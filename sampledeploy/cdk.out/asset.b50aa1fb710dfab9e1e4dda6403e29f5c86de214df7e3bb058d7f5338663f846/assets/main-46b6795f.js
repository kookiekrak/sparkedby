var ip=(t,e,n)=>{if(!e.has(t))throw TypeError("Cannot "+n)};var _=(t,e,n)=>(ip(t,e,"read from private field"),n?n.call(t):e.get(t)),q=(t,e,n)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,n)},U=(t,e,n,r)=>(ip(t,e,"write to private field"),r?r.call(t,n):e.set(t,n),n);var Nu=(t,e,n,r)=>({set _(i){U(t,e,i,n)},get _(){return _(t,e,r)}}),se=(t,e,n)=>(ip(t,e,"access private method"),n);function XO(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in t)){const o=Object.getOwnPropertyDescriptor(r,i);o&&Object.defineProperty(t,i,o.get?o:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();var Nn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function mS(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function ZO(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var i=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,i.get?i:{enumerable:!0,get:function(){return t[r]}})}),n}var gS={exports:{}},Zf={},yS={exports:{}},ce={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var su=Symbol.for("react.element"),eP=Symbol.for("react.portal"),tP=Symbol.for("react.fragment"),nP=Symbol.for("react.strict_mode"),rP=Symbol.for("react.profiler"),iP=Symbol.for("react.provider"),oP=Symbol.for("react.context"),sP=Symbol.for("react.forward_ref"),aP=Symbol.for("react.suspense"),lP=Symbol.for("react.memo"),cP=Symbol.for("react.lazy"),cx=Symbol.iterator;function uP(t){return t===null||typeof t!="object"?null:(t=cx&&t[cx]||t["@@iterator"],typeof t=="function"?t:null)}var vS={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},xS=Object.assign,wS={};function sl(t,e,n){this.props=t,this.context=e,this.refs=wS,this.updater=n||vS}sl.prototype.isReactComponent={};sl.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};sl.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function bS(){}bS.prototype=sl.prototype;function $y(t,e,n){this.props=t,this.context=e,this.refs=wS,this.updater=n||vS}var Fy=$y.prototype=new bS;Fy.constructor=$y;xS(Fy,sl.prototype);Fy.isPureReactComponent=!0;var ux=Array.isArray,SS=Object.prototype.hasOwnProperty,By={current:null},CS={key:!0,ref:!0,__self:!0,__source:!0};function kS(t,e,n){var r,i={},o=null,s=null;if(e!=null)for(r in e.ref!==void 0&&(s=e.ref),e.key!==void 0&&(o=""+e.key),e)SS.call(e,r)&&!CS.hasOwnProperty(r)&&(i[r]=e[r]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];i.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:su,type:t,key:o,ref:s,props:i,_owner:By.current}}function dP(t,e){return{$$typeof:su,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function zy(t){return typeof t=="object"&&t!==null&&t.$$typeof===su}function fP(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var dx=/\/+/g;function op(t,e){return typeof t=="object"&&t!==null&&t.key!=null?fP(""+t.key):e.toString(36)}function kd(t,e,n,r,i){var o=typeof t;(o==="undefined"||o==="boolean")&&(t=null);var s=!1;if(t===null)s=!0;else switch(o){case"string":case"number":s=!0;break;case"object":switch(t.$$typeof){case su:case eP:s=!0}}if(s)return s=t,i=i(s),t=r===""?"."+op(s,0):r,ux(i)?(n="",t!=null&&(n=t.replace(dx,"$&/")+"/"),kd(i,e,n,"",function(c){return c})):i!=null&&(zy(i)&&(i=dP(i,n+(!i.key||s&&s.key===i.key?"":(""+i.key).replace(dx,"$&/")+"/")+t)),e.push(i)),1;if(s=0,r=r===""?".":r+":",ux(t))for(var a=0;a<t.length;a++){o=t[a];var l=r+op(o,a);s+=kd(o,e,n,l,i)}else if(l=uP(t),typeof l=="function")for(t=l.call(t),a=0;!(o=t.next()).done;)o=o.value,l=r+op(o,a++),s+=kd(o,e,n,l,i);else if(o==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return s}function ju(t,e,n){if(t==null)return t;var r=[],i=0;return kd(t,r,"","",function(o){return e.call(n,o,i++)}),r}function hP(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Lt={current:null},Ed={transition:null},pP={ReactCurrentDispatcher:Lt,ReactCurrentBatchConfig:Ed,ReactCurrentOwner:By};function ES(){throw Error("act(...) is not supported in production builds of React.")}ce.Children={map:ju,forEach:function(t,e,n){ju(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return ju(t,function(){e++}),e},toArray:function(t){return ju(t,function(e){return e})||[]},only:function(t){if(!zy(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};ce.Component=sl;ce.Fragment=tP;ce.Profiler=rP;ce.PureComponent=$y;ce.StrictMode=nP;ce.Suspense=aP;ce.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=pP;ce.act=ES;ce.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=xS({},t.props),i=t.key,o=t.ref,s=t._owner;if(e!=null){if(e.ref!==void 0&&(o=e.ref,s=By.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)SS.call(e,l)&&!CS.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var c=0;c<l;c++)a[c]=arguments[c+2];r.children=a}return{$$typeof:su,type:t.type,key:i,ref:o,props:r,_owner:s}};ce.createContext=function(t){return t={$$typeof:oP,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:iP,_context:t},t.Consumer=t};ce.createElement=kS;ce.createFactory=function(t){var e=kS.bind(null,t);return e.type=t,e};ce.createRef=function(){return{current:null}};ce.forwardRef=function(t){return{$$typeof:sP,render:t}};ce.isValidElement=zy;ce.lazy=function(t){return{$$typeof:cP,_payload:{_status:-1,_result:t},_init:hP}};ce.memo=function(t,e){return{$$typeof:lP,type:t,compare:e===void 0?null:e}};ce.startTransition=function(t){var e=Ed.transition;Ed.transition={};try{t()}finally{Ed.transition=e}};ce.unstable_act=ES;ce.useCallback=function(t,e){return Lt.current.useCallback(t,e)};ce.useContext=function(t){return Lt.current.useContext(t)};ce.useDebugValue=function(){};ce.useDeferredValue=function(t){return Lt.current.useDeferredValue(t)};ce.useEffect=function(t,e){return Lt.current.useEffect(t,e)};ce.useId=function(){return Lt.current.useId()};ce.useImperativeHandle=function(t,e,n){return Lt.current.useImperativeHandle(t,e,n)};ce.useInsertionEffect=function(t,e){return Lt.current.useInsertionEffect(t,e)};ce.useLayoutEffect=function(t,e){return Lt.current.useLayoutEffect(t,e)};ce.useMemo=function(t,e){return Lt.current.useMemo(t,e)};ce.useReducer=function(t,e,n){return Lt.current.useReducer(t,e,n)};ce.useRef=function(t){return Lt.current.useRef(t)};ce.useState=function(t){return Lt.current.useState(t)};ce.useSyncExternalStore=function(t,e,n){return Lt.current.useSyncExternalStore(t,e,n)};ce.useTransition=function(){return Lt.current.useTransition()};ce.version="18.3.1";yS.exports=ce;var y=yS.exports;const ve=mS(y),mP=XO({__proto__:null,default:ve},[y]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gP=y,yP=Symbol.for("react.element"),vP=Symbol.for("react.fragment"),xP=Object.prototype.hasOwnProperty,wP=gP.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,bP={key:!0,ref:!0,__self:!0,__source:!0};function TS(t,e,n){var r,i={},o=null,s=null;n!==void 0&&(o=""+n),e.key!==void 0&&(o=""+e.key),e.ref!==void 0&&(s=e.ref);for(r in e)xP.call(e,r)&&!bP.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:yP,type:t,key:o,ref:s,props:i,_owner:wP.current}}Zf.Fragment=vP;Zf.jsx=TS;Zf.jsxs=TS;gS.exports=Zf;var h=gS.exports;window.global=window;var Om={},_S={exports:{}},xn={},RS={exports:{}},OS={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(A,D){var L=A.length;A.push(D);e:for(;0<L;){var Y=L-1>>>1,ee=A[Y];if(0<i(ee,D))A[Y]=D,A[L]=ee,L=Y;else break e}}function n(A){return A.length===0?null:A[0]}function r(A){if(A.length===0)return null;var D=A[0],L=A.pop();if(L!==D){A[0]=L;e:for(var Y=0,ee=A.length,G=ee>>>1;Y<G;){var Z=2*(Y+1)-1,xe=A[Z],we=Z+1,ze=A[we];if(0>i(xe,L))we<ee&&0>i(ze,xe)?(A[Y]=ze,A[we]=L,Y=we):(A[Y]=xe,A[Z]=L,Y=Z);else if(we<ee&&0>i(ze,L))A[Y]=ze,A[we]=L,Y=we;else break e}}return D}function i(A,D){var L=A.sortIndex-D.sortIndex;return L!==0?L:A.id-D.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var s=Date,a=s.now();t.unstable_now=function(){return s.now()-a}}var l=[],c=[],u=1,d=null,f=3,p=!1,m=!1,g=!1,v=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function S(A){for(var D=n(c);D!==null;){if(D.callback===null)r(c);else if(D.startTime<=A)r(c),D.sortIndex=D.expirationTime,e(l,D);else break;D=n(c)}}function b(A){if(g=!1,S(A),!m)if(n(l)!==null)m=!0,B(C);else{var D=n(c);D!==null&&H(b,D.startTime-A)}}function C(A,D){m=!1,g&&(g=!1,x(T),T=-1),p=!0;var L=f;try{for(S(D),d=n(l);d!==null&&(!(d.expirationTime>D)||A&&!I());){var Y=d.callback;if(typeof Y=="function"){d.callback=null,f=d.priorityLevel;var ee=Y(d.expirationTime<=D);D=t.unstable_now(),typeof ee=="function"?d.callback=ee:d===n(l)&&r(l),S(D)}else r(l);d=n(l)}if(d!==null)var G=!0;else{var Z=n(c);Z!==null&&H(b,Z.startTime-D),G=!1}return G}finally{d=null,f=L,p=!1}}var k=!1,E=null,T=-1,O=5,R=-1;function I(){return!(t.unstable_now()-R<O)}function $(){if(E!==null){var A=t.unstable_now();R=A;var D=!0;try{D=E(!0,A)}finally{D?P():(k=!1,E=null)}}else k=!1}var P;if(typeof w=="function")P=function(){w($)};else if(typeof MessageChannel<"u"){var M=new MessageChannel,z=M.port2;M.port1.onmessage=$,P=function(){z.postMessage(null)}}else P=function(){v($,0)};function B(A){E=A,k||(k=!0,P())}function H(A,D){T=v(function(){A(t.unstable_now())},D)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(A){A.callback=null},t.unstable_continueExecution=function(){m||p||(m=!0,B(C))},t.unstable_forceFrameRate=function(A){0>A||125<A?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):O=0<A?Math.floor(1e3/A):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(A){switch(f){case 1:case 2:case 3:var D=3;break;default:D=f}var L=f;f=D;try{return A()}finally{f=L}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(A,D){switch(A){case 1:case 2:case 3:case 4:case 5:break;default:A=3}var L=f;f=A;try{return D()}finally{f=L}},t.unstable_scheduleCallback=function(A,D,L){var Y=t.unstable_now();switch(typeof L=="object"&&L!==null?(L=L.delay,L=typeof L=="number"&&0<L?Y+L:Y):L=Y,A){case 1:var ee=-1;break;case 2:ee=250;break;case 5:ee=1073741823;break;case 4:ee=1e4;break;default:ee=5e3}return ee=L+ee,A={id:u++,callback:D,priorityLevel:A,startTime:L,expirationTime:ee,sortIndex:-1},L>Y?(A.sortIndex=L,e(c,A),n(l)===null&&A===n(c)&&(g?(x(T),T=-1):g=!0,H(b,L-Y))):(A.sortIndex=ee,e(l,A),m||p||(m=!0,B(C))),A},t.unstable_shouldYield=I,t.unstable_wrapCallback=function(A){var D=f;return function(){var L=f;f=D;try{return A.apply(this,arguments)}finally{f=L}}}})(OS);RS.exports=OS;var SP=RS.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var CP=y,yn=SP;function F(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var PS=new Set,lc={};function bs(t,e){Na(t,e),Na(t+"Capture",e)}function Na(t,e){for(lc[t]=e,t=0;t<e.length;t++)PS.add(e[t])}var Yr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Pm=Object.prototype.hasOwnProperty,kP=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,fx={},hx={};function EP(t){return Pm.call(hx,t)?!0:Pm.call(fx,t)?!1:kP.test(t)?hx[t]=!0:(fx[t]=!0,!1)}function TP(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function _P(t,e,n,r){if(e===null||typeof e>"u"||TP(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function $t(t,e,n,r,i,o,s){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=o,this.removeEmptyString=s}var ft={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){ft[t]=new $t(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];ft[e]=new $t(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){ft[t]=new $t(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){ft[t]=new $t(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){ft[t]=new $t(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){ft[t]=new $t(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){ft[t]=new $t(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){ft[t]=new $t(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){ft[t]=new $t(t,5,!1,t.toLowerCase(),null,!1,!1)});var Uy=/[\-:]([a-z])/g;function Vy(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Uy,Vy);ft[e]=new $t(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Uy,Vy);ft[e]=new $t(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Uy,Vy);ft[e]=new $t(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){ft[t]=new $t(t,1,!1,t.toLowerCase(),null,!1,!1)});ft.xlinkHref=new $t("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){ft[t]=new $t(t,1,!1,t.toLowerCase(),null,!0,!0)});function Hy(t,e,n,r){var i=ft.hasOwnProperty(e)?ft[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(_P(e,n,i,r)&&(n=null),r||i===null?EP(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var ri=CP.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Lu=Symbol.for("react.element"),Gs=Symbol.for("react.portal"),Js=Symbol.for("react.fragment"),Wy=Symbol.for("react.strict_mode"),Mm=Symbol.for("react.profiler"),MS=Symbol.for("react.provider"),AS=Symbol.for("react.context"),Ky=Symbol.for("react.forward_ref"),Am=Symbol.for("react.suspense"),Dm=Symbol.for("react.suspense_list"),qy=Symbol.for("react.memo"),mi=Symbol.for("react.lazy"),DS=Symbol.for("react.offscreen"),px=Symbol.iterator;function wl(t){return t===null||typeof t!="object"?null:(t=px&&t[px]||t["@@iterator"],typeof t=="function"?t:null)}var je=Object.assign,sp;function Dl(t){if(sp===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);sp=e&&e[1]||""}return`
`+sp+t}var ap=!1;function lp(t,e){if(!t||ap)return"";ap=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var r=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){r=c}t.call(e.prototype)}else{try{throw Error()}catch(c){r=c}t()}}catch(c){if(c&&r&&typeof c.stack=="string"){for(var i=c.stack.split(`
`),o=r.stack.split(`
`),s=i.length-1,a=o.length-1;1<=s&&0<=a&&i[s]!==o[a];)a--;for(;1<=s&&0<=a;s--,a--)if(i[s]!==o[a]){if(s!==1||a!==1)do if(s--,a--,0>a||i[s]!==o[a]){var l=`
`+i[s].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=s&&0<=a);break}}}finally{ap=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Dl(t):""}function RP(t){switch(t.tag){case 5:return Dl(t.type);case 16:return Dl("Lazy");case 13:return Dl("Suspense");case 19:return Dl("SuspenseList");case 0:case 2:case 15:return t=lp(t.type,!1),t;case 11:return t=lp(t.type.render,!1),t;case 1:return t=lp(t.type,!0),t;default:return""}}function Im(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Js:return"Fragment";case Gs:return"Portal";case Mm:return"Profiler";case Wy:return"StrictMode";case Am:return"Suspense";case Dm:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case AS:return(t.displayName||"Context")+".Consumer";case MS:return(t._context.displayName||"Context")+".Provider";case Ky:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case qy:return e=t.displayName||null,e!==null?e:Im(t.type)||"Memo";case mi:e=t._payload,t=t._init;try{return Im(t(e))}catch{}}return null}function OP(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Im(e);case 8:return e===Wy?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Xi(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function IS(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function PP(t){var e=IS(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,o=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(s){r=""+s,o.call(this,s)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(s){r=""+s},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function $u(t){t._valueTracker||(t._valueTracker=PP(t))}function NS(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=IS(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function qd(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Nm(t,e){var n=e.checked;return je({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function mx(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Xi(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function jS(t,e){e=e.checked,e!=null&&Hy(t,"checked",e,!1)}function jm(t,e){jS(t,e);var n=Xi(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Lm(t,e.type,n):e.hasOwnProperty("defaultValue")&&Lm(t,e.type,Xi(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function gx(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Lm(t,e,n){(e!=="number"||qd(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Il=Array.isArray;function la(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Xi(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function $m(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(F(91));return je({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function yx(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(F(92));if(Il(n)){if(1<n.length)throw Error(F(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Xi(n)}}function LS(t,e){var n=Xi(e.value),r=Xi(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function vx(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function $S(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Fm(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?$S(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Fu,FS=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Fu=Fu||document.createElement("div"),Fu.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Fu.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function cc(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Hl={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},MP=["Webkit","ms","Moz","O"];Object.keys(Hl).forEach(function(t){MP.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Hl[e]=Hl[t]})});function BS(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Hl.hasOwnProperty(t)&&Hl[t]?(""+e).trim():e+"px"}function zS(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=BS(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var AP=je({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Bm(t,e){if(e){if(AP[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(F(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(F(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(F(61))}if(e.style!=null&&typeof e.style!="object")throw Error(F(62))}}function zm(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Um=null;function Gy(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Vm=null,ca=null,ua=null;function xx(t){if(t=cu(t)){if(typeof Vm!="function")throw Error(F(280));var e=t.stateNode;e&&(e=ih(e),Vm(t.stateNode,t.type,e))}}function US(t){ca?ua?ua.push(t):ua=[t]:ca=t}function VS(){if(ca){var t=ca,e=ua;if(ua=ca=null,xx(t),e)for(t=0;t<e.length;t++)xx(e[t])}}function HS(t,e){return t(e)}function WS(){}var cp=!1;function KS(t,e,n){if(cp)return t(e,n);cp=!0;try{return HS(t,e,n)}finally{cp=!1,(ca!==null||ua!==null)&&(WS(),VS())}}function uc(t,e){var n=t.stateNode;if(n===null)return null;var r=ih(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(F(231,e,typeof n));return n}var Hm=!1;if(Yr)try{var bl={};Object.defineProperty(bl,"passive",{get:function(){Hm=!0}}),window.addEventListener("test",bl,bl),window.removeEventListener("test",bl,bl)}catch{Hm=!1}function DP(t,e,n,r,i,o,s,a,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(n,c)}catch(u){this.onError(u)}}var Wl=!1,Gd=null,Jd=!1,Wm=null,IP={onError:function(t){Wl=!0,Gd=t}};function NP(t,e,n,r,i,o,s,a,l){Wl=!1,Gd=null,DP.apply(IP,arguments)}function jP(t,e,n,r,i,o,s,a,l){if(NP.apply(this,arguments),Wl){if(Wl){var c=Gd;Wl=!1,Gd=null}else throw Error(F(198));Jd||(Jd=!0,Wm=c)}}function Ss(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function qS(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function wx(t){if(Ss(t)!==t)throw Error(F(188))}function LP(t){var e=t.alternate;if(!e){if(e=Ss(t),e===null)throw Error(F(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var o=i.alternate;if(o===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===n)return wx(i),t;if(o===r)return wx(i),e;o=o.sibling}throw Error(F(188))}if(n.return!==r.return)n=i,r=o;else{for(var s=!1,a=i.child;a;){if(a===n){s=!0,n=i,r=o;break}if(a===r){s=!0,r=i,n=o;break}a=a.sibling}if(!s){for(a=o.child;a;){if(a===n){s=!0,n=o,r=i;break}if(a===r){s=!0,r=o,n=i;break}a=a.sibling}if(!s)throw Error(F(189))}}if(n.alternate!==r)throw Error(F(190))}if(n.tag!==3)throw Error(F(188));return n.stateNode.current===n?t:e}function GS(t){return t=LP(t),t!==null?JS(t):null}function JS(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=JS(t);if(e!==null)return e;t=t.sibling}return null}var YS=yn.unstable_scheduleCallback,bx=yn.unstable_cancelCallback,$P=yn.unstable_shouldYield,FP=yn.unstable_requestPaint,Ve=yn.unstable_now,BP=yn.unstable_getCurrentPriorityLevel,Jy=yn.unstable_ImmediatePriority,QS=yn.unstable_UserBlockingPriority,Yd=yn.unstable_NormalPriority,zP=yn.unstable_LowPriority,XS=yn.unstable_IdlePriority,eh=null,Sr=null;function UP(t){if(Sr&&typeof Sr.onCommitFiberRoot=="function")try{Sr.onCommitFiberRoot(eh,t,void 0,(t.current.flags&128)===128)}catch{}}var Zn=Math.clz32?Math.clz32:WP,VP=Math.log,HP=Math.LN2;function WP(t){return t>>>=0,t===0?32:31-(VP(t)/HP|0)|0}var Bu=64,zu=4194304;function Nl(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Qd(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,o=t.pingedLanes,s=n&268435455;if(s!==0){var a=s&~i;a!==0?r=Nl(a):(o&=s,o!==0&&(r=Nl(o)))}else s=n&~i,s!==0?r=Nl(s):o!==0&&(r=Nl(o));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,o=e&-e,i>=o||i===16&&(o&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Zn(e),i=1<<n,r|=t[n],e&=~i;return r}function KP(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function qP(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,o=t.pendingLanes;0<o;){var s=31-Zn(o),a=1<<s,l=i[s];l===-1?(!(a&n)||a&r)&&(i[s]=KP(a,e)):l<=e&&(t.expiredLanes|=a),o&=~a}}function Km(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function ZS(){var t=Bu;return Bu<<=1,!(Bu&4194240)&&(Bu=64),t}function up(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function au(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Zn(e),t[e]=n}function GP(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-Zn(n),o=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~o}}function Yy(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Zn(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var me=0;function eC(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var tC,Qy,nC,rC,iC,qm=!1,Uu=[],$i=null,Fi=null,Bi=null,dc=new Map,fc=new Map,wi=[],JP="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Sx(t,e){switch(t){case"focusin":case"focusout":$i=null;break;case"dragenter":case"dragleave":Fi=null;break;case"mouseover":case"mouseout":Bi=null;break;case"pointerover":case"pointerout":dc.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":fc.delete(e.pointerId)}}function Sl(t,e,n,r,i,o){return t===null||t.nativeEvent!==o?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[i]},e!==null&&(e=cu(e),e!==null&&Qy(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function YP(t,e,n,r,i){switch(e){case"focusin":return $i=Sl($i,t,e,n,r,i),!0;case"dragenter":return Fi=Sl(Fi,t,e,n,r,i),!0;case"mouseover":return Bi=Sl(Bi,t,e,n,r,i),!0;case"pointerover":var o=i.pointerId;return dc.set(o,Sl(dc.get(o)||null,t,e,n,r,i)),!0;case"gotpointercapture":return o=i.pointerId,fc.set(o,Sl(fc.get(o)||null,t,e,n,r,i)),!0}return!1}function oC(t){var e=No(t.target);if(e!==null){var n=Ss(e);if(n!==null){if(e=n.tag,e===13){if(e=qS(n),e!==null){t.blockedOn=e,iC(t.priority,function(){nC(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Td(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Gm(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Um=r,n.target.dispatchEvent(r),Um=null}else return e=cu(n),e!==null&&Qy(e),t.blockedOn=n,!1;e.shift()}return!0}function Cx(t,e,n){Td(t)&&n.delete(e)}function QP(){qm=!1,$i!==null&&Td($i)&&($i=null),Fi!==null&&Td(Fi)&&(Fi=null),Bi!==null&&Td(Bi)&&(Bi=null),dc.forEach(Cx),fc.forEach(Cx)}function Cl(t,e){t.blockedOn===e&&(t.blockedOn=null,qm||(qm=!0,yn.unstable_scheduleCallback(yn.unstable_NormalPriority,QP)))}function hc(t){function e(i){return Cl(i,t)}if(0<Uu.length){Cl(Uu[0],t);for(var n=1;n<Uu.length;n++){var r=Uu[n];r.blockedOn===t&&(r.blockedOn=null)}}for($i!==null&&Cl($i,t),Fi!==null&&Cl(Fi,t),Bi!==null&&Cl(Bi,t),dc.forEach(e),fc.forEach(e),n=0;n<wi.length;n++)r=wi[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<wi.length&&(n=wi[0],n.blockedOn===null);)oC(n),n.blockedOn===null&&wi.shift()}var da=ri.ReactCurrentBatchConfig,Xd=!0;function XP(t,e,n,r){var i=me,o=da.transition;da.transition=null;try{me=1,Xy(t,e,n,r)}finally{me=i,da.transition=o}}function ZP(t,e,n,r){var i=me,o=da.transition;da.transition=null;try{me=4,Xy(t,e,n,r)}finally{me=i,da.transition=o}}function Xy(t,e,n,r){if(Xd){var i=Gm(t,e,n,r);if(i===null)wp(t,e,r,Zd,n),Sx(t,r);else if(YP(i,t,e,n,r))r.stopPropagation();else if(Sx(t,r),e&4&&-1<JP.indexOf(t)){for(;i!==null;){var o=cu(i);if(o!==null&&tC(o),o=Gm(t,e,n,r),o===null&&wp(t,e,r,Zd,n),o===i)break;i=o}i!==null&&r.stopPropagation()}else wp(t,e,r,null,n)}}var Zd=null;function Gm(t,e,n,r){if(Zd=null,t=Gy(r),t=No(t),t!==null)if(e=Ss(t),e===null)t=null;else if(n=e.tag,n===13){if(t=qS(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Zd=t,null}function sC(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(BP()){case Jy:return 1;case QS:return 4;case Yd:case zP:return 16;case XS:return 536870912;default:return 16}default:return 16}}var Di=null,Zy=null,_d=null;function aC(){if(_d)return _d;var t,e=Zy,n=e.length,r,i="value"in Di?Di.value:Di.textContent,o=i.length;for(t=0;t<n&&e[t]===i[t];t++);var s=n-t;for(r=1;r<=s&&e[n-r]===i[o-r];r++);return _d=i.slice(t,1<r?1-r:void 0)}function Rd(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Vu(){return!0}function kx(){return!1}function wn(t){function e(n,r,i,o,s){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=o,this.target=s,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(o):o[a]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?Vu:kx,this.isPropagationStopped=kx,this}return je(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Vu)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Vu)},persist:function(){},isPersistent:Vu}),e}var al={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ev=wn(al),lu=je({},al,{view:0,detail:0}),eM=wn(lu),dp,fp,kl,th=je({},lu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:tv,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==kl&&(kl&&t.type==="mousemove"?(dp=t.screenX-kl.screenX,fp=t.screenY-kl.screenY):fp=dp=0,kl=t),dp)},movementY:function(t){return"movementY"in t?t.movementY:fp}}),Ex=wn(th),tM=je({},th,{dataTransfer:0}),nM=wn(tM),rM=je({},lu,{relatedTarget:0}),hp=wn(rM),iM=je({},al,{animationName:0,elapsedTime:0,pseudoElement:0}),oM=wn(iM),sM=je({},al,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),aM=wn(sM),lM=je({},al,{data:0}),Tx=wn(lM),cM={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},uM={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},dM={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function fM(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=dM[t])?!!e[t]:!1}function tv(){return fM}var hM=je({},lu,{key:function(t){if(t.key){var e=cM[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Rd(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?uM[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:tv,charCode:function(t){return t.type==="keypress"?Rd(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Rd(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),pM=wn(hM),mM=je({},th,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),_x=wn(mM),gM=je({},lu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:tv}),yM=wn(gM),vM=je({},al,{propertyName:0,elapsedTime:0,pseudoElement:0}),xM=wn(vM),wM=je({},th,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),bM=wn(wM),SM=[9,13,27,32],nv=Yr&&"CompositionEvent"in window,Kl=null;Yr&&"documentMode"in document&&(Kl=document.documentMode);var CM=Yr&&"TextEvent"in window&&!Kl,lC=Yr&&(!nv||Kl&&8<Kl&&11>=Kl),Rx=String.fromCharCode(32),Ox=!1;function cC(t,e){switch(t){case"keyup":return SM.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function uC(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Ys=!1;function kM(t,e){switch(t){case"compositionend":return uC(e);case"keypress":return e.which!==32?null:(Ox=!0,Rx);case"textInput":return t=e.data,t===Rx&&Ox?null:t;default:return null}}function EM(t,e){if(Ys)return t==="compositionend"||!nv&&cC(t,e)?(t=aC(),_d=Zy=Di=null,Ys=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return lC&&e.locale!=="ko"?null:e.data;default:return null}}var TM={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Px(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!TM[t.type]:e==="textarea"}function dC(t,e,n,r){US(r),e=ef(e,"onChange"),0<e.length&&(n=new ev("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var ql=null,pc=null;function _M(t){SC(t,0)}function nh(t){var e=Zs(t);if(NS(e))return t}function RM(t,e){if(t==="change")return e}var fC=!1;if(Yr){var pp;if(Yr){var mp="oninput"in document;if(!mp){var Mx=document.createElement("div");Mx.setAttribute("oninput","return;"),mp=typeof Mx.oninput=="function"}pp=mp}else pp=!1;fC=pp&&(!document.documentMode||9<document.documentMode)}function Ax(){ql&&(ql.detachEvent("onpropertychange",hC),pc=ql=null)}function hC(t){if(t.propertyName==="value"&&nh(pc)){var e=[];dC(e,pc,t,Gy(t)),KS(_M,e)}}function OM(t,e,n){t==="focusin"?(Ax(),ql=e,pc=n,ql.attachEvent("onpropertychange",hC)):t==="focusout"&&Ax()}function PM(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return nh(pc)}function MM(t,e){if(t==="click")return nh(e)}function AM(t,e){if(t==="input"||t==="change")return nh(e)}function DM(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var tr=typeof Object.is=="function"?Object.is:DM;function mc(t,e){if(tr(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!Pm.call(e,i)||!tr(t[i],e[i]))return!1}return!0}function Dx(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Ix(t,e){var n=Dx(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Dx(n)}}function pC(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?pC(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function mC(){for(var t=window,e=qd();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=qd(t.document)}return e}function rv(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function IM(t){var e=mC(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&pC(n.ownerDocument.documentElement,n)){if(r!==null&&rv(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,o=Math.min(r.start,i);r=r.end===void 0?o:Math.min(r.end,i),!t.extend&&o>r&&(i=r,r=o,o=i),i=Ix(n,o);var s=Ix(n,r);i&&s&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==s.node||t.focusOffset!==s.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),o>r?(t.addRange(e),t.extend(s.node,s.offset)):(e.setEnd(s.node,s.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var NM=Yr&&"documentMode"in document&&11>=document.documentMode,Qs=null,Jm=null,Gl=null,Ym=!1;function Nx(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Ym||Qs==null||Qs!==qd(r)||(r=Qs,"selectionStart"in r&&rv(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Gl&&mc(Gl,r)||(Gl=r,r=ef(Jm,"onSelect"),0<r.length&&(e=new ev("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Qs)))}function Hu(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Xs={animationend:Hu("Animation","AnimationEnd"),animationiteration:Hu("Animation","AnimationIteration"),animationstart:Hu("Animation","AnimationStart"),transitionend:Hu("Transition","TransitionEnd")},gp={},gC={};Yr&&(gC=document.createElement("div").style,"AnimationEvent"in window||(delete Xs.animationend.animation,delete Xs.animationiteration.animation,delete Xs.animationstart.animation),"TransitionEvent"in window||delete Xs.transitionend.transition);function rh(t){if(gp[t])return gp[t];if(!Xs[t])return t;var e=Xs[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in gC)return gp[t]=e[n];return t}var yC=rh("animationend"),vC=rh("animationiteration"),xC=rh("animationstart"),wC=rh("transitionend"),bC=new Map,jx="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ao(t,e){bC.set(t,e),bs(e,[t])}for(var yp=0;yp<jx.length;yp++){var vp=jx[yp],jM=vp.toLowerCase(),LM=vp[0].toUpperCase()+vp.slice(1);ao(jM,"on"+LM)}ao(yC,"onAnimationEnd");ao(vC,"onAnimationIteration");ao(xC,"onAnimationStart");ao("dblclick","onDoubleClick");ao("focusin","onFocus");ao("focusout","onBlur");ao(wC,"onTransitionEnd");Na("onMouseEnter",["mouseout","mouseover"]);Na("onMouseLeave",["mouseout","mouseover"]);Na("onPointerEnter",["pointerout","pointerover"]);Na("onPointerLeave",["pointerout","pointerover"]);bs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));bs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));bs("onBeforeInput",["compositionend","keypress","textInput","paste"]);bs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));bs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));bs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var jl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),$M=new Set("cancel close invalid load scroll toggle".split(" ").concat(jl));function Lx(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,jP(r,e,void 0,t),t.currentTarget=null}function SC(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var o=void 0;if(e)for(var s=r.length-1;0<=s;s--){var a=r[s],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==o&&i.isPropagationStopped())break e;Lx(i,a,c),o=l}else for(s=0;s<r.length;s++){if(a=r[s],l=a.instance,c=a.currentTarget,a=a.listener,l!==o&&i.isPropagationStopped())break e;Lx(i,a,c),o=l}}}if(Jd)throw t=Wm,Jd=!1,Wm=null,t}function Oe(t,e){var n=e[tg];n===void 0&&(n=e[tg]=new Set);var r=t+"__bubble";n.has(r)||(CC(e,t,2,!1),n.add(r))}function xp(t,e,n){var r=0;e&&(r|=4),CC(n,t,r,e)}var Wu="_reactListening"+Math.random().toString(36).slice(2);function gc(t){if(!t[Wu]){t[Wu]=!0,PS.forEach(function(n){n!=="selectionchange"&&($M.has(n)||xp(n,!1,t),xp(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Wu]||(e[Wu]=!0,xp("selectionchange",!1,e))}}function CC(t,e,n,r){switch(sC(e)){case 1:var i=XP;break;case 4:i=ZP;break;default:i=Xy}n=i.bind(null,e,n,t),i=void 0,!Hm||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function wp(t,e,n,r,i){var o=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var s=r.tag;if(s===3||s===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(s===4)for(s=r.return;s!==null;){var l=s.tag;if((l===3||l===4)&&(l=s.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;s=s.return}for(;a!==null;){if(s=No(a),s===null)return;if(l=s.tag,l===5||l===6){r=o=s;continue e}a=a.parentNode}}r=r.return}KS(function(){var c=o,u=Gy(n),d=[];e:{var f=bC.get(t);if(f!==void 0){var p=ev,m=t;switch(t){case"keypress":if(Rd(n)===0)break e;case"keydown":case"keyup":p=pM;break;case"focusin":m="focus",p=hp;break;case"focusout":m="blur",p=hp;break;case"beforeblur":case"afterblur":p=hp;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=Ex;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=nM;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=yM;break;case yC:case vC:case xC:p=oM;break;case wC:p=xM;break;case"scroll":p=eM;break;case"wheel":p=bM;break;case"copy":case"cut":case"paste":p=aM;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=_x}var g=(e&4)!==0,v=!g&&t==="scroll",x=g?f!==null?f+"Capture":null:f;g=[];for(var w=c,S;w!==null;){S=w;var b=S.stateNode;if(S.tag===5&&b!==null&&(S=b,x!==null&&(b=uc(w,x),b!=null&&g.push(yc(w,b,S)))),v)break;w=w.return}0<g.length&&(f=new p(f,m,null,n,u),d.push({event:f,listeners:g}))}}if(!(e&7)){e:{if(f=t==="mouseover"||t==="pointerover",p=t==="mouseout"||t==="pointerout",f&&n!==Um&&(m=n.relatedTarget||n.fromElement)&&(No(m)||m[Qr]))break e;if((p||f)&&(f=u.window===u?u:(f=u.ownerDocument)?f.defaultView||f.parentWindow:window,p?(m=n.relatedTarget||n.toElement,p=c,m=m?No(m):null,m!==null&&(v=Ss(m),m!==v||m.tag!==5&&m.tag!==6)&&(m=null)):(p=null,m=c),p!==m)){if(g=Ex,b="onMouseLeave",x="onMouseEnter",w="mouse",(t==="pointerout"||t==="pointerover")&&(g=_x,b="onPointerLeave",x="onPointerEnter",w="pointer"),v=p==null?f:Zs(p),S=m==null?f:Zs(m),f=new g(b,w+"leave",p,n,u),f.target=v,f.relatedTarget=S,b=null,No(u)===c&&(g=new g(x,w+"enter",m,n,u),g.target=S,g.relatedTarget=v,b=g),v=b,p&&m)t:{for(g=p,x=m,w=0,S=g;S;S=As(S))w++;for(S=0,b=x;b;b=As(b))S++;for(;0<w-S;)g=As(g),w--;for(;0<S-w;)x=As(x),S--;for(;w--;){if(g===x||x!==null&&g===x.alternate)break t;g=As(g),x=As(x)}g=null}else g=null;p!==null&&$x(d,f,p,g,!1),m!==null&&v!==null&&$x(d,v,m,g,!0)}}e:{if(f=c?Zs(c):window,p=f.nodeName&&f.nodeName.toLowerCase(),p==="select"||p==="input"&&f.type==="file")var C=RM;else if(Px(f))if(fC)C=AM;else{C=PM;var k=OM}else(p=f.nodeName)&&p.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(C=MM);if(C&&(C=C(t,c))){dC(d,C,n,u);break e}k&&k(t,f,c),t==="focusout"&&(k=f._wrapperState)&&k.controlled&&f.type==="number"&&Lm(f,"number",f.value)}switch(k=c?Zs(c):window,t){case"focusin":(Px(k)||k.contentEditable==="true")&&(Qs=k,Jm=c,Gl=null);break;case"focusout":Gl=Jm=Qs=null;break;case"mousedown":Ym=!0;break;case"contextmenu":case"mouseup":case"dragend":Ym=!1,Nx(d,n,u);break;case"selectionchange":if(NM)break;case"keydown":case"keyup":Nx(d,n,u)}var E;if(nv)e:{switch(t){case"compositionstart":var T="onCompositionStart";break e;case"compositionend":T="onCompositionEnd";break e;case"compositionupdate":T="onCompositionUpdate";break e}T=void 0}else Ys?cC(t,n)&&(T="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(T="onCompositionStart");T&&(lC&&n.locale!=="ko"&&(Ys||T!=="onCompositionStart"?T==="onCompositionEnd"&&Ys&&(E=aC()):(Di=u,Zy="value"in Di?Di.value:Di.textContent,Ys=!0)),k=ef(c,T),0<k.length&&(T=new Tx(T,t,null,n,u),d.push({event:T,listeners:k}),E?T.data=E:(E=uC(n),E!==null&&(T.data=E)))),(E=CM?kM(t,n):EM(t,n))&&(c=ef(c,"onBeforeInput"),0<c.length&&(u=new Tx("onBeforeInput","beforeinput",null,n,u),d.push({event:u,listeners:c}),u.data=E))}SC(d,e)})}function yc(t,e,n){return{instance:t,listener:e,currentTarget:n}}function ef(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,o=i.stateNode;i.tag===5&&o!==null&&(i=o,o=uc(t,n),o!=null&&r.unshift(yc(t,o,i)),o=uc(t,e),o!=null&&r.push(yc(t,o,i))),t=t.return}return r}function As(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function $x(t,e,n,r,i){for(var o=e._reactName,s=[];n!==null&&n!==r;){var a=n,l=a.alternate,c=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&c!==null&&(a=c,i?(l=uc(n,o),l!=null&&s.unshift(yc(n,l,a))):i||(l=uc(n,o),l!=null&&s.push(yc(n,l,a)))),n=n.return}s.length!==0&&t.push({event:e,listeners:s})}var FM=/\r\n?/g,BM=/\u0000|\uFFFD/g;function Fx(t){return(typeof t=="string"?t:""+t).replace(FM,`
`).replace(BM,"")}function Ku(t,e,n){if(e=Fx(e),Fx(t)!==e&&n)throw Error(F(425))}function tf(){}var Qm=null,Xm=null;function Zm(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var eg=typeof setTimeout=="function"?setTimeout:void 0,zM=typeof clearTimeout=="function"?clearTimeout:void 0,Bx=typeof Promise=="function"?Promise:void 0,UM=typeof queueMicrotask=="function"?queueMicrotask:typeof Bx<"u"?function(t){return Bx.resolve(null).then(t).catch(VM)}:eg;function VM(t){setTimeout(function(){throw t})}function bp(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),hc(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);hc(e)}function zi(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function zx(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var ll=Math.random().toString(36).slice(2),xr="__reactFiber$"+ll,vc="__reactProps$"+ll,Qr="__reactContainer$"+ll,tg="__reactEvents$"+ll,HM="__reactListeners$"+ll,WM="__reactHandles$"+ll;function No(t){var e=t[xr];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Qr]||n[xr]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=zx(t);t!==null;){if(n=t[xr])return n;t=zx(t)}return e}t=n,n=t.parentNode}return null}function cu(t){return t=t[xr]||t[Qr],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Zs(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(F(33))}function ih(t){return t[vc]||null}var ng=[],ea=-1;function lo(t){return{current:t}}function Pe(t){0>ea||(t.current=ng[ea],ng[ea]=null,ea--)}function Te(t,e){ea++,ng[ea]=t.current,t.current=e}var Zi={},St=lo(Zi),Zt=lo(!1),ss=Zi;function ja(t,e){var n=t.type.contextTypes;if(!n)return Zi;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},o;for(o in n)i[o]=e[o];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function en(t){return t=t.childContextTypes,t!=null}function nf(){Pe(Zt),Pe(St)}function Ux(t,e,n){if(St.current!==Zi)throw Error(F(168));Te(St,e),Te(Zt,n)}function kC(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(F(108,OP(t)||"Unknown",i));return je({},n,r)}function rf(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Zi,ss=St.current,Te(St,t),Te(Zt,Zt.current),!0}function Vx(t,e,n){var r=t.stateNode;if(!r)throw Error(F(169));n?(t=kC(t,e,ss),r.__reactInternalMemoizedMergedChildContext=t,Pe(Zt),Pe(St),Te(St,t)):Pe(Zt),Te(Zt,n)}var Br=null,oh=!1,Sp=!1;function EC(t){Br===null?Br=[t]:Br.push(t)}function KM(t){oh=!0,EC(t)}function co(){if(!Sp&&Br!==null){Sp=!0;var t=0,e=me;try{var n=Br;for(me=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Br=null,oh=!1}catch(i){throw Br!==null&&(Br=Br.slice(t+1)),YS(Jy,co),i}finally{me=e,Sp=!1}}return null}var ta=[],na=0,of=null,sf=0,Tn=[],_n=0,as=null,Vr=1,Hr="";function _o(t,e){ta[na++]=sf,ta[na++]=of,of=t,sf=e}function TC(t,e,n){Tn[_n++]=Vr,Tn[_n++]=Hr,Tn[_n++]=as,as=t;var r=Vr;t=Hr;var i=32-Zn(r)-1;r&=~(1<<i),n+=1;var o=32-Zn(e)+i;if(30<o){var s=i-i%5;o=(r&(1<<s)-1).toString(32),r>>=s,i-=s,Vr=1<<32-Zn(e)+i|n<<i|r,Hr=o+t}else Vr=1<<o|n<<i|r,Hr=t}function iv(t){t.return!==null&&(_o(t,1),TC(t,1,0))}function ov(t){for(;t===of;)of=ta[--na],ta[na]=null,sf=ta[--na],ta[na]=null;for(;t===as;)as=Tn[--_n],Tn[_n]=null,Hr=Tn[--_n],Tn[_n]=null,Vr=Tn[--_n],Tn[_n]=null}var mn=null,hn=null,Ae=!1,Yn=null;function _C(t,e){var n=On(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function Hx(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,mn=t,hn=zi(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,mn=t,hn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=as!==null?{id:Vr,overflow:Hr}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=On(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,mn=t,hn=null,!0):!1;default:return!1}}function rg(t){return(t.mode&1)!==0&&(t.flags&128)===0}function ig(t){if(Ae){var e=hn;if(e){var n=e;if(!Hx(t,e)){if(rg(t))throw Error(F(418));e=zi(n.nextSibling);var r=mn;e&&Hx(t,e)?_C(r,n):(t.flags=t.flags&-4097|2,Ae=!1,mn=t)}}else{if(rg(t))throw Error(F(418));t.flags=t.flags&-4097|2,Ae=!1,mn=t}}}function Wx(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;mn=t}function qu(t){if(t!==mn)return!1;if(!Ae)return Wx(t),Ae=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Zm(t.type,t.memoizedProps)),e&&(e=hn)){if(rg(t))throw RC(),Error(F(418));for(;e;)_C(t,e),e=zi(e.nextSibling)}if(Wx(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(F(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){hn=zi(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}hn=null}}else hn=mn?zi(t.stateNode.nextSibling):null;return!0}function RC(){for(var t=hn;t;)t=zi(t.nextSibling)}function La(){hn=mn=null,Ae=!1}function sv(t){Yn===null?Yn=[t]:Yn.push(t)}var qM=ri.ReactCurrentBatchConfig;function El(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(F(309));var r=n.stateNode}if(!r)throw Error(F(147,t));var i=r,o=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===o?e.ref:(e=function(s){var a=i.refs;s===null?delete a[o]:a[o]=s},e._stringRef=o,e)}if(typeof t!="string")throw Error(F(284));if(!n._owner)throw Error(F(290,t))}return t}function Gu(t,e){throw t=Object.prototype.toString.call(e),Error(F(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Kx(t){var e=t._init;return e(t._payload)}function OC(t){function e(x,w){if(t){var S=x.deletions;S===null?(x.deletions=[w],x.flags|=16):S.push(w)}}function n(x,w){if(!t)return null;for(;w!==null;)e(x,w),w=w.sibling;return null}function r(x,w){for(x=new Map;w!==null;)w.key!==null?x.set(w.key,w):x.set(w.index,w),w=w.sibling;return x}function i(x,w){return x=Wi(x,w),x.index=0,x.sibling=null,x}function o(x,w,S){return x.index=S,t?(S=x.alternate,S!==null?(S=S.index,S<w?(x.flags|=2,w):S):(x.flags|=2,w)):(x.flags|=1048576,w)}function s(x){return t&&x.alternate===null&&(x.flags|=2),x}function a(x,w,S,b){return w===null||w.tag!==6?(w=Op(S,x.mode,b),w.return=x,w):(w=i(w,S),w.return=x,w)}function l(x,w,S,b){var C=S.type;return C===Js?u(x,w,S.props.children,b,S.key):w!==null&&(w.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===mi&&Kx(C)===w.type)?(b=i(w,S.props),b.ref=El(x,w,S),b.return=x,b):(b=Nd(S.type,S.key,S.props,null,x.mode,b),b.ref=El(x,w,S),b.return=x,b)}function c(x,w,S,b){return w===null||w.tag!==4||w.stateNode.containerInfo!==S.containerInfo||w.stateNode.implementation!==S.implementation?(w=Pp(S,x.mode,b),w.return=x,w):(w=i(w,S.children||[]),w.return=x,w)}function u(x,w,S,b,C){return w===null||w.tag!==7?(w=Yo(S,x.mode,b,C),w.return=x,w):(w=i(w,S),w.return=x,w)}function d(x,w,S){if(typeof w=="string"&&w!==""||typeof w=="number")return w=Op(""+w,x.mode,S),w.return=x,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Lu:return S=Nd(w.type,w.key,w.props,null,x.mode,S),S.ref=El(x,null,w),S.return=x,S;case Gs:return w=Pp(w,x.mode,S),w.return=x,w;case mi:var b=w._init;return d(x,b(w._payload),S)}if(Il(w)||wl(w))return w=Yo(w,x.mode,S,null),w.return=x,w;Gu(x,w)}return null}function f(x,w,S,b){var C=w!==null?w.key:null;if(typeof S=="string"&&S!==""||typeof S=="number")return C!==null?null:a(x,w,""+S,b);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case Lu:return S.key===C?l(x,w,S,b):null;case Gs:return S.key===C?c(x,w,S,b):null;case mi:return C=S._init,f(x,w,C(S._payload),b)}if(Il(S)||wl(S))return C!==null?null:u(x,w,S,b,null);Gu(x,S)}return null}function p(x,w,S,b,C){if(typeof b=="string"&&b!==""||typeof b=="number")return x=x.get(S)||null,a(w,x,""+b,C);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Lu:return x=x.get(b.key===null?S:b.key)||null,l(w,x,b,C);case Gs:return x=x.get(b.key===null?S:b.key)||null,c(w,x,b,C);case mi:var k=b._init;return p(x,w,S,k(b._payload),C)}if(Il(b)||wl(b))return x=x.get(S)||null,u(w,x,b,C,null);Gu(w,b)}return null}function m(x,w,S,b){for(var C=null,k=null,E=w,T=w=0,O=null;E!==null&&T<S.length;T++){E.index>T?(O=E,E=null):O=E.sibling;var R=f(x,E,S[T],b);if(R===null){E===null&&(E=O);break}t&&E&&R.alternate===null&&e(x,E),w=o(R,w,T),k===null?C=R:k.sibling=R,k=R,E=O}if(T===S.length)return n(x,E),Ae&&_o(x,T),C;if(E===null){for(;T<S.length;T++)E=d(x,S[T],b),E!==null&&(w=o(E,w,T),k===null?C=E:k.sibling=E,k=E);return Ae&&_o(x,T),C}for(E=r(x,E);T<S.length;T++)O=p(E,x,T,S[T],b),O!==null&&(t&&O.alternate!==null&&E.delete(O.key===null?T:O.key),w=o(O,w,T),k===null?C=O:k.sibling=O,k=O);return t&&E.forEach(function(I){return e(x,I)}),Ae&&_o(x,T),C}function g(x,w,S,b){var C=wl(S);if(typeof C!="function")throw Error(F(150));if(S=C.call(S),S==null)throw Error(F(151));for(var k=C=null,E=w,T=w=0,O=null,R=S.next();E!==null&&!R.done;T++,R=S.next()){E.index>T?(O=E,E=null):O=E.sibling;var I=f(x,E,R.value,b);if(I===null){E===null&&(E=O);break}t&&E&&I.alternate===null&&e(x,E),w=o(I,w,T),k===null?C=I:k.sibling=I,k=I,E=O}if(R.done)return n(x,E),Ae&&_o(x,T),C;if(E===null){for(;!R.done;T++,R=S.next())R=d(x,R.value,b),R!==null&&(w=o(R,w,T),k===null?C=R:k.sibling=R,k=R);return Ae&&_o(x,T),C}for(E=r(x,E);!R.done;T++,R=S.next())R=p(E,x,T,R.value,b),R!==null&&(t&&R.alternate!==null&&E.delete(R.key===null?T:R.key),w=o(R,w,T),k===null?C=R:k.sibling=R,k=R);return t&&E.forEach(function($){return e(x,$)}),Ae&&_o(x,T),C}function v(x,w,S,b){if(typeof S=="object"&&S!==null&&S.type===Js&&S.key===null&&(S=S.props.children),typeof S=="object"&&S!==null){switch(S.$$typeof){case Lu:e:{for(var C=S.key,k=w;k!==null;){if(k.key===C){if(C=S.type,C===Js){if(k.tag===7){n(x,k.sibling),w=i(k,S.props.children),w.return=x,x=w;break e}}else if(k.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===mi&&Kx(C)===k.type){n(x,k.sibling),w=i(k,S.props),w.ref=El(x,k,S),w.return=x,x=w;break e}n(x,k);break}else e(x,k);k=k.sibling}S.type===Js?(w=Yo(S.props.children,x.mode,b,S.key),w.return=x,x=w):(b=Nd(S.type,S.key,S.props,null,x.mode,b),b.ref=El(x,w,S),b.return=x,x=b)}return s(x);case Gs:e:{for(k=S.key;w!==null;){if(w.key===k)if(w.tag===4&&w.stateNode.containerInfo===S.containerInfo&&w.stateNode.implementation===S.implementation){n(x,w.sibling),w=i(w,S.children||[]),w.return=x,x=w;break e}else{n(x,w);break}else e(x,w);w=w.sibling}w=Pp(S,x.mode,b),w.return=x,x=w}return s(x);case mi:return k=S._init,v(x,w,k(S._payload),b)}if(Il(S))return m(x,w,S,b);if(wl(S))return g(x,w,S,b);Gu(x,S)}return typeof S=="string"&&S!==""||typeof S=="number"?(S=""+S,w!==null&&w.tag===6?(n(x,w.sibling),w=i(w,S),w.return=x,x=w):(n(x,w),w=Op(S,x.mode,b),w.return=x,x=w),s(x)):n(x,w)}return v}var $a=OC(!0),PC=OC(!1),af=lo(null),lf=null,ra=null,av=null;function lv(){av=ra=lf=null}function cv(t){var e=af.current;Pe(af),t._currentValue=e}function og(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function fa(t,e){lf=t,av=ra=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Qt=!0),t.firstContext=null)}function jn(t){var e=t._currentValue;if(av!==t)if(t={context:t,memoizedValue:e,next:null},ra===null){if(lf===null)throw Error(F(308));ra=t,lf.dependencies={lanes:0,firstContext:t}}else ra=ra.next=t;return e}var jo=null;function uv(t){jo===null?jo=[t]:jo.push(t)}function MC(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,uv(e)):(n.next=i.next,i.next=n),e.interleaved=n,Xr(t,r)}function Xr(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var gi=!1;function dv(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function AC(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function qr(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Ui(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,he&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,Xr(t,n)}return i=r.interleaved,i===null?(e.next=e,uv(r)):(e.next=i.next,i.next=e),r.interleaved=e,Xr(t,n)}function Od(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Yy(t,n)}}function qx(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,o=null;if(n=n.firstBaseUpdate,n!==null){do{var s={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};o===null?i=o=s:o=o.next=s,n=n.next}while(n!==null);o===null?i=o=e:o=o.next=e}else i=o=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function cf(t,e,n,r){var i=t.updateQueue;gi=!1;var o=i.firstBaseUpdate,s=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var l=a,c=l.next;l.next=null,s===null?o=c:s.next=c,s=l;var u=t.alternate;u!==null&&(u=u.updateQueue,a=u.lastBaseUpdate,a!==s&&(a===null?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(o!==null){var d=i.baseState;s=0,u=c=l=null,a=o;do{var f=a.lane,p=a.eventTime;if((r&f)===f){u!==null&&(u=u.next={eventTime:p,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var m=t,g=a;switch(f=e,p=n,g.tag){case 1:if(m=g.payload,typeof m=="function"){d=m.call(p,d,f);break e}d=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=g.payload,f=typeof m=="function"?m.call(p,d,f):m,f==null)break e;d=je({},d,f);break e;case 2:gi=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,f=i.effects,f===null?i.effects=[a]:f.push(a))}else p={eventTime:p,lane:f,tag:a.tag,payload:a.payload,callback:a.callback,next:null},u===null?(c=u=p,l=d):u=u.next=p,s|=f;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;f=a,a=f.next,f.next=null,i.lastBaseUpdate=f,i.shared.pending=null}}while(1);if(u===null&&(l=d),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=u,e=i.shared.interleaved,e!==null){i=e;do s|=i.lane,i=i.next;while(i!==e)}else o===null&&(i.shared.lanes=0);cs|=s,t.lanes=s,t.memoizedState=d}}function Gx(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(F(191,i));i.call(r)}}}var uu={},Cr=lo(uu),xc=lo(uu),wc=lo(uu);function Lo(t){if(t===uu)throw Error(F(174));return t}function fv(t,e){switch(Te(wc,e),Te(xc,t),Te(Cr,uu),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Fm(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Fm(e,t)}Pe(Cr),Te(Cr,e)}function Fa(){Pe(Cr),Pe(xc),Pe(wc)}function DC(t){Lo(wc.current);var e=Lo(Cr.current),n=Fm(e,t.type);e!==n&&(Te(xc,t),Te(Cr,n))}function hv(t){xc.current===t&&(Pe(Cr),Pe(xc))}var Ie=lo(0);function uf(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Cp=[];function pv(){for(var t=0;t<Cp.length;t++)Cp[t]._workInProgressVersionPrimary=null;Cp.length=0}var Pd=ri.ReactCurrentDispatcher,kp=ri.ReactCurrentBatchConfig,ls=0,Ne=null,Ge=null,Ze=null,df=!1,Jl=!1,bc=0,GM=0;function pt(){throw Error(F(321))}function mv(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!tr(t[n],e[n]))return!1;return!0}function gv(t,e,n,r,i,o){if(ls=o,Ne=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Pd.current=t===null||t.memoizedState===null?XM:ZM,t=n(r,i),Jl){o=0;do{if(Jl=!1,bc=0,25<=o)throw Error(F(301));o+=1,Ze=Ge=null,e.updateQueue=null,Pd.current=eA,t=n(r,i)}while(Jl)}if(Pd.current=ff,e=Ge!==null&&Ge.next!==null,ls=0,Ze=Ge=Ne=null,df=!1,e)throw Error(F(300));return t}function yv(){var t=bc!==0;return bc=0,t}function hr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ze===null?Ne.memoizedState=Ze=t:Ze=Ze.next=t,Ze}function Ln(){if(Ge===null){var t=Ne.alternate;t=t!==null?t.memoizedState:null}else t=Ge.next;var e=Ze===null?Ne.memoizedState:Ze.next;if(e!==null)Ze=e,Ge=t;else{if(t===null)throw Error(F(310));Ge=t,t={memoizedState:Ge.memoizedState,baseState:Ge.baseState,baseQueue:Ge.baseQueue,queue:Ge.queue,next:null},Ze===null?Ne.memoizedState=Ze=t:Ze=Ze.next=t}return Ze}function Sc(t,e){return typeof e=="function"?e(t):e}function Ep(t){var e=Ln(),n=e.queue;if(n===null)throw Error(F(311));n.lastRenderedReducer=t;var r=Ge,i=r.baseQueue,o=n.pending;if(o!==null){if(i!==null){var s=i.next;i.next=o.next,o.next=s}r.baseQueue=i=o,n.pending=null}if(i!==null){o=i.next,r=r.baseState;var a=s=null,l=null,c=o;do{var u=c.lane;if((ls&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:t(r,c.action);else{var d={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(a=l=d,s=r):l=l.next=d,Ne.lanes|=u,cs|=u}c=c.next}while(c!==null&&c!==o);l===null?s=r:l.next=a,tr(r,e.memoizedState)||(Qt=!0),e.memoizedState=r,e.baseState=s,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do o=i.lane,Ne.lanes|=o,cs|=o,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Tp(t){var e=Ln(),n=e.queue;if(n===null)throw Error(F(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,o=e.memoizedState;if(i!==null){n.pending=null;var s=i=i.next;do o=t(o,s.action),s=s.next;while(s!==i);tr(o,e.memoizedState)||(Qt=!0),e.memoizedState=o,e.baseQueue===null&&(e.baseState=o),n.lastRenderedState=o}return[o,r]}function IC(){}function NC(t,e){var n=Ne,r=Ln(),i=e(),o=!tr(r.memoizedState,i);if(o&&(r.memoizedState=i,Qt=!0),r=r.queue,vv($C.bind(null,n,r,t),[t]),r.getSnapshot!==e||o||Ze!==null&&Ze.memoizedState.tag&1){if(n.flags|=2048,Cc(9,LC.bind(null,n,r,i,e),void 0,null),tt===null)throw Error(F(349));ls&30||jC(n,e,i)}return i}function jC(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Ne.updateQueue,e===null?(e={lastEffect:null,stores:null},Ne.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function LC(t,e,n,r){e.value=n,e.getSnapshot=r,FC(e)&&BC(t)}function $C(t,e,n){return n(function(){FC(e)&&BC(t)})}function FC(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!tr(t,n)}catch{return!0}}function BC(t){var e=Xr(t,1);e!==null&&er(e,t,1,-1)}function Jx(t){var e=hr();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Sc,lastRenderedState:t},e.queue=t,t=t.dispatch=QM.bind(null,Ne,t),[e.memoizedState,t]}function Cc(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Ne.updateQueue,e===null?(e={lastEffect:null,stores:null},Ne.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function zC(){return Ln().memoizedState}function Md(t,e,n,r){var i=hr();Ne.flags|=t,i.memoizedState=Cc(1|e,n,void 0,r===void 0?null:r)}function sh(t,e,n,r){var i=Ln();r=r===void 0?null:r;var o=void 0;if(Ge!==null){var s=Ge.memoizedState;if(o=s.destroy,r!==null&&mv(r,s.deps)){i.memoizedState=Cc(e,n,o,r);return}}Ne.flags|=t,i.memoizedState=Cc(1|e,n,o,r)}function Yx(t,e){return Md(8390656,8,t,e)}function vv(t,e){return sh(2048,8,t,e)}function UC(t,e){return sh(4,2,t,e)}function VC(t,e){return sh(4,4,t,e)}function HC(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function WC(t,e,n){return n=n!=null?n.concat([t]):null,sh(4,4,HC.bind(null,e,t),n)}function xv(){}function KC(t,e){var n=Ln();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&mv(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function qC(t,e){var n=Ln();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&mv(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function GC(t,e,n){return ls&21?(tr(n,e)||(n=ZS(),Ne.lanes|=n,cs|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Qt=!0),t.memoizedState=n)}function JM(t,e){var n=me;me=n!==0&&4>n?n:4,t(!0);var r=kp.transition;kp.transition={};try{t(!1),e()}finally{me=n,kp.transition=r}}function JC(){return Ln().memoizedState}function YM(t,e,n){var r=Hi(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},YC(t))QC(e,n);else if(n=MC(t,e,n,r),n!==null){var i=Mt();er(n,t,r,i),XC(n,e,r)}}function QM(t,e,n){var r=Hi(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(YC(t))QC(e,i);else{var o=t.alternate;if(t.lanes===0&&(o===null||o.lanes===0)&&(o=e.lastRenderedReducer,o!==null))try{var s=e.lastRenderedState,a=o(s,n);if(i.hasEagerState=!0,i.eagerState=a,tr(a,s)){var l=e.interleaved;l===null?(i.next=i,uv(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}n=MC(t,e,i,r),n!==null&&(i=Mt(),er(n,t,r,i),XC(n,e,r))}}function YC(t){var e=t.alternate;return t===Ne||e!==null&&e===Ne}function QC(t,e){Jl=df=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function XC(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Yy(t,n)}}var ff={readContext:jn,useCallback:pt,useContext:pt,useEffect:pt,useImperativeHandle:pt,useInsertionEffect:pt,useLayoutEffect:pt,useMemo:pt,useReducer:pt,useRef:pt,useState:pt,useDebugValue:pt,useDeferredValue:pt,useTransition:pt,useMutableSource:pt,useSyncExternalStore:pt,useId:pt,unstable_isNewReconciler:!1},XM={readContext:jn,useCallback:function(t,e){return hr().memoizedState=[t,e===void 0?null:e],t},useContext:jn,useEffect:Yx,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Md(4194308,4,HC.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Md(4194308,4,t,e)},useInsertionEffect:function(t,e){return Md(4,2,t,e)},useMemo:function(t,e){var n=hr();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=hr();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=YM.bind(null,Ne,t),[r.memoizedState,t]},useRef:function(t){var e=hr();return t={current:t},e.memoizedState=t},useState:Jx,useDebugValue:xv,useDeferredValue:function(t){return hr().memoizedState=t},useTransition:function(){var t=Jx(!1),e=t[0];return t=JM.bind(null,t[1]),hr().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Ne,i=hr();if(Ae){if(n===void 0)throw Error(F(407));n=n()}else{if(n=e(),tt===null)throw Error(F(349));ls&30||jC(r,e,n)}i.memoizedState=n;var o={value:n,getSnapshot:e};return i.queue=o,Yx($C.bind(null,r,o,t),[t]),r.flags|=2048,Cc(9,LC.bind(null,r,o,n,e),void 0,null),n},useId:function(){var t=hr(),e=tt.identifierPrefix;if(Ae){var n=Hr,r=Vr;n=(r&~(1<<32-Zn(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=bc++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=GM++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},ZM={readContext:jn,useCallback:KC,useContext:jn,useEffect:vv,useImperativeHandle:WC,useInsertionEffect:UC,useLayoutEffect:VC,useMemo:qC,useReducer:Ep,useRef:zC,useState:function(){return Ep(Sc)},useDebugValue:xv,useDeferredValue:function(t){var e=Ln();return GC(e,Ge.memoizedState,t)},useTransition:function(){var t=Ep(Sc)[0],e=Ln().memoizedState;return[t,e]},useMutableSource:IC,useSyncExternalStore:NC,useId:JC,unstable_isNewReconciler:!1},eA={readContext:jn,useCallback:KC,useContext:jn,useEffect:vv,useImperativeHandle:WC,useInsertionEffect:UC,useLayoutEffect:VC,useMemo:qC,useReducer:Tp,useRef:zC,useState:function(){return Tp(Sc)},useDebugValue:xv,useDeferredValue:function(t){var e=Ln();return Ge===null?e.memoizedState=t:GC(e,Ge.memoizedState,t)},useTransition:function(){var t=Tp(Sc)[0],e=Ln().memoizedState;return[t,e]},useMutableSource:IC,useSyncExternalStore:NC,useId:JC,unstable_isNewReconciler:!1};function Wn(t,e){if(t&&t.defaultProps){e=je({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function sg(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:je({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var ah={isMounted:function(t){return(t=t._reactInternals)?Ss(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Mt(),i=Hi(t),o=qr(r,i);o.payload=e,n!=null&&(o.callback=n),e=Ui(t,o,i),e!==null&&(er(e,t,i,r),Od(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Mt(),i=Hi(t),o=qr(r,i);o.tag=1,o.payload=e,n!=null&&(o.callback=n),e=Ui(t,o,i),e!==null&&(er(e,t,i,r),Od(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Mt(),r=Hi(t),i=qr(n,r);i.tag=2,e!=null&&(i.callback=e),e=Ui(t,i,r),e!==null&&(er(e,t,r,n),Od(e,t,r))}};function Qx(t,e,n,r,i,o,s){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,o,s):e.prototype&&e.prototype.isPureReactComponent?!mc(n,r)||!mc(i,o):!0}function ZC(t,e,n){var r=!1,i=Zi,o=e.contextType;return typeof o=="object"&&o!==null?o=jn(o):(i=en(e)?ss:St.current,r=e.contextTypes,o=(r=r!=null)?ja(t,i):Zi),e=new e(n,o),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=ah,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=o),e}function Xx(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&ah.enqueueReplaceState(e,e.state,null)}function ag(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},dv(t);var o=e.contextType;typeof o=="object"&&o!==null?i.context=jn(o):(o=en(e)?ss:St.current,i.context=ja(t,o)),i.state=t.memoizedState,o=e.getDerivedStateFromProps,typeof o=="function"&&(sg(t,e,o,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&ah.enqueueReplaceState(i,i.state,null),cf(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function Ba(t,e){try{var n="",r=e;do n+=RP(r),r=r.return;while(r);var i=n}catch(o){i=`
Error generating stack: `+o.message+`
`+o.stack}return{value:t,source:e,stack:i,digest:null}}function _p(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function lg(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var tA=typeof WeakMap=="function"?WeakMap:Map;function ek(t,e,n){n=qr(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){pf||(pf=!0,vg=r),lg(t,e)},n}function tk(t,e,n){n=qr(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){lg(t,e)}}var o=t.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(n.callback=function(){lg(t,e),typeof r!="function"&&(Vi===null?Vi=new Set([this]):Vi.add(this));var s=e.stack;this.componentDidCatch(e.value,{componentStack:s!==null?s:""})}),n}function Zx(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new tA;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=mA.bind(null,t,e,n),e.then(t,t))}function ew(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function tw(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=qr(-1,1),e.tag=2,Ui(n,e,1))),n.lanes|=1),t)}var nA=ri.ReactCurrentOwner,Qt=!1;function Pt(t,e,n,r){e.child=t===null?PC(e,null,n,r):$a(e,t.child,n,r)}function nw(t,e,n,r,i){n=n.render;var o=e.ref;return fa(e,i),r=gv(t,e,n,r,o,i),n=yv(),t!==null&&!Qt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Zr(t,e,i)):(Ae&&n&&iv(e),e.flags|=1,Pt(t,e,r,i),e.child)}function rw(t,e,n,r,i){if(t===null){var o=n.type;return typeof o=="function"&&!_v(o)&&o.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=o,nk(t,e,o,r,i)):(t=Nd(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(o=t.child,!(t.lanes&i)){var s=o.memoizedProps;if(n=n.compare,n=n!==null?n:mc,n(s,r)&&t.ref===e.ref)return Zr(t,e,i)}return e.flags|=1,t=Wi(o,r),t.ref=e.ref,t.return=e,e.child=t}function nk(t,e,n,r,i){if(t!==null){var o=t.memoizedProps;if(mc(o,r)&&t.ref===e.ref)if(Qt=!1,e.pendingProps=r=o,(t.lanes&i)!==0)t.flags&131072&&(Qt=!0);else return e.lanes=t.lanes,Zr(t,e,i)}return cg(t,e,n,r,i)}function rk(t,e,n){var r=e.pendingProps,i=r.children,o=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Te(oa,un),un|=n;else{if(!(n&1073741824))return t=o!==null?o.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Te(oa,un),un|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=o!==null?o.baseLanes:n,Te(oa,un),un|=r}else o!==null?(r=o.baseLanes|n,e.memoizedState=null):r=n,Te(oa,un),un|=r;return Pt(t,e,i,n),e.child}function ik(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function cg(t,e,n,r,i){var o=en(n)?ss:St.current;return o=ja(e,o),fa(e,i),n=gv(t,e,n,r,o,i),r=yv(),t!==null&&!Qt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Zr(t,e,i)):(Ae&&r&&iv(e),e.flags|=1,Pt(t,e,n,i),e.child)}function iw(t,e,n,r,i){if(en(n)){var o=!0;rf(e)}else o=!1;if(fa(e,i),e.stateNode===null)Ad(t,e),ZC(e,n,r),ag(e,n,r,i),r=!0;else if(t===null){var s=e.stateNode,a=e.memoizedProps;s.props=a;var l=s.context,c=n.contextType;typeof c=="object"&&c!==null?c=jn(c):(c=en(n)?ss:St.current,c=ja(e,c));var u=n.getDerivedStateFromProps,d=typeof u=="function"||typeof s.getSnapshotBeforeUpdate=="function";d||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(a!==r||l!==c)&&Xx(e,s,r,c),gi=!1;var f=e.memoizedState;s.state=f,cf(e,r,s,i),l=e.memoizedState,a!==r||f!==l||Zt.current||gi?(typeof u=="function"&&(sg(e,n,u,r),l=e.memoizedState),(a=gi||Qx(e,n,a,r,f,l,c))?(d||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(e.flags|=4194308)):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),s.props=r,s.state=l,s.context=c,r=a):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{s=e.stateNode,AC(t,e),a=e.memoizedProps,c=e.type===e.elementType?a:Wn(e.type,a),s.props=c,d=e.pendingProps,f=s.context,l=n.contextType,typeof l=="object"&&l!==null?l=jn(l):(l=en(n)?ss:St.current,l=ja(e,l));var p=n.getDerivedStateFromProps;(u=typeof p=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(a!==d||f!==l)&&Xx(e,s,r,l),gi=!1,f=e.memoizedState,s.state=f,cf(e,r,s,i);var m=e.memoizedState;a!==d||f!==m||Zt.current||gi?(typeof p=="function"&&(sg(e,n,p,r),m=e.memoizedState),(c=gi||Qx(e,n,c,r,f,m,l)||!1)?(u||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(r,m,l),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(r,m,l)),typeof s.componentDidUpdate=="function"&&(e.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof s.componentDidUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=m),s.props=r,s.state=m,s.context=l,r=c):(typeof s.componentDidUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),r=!1)}return ug(t,e,n,r,o,i)}function ug(t,e,n,r,i,o){ik(t,e);var s=(e.flags&128)!==0;if(!r&&!s)return i&&Vx(e,n,!1),Zr(t,e,o);r=e.stateNode,nA.current=e;var a=s&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&s?(e.child=$a(e,t.child,null,o),e.child=$a(e,null,a,o)):Pt(t,e,a,o),e.memoizedState=r.state,i&&Vx(e,n,!0),e.child}function ok(t){var e=t.stateNode;e.pendingContext?Ux(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Ux(t,e.context,!1),fv(t,e.containerInfo)}function ow(t,e,n,r,i){return La(),sv(i),e.flags|=256,Pt(t,e,n,r),e.child}var dg={dehydrated:null,treeContext:null,retryLane:0};function fg(t){return{baseLanes:t,cachePool:null,transitions:null}}function sk(t,e,n){var r=e.pendingProps,i=Ie.current,o=!1,s=(e.flags&128)!==0,a;if((a=s)||(a=t!==null&&t.memoizedState===null?!1:(i&2)!==0),a?(o=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),Te(Ie,i&1),t===null)return ig(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(s=r.children,t=r.fallback,o?(r=e.mode,o=e.child,s={mode:"hidden",children:s},!(r&1)&&o!==null?(o.childLanes=0,o.pendingProps=s):o=uh(s,r,0,null),t=Yo(t,r,n,null),o.return=e,t.return=e,o.sibling=t,e.child=o,e.child.memoizedState=fg(n),e.memoizedState=dg,t):wv(e,s));if(i=t.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return rA(t,e,s,r,a,i,n);if(o){o=r.fallback,s=e.mode,i=t.child,a=i.sibling;var l={mode:"hidden",children:r.children};return!(s&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=Wi(i,l),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?o=Wi(a,o):(o=Yo(o,s,n,null),o.flags|=2),o.return=e,r.return=e,r.sibling=o,e.child=r,r=o,o=e.child,s=t.child.memoizedState,s=s===null?fg(n):{baseLanes:s.baseLanes|n,cachePool:null,transitions:s.transitions},o.memoizedState=s,o.childLanes=t.childLanes&~n,e.memoizedState=dg,r}return o=t.child,t=o.sibling,r=Wi(o,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function wv(t,e){return e=uh({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Ju(t,e,n,r){return r!==null&&sv(r),$a(e,t.child,null,n),t=wv(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function rA(t,e,n,r,i,o,s){if(n)return e.flags&256?(e.flags&=-257,r=_p(Error(F(422))),Ju(t,e,s,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(o=r.fallback,i=e.mode,r=uh({mode:"visible",children:r.children},i,0,null),o=Yo(o,i,s,null),o.flags|=2,r.return=e,o.return=e,r.sibling=o,e.child=r,e.mode&1&&$a(e,t.child,null,s),e.child.memoizedState=fg(s),e.memoizedState=dg,o);if(!(e.mode&1))return Ju(t,e,s,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,o=Error(F(419)),r=_p(o,r,void 0),Ju(t,e,s,r)}if(a=(s&t.childLanes)!==0,Qt||a){if(r=tt,r!==null){switch(s&-s){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|s)?0:i,i!==0&&i!==o.retryLane&&(o.retryLane=i,Xr(t,i),er(r,t,i,-1))}return Tv(),r=_p(Error(F(421))),Ju(t,e,s,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=gA.bind(null,t),i._reactRetry=e,null):(t=o.treeContext,hn=zi(i.nextSibling),mn=e,Ae=!0,Yn=null,t!==null&&(Tn[_n++]=Vr,Tn[_n++]=Hr,Tn[_n++]=as,Vr=t.id,Hr=t.overflow,as=e),e=wv(e,r.children),e.flags|=4096,e)}function sw(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),og(t.return,e,n)}function Rp(t,e,n,r,i){var o=t.memoizedState;o===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(o.isBackwards=e,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=i)}function ak(t,e,n){var r=e.pendingProps,i=r.revealOrder,o=r.tail;if(Pt(t,e,r.children,n),r=Ie.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&sw(t,n,e);else if(t.tag===19)sw(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Te(Ie,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&uf(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),Rp(e,!1,i,n,o);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&uf(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}Rp(e,!0,n,null,o);break;case"together":Rp(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Ad(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Zr(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),cs|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(F(153));if(e.child!==null){for(t=e.child,n=Wi(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Wi(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function iA(t,e,n){switch(e.tag){case 3:ok(e),La();break;case 5:DC(e);break;case 1:en(e.type)&&rf(e);break;case 4:fv(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;Te(af,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Te(Ie,Ie.current&1),e.flags|=128,null):n&e.child.childLanes?sk(t,e,n):(Te(Ie,Ie.current&1),t=Zr(t,e,n),t!==null?t.sibling:null);Te(Ie,Ie.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return ak(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Te(Ie,Ie.current),r)break;return null;case 22:case 23:return e.lanes=0,rk(t,e,n)}return Zr(t,e,n)}var lk,hg,ck,uk;lk=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};hg=function(){};ck=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,Lo(Cr.current);var o=null;switch(n){case"input":i=Nm(t,i),r=Nm(t,r),o=[];break;case"select":i=je({},i,{value:void 0}),r=je({},r,{value:void 0}),o=[];break;case"textarea":i=$m(t,i),r=$m(t,r),o=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=tf)}Bm(n,r);var s;n=null;for(c in i)if(!r.hasOwnProperty(c)&&i.hasOwnProperty(c)&&i[c]!=null)if(c==="style"){var a=i[c];for(s in a)a.hasOwnProperty(s)&&(n||(n={}),n[s]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(lc.hasOwnProperty(c)?o||(o=[]):(o=o||[]).push(c,null));for(c in r){var l=r[c];if(a=i!=null?i[c]:void 0,r.hasOwnProperty(c)&&l!==a&&(l!=null||a!=null))if(c==="style")if(a){for(s in a)!a.hasOwnProperty(s)||l&&l.hasOwnProperty(s)||(n||(n={}),n[s]="");for(s in l)l.hasOwnProperty(s)&&a[s]!==l[s]&&(n||(n={}),n[s]=l[s])}else n||(o||(o=[]),o.push(c,n)),n=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(o=o||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(o=o||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(lc.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&Oe("scroll",t),o||a===l||(o=[])):(o=o||[]).push(c,l))}n&&(o=o||[]).push("style",n);var c=o;(e.updateQueue=c)&&(e.flags|=4)}};uk=function(t,e,n,r){n!==r&&(e.flags|=4)};function Tl(t,e){if(!Ae)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function mt(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function oA(t,e,n){var r=e.pendingProps;switch(ov(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return mt(e),null;case 1:return en(e.type)&&nf(),mt(e),null;case 3:return r=e.stateNode,Fa(),Pe(Zt),Pe(St),pv(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(qu(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Yn!==null&&(bg(Yn),Yn=null))),hg(t,e),mt(e),null;case 5:hv(e);var i=Lo(wc.current);if(n=e.type,t!==null&&e.stateNode!=null)ck(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(F(166));return mt(e),null}if(t=Lo(Cr.current),qu(e)){r=e.stateNode,n=e.type;var o=e.memoizedProps;switch(r[xr]=e,r[vc]=o,t=(e.mode&1)!==0,n){case"dialog":Oe("cancel",r),Oe("close",r);break;case"iframe":case"object":case"embed":Oe("load",r);break;case"video":case"audio":for(i=0;i<jl.length;i++)Oe(jl[i],r);break;case"source":Oe("error",r);break;case"img":case"image":case"link":Oe("error",r),Oe("load",r);break;case"details":Oe("toggle",r);break;case"input":mx(r,o),Oe("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},Oe("invalid",r);break;case"textarea":yx(r,o),Oe("invalid",r)}Bm(n,o),i=null;for(var s in o)if(o.hasOwnProperty(s)){var a=o[s];s==="children"?typeof a=="string"?r.textContent!==a&&(o.suppressHydrationWarning!==!0&&Ku(r.textContent,a,t),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(o.suppressHydrationWarning!==!0&&Ku(r.textContent,a,t),i=["children",""+a]):lc.hasOwnProperty(s)&&a!=null&&s==="onScroll"&&Oe("scroll",r)}switch(n){case"input":$u(r),gx(r,o,!0);break;case"textarea":$u(r),vx(r);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(r.onclick=tf)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{s=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=$S(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=s.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=s.createElement(n,{is:r.is}):(t=s.createElement(n),n==="select"&&(s=t,r.multiple?s.multiple=!0:r.size&&(s.size=r.size))):t=s.createElementNS(t,n),t[xr]=e,t[vc]=r,lk(t,e,!1,!1),e.stateNode=t;e:{switch(s=zm(n,r),n){case"dialog":Oe("cancel",t),Oe("close",t),i=r;break;case"iframe":case"object":case"embed":Oe("load",t),i=r;break;case"video":case"audio":for(i=0;i<jl.length;i++)Oe(jl[i],t);i=r;break;case"source":Oe("error",t),i=r;break;case"img":case"image":case"link":Oe("error",t),Oe("load",t),i=r;break;case"details":Oe("toggle",t),i=r;break;case"input":mx(t,r),i=Nm(t,r),Oe("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=je({},r,{value:void 0}),Oe("invalid",t);break;case"textarea":yx(t,r),i=$m(t,r),Oe("invalid",t);break;default:i=r}Bm(n,i),a=i;for(o in a)if(a.hasOwnProperty(o)){var l=a[o];o==="style"?zS(t,l):o==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&FS(t,l)):o==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&cc(t,l):typeof l=="number"&&cc(t,""+l):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(lc.hasOwnProperty(o)?l!=null&&o==="onScroll"&&Oe("scroll",t):l!=null&&Hy(t,o,l,s))}switch(n){case"input":$u(t),gx(t,r,!1);break;case"textarea":$u(t),vx(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Xi(r.value));break;case"select":t.multiple=!!r.multiple,o=r.value,o!=null?la(t,!!r.multiple,o,!1):r.defaultValue!=null&&la(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=tf)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return mt(e),null;case 6:if(t&&e.stateNode!=null)uk(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(F(166));if(n=Lo(wc.current),Lo(Cr.current),qu(e)){if(r=e.stateNode,n=e.memoizedProps,r[xr]=e,(o=r.nodeValue!==n)&&(t=mn,t!==null))switch(t.tag){case 3:Ku(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Ku(r.nodeValue,n,(t.mode&1)!==0)}o&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[xr]=e,e.stateNode=r}return mt(e),null;case 13:if(Pe(Ie),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Ae&&hn!==null&&e.mode&1&&!(e.flags&128))RC(),La(),e.flags|=98560,o=!1;else if(o=qu(e),r!==null&&r.dehydrated!==null){if(t===null){if(!o)throw Error(F(318));if(o=e.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(F(317));o[xr]=e}else La(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;mt(e),o=!1}else Yn!==null&&(bg(Yn),Yn=null),o=!0;if(!o)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Ie.current&1?Ye===0&&(Ye=3):Tv())),e.updateQueue!==null&&(e.flags|=4),mt(e),null);case 4:return Fa(),hg(t,e),t===null&&gc(e.stateNode.containerInfo),mt(e),null;case 10:return cv(e.type._context),mt(e),null;case 17:return en(e.type)&&nf(),mt(e),null;case 19:if(Pe(Ie),o=e.memoizedState,o===null)return mt(e),null;if(r=(e.flags&128)!==0,s=o.rendering,s===null)if(r)Tl(o,!1);else{if(Ye!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(s=uf(t),s!==null){for(e.flags|=128,Tl(o,!1),r=s.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)o=n,t=r,o.flags&=14680066,s=o.alternate,s===null?(o.childLanes=0,o.lanes=t,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=s.childLanes,o.lanes=s.lanes,o.child=s.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=s.memoizedProps,o.memoizedState=s.memoizedState,o.updateQueue=s.updateQueue,o.type=s.type,t=s.dependencies,o.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Te(Ie,Ie.current&1|2),e.child}t=t.sibling}o.tail!==null&&Ve()>za&&(e.flags|=128,r=!0,Tl(o,!1),e.lanes=4194304)}else{if(!r)if(t=uf(s),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Tl(o,!0),o.tail===null&&o.tailMode==="hidden"&&!s.alternate&&!Ae)return mt(e),null}else 2*Ve()-o.renderingStartTime>za&&n!==1073741824&&(e.flags|=128,r=!0,Tl(o,!1),e.lanes=4194304);o.isBackwards?(s.sibling=e.child,e.child=s):(n=o.last,n!==null?n.sibling=s:e.child=s,o.last=s)}return o.tail!==null?(e=o.tail,o.rendering=e,o.tail=e.sibling,o.renderingStartTime=Ve(),e.sibling=null,n=Ie.current,Te(Ie,r?n&1|2:n&1),e):(mt(e),null);case 22:case 23:return Ev(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?un&1073741824&&(mt(e),e.subtreeFlags&6&&(e.flags|=8192)):mt(e),null;case 24:return null;case 25:return null}throw Error(F(156,e.tag))}function sA(t,e){switch(ov(e),e.tag){case 1:return en(e.type)&&nf(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Fa(),Pe(Zt),Pe(St),pv(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return hv(e),null;case 13:if(Pe(Ie),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(F(340));La()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Pe(Ie),null;case 4:return Fa(),null;case 10:return cv(e.type._context),null;case 22:case 23:return Ev(),null;case 24:return null;default:return null}}var Yu=!1,wt=!1,aA=typeof WeakSet=="function"?WeakSet:Set,W=null;function ia(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){$e(t,e,r)}else n.current=null}function pg(t,e,n){try{n()}catch(r){$e(t,e,r)}}var aw=!1;function lA(t,e){if(Qm=Xd,t=mC(),rv(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch{n=null;break e}var s=0,a=-1,l=-1,c=0,u=0,d=t,f=null;t:for(;;){for(var p;d!==n||i!==0&&d.nodeType!==3||(a=s+i),d!==o||r!==0&&d.nodeType!==3||(l=s+r),d.nodeType===3&&(s+=d.nodeValue.length),(p=d.firstChild)!==null;)f=d,d=p;for(;;){if(d===t)break t;if(f===n&&++c===i&&(a=s),f===o&&++u===r&&(l=s),(p=d.nextSibling)!==null)break;d=f,f=d.parentNode}d=p}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(Xm={focusedElem:t,selectionRange:n},Xd=!1,W=e;W!==null;)if(e=W,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,W=t;else for(;W!==null;){e=W;try{var m=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(m!==null){var g=m.memoizedProps,v=m.memoizedState,x=e.stateNode,w=x.getSnapshotBeforeUpdate(e.elementType===e.type?g:Wn(e.type,g),v);x.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var S=e.stateNode.containerInfo;S.nodeType===1?S.textContent="":S.nodeType===9&&S.documentElement&&S.removeChild(S.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(F(163))}}catch(b){$e(e,e.return,b)}if(t=e.sibling,t!==null){t.return=e.return,W=t;break}W=e.return}return m=aw,aw=!1,m}function Yl(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var o=i.destroy;i.destroy=void 0,o!==void 0&&pg(e,n,o)}i=i.next}while(i!==r)}}function lh(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function mg(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function dk(t){var e=t.alternate;e!==null&&(t.alternate=null,dk(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[xr],delete e[vc],delete e[tg],delete e[HM],delete e[WM])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function fk(t){return t.tag===5||t.tag===3||t.tag===4}function lw(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||fk(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function gg(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=tf));else if(r!==4&&(t=t.child,t!==null))for(gg(t,e,n),t=t.sibling;t!==null;)gg(t,e,n),t=t.sibling}function yg(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(yg(t,e,n),t=t.sibling;t!==null;)yg(t,e,n),t=t.sibling}var at=null,Gn=!1;function oi(t,e,n){for(n=n.child;n!==null;)hk(t,e,n),n=n.sibling}function hk(t,e,n){if(Sr&&typeof Sr.onCommitFiberUnmount=="function")try{Sr.onCommitFiberUnmount(eh,n)}catch{}switch(n.tag){case 5:wt||ia(n,e);case 6:var r=at,i=Gn;at=null,oi(t,e,n),at=r,Gn=i,at!==null&&(Gn?(t=at,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):at.removeChild(n.stateNode));break;case 18:at!==null&&(Gn?(t=at,n=n.stateNode,t.nodeType===8?bp(t.parentNode,n):t.nodeType===1&&bp(t,n),hc(t)):bp(at,n.stateNode));break;case 4:r=at,i=Gn,at=n.stateNode.containerInfo,Gn=!0,oi(t,e,n),at=r,Gn=i;break;case 0:case 11:case 14:case 15:if(!wt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var o=i,s=o.destroy;o=o.tag,s!==void 0&&(o&2||o&4)&&pg(n,e,s),i=i.next}while(i!==r)}oi(t,e,n);break;case 1:if(!wt&&(ia(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){$e(n,e,a)}oi(t,e,n);break;case 21:oi(t,e,n);break;case 22:n.mode&1?(wt=(r=wt)||n.memoizedState!==null,oi(t,e,n),wt=r):oi(t,e,n);break;default:oi(t,e,n)}}function cw(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new aA),e.forEach(function(r){var i=yA.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function Hn(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var o=t,s=e,a=s;e:for(;a!==null;){switch(a.tag){case 5:at=a.stateNode,Gn=!1;break e;case 3:at=a.stateNode.containerInfo,Gn=!0;break e;case 4:at=a.stateNode.containerInfo,Gn=!0;break e}a=a.return}if(at===null)throw Error(F(160));hk(o,s,i),at=null,Gn=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(c){$e(i,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)pk(e,t),e=e.sibling}function pk(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Hn(e,t),ur(t),r&4){try{Yl(3,t,t.return),lh(3,t)}catch(g){$e(t,t.return,g)}try{Yl(5,t,t.return)}catch(g){$e(t,t.return,g)}}break;case 1:Hn(e,t),ur(t),r&512&&n!==null&&ia(n,n.return);break;case 5:if(Hn(e,t),ur(t),r&512&&n!==null&&ia(n,n.return),t.flags&32){var i=t.stateNode;try{cc(i,"")}catch(g){$e(t,t.return,g)}}if(r&4&&(i=t.stateNode,i!=null)){var o=t.memoizedProps,s=n!==null?n.memoizedProps:o,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&o.type==="radio"&&o.name!=null&&jS(i,o),zm(a,s);var c=zm(a,o);for(s=0;s<l.length;s+=2){var u=l[s],d=l[s+1];u==="style"?zS(i,d):u==="dangerouslySetInnerHTML"?FS(i,d):u==="children"?cc(i,d):Hy(i,u,d,c)}switch(a){case"input":jm(i,o);break;case"textarea":LS(i,o);break;case"select":var f=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!o.multiple;var p=o.value;p!=null?la(i,!!o.multiple,p,!1):f!==!!o.multiple&&(o.defaultValue!=null?la(i,!!o.multiple,o.defaultValue,!0):la(i,!!o.multiple,o.multiple?[]:"",!1))}i[vc]=o}catch(g){$e(t,t.return,g)}}break;case 6:if(Hn(e,t),ur(t),r&4){if(t.stateNode===null)throw Error(F(162));i=t.stateNode,o=t.memoizedProps;try{i.nodeValue=o}catch(g){$e(t,t.return,g)}}break;case 3:if(Hn(e,t),ur(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{hc(e.containerInfo)}catch(g){$e(t,t.return,g)}break;case 4:Hn(e,t),ur(t);break;case 13:Hn(e,t),ur(t),i=t.child,i.flags&8192&&(o=i.memoizedState!==null,i.stateNode.isHidden=o,!o||i.alternate!==null&&i.alternate.memoizedState!==null||(Cv=Ve())),r&4&&cw(t);break;case 22:if(u=n!==null&&n.memoizedState!==null,t.mode&1?(wt=(c=wt)||u,Hn(e,t),wt=c):Hn(e,t),ur(t),r&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!u&&t.mode&1)for(W=t,u=t.child;u!==null;){for(d=W=u;W!==null;){switch(f=W,p=f.child,f.tag){case 0:case 11:case 14:case 15:Yl(4,f,f.return);break;case 1:ia(f,f.return);var m=f.stateNode;if(typeof m.componentWillUnmount=="function"){r=f,n=f.return;try{e=r,m.props=e.memoizedProps,m.state=e.memoizedState,m.componentWillUnmount()}catch(g){$e(r,n,g)}}break;case 5:ia(f,f.return);break;case 22:if(f.memoizedState!==null){dw(d);continue}}p!==null?(p.return=f,W=p):dw(d)}u=u.sibling}e:for(u=null,d=t;;){if(d.tag===5){if(u===null){u=d;try{i=d.stateNode,c?(o=i.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(a=d.stateNode,l=d.memoizedProps.style,s=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=BS("display",s))}catch(g){$e(t,t.return,g)}}}else if(d.tag===6){if(u===null)try{d.stateNode.nodeValue=c?"":d.memoizedProps}catch(g){$e(t,t.return,g)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===t)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===t)break e;for(;d.sibling===null;){if(d.return===null||d.return===t)break e;u===d&&(u=null),d=d.return}u===d&&(u=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:Hn(e,t),ur(t),r&4&&cw(t);break;case 21:break;default:Hn(e,t),ur(t)}}function ur(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(fk(n)){var r=n;break e}n=n.return}throw Error(F(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(cc(i,""),r.flags&=-33);var o=lw(t);yg(t,o,i);break;case 3:case 4:var s=r.stateNode.containerInfo,a=lw(t);gg(t,a,s);break;default:throw Error(F(161))}}catch(l){$e(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function cA(t,e,n){W=t,mk(t)}function mk(t,e,n){for(var r=(t.mode&1)!==0;W!==null;){var i=W,o=i.child;if(i.tag===22&&r){var s=i.memoizedState!==null||Yu;if(!s){var a=i.alternate,l=a!==null&&a.memoizedState!==null||wt;a=Yu;var c=wt;if(Yu=s,(wt=l)&&!c)for(W=i;W!==null;)s=W,l=s.child,s.tag===22&&s.memoizedState!==null?fw(i):l!==null?(l.return=s,W=l):fw(i);for(;o!==null;)W=o,mk(o),o=o.sibling;W=i,Yu=a,wt=c}uw(t)}else i.subtreeFlags&8772&&o!==null?(o.return=i,W=o):uw(t)}}function uw(t){for(;W!==null;){var e=W;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:wt||lh(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!wt)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:Wn(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=e.updateQueue;o!==null&&Gx(e,o,r);break;case 3:var s=e.updateQueue;if(s!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}Gx(e,s,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var d=u.dehydrated;d!==null&&hc(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(F(163))}wt||e.flags&512&&mg(e)}catch(f){$e(e,e.return,f)}}if(e===t){W=null;break}if(n=e.sibling,n!==null){n.return=e.return,W=n;break}W=e.return}}function dw(t){for(;W!==null;){var e=W;if(e===t){W=null;break}var n=e.sibling;if(n!==null){n.return=e.return,W=n;break}W=e.return}}function fw(t){for(;W!==null;){var e=W;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{lh(4,e)}catch(l){$e(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(l){$e(e,i,l)}}var o=e.return;try{mg(e)}catch(l){$e(e,o,l)}break;case 5:var s=e.return;try{mg(e)}catch(l){$e(e,s,l)}}}catch(l){$e(e,e.return,l)}if(e===t){W=null;break}var a=e.sibling;if(a!==null){a.return=e.return,W=a;break}W=e.return}}var uA=Math.ceil,hf=ri.ReactCurrentDispatcher,bv=ri.ReactCurrentOwner,Pn=ri.ReactCurrentBatchConfig,he=0,tt=null,We=null,dt=0,un=0,oa=lo(0),Ye=0,kc=null,cs=0,ch=0,Sv=0,Ql=null,Jt=null,Cv=0,za=1/0,Lr=null,pf=!1,vg=null,Vi=null,Qu=!1,Ii=null,mf=0,Xl=0,xg=null,Dd=-1,Id=0;function Mt(){return he&6?Ve():Dd!==-1?Dd:Dd=Ve()}function Hi(t){return t.mode&1?he&2&&dt!==0?dt&-dt:qM.transition!==null?(Id===0&&(Id=ZS()),Id):(t=me,t!==0||(t=window.event,t=t===void 0?16:sC(t.type)),t):1}function er(t,e,n,r){if(50<Xl)throw Xl=0,xg=null,Error(F(185));au(t,n,r),(!(he&2)||t!==tt)&&(t===tt&&(!(he&2)&&(ch|=n),Ye===4&&bi(t,dt)),tn(t,r),n===1&&he===0&&!(e.mode&1)&&(za=Ve()+500,oh&&co()))}function tn(t,e){var n=t.callbackNode;qP(t,e);var r=Qd(t,t===tt?dt:0);if(r===0)n!==null&&bx(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&bx(n),e===1)t.tag===0?KM(hw.bind(null,t)):EC(hw.bind(null,t)),UM(function(){!(he&6)&&co()}),n=null;else{switch(eC(r)){case 1:n=Jy;break;case 4:n=QS;break;case 16:n=Yd;break;case 536870912:n=XS;break;default:n=Yd}n=Ck(n,gk.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function gk(t,e){if(Dd=-1,Id=0,he&6)throw Error(F(327));var n=t.callbackNode;if(ha()&&t.callbackNode!==n)return null;var r=Qd(t,t===tt?dt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=gf(t,r);else{e=r;var i=he;he|=2;var o=vk();(tt!==t||dt!==e)&&(Lr=null,za=Ve()+500,Jo(t,e));do try{hA();break}catch(a){yk(t,a)}while(1);lv(),hf.current=o,he=i,We!==null?e=0:(tt=null,dt=0,e=Ye)}if(e!==0){if(e===2&&(i=Km(t),i!==0&&(r=i,e=wg(t,i))),e===1)throw n=kc,Jo(t,0),bi(t,r),tn(t,Ve()),n;if(e===6)bi(t,r);else{if(i=t.current.alternate,!(r&30)&&!dA(i)&&(e=gf(t,r),e===2&&(o=Km(t),o!==0&&(r=o,e=wg(t,o))),e===1))throw n=kc,Jo(t,0),bi(t,r),tn(t,Ve()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(F(345));case 2:Ro(t,Jt,Lr);break;case 3:if(bi(t,r),(r&130023424)===r&&(e=Cv+500-Ve(),10<e)){if(Qd(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){Mt(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=eg(Ro.bind(null,t,Jt,Lr),e);break}Ro(t,Jt,Lr);break;case 4:if(bi(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var s=31-Zn(r);o=1<<s,s=e[s],s>i&&(i=s),r&=~o}if(r=i,r=Ve()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*uA(r/1960))-r,10<r){t.timeoutHandle=eg(Ro.bind(null,t,Jt,Lr),r);break}Ro(t,Jt,Lr);break;case 5:Ro(t,Jt,Lr);break;default:throw Error(F(329))}}}return tn(t,Ve()),t.callbackNode===n?gk.bind(null,t):null}function wg(t,e){var n=Ql;return t.current.memoizedState.isDehydrated&&(Jo(t,e).flags|=256),t=gf(t,e),t!==2&&(e=Jt,Jt=n,e!==null&&bg(e)),t}function bg(t){Jt===null?Jt=t:Jt.push.apply(Jt,t)}function dA(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],o=i.getSnapshot;i=i.value;try{if(!tr(o(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function bi(t,e){for(e&=~Sv,e&=~ch,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Zn(e),r=1<<n;t[n]=-1,e&=~r}}function hw(t){if(he&6)throw Error(F(327));ha();var e=Qd(t,0);if(!(e&1))return tn(t,Ve()),null;var n=gf(t,e);if(t.tag!==0&&n===2){var r=Km(t);r!==0&&(e=r,n=wg(t,r))}if(n===1)throw n=kc,Jo(t,0),bi(t,e),tn(t,Ve()),n;if(n===6)throw Error(F(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Ro(t,Jt,Lr),tn(t,Ve()),null}function kv(t,e){var n=he;he|=1;try{return t(e)}finally{he=n,he===0&&(za=Ve()+500,oh&&co())}}function us(t){Ii!==null&&Ii.tag===0&&!(he&6)&&ha();var e=he;he|=1;var n=Pn.transition,r=me;try{if(Pn.transition=null,me=1,t)return t()}finally{me=r,Pn.transition=n,he=e,!(he&6)&&co()}}function Ev(){un=oa.current,Pe(oa)}function Jo(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,zM(n)),We!==null)for(n=We.return;n!==null;){var r=n;switch(ov(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&nf();break;case 3:Fa(),Pe(Zt),Pe(St),pv();break;case 5:hv(r);break;case 4:Fa();break;case 13:Pe(Ie);break;case 19:Pe(Ie);break;case 10:cv(r.type._context);break;case 22:case 23:Ev()}n=n.return}if(tt=t,We=t=Wi(t.current,null),dt=un=e,Ye=0,kc=null,Sv=ch=cs=0,Jt=Ql=null,jo!==null){for(e=0;e<jo.length;e++)if(n=jo[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,o=n.pending;if(o!==null){var s=o.next;o.next=i,r.next=s}n.pending=r}jo=null}return t}function yk(t,e){do{var n=We;try{if(lv(),Pd.current=ff,df){for(var r=Ne.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}df=!1}if(ls=0,Ze=Ge=Ne=null,Jl=!1,bc=0,bv.current=null,n===null||n.return===null){Ye=1,kc=e,We=null;break}e:{var o=t,s=n.return,a=n,l=e;if(e=dt,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=a,d=u.tag;if(!(u.mode&1)&&(d===0||d===11||d===15)){var f=u.alternate;f?(u.updateQueue=f.updateQueue,u.memoizedState=f.memoizedState,u.lanes=f.lanes):(u.updateQueue=null,u.memoizedState=null)}var p=ew(s);if(p!==null){p.flags&=-257,tw(p,s,a,o,e),p.mode&1&&Zx(o,c,e),e=p,l=c;var m=e.updateQueue;if(m===null){var g=new Set;g.add(l),e.updateQueue=g}else m.add(l);break e}else{if(!(e&1)){Zx(o,c,e),Tv();break e}l=Error(F(426))}}else if(Ae&&a.mode&1){var v=ew(s);if(v!==null){!(v.flags&65536)&&(v.flags|=256),tw(v,s,a,o,e),sv(Ba(l,a));break e}}o=l=Ba(l,a),Ye!==4&&(Ye=2),Ql===null?Ql=[o]:Ql.push(o),o=s;do{switch(o.tag){case 3:o.flags|=65536,e&=-e,o.lanes|=e;var x=ek(o,l,e);qx(o,x);break e;case 1:a=l;var w=o.type,S=o.stateNode;if(!(o.flags&128)&&(typeof w.getDerivedStateFromError=="function"||S!==null&&typeof S.componentDidCatch=="function"&&(Vi===null||!Vi.has(S)))){o.flags|=65536,e&=-e,o.lanes|=e;var b=tk(o,a,e);qx(o,b);break e}}o=o.return}while(o!==null)}wk(n)}catch(C){e=C,We===n&&n!==null&&(We=n=n.return);continue}break}while(1)}function vk(){var t=hf.current;return hf.current=ff,t===null?ff:t}function Tv(){(Ye===0||Ye===3||Ye===2)&&(Ye=4),tt===null||!(cs&268435455)&&!(ch&268435455)||bi(tt,dt)}function gf(t,e){var n=he;he|=2;var r=vk();(tt!==t||dt!==e)&&(Lr=null,Jo(t,e));do try{fA();break}catch(i){yk(t,i)}while(1);if(lv(),he=n,hf.current=r,We!==null)throw Error(F(261));return tt=null,dt=0,Ye}function fA(){for(;We!==null;)xk(We)}function hA(){for(;We!==null&&!$P();)xk(We)}function xk(t){var e=Sk(t.alternate,t,un);t.memoizedProps=t.pendingProps,e===null?wk(t):We=e,bv.current=null}function wk(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=sA(n,e),n!==null){n.flags&=32767,We=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Ye=6,We=null;return}}else if(n=oA(n,e,un),n!==null){We=n;return}if(e=e.sibling,e!==null){We=e;return}We=e=t}while(e!==null);Ye===0&&(Ye=5)}function Ro(t,e,n){var r=me,i=Pn.transition;try{Pn.transition=null,me=1,pA(t,e,n,r)}finally{Pn.transition=i,me=r}return null}function pA(t,e,n,r){do ha();while(Ii!==null);if(he&6)throw Error(F(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(F(177));t.callbackNode=null,t.callbackPriority=0;var o=n.lanes|n.childLanes;if(GP(t,o),t===tt&&(We=tt=null,dt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Qu||(Qu=!0,Ck(Yd,function(){return ha(),null})),o=(n.flags&15990)!==0,n.subtreeFlags&15990||o){o=Pn.transition,Pn.transition=null;var s=me;me=1;var a=he;he|=4,bv.current=null,lA(t,n),pk(n,t),IM(Xm),Xd=!!Qm,Xm=Qm=null,t.current=n,cA(n),FP(),he=a,me=s,Pn.transition=o}else t.current=n;if(Qu&&(Qu=!1,Ii=t,mf=i),o=t.pendingLanes,o===0&&(Vi=null),UP(n.stateNode),tn(t,Ve()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(pf)throw pf=!1,t=vg,vg=null,t;return mf&1&&t.tag!==0&&ha(),o=t.pendingLanes,o&1?t===xg?Xl++:(Xl=0,xg=t):Xl=0,co(),null}function ha(){if(Ii!==null){var t=eC(mf),e=Pn.transition,n=me;try{if(Pn.transition=null,me=16>t?16:t,Ii===null)var r=!1;else{if(t=Ii,Ii=null,mf=0,he&6)throw Error(F(331));var i=he;for(he|=4,W=t.current;W!==null;){var o=W,s=o.child;if(W.flags&16){var a=o.deletions;if(a!==null){for(var l=0;l<a.length;l++){var c=a[l];for(W=c;W!==null;){var u=W;switch(u.tag){case 0:case 11:case 15:Yl(8,u,o)}var d=u.child;if(d!==null)d.return=u,W=d;else for(;W!==null;){u=W;var f=u.sibling,p=u.return;if(dk(u),u===c){W=null;break}if(f!==null){f.return=p,W=f;break}W=p}}}var m=o.alternate;if(m!==null){var g=m.child;if(g!==null){m.child=null;do{var v=g.sibling;g.sibling=null,g=v}while(g!==null)}}W=o}}if(o.subtreeFlags&2064&&s!==null)s.return=o,W=s;else e:for(;W!==null;){if(o=W,o.flags&2048)switch(o.tag){case 0:case 11:case 15:Yl(9,o,o.return)}var x=o.sibling;if(x!==null){x.return=o.return,W=x;break e}W=o.return}}var w=t.current;for(W=w;W!==null;){s=W;var S=s.child;if(s.subtreeFlags&2064&&S!==null)S.return=s,W=S;else e:for(s=w;W!==null;){if(a=W,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:lh(9,a)}}catch(C){$e(a,a.return,C)}if(a===s){W=null;break e}var b=a.sibling;if(b!==null){b.return=a.return,W=b;break e}W=a.return}}if(he=i,co(),Sr&&typeof Sr.onPostCommitFiberRoot=="function")try{Sr.onPostCommitFiberRoot(eh,t)}catch{}r=!0}return r}finally{me=n,Pn.transition=e}}return!1}function pw(t,e,n){e=Ba(n,e),e=ek(t,e,1),t=Ui(t,e,1),e=Mt(),t!==null&&(au(t,1,e),tn(t,e))}function $e(t,e,n){if(t.tag===3)pw(t,t,n);else for(;e!==null;){if(e.tag===3){pw(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Vi===null||!Vi.has(r))){t=Ba(n,t),t=tk(e,t,1),e=Ui(e,t,1),t=Mt(),e!==null&&(au(e,1,t),tn(e,t));break}}e=e.return}}function mA(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Mt(),t.pingedLanes|=t.suspendedLanes&n,tt===t&&(dt&n)===n&&(Ye===4||Ye===3&&(dt&130023424)===dt&&500>Ve()-Cv?Jo(t,0):Sv|=n),tn(t,e)}function bk(t,e){e===0&&(t.mode&1?(e=zu,zu<<=1,!(zu&130023424)&&(zu=4194304)):e=1);var n=Mt();t=Xr(t,e),t!==null&&(au(t,e,n),tn(t,n))}function gA(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),bk(t,n)}function yA(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(F(314))}r!==null&&r.delete(e),bk(t,n)}var Sk;Sk=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Zt.current)Qt=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Qt=!1,iA(t,e,n);Qt=!!(t.flags&131072)}else Qt=!1,Ae&&e.flags&1048576&&TC(e,sf,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Ad(t,e),t=e.pendingProps;var i=ja(e,St.current);fa(e,n),i=gv(null,e,r,t,i,n);var o=yv();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,en(r)?(o=!0,rf(e)):o=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,dv(e),i.updater=ah,e.stateNode=i,i._reactInternals=e,ag(e,r,t,n),e=ug(null,e,r,!0,o,n)):(e.tag=0,Ae&&o&&iv(e),Pt(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Ad(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=xA(r),t=Wn(r,t),i){case 0:e=cg(null,e,r,t,n);break e;case 1:e=iw(null,e,r,t,n);break e;case 11:e=nw(null,e,r,t,n);break e;case 14:e=rw(null,e,r,Wn(r.type,t),n);break e}throw Error(F(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Wn(r,i),cg(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Wn(r,i),iw(t,e,r,i,n);case 3:e:{if(ok(e),t===null)throw Error(F(387));r=e.pendingProps,o=e.memoizedState,i=o.element,AC(t,e),cf(e,r,null,n);var s=e.memoizedState;if(r=s.element,o.isDehydrated)if(o={element:r,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},e.updateQueue.baseState=o,e.memoizedState=o,e.flags&256){i=Ba(Error(F(423)),e),e=ow(t,e,r,n,i);break e}else if(r!==i){i=Ba(Error(F(424)),e),e=ow(t,e,r,n,i);break e}else for(hn=zi(e.stateNode.containerInfo.firstChild),mn=e,Ae=!0,Yn=null,n=PC(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(La(),r===i){e=Zr(t,e,n);break e}Pt(t,e,r,n)}e=e.child}return e;case 5:return DC(e),t===null&&ig(e),r=e.type,i=e.pendingProps,o=t!==null?t.memoizedProps:null,s=i.children,Zm(r,i)?s=null:o!==null&&Zm(r,o)&&(e.flags|=32),ik(t,e),Pt(t,e,s,n),e.child;case 6:return t===null&&ig(e),null;case 13:return sk(t,e,n);case 4:return fv(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=$a(e,null,r,n):Pt(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Wn(r,i),nw(t,e,r,i,n);case 7:return Pt(t,e,e.pendingProps,n),e.child;case 8:return Pt(t,e,e.pendingProps.children,n),e.child;case 12:return Pt(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,o=e.memoizedProps,s=i.value,Te(af,r._currentValue),r._currentValue=s,o!==null)if(tr(o.value,s)){if(o.children===i.children&&!Zt.current){e=Zr(t,e,n);break e}}else for(o=e.child,o!==null&&(o.return=e);o!==null;){var a=o.dependencies;if(a!==null){s=o.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(o.tag===1){l=qr(-1,n&-n),l.tag=2;var c=o.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),og(o.return,n,e),a.lanes|=n;break}l=l.next}}else if(o.tag===10)s=o.type===e.type?null:o.child;else if(o.tag===18){if(s=o.return,s===null)throw Error(F(341));s.lanes|=n,a=s.alternate,a!==null&&(a.lanes|=n),og(s,n,e),s=o.sibling}else s=o.child;if(s!==null)s.return=o;else for(s=o;s!==null;){if(s===e){s=null;break}if(o=s.sibling,o!==null){o.return=s.return,s=o;break}s=s.return}o=s}Pt(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,fa(e,n),i=jn(i),r=r(i),e.flags|=1,Pt(t,e,r,n),e.child;case 14:return r=e.type,i=Wn(r,e.pendingProps),i=Wn(r.type,i),rw(t,e,r,i,n);case 15:return nk(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Wn(r,i),Ad(t,e),e.tag=1,en(r)?(t=!0,rf(e)):t=!1,fa(e,n),ZC(e,r,i),ag(e,r,i,n),ug(null,e,r,!0,t,n);case 19:return ak(t,e,n);case 22:return rk(t,e,n)}throw Error(F(156,e.tag))};function Ck(t,e){return YS(t,e)}function vA(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function On(t,e,n,r){return new vA(t,e,n,r)}function _v(t){return t=t.prototype,!(!t||!t.isReactComponent)}function xA(t){if(typeof t=="function")return _v(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Ky)return 11;if(t===qy)return 14}return 2}function Wi(t,e){var n=t.alternate;return n===null?(n=On(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Nd(t,e,n,r,i,o){var s=2;if(r=t,typeof t=="function")_v(t)&&(s=1);else if(typeof t=="string")s=5;else e:switch(t){case Js:return Yo(n.children,i,o,e);case Wy:s=8,i|=8;break;case Mm:return t=On(12,n,e,i|2),t.elementType=Mm,t.lanes=o,t;case Am:return t=On(13,n,e,i),t.elementType=Am,t.lanes=o,t;case Dm:return t=On(19,n,e,i),t.elementType=Dm,t.lanes=o,t;case DS:return uh(n,i,o,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case MS:s=10;break e;case AS:s=9;break e;case Ky:s=11;break e;case qy:s=14;break e;case mi:s=16,r=null;break e}throw Error(F(130,t==null?t:typeof t,""))}return e=On(s,n,e,i),e.elementType=t,e.type=r,e.lanes=o,e}function Yo(t,e,n,r){return t=On(7,t,r,e),t.lanes=n,t}function uh(t,e,n,r){return t=On(22,t,r,e),t.elementType=DS,t.lanes=n,t.stateNode={isHidden:!1},t}function Op(t,e,n){return t=On(6,t,null,e),t.lanes=n,t}function Pp(t,e,n){return e=On(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function wA(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=up(0),this.expirationTimes=up(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=up(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Rv(t,e,n,r,i,o,s,a,l){return t=new wA(t,e,n,a,l),e===1?(e=1,o===!0&&(e|=8)):e=0,o=On(3,null,null,e),t.current=o,o.stateNode=t,o.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},dv(o),t}function bA(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Gs,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function kk(t){if(!t)return Zi;t=t._reactInternals;e:{if(Ss(t)!==t||t.tag!==1)throw Error(F(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(en(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(F(171))}if(t.tag===1){var n=t.type;if(en(n))return kC(t,n,e)}return e}function Ek(t,e,n,r,i,o,s,a,l){return t=Rv(n,r,!0,t,i,o,s,a,l),t.context=kk(null),n=t.current,r=Mt(),i=Hi(n),o=qr(r,i),o.callback=e??null,Ui(n,o,i),t.current.lanes=i,au(t,i,r),tn(t,r),t}function dh(t,e,n,r){var i=e.current,o=Mt(),s=Hi(i);return n=kk(n),e.context===null?e.context=n:e.pendingContext=n,e=qr(o,s),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Ui(i,e,s),t!==null&&(er(t,i,s,o),Od(t,i,s)),s}function yf(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function mw(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Ov(t,e){mw(t,e),(t=t.alternate)&&mw(t,e)}function SA(){return null}var Tk=typeof reportError=="function"?reportError:function(t){console.error(t)};function Pv(t){this._internalRoot=t}fh.prototype.render=Pv.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(F(409));dh(t,e,null,null)};fh.prototype.unmount=Pv.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;us(function(){dh(null,t,null,null)}),e[Qr]=null}};function fh(t){this._internalRoot=t}fh.prototype.unstable_scheduleHydration=function(t){if(t){var e=rC();t={blockedOn:null,target:t,priority:e};for(var n=0;n<wi.length&&e!==0&&e<wi[n].priority;n++);wi.splice(n,0,t),n===0&&oC(t)}};function Mv(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function hh(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function gw(){}function CA(t,e,n,r,i){if(i){if(typeof r=="function"){var o=r;r=function(){var c=yf(s);o.call(c)}}var s=Ek(e,r,t,0,null,!1,!1,"",gw);return t._reactRootContainer=s,t[Qr]=s.current,gc(t.nodeType===8?t.parentNode:t),us(),s}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var c=yf(l);a.call(c)}}var l=Rv(t,0,!1,null,null,!1,!1,"",gw);return t._reactRootContainer=l,t[Qr]=l.current,gc(t.nodeType===8?t.parentNode:t),us(function(){dh(e,l,n,r)}),l}function ph(t,e,n,r,i){var o=n._reactRootContainer;if(o){var s=o;if(typeof i=="function"){var a=i;i=function(){var l=yf(s);a.call(l)}}dh(e,s,t,i)}else s=CA(n,e,t,i,r);return yf(s)}tC=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Nl(e.pendingLanes);n!==0&&(Yy(e,n|1),tn(e,Ve()),!(he&6)&&(za=Ve()+500,co()))}break;case 13:us(function(){var r=Xr(t,1);if(r!==null){var i=Mt();er(r,t,1,i)}}),Ov(t,1)}};Qy=function(t){if(t.tag===13){var e=Xr(t,134217728);if(e!==null){var n=Mt();er(e,t,134217728,n)}Ov(t,134217728)}};nC=function(t){if(t.tag===13){var e=Hi(t),n=Xr(t,e);if(n!==null){var r=Mt();er(n,t,e,r)}Ov(t,e)}};rC=function(){return me};iC=function(t,e){var n=me;try{return me=t,e()}finally{me=n}};Vm=function(t,e,n){switch(e){case"input":if(jm(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=ih(r);if(!i)throw Error(F(90));NS(r),jm(r,i)}}}break;case"textarea":LS(t,n);break;case"select":e=n.value,e!=null&&la(t,!!n.multiple,e,!1)}};HS=kv;WS=us;var kA={usingClientEntryPoint:!1,Events:[cu,Zs,ih,US,VS,kv]},_l={findFiberByHostInstance:No,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},EA={bundleType:_l.bundleType,version:_l.version,rendererPackageName:_l.rendererPackageName,rendererConfig:_l.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ri.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=GS(t),t===null?null:t.stateNode},findFiberByHostInstance:_l.findFiberByHostInstance||SA,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Xu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Xu.isDisabled&&Xu.supportsFiber)try{eh=Xu.inject(EA),Sr=Xu}catch{}}xn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=kA;xn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Mv(e))throw Error(F(200));return bA(t,e,null,n)};xn.createRoot=function(t,e){if(!Mv(t))throw Error(F(299));var n=!1,r="",i=Tk;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=Rv(t,1,!1,null,null,n,!1,r,i),t[Qr]=e.current,gc(t.nodeType===8?t.parentNode:t),new Pv(e)};xn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(F(188)):(t=Object.keys(t).join(","),Error(F(268,t)));return t=GS(e),t=t===null?null:t.stateNode,t};xn.flushSync=function(t){return us(t)};xn.hydrate=function(t,e,n){if(!hh(e))throw Error(F(200));return ph(null,t,e,!0,n)};xn.hydrateRoot=function(t,e,n){if(!Mv(t))throw Error(F(405));var r=n!=null&&n.hydratedSources||null,i=!1,o="",s=Tk;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onRecoverableError!==void 0&&(s=n.onRecoverableError)),e=Ek(e,null,t,1,n??null,i,!1,o,s),t[Qr]=e.current,gc(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new fh(e)};xn.render=function(t,e,n){if(!hh(e))throw Error(F(200));return ph(null,t,e,!1,n)};xn.unmountComponentAtNode=function(t){if(!hh(t))throw Error(F(40));return t._reactRootContainer?(us(function(){ph(null,null,t,!1,function(){t._reactRootContainer=null,t[Qr]=null})}),!0):!1};xn.unstable_batchedUpdates=kv;xn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!hh(n))throw Error(F(200));if(t==null||t._reactInternals===void 0)throw Error(F(38));return ph(t,e,n,!1,r)};xn.version="18.3.1-next-f1338f8080-20240426";function _k(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(_k)}catch(t){console.error(t)}}_k(),_S.exports=xn;var du=_S.exports;const Rk=mS(du);var yw=du;Om.createRoot=yw.createRoot,Om.hydrateRoot=yw.hydrateRoot;const TA="modulepreload",_A=function(t){return"/"+t},vw={},ds=function(e,n,r){if(!n||n.length===0)return e();const i=document.getElementsByTagName("link");return Promise.all(n.map(o=>{if(o=_A(o),o in vw)return;vw[o]=!0;const s=o.endsWith(".css"),a=s?'[rel="stylesheet"]':"";if(!!r)for(let u=i.length-1;u>=0;u--){const d=i[u];if(d.href===o&&(!s||d.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${o}"]${a}`))return;const c=document.createElement("link");if(c.rel=s?"stylesheet":TA,s||(c.as="script",c.crossOrigin=""),c.href=o,document.head.appendChild(c),s)return new Promise((u,d)=>{c.addEventListener("load",u),c.addEventListener("error",()=>d(new Error(`Unable to preload CSS for ${o}`)))})})).then(()=>e()).catch(o=>{const s=new Event("vite:preloadError",{cancelable:!0});if(s.payload=o,window.dispatchEvent(s),!s.defaultPrevented)throw o})};var Av={};Object.defineProperty(Av,"__esModule",{value:!0});Av.parse=IA;Av.serialize=NA;const RA=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,OA=/^[\u0021-\u003A\u003C-\u007E]*$/,PA=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,MA=/^[\u0020-\u003A\u003D-\u007E]*$/,AA=Object.prototype.toString,DA=(()=>{const t=function(){};return t.prototype=Object.create(null),t})();function IA(t,e){const n=new DA,r=t.length;if(r<2)return n;const i=(e==null?void 0:e.decode)||jA;let o=0;do{const s=t.indexOf("=",o);if(s===-1)break;const a=t.indexOf(";",o),l=a===-1?r:a;if(s>l){o=t.lastIndexOf(";",s-1)+1;continue}const c=xw(t,o,s),u=ww(t,s,c),d=t.slice(c,u);if(n[d]===void 0){let f=xw(t,s+1,l),p=ww(t,l,f);const m=i(t.slice(f,p));n[d]=m}o=l+1}while(o<r);return n}function xw(t,e,n){do{const r=t.charCodeAt(e);if(r!==32&&r!==9)return e}while(++e<n);return n}function ww(t,e,n){for(;e>n;){const r=t.charCodeAt(--e);if(r!==32&&r!==9)return e+1}return n}function NA(t,e,n){const r=(n==null?void 0:n.encode)||encodeURIComponent;if(!RA.test(t))throw new TypeError(`argument name is invalid: ${t}`);const i=r(e);if(!OA.test(i))throw new TypeError(`argument val is invalid: ${e}`);let o=t+"="+i;if(!n)return o;if(n.maxAge!==void 0){if(!Number.isInteger(n.maxAge))throw new TypeError(`option maxAge is invalid: ${n.maxAge}`);o+="; Max-Age="+n.maxAge}if(n.domain){if(!PA.test(n.domain))throw new TypeError(`option domain is invalid: ${n.domain}`);o+="; Domain="+n.domain}if(n.path){if(!MA.test(n.path))throw new TypeError(`option path is invalid: ${n.path}`);o+="; Path="+n.path}if(n.expires){if(!LA(n.expires)||!Number.isFinite(n.expires.valueOf()))throw new TypeError(`option expires is invalid: ${n.expires}`);o+="; Expires="+n.expires.toUTCString()}if(n.httpOnly&&(o+="; HttpOnly"),n.secure&&(o+="; Secure"),n.partitioned&&(o+="; Partitioned"),n.priority)switch(typeof n.priority=="string"?n.priority.toLowerCase():void 0){case"low":o+="; Priority=Low";break;case"medium":o+="; Priority=Medium";break;case"high":o+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${n.priority}`)}if(n.sameSite)switch(typeof n.sameSite=="string"?n.sameSite.toLowerCase():n.sameSite){case!0:case"strict":o+="; SameSite=Strict";break;case"lax":o+="; SameSite=Lax";break;case"none":o+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${n.sameSite}`)}return o}function jA(t){if(t.indexOf("%")===-1)return t;try{return decodeURIComponent(t)}catch{return t}}function LA(t){return AA.call(t)==="[object Date]"}var bw="popstate";function $A(t={}){function e(r,i){let{pathname:o,search:s,hash:a}=r.location;return Sg("",{pathname:o,search:s,hash:a},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function n(r,i){return typeof i=="string"?i:Ec(i)}return BA(e,n,null,t)}function De(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function $n(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function FA(){return Math.random().toString(36).substring(2,10)}function Sw(t,e){return{usr:t.state,key:t.key,idx:e}}function Sg(t,e,n=null,r){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?cl(e):e,state:n,key:e&&e.key||r||FA()}}function Ec({pathname:t="/",search:e="",hash:n=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function cl(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substring(n),t=t.substring(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substring(r),t=t.substring(0,r)),t&&(e.pathname=t)}return e}function BA(t,e,n,r={}){let{window:i=document.defaultView,v5Compat:o=!1}=r,s=i.history,a="POP",l=null,c=u();c==null&&(c=0,s.replaceState({...s.state,idx:c},""));function u(){return(s.state||{idx:null}).idx}function d(){a="POP";let v=u(),x=v==null?null:v-c;c=v,l&&l({action:a,location:g.location,delta:x})}function f(v,x){a="PUSH";let w=Sg(g.location,v,x);n&&n(w,v),c=u()+1;let S=Sw(w,c),b=g.createHref(w);try{s.pushState(S,"",b)}catch(C){if(C instanceof DOMException&&C.name==="DataCloneError")throw C;i.location.assign(b)}o&&l&&l({action:a,location:g.location,delta:1})}function p(v,x){a="REPLACE";let w=Sg(g.location,v,x);n&&n(w,v),c=u();let S=Sw(w,c),b=g.createHref(w);s.replaceState(S,"",b),o&&l&&l({action:a,location:g.location,delta:0})}function m(v){let x=i.location.origin!=="null"?i.location.origin:i.location.href,w=typeof v=="string"?v:Ec(v);return w=w.replace(/ $/,"%20"),De(x,`No window.location.(origin|href) available to create URL for href: ${w}`),new URL(w,x)}let g={get action(){return a},get location(){return t(i,s)},listen(v){if(l)throw new Error("A history only accepts one active listener");return i.addEventListener(bw,d),l=v,()=>{i.removeEventListener(bw,d),l=null}},createHref(v){return e(i,v)},createURL:m,encodeLocation(v){let x=m(v);return{pathname:x.pathname,search:x.search,hash:x.hash}},push:f,replace:p,go(v){return s.go(v)}};return g}function Ok(t,e,n="/"){return zA(t,e,n,!1)}function zA(t,e,n,r){let i=typeof e=="string"?cl(e):e,o=eo(i.pathname||"/",n);if(o==null)return null;let s=Pk(t);UA(s);let a=null;for(let l=0;a==null&&l<s.length;++l){let c=ZA(o);a=QA(s[l],c,r)}return a}function Pk(t,e=[],n=[],r=""){let i=(o,s,a)=>{let l={relativePath:a===void 0?o.path||"":a,caseSensitive:o.caseSensitive===!0,childrenIndex:s,route:o};l.relativePath.startsWith("/")&&(De(l.relativePath.startsWith(r),`Absolute route path "${l.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),l.relativePath=l.relativePath.slice(r.length));let c=Gr([r,l.relativePath]),u=n.concat(l);o.children&&o.children.length>0&&(De(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${c}".`),Pk(o.children,e,u,c)),!(o.path==null&&!o.index)&&e.push({path:c,score:JA(c,o.index),routesMeta:u})};return t.forEach((o,s)=>{var a;if(o.path===""||!((a=o.path)!=null&&a.includes("?")))i(o,s);else for(let l of Mk(o.path))i(o,s,l)}),e}function Mk(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,i=n.endsWith("?"),o=n.replace(/\?$/,"");if(r.length===0)return i?[o,""]:[o];let s=Mk(r.join("/")),a=[];return a.push(...s.map(l=>l===""?o:[o,l].join("/"))),i&&a.push(...s),a.map(l=>t.startsWith("/")&&l===""?"/":l)}function UA(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:YA(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}var VA=/^:[\w-]+$/,HA=3,WA=2,KA=1,qA=10,GA=-2,Cw=t=>t==="*";function JA(t,e){let n=t.split("/"),r=n.length;return n.some(Cw)&&(r+=GA),e&&(r+=WA),n.filter(i=>!Cw(i)).reduce((i,o)=>i+(VA.test(o)?HA:o===""?KA:qA),r)}function YA(t,e){return t.length===e.length&&t.slice(0,-1).every((r,i)=>r===e[i])?t[t.length-1]-e[e.length-1]:0}function QA(t,e,n=!1){let{routesMeta:r}=t,i={},o="/",s=[];for(let a=0;a<r.length;++a){let l=r[a],c=a===r.length-1,u=o==="/"?e:e.slice(o.length)||"/",d=vf({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},u),f=l.route;if(!d&&c&&n&&!r[r.length-1].route.index&&(d=vf({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},u)),!d)return null;Object.assign(i,d.params),s.push({params:i,pathname:Gr([o,d.pathname]),pathnameBase:rD(Gr([o,d.pathnameBase])),route:f}),d.pathnameBase!=="/"&&(o=Gr([o,d.pathnameBase]))}return s}function vf(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=XA(t.path,t.caseSensitive,t.end),i=e.match(n);if(!i)return null;let o=i[0],s=o.replace(/(.)\/+$/,"$1"),a=i.slice(1);return{params:r.reduce((c,{paramName:u,isOptional:d},f)=>{if(u==="*"){let m=a[f]||"";s=o.slice(0,o.length-m.length).replace(/(.)\/+$/,"$1")}const p=a[f];return d&&!p?c[u]=void 0:c[u]=(p||"").replace(/%2F/g,"/"),c},{}),pathname:o,pathnameBase:s,pattern:t}}function XA(t,e=!1,n=!0){$n(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let r=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(s,a,l)=>(r.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),r]}function ZA(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return $n(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function eo(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function eD(t,e="/"){let{pathname:n,search:r="",hash:i=""}=typeof t=="string"?cl(t):t;return{pathname:n?n.startsWith("/")?n:tD(n,e):e,search:iD(r),hash:oD(i)}}function tD(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?n.length>1&&n.pop():i!=="."&&n.push(i)}),n.length>1?n.join("/"):"/"}function Mp(t,e,n,r){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function nD(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function Dv(t){let e=nD(t);return e.map((n,r)=>r===e.length-1?n.pathname:n.pathnameBase)}function Iv(t,e,n,r=!1){let i;typeof t=="string"?i=cl(t):(i={...t},De(!i.pathname||!i.pathname.includes("?"),Mp("?","pathname","search",i)),De(!i.pathname||!i.pathname.includes("#"),Mp("#","pathname","hash",i)),De(!i.search||!i.search.includes("#"),Mp("#","search","hash",i)));let o=t===""||i.pathname==="",s=o?"/":i.pathname,a;if(s==null)a=n;else{let d=e.length-1;if(!r&&s.startsWith("..")){let f=s.split("/");for(;f[0]==="..";)f.shift(),d-=1;i.pathname=f.join("/")}a=d>=0?e[d]:"/"}let l=eD(i,a),c=s&&s!=="/"&&s.endsWith("/"),u=(o||s===".")&&n.endsWith("/");return!l.pathname.endsWith("/")&&(c||u)&&(l.pathname+="/"),l}var Gr=t=>t.join("/").replace(/\/\/+/g,"/"),rD=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),iD=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,oD=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function sD(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}var Ak=["POST","PUT","PATCH","DELETE"];new Set(Ak);var aD=["GET",...Ak];new Set(aD);var ul=y.createContext(null);ul.displayName="DataRouter";var mh=y.createContext(null);mh.displayName="DataRouterState";var Dk=y.createContext({isTransitioning:!1});Dk.displayName="ViewTransition";var lD=y.createContext(new Map);lD.displayName="Fetchers";var cD=y.createContext(null);cD.displayName="Await";var or=y.createContext(null);or.displayName="Navigation";var fu=y.createContext(null);fu.displayName="Location";var sr=y.createContext({outlet:null,matches:[],isDataRoute:!1});sr.displayName="Route";var Nv=y.createContext(null);Nv.displayName="RouteError";function uD(t,{relative:e}={}){De(dl(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:r}=y.useContext(or),{hash:i,pathname:o,search:s}=hu(t,{relative:e}),a=o;return n!=="/"&&(a=o==="/"?n:Gr([n,o])),r.createHref({pathname:a,search:s,hash:i})}function dl(){return y.useContext(fu)!=null}function zn(){return De(dl(),"useLocation() may be used only in the context of a <Router> component."),y.useContext(fu).location}var Ik="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Nk(t){y.useContext(or).static||y.useLayoutEffect(t)}function Un(){let{isDataRoute:t}=y.useContext(sr);return t?kD():dD()}function dD(){De(dl(),"useNavigate() may be used only in the context of a <Router> component.");let t=y.useContext(ul),{basename:e,navigator:n}=y.useContext(or),{matches:r}=y.useContext(sr),{pathname:i}=zn(),o=JSON.stringify(Dv(r)),s=y.useRef(!1);return Nk(()=>{s.current=!0}),y.useCallback((l,c={})=>{if($n(s.current,Ik),!s.current)return;if(typeof l=="number"){n.go(l);return}let u=Iv(l,JSON.parse(o),i,c.relative==="path");t==null&&e!=="/"&&(u.pathname=u.pathname==="/"?e:Gr([e,u.pathname])),(c.replace?n.replace:n.push)(u,c.state,c)},[e,n,o,i,t])}y.createContext(null);function fD(){let{matches:t}=y.useContext(sr),e=t[t.length-1];return e?e.params:{}}function hu(t,{relative:e}={}){let{matches:n}=y.useContext(sr),{pathname:r}=zn(),i=JSON.stringify(Dv(n));return y.useMemo(()=>Iv(t,JSON.parse(i),r,e==="path"),[t,i,r,e])}function hD(t,e){return jk(t,e)}function jk(t,e,n,r){var w;De(dl(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:i,static:o}=y.useContext(or),{matches:s}=y.useContext(sr),a=s[s.length-1],l=a?a.params:{},c=a?a.pathname:"/",u=a?a.pathnameBase:"/",d=a&&a.route;{let S=d&&d.path||"";Lk(c,!d||S.endsWith("*")||S.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${c}" (under <Route path="${S}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${S}"> to <Route path="${S==="/"?"*":`${S}/*`}">.`)}let f=zn(),p;if(e){let S=typeof e=="string"?cl(e):e;De(u==="/"||((w=S.pathname)==null?void 0:w.startsWith(u)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${u}" but pathname "${S.pathname}" was given in the \`location\` prop.`),p=S}else p=f;let m=p.pathname||"/",g=m;if(u!=="/"){let S=u.replace(/^\//,"").split("/");g="/"+m.replace(/^\//,"").split("/").slice(S.length).join("/")}let v=!o&&n&&n.matches&&n.matches.length>0?n.matches:Ok(t,{pathname:g});$n(d||v!=null,`No routes matched location "${p.pathname}${p.search}${p.hash}" `),$n(v==null||v[v.length-1].route.element!==void 0||v[v.length-1].route.Component!==void 0||v[v.length-1].route.lazy!==void 0,`Matched leaf route at location "${p.pathname}${p.search}${p.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let x=vD(v&&v.map(S=>Object.assign({},S,{params:Object.assign({},l,S.params),pathname:Gr([u,i.encodeLocation?i.encodeLocation(S.pathname).pathname:S.pathname]),pathnameBase:S.pathnameBase==="/"?u:Gr([u,i.encodeLocation?i.encodeLocation(S.pathnameBase).pathname:S.pathnameBase])})),s,n,r);return e&&x?y.createElement(fu.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...p},navigationType:"POP"}},x):x}function pD(){let t=CD(),e=sD(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,r="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:r},o={padding:"2px 4px",backgroundColor:r},s=null;return console.error("Error handled by React Router default ErrorBoundary:",t),s=y.createElement(y.Fragment,null,y.createElement("p",null," Hey developer "),y.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",y.createElement("code",{style:o},"ErrorBoundary")," or"," ",y.createElement("code",{style:o},"errorElement")," prop on your route.")),y.createElement(y.Fragment,null,y.createElement("h2",null,"Unexpected Application Error!"),y.createElement("h3",{style:{fontStyle:"italic"}},e),n?y.createElement("pre",{style:i},n):null,s)}var mD=y.createElement(pD,null),gD=class extends y.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){console.error("React Router caught the following error during render",t,e)}render(){return this.state.error!==void 0?y.createElement(sr.Provider,{value:this.props.routeContext},y.createElement(Nv.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function yD({routeContext:t,match:e,children:n}){let r=y.useContext(ul);return r&&r.static&&r.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=e.route.id),y.createElement(sr.Provider,{value:t},n)}function vD(t,e=[],n=null,r=null){if(t==null){if(!n)return null;if(n.errors)t=n.matches;else if(e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let i=t,o=n==null?void 0:n.errors;if(o!=null){let l=i.findIndex(c=>c.route.id&&(o==null?void 0:o[c.route.id])!==void 0);De(l>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),i=i.slice(0,Math.min(i.length,l+1))}let s=!1,a=-1;if(n)for(let l=0;l<i.length;l++){let c=i[l];if((c.route.HydrateFallback||c.route.hydrateFallbackElement)&&(a=l),c.route.id){let{loaderData:u,errors:d}=n,f=c.route.loader&&!u.hasOwnProperty(c.route.id)&&(!d||d[c.route.id]===void 0);if(c.route.lazy||f){s=!0,a>=0?i=i.slice(0,a+1):i=[i[0]];break}}}return i.reduceRight((l,c,u)=>{let d,f=!1,p=null,m=null;n&&(d=o&&c.route.id?o[c.route.id]:void 0,p=c.route.errorElement||mD,s&&(a<0&&u===0?(Lk("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),f=!0,m=null):a===u&&(f=!0,m=c.route.hydrateFallbackElement||null)));let g=e.concat(i.slice(0,u+1)),v=()=>{let x;return d?x=p:f?x=m:c.route.Component?x=y.createElement(c.route.Component,null):c.route.element?x=c.route.element:x=l,y.createElement(yD,{match:c,routeContext:{outlet:l,matches:g,isDataRoute:n!=null},children:x})};return n&&(c.route.ErrorBoundary||c.route.errorElement||u===0)?y.createElement(gD,{location:n.location,revalidation:n.revalidation,component:p,error:d,children:v(),routeContext:{outlet:null,matches:g,isDataRoute:!0}}):v()},null)}function jv(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function xD(t){let e=y.useContext(ul);return De(e,jv(t)),e}function wD(t){let e=y.useContext(mh);return De(e,jv(t)),e}function bD(t){let e=y.useContext(sr);return De(e,jv(t)),e}function Lv(t){let e=bD(t),n=e.matches[e.matches.length-1];return De(n.route.id,`${t} can only be used on routes that contain a unique "id"`),n.route.id}function SD(){return Lv("useRouteId")}function CD(){var r;let t=y.useContext(Nv),e=wD("useRouteError"),n=Lv("useRouteError");return t!==void 0?t:(r=e.errors)==null?void 0:r[n]}function kD(){let{router:t}=xD("useNavigate"),e=Lv("useNavigate"),n=y.useRef(!1);return Nk(()=>{n.current=!0}),y.useCallback(async(i,o={})=>{$n(n.current,Ik),n.current&&(typeof i=="number"?t.navigate(i):await t.navigate(i,{fromRouteId:e,...o}))},[t,e])}var kw={};function Lk(t,e,n){!e&&!kw[t]&&(kw[t]=!0,$n(!1,n))}y.memo(ED);function ED({routes:t,future:e,state:n}){return jk(t,void 0,n,e)}function xf({to:t,replace:e,state:n,relative:r}){De(dl(),"<Navigate> may be used only in the context of a <Router> component.");let{static:i}=y.useContext(or);$n(!i,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:o}=y.useContext(sr),{pathname:s}=zn(),a=Un(),l=Iv(t,Dv(o),s,r==="path"),c=JSON.stringify(l);return y.useEffect(()=>{a(JSON.parse(c),{replace:e,state:n,relative:r})},[a,c,r,e,n]),null}function an(t){De(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function TD({basename:t="/",children:e=null,location:n,navigationType:r="POP",navigator:i,static:o=!1}){De(!dl(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let s=t.replace(/^\/*/,"/"),a=y.useMemo(()=>({basename:s,navigator:i,static:o,future:{}}),[s,i,o]);typeof n=="string"&&(n=cl(n));let{pathname:l="/",search:c="",hash:u="",state:d=null,key:f="default"}=n,p=y.useMemo(()=>{let m=eo(l,s);return m==null?null:{location:{pathname:m,search:c,hash:u,state:d,key:f},navigationType:r}},[s,l,c,u,d,f,r]);return $n(p!=null,`<Router basename="${s}"> is not able to match the URL "${l}${c}${u}" because it does not start with the basename, so the <Router> won't render anything.`),p==null?null:y.createElement(or.Provider,{value:a},y.createElement(fu.Provider,{children:e,value:p}))}function _D({children:t,location:e}){return hD(Cg(t),e)}function Cg(t,e=[]){let n=[];return y.Children.forEach(t,(r,i)=>{if(!y.isValidElement(r))return;let o=[...e,i];if(r.type===y.Fragment){n.push.apply(n,Cg(r.props.children,o));return}De(r.type===an,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),De(!r.props.index||!r.props.children,"An index route cannot have child routes.");let s={id:r.props.id||o.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(s.children=Cg(r.props.children,o)),n.push(s)}),n}var jd="get",Ld="application/x-www-form-urlencoded";function gh(t){return t!=null&&typeof t.tagName=="string"}function RD(t){return gh(t)&&t.tagName.toLowerCase()==="button"}function OD(t){return gh(t)&&t.tagName.toLowerCase()==="form"}function PD(t){return gh(t)&&t.tagName.toLowerCase()==="input"}function MD(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function AD(t,e){return t.button===0&&(!e||e==="_self")&&!MD(t)}function kg(t=""){return new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,n)=>{let r=t[n];return e.concat(Array.isArray(r)?r.map(i=>[n,i]):[[n,r]])},[]))}function DD(t,e){let n=kg(t);return e&&e.forEach((r,i)=>{n.has(i)||e.getAll(i).forEach(o=>{n.append(i,o)})}),n}var Zu=null;function ID(){if(Zu===null)try{new FormData(document.createElement("form"),0),Zu=!1}catch{Zu=!0}return Zu}var ND=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Ap(t){return t!=null&&!ND.has(t)?($n(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Ld}"`),null):t}function jD(t,e){let n,r,i,o,s;if(OD(t)){let a=t.getAttribute("action");r=a?eo(a,e):null,n=t.getAttribute("method")||jd,i=Ap(t.getAttribute("enctype"))||Ld,o=new FormData(t)}else if(RD(t)||PD(t)&&(t.type==="submit"||t.type==="image")){let a=t.form;if(a==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let l=t.getAttribute("formaction")||a.getAttribute("action");if(r=l?eo(l,e):null,n=t.getAttribute("formmethod")||a.getAttribute("method")||jd,i=Ap(t.getAttribute("formenctype"))||Ap(a.getAttribute("enctype"))||Ld,o=new FormData(a,t),!ID()){let{name:c,type:u,value:d}=t;if(u==="image"){let f=c?`${c}.`:"";o.append(`${f}x`,"0"),o.append(`${f}y`,"0")}else c&&o.append(c,d)}}else{if(gh(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=jd,r=null,i=Ld,s=t}return o&&i==="text/plain"&&(s=o,o=void 0),{action:r,method:n.toLowerCase(),encType:i,formData:o,body:s}}function $v(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}async function LD(t,e){if(t.id in e)return e[t.id];try{let n=await ds(()=>import(t.module),[]);return e[t.id]=n,n}catch(n){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function $D(t){return t!=null&&typeof t.page=="string"}function FD(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function BD(t,e,n){let r=await Promise.all(t.map(async i=>{let o=e.routes[i.route.id];if(o){let s=await LD(o,n);return s.links?s.links():[]}return[]}));return HD(r.flat(1).filter(FD).filter(i=>i.rel==="stylesheet"||i.rel==="preload").map(i=>i.rel==="stylesheet"?{...i,rel:"prefetch",as:"style"}:{...i,rel:"prefetch"}))}function Ew(t,e,n,r,i,o){let s=(l,c)=>n[c]?l.route.id!==n[c].route.id:!0,a=(l,c)=>{var u;return n[c].pathname!==l.pathname||((u=n[c].route.path)==null?void 0:u.endsWith("*"))&&n[c].params["*"]!==l.params["*"]};return o==="assets"?e.filter((l,c)=>s(l,c)||a(l,c)):o==="data"?e.filter((l,c)=>{var d;let u=r.routes[l.route.id];if(!u||!u.hasLoader)return!1;if(s(l,c)||a(l,c))return!0;if(l.route.shouldRevalidate){let f=l.route.shouldRevalidate({currentUrl:new URL(i.pathname+i.search+i.hash,window.origin),currentParams:((d=n[0])==null?void 0:d.params)||{},nextUrl:new URL(t,window.origin),nextParams:l.params,defaultShouldRevalidate:!0});if(typeof f=="boolean")return f}return!0}):[]}function zD(t,e,{includeHydrateFallback:n}={}){return UD(t.map(r=>{let i=e.routes[r.route.id];if(!i)return[];let o=[i.module];return i.clientActionModule&&(o=o.concat(i.clientActionModule)),i.clientLoaderModule&&(o=o.concat(i.clientLoaderModule)),n&&i.hydrateFallbackModule&&(o=o.concat(i.hydrateFallbackModule)),i.imports&&(o=o.concat(i.imports)),o}).flat(1))}function UD(t){return[...new Set(t)]}function VD(t){let e={},n=Object.keys(t).sort();for(let r of n)e[r]=t[r];return e}function HD(t,e){let n=new Set,r=new Set(e);return t.reduce((i,o)=>{if(e&&!$D(o)&&o.as==="script"&&o.href&&r.has(o.href))return i;let a=JSON.stringify(VD(o));return n.has(a)||(n.add(a),i.push({key:a,link:o})),i},[])}function WD(t){let e=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return e.pathname==="/"?e.pathname="_root.data":e.pathname=`${e.pathname.replace(/\/$/,"")}.data`,e}function KD(){let t=y.useContext(ul);return $v(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function qD(){let t=y.useContext(mh);return $v(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var Fv=y.createContext(void 0);Fv.displayName="FrameworkContext";function $k(){let t=y.useContext(Fv);return $v(t,"You must render this element inside a <HydratedRouter> element"),t}function GD(t,e){let n=y.useContext(Fv),[r,i]=y.useState(!1),[o,s]=y.useState(!1),{onFocus:a,onBlur:l,onMouseEnter:c,onMouseLeave:u,onTouchStart:d}=e,f=y.useRef(null);y.useEffect(()=>{if(t==="render"&&s(!0),t==="viewport"){let g=x=>{x.forEach(w=>{s(w.isIntersecting)})},v=new IntersectionObserver(g,{threshold:.5});return f.current&&v.observe(f.current),()=>{v.disconnect()}}},[t]),y.useEffect(()=>{if(r){let g=setTimeout(()=>{s(!0)},100);return()=>{clearTimeout(g)}}},[r]);let p=()=>{i(!0)},m=()=>{i(!1),s(!1)};return n?t!=="intent"?[o,f,{}]:[o,f,{onFocus:Rl(a,p),onBlur:Rl(l,m),onMouseEnter:Rl(c,p),onMouseLeave:Rl(u,m),onTouchStart:Rl(d,p)}]:[!1,f,{}]}function Rl(t,e){return n=>{t&&t(n),n.defaultPrevented||e(n)}}function JD({page:t,...e}){let{router:n}=KD(),r=y.useMemo(()=>Ok(n.routes,t,n.basename),[n.routes,t,n.basename]);return r?y.createElement(QD,{page:t,matches:r,...e}):null}function YD(t){let{manifest:e,routeModules:n}=$k(),[r,i]=y.useState([]);return y.useEffect(()=>{let o=!1;return BD(t,e,n).then(s=>{o||i(s)}),()=>{o=!0}},[t,e,n]),r}function QD({page:t,matches:e,...n}){let r=zn(),{manifest:i,routeModules:o}=$k(),{loaderData:s,matches:a}=qD(),l=y.useMemo(()=>Ew(t,e,a,i,r,"data"),[t,e,a,i,r]),c=y.useMemo(()=>Ew(t,e,a,i,r,"assets"),[t,e,a,i,r]),u=y.useMemo(()=>{if(t===r.pathname+r.search+r.hash)return[];let p=new Set,m=!1;if(e.forEach(v=>{var w;let x=i.routes[v.route.id];!x||!x.hasLoader||(!l.some(S=>S.route.id===v.route.id)&&v.route.id in s&&((w=o[v.route.id])!=null&&w.shouldRevalidate)||x.hasClientLoader?m=!0:p.add(v.route.id))}),p.size===0)return[];let g=WD(t);return m&&p.size>0&&g.searchParams.set("_routes",e.filter(v=>p.has(v.route.id)).map(v=>v.route.id).join(",")),[g.pathname+g.search]},[s,r,i,l,e,t,o]),d=y.useMemo(()=>zD(c,i),[c,i]),f=YD(c);return y.createElement(y.Fragment,null,u.map(p=>y.createElement("link",{key:p,rel:"prefetch",as:"fetch",href:p,...n})),d.map(p=>y.createElement("link",{key:p,rel:"modulepreload",href:p,...n})),f.map(({key:p,link:m})=>y.createElement("link",{key:p,...m})))}function XD(...t){return e=>{t.forEach(n=>{typeof n=="function"?n(e):n!=null&&(n.current=e)})}}var Fk=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{Fk&&(window.__reactRouterVersion="7.2.0")}catch{}function ZD({basename:t,children:e,window:n}){let r=y.useRef();r.current==null&&(r.current=$A({window:n,v5Compat:!0}));let i=r.current,[o,s]=y.useState({action:i.action,location:i.location}),a=y.useCallback(l=>{y.startTransition(()=>s(l))},[s]);return y.useLayoutEffect(()=>i.listen(a),[i,a]),y.createElement(TD,{basename:t,children:e,location:o.location,navigationType:o.action,navigator:i})}var Bk=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Bv=y.forwardRef(function({onClick:e,discover:n="render",prefetch:r="none",relative:i,reloadDocument:o,replace:s,state:a,target:l,to:c,preventScrollReset:u,viewTransition:d,...f},p){let{basename:m}=y.useContext(or),g=typeof c=="string"&&Bk.test(c),v,x=!1;if(typeof c=="string"&&g&&(v=c,Fk))try{let O=new URL(window.location.href),R=c.startsWith("//")?new URL(O.protocol+c):new URL(c),I=eo(R.pathname,m);R.origin===O.origin&&I!=null?c=I+R.search+R.hash:x=!0}catch{$n(!1,`<Link to="${c}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let w=uD(c,{relative:i}),[S,b,C]=GD(r,f),k=r2(c,{replace:s,state:a,target:l,preventScrollReset:u,relative:i,viewTransition:d});function E(O){e&&e(O),O.defaultPrevented||k(O)}let T=y.createElement("a",{...f,...C,href:v||w,onClick:x||o?e:E,ref:XD(p,b),target:l,"data-discover":!g&&n==="render"?"true":void 0});return S&&!g?y.createElement(y.Fragment,null,T,y.createElement(JD,{page:w})):T});Bv.displayName="Link";var e2=y.forwardRef(function({"aria-current":e="page",caseSensitive:n=!1,className:r="",end:i=!1,style:o,to:s,viewTransition:a,children:l,...c},u){let d=hu(s,{relative:c.relative}),f=zn(),p=y.useContext(mh),{navigator:m,basename:g}=y.useContext(or),v=p!=null&&c2(d)&&a===!0,x=m.encodeLocation?m.encodeLocation(d).pathname:d.pathname,w=f.pathname,S=p&&p.navigation&&p.navigation.location?p.navigation.location.pathname:null;n||(w=w.toLowerCase(),S=S?S.toLowerCase():null,x=x.toLowerCase()),S&&g&&(S=eo(S,g)||S);const b=x!=="/"&&x.endsWith("/")?x.length-1:x.length;let C=w===x||!i&&w.startsWith(x)&&w.charAt(b)==="/",k=S!=null&&(S===x||!i&&S.startsWith(x)&&S.charAt(x.length)==="/"),E={isActive:C,isPending:k,isTransitioning:v},T=C?e:void 0,O;typeof r=="function"?O=r(E):O=[r,C?"active":null,k?"pending":null,v?"transitioning":null].filter(Boolean).join(" ");let R=typeof o=="function"?o(E):o;return y.createElement(Bv,{...c,"aria-current":T,className:O,ref:u,style:R,to:s,viewTransition:a},typeof l=="function"?l(E):l)});e2.displayName="NavLink";var t2=y.forwardRef(({discover:t="render",fetcherKey:e,navigate:n,reloadDocument:r,replace:i,state:o,method:s=jd,action:a,onSubmit:l,relative:c,preventScrollReset:u,viewTransition:d,...f},p)=>{let m=a2(),g=l2(a,{relative:c}),v=s.toLowerCase()==="get"?"get":"post",x=typeof a=="string"&&Bk.test(a),w=S=>{if(l&&l(S),S.defaultPrevented)return;S.preventDefault();let b=S.nativeEvent.submitter,C=(b==null?void 0:b.getAttribute("formmethod"))||s;m(b||S.currentTarget,{fetcherKey:e,method:C,navigate:n,replace:i,state:o,relative:c,preventScrollReset:u,viewTransition:d})};return y.createElement("form",{ref:p,method:v,action:g,onSubmit:r?l:w,...f,"data-discover":!x&&t==="render"?"true":void 0})});t2.displayName="Form";function n2(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function zk(t){let e=y.useContext(ul);return De(e,n2(t)),e}function r2(t,{target:e,replace:n,state:r,preventScrollReset:i,relative:o,viewTransition:s}={}){let a=Un(),l=zn(),c=hu(t,{relative:o});return y.useCallback(u=>{if(AD(u,e)){u.preventDefault();let d=n!==void 0?n:Ec(l)===Ec(c);a(t,{replace:d,state:r,preventScrollReset:i,relative:o,viewTransition:s})}},[l,a,c,n,r,e,t,i,o,s])}function i2(t){$n(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=y.useRef(kg(t)),n=y.useRef(!1),r=zn(),i=y.useMemo(()=>DD(r.search,n.current?null:e.current),[r.search]),o=Un(),s=y.useCallback((a,l)=>{const c=kg(typeof a=="function"?a(i):a);n.current=!0,o("?"+c,l)},[o,i]);return[i,s]}var o2=0,s2=()=>`__${String(++o2)}__`;function a2(){let{router:t}=zk("useSubmit"),{basename:e}=y.useContext(or),n=SD();return y.useCallback(async(r,i={})=>{let{action:o,method:s,encType:a,formData:l,body:c}=jD(r,e);if(i.navigate===!1){let u=i.fetcherKey||s2();await t.fetch(u,n,i.action||o,{preventScrollReset:i.preventScrollReset,formData:l,body:c,formMethod:i.method||s,formEncType:i.encType||a,flushSync:i.flushSync})}else await t.navigate(i.action||o,{preventScrollReset:i.preventScrollReset,formData:l,body:c,formMethod:i.method||s,formEncType:i.encType||a,replace:i.replace,state:i.state,fromRouteId:n,flushSync:i.flushSync,viewTransition:i.viewTransition})},[t,e,n])}function l2(t,{relative:e}={}){let{basename:n}=y.useContext(or),r=y.useContext(sr);De(r,"useFormAction must be used inside a RouteContext");let[i]=r.matches.slice(-1),o={...hu(t||".",{relative:e})},s=zn();if(t==null){o.search=s.search;let a=new URLSearchParams(o.search),l=a.getAll("index");if(l.some(u=>u==="")){a.delete("index"),l.filter(d=>d).forEach(d=>a.append("index",d));let u=a.toString();o.search=u?`?${u}`:""}}return(!t||t===".")&&i.route.index&&(o.search=o.search?o.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(o.pathname=o.pathname==="/"?n:Gr([n,o.pathname])),Ec(o)}function c2(t,e={}){let n=y.useContext(Dk);De(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=zk("useViewTransitionState"),i=hu(t,{relative:e.relative});if(!n.isTransitioning)return!1;let o=eo(n.currentLocation.pathname,r)||n.currentLocation.pathname,s=eo(n.nextLocation.pathname,r)||n.nextLocation.pathname;return vf(i.pathname,s)!=null||vf(i.pathname,o)!=null}new TextEncoder;var fl=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(t){return this.listeners.add(t),this.onSubscribe(),()=>{this.listeners.delete(t),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},fs=typeof window>"u"||"Deno"in globalThis;function kn(){}function u2(t,e){return typeof t=="function"?t(e):t}function Eg(t){return typeof t=="number"&&t>=0&&t!==1/0}function Uk(t,e){return Math.max(t+(e||0)-Date.now(),0)}function pa(t,e){return typeof t=="function"?t(e):t}function Qn(t,e){return typeof t=="function"?t(e):t}function Tw(t,e){const{type:n="all",exact:r,fetchStatus:i,predicate:o,queryKey:s,stale:a}=t;if(s){if(r){if(e.queryHash!==zv(s,e.options))return!1}else if(!Tc(e.queryKey,s))return!1}if(n!=="all"){const l=e.isActive();if(n==="active"&&!l||n==="inactive"&&l)return!1}return!(typeof a=="boolean"&&e.isStale()!==a||i&&i!==e.state.fetchStatus||o&&!o(e))}function _w(t,e){const{exact:n,status:r,predicate:i,mutationKey:o}=t;if(o){if(!e.options.mutationKey)return!1;if(n){if(hs(e.options.mutationKey)!==hs(o))return!1}else if(!Tc(e.options.mutationKey,o))return!1}return!(r&&e.state.status!==r||i&&!i(e))}function zv(t,e){return((e==null?void 0:e.queryKeyHashFn)||hs)(t)}function hs(t){return JSON.stringify(t,(e,n)=>Tg(n)?Object.keys(n).sort().reduce((r,i)=>(r[i]=n[i],r),{}):n)}function Tc(t,e){return t===e?!0:typeof t!=typeof e?!1:t&&e&&typeof t=="object"&&typeof e=="object"?!Object.keys(e).some(n=>!Tc(t[n],e[n])):!1}function Vk(t,e){if(t===e)return t;const n=Rw(t)&&Rw(e);if(n||Tg(t)&&Tg(e)){const r=n?t:Object.keys(t),i=r.length,o=n?e:Object.keys(e),s=o.length,a=n?[]:{};let l=0;for(let c=0;c<s;c++){const u=n?c:o[c];(!n&&r.includes(u)||n)&&t[u]===void 0&&e[u]===void 0?(a[u]=void 0,l++):(a[u]=Vk(t[u],e[u]),a[u]===t[u]&&t[u]!==void 0&&l++)}return i===s&&l===i?t:a}return e}function wf(t,e){if(!e||Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(t[n]!==e[n])return!1;return!0}function Rw(t){return Array.isArray(t)&&t.length===Object.keys(t).length}function Tg(t){if(!Ow(t))return!1;const e=t.constructor;if(e===void 0)return!0;const n=e.prototype;return!(!Ow(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(t)!==Object.prototype)}function Ow(t){return Object.prototype.toString.call(t)==="[object Object]"}function d2(t){return new Promise(e=>{setTimeout(e,t)})}function _g(t,e,n){return typeof n.structuralSharing=="function"?n.structuralSharing(t,e):n.structuralSharing!==!1?Vk(t,e):e}function f2(t,e,n=0){const r=[...t,e];return n&&r.length>n?r.slice(1):r}function h2(t,e,n=0){const r=[e,...t];return n&&r.length>n?r.slice(0,-1):r}var Uv=Symbol();function Hk(t,e){return!t.queryFn&&(e!=null&&e.initialPromise)?()=>e.initialPromise:!t.queryFn||t.queryFn===Uv?()=>Promise.reject(new Error(`Missing queryFn: '${t.queryHash}'`)):t.queryFn}var Bo,ki,ba,oS,p2=(oS=class extends fl{constructor(){super();q(this,Bo,void 0);q(this,ki,void 0);q(this,ba,void 0);U(this,ba,e=>{if(!fs&&window.addEventListener){const n=()=>e();return window.addEventListener("visibilitychange",n,!1),()=>{window.removeEventListener("visibilitychange",n)}}})}onSubscribe(){_(this,ki)||this.setEventListener(_(this,ba))}onUnsubscribe(){var e;this.hasListeners()||((e=_(this,ki))==null||e.call(this),U(this,ki,void 0))}setEventListener(e){var n;U(this,ba,e),(n=_(this,ki))==null||n.call(this),U(this,ki,e(r=>{typeof r=="boolean"?this.setFocused(r):this.onFocus()}))}setFocused(e){_(this,Bo)!==e&&(U(this,Bo,e),this.onFocus())}onFocus(){const e=this.isFocused();this.listeners.forEach(n=>{n(e)})}isFocused(){var e;return typeof _(this,Bo)=="boolean"?_(this,Bo):((e=globalThis.document)==null?void 0:e.visibilityState)!=="hidden"}},Bo=new WeakMap,ki=new WeakMap,ba=new WeakMap,oS),Vv=new p2,Sa,Ei,Ca,sS,m2=(sS=class extends fl{constructor(){super();q(this,Sa,!0);q(this,Ei,void 0);q(this,Ca,void 0);U(this,Ca,e=>{if(!fs&&window.addEventListener){const n=()=>e(!0),r=()=>e(!1);return window.addEventListener("online",n,!1),window.addEventListener("offline",r,!1),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",r)}}})}onSubscribe(){_(this,Ei)||this.setEventListener(_(this,Ca))}onUnsubscribe(){var e;this.hasListeners()||((e=_(this,Ei))==null||e.call(this),U(this,Ei,void 0))}setEventListener(e){var n;U(this,Ca,e),(n=_(this,Ei))==null||n.call(this),U(this,Ei,e(this.setOnline.bind(this)))}setOnline(e){_(this,Sa)!==e&&(U(this,Sa,e),this.listeners.forEach(r=>{r(e)}))}isOnline(){return _(this,Sa)}},Sa=new WeakMap,Ei=new WeakMap,Ca=new WeakMap,sS),bf=new m2;function Rg(){let t,e;const n=new Promise((i,o)=>{t=i,e=o});n.status="pending",n.catch(()=>{});function r(i){Object.assign(n,i),delete n.resolve,delete n.reject}return n.resolve=i=>{r({status:"fulfilled",value:i}),t(i)},n.reject=i=>{r({status:"rejected",reason:i}),e(i)},n}function g2(t){return Math.min(1e3*2**t,3e4)}function Wk(t){return(t??"online")==="online"?bf.isOnline():!0}var Kk=class extends Error{constructor(t){super("CancelledError"),this.revert=t==null?void 0:t.revert,this.silent=t==null?void 0:t.silent}};function Dp(t){return t instanceof Kk}function qk(t){let e=!1,n=0,r=!1,i;const o=Rg(),s=g=>{var v;r||(f(new Kk(g)),(v=t.abort)==null||v.call(t))},a=()=>{e=!0},l=()=>{e=!1},c=()=>Vv.isFocused()&&(t.networkMode==="always"||bf.isOnline())&&t.canRun(),u=()=>Wk(t.networkMode)&&t.canRun(),d=g=>{var v;r||(r=!0,(v=t.onSuccess)==null||v.call(t,g),i==null||i(),o.resolve(g))},f=g=>{var v;r||(r=!0,(v=t.onError)==null||v.call(t,g),i==null||i(),o.reject(g))},p=()=>new Promise(g=>{var v;i=x=>{(r||c())&&g(x)},(v=t.onPause)==null||v.call(t)}).then(()=>{var g;i=void 0,r||(g=t.onContinue)==null||g.call(t)}),m=()=>{if(r)return;let g;const v=n===0?t.initialPromise:void 0;try{g=v??t.fn()}catch(x){g=Promise.reject(x)}Promise.resolve(g).then(d).catch(x=>{var k;if(r)return;const w=t.retry??(fs?0:3),S=t.retryDelay??g2,b=typeof S=="function"?S(n,x):S,C=w===!0||typeof w=="number"&&n<w||typeof w=="function"&&w(n,x);if(e||!C){f(x);return}n++,(k=t.onFail)==null||k.call(t,n,x),d2(b).then(()=>c()?void 0:p()).then(()=>{e?f(x):m()})})};return{promise:o,cancel:s,continue:()=>(i==null||i(),o),cancelRetry:a,continueRetry:l,canStart:u,start:()=>(u()?m():p().then(m),o)}}function y2(){let t=[],e=0,n=a=>{a()},r=a=>{a()},i=a=>setTimeout(a,0);const o=a=>{e?t.push(a):i(()=>{n(a)})},s=()=>{const a=t;t=[],a.length&&i(()=>{r(()=>{a.forEach(l=>{n(l)})})})};return{batch:a=>{let l;e++;try{l=a()}finally{e--,e||s()}return l},batchCalls:a=>(...l)=>{o(()=>{a(...l)})},schedule:o,setNotifyFunction:a=>{n=a},setBatchNotifyFunction:a=>{r=a},setScheduler:a=>{i=a}}}var Je=y2(),zo,aS,Gk=(aS=class{constructor(){q(this,zo,void 0)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),Eg(this.gcTime)&&U(this,zo,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(t){this.gcTime=Math.max(this.gcTime||0,t??(fs?1/0:5*60*1e3))}clearGcTimeout(){_(this,zo)&&(clearTimeout(_(this,zo)),U(this,zo,void 0))}},zo=new WeakMap,aS),ka,Ea,Cn,Uo,vt,Gc,Vo,Kn,jr,lS,v2=(lS=class extends Gk{constructor(e){super();q(this,Kn);q(this,ka,void 0);q(this,Ea,void 0);q(this,Cn,void 0);q(this,Uo,void 0);q(this,vt,void 0);q(this,Gc,void 0);q(this,Vo,void 0);U(this,Vo,!1),U(this,Gc,e.defaultOptions),this.setOptions(e.options),this.observers=[],U(this,Uo,e.client),U(this,Cn,_(this,Uo).getQueryCache()),this.queryKey=e.queryKey,this.queryHash=e.queryHash,U(this,ka,x2(this.options)),this.state=e.state??_(this,ka),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var e;return(e=_(this,vt))==null?void 0:e.promise}setOptions(e){this.options={..._(this,Gc),...e},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&_(this,Cn).remove(this)}setData(e,n){const r=_g(this.state.data,e,this.options);return se(this,Kn,jr).call(this,{data:r,type:"success",dataUpdatedAt:n==null?void 0:n.updatedAt,manual:n==null?void 0:n.manual}),r}setState(e,n){se(this,Kn,jr).call(this,{type:"setState",state:e,setStateOptions:n})}cancel(e){var r,i;const n=(r=_(this,vt))==null?void 0:r.promise;return(i=_(this,vt))==null||i.cancel(e),n?n.then(kn).catch(kn):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(_(this,ka))}isActive(){return this.observers.some(e=>Qn(e.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===Uv||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStale(){return this.state.isInvalidated?!0:this.getObserversCount()>0?this.observers.some(e=>e.getCurrentResult().isStale):this.state.data===void 0}isStaleByTime(e=0){return this.state.isInvalidated||this.state.data===void 0||!Uk(this.state.dataUpdatedAt,e)}onFocus(){var n;const e=this.observers.find(r=>r.shouldFetchOnWindowFocus());e==null||e.refetch({cancelRefetch:!1}),(n=_(this,vt))==null||n.continue()}onOnline(){var n;const e=this.observers.find(r=>r.shouldFetchOnReconnect());e==null||e.refetch({cancelRefetch:!1}),(n=_(this,vt))==null||n.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),_(this,Cn).notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter(n=>n!==e),this.observers.length||(_(this,vt)&&(_(this,Vo)?_(this,vt).cancel({revert:!0}):_(this,vt).cancelRetry()),this.scheduleGc()),_(this,Cn).notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||se(this,Kn,jr).call(this,{type:"invalidate"})}fetch(e,n){var l,c,u;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(n!=null&&n.cancelRefetch))this.cancel({silent:!0});else if(_(this,vt))return _(this,vt).continueRetry(),_(this,vt).promise}if(e&&this.setOptions(e),!this.options.queryFn){const d=this.observers.find(f=>f.options.queryFn);d&&this.setOptions(d.options)}const r=new AbortController,i=d=>{Object.defineProperty(d,"signal",{enumerable:!0,get:()=>(U(this,Vo,!0),r.signal)})},o=()=>{const d=Hk(this.options,n),f={client:_(this,Uo),queryKey:this.queryKey,meta:this.meta};return i(f),U(this,Vo,!1),this.options.persister?this.options.persister(d,f,this):d(f)},s={fetchOptions:n,options:this.options,queryKey:this.queryKey,client:_(this,Uo),state:this.state,fetchFn:o};i(s),(l=this.options.behavior)==null||l.onFetch(s,this),U(this,Ea,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((c=s.fetchOptions)==null?void 0:c.meta))&&se(this,Kn,jr).call(this,{type:"fetch",meta:(u=s.fetchOptions)==null?void 0:u.meta});const a=d=>{var f,p,m,g;Dp(d)&&d.silent||se(this,Kn,jr).call(this,{type:"error",error:d}),Dp(d)||((p=(f=_(this,Cn).config).onError)==null||p.call(f,d,this),(g=(m=_(this,Cn).config).onSettled)==null||g.call(m,this.state.data,d,this)),this.scheduleGc()};return U(this,vt,qk({initialPromise:n==null?void 0:n.initialPromise,fn:s.fetchFn,abort:r.abort.bind(r),onSuccess:d=>{var f,p,m,g;if(d===void 0){a(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(d)}catch(v){a(v);return}(p=(f=_(this,Cn).config).onSuccess)==null||p.call(f,d,this),(g=(m=_(this,Cn).config).onSettled)==null||g.call(m,d,this.state.error,this),this.scheduleGc()},onError:a,onFail:(d,f)=>{se(this,Kn,jr).call(this,{type:"failed",failureCount:d,error:f})},onPause:()=>{se(this,Kn,jr).call(this,{type:"pause"})},onContinue:()=>{se(this,Kn,jr).call(this,{type:"continue"})},retry:s.options.retry,retryDelay:s.options.retryDelay,networkMode:s.options.networkMode,canRun:()=>!0})),_(this,vt).start()}},ka=new WeakMap,Ea=new WeakMap,Cn=new WeakMap,Uo=new WeakMap,vt=new WeakMap,Gc=new WeakMap,Vo=new WeakMap,Kn=new WeakSet,jr=function(e){const n=r=>{switch(e.type){case"failed":return{...r,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...r,fetchStatus:"paused"};case"continue":return{...r,fetchStatus:"fetching"};case"fetch":return{...r,...Jk(r.data,this.options),fetchMeta:e.meta??null};case"success":return{...r,data:e.data,dataUpdateCount:r.dataUpdateCount+1,dataUpdatedAt:e.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const i=e.error;return Dp(i)&&i.revert&&_(this,Ea)?{..._(this,Ea),fetchStatus:"idle"}:{...r,error:i,errorUpdateCount:r.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:r.fetchFailureCount+1,fetchFailureReason:i,fetchStatus:"idle",status:"error"};case"invalidate":return{...r,isInvalidated:!0};case"setState":return{...r,...e.state}}};this.state=n(this.state),Je.batch(()=>{this.observers.forEach(r=>{r.onQueryUpdate()}),_(this,Cn).notify({query:this,type:"updated",action:e})})},lS);function Jk(t,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:Wk(e.networkMode)?"fetching":"paused",...t===void 0&&{error:null,status:"pending"}}}function x2(t){const e=typeof t.initialData=="function"?t.initialData():t.initialData,n=e!==void 0,r=n?typeof t.initialDataUpdatedAt=="function"?t.initialDataUpdatedAt():t.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:n?r??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}var pr,cS,w2=(cS=class extends fl{constructor(e={}){super();q(this,pr,void 0);this.config=e,U(this,pr,new Map)}build(e,n,r){const i=n.queryKey,o=n.queryHash??zv(i,n);let s=this.get(o);return s||(s=new v2({client:e,queryKey:i,queryHash:o,options:e.defaultQueryOptions(n),state:r,defaultOptions:e.getQueryDefaults(i)}),this.add(s)),s}add(e){_(this,pr).has(e.queryHash)||(_(this,pr).set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const n=_(this,pr).get(e.queryHash);n&&(e.destroy(),n===e&&_(this,pr).delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){Je.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return _(this,pr).get(e)}getAll(){return[..._(this,pr).values()]}find(e){const n={exact:!0,...e};return this.getAll().find(r=>Tw(n,r))}findAll(e={}){const n=this.getAll();return Object.keys(e).length>0?n.filter(r=>Tw(e,r)):n}notify(e){Je.batch(()=>{this.listeners.forEach(n=>{n(e)})})}onFocus(){Je.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){Je.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}},pr=new WeakMap,cS),mr,Rt,Ho,gr,ui,uS,b2=(uS=class extends Gk{constructor(e){super();q(this,gr);q(this,mr,void 0);q(this,Rt,void 0);q(this,Ho,void 0);this.mutationId=e.mutationId,U(this,Rt,e.mutationCache),U(this,mr,[]),this.state=e.state||Yk(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){_(this,mr).includes(e)||(_(this,mr).push(e),this.clearGcTimeout(),_(this,Rt).notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){U(this,mr,_(this,mr).filter(n=>n!==e)),this.scheduleGc(),_(this,Rt).notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){_(this,mr).length||(this.state.status==="pending"?this.scheduleGc():_(this,Rt).remove(this))}continue(){var e;return((e=_(this,Ho))==null?void 0:e.continue())??this.execute(this.state.variables)}async execute(e){var i,o,s,a,l,c,u,d,f,p,m,g,v,x,w,S,b,C,k,E;U(this,Ho,qk({fn:()=>this.options.mutationFn?this.options.mutationFn(e):Promise.reject(new Error("No mutationFn found")),onFail:(T,O)=>{se(this,gr,ui).call(this,{type:"failed",failureCount:T,error:O})},onPause:()=>{se(this,gr,ui).call(this,{type:"pause"})},onContinue:()=>{se(this,gr,ui).call(this,{type:"continue"})},retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>_(this,Rt).canRun(this)}));const n=this.state.status==="pending",r=!_(this,Ho).canStart();try{if(!n){se(this,gr,ui).call(this,{type:"pending",variables:e,isPaused:r}),await((o=(i=_(this,Rt).config).onMutate)==null?void 0:o.call(i,e,this));const O=await((a=(s=this.options).onMutate)==null?void 0:a.call(s,e));O!==this.state.context&&se(this,gr,ui).call(this,{type:"pending",context:O,variables:e,isPaused:r})}const T=await _(this,Ho).start();return await((c=(l=_(this,Rt).config).onSuccess)==null?void 0:c.call(l,T,e,this.state.context,this)),await((d=(u=this.options).onSuccess)==null?void 0:d.call(u,T,e,this.state.context)),await((p=(f=_(this,Rt).config).onSettled)==null?void 0:p.call(f,T,null,this.state.variables,this.state.context,this)),await((g=(m=this.options).onSettled)==null?void 0:g.call(m,T,null,e,this.state.context)),se(this,gr,ui).call(this,{type:"success",data:T}),T}catch(T){try{throw await((x=(v=_(this,Rt).config).onError)==null?void 0:x.call(v,T,e,this.state.context,this)),await((S=(w=this.options).onError)==null?void 0:S.call(w,T,e,this.state.context)),await((C=(b=_(this,Rt).config).onSettled)==null?void 0:C.call(b,void 0,T,this.state.variables,this.state.context,this)),await((E=(k=this.options).onSettled)==null?void 0:E.call(k,void 0,T,e,this.state.context)),T}finally{se(this,gr,ui).call(this,{type:"error",error:T})}}finally{_(this,Rt).runNext(this)}}},mr=new WeakMap,Rt=new WeakMap,Ho=new WeakMap,gr=new WeakSet,ui=function(e){const n=r=>{switch(e.type){case"failed":return{...r,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...r,isPaused:!0};case"continue":return{...r,isPaused:!1};case"pending":return{...r,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...r,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...r,data:void 0,error:e.error,failureCount:r.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}};this.state=n(this.state),Je.batch(()=>{_(this,mr).forEach(r=>{r.onMutationUpdate(e)}),_(this,Rt).notify({mutation:this,type:"updated",action:e})})},uS);function Yk(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var zr,qn,Jc,dS,S2=(dS=class extends fl{constructor(e={}){super();q(this,zr,void 0);q(this,qn,void 0);q(this,Jc,void 0);this.config=e,U(this,zr,new Set),U(this,qn,new Map),U(this,Jc,0)}build(e,n,r){const i=new b2({mutationCache:this,mutationId:++Nu(this,Jc)._,options:e.defaultMutationOptions(n),state:r});return this.add(i),i}add(e){_(this,zr).add(e);const n=ed(e);if(typeof n=="string"){const r=_(this,qn).get(n);r?r.push(e):_(this,qn).set(n,[e])}this.notify({type:"added",mutation:e})}remove(e){if(_(this,zr).delete(e)){const n=ed(e);if(typeof n=="string"){const r=_(this,qn).get(n);if(r)if(r.length>1){const i=r.indexOf(e);i!==-1&&r.splice(i,1)}else r[0]===e&&_(this,qn).delete(n)}}this.notify({type:"removed",mutation:e})}canRun(e){const n=ed(e);if(typeof n=="string"){const r=_(this,qn).get(n),i=r==null?void 0:r.find(o=>o.state.status==="pending");return!i||i===e}else return!0}runNext(e){var r;const n=ed(e);if(typeof n=="string"){const i=(r=_(this,qn).get(n))==null?void 0:r.find(o=>o!==e&&o.state.isPaused);return(i==null?void 0:i.continue())??Promise.resolve()}else return Promise.resolve()}clear(){Je.batch(()=>{_(this,zr).forEach(e=>{this.notify({type:"removed",mutation:e})}),_(this,zr).clear(),_(this,qn).clear()})}getAll(){return Array.from(_(this,zr))}find(e){const n={exact:!0,...e};return this.getAll().find(r=>_w(n,r))}findAll(e={}){return this.getAll().filter(n=>_w(e,n))}notify(e){Je.batch(()=>{this.listeners.forEach(n=>{n(e)})})}resumePausedMutations(){const e=this.getAll().filter(n=>n.state.isPaused);return Je.batch(()=>Promise.all(e.map(n=>n.continue().catch(kn))))}},zr=new WeakMap,qn=new WeakMap,Jc=new WeakMap,dS);function ed(t){var e;return(e=t.options.scope)==null?void 0:e.id}function Pw(t){return{onFetch:(e,n)=>{var u,d,f,p,m;const r=e.options,i=(f=(d=(u=e.fetchOptions)==null?void 0:u.meta)==null?void 0:d.fetchMore)==null?void 0:f.direction,o=((p=e.state.data)==null?void 0:p.pages)||[],s=((m=e.state.data)==null?void 0:m.pageParams)||[];let a={pages:[],pageParams:[]},l=0;const c=async()=>{let g=!1;const v=S=>{Object.defineProperty(S,"signal",{enumerable:!0,get:()=>(e.signal.aborted?g=!0:e.signal.addEventListener("abort",()=>{g=!0}),e.signal)})},x=Hk(e.options,e.fetchOptions),w=async(S,b,C)=>{if(g)return Promise.reject();if(b==null&&S.pages.length)return Promise.resolve(S);const k={client:e.client,queryKey:e.queryKey,pageParam:b,direction:C?"backward":"forward",meta:e.options.meta};v(k);const E=await x(k),{maxPages:T}=e.options,O=C?h2:f2;return{pages:O(S.pages,E,T),pageParams:O(S.pageParams,b,T)}};if(i&&o.length){const S=i==="backward",b=S?C2:Mw,C={pages:o,pageParams:s},k=b(r,C);a=await w(C,k,S)}else{const S=t??o.length;do{const b=l===0?s[0]??r.initialPageParam:Mw(r,a);if(l>0&&b==null)break;a=await w(a,b),l++}while(l<S)}return a};e.options.persister?e.fetchFn=()=>{var g,v;return(v=(g=e.options).persister)==null?void 0:v.call(g,c,{client:e.client,queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},n)}:e.fetchFn=c}}}function Mw(t,{pages:e,pageParams:n}){const r=e.length-1;return e.length>0?t.getNextPageParam(e[r],e,n[r],n):void 0}function C2(t,{pages:e,pageParams:n}){var r;return e.length>0?(r=t.getPreviousPageParam)==null?void 0:r.call(t,e[0],e,n[0],n):void 0}var Le,Ti,_i,Ta,_a,Ri,Ra,Oa,fS,Qk=(fS=class{constructor(t={}){q(this,Le,void 0);q(this,Ti,void 0);q(this,_i,void 0);q(this,Ta,void 0);q(this,_a,void 0);q(this,Ri,void 0);q(this,Ra,void 0);q(this,Oa,void 0);U(this,Le,t.queryCache||new w2),U(this,Ti,t.mutationCache||new S2),U(this,_i,t.defaultOptions||{}),U(this,Ta,new Map),U(this,_a,new Map),U(this,Ri,0)}mount(){Nu(this,Ri)._++,_(this,Ri)===1&&(U(this,Ra,Vv.subscribe(async t=>{t&&(await this.resumePausedMutations(),_(this,Le).onFocus())})),U(this,Oa,bf.subscribe(async t=>{t&&(await this.resumePausedMutations(),_(this,Le).onOnline())})))}unmount(){var t,e;Nu(this,Ri)._--,_(this,Ri)===0&&((t=_(this,Ra))==null||t.call(this),U(this,Ra,void 0),(e=_(this,Oa))==null||e.call(this),U(this,Oa,void 0))}isFetching(t){return _(this,Le).findAll({...t,fetchStatus:"fetching"}).length}isMutating(t){return _(this,Ti).findAll({...t,status:"pending"}).length}getQueryData(t){var n;const e=this.defaultQueryOptions({queryKey:t});return(n=_(this,Le).get(e.queryHash))==null?void 0:n.state.data}ensureQueryData(t){const e=this.defaultQueryOptions(t),n=_(this,Le).build(this,e),r=n.state.data;return r===void 0?this.fetchQuery(t):(t.revalidateIfStale&&n.isStaleByTime(pa(e.staleTime,n))&&this.prefetchQuery(e),Promise.resolve(r))}getQueriesData(t){return _(this,Le).findAll(t).map(({queryKey:e,state:n})=>{const r=n.data;return[e,r]})}setQueryData(t,e,n){const r=this.defaultQueryOptions({queryKey:t}),i=_(this,Le).get(r.queryHash),o=i==null?void 0:i.state.data,s=u2(e,o);if(s!==void 0)return _(this,Le).build(this,r).setData(s,{...n,manual:!0})}setQueriesData(t,e,n){return Je.batch(()=>_(this,Le).findAll(t).map(({queryKey:r})=>[r,this.setQueryData(r,e,n)]))}getQueryState(t){var n;const e=this.defaultQueryOptions({queryKey:t});return(n=_(this,Le).get(e.queryHash))==null?void 0:n.state}removeQueries(t){const e=_(this,Le);Je.batch(()=>{e.findAll(t).forEach(n=>{e.remove(n)})})}resetQueries(t,e){const n=_(this,Le);return Je.batch(()=>(n.findAll(t).forEach(r=>{r.reset()}),this.refetchQueries({type:"active",...t},e)))}cancelQueries(t,e={}){const n={revert:!0,...e},r=Je.batch(()=>_(this,Le).findAll(t).map(i=>i.cancel(n)));return Promise.all(r).then(kn).catch(kn)}invalidateQueries(t,e={}){return Je.batch(()=>(_(this,Le).findAll(t).forEach(n=>{n.invalidate()}),(t==null?void 0:t.refetchType)==="none"?Promise.resolve():this.refetchQueries({...t,type:(t==null?void 0:t.refetchType)??(t==null?void 0:t.type)??"active"},e)))}refetchQueries(t,e={}){const n={...e,cancelRefetch:e.cancelRefetch??!0},r=Je.batch(()=>_(this,Le).findAll(t).filter(i=>!i.isDisabled()).map(i=>{let o=i.fetch(void 0,n);return n.throwOnError||(o=o.catch(kn)),i.state.fetchStatus==="paused"?Promise.resolve():o}));return Promise.all(r).then(kn)}fetchQuery(t){const e=this.defaultQueryOptions(t);e.retry===void 0&&(e.retry=!1);const n=_(this,Le).build(this,e);return n.isStaleByTime(pa(e.staleTime,n))?n.fetch(e):Promise.resolve(n.state.data)}prefetchQuery(t){return this.fetchQuery(t).then(kn).catch(kn)}fetchInfiniteQuery(t){return t.behavior=Pw(t.pages),this.fetchQuery(t)}prefetchInfiniteQuery(t){return this.fetchInfiniteQuery(t).then(kn).catch(kn)}ensureInfiniteQueryData(t){return t.behavior=Pw(t.pages),this.ensureQueryData(t)}resumePausedMutations(){return bf.isOnline()?_(this,Ti).resumePausedMutations():Promise.resolve()}getQueryCache(){return _(this,Le)}getMutationCache(){return _(this,Ti)}getDefaultOptions(){return _(this,_i)}setDefaultOptions(t){U(this,_i,t)}setQueryDefaults(t,e){_(this,Ta).set(hs(t),{queryKey:t,defaultOptions:e})}getQueryDefaults(t){const e=[..._(this,Ta).values()],n={};return e.forEach(r=>{Tc(t,r.queryKey)&&Object.assign(n,r.defaultOptions)}),n}setMutationDefaults(t,e){_(this,_a).set(hs(t),{mutationKey:t,defaultOptions:e})}getMutationDefaults(t){const e=[..._(this,_a).values()],n={};return e.forEach(r=>{Tc(t,r.mutationKey)&&Object.assign(n,r.defaultOptions)}),n}defaultQueryOptions(t){if(t._defaulted)return t;const e={..._(this,_i).queries,...this.getQueryDefaults(t.queryKey),...t,_defaulted:!0};return e.queryHash||(e.queryHash=zv(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.queryFn===Uv&&(e.enabled=!1),e}defaultMutationOptions(t){return t!=null&&t._defaulted?t:{..._(this,_i).mutations,...(t==null?void 0:t.mutationKey)&&this.getMutationDefaults(t.mutationKey),...t,_defaulted:!0}}clear(){_(this,Le).clear(),_(this,Ti).clear()}},Le=new WeakMap,Ti=new WeakMap,_i=new WeakMap,Ta=new WeakMap,_a=new WeakMap,Ri=new WeakMap,Ra=new WeakMap,Oa=new WeakMap,fS),Kt,ue,Yc,Ot,Wo,Pa,Oi,yr,Qc,Ma,Aa,Ko,qo,Pi,Da,Go,Ll,Xc,Og,Zc,Pg,eu,Mg,tu,Ag,nu,Dg,ru,Ig,iu,Ng,Xf,Xk,hS,k2=(hS=class extends fl{constructor(e,n){super();q(this,Go);q(this,Xc);q(this,Zc);q(this,eu);q(this,tu);q(this,nu);q(this,ru);q(this,iu);q(this,Xf);q(this,Kt,void 0);q(this,ue,void 0);q(this,Yc,void 0);q(this,Ot,void 0);q(this,Wo,void 0);q(this,Pa,void 0);q(this,Oi,void 0);q(this,yr,void 0);q(this,Qc,void 0);q(this,Ma,void 0);q(this,Aa,void 0);q(this,Ko,void 0);q(this,qo,void 0);q(this,Pi,void 0);q(this,Da,new Set);this.options=n,U(this,Kt,e),U(this,yr,null),U(this,Oi,Rg()),this.options.experimental_prefetchInRender||_(this,Oi).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(n)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(_(this,ue).addObserver(this),Aw(_(this,ue),this.options)?se(this,Go,Ll).call(this):this.updateResult(),se(this,tu,Ag).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return jg(_(this,ue),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return jg(_(this,ue),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,se(this,nu,Dg).call(this),se(this,ru,Ig).call(this),_(this,ue).removeObserver(this)}setOptions(e,n){const r=this.options,i=_(this,ue);if(this.options=_(this,Kt).defaultQueryOptions(e),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof Qn(this.options.enabled,_(this,ue))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");se(this,iu,Ng).call(this),_(this,ue).setOptions(this.options),r._defaulted&&!wf(this.options,r)&&_(this,Kt).getQueryCache().notify({type:"observerOptionsUpdated",query:_(this,ue),observer:this});const o=this.hasListeners();o&&Dw(_(this,ue),i,this.options,r)&&se(this,Go,Ll).call(this),this.updateResult(n),o&&(_(this,ue)!==i||Qn(this.options.enabled,_(this,ue))!==Qn(r.enabled,_(this,ue))||pa(this.options.staleTime,_(this,ue))!==pa(r.staleTime,_(this,ue)))&&se(this,Xc,Og).call(this);const s=se(this,Zc,Pg).call(this);o&&(_(this,ue)!==i||Qn(this.options.enabled,_(this,ue))!==Qn(r.enabled,_(this,ue))||s!==_(this,Pi))&&se(this,eu,Mg).call(this,s)}getOptimisticResult(e){const n=_(this,Kt).getQueryCache().build(_(this,Kt),e),r=this.createResult(n,e);return T2(this,r)&&(U(this,Ot,r),U(this,Pa,this.options),U(this,Wo,_(this,ue).state)),r}getCurrentResult(){return _(this,Ot)}trackResult(e,n){const r={};return Object.keys(e).forEach(i=>{Object.defineProperty(r,i,{configurable:!1,enumerable:!0,get:()=>(this.trackProp(i),n==null||n(i),e[i])})}),r}trackProp(e){_(this,Da).add(e)}getCurrentQuery(){return _(this,ue)}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){const n=_(this,Kt).defaultQueryOptions(e),r=_(this,Kt).getQueryCache().build(_(this,Kt),n);return r.fetch().then(()=>this.createResult(r,n))}fetch(e){return se(this,Go,Ll).call(this,{...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),_(this,Ot)))}createResult(e,n){var T;const r=_(this,ue),i=this.options,o=_(this,Ot),s=_(this,Wo),a=_(this,Pa),c=e!==r?e.state:_(this,Yc),{state:u}=e;let d={...u},f=!1,p;if(n._optimisticResults){const O=this.hasListeners(),R=!O&&Aw(e,n),I=O&&Dw(e,r,n,i);(R||I)&&(d={...d,...Jk(u.data,e.options)}),n._optimisticResults==="isRestoring"&&(d.fetchStatus="idle")}let{error:m,errorUpdatedAt:g,status:v}=d;if(n.select&&d.data!==void 0)if(o&&d.data===(s==null?void 0:s.data)&&n.select===_(this,Qc))p=_(this,Ma);else try{U(this,Qc,n.select),p=n.select(d.data),p=_g(o==null?void 0:o.data,p,n),U(this,Ma,p),U(this,yr,null)}catch(O){U(this,yr,O)}else p=d.data;if(n.placeholderData!==void 0&&p===void 0&&v==="pending"){let O;if(o!=null&&o.isPlaceholderData&&n.placeholderData===(a==null?void 0:a.placeholderData))O=o.data;else if(O=typeof n.placeholderData=="function"?n.placeholderData((T=_(this,Aa))==null?void 0:T.state.data,_(this,Aa)):n.placeholderData,n.select&&O!==void 0)try{O=n.select(O),U(this,yr,null)}catch(R){U(this,yr,R)}O!==void 0&&(v="success",p=_g(o==null?void 0:o.data,O,n),f=!0)}_(this,yr)&&(m=_(this,yr),p=_(this,Ma),g=Date.now(),v="error");const x=d.fetchStatus==="fetching",w=v==="pending",S=v==="error",b=w&&x,C=p!==void 0,E={status:v,fetchStatus:d.fetchStatus,isPending:w,isSuccess:v==="success",isError:S,isInitialLoading:b,isLoading:b,data:p,dataUpdatedAt:d.dataUpdatedAt,error:m,errorUpdatedAt:g,failureCount:d.fetchFailureCount,failureReason:d.fetchFailureReason,errorUpdateCount:d.errorUpdateCount,isFetched:d.dataUpdateCount>0||d.errorUpdateCount>0,isFetchedAfterMount:d.dataUpdateCount>c.dataUpdateCount||d.errorUpdateCount>c.errorUpdateCount,isFetching:x,isRefetching:x&&!w,isLoadingError:S&&!C,isPaused:d.fetchStatus==="paused",isPlaceholderData:f,isRefetchError:S&&C,isStale:Hv(e,n),refetch:this.refetch,promise:_(this,Oi)};if(this.options.experimental_prefetchInRender){const O=$=>{E.status==="error"?$.reject(E.error):E.data!==void 0&&$.resolve(E.data)},R=()=>{const $=U(this,Oi,E.promise=Rg());O($)},I=_(this,Oi);switch(I.status){case"pending":e.queryHash===r.queryHash&&O(I);break;case"fulfilled":(E.status==="error"||E.data!==I.value)&&R();break;case"rejected":(E.status!=="error"||E.error!==I.reason)&&R();break}}return E}updateResult(e){const n=_(this,Ot),r=this.createResult(_(this,ue),this.options);if(U(this,Wo,_(this,ue).state),U(this,Pa,this.options),_(this,Wo).data!==void 0&&U(this,Aa,_(this,ue)),wf(r,n))return;U(this,Ot,r);const i={},o=()=>{if(!n)return!0;const{notifyOnChangeProps:s}=this.options,a=typeof s=="function"?s():s;if(a==="all"||!a&&!_(this,Da).size)return!0;const l=new Set(a??_(this,Da));return this.options.throwOnError&&l.add("error"),Object.keys(_(this,Ot)).some(c=>{const u=c;return _(this,Ot)[u]!==n[u]&&l.has(u)})};(e==null?void 0:e.listeners)!==!1&&o()&&(i.listeners=!0),se(this,Xf,Xk).call(this,{...i,...e})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&se(this,tu,Ag).call(this)}},Kt=new WeakMap,ue=new WeakMap,Yc=new WeakMap,Ot=new WeakMap,Wo=new WeakMap,Pa=new WeakMap,Oi=new WeakMap,yr=new WeakMap,Qc=new WeakMap,Ma=new WeakMap,Aa=new WeakMap,Ko=new WeakMap,qo=new WeakMap,Pi=new WeakMap,Da=new WeakMap,Go=new WeakSet,Ll=function(e){se(this,iu,Ng).call(this);let n=_(this,ue).fetch(this.options,e);return e!=null&&e.throwOnError||(n=n.catch(kn)),n},Xc=new WeakSet,Og=function(){se(this,nu,Dg).call(this);const e=pa(this.options.staleTime,_(this,ue));if(fs||_(this,Ot).isStale||!Eg(e))return;const r=Uk(_(this,Ot).dataUpdatedAt,e)+1;U(this,Ko,setTimeout(()=>{_(this,Ot).isStale||this.updateResult()},r))},Zc=new WeakSet,Pg=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(_(this,ue)):this.options.refetchInterval)??!1},eu=new WeakSet,Mg=function(e){se(this,ru,Ig).call(this),U(this,Pi,e),!(fs||Qn(this.options.enabled,_(this,ue))===!1||!Eg(_(this,Pi))||_(this,Pi)===0)&&U(this,qo,setInterval(()=>{(this.options.refetchIntervalInBackground||Vv.isFocused())&&se(this,Go,Ll).call(this)},_(this,Pi)))},tu=new WeakSet,Ag=function(){se(this,Xc,Og).call(this),se(this,eu,Mg).call(this,se(this,Zc,Pg).call(this))},nu=new WeakSet,Dg=function(){_(this,Ko)&&(clearTimeout(_(this,Ko)),U(this,Ko,void 0))},ru=new WeakSet,Ig=function(){_(this,qo)&&(clearInterval(_(this,qo)),U(this,qo,void 0))},iu=new WeakSet,Ng=function(){const e=_(this,Kt).getQueryCache().build(_(this,Kt),this.options);if(e===_(this,ue))return;const n=_(this,ue);U(this,ue,e),U(this,Yc,e.state),this.hasListeners()&&(n==null||n.removeObserver(this),e.addObserver(this))},Xf=new WeakSet,Xk=function(e){Je.batch(()=>{e.listeners&&this.listeners.forEach(n=>{n(_(this,Ot))}),_(this,Kt).getQueryCache().notify({query:_(this,ue),type:"observerResultsUpdated"})})},hS);function E2(t,e){return Qn(e.enabled,t)!==!1&&t.state.data===void 0&&!(t.state.status==="error"&&e.retryOnMount===!1)}function Aw(t,e){return E2(t,e)||t.state.data!==void 0&&jg(t,e,e.refetchOnMount)}function jg(t,e,n){if(Qn(e.enabled,t)!==!1){const r=typeof n=="function"?n(t):n;return r==="always"||r!==!1&&Hv(t,e)}return!1}function Dw(t,e,n,r){return(t!==e||Qn(r.enabled,t)===!1)&&(!n.suspense||t.state.status!=="error")&&Hv(t,n)}function Hv(t,e){return Qn(e.enabled,t)!==!1&&t.isStaleByTime(pa(e.staleTime,t))}function T2(t,e){return!wf(t.getCurrentResult(),e)}var Mi,Ai,qt,Ur,Ia,$d,ou,Lg,pS,_2=(pS=class extends fl{constructor(n,r){super();q(this,Ia);q(this,ou);q(this,Mi,void 0);q(this,Ai,void 0);q(this,qt,void 0);q(this,Ur,void 0);U(this,Mi,n),this.setOptions(r),this.bindMethods(),se(this,Ia,$d).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(n){var i;const r=this.options;this.options=_(this,Mi).defaultMutationOptions(n),wf(this.options,r)||_(this,Mi).getMutationCache().notify({type:"observerOptionsUpdated",mutation:_(this,qt),observer:this}),r!=null&&r.mutationKey&&this.options.mutationKey&&hs(r.mutationKey)!==hs(this.options.mutationKey)?this.reset():((i=_(this,qt))==null?void 0:i.state.status)==="pending"&&_(this,qt).setOptions(this.options)}onUnsubscribe(){var n;this.hasListeners()||(n=_(this,qt))==null||n.removeObserver(this)}onMutationUpdate(n){se(this,Ia,$d).call(this),se(this,ou,Lg).call(this,n)}getCurrentResult(){return _(this,Ai)}reset(){var n;(n=_(this,qt))==null||n.removeObserver(this),U(this,qt,void 0),se(this,Ia,$d).call(this),se(this,ou,Lg).call(this)}mutate(n,r){var i;return U(this,Ur,r),(i=_(this,qt))==null||i.removeObserver(this),U(this,qt,_(this,Mi).getMutationCache().build(_(this,Mi),this.options)),_(this,qt).addObserver(this),_(this,qt).execute(n)}},Mi=new WeakMap,Ai=new WeakMap,qt=new WeakMap,Ur=new WeakMap,Ia=new WeakSet,$d=function(){var r;const n=((r=_(this,qt))==null?void 0:r.state)??Yk();U(this,Ai,{...n,isPending:n.status==="pending",isSuccess:n.status==="success",isError:n.status==="error",isIdle:n.status==="idle",mutate:this.mutate,reset:this.reset})},ou=new WeakSet,Lg=function(n){Je.batch(()=>{var r,i,o,s,a,l,c,u;if(_(this,Ur)&&this.hasListeners()){const d=_(this,Ai).variables,f=_(this,Ai).context;(n==null?void 0:n.type)==="success"?((i=(r=_(this,Ur)).onSuccess)==null||i.call(r,n.data,d,f),(s=(o=_(this,Ur)).onSettled)==null||s.call(o,n.data,null,d,f)):(n==null?void 0:n.type)==="error"&&((l=(a=_(this,Ur)).onError)==null||l.call(a,n.error,d,f),(u=(c=_(this,Ur)).onSettled)==null||u.call(c,void 0,n.error,d,f))}this.listeners.forEach(d=>{d(_(this,Ai))})})},pS),Zk=y.createContext(void 0),uo=t=>{const e=y.useContext(Zk);if(t)return t;if(!e)throw new Error("No QueryClient set, use QueryClientProvider to set one");return e},eE=({client:t,children:e})=>(y.useEffect(()=>(t.mount(),()=>{t.unmount()}),[t]),h.jsx(Zk.Provider,{value:t,children:e})),tE=y.createContext(!1),R2=()=>y.useContext(tE);tE.Provider;function O2(){let t=!1;return{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t}}var P2=y.createContext(O2()),M2=()=>y.useContext(P2);function nE(t,e){return typeof t=="function"?t(...e):!!t}function $g(){}var A2=(t,e)=>{(t.suspense||t.throwOnError||t.experimental_prefetchInRender)&&(e.isReset()||(t.retryOnMount=!1))},D2=t=>{y.useEffect(()=>{t.clearReset()},[t])},I2=({result:t,errorResetBoundary:e,throwOnError:n,query:r,suspense:i})=>t.isError&&!e.isReset()&&!t.isFetching&&r&&(i&&t.data===void 0||nE(n,[t.error,r])),N2=t=>{const e=t.staleTime;t.suspense&&(t.staleTime=typeof e=="function"?(...n)=>Math.max(e(...n),1e3):Math.max(e??1e3,1e3),typeof t.gcTime=="number"&&(t.gcTime=Math.max(t.gcTime,1e3)))},j2=(t,e)=>t.isLoading&&t.isFetching&&!e,L2=(t,e)=>(t==null?void 0:t.suspense)&&e.isPending,Iw=(t,e,n)=>e.fetchOptimistic(t).catch(()=>{n.clearReset()});function $2(t,e,n){var d,f,p,m,g;const r=uo(n),i=R2(),o=M2(),s=r.defaultQueryOptions(t);(f=(d=r.getDefaultOptions().queries)==null?void 0:d._experimental_beforeQuery)==null||f.call(d,s),s._optimisticResults=i?"isRestoring":"optimistic",N2(s),A2(s,o),D2(o);const a=!r.getQueryCache().get(s.queryHash),[l]=y.useState(()=>new e(r,s)),c=l.getOptimisticResult(s),u=!i&&t.subscribed!==!1;if(y.useSyncExternalStore(y.useCallback(v=>{const x=u?l.subscribe(Je.batchCalls(v)):$g;return l.updateResult(),x},[l,u]),()=>l.getCurrentResult(),()=>l.getCurrentResult()),y.useEffect(()=>{l.setOptions(s,{listeners:!1})},[s,l]),L2(s,c))throw Iw(s,l,o);if(I2({result:c,errorResetBoundary:o,throwOnError:s.throwOnError,query:r.getQueryCache().get(s.queryHash),suspense:s.suspense}))throw c.error;if((m=(p=r.getDefaultOptions().queries)==null?void 0:p._experimental_afterQuery)==null||m.call(p,s,c),s.experimental_prefetchInRender&&!fs&&j2(c,i)){const v=a?Iw(s,l,o):(g=r.getQueryCache().get(s.queryHash))==null?void 0:g.promise;v==null||v.catch($g).finally(()=>{l.updateResult()})}return s.notifyOnChangeProps?c:l.trackResult(c)}function _c(t,e){return $2(t,k2,e)}function Rc(t,e){const n=uo(e),[r]=y.useState(()=>new _2(n,t));y.useEffect(()=>{r.setOptions(t)},[r,t]);const i=y.useSyncExternalStore(y.useCallback(s=>r.subscribe(Je.batchCalls(s)),[r]),()=>r.getCurrentResult(),()=>r.getCurrentResult()),o=y.useCallback((s,a)=>{r.mutate(s,a).catch($g)},[r]);if(i.error&&nE(r.options.throwOnError,[i.error]))throw i.error;return{...i,mutate:o,mutateAsync:i.mutate}}const F2=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>ds(()=>Promise.resolve().then(()=>hl),void 0).then(({default:r})=>r(...n)):e=fetch,(...n)=>e(...n)};class Wv extends Error{constructor(e,n="FunctionsError",r){super(e),this.name=n,this.context=r}}class B2 extends Wv{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class z2 extends Wv{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class U2 extends Wv{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Fg;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(Fg||(Fg={}));var V2=globalThis&&globalThis.__awaiter||function(t,e,n,r){function i(o){return o instanceof n?o:new n(function(s){s(o)})}return new(n||(n=Promise))(function(o,s){function a(u){try{c(r.next(u))}catch(d){s(d)}}function l(u){try{c(r.throw(u))}catch(d){s(d)}}function c(u){u.done?o(u.value):i(u.value).then(a,l)}c((r=r.apply(t,e||[])).next())})};class H2{constructor(e,{headers:n={},customFetch:r,region:i=Fg.Any}={}){this.url=e,this.headers=n,this.region=i,this.fetch=F2(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,n={}){var r;return V2(this,void 0,void 0,function*(){try{const{headers:i,method:o,body:s}=n;let a={},{region:l}=n;l||(l=this.region),l&&l!=="any"&&(a["x-region"]=l);let c;s&&(i&&!Object.prototype.hasOwnProperty.call(i,"Content-Type")||!i)&&(typeof Blob<"u"&&s instanceof Blob||s instanceof ArrayBuffer?(a["Content-Type"]="application/octet-stream",c=s):typeof s=="string"?(a["Content-Type"]="text/plain",c=s):typeof FormData<"u"&&s instanceof FormData?c=s:(a["Content-Type"]="application/json",c=JSON.stringify(s)));const u=yield this.fetch(`${this.url}/${e}`,{method:o||"POST",headers:Object.assign(Object.assign(Object.assign({},a),this.headers),i),body:c}).catch(m=>{throw new B2(m)}),d=u.headers.get("x-relay-error");if(d&&d==="true")throw new z2(u);if(!u.ok)throw new U2(u);let f=((r=u.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),p;return f==="application/json"?p=yield u.json():f==="application/octet-stream"?p=yield u.blob():f==="text/event-stream"?p=u:f==="multipart/form-data"?p=yield u.formData():p=yield u.text(),{data:p,error:null}}catch(i){return{data:null,error:i}}})}}var Yt={},Kv={},yh={},pu={},vh={},xh={},W2=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Ua=W2();const K2=Ua.fetch,rE=Ua.fetch.bind(Ua),iE=Ua.Headers,q2=Ua.Request,G2=Ua.Response,hl=Object.freeze(Object.defineProperty({__proto__:null,Headers:iE,Request:q2,Response:G2,default:rE,fetch:K2},Symbol.toStringTag,{value:"Module"})),J2=ZO(hl);var wh={};Object.defineProperty(wh,"__esModule",{value:!0});let Y2=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}};wh.default=Y2;var oE=Nn&&Nn.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(xh,"__esModule",{value:!0});const Q2=oE(J2),X2=oE(wh);let Z2=class{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=Q2.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,n){return this.headers=Object.assign({},this.headers),this.headers[e]=n,this}then(e,n){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const r=this.fetch;let i=r(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async o=>{var s,a,l;let c=null,u=null,d=null,f=o.status,p=o.statusText;if(o.ok){if(this.method!=="HEAD"){const x=await o.text();x===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?u=x:u=JSON.parse(x))}const g=(s=this.headers.Prefer)===null||s===void 0?void 0:s.match(/count=(exact|planned|estimated)/),v=(a=o.headers.get("content-range"))===null||a===void 0?void 0:a.split("/");g&&v&&v.length>1&&(d=parseInt(v[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(u)&&(u.length>1?(c={code:"PGRST116",details:`Results contain ${u.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},u=null,d=null,f=406,p="Not Acceptable"):u.length===1?u=u[0]:u=null)}else{const g=await o.text();try{c=JSON.parse(g),Array.isArray(c)&&o.status===404&&(u=[],c=null,f=200,p="OK")}catch{o.status===404&&g===""?(f=204,p="No Content"):c={message:g}}if(c&&this.isMaybeSingle&&(!((l=c==null?void 0:c.details)===null||l===void 0)&&l.includes("0 rows"))&&(c=null,f=200,p="OK"),c&&this.shouldThrowOnError)throw new X2.default(c)}return{error:c,data:u,count:d,status:f,statusText:p}});return this.shouldThrowOnError||(i=i.catch(o=>{var s,a,l;return{error:{message:`${(s=o==null?void 0:o.name)!==null&&s!==void 0?s:"FetchError"}: ${o==null?void 0:o.message}`,details:`${(a=o==null?void 0:o.stack)!==null&&a!==void 0?a:""}`,hint:"",code:`${(l=o==null?void 0:o.code)!==null&&l!==void 0?l:""}`},data:null,count:null,status:0,statusText:""}})),i.then(e,n)}returns(){return this}overrideTypes(){return this}};xh.default=Z2;var eI=Nn&&Nn.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(vh,"__esModule",{value:!0});const tI=eI(xh);let nI=class extends tI.default{select(e){let n=!1;const r=(e??"*").split("").map(i=>/\s/.test(i)&&!n?"":(i==='"'&&(n=!n),i)).join("");return this.url.searchParams.set("select",r),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:n=!0,nullsFirst:r,foreignTable:i,referencedTable:o=i}={}){const s=o?`${o}.order`:"order",a=this.url.searchParams.get(s);return this.url.searchParams.set(s,`${a?`${a},`:""}${e}.${n?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:n,referencedTable:r=n}={}){const i=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(i,`${e}`),this}range(e,n,{foreignTable:r,referencedTable:i=r}={}){const o=typeof i>"u"?"offset":`${i}.offset`,s=typeof i>"u"?"limit":`${i}.limit`;return this.url.searchParams.set(o,`${e}`),this.url.searchParams.set(s,`${n-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:n=!1,settings:r=!1,buffers:i=!1,wal:o=!1,format:s="text"}={}){var a;const l=[e?"analyze":null,n?"verbose":null,r?"settings":null,i?"buffers":null,o?"wal":null].filter(Boolean).join("|"),c=(a=this.headers.Accept)!==null&&a!==void 0?a:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${s}; for="${c}"; options=${l};`,s==="json"?this:this}rollback(){var e;return((e=this.headers.Prefer)!==null&&e!==void 0?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};vh.default=nI;var rI=Nn&&Nn.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(pu,"__esModule",{value:!0});const iI=rI(vh);let oI=class extends iI.default{eq(e,n){return this.url.searchParams.append(e,`eq.${n}`),this}neq(e,n){return this.url.searchParams.append(e,`neq.${n}`),this}gt(e,n){return this.url.searchParams.append(e,`gt.${n}`),this}gte(e,n){return this.url.searchParams.append(e,`gte.${n}`),this}lt(e,n){return this.url.searchParams.append(e,`lt.${n}`),this}lte(e,n){return this.url.searchParams.append(e,`lte.${n}`),this}like(e,n){return this.url.searchParams.append(e,`like.${n}`),this}likeAllOf(e,n){return this.url.searchParams.append(e,`like(all).{${n.join(",")}}`),this}likeAnyOf(e,n){return this.url.searchParams.append(e,`like(any).{${n.join(",")}}`),this}ilike(e,n){return this.url.searchParams.append(e,`ilike.${n}`),this}ilikeAllOf(e,n){return this.url.searchParams.append(e,`ilike(all).{${n.join(",")}}`),this}ilikeAnyOf(e,n){return this.url.searchParams.append(e,`ilike(any).{${n.join(",")}}`),this}is(e,n){return this.url.searchParams.append(e,`is.${n}`),this}in(e,n){const r=Array.from(new Set(n)).map(i=>typeof i=="string"&&new RegExp("[,()]").test(i)?`"${i}"`:`${i}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}contains(e,n){return typeof n=="string"?this.url.searchParams.append(e,`cs.${n}`):Array.isArray(n)?this.url.searchParams.append(e,`cs.{${n.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(n)}`),this}containedBy(e,n){return typeof n=="string"?this.url.searchParams.append(e,`cd.${n}`):Array.isArray(n)?this.url.searchParams.append(e,`cd.{${n.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(n)}`),this}rangeGt(e,n){return this.url.searchParams.append(e,`sr.${n}`),this}rangeGte(e,n){return this.url.searchParams.append(e,`nxl.${n}`),this}rangeLt(e,n){return this.url.searchParams.append(e,`sl.${n}`),this}rangeLte(e,n){return this.url.searchParams.append(e,`nxr.${n}`),this}rangeAdjacent(e,n){return this.url.searchParams.append(e,`adj.${n}`),this}overlaps(e,n){return typeof n=="string"?this.url.searchParams.append(e,`ov.${n}`):this.url.searchParams.append(e,`ov.{${n.join(",")}}`),this}textSearch(e,n,{config:r,type:i}={}){let o="";i==="plain"?o="pl":i==="phrase"?o="ph":i==="websearch"&&(o="w");const s=r===void 0?"":`(${r})`;return this.url.searchParams.append(e,`${o}fts${s}.${n}`),this}match(e){return Object.entries(e).forEach(([n,r])=>{this.url.searchParams.append(n,`eq.${r}`)}),this}not(e,n,r){return this.url.searchParams.append(e,`not.${n}.${r}`),this}or(e,{foreignTable:n,referencedTable:r=n}={}){const i=r?`${r}.or`:"or";return this.url.searchParams.append(i,`(${e})`),this}filter(e,n,r){return this.url.searchParams.append(e,`${n}.${r}`),this}};pu.default=oI;var sI=Nn&&Nn.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(yh,"__esModule",{value:!0});const Ol=sI(pu);let aI=class{constructor(e,{headers:n={},schema:r,fetch:i}){this.url=e,this.headers=n,this.schema=r,this.fetch=i}select(e,{head:n=!1,count:r}={}){const i=n?"HEAD":"GET";let o=!1;const s=(e??"*").split("").map(a=>/\s/.test(a)&&!o?"":(a==='"'&&(o=!o),a)).join("");return this.url.searchParams.set("select",s),r&&(this.headers.Prefer=`count=${r}`),new Ol.default({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:n,defaultToNull:r=!0}={}){const i="POST",o=[];if(this.headers.Prefer&&o.push(this.headers.Prefer),n&&o.push(`count=${n}`),r||o.push("missing=default"),this.headers.Prefer=o.join(","),Array.isArray(e)){const s=e.reduce((a,l)=>a.concat(Object.keys(l)),[]);if(s.length>0){const a=[...new Set(s)].map(l=>`"${l}"`);this.url.searchParams.set("columns",a.join(","))}}return new Ol.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:n,ignoreDuplicates:r=!1,count:i,defaultToNull:o=!0}={}){const s="POST",a=[`resolution=${r?"ignore":"merge"}-duplicates`];if(n!==void 0&&this.url.searchParams.set("on_conflict",n),this.headers.Prefer&&a.push(this.headers.Prefer),i&&a.push(`count=${i}`),o||a.push("missing=default"),this.headers.Prefer=a.join(","),Array.isArray(e)){const l=e.reduce((c,u)=>c.concat(Object.keys(u)),[]);if(l.length>0){const c=[...new Set(l)].map(u=>`"${u}"`);this.url.searchParams.set("columns",c.join(","))}}return new Ol.default({method:s,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:n}={}){const r="PATCH",i=[];return this.headers.Prefer&&i.push(this.headers.Prefer),n&&i.push(`count=${n}`),this.headers.Prefer=i.join(","),new Ol.default({method:r,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){const n="DELETE",r=[];return e&&r.push(`count=${e}`),this.headers.Prefer&&r.unshift(this.headers.Prefer),this.headers.Prefer=r.join(","),new Ol.default({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};yh.default=aI;var bh={},Sh={};Object.defineProperty(Sh,"__esModule",{value:!0});Sh.version=void 0;Sh.version="0.0.0-automated";Object.defineProperty(bh,"__esModule",{value:!0});bh.DEFAULT_HEADERS=void 0;const lI=Sh;bh.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${lI.version}`};var sE=Nn&&Nn.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Kv,"__esModule",{value:!0});const cI=sE(yh),uI=sE(pu),dI=bh;let fI=class aE{constructor(e,{headers:n={},schema:r,fetch:i}={}){this.url=e,this.headers=Object.assign(Object.assign({},dI.DEFAULT_HEADERS),n),this.schemaName=r,this.fetch=i}from(e){const n=new URL(`${this.url}/${e}`);return new cI.default(n,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new aE(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,n={},{head:r=!1,get:i=!1,count:o}={}){let s;const a=new URL(`${this.url}/rpc/${e}`);let l;r||i?(s=r?"HEAD":"GET",Object.entries(n).filter(([u,d])=>d!==void 0).map(([u,d])=>[u,Array.isArray(d)?`{${d.join(",")}}`:`${d}`]).forEach(([u,d])=>{a.searchParams.append(u,d)})):(s="POST",l=n);const c=Object.assign({},this.headers);return o&&(c.Prefer=`count=${o}`),new uI.default({method:s,url:a,headers:c,schema:this.schemaName,body:l,fetch:this.fetch,allowEmpty:!1})}};Kv.default=fI;var pl=Nn&&Nn.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Yt,"__esModule",{value:!0});Yt.PostgrestError=Yt.PostgrestBuilder=Yt.PostgrestTransformBuilder=Yt.PostgrestFilterBuilder=Yt.PostgrestQueryBuilder=Yt.PostgrestClient=void 0;const lE=pl(Kv);Yt.PostgrestClient=lE.default;const cE=pl(yh);Yt.PostgrestQueryBuilder=cE.default;const uE=pl(pu);Yt.PostgrestFilterBuilder=uE.default;const dE=pl(vh);Yt.PostgrestTransformBuilder=dE.default;const fE=pl(xh);Yt.PostgrestBuilder=fE.default;const hE=pl(wh);Yt.PostgrestError=hE.default;var hI=Yt.default={PostgrestClient:lE.default,PostgrestQueryBuilder:cE.default,PostgrestFilterBuilder:uE.default,PostgrestTransformBuilder:dE.default,PostgrestBuilder:fE.default,PostgrestError:hE.default};const{PostgrestClient:pI,PostgrestQueryBuilder:WH,PostgrestFilterBuilder:KH,PostgrestTransformBuilder:qH,PostgrestBuilder:GH,PostgrestError:JH}=hI,mI="2.11.2",gI={"X-Client-Info":`realtime-js/${mI}`},yI="1.0.0",pE=1e4,vI=1e3;var ma;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(ma||(ma={}));var cn;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(cn||(cn={}));var Jn;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(Jn||(Jn={}));var Bg;(function(t){t.websocket="websocket"})(Bg||(Bg={}));var Mo;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(Mo||(Mo={}));class xI{constructor(){this.HEADER_LENGTH=1}decode(e,n){return e.constructor===ArrayBuffer?n(this._binaryDecode(e)):n(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const n=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,n,r)}_decodeBroadcast(e,n,r){const i=n.getUint8(1),o=n.getUint8(2);let s=this.HEADER_LENGTH+2;const a=r.decode(e.slice(s,s+i));s=s+i;const l=r.decode(e.slice(s,s+o));s=s+o;const c=JSON.parse(r.decode(e.slice(s,e.byteLength)));return{ref:null,topic:a,event:l,payload:c}}}class mE{constructor(e,n){this.callback=e,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Ee;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(Ee||(Ee={}));const Nw=(t,e,n={})=>{var r;const i=(r=n.skipTypes)!==null&&r!==void 0?r:[];return Object.keys(e).reduce((o,s)=>(o[s]=wI(s,t,e,i),o),{})},wI=(t,e,n,r)=>{const i=e.find(a=>a.name===t),o=i==null?void 0:i.type,s=n[t];return o&&!r.includes(o)?gE(o,s):zg(s)},gE=(t,e)=>{if(t.charAt(0)==="_"){const n=t.slice(1,t.length);return kI(e,n)}switch(t){case Ee.bool:return bI(e);case Ee.float4:case Ee.float8:case Ee.int2:case Ee.int4:case Ee.int8:case Ee.numeric:case Ee.oid:return SI(e);case Ee.json:case Ee.jsonb:return CI(e);case Ee.timestamp:return EI(e);case Ee.abstime:case Ee.date:case Ee.daterange:case Ee.int4range:case Ee.int8range:case Ee.money:case Ee.reltime:case Ee.text:case Ee.time:case Ee.timestamptz:case Ee.timetz:case Ee.tsrange:case Ee.tstzrange:return zg(e);default:return zg(e)}},zg=t=>t,bI=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},SI=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},CI=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(e){return console.log(`JSON parse error: ${e}`),t}return t},kI=(t,e)=>{if(typeof t!="string")return t;const n=t.length-1,r=t[n];if(t[0]==="{"&&r==="}"){let o;const s=t.slice(1,n);try{o=JSON.parse("["+s+"]")}catch{o=s?s.split(","):[]}return o.map(a=>gE(e,a))}return t},EI=t=>typeof t=="string"?t.replace(" ","T"):t,yE=t=>{let e=t;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")};class Ip{constructor(e,n,r={},i=pE){this.channel=e,this.event=n,this.payload=r,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,n){var r;return this._hasReceived(e)&&n((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:e,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:n}){this.recHooks.filter(r=>r.status===e).forEach(r=>r.callback(n))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var jw;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(jw||(jw={}));class Zl{constructor(e,n){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(n==null?void 0:n.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},i=>{const{onJoin:o,onLeave:s,onSync:a}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Zl.syncState(this.state,i,o,s),this.pendingDiffs.forEach(l=>{this.state=Zl.syncDiff(this.state,l,o,s)}),this.pendingDiffs=[],a()}),this.channel._on(r.diff,{},i=>{const{onJoin:o,onLeave:s,onSync:a}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(i):(this.state=Zl.syncDiff(this.state,i,o,s),a())}),this.onJoin((i,o,s)=>{this.channel._trigger("presence",{event:"join",key:i,currentPresences:o,newPresences:s})}),this.onLeave((i,o,s)=>{this.channel._trigger("presence",{event:"leave",key:i,currentPresences:o,leftPresences:s})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,n,r,i){const o=this.cloneDeep(e),s=this.transformState(n),a={},l={};return this.map(o,(c,u)=>{s[c]||(l[c]=u)}),this.map(s,(c,u)=>{const d=o[c];if(d){const f=u.map(v=>v.presence_ref),p=d.map(v=>v.presence_ref),m=u.filter(v=>p.indexOf(v.presence_ref)<0),g=d.filter(v=>f.indexOf(v.presence_ref)<0);m.length>0&&(a[c]=m),g.length>0&&(l[c]=g)}else a[c]=u}),this.syncDiff(o,{joins:a,leaves:l},r,i)}static syncDiff(e,n,r,i){const{joins:o,leaves:s}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return r||(r=()=>{}),i||(i=()=>{}),this.map(o,(a,l)=>{var c;const u=(c=e[a])!==null&&c!==void 0?c:[];if(e[a]=this.cloneDeep(l),u.length>0){const d=e[a].map(p=>p.presence_ref),f=u.filter(p=>d.indexOf(p.presence_ref)<0);e[a].unshift(...f)}r(a,u,l)}),this.map(s,(a,l)=>{let c=e[a];if(!c)return;const u=l.map(d=>d.presence_ref);c=c.filter(d=>u.indexOf(d.presence_ref)<0),e[a]=c,i(a,c,l),c.length===0&&delete e[a]}),e}static map(e,n){return Object.getOwnPropertyNames(e).map(r=>n(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((n,r)=>{const i=e[r];return"metas"in i?n[r]=i.metas.map(o=>(o.presence_ref=o.phx_ref,delete o.phx_ref,delete o.phx_ref_prev,o)):n[r]=i,n},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Ki;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(Ki||(Ki={}));var Lw;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(Lw||(Lw={}));var $r;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})($r||($r={}));class qv{constructor(e,n={config:{}},r){this.topic=e,this.params=n,this.socket=r,this.bindings={},this.state=cn.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},n.config),this.timeout=this.socket.timeout,this.joinPush=new Ip(this,Jn.join,this.params,this.timeout),this.rejoinTimer=new mE(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=cn.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(i=>i.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=cn.closed,this.socket._remove(this)}),this._onError(i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=cn.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=cn.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Jn.reply,{},(i,o)=>{this._trigger(this._replyEventName(o),i)}),this.presence=new Zl(this),this.broadcastEndpointURL=yE(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,n=this.timeout){var r,i;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:o,presence:s,private:a}}=this.params;this._onError(u=>e==null?void 0:e($r.CHANNEL_ERROR,u)),this._onClose(()=>e==null?void 0:e($r.CLOSED));const l={},c={broadcast:o,presence:s,postgres_changes:(i=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(u=>u.filter))!==null&&i!==void 0?i:[],private:a};this.socket.accessTokenValue&&(l.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:c},l)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",async({postgres_changes:u})=>{var d;if(this.socket.setAuth(),u===void 0){e==null||e($r.SUBSCRIBED);return}else{const f=this.bindings.postgres_changes,p=(d=f==null?void 0:f.length)!==null&&d!==void 0?d:0,m=[];for(let g=0;g<p;g++){const v=f[g],{filter:{event:x,schema:w,table:S,filter:b}}=v,C=u&&u[g];if(C&&C.event===x&&C.schema===w&&C.table===S&&C.filter===b)m.push(Object.assign(Object.assign({},v),{id:C.id}));else{this.unsubscribe(),e==null||e($r.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=m,e&&e($r.SUBSCRIBED);return}}).receive("error",u=>{e==null||e($r.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(u).join(", ")||"error")))}).receive("timeout",()=>{e==null||e($r.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,n={}){return await this.send({type:"presence",event:"track",payload:e},n.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,n,r){return this._on(e,n,r)}async send(e,n={}){var r,i;if(!this._canPush()&&e.type==="broadcast"){const{event:o,payload:s}=e,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:o,payload:s,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(r=n.timeout)!==null&&r!==void 0?r:this.timeout);return await((i=c.body)===null||i===void 0?void 0:i.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(o=>{var s,a,l;const c=this._push(e.type,e,n.timeout||this.timeout);e.type==="broadcast"&&!(!((l=(a=(s=this.params)===null||s===void 0?void 0:s.config)===null||a===void 0?void 0:a.broadcast)===null||l===void 0)&&l.ack)&&o("ok"),c.receive("ok",()=>o("ok")),c.receive("error",()=>o("error")),c.receive("timeout",()=>o("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=cn.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Jn.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(r=>{const i=new Ip(this,Jn.leave,{},e);i.receive("ok",()=>{n(),r("ok")}).receive("timeout",()=>{n(),r("timed out")}).receive("error",()=>{r("error")}),i.send(),this._canPush()||i.trigger("ok",{})})}async _fetchWithTimeout(e,n,r){const i=new AbortController,o=setTimeout(()=>i.abort(),r),s=await this.socket.fetch(e,Object.assign(Object.assign({},n),{signal:i.signal}));return clearTimeout(o),s}_push(e,n,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new Ip(this,e,n,r);return this._canPush()?i.send():(i.startTimeout(),this.pushBuffer.push(i)),i}_onMessage(e,n,r){return n}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,n,r){var i,o;const s=e.toLocaleLowerCase(),{close:a,error:l,leave:c,join:u}=Jn;if(r&&[a,l,c,u].indexOf(s)>=0&&r!==this._joinRef())return;let f=this._onMessage(s,n,r);if(n&&!f)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(s)?(i=this.bindings.postgres_changes)===null||i===void 0||i.filter(p=>{var m,g,v;return((m=p.filter)===null||m===void 0?void 0:m.event)==="*"||((v=(g=p.filter)===null||g===void 0?void 0:g.event)===null||v===void 0?void 0:v.toLocaleLowerCase())===s}).map(p=>p.callback(f,r)):(o=this.bindings[s])===null||o===void 0||o.filter(p=>{var m,g,v,x,w,S;if(["broadcast","presence","postgres_changes"].includes(s))if("id"in p){const b=p.id,C=(m=p.filter)===null||m===void 0?void 0:m.event;return b&&((g=n.ids)===null||g===void 0?void 0:g.includes(b))&&(C==="*"||(C==null?void 0:C.toLocaleLowerCase())===((v=n.data)===null||v===void 0?void 0:v.type.toLocaleLowerCase()))}else{const b=(w=(x=p==null?void 0:p.filter)===null||x===void 0?void 0:x.event)===null||w===void 0?void 0:w.toLocaleLowerCase();return b==="*"||b===((S=n==null?void 0:n.event)===null||S===void 0?void 0:S.toLocaleLowerCase())}else return p.type.toLocaleLowerCase()===s}).map(p=>{if(typeof f=="object"&&"ids"in f){const m=f.data,{schema:g,table:v,commit_timestamp:x,type:w,errors:S}=m;f=Object.assign(Object.assign({},{schema:g,table:v,commit_timestamp:x,eventType:w,new:{},old:{},errors:S}),this._getPayloadRecords(m))}p.callback(f,r)})}_isClosed(){return this.state===cn.closed}_isJoined(){return this.state===cn.joined}_isJoining(){return this.state===cn.joining}_isLeaving(){return this.state===cn.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,n,r){const i=e.toLocaleLowerCase(),o={type:i,filter:n,callback:r};return this.bindings[i]?this.bindings[i].push(o):this.bindings[i]=[o],this}_off(e,n){const r=e.toLocaleLowerCase();return this.bindings[r]=this.bindings[r].filter(i=>{var o;return!(((o=i.type)===null||o===void 0?void 0:o.toLocaleLowerCase())===r&&qv.isEqual(i.filter,n))}),this}static isEqual(e,n){if(Object.keys(e).length!==Object.keys(n).length)return!1;for(const r in e)if(e[r]!==n[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Jn.close,{},e)}_onError(e){this._on(Jn.error,{},n=>e(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=cn.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const n={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(n.new=Nw(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(n.old=Nw(e.columns,e.old_record)),n}}const TI=()=>{},_I=typeof WebSocket<"u",RI=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class OI{constructor(e,n){var r;this.accessTokenValue=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=gI,this.params={},this.timeout=pE,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=TI,this.conn=null,this.sendBuffer=[],this.serializer=new xI,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=o=>{let s;return o?s=o:typeof fetch>"u"?s=(...a)=>ds(()=>Promise.resolve().then(()=>hl),void 0).then(({default:l})=>l(...a)):s=fetch,(...a)=>s(...a)},this.endPoint=`${e}/${Bg.websocket}`,this.httpEndpoint=yE(e),n!=null&&n.transport?this.transport=n.transport:this.transport=null,n!=null&&n.params&&(this.params=n.params),n!=null&&n.headers&&(this.headers=Object.assign(Object.assign({},this.headers),n.headers)),n!=null&&n.timeout&&(this.timeout=n.timeout),n!=null&&n.logger&&(this.logger=n.logger),n!=null&&n.heartbeatIntervalMs&&(this.heartbeatIntervalMs=n.heartbeatIntervalMs);const i=(r=n==null?void 0:n.params)===null||r===void 0?void 0:r.apikey;if(i&&(this.accessTokenValue=i,this.apiKey=i),this.reconnectAfterMs=n!=null&&n.reconnectAfterMs?n.reconnectAfterMs:o=>[1e3,2e3,5e3,1e4][o-1]||1e4,this.encode=n!=null&&n.encode?n.encode:(o,s)=>s(JSON.stringify(o)),this.decode=n!=null&&n.decode?n.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new mE(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(n==null?void 0:n.fetch),n!=null&&n.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(n==null?void 0:n.worker)||!1,this.workerUrl=n==null?void 0:n.workerUrl}this.accessToken=(n==null?void 0:n.accessToken)||null}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers});return}if(_I){this.conn=new WebSocket(this.endpointURL()),this.setupConnection();return}this.conn=new PI(this.endpointURL(),void 0,{close:()=>{this.conn=null}}),ds(()=>import("./browser-e297dae5.js").then(e=>e.b),[]).then(({default:e})=>{this.conn=new e(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:yI}))}disconnect(e,n){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,n??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(e){const n=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const e=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.disconnect(),e}log(e,n,r){this.logger(e,n,r)}connectionState(){switch(this.conn&&this.conn.readyState){case ma.connecting:return Mo.Connecting;case ma.open:return Mo.Open;case ma.closing:return Mo.Closing;default:return Mo.Closed}}isConnected(){return this.connectionState()===Mo.Open}channel(e,n={config:{}}){const r=new qv(`realtime:${e}`,n,this);return this.channels.push(r),r}push(e){const{topic:n,event:r,payload:i,ref:o}=e,s=()=>{this.encode(e,a=>{var l;(l=this.conn)===null||l===void 0||l.send(a)})};this.log("push",`${n} ${r} (${o})`,i),this.isConnected()?s():this.sendBuffer.push(s)}async setAuth(e=null){let n=e||this.accessToken&&await this.accessToken()||this.accessTokenValue;if(n){let r=null;try{r=JSON.parse(atob(n.split(".")[1]))}catch{}if(r&&r.exp&&!(Math.floor(Date.now()/1e3)-r.exp<0))return this.log("auth",`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${r.exp}`),Promise.reject(`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${r.exp}`);this.accessTokenValue=n,this.channels.forEach(i=>{n&&i.updateJoinPayload({access_token:n}),i.joinedOnce&&i._isJoined()&&i._push(Jn.access_token,{access_token:n})})}}async sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(e=this.conn)===null||e===void 0||e.close(vI,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth()}}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let n=this.channels.find(r=>r.topic===e&&(r._isJoined()||r._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${e}"`),n.unsubscribe())}_remove(e){this.channels=this.channels.filter(n=>n._joinRef()!==e._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,n=>{let{topic:r,event:i,payload:o,ref:s}=n;s&&s===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${o.status||""} ${r} ${i} ${s&&"("+s+")"||""}`,o),this.channels.filter(a=>a._isMember(r)).forEach(a=>a._trigger(i,o,s)),this.stateChangeCallbacks.message.forEach(a=>a(n))})}async _onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),!this.worker)this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs);else{this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=n=>{this.log("worker","worker error",n.message),this.workerRef.terminate()},this.workerRef.onmessage=n=>{n.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}this.stateChangeCallbacks.open.forEach(e=>e())}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(n=>n(e))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(n=>n(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(Jn.error))}_appendParams(e,n){if(Object.keys(n).length===0)return e;const r=e.match(/\?/)?"&":"?",i=new URLSearchParams(n);return`${e}${r}${i}`}_workerObjectUrl(e){let n;if(e)n=e;else{const r=new Blob([RI],{type:"application/javascript"});n=URL.createObjectURL(r)}return n}}class PI{constructor(e,n,r){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=ma.connecting,this.send=()=>{},this.url=null,this.url=e,this.close=r.close}}class Gv extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function Xe(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class MI extends Gv{constructor(e,n){super(e),this.name="StorageApiError",this.status=n}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class Ug extends Gv{constructor(e,n){super(e),this.name="StorageUnknownError",this.originalError=n}}var AI=globalThis&&globalThis.__awaiter||function(t,e,n,r){function i(o){return o instanceof n?o:new n(function(s){s(o)})}return new(n||(n=Promise))(function(o,s){function a(u){try{c(r.next(u))}catch(d){s(d)}}function l(u){try{c(r.throw(u))}catch(d){s(d)}}function c(u){u.done?o(u.value):i(u.value).then(a,l)}c((r=r.apply(t,e||[])).next())})};const vE=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>ds(()=>Promise.resolve().then(()=>hl),void 0).then(({default:r})=>r(...n)):e=fetch,(...n)=>e(...n)},DI=()=>AI(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield ds(()=>Promise.resolve().then(()=>hl),void 0)).Response:Response}),Vg=t=>{if(Array.isArray(t))return t.map(n=>Vg(n));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([n,r])=>{const i=n.replace(/([-_][a-z])/gi,o=>o.toUpperCase().replace(/[-_]/g,""));e[i]=Vg(r)}),e};var Cs=globalThis&&globalThis.__awaiter||function(t,e,n,r){function i(o){return o instanceof n?o:new n(function(s){s(o)})}return new(n||(n=Promise))(function(o,s){function a(u){try{c(r.next(u))}catch(d){s(d)}}function l(u){try{c(r.throw(u))}catch(d){s(d)}}function c(u){u.done?o(u.value):i(u.value).then(a,l)}c((r=r.apply(t,e||[])).next())})};const Np=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),II=(t,e,n)=>Cs(void 0,void 0,void 0,function*(){const r=yield DI();t instanceof r&&!(n!=null&&n.noResolveJson)?t.json().then(i=>{e(new MI(Np(i),t.status||500))}).catch(i=>{e(new Ug(Np(i),i))}):e(new Ug(Np(t),t))}),NI=(t,e,n,r)=>{const i={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),r&&(i.body=JSON.stringify(r)),Object.assign(Object.assign({},i),n))};function mu(t,e,n,r,i,o){return Cs(this,void 0,void 0,function*(){return new Promise((s,a)=>{t(n,NI(e,r,i,o)).then(l=>{if(!l.ok)throw l;return r!=null&&r.noResolveJson?l:l.json()}).then(l=>s(l)).catch(l=>II(l,a,r))})})}function Sf(t,e,n,r){return Cs(this,void 0,void 0,function*(){return mu(t,"GET",e,n,r)})}function yi(t,e,n,r,i){return Cs(this,void 0,void 0,function*(){return mu(t,"POST",e,r,i,n)})}function jI(t,e,n,r,i){return Cs(this,void 0,void 0,function*(){return mu(t,"PUT",e,r,i,n)})}function LI(t,e,n,r){return Cs(this,void 0,void 0,function*(){return mu(t,"HEAD",e,Object.assign(Object.assign({},n),{noResolveJson:!0}),r)})}function xE(t,e,n,r,i){return Cs(this,void 0,void 0,function*(){return mu(t,"DELETE",e,r,i,n)})}var Vt=globalThis&&globalThis.__awaiter||function(t,e,n,r){function i(o){return o instanceof n?o:new n(function(s){s(o)})}return new(n||(n=Promise))(function(o,s){function a(u){try{c(r.next(u))}catch(d){s(d)}}function l(u){try{c(r.throw(u))}catch(d){s(d)}}function c(u){u.done?o(u.value):i(u.value).then(a,l)}c((r=r.apply(t,e||[])).next())})};const $I={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},$w={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class FI{constructor(e,n={},r,i){this.url=e,this.headers=n,this.bucketId=r,this.fetch=vE(i)}uploadOrUpdate(e,n,r,i){return Vt(this,void 0,void 0,function*(){try{let o;const s=Object.assign(Object.assign({},$w),i);let a=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(s.upsert)});const l=s.metadata;typeof Blob<"u"&&r instanceof Blob?(o=new FormData,o.append("cacheControl",s.cacheControl),l&&o.append("metadata",this.encodeMetadata(l)),o.append("",r)):typeof FormData<"u"&&r instanceof FormData?(o=r,o.append("cacheControl",s.cacheControl),l&&o.append("metadata",this.encodeMetadata(l))):(o=r,a["cache-control"]=`max-age=${s.cacheControl}`,a["content-type"]=s.contentType,l&&(a["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),i!=null&&i.headers&&(a=Object.assign(Object.assign({},a),i.headers));const c=this._removeEmptyFolders(n),u=this._getFinalPath(c),d=yield this.fetch(`${this.url}/object/${u}`,Object.assign({method:e,body:o,headers:a},s!=null&&s.duplex?{duplex:s.duplex}:{})),f=yield d.json();return d.ok?{data:{path:c,id:f.Id,fullPath:f.Key},error:null}:{data:null,error:f}}catch(o){if(Xe(o))return{data:null,error:o};throw o}})}upload(e,n,r){return Vt(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,n,r)})}uploadToSignedUrl(e,n,r,i){return Vt(this,void 0,void 0,function*(){const o=this._removeEmptyFolders(e),s=this._getFinalPath(o),a=new URL(this.url+`/object/upload/sign/${s}`);a.searchParams.set("token",n);try{let l;const c=Object.assign({upsert:$w.upsert},i),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&r instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),l.append("",r)):typeof FormData<"u"&&r instanceof FormData?(l=r,l.append("cacheControl",c.cacheControl)):(l=r,u["cache-control"]=`max-age=${c.cacheControl}`,u["content-type"]=c.contentType);const d=yield this.fetch(a.toString(),{method:"PUT",body:l,headers:u}),f=yield d.json();return d.ok?{data:{path:o,fullPath:f.Key},error:null}:{data:null,error:f}}catch(l){if(Xe(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(e,n){return Vt(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e);const i=Object.assign({},this.headers);n!=null&&n.upsert&&(i["x-upsert"]="true");const o=yield yi(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:i}),s=new URL(this.url+o.url),a=s.searchParams.get("token");if(!a)throw new Gv("No token returned by API");return{data:{signedUrl:s.toString(),path:e,token:a},error:null}}catch(r){if(Xe(r))return{data:null,error:r};throw r}})}update(e,n,r){return Vt(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,n,r)})}move(e,n,r){return Vt(this,void 0,void 0,function*(){try{return{data:yield yi(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers}),error:null}}catch(i){if(Xe(i))return{data:null,error:i};throw i}})}copy(e,n,r){return Vt(this,void 0,void 0,function*(){try{return{data:{path:(yield yi(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers})).Key},error:null}}catch(i){if(Xe(i))return{data:null,error:i};throw i}})}createSignedUrl(e,n,r){return Vt(this,void 0,void 0,function*(){try{let i=this._getFinalPath(e),o=yield yi(this.fetch,`${this.url}/object/sign/${i}`,Object.assign({expiresIn:n},r!=null&&r.transform?{transform:r.transform}:{}),{headers:this.headers});const s=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return o={signedUrl:encodeURI(`${this.url}${o.signedURL}${s}`)},{data:o,error:null}}catch(i){if(Xe(i))return{data:null,error:i};throw i}})}createSignedUrls(e,n,r){return Vt(this,void 0,void 0,function*(){try{const i=yield yi(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:n,paths:e},{headers:this.headers}),o=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:i.map(s=>Object.assign(Object.assign({},s),{signedUrl:s.signedURL?encodeURI(`${this.url}${s.signedURL}${o}`):null})),error:null}}catch(i){if(Xe(i))return{data:null,error:i};throw i}})}download(e,n){return Vt(this,void 0,void 0,function*(){const i=typeof(n==null?void 0:n.transform)<"u"?"render/image/authenticated":"object",o=this.transformOptsToQueryString((n==null?void 0:n.transform)||{}),s=o?`?${o}`:"";try{const a=this._getFinalPath(e);return{data:yield(yield Sf(this.fetch,`${this.url}/${i}/${a}${s}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(a){if(Xe(a))return{data:null,error:a};throw a}})}info(e){return Vt(this,void 0,void 0,function*(){const n=this._getFinalPath(e);try{const r=yield Sf(this.fetch,`${this.url}/object/info/${n}`,{headers:this.headers});return{data:Vg(r),error:null}}catch(r){if(Xe(r))return{data:null,error:r};throw r}})}exists(e){return Vt(this,void 0,void 0,function*(){const n=this._getFinalPath(e);try{return yield LI(this.fetch,`${this.url}/object/${n}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(Xe(r)&&r instanceof Ug){const i=r.originalError;if([400,404].includes(i==null?void 0:i.status))return{data:!1,error:r}}throw r}})}getPublicUrl(e,n){const r=this._getFinalPath(e),i=[],o=n!=null&&n.download?`download=${n.download===!0?"":n.download}`:"";o!==""&&i.push(o);const a=typeof(n==null?void 0:n.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((n==null?void 0:n.transform)||{});l!==""&&i.push(l);let c=i.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${a}/public/${r}${c}`)}}}remove(e){return Vt(this,void 0,void 0,function*(){try{return{data:yield xE(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(n){if(Xe(n))return{data:null,error:n};throw n}})}list(e,n,r){return Vt(this,void 0,void 0,function*(){try{const i=Object.assign(Object.assign(Object.assign({},$I),n),{prefix:e||""});return{data:yield yi(this.fetch,`${this.url}/object/list/${this.bucketId}`,i,{headers:this.headers},r),error:null}}catch(i){if(Xe(i))return{data:null,error:i};throw i}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const n=[];return e.width&&n.push(`width=${e.width}`),e.height&&n.push(`height=${e.height}`),e.resize&&n.push(`resize=${e.resize}`),e.format&&n.push(`format=${e.format}`),e.quality&&n.push(`quality=${e.quality}`),n.join("&")}}const BI="2.7.1",zI={"X-Client-Info":`storage-js/${BI}`};var Ds=globalThis&&globalThis.__awaiter||function(t,e,n,r){function i(o){return o instanceof n?o:new n(function(s){s(o)})}return new(n||(n=Promise))(function(o,s){function a(u){try{c(r.next(u))}catch(d){s(d)}}function l(u){try{c(r.throw(u))}catch(d){s(d)}}function c(u){u.done?o(u.value):i(u.value).then(a,l)}c((r=r.apply(t,e||[])).next())})};class UI{constructor(e,n={},r){this.url=e,this.headers=Object.assign(Object.assign({},zI),n),this.fetch=vE(r)}listBuckets(){return Ds(this,void 0,void 0,function*(){try{return{data:yield Sf(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(Xe(e))return{data:null,error:e};throw e}})}getBucket(e){return Ds(this,void 0,void 0,function*(){try{return{data:yield Sf(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(n){if(Xe(n))return{data:null,error:n};throw n}})}createBucket(e,n={public:!1}){return Ds(this,void 0,void 0,function*(){try{return{data:yield yi(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(Xe(r))return{data:null,error:r};throw r}})}updateBucket(e,n){return Ds(this,void 0,void 0,function*(){try{return{data:yield jI(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(Xe(r))return{data:null,error:r};throw r}})}emptyBucket(e){return Ds(this,void 0,void 0,function*(){try{return{data:yield yi(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(n){if(Xe(n))return{data:null,error:n};throw n}})}deleteBucket(e){return Ds(this,void 0,void 0,function*(){try{return{data:yield xE(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(n){if(Xe(n))return{data:null,error:n};throw n}})}}class VI extends UI{constructor(e,n={},r){super(e,n,r)}from(e){return new FI(this.url,this.headers,e,this.fetch)}}const HI="2.49.1";let $l="";typeof Deno<"u"?$l="deno":typeof document<"u"?$l="web":typeof navigator<"u"&&navigator.product==="ReactNative"?$l="react-native":$l="node";const WI={"X-Client-Info":`supabase-js-${$l}/${HI}`},KI={headers:WI},qI={schema:"public"},GI={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},JI={};var YI=globalThis&&globalThis.__awaiter||function(t,e,n,r){function i(o){return o instanceof n?o:new n(function(s){s(o)})}return new(n||(n=Promise))(function(o,s){function a(u){try{c(r.next(u))}catch(d){s(d)}}function l(u){try{c(r.throw(u))}catch(d){s(d)}}function c(u){u.done?o(u.value):i(u.value).then(a,l)}c((r=r.apply(t,e||[])).next())})};const QI=t=>{let e;return t?e=t:typeof fetch>"u"?e=rE:e=fetch,(...n)=>e(...n)},XI=()=>typeof Headers>"u"?iE:Headers,ZI=(t,e,n)=>{const r=QI(n),i=XI();return(o,s)=>YI(void 0,void 0,void 0,function*(){var a;const l=(a=yield e())!==null&&a!==void 0?a:t;let c=new i(s==null?void 0:s.headers);return c.has("apikey")||c.set("apikey",t),c.has("Authorization")||c.set("Authorization",`Bearer ${l}`),r(o,Object.assign(Object.assign({},s),{headers:c}))})};var eN=globalThis&&globalThis.__awaiter||function(t,e,n,r){function i(o){return o instanceof n?o:new n(function(s){s(o)})}return new(n||(n=Promise))(function(o,s){function a(u){try{c(r.next(u))}catch(d){s(d)}}function l(u){try{c(r.throw(u))}catch(d){s(d)}}function c(u){u.done?o(u.value):i(u.value).then(a,l)}c((r=r.apply(t,e||[])).next())})};function tN(t){return t.replace(/\/$/,"")}function nN(t,e){const{db:n,auth:r,realtime:i,global:o}=t,{db:s,auth:a,realtime:l,global:c}=e,u={db:Object.assign(Object.assign({},s),n),auth:Object.assign(Object.assign({},a),r),realtime:Object.assign(Object.assign({},l),i),global:Object.assign(Object.assign({},c),o),accessToken:()=>eN(this,void 0,void 0,function*(){return""})};return t.accessToken?u.accessToken=t.accessToken:delete u.accessToken,u}const wE="2.68.0",Vs=30*1e3,Hg=3,jp=Hg*Vs,rN="http://localhost:9999",iN="supabase.auth.token",oN={"X-Client-Info":`gotrue-js/${wE}`},Wg="X-Supabase-Api-Version",bE={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}};function sN(t){return Math.round(Date.now()/1e3)+t}function aN(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const e=Math.random()*16|0;return(t=="x"?e:e&3|8).toString(16)})}const fr=()=>typeof window<"u"&&typeof document<"u",Eo={tested:!1,writable:!1},ec=()=>{if(!fr())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Eo.tested)return Eo.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),Eo.tested=!0,Eo.writable=!0}catch{Eo.tested=!0,Eo.writable=!1}return Eo.writable};function lN(t){const e={},n=new URL(t);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((i,o)=>{e[o]=i})}catch{}return n.searchParams.forEach((r,i)=>{e[i]=r}),e}const SE=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>ds(()=>Promise.resolve().then(()=>hl),void 0).then(({default:r})=>r(...n)):e=fetch,(...n)=>e(...n)},cN=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",CE=async(t,e,n)=>{await t.setItem(e,JSON.stringify(n))},td=async(t,e)=>{const n=await t.getItem(e);if(!n)return null;try{return JSON.parse(n)}catch{return n}},nd=async(t,e)=>{await t.removeItem(e)};function uN(t){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let n="",r,i,o,s,a,l,c,u=0;for(t=t.replace("-","+").replace("_","/");u<t.length;)s=e.indexOf(t.charAt(u++)),a=e.indexOf(t.charAt(u++)),l=e.indexOf(t.charAt(u++)),c=e.indexOf(t.charAt(u++)),r=s<<2|a>>4,i=(a&15)<<4|l>>2,o=(l&3)<<6|c,n=n+String.fromCharCode(r),l!=64&&i!=0&&(n=n+String.fromCharCode(i)),c!=64&&o!=0&&(n=n+String.fromCharCode(o));return n}class Ch{constructor(){this.promise=new Ch.promiseConstructor((e,n)=>{this.resolve=e,this.reject=n})}}Ch.promiseConstructor=Promise;function Fw(t){const e=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}=?$|[a-z0-9_-]{2}(==)?$)$/i,n=t.split(".");if(n.length!==3)throw new Error("JWT is not valid: not a JWT structure");if(!e.test(n[1]))throw new Error("JWT is not valid: payload is not in base64url format");const r=n[1];return JSON.parse(uN(r))}async function dN(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function fN(t,e){return new Promise((r,i)=>{(async()=>{for(let o=0;o<1/0;o++)try{const s=await t(o);if(!e(o,null,s)){r(s);return}}catch(s){if(!e(o,s)){i(s);return}}})()})}function hN(t){return("0"+t.toString(16)).substr(-2)}function pN(){const e=new Uint32Array(56);if(typeof crypto>"u"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=n.length;let i="";for(let o=0;o<56;o++)i+=n.charAt(Math.floor(Math.random()*r));return i}return crypto.getRandomValues(e),Array.from(e,hN).join("")}async function mN(t){const n=new TextEncoder().encode(t),r=await crypto.subtle.digest("SHA-256",n),i=new Uint8Array(r);return Array.from(i).map(o=>String.fromCharCode(o)).join("")}function gN(t){return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function yN(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const n=await mN(t);return gN(n)}async function Is(t,e,n=!1){const r=pN();let i=r;n&&(i+="/PASSWORD_RECOVERY"),await CE(t,`${e}-code-verifier`,i);const o=await yN(r);return[o,r===o?"plain":"s256"]}const vN=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function xN(t){const e=t.headers.get(Wg);if(!e||!e.match(vN))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}class Jv extends Error{constructor(e,n,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=n,this.code=r}}function ae(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class wN extends Jv{constructor(e,n,r){super(e,n,r),this.name="AuthApiError",this.status=n,this.code=r}}function bN(t){return ae(t)&&t.name==="AuthApiError"}class kE extends Jv{constructor(e,n){super(e),this.name="AuthUnknownError",this.originalError=n}}class ks extends Jv{constructor(e,n,r,i){super(e,r,i),this.name=n,this.status=r}}class di extends ks{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function SN(t){return ae(t)&&t.name==="AuthSessionMissingError"}class Lp extends ks{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class rd extends ks{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class id extends ks{constructor(e,n=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function CN(t){return ae(t)&&t.name==="AuthImplicitGrantRedirectError"}class Bw extends ks{constructor(e,n=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Kg extends ks{constructor(e,n){super(e,"AuthRetryableFetchError",n,void 0)}}function $p(t){return ae(t)&&t.name==="AuthRetryableFetchError"}class zw extends ks{constructor(e,n,r){super(e,"AuthWeakPasswordError",n,"weak_password"),this.reasons=r}}var kN=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};const Oo=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),EN=[502,503,504];async function Uw(t){var e;if(!cN(t))throw new Kg(Oo(t),0);if(EN.includes(t.status))throw new Kg(Oo(t),t.status);let n;try{n=await t.json()}catch(o){throw new kE(Oo(o),o)}let r;const i=xN(t);if(i&&i.getTime()>=bE["2024-01-01"].timestamp&&typeof n=="object"&&n&&typeof n.code=="string"?r=n.code:typeof n=="object"&&n&&typeof n.error_code=="string"&&(r=n.error_code),r){if(r==="weak_password")throw new zw(Oo(n),t.status,((e=n.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(r==="session_not_found")throw new di}else if(typeof n=="object"&&n&&typeof n.weak_password=="object"&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((o,s)=>o&&typeof s=="string",!0))throw new zw(Oo(n),t.status,n.weak_password.reasons);throw new wN(Oo(n),t.status||500,r)}const TN=(t,e,n,r)=>{const i={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),i.body=JSON.stringify(r),Object.assign(Object.assign({},i),n))};async function de(t,e,n,r){var i;const o=Object.assign({},r==null?void 0:r.headers);o[Wg]||(o[Wg]=bE["2024-01-01"].name),r!=null&&r.jwt&&(o.Authorization=`Bearer ${r.jwt}`);const s=(i=r==null?void 0:r.query)!==null&&i!==void 0?i:{};r!=null&&r.redirectTo&&(s.redirect_to=r.redirectTo);const a=Object.keys(s).length?"?"+new URLSearchParams(s).toString():"",l=await _N(t,e,n+a,{headers:o,noResolveJson:r==null?void 0:r.noResolveJson},{},r==null?void 0:r.body);return r!=null&&r.xform?r==null?void 0:r.xform(l):{data:Object.assign({},l),error:null}}async function _N(t,e,n,r,i,o){const s=TN(e,r,i,o);let a;try{a=await t(n,Object.assign({},s))}catch(l){throw console.error(l),new Kg(Oo(l),0)}if(a.ok||await Uw(a),r!=null&&r.noResolveJson)return a;try{return await a.json()}catch(l){await Uw(l)}}function fi(t){var e;let n=null;MN(t)&&(n=Object.assign({},t),t.expires_at||(n.expires_at=sN(t.expires_in)));const r=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:n,user:r},error:null}}function Vw(t){const e=fi(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((n,r)=>n&&typeof r=="string",!0)&&(e.data.weak_password=t.weak_password),e}function Si(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function RN(t){return{data:t,error:null}}function ON(t){const{action_link:e,email_otp:n,hashed_token:r,redirect_to:i,verification_type:o}=t,s=kN(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),a={action_link:e,email_otp:n,hashed_token:r,redirect_to:i,verification_type:o},l=Object.assign({},s);return{data:{properties:a,user:l},error:null}}function PN(t){return t}function MN(t){return t.access_token&&t.refresh_token&&t.expires_in}var AN=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};class DN{constructor({url:e="",headers:n={},fetch:r}){this.url=e,this.headers=n,this.fetch=SE(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,n="global"){try{return await de(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(ae(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,n={}){try{return await de(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:Si})}catch(r){if(ae(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:n}=e,r=AN(e,["options"]),i=Object.assign(Object.assign({},r),n);return"newEmail"in r&&(i.new_email=r==null?void 0:r.newEmail,delete i.newEmail),await de(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:ON,redirectTo:n==null?void 0:n.redirectTo})}catch(n){if(ae(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(e){try{return await de(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Si})}catch(n){if(ae(n))return{data:{user:null},error:n};throw n}}async listUsers(e){var n,r,i,o,s,a,l;try{const c={nextPage:null,lastPage:0,total:0},u=await de(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(n=e==null?void 0:e.page)===null||n===void 0?void 0:n.toString())!==null&&r!==void 0?r:"",per_page:(o=(i=e==null?void 0:e.perPage)===null||i===void 0?void 0:i.toString())!==null&&o!==void 0?o:""},xform:PN});if(u.error)throw u.error;const d=await u.json(),f=(s=u.headers.get("x-total-count"))!==null&&s!==void 0?s:0,p=(l=(a=u.headers.get("link"))===null||a===void 0?void 0:a.split(","))!==null&&l!==void 0?l:[];return p.length>0&&(p.forEach(m=>{const g=parseInt(m.split(";")[0].split("=")[1].substring(0,1)),v=JSON.parse(m.split(";")[1].split("=")[1]);c[`${v}Page`]=g}),c.total=parseInt(f)),{data:Object.assign(Object.assign({},d),c),error:null}}catch(c){if(ae(c))return{data:{users:[]},error:c};throw c}}async getUserById(e){try{return await de(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Si})}catch(n){if(ae(n))return{data:{user:null},error:n};throw n}}async updateUserById(e,n){try{return await de(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:n,headers:this.headers,xform:Si})}catch(r){if(ae(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,n=!1){try{return await de(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:n},xform:Si})}catch(r){if(ae(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){try{const{data:n,error:r}=await de(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:i=>({data:{factors:i},error:null})});return{data:n,error:r}}catch(n){if(ae(n))return{data:null,error:n};throw n}}async _deleteFactor(e){try{return{data:await de(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(n){if(ae(n))return{data:null,error:n};throw n}}}const IN={getItem:t=>ec()?globalThis.localStorage.getItem(t):null,setItem:(t,e)=>{ec()&&globalThis.localStorage.setItem(t,e)},removeItem:t=>{ec()&&globalThis.localStorage.removeItem(t)}};function Hw(t={}){return{getItem:e=>t[e]||null,setItem:(e,n)=>{t[e]=n},removeItem:e=>{delete t[e]}}}function NN(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Ns={debug:!!(globalThis&&ec()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class EE extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class jN extends EE{}async function LN(t,e,n){Ns.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const r=new globalThis.AbortController;return e>0&&setTimeout(()=>{r.abort(),Ns.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async i=>{if(i){Ns.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,i.name);try{return await n()}finally{Ns.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,i.name)}}else{if(e===0)throw Ns.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new jN(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(Ns.debug)try{const o=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(o,null,"  "))}catch(o){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",o)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}}))}NN();const $N={url:rN,storageKey:iN,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:oN,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Ww(t,e,n){return await n()}class Oc{constructor(e){var n,r;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Oc.nextInstanceID,Oc.nextInstanceID+=1,this.instanceID>0&&fr()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const i=Object.assign(Object.assign({},$N),e);if(this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.persistSession=i.persistSession,this.storageKey=i.storageKey,this.autoRefreshToken=i.autoRefreshToken,this.admin=new DN({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=SE(i.fetch),this.lock=i.lock||Ww,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,i.lock?this.lock=i.lock:fr()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=LN:this.lock=Ww,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?i.storage?this.storage=i.storage:ec()?this.storage=IN:(this.memoryStorage={},this.storage=Hw(this.memoryStorage)):(this.memoryStorage={},this.storage=Hw(this.memoryStorage)),fr()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(o){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",o)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async o=>{this._debug("received broadcast notification from other tab or client",o),await this._notifyAllSubscribers(o.data.event,o.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${wE}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const n=lN(window.location.href);let r="none";if(this._isImplicitGrantCallback(n)?r="implicit":await this._isPKCECallback(n)&&(r="pkce"),fr()&&this.detectSessionInUrl&&r!=="none"){const{data:i,error:o}=await this._getSessionFromURL(n,r);if(o){if(this._debug("#_initialize()","error detecting session from URL",o),CN(o)){const l=(e=o.details)===null||e===void 0?void 0:e.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:o}}return await this._removeSession(),{error:o}}const{session:s,redirectType:a}=i;return this._debug("#_initialize()","detected session in URL",s,"redirect type",a),await this._saveSession(s),setTimeout(async()=>{a==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",s):await this._notifyAllSubscribers("SIGNED_IN",s)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(n){return ae(n)?{error:n}:{error:new kE("Unexpected error during initialization",n)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var n,r,i;try{const o=await de(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(n=e==null?void 0:e.options)===null||n===void 0?void 0:n.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(i=e==null?void 0:e.options)===null||i===void 0?void 0:i.captchaToken}},xform:fi}),{data:s,error:a}=o;if(a||!s)return{data:{user:null,session:null},error:a};const l=s.session,c=s.user;return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(o){if(ae(o))return{data:{user:null,session:null},error:o};throw o}}async signUp(e){var n,r,i;try{let o;if("email"in e){const{email:u,password:d,options:f}=e;let p=null,m=null;this.flowType==="pkce"&&([p,m]=await Is(this.storage,this.storageKey)),o=await de(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:f==null?void 0:f.emailRedirectTo,body:{email:u,password:d,data:(n=f==null?void 0:f.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken},code_challenge:p,code_challenge_method:m},xform:fi})}else if("phone"in e){const{phone:u,password:d,options:f}=e;o=await de(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:d,data:(r=f==null?void 0:f.data)!==null&&r!==void 0?r:{},channel:(i=f==null?void 0:f.channel)!==null&&i!==void 0?i:"sms",gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:fi})}else throw new rd("You must provide either an email or phone number and a password");const{data:s,error:a}=o;if(a||!s)return{data:{user:null,session:null},error:a};const l=s.session,c=s.user;return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(o){if(ae(o))return{data:{user:null,session:null},error:o};throw o}}async signInWithPassword(e){try{let n;if("email"in e){const{email:o,password:s,options:a}=e;n=await de(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:o,password:s,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:Vw})}else if("phone"in e){const{phone:o,password:s,options:a}=e;n=await de(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:o,password:s,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:Vw})}else throw new rd("You must provide either an email or phone number and a password");const{data:r,error:i}=n;return i?{data:{user:null,session:null},error:i}:!r||!r.session||!r.user?{data:{user:null,session:null},error:new Lp}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:i})}catch(n){if(ae(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOAuth(e){var n,r,i,o;return await this._handleProviderSignIn(e.provider,{redirectTo:(n=e.options)===null||n===void 0?void 0:n.redirectTo,scopes:(r=e.options)===null||r===void 0?void 0:r.scopes,queryParams:(i=e.options)===null||i===void 0?void 0:i.queryParams,skipBrowserRedirect:(o=e.options)===null||o===void 0?void 0:o.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async _exchangeCodeForSession(e){const n=await td(this.storage,`${this.storageKey}-code-verifier`),[r,i]=(n??"").split("/");try{const{data:o,error:s}=await de(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:fi});if(await nd(this.storage,`${this.storageKey}-code-verifier`),s)throw s;return!o||!o.session||!o.user?{data:{user:null,session:null,redirectType:null},error:new Lp}:(o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",o.session)),{data:Object.assign(Object.assign({},o),{redirectType:i??null}),error:s})}catch(o){if(ae(o))return{data:{user:null,session:null,redirectType:null},error:o};throw o}}async signInWithIdToken(e){try{const{options:n,provider:r,token:i,access_token:o,nonce:s}=e,a=await de(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:i,access_token:o,nonce:s,gotrue_meta_security:{captcha_token:n==null?void 0:n.captchaToken}},xform:fi}),{data:l,error:c}=a;return c?{data:{user:null,session:null},error:c}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new Lp}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:c})}catch(n){if(ae(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOtp(e){var n,r,i,o,s;try{if("email"in e){const{email:a,options:l}=e;let c=null,u=null;this.flowType==="pkce"&&([c,u]=await Is(this.storage,this.storageKey));const{error:d}=await de(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:a,data:(n=l==null?void 0:l.data)!==null&&n!==void 0?n:{},create_user:(r=l==null?void 0:l.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:c,code_challenge_method:u},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:d}}if("phone"in e){const{phone:a,options:l}=e,{data:c,error:u}=await de(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:a,data:(i=l==null?void 0:l.data)!==null&&i!==void 0?i:{},create_user:(o=l==null?void 0:l.shouldCreateUser)!==null&&o!==void 0?o:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(s=l==null?void 0:l.channel)!==null&&s!==void 0?s:"sms"}});return{data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:u}}throw new rd("You must provide either an email or phone number.")}catch(a){if(ae(a))return{data:{user:null,session:null},error:a};throw a}}async verifyOtp(e){var n,r;try{let i,o;"options"in e&&(i=(n=e.options)===null||n===void 0?void 0:n.redirectTo,o=(r=e.options)===null||r===void 0?void 0:r.captchaToken);const{data:s,error:a}=await de(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:o}}),redirectTo:i,xform:fi});if(a)throw a;if(!s)throw new Error("An error occurred on token verification.");const l=s.session,c=s.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(i){if(ae(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithSSO(e){var n,r,i;try{let o=null,s=null;return this.flowType==="pkce"&&([o,s]=await Is(this.storage,this.storageKey)),await de(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(r=(n=e.options)===null||n===void 0?void 0:n.redirectTo)!==null&&r!==void 0?r:void 0}),!((i=e==null?void 0:e.options)===null||i===void 0)&&i.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:o,code_challenge_method:s}),headers:this.headers,xform:RN})}catch(o){if(ae(o))return{data:null,error:o};throw o}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:n},error:r}=e;if(r)throw r;if(!n)throw new di;const{error:i}=await de(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return{data:{user:null,session:null},error:i}})}catch(e){if(ae(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const n=`${this.url}/resend`;if("email"in e){const{email:r,type:i,options:o}=e,{error:s}=await de(this.fetch,"POST",n,{headers:this.headers,body:{email:r,type:i,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},redirectTo:o==null?void 0:o.emailRedirectTo});return{data:{user:null,session:null},error:s}}else if("phone"in e){const{phone:r,type:i,options:o}=e,{data:s,error:a}=await de(this.fetch,"POST",n,{headers:this.headers,body:{phone:r,type:i,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}}});return{data:{user:null,session:null,messageId:s==null?void 0:s.message_id},error:a}}throw new rd("You must provide either an email or phone number and a type")}catch(n){if(ae(n))return{data:{user:null,session:null},error:n};throw n}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async n=>n))}async _acquireLock(e,n){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),i=(async()=>(await r,await n()))();return this.pendingInLock.push((async()=>{try{await i}catch{}})()),i}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=n();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const i=[...this.pendingInLock];await Promise.all(i),this.pendingInLock.splice(0,i.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await e(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const n=await td(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?e=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=e.expires_at?e.expires_at*1e3-Date.now()<jp:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.storage.isServer){let s=this.suppressGetSessionWarning;e=new Proxy(e,{get:(l,c,u)=>(!s&&c==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),s=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,c,u))})}return{data:{session:e},error:null}}const{session:i,error:o}=await this._callRefreshToken(e.refresh_token);return o?{data:{session:null},error:o}:{data:{session:i},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await de(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Si}):await this._useSession(async n=>{var r,i,o;const{data:s,error:a}=n;if(a)throw a;return!(!((r=s.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new di}:await de(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(o=(i=s.session)===null||i===void 0?void 0:i.access_token)!==null&&o!==void 0?o:void 0,xform:Si})})}catch(n){if(ae(n))return SN(n)&&(await this._removeSession(),await nd(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:n};throw n}}async updateUser(e,n={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,n))}async _updateUser(e,n={}){try{return await this._useSession(async r=>{const{data:i,error:o}=r;if(o)throw o;if(!i.session)throw new di;const s=i.session;let a=null,l=null;this.flowType==="pkce"&&e.email!=null&&([a,l]=await Is(this.storage,this.storageKey));const{data:c,error:u}=await de(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n==null?void 0:n.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:a,code_challenge_method:l}),jwt:s.access_token,xform:Si});if(u)throw u;return s.user=c.user,await this._saveSession(s),await this._notifyAllSubscribers("USER_UPDATED",s),{data:{user:s.user},error:null}})}catch(r){if(ae(r))return{data:{user:null},error:r};throw r}}_decodeJWT(e){return Fw(e)}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new di;const n=Date.now()/1e3;let r=n,i=!0,o=null;const s=Fw(e.access_token);if(s.exp&&(r=s.exp,i=r<=n),i){const{session:a,error:l}=await this._callRefreshToken(e.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!a)return{data:{user:null,session:null},error:null};o=a}else{const{data:a,error:l}=await this._getUser(e.access_token);if(l)throw l;o={access_token:e.access_token,refresh_token:e.refresh_token,user:a.user,token_type:"bearer",expires_in:r-n,expires_at:r},await this._saveSession(o),await this._notifyAllSubscribers("SIGNED_IN",o)}return{data:{user:o.user,session:o},error:null}}catch(n){if(ae(n))return{data:{session:null,user:null},error:n};throw n}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async n=>{var r;if(!e){const{data:s,error:a}=n;if(a)throw a;e=(r=s.session)!==null&&r!==void 0?r:void 0}if(!(e!=null&&e.refresh_token))throw new di;const{session:i,error:o}=await this._callRefreshToken(e.refresh_token);return o?{data:{user:null,session:null},error:o}:i?{data:{user:i.user,session:i},error:null}:{data:{user:null,session:null},error:null}})}catch(n){if(ae(n))return{data:{user:null,session:null},error:n};throw n}}async _getSessionFromURL(e,n){try{if(!fr())throw new id("No browser detected.");if(e.error||e.error_description||e.error_code)throw new id(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(n){case"implicit":if(this.flowType==="pkce")throw new Bw("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new id("Not a valid implicit grant flow url.");break;default:}if(n==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Bw("No code detected.");const{data:w,error:S}=await this._exchangeCodeForSession(e.code);if(S)throw S;const b=new URL(window.location.href);return b.searchParams.delete("code"),window.history.replaceState(window.history.state,"",b.toString()),{data:{session:w.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:i,access_token:o,refresh_token:s,expires_in:a,expires_at:l,token_type:c}=e;if(!o||!a||!s||!c)throw new id("No session defined in URL");const u=Math.round(Date.now()/1e3),d=parseInt(a);let f=u+d;l&&(f=parseInt(l));const p=f-u;p*1e3<=Vs&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${p}s, should have been closer to ${d}s`);const m=f-d;u-m>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",m,f,u):u-m<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",m,f,u);const{data:g,error:v}=await this._getUser(o);if(v)throw v;const x={provider_token:r,provider_refresh_token:i,access_token:o,expires_in:d,expires_at:f,refresh_token:s,token_type:c,user:g.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:x,redirectType:e.type},error:null}}catch(r){if(ae(r))return{data:{session:null,redirectType:null},error:r};throw r}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const n=await td(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&n)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async n=>{var r;const{data:i,error:o}=n;if(o)return{error:o};const s=(r=i.session)===null||r===void 0?void 0:r.access_token;if(s){const{error:a}=await this.admin.signOut(s,e);if(a&&!(bN(a)&&(a.status===404||a.status===401||a.status===403)))return{error:a}}return e!=="others"&&(await this._removeSession(),await nd(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const n=aN(),r={id:n,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async n=>{var r,i;try{const{data:{session:o},error:s}=n;if(s)throw s;await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",o)),this._debug("INITIAL_SESSION","callback id",e,"session",o)}catch(o){await((i=this.stateChangeEmitters.get(e))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",o),console.error(o)}})}async resetPasswordForEmail(e,n={}){let r=null,i=null;this.flowType==="pkce"&&([r,i]=await Is(this.storage,this.storageKey,!0));try{return await de(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:i,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(o){if(ae(o))return{data:null,error:o};throw o}}async getUserIdentities(){var e;try{const{data:n,error:r}=await this.getUser();if(r)throw r;return{data:{identities:(e=n.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(n){if(ae(n))return{data:null,error:n};throw n}}async linkIdentity(e){var n;try{const{data:r,error:i}=await this._useSession(async o=>{var s,a,l,c,u;const{data:d,error:f}=o;if(f)throw f;const p=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(s=e.options)===null||s===void 0?void 0:s.redirectTo,scopes:(a=e.options)===null||a===void 0?void 0:a.scopes,queryParams:(l=e.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await de(this.fetch,"GET",p,{headers:this.headers,jwt:(u=(c=d.session)===null||c===void 0?void 0:c.access_token)!==null&&u!==void 0?u:void 0})});if(i)throw i;return fr()&&!(!((n=e.options)===null||n===void 0)&&n.skipBrowserRedirect)&&window.location.assign(r==null?void 0:r.url),{data:{provider:e.provider,url:r==null?void 0:r.url},error:null}}catch(r){if(ae(r))return{data:{provider:e.provider,url:null},error:r};throw r}}async unlinkIdentity(e){try{return await this._useSession(async n=>{var r,i;const{data:o,error:s}=n;if(s)throw s;return await de(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(i=(r=o.session)===null||r===void 0?void 0:r.access_token)!==null&&i!==void 0?i:void 0})})}catch(n){if(ae(n))return{data:null,error:n};throw n}}async _refreshAccessToken(e){const n=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{const r=Date.now();return await fN(async i=>(i>0&&await dN(200*Math.pow(2,i-1)),this._debug(n,"refreshing attempt",i),await de(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:fi})),(i,o)=>{const s=200*Math.pow(2,i);return o&&$p(o)&&Date.now()+s-r<Vs})}catch(r){if(this._debug(n,"error",r),ae(r))return{data:{session:null,user:null},error:r};throw r}finally{this._debug(n,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,n){const r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",n,"url",r),fr()&&!n.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const r=await td(this.storage,this.storageKey);if(this._debug(n,"session from storage",r),!this._isValidSession(r)){this._debug(n,"session is not valid"),r!==null&&await this._removeSession();return}const i=((e=r.expires_at)!==null&&e!==void 0?e:1/0)*1e3-Date.now()<jp;if(this._debug(n,`session has${i?"":" not"} expired with margin of ${jp}s`),i){if(this.autoRefreshToken&&r.refresh_token){const{error:o}=await this._callRefreshToken(r.refresh_token);o&&(console.error(o),$p(o)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",r)}catch(r){this._debug(n,"error",r),console.error(r);return}finally{this._debug(n,"end")}}async _callRefreshToken(e){var n,r;if(!e)throw new di;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const i=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(i,"begin");try{this.refreshingDeferred=new Ch;const{data:o,error:s}=await this._refreshAccessToken(e);if(s)throw s;if(!o.session)throw new di;await this._saveSession(o.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",o.session);const a={session:o.session,error:null};return this.refreshingDeferred.resolve(a),a}catch(o){if(this._debug(i,"error",o),ae(o)){const s={session:null,error:o};return $p(o)||await this._removeSession(),(n=this.refreshingDeferred)===null||n===void 0||n.resolve(s),s}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(o),o}finally{this.refreshingDeferred=null,this._debug(i,"end")}}async _notifyAllSubscribers(e,n,r=!0){const i=`#_notifyAllSubscribers(${e})`;this._debug(i,"begin",n,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:n});const o=[],s=Array.from(this.stateChangeEmitters.values()).map(async a=>{try{await a.callback(e,n)}catch(l){o.push(l)}});if(await Promise.all(s),o.length>0){for(let a=0;a<o.length;a+=1)console.error(o[a]);throw o[0]}}finally{this._debug(i,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await CE(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await nd(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&fr()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(n){console.error("removing visibilitychange callback failed",n)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Vs);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async n=>{const{data:{session:r}}=n;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const i=Math.floor((r.expires_at*1e3-e)/Vs);this._debug("#_autoRefreshTokenTick()",`access token expires in ${i} ticks, a tick lasts ${Vs}ms, refresh threshold is ${Hg} ticks`),i<=Hg&&await this._callRefreshToken(r.refresh_token)})}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof EE)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!fr()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const n=`#_onVisibilityChanged(${e})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,n,r){const i=[`provider=${encodeURIComponent(n)}`];if(r!=null&&r.redirectTo&&i.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r!=null&&r.scopes&&i.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[o,s]=await Is(this.storage,this.storageKey),a=new URLSearchParams({code_challenge:`${encodeURIComponent(o)}`,code_challenge_method:`${encodeURIComponent(s)}`});i.push(a.toString())}if(r!=null&&r.queryParams){const o=new URLSearchParams(r.queryParams);i.push(o.toString())}return r!=null&&r.skipBrowserRedirect&&i.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${i.join("&")}`}async _unenroll(e){try{return await this._useSession(async n=>{var r;const{data:i,error:o}=n;return o?{data:null,error:o}:await de(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token})})}catch(n){if(ae(n))return{data:null,error:n};throw n}}async _enroll(e){try{return await this._useSession(async n=>{var r,i;const{data:o,error:s}=n;if(s)return{data:null,error:s};const a=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:l,error:c}=await de(this.fetch,"POST",`${this.url}/factors`,{body:a,headers:this.headers,jwt:(r=o==null?void 0:o.session)===null||r===void 0?void 0:r.access_token});return c?{data:null,error:c}:(e.factorType==="totp"&&(!((i=l==null?void 0:l.totp)===null||i===void 0)&&i.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(n){if(ae(n))return{data:null,error:n};throw n}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var r;const{data:i,error:o}=n;if(o)return{data:null,error:o};const{data:s,error:a}=await de(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token});return a?{data:null,error:a}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+s.expires_in},s)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",s),{data:s,error:a})})}catch(n){if(ae(n))return{data:null,error:n};throw n}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var r;const{data:i,error:o}=n;return o?{data:null,error:o}:await de(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token})})}catch(n){if(ae(n))return{data:null,error:n};throw n}})}async _challengeAndVerify(e){const{data:n,error:r}=await this._challenge({factorId:e.factorId});return r?{data:null,error:r}:await this._verify({factorId:e.factorId,challengeId:n.id,code:e.code})}async _listFactors(){const{data:{user:e},error:n}=await this.getUser();if(n)return{data:null,error:n};const r=(e==null?void 0:e.factors)||[],i=r.filter(s=>s.factor_type==="totp"&&s.status==="verified"),o=r.filter(s=>s.factor_type==="phone"&&s.status==="verified");return{data:{all:r,totp:i,phone:o},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var n,r;const{data:{session:i},error:o}=e;if(o)return{data:null,error:o};if(!i)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const s=this._decodeJWT(i.access_token);let a=null;s.aal&&(a=s.aal);let l=a;((r=(n=i.user.factors)===null||n===void 0?void 0:n.filter(d=>d.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(l="aal2");const u=s.amr||[];return{data:{currentLevel:a,nextLevel:l,currentAuthenticationMethods:u},error:null}}))}}Oc.nextInstanceID=0;const FN=Oc;class BN extends FN{constructor(e){super(e)}}var zN=globalThis&&globalThis.__awaiter||function(t,e,n,r){function i(o){return o instanceof n?o:new n(function(s){s(o)})}return new(n||(n=Promise))(function(o,s){function a(u){try{c(r.next(u))}catch(d){s(d)}}function l(u){try{c(r.throw(u))}catch(d){s(d)}}function c(u){u.done?o(u.value):i(u.value).then(a,l)}c((r=r.apply(t,e||[])).next())})};class UN{constructor(e,n,r){var i,o,s;if(this.supabaseUrl=e,this.supabaseKey=n,!e)throw new Error("supabaseUrl is required.");if(!n)throw new Error("supabaseKey is required.");const a=tN(e);this.realtimeUrl=`${a}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${a}/auth/v1`,this.storageUrl=`${a}/storage/v1`,this.functionsUrl=`${a}/functions/v1`;const l=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,c={db:qI,realtime:JI,auth:Object.assign(Object.assign({},GI),{storageKey:l}),global:KI},u=nN(r??{},c);this.storageKey=(i=u.auth.storageKey)!==null&&i!==void 0?i:"",this.headers=(o=u.global.headers)!==null&&o!==void 0?o:{},u.accessToken?(this.accessToken=u.accessToken,this.auth=new Proxy({},{get:(d,f)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(f)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((s=u.auth)!==null&&s!==void 0?s:{},this.headers,u.global.fetch),this.fetch=ZI(n,this._getAccessToken.bind(this),u.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},u.realtime)),this.rest=new pI(`${a}/rest/v1`,{headers:this.headers,schema:u.db.schema,fetch:this.fetch}),u.accessToken||this._listenForAuthEvents()}get functions(){return new H2(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new VI(this.storageUrl,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,n={},r={}){return this.rest.rpc(e,n,r)}channel(e,n={config:{}}){return this.realtime.channel(e,n)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,n;return zN(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:r}=yield this.auth.getSession();return(n=(e=r.session)===null||e===void 0?void 0:e.access_token)!==null&&n!==void 0?n:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:n,detectSessionInUrl:r,storage:i,storageKey:o,flowType:s,lock:a,debug:l},c,u){const d={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new BN({url:this.authUrl,headers:Object.assign(Object.assign({},d),c),storageKey:o,autoRefreshToken:e,persistSession:n,detectSessionInUrl:r,storage:i,flowType:s,lock:a,debug:l,fetch:u,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new OI(this.realtimeUrl,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((n,r)=>{this._handleTokenChanged(n,"CLIENT",r==null?void 0:r.access_token)})}_handleTokenChanged(e,n,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?this.changedAccessToken=r:e==="SIGNED_OUT"&&(this.realtime.setAuth(),n=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const VN=(t,e,n)=>new UN(t,e,n);function HN(){const t="production";return{apiUrl:"https://api.eastmedical.ai",wsUrl:{}.VITE_WS_URL||"ws://localhost:3000",supabaseUrl:"https://apnxgktdaiqoesqyseiz.supabase.co",supabaseAnonKey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFwbnhna3RkYWlxb2VzcXlzZWl6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDExMzQxNjEsImV4cCI6MjA1NjcxMDE2MX0.XhGhD7ESMUFhZso3wY_ee_WHGWde5v748qFDAhgSQ04",environment:t}}const Tr=HN(),pn=VN(Tr.supabaseUrl,Tr.supabaseAnonKey,{realtime:{params:{eventsPerSecond:10}},auth:{persistSession:!0,autoRefreshToken:!0}});function Be(){return pn}const TE=y.createContext(void 0);function WN({children:t}){const e=Be(),[n,r]=y.useState(void 0),[i,o]=y.useState(!0),s=uo();y.useEffect(()=>{e.auth.getSession().then(({data:{session:d}})=>{r((d==null?void 0:d.user)??void 0),o(!1)});const{data:{subscription:u}}=e.auth.onAuthStateChange((d,f)=>{r((f==null?void 0:f.user)??void 0),d==="SIGNED_OUT"&&s.clear()});return()=>{u.unsubscribe()}},[e,s]);const c={user:n,loading:i,signIn:async(u,d)=>{const{data:f,error:p}=await e.auth.signInWithPassword({email:u,password:d});if(p)throw p;return f},signOut:async()=>{const{error:u}=await e.auth.signOut();if(u)throw u;s.clear()}};return h.jsx(TE.Provider,{value:c,children:t})}const si={container:{display:"flex",gap:"24px",height:"100%"},transcriptPanel:{flex:1,display:"flex",flexDirection:"column",backgroundColor:"white",borderRadius:"6px",border:"1px solid #e5e7eb",padding:"16px",overflow:"auto"},contextPanel:{flex:1,display:"flex",flexDirection:"column",backgroundColor:"white",borderRadius:"6px",border:"1px solid #e5e7eb",padding:"16px",overflow:"auto"},text:{fontSize:"16px",color:"#374151",lineHeight:"1.5",whiteSpace:"pre-wrap",margin:0},contentContainer:{display:"flex",flexDirection:"column",height:"100%"},contextTitle:{fontSize:"18px",fontWeight:600,color:"#111827",marginBottom:"12px"},contextContent:{fontSize:"16px",lineHeight:"1.5",color:"#374151",whiteSpace:"pre-wrap",flex:1}};function KN({transcription:t="",placeholder:e="Your transcription will appear here as you speak...",isTranscribing:n,visit:r,aiContextNote:i}){const[o,s]=y.useState(""),a=y.useRef([]),l=y.useRef(null),c=y.useRef(0),u=y.useRef(t),d=y.useCallback(()=>{l.current&&(window.clearTimeout(l.current),l.current=null)},[]);y.useEffect(()=>{s(""),a.current=[],c.current=0,u.current="",d()},[r==null?void 0:r.id,d]);const f=y.useCallback((g,v)=>{const x=100+Math.random()*100,w=Math.min(g.length*10,100),S=/[,.!?]$/.test(g)?200:0,b=Math.max(.7,1-v/200);return(x+w+S)*b},[]),p=y.useCallback(()=>{const g=a.current;if(g.length>0){const v=g[0];if(a.current=g.slice(1),c.current+=1,s(x=>{const w=x.length>0&&!/[\s\u4e00-\u9fff]$/.test(x)&&!/^[\u4e00-\u9fff]/.test(v);return x+(w?" ":"")+v}),a.current.length>0){const x=f(v,c.current);d(),l.current=window.setTimeout(p,x)}else d()}},[f,d]),m=y.useCallback(g=>{if(!g)return[];const x=g.replace(/([\u4e00-\u9fff])/g," $1 ").split(/\s+/).filter(Boolean),w=[];for(const S of x)if(/[\u4e00-\u9fff]/.test(S)){const b=S.split("");w.push(...b)}else w.push(S);return w},[]);return y.useEffect(()=>{if(!n){s(t),d();return}if(t===u.current)return;if(u.current=t,!t){console.log("[LiveTranscriptionDisplay] Resetting display - no transcription"),s(""),a.current=[],c.current=0,d();return}const g=m(t);if(g.length<c.current){console.log("[LiveTranscriptionDisplay] Reset detected"),d(),s(t),a.current=[],c.current=g.length;return}if(g.length>c.current){console.log("[LiveTranscriptionDisplay] New words detected:",{newWordsCount:g.length-c.current});const v=g.slice(c.current);a.current=v,l.current||p()}},[t,n,d,m,p]),y.useEffect(()=>()=>{d()},[d]),h.jsxs("div",{style:si.container,children:[h.jsxs("div",{style:si.transcriptPanel,children:[h.jsx("div",{style:si.contextTitle,children:"Transcript"}),h.jsx("div",{style:si.contentContainer,children:h.jsx("p",{style:si.text,children:o||t||e})})]}),h.jsxs("div",{style:si.contextPanel,children:[h.jsx("div",{style:si.contextTitle,children:"Context"}),h.jsx("div",{style:si.contextContent,children:(i==null?void 0:i.content)||"No context available yet..."})]})]})}const Tt={modalOverlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3},modalContent:{backgroundColor:"white",padding:"24px",borderRadius:"8px",width:"90%",maxWidth:"600px",maxHeight:"80vh",display:"flex",flexDirection:"column"},header:{marginBottom:"16px"},title:{fontSize:"18px",fontWeight:"600",color:"#111827",marginBottom:"8px"},description:{fontSize:"14px",color:"#6b7280"},templateList:{overflowY:"auto",flex:1,marginBottom:"16px",padding:"8px 0"},templateItem:{padding:"12px 16px",borderRadius:"6px",cursor:"pointer",transition:"all 0.2s ease",marginBottom:"8px",border:"1px solid #e5e7eb",minHeight:"48px",display:"flex","&:hover":{backgroundColor:"#f3f4f6"}},templateName:{fontSize:"16px",fontWeight:"500",color:"#111827",marginBottom:"4px"},templateDescription:{fontSize:"14px",color:"#6b7280"},footer:{display:"flex",justifyContent:"flex-end",gap:"8px",borderTop:"1px solid #e5e7eb",paddingTop:"16px"},button:{padding:"8px 16px",borderRadius:"6px",border:"none",cursor:"pointer",fontSize:"14px",fontWeight:"500",transition:"all 0.2s ease"},cancelButton:{backgroundColor:"#f3f4f6",color:"#374151","&:hover":{backgroundColor:"#e5e7eb"}},generateButton:{backgroundColor:"#3b82f6",color:"white","&:hover":{backgroundColor:"#2563eb"}},disabledButton:{opacity:.5,cursor:"not-allowed","&:hover":{backgroundColor:"#3b82f6"}}};function qN({isOpen:t,onClose:e,onGenerate:n,existingTemplateIds:r=[]}){const[i,o]=y.useState([]),[s,a]=y.useState(void 0),[l,c]=y.useState(!0),u=Be();if(y.useEffect(()=>{t&&(async()=>{try{const{data:f,error:p}=await u.from("template_library").select("*").order("name");if(p)throw p;const m=(f==null?void 0:f.filter(g=>!r.includes(g.id)))||[];console.log("Available templates:",m),o(m)}catch(f){console.error("Error fetching templates:",f)}finally{c(!1)}})()},[t,u,r]),!!t)return h.jsx("div",{style:Tt.modalOverlay,onClick:e,children:h.jsxs("div",{style:Tt.modalContent,onClick:d=>d.stopPropagation(),children:[h.jsxs("div",{style:Tt.header,children:[h.jsx("h2",{style:Tt.title,children:"Select Template"}),h.jsx("p",{style:Tt.description,children:"Choose a template to generate a new note"})]}),h.jsx("div",{style:Tt.templateList,children:l?h.jsx("div",{children:"Loading templates..."}):i.length===0?h.jsx("div",{children:"No templates available"}):i.map(d=>h.jsxs("div",{style:{...Tt.templateItem,...(s==null?void 0:s.id)===d.id?{backgroundColor:"#f3f4f6",borderColor:"#3b82f6"}:{}},onClick:()=>a(d),children:[h.jsx("div",{style:Tt.templateName,children:d.name}),d.description&&h.jsx("div",{style:Tt.templateDescription,children:d.description})]},d.id))}),h.jsxs("div",{style:Tt.footer,children:[h.jsx("button",{style:{...Tt.button,...Tt.cancelButton},onClick:e,children:"Cancel"}),h.jsx("button",{style:{...Tt.button,...Tt.generateButton,...!s||l?Tt.disabledButton:{}},onClick:()=>s&&n(s),disabled:!s||l,children:"Generate Note"})]})]})})}function lt(t){this.content=t}lt.prototype={constructor:lt,find:function(t){for(var e=0;e<this.content.length;e+=2)if(this.content[e]===t)return e;return-1},get:function(t){var e=this.find(t);return e==-1?void 0:this.content[e+1]},update:function(t,e,n){var r=n&&n!=t?this.remove(n):this,i=r.find(t),o=r.content.slice();return i==-1?o.push(n||t,e):(o[i+1]=e,n&&(o[i]=n)),new lt(o)},remove:function(t){var e=this.find(t);if(e==-1)return this;var n=this.content.slice();return n.splice(e,2),new lt(n)},addToStart:function(t,e){return new lt([t,e].concat(this.remove(t).content))},addToEnd:function(t,e){var n=this.remove(t).content.slice();return n.push(t,e),new lt(n)},addBefore:function(t,e,n){var r=this.remove(e),i=r.content.slice(),o=r.find(t);return i.splice(o==-1?i.length:o,0,e,n),new lt(i)},forEach:function(t){for(var e=0;e<this.content.length;e+=2)t(this.content[e],this.content[e+1])},prepend:function(t){return t=lt.from(t),t.size?new lt(t.content.concat(this.subtract(t).content)):this},append:function(t){return t=lt.from(t),t.size?new lt(this.subtract(t).content.concat(t.content)):this},subtract:function(t){var e=this;t=lt.from(t);for(var n=0;n<t.content.length;n+=2)e=e.remove(t.content[n]);return e},toObject:function(){var t={};return this.forEach(function(e,n){t[e]=n}),t},get size(){return this.content.length>>1}};lt.from=function(t){if(t instanceof lt)return t;var e=[];if(t)for(var n in t)e.push(n,t[n]);return new lt(e)};function _E(t,e,n){for(let r=0;;r++){if(r==t.childCount||r==e.childCount)return t.childCount==e.childCount?null:n;let i=t.child(r),o=e.child(r);if(i==o){n+=i.nodeSize;continue}if(!i.sameMarkup(o))return n;if(i.isText&&i.text!=o.text){for(let s=0;i.text[s]==o.text[s];s++)n++;return n}if(i.content.size||o.content.size){let s=_E(i.content,o.content,n+1);if(s!=null)return s}n+=i.nodeSize}}function RE(t,e,n,r){for(let i=t.childCount,o=e.childCount;;){if(i==0||o==0)return i==o?null:{a:n,b:r};let s=t.child(--i),a=e.child(--o),l=s.nodeSize;if(s==a){n-=l,r-=l;continue}if(!s.sameMarkup(a))return{a:n,b:r};if(s.isText&&s.text!=a.text){let c=0,u=Math.min(s.text.length,a.text.length);for(;c<u&&s.text[s.text.length-c-1]==a.text[a.text.length-c-1];)c++,n--,r--;return{a:n,b:r}}if(s.content.size||a.content.size){let c=RE(s.content,a.content,n-1,r-1);if(c)return c}n-=l,r-=l}}class j{constructor(e,n){if(this.content=e,this.size=n||0,n==null)for(let r=0;r<e.length;r++)this.size+=e[r].nodeSize}nodesBetween(e,n,r,i=0,o){for(let s=0,a=0;a<n;s++){let l=this.content[s],c=a+l.nodeSize;if(c>e&&r(l,i+a,o||null,s)!==!1&&l.content.size){let u=a+1;l.nodesBetween(Math.max(0,e-u),Math.min(l.content.size,n-u),r,i+u)}a=c}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,n,r,i){let o="",s=!0;return this.nodesBetween(e,n,(a,l)=>{let c=a.isText?a.text.slice(Math.max(e,l)-l,n-l):a.isLeaf?i?typeof i=="function"?i(a):i:a.type.spec.leafText?a.type.spec.leafText(a):"":"";a.isBlock&&(a.isLeaf&&c||a.isTextblock)&&r&&(s?s=!1:o+=r),o+=c},0),o}append(e){if(!e.size)return this;if(!this.size)return e;let n=this.lastChild,r=e.firstChild,i=this.content.slice(),o=0;for(n.isText&&n.sameMarkup(r)&&(i[i.length-1]=n.withText(n.text+r.text),o=1);o<e.content.length;o++)i.push(e.content[o]);return new j(i,this.size+e.size)}cut(e,n=this.size){if(e==0&&n==this.size)return this;let r=[],i=0;if(n>e)for(let o=0,s=0;s<n;o++){let a=this.content[o],l=s+a.nodeSize;l>e&&((s<e||l>n)&&(a.isText?a=a.cut(Math.max(0,e-s),Math.min(a.text.length,n-s)):a=a.cut(Math.max(0,e-s-1),Math.min(a.content.size,n-s-1))),r.push(a),i+=a.nodeSize),s=l}return new j(r,i)}cutByIndex(e,n){return e==n?j.empty:e==0&&n==this.content.length?this:new j(this.content.slice(e,n))}replaceChild(e,n){let r=this.content[e];if(r==n)return this;let i=this.content.slice(),o=this.size+n.nodeSize-r.nodeSize;return i[e]=n,new j(i,o)}addToStart(e){return new j([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new j(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let n=0;n<this.content.length;n++)if(!this.content[n].eq(e.content[n]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let n=this.content[e];if(!n)throw new RangeError("Index "+e+" out of range for "+this);return n}maybeChild(e){return this.content[e]||null}forEach(e){for(let n=0,r=0;n<this.content.length;n++){let i=this.content[n];e(i,r,n),r+=i.nodeSize}}findDiffStart(e,n=0){return _E(this,e,n)}findDiffEnd(e,n=this.size,r=e.size){return RE(this,e,n,r)}findIndex(e,n=-1){if(e==0)return od(0,e);if(e==this.size)return od(this.content.length,e);if(e>this.size||e<0)throw new RangeError(`Position ${e} outside of fragment (${this})`);for(let r=0,i=0;;r++){let o=this.child(r),s=i+o.nodeSize;if(s>=e)return s==e||n>0?od(r+1,s):od(r,i);i=s}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,n){if(!n)return j.empty;if(!Array.isArray(n))throw new RangeError("Invalid input for Fragment.fromJSON");return new j(n.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return j.empty;let n,r=0;for(let i=0;i<e.length;i++){let o=e[i];r+=o.nodeSize,i&&o.isText&&e[i-1].sameMarkup(o)?(n||(n=e.slice(0,i)),n[n.length-1]=o.withText(n[n.length-1].text+o.text)):n&&n.push(o)}return new j(n||e,r)}static from(e){if(!e)return j.empty;if(e instanceof j)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new j([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}j.empty=new j([],0);const Fp={index:0,offset:0};function od(t,e){return Fp.index=t,Fp.offset=e,Fp}function Cf(t,e){if(t===e)return!0;if(!(t&&typeof t=="object")||!(e&&typeof e=="object"))return!1;let n=Array.isArray(t);if(Array.isArray(e)!=n)return!1;if(n){if(t.length!=e.length)return!1;for(let r=0;r<t.length;r++)if(!Cf(t[r],e[r]))return!1}else{for(let r in t)if(!(r in e)||!Cf(t[r],e[r]))return!1;for(let r in e)if(!(r in t))return!1}return!0}let Se=class qg{constructor(e,n){this.type=e,this.attrs=n}addToSet(e){let n,r=!1;for(let i=0;i<e.length;i++){let o=e[i];if(this.eq(o))return e;if(this.type.excludes(o.type))n||(n=e.slice(0,i));else{if(o.type.excludes(this.type))return e;!r&&o.type.rank>this.type.rank&&(n||(n=e.slice(0,i)),n.push(this),r=!0),n&&n.push(o)}}return n||(n=e.slice()),r||n.push(this),n}removeFromSet(e){for(let n=0;n<e.length;n++)if(this.eq(e[n]))return e.slice(0,n).concat(e.slice(n+1));return e}isInSet(e){for(let n=0;n<e.length;n++)if(this.eq(e[n]))return!0;return!1}eq(e){return this==e||this.type==e.type&&Cf(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let n in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,n){if(!n)throw new RangeError("Invalid input for Mark.fromJSON");let r=e.marks[n.type];if(!r)throw new RangeError(`There is no mark type ${n.type} in this schema`);let i=r.create(n.attrs);return r.checkAttrs(i.attrs),i}static sameSet(e,n){if(e==n)return!0;if(e.length!=n.length)return!1;for(let r=0;r<e.length;r++)if(!e[r].eq(n[r]))return!1;return!0}static setFrom(e){if(!e||Array.isArray(e)&&e.length==0)return qg.none;if(e instanceof qg)return[e];let n=e.slice();return n.sort((r,i)=>r.type.rank-i.type.rank),n}};Se.none=[];class kf extends Error{}class V{constructor(e,n,r){this.content=e,this.openStart=n,this.openEnd=r}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,n){let r=PE(this.content,e+this.openStart,n);return r&&new V(r,this.openStart,this.openEnd)}removeBetween(e,n){return new V(OE(this.content,e+this.openStart,n+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,n){if(!n)return V.empty;let r=n.openStart||0,i=n.openEnd||0;if(typeof r!="number"||typeof i!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new V(j.fromJSON(e,n.content),r,i)}static maxOpen(e,n=!0){let r=0,i=0;for(let o=e.firstChild;o&&!o.isLeaf&&(n||!o.type.spec.isolating);o=o.firstChild)r++;for(let o=e.lastChild;o&&!o.isLeaf&&(n||!o.type.spec.isolating);o=o.lastChild)i++;return new V(e,r,i)}}V.empty=new V(j.empty,0,0);function OE(t,e,n){let{index:r,offset:i}=t.findIndex(e),o=t.maybeChild(r),{index:s,offset:a}=t.findIndex(n);if(i==e||o.isText){if(a!=n&&!t.child(s).isText)throw new RangeError("Removing non-flat range");return t.cut(0,e).append(t.cut(n))}if(r!=s)throw new RangeError("Removing non-flat range");return t.replaceChild(r,o.copy(OE(o.content,e-i-1,n-i-1)))}function PE(t,e,n,r){let{index:i,offset:o}=t.findIndex(e),s=t.maybeChild(i);if(o==e||s.isText)return r&&!r.canReplace(i,i,n)?null:t.cut(0,e).append(n).append(t.cut(e));let a=PE(s.content,e-o-1,n);return a&&t.replaceChild(i,s.copy(a))}function GN(t,e,n){if(n.openStart>t.depth)throw new kf("Inserted content deeper than insertion position");if(t.depth-n.openStart!=e.depth-n.openEnd)throw new kf("Inconsistent open depths");return ME(t,e,n,0)}function ME(t,e,n,r){let i=t.index(r),o=t.node(r);if(i==e.index(r)&&r<t.depth-n.openStart){let s=ME(t,e,n,r+1);return o.copy(o.content.replaceChild(i,s))}else if(n.content.size)if(!n.openStart&&!n.openEnd&&t.depth==r&&e.depth==r){let s=t.parent,a=s.content;return Xo(s,a.cut(0,t.parentOffset).append(n.content).append(a.cut(e.parentOffset)))}else{let{start:s,end:a}=JN(n,t);return Xo(o,DE(t,s,a,e,r))}else return Xo(o,Ef(t,e,r))}function AE(t,e){if(!e.type.compatibleContent(t.type))throw new kf("Cannot join "+e.type.name+" onto "+t.type.name)}function Gg(t,e,n){let r=t.node(n);return AE(r,e.node(n)),r}function Qo(t,e){let n=e.length-1;n>=0&&t.isText&&t.sameMarkup(e[n])?e[n]=t.withText(e[n].text+t.text):e.push(t)}function tc(t,e,n,r){let i=(e||t).node(n),o=0,s=e?e.index(n):i.childCount;t&&(o=t.index(n),t.depth>n?o++:t.textOffset&&(Qo(t.nodeAfter,r),o++));for(let a=o;a<s;a++)Qo(i.child(a),r);e&&e.depth==n&&e.textOffset&&Qo(e.nodeBefore,r)}function Xo(t,e){return t.type.checkContent(e),t.copy(e)}function DE(t,e,n,r,i){let o=t.depth>i&&Gg(t,e,i+1),s=r.depth>i&&Gg(n,r,i+1),a=[];return tc(null,t,i,a),o&&s&&e.index(i)==n.index(i)?(AE(o,s),Qo(Xo(o,DE(t,e,n,r,i+1)),a)):(o&&Qo(Xo(o,Ef(t,e,i+1)),a),tc(e,n,i,a),s&&Qo(Xo(s,Ef(n,r,i+1)),a)),tc(r,null,i,a),new j(a)}function Ef(t,e,n){let r=[];if(tc(null,t,n,r),t.depth>n){let i=Gg(t,e,n+1);Qo(Xo(i,Ef(t,e,n+1)),r)}return tc(e,null,n,r),new j(r)}function JN(t,e){let n=e.depth-t.openStart,i=e.node(n).copy(t.content);for(let o=n-1;o>=0;o--)i=e.node(o).copy(j.from(i));return{start:i.resolveNoCache(t.openStart+n),end:i.resolveNoCache(i.content.size-t.openEnd-n)}}class Pc{constructor(e,n,r){this.pos=e,this.path=n,this.parentOffset=r,this.depth=n.length/3-1}resolveDepth(e){return e==null?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[this.resolveDepth(e)*3]}index(e){return this.path[this.resolveDepth(e)*3+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e==this.depth&&!this.textOffset?0:1)}start(e){return e=this.resolveDepth(e),e==0?0:this.path[e*3-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]}after(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]+this.path[e*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,n=this.index(this.depth);if(n==e.childCount)return null;let r=this.pos-this.path[this.path.length-1],i=e.child(n);return r?e.child(n).cut(r):i}get nodeBefore(){let e=this.index(this.depth),n=this.pos-this.path[this.path.length-1];return n?this.parent.child(e).cut(0,n):e==0?null:this.parent.child(e-1)}posAtIndex(e,n){n=this.resolveDepth(n);let r=this.path[n*3],i=n==0?0:this.path[n*3-1]+1;for(let o=0;o<e;o++)i+=r.child(o).nodeSize;return i}marks(){let e=this.parent,n=this.index();if(e.content.size==0)return Se.none;if(this.textOffset)return e.child(n).marks;let r=e.maybeChild(n-1),i=e.maybeChild(n);if(!r){let a=r;r=i,i=a}let o=r.marks;for(var s=0;s<o.length;s++)o[s].type.spec.inclusive===!1&&(!i||!o[s].isInSet(i.marks))&&(o=o[s--].removeFromSet(o));return o}marksAcross(e){let n=this.parent.maybeChild(this.index());if(!n||!n.isInline)return null;let r=n.marks,i=e.parent.maybeChild(e.index());for(var o=0;o<r.length;o++)r[o].type.spec.inclusive===!1&&(!i||!r[o].isInSet(i.marks))&&(r=r[o--].removeFromSet(r));return r}sharedDepth(e){for(let n=this.depth;n>0;n--)if(this.start(n)<=e&&this.end(n)>=e)return n;return 0}blockRange(e=this,n){if(e.pos<this.pos)return e.blockRange(this);for(let r=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);r>=0;r--)if(e.pos<=this.end(r)&&(!n||n(this.node(r))))return new Tf(this,e,r);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let n=1;n<=this.depth;n++)e+=(e?"/":"")+this.node(n).type.name+"_"+this.index(n-1);return e+":"+this.parentOffset}static resolve(e,n){if(!(n>=0&&n<=e.content.size))throw new RangeError("Position "+n+" out of range");let r=[],i=0,o=n;for(let s=e;;){let{index:a,offset:l}=s.content.findIndex(o),c=o-l;if(r.push(s,a,i+l),!c||(s=s.child(a),s.isText))break;o=c-1,i+=l+1}return new Pc(n,r,o)}static resolveCached(e,n){let r=Kw.get(e);if(r)for(let o=0;o<r.elts.length;o++){let s=r.elts[o];if(s.pos==n)return s}else Kw.set(e,r=new YN);let i=r.elts[r.i]=Pc.resolve(e,n);return r.i=(r.i+1)%QN,i}}class YN{constructor(){this.elts=[],this.i=0}}const QN=12,Kw=new WeakMap;class Tf{constructor(e,n,r){this.$from=e,this.$to=n,this.depth=r}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const XN=Object.create(null);let qi=class Jg{constructor(e,n,r,i=Se.none){this.type=e,this.attrs=n,this.marks=i,this.content=r||j.empty}get children(){return this.content.content}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,n,r,i=0){this.content.nodesBetween(e,n,r,i,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,n,r,i){return this.content.textBetween(e,n,r,i)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,n,r){return this.type==e&&Cf(this.attrs,n||e.defaultAttrs||XN)&&Se.sameSet(this.marks,r||Se.none)}copy(e=null){return e==this.content?this:new Jg(this.type,this.attrs,e,this.marks)}mark(e){return e==this.marks?this:new Jg(this.type,this.attrs,this.content,e)}cut(e,n=this.content.size){return e==0&&n==this.content.size?this:this.copy(this.content.cut(e,n))}slice(e,n=this.content.size,r=!1){if(e==n)return V.empty;let i=this.resolve(e),o=this.resolve(n),s=r?0:i.sharedDepth(n),a=i.start(s),c=i.node(s).content.cut(i.pos-a,o.pos-a);return new V(c,i.depth-s,o.depth-s)}replace(e,n,r){return GN(this.resolve(e),this.resolve(n),r)}nodeAt(e){for(let n=this;;){let{index:r,offset:i}=n.content.findIndex(e);if(n=n.maybeChild(r),!n)return null;if(i==e||n.isText)return n;e-=i+1}}childAfter(e){let{index:n,offset:r}=this.content.findIndex(e);return{node:this.content.maybeChild(n),index:n,offset:r}}childBefore(e){if(e==0)return{node:null,index:0,offset:0};let{index:n,offset:r}=this.content.findIndex(e);if(r<e)return{node:this.content.child(n),index:n,offset:r};let i=this.content.child(n-1);return{node:i,index:n-1,offset:r-i.nodeSize}}resolve(e){return Pc.resolveCached(this,e)}resolveNoCache(e){return Pc.resolve(this,e)}rangeHasMark(e,n,r){let i=!1;return n>e&&this.nodesBetween(e,n,o=>(r.isInSet(o.marks)&&(i=!0),!i)),i}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),IE(this.marks,e)}contentMatchAt(e){let n=this.type.contentMatch.matchFragment(this.content,0,e);if(!n)throw new Error("Called contentMatchAt on a node with invalid content");return n}canReplace(e,n,r=j.empty,i=0,o=r.childCount){let s=this.contentMatchAt(e).matchFragment(r,i,o),a=s&&s.matchFragment(this.content,n);if(!a||!a.validEnd)return!1;for(let l=i;l<o;l++)if(!this.type.allowsMarks(r.child(l).marks))return!1;return!0}canReplaceWith(e,n,r,i){if(i&&!this.type.allowsMarks(i))return!1;let o=this.contentMatchAt(e).matchType(r),s=o&&o.matchFragment(this.content,n);return s?s.validEnd:!1}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let e=Se.none;for(let n=0;n<this.marks.length;n++){let r=this.marks[n];r.type.checkAttrs(r.attrs),e=r.addToSet(e)}if(!Se.sameSet(e,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(n=>n.type.name)}`);this.content.forEach(n=>n.check())}toJSON(){let e={type:this.type.name};for(let n in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map(n=>n.toJSON())),e}static fromJSON(e,n){if(!n)throw new RangeError("Invalid input for Node.fromJSON");let r;if(n.marks){if(!Array.isArray(n.marks))throw new RangeError("Invalid mark data for Node.fromJSON");r=n.marks.map(e.markFromJSON)}if(n.type=="text"){if(typeof n.text!="string")throw new RangeError("Invalid text node in JSON");return e.text(n.text,r)}let i=j.fromJSON(e,n.content),o=e.nodeType(n.type).create(n.attrs,i,r);return o.type.checkAttrs(o.attrs),o}};qi.prototype.text=void 0;class _f extends qi{constructor(e,n,r,i){if(super(e,n,null,i),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):IE(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(e,n){return this.text.slice(e,n)}get nodeSize(){return this.text.length}mark(e){return e==this.marks?this:new _f(this.type,this.attrs,this.text,e)}withText(e){return e==this.text?this:new _f(this.type,this.attrs,e,this.marks)}cut(e=0,n=this.text.length){return e==0&&n==this.text.length?this:this.withText(this.text.slice(e,n))}eq(e){return this.sameMarkup(e)&&this.text==e.text}toJSON(){let e=super.toJSON();return e.text=this.text,e}}function IE(t,e){for(let n=t.length-1;n>=0;n--)e=t[n].type.name+"("+e+")";return e}class ps{constructor(e){this.validEnd=e,this.next=[],this.wrapCache=[]}static parse(e,n){let r=new ZN(e,n);if(r.next==null)return ps.empty;let i=NE(r);r.next&&r.err("Unexpected trailing text");let o=sj(oj(i));return aj(o,r),o}matchType(e){for(let n=0;n<this.next.length;n++)if(this.next[n].type==e)return this.next[n].next;return null}matchFragment(e,n=0,r=e.childCount){let i=this;for(let o=n;i&&o<r;o++)i=i.matchType(e.child(o).type);return i}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let e=0;e<this.next.length;e++){let{type:n}=this.next[e];if(!(n.isText||n.hasRequiredAttrs()))return n}return null}compatible(e){for(let n=0;n<this.next.length;n++)for(let r=0;r<e.next.length;r++)if(this.next[n].type==e.next[r].type)return!0;return!1}fillBefore(e,n=!1,r=0){let i=[this];function o(s,a){let l=s.matchFragment(e,r);if(l&&(!n||l.validEnd))return j.from(a.map(c=>c.createAndFill()));for(let c=0;c<s.next.length;c++){let{type:u,next:d}=s.next[c];if(!(u.isText||u.hasRequiredAttrs())&&i.indexOf(d)==-1){i.push(d);let f=o(d,a.concat(u));if(f)return f}}return null}return o(this,[])}findWrapping(e){for(let r=0;r<this.wrapCache.length;r+=2)if(this.wrapCache[r]==e)return this.wrapCache[r+1];let n=this.computeWrapping(e);return this.wrapCache.push(e,n),n}computeWrapping(e){let n=Object.create(null),r=[{match:this,type:null,via:null}];for(;r.length;){let i=r.shift(),o=i.match;if(o.matchType(e)){let s=[];for(let a=i;a.type;a=a.via)s.push(a.type);return s.reverse()}for(let s=0;s<o.next.length;s++){let{type:a,next:l}=o.next[s];!a.isLeaf&&!a.hasRequiredAttrs()&&!(a.name in n)&&(!i.type||l.validEnd)&&(r.push({match:a.contentMatch,type:a,via:i}),n[a.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(e){if(e>=this.next.length)throw new RangeError(`There's no ${e}th edge in this content match`);return this.next[e]}toString(){let e=[];function n(r){e.push(r);for(let i=0;i<r.next.length;i++)e.indexOf(r.next[i].next)==-1&&n(r.next[i].next)}return n(this),e.map((r,i)=>{let o=i+(r.validEnd?"*":" ")+" ";for(let s=0;s<r.next.length;s++)o+=(s?", ":"")+r.next[s].type.name+"->"+e.indexOf(r.next[s].next);return o}).join(`
`)}}ps.empty=new ps(!0);class ZN{constructor(e,n){this.string=e,this.nodeTypes=n,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")}}function NE(t){let e=[];do e.push(ej(t));while(t.eat("|"));return e.length==1?e[0]:{type:"choice",exprs:e}}function ej(t){let e=[];do e.push(tj(t));while(t.next&&t.next!=")"&&t.next!="|");return e.length==1?e[0]:{type:"seq",exprs:e}}function tj(t){let e=ij(t);for(;;)if(t.eat("+"))e={type:"plus",expr:e};else if(t.eat("*"))e={type:"star",expr:e};else if(t.eat("?"))e={type:"opt",expr:e};else if(t.eat("{"))e=nj(t,e);else break;return e}function qw(t){/\D/.test(t.next)&&t.err("Expected number, got '"+t.next+"'");let e=Number(t.next);return t.pos++,e}function nj(t,e){let n=qw(t),r=n;return t.eat(",")&&(t.next!="}"?r=qw(t):r=-1),t.eat("}")||t.err("Unclosed braced range"),{type:"range",min:n,max:r,expr:e}}function rj(t,e){let n=t.nodeTypes,r=n[e];if(r)return[r];let i=[];for(let o in n){let s=n[o];s.isInGroup(e)&&i.push(s)}return i.length==0&&t.err("No node type or group '"+e+"' found"),i}function ij(t){if(t.eat("(")){let e=NE(t);return t.eat(")")||t.err("Missing closing paren"),e}else if(/\W/.test(t.next))t.err("Unexpected token '"+t.next+"'");else{let e=rj(t,t.next).map(n=>(t.inline==null?t.inline=n.isInline:t.inline!=n.isInline&&t.err("Mixing inline and block content"),{type:"name",value:n}));return t.pos++,e.length==1?e[0]:{type:"choice",exprs:e}}}function oj(t){let e=[[]];return i(o(t,0),n()),e;function n(){return e.push([])-1}function r(s,a,l){let c={term:l,to:a};return e[s].push(c),c}function i(s,a){s.forEach(l=>l.to=a)}function o(s,a){if(s.type=="choice")return s.exprs.reduce((l,c)=>l.concat(o(c,a)),[]);if(s.type=="seq")for(let l=0;;l++){let c=o(s.exprs[l],a);if(l==s.exprs.length-1)return c;i(c,a=n())}else if(s.type=="star"){let l=n();return r(a,l),i(o(s.expr,l),l),[r(l)]}else if(s.type=="plus"){let l=n();return i(o(s.expr,a),l),i(o(s.expr,l),l),[r(l)]}else{if(s.type=="opt")return[r(a)].concat(o(s.expr,a));if(s.type=="range"){let l=a;for(let c=0;c<s.min;c++){let u=n();i(o(s.expr,l),u),l=u}if(s.max==-1)i(o(s.expr,l),l);else for(let c=s.min;c<s.max;c++){let u=n();r(l,u),i(o(s.expr,l),u),l=u}return[r(l)]}else{if(s.type=="name")return[r(a,void 0,s.value)];throw new Error("Unknown expr type")}}}}function jE(t,e){return e-t}function Gw(t,e){let n=[];return r(e),n.sort(jE);function r(i){let o=t[i];if(o.length==1&&!o[0].term)return r(o[0].to);n.push(i);for(let s=0;s<o.length;s++){let{term:a,to:l}=o[s];!a&&n.indexOf(l)==-1&&r(l)}}}function sj(t){let e=Object.create(null);return n(Gw(t,0));function n(r){let i=[];r.forEach(s=>{t[s].forEach(({term:a,to:l})=>{if(!a)return;let c;for(let u=0;u<i.length;u++)i[u][0]==a&&(c=i[u][1]);Gw(t,l).forEach(u=>{c||i.push([a,c=[]]),c.indexOf(u)==-1&&c.push(u)})})});let o=e[r.join(",")]=new ps(r.indexOf(t.length-1)>-1);for(let s=0;s<i.length;s++){let a=i[s][1].sort(jE);o.next.push({type:i[s][0],next:e[a.join(",")]||n(a)})}return o}}function aj(t,e){for(let n=0,r=[t];n<r.length;n++){let i=r[n],o=!i.validEnd,s=[];for(let a=0;a<i.next.length;a++){let{type:l,next:c}=i.next[a];s.push(l.name),o&&!(l.isText||l.hasRequiredAttrs())&&(o=!1),r.indexOf(c)==-1&&r.push(c)}o&&e.err("Only non-generatable nodes ("+s.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function LE(t){let e=Object.create(null);for(let n in t){let r=t[n];if(!r.hasDefault)return null;e[n]=r.default}return e}function $E(t,e){let n=Object.create(null);for(let r in t){let i=e&&e[r];if(i===void 0){let o=t[r];if(o.hasDefault)i=o.default;else throw new RangeError("No value supplied for attribute "+r)}n[r]=i}return n}function FE(t,e,n,r){for(let i in e)if(!(i in t))throw new RangeError(`Unsupported attribute ${i} for ${n} of type ${i}`);for(let i in t){let o=t[i];o.validate&&o.validate(e[i])}}function BE(t,e){let n=Object.create(null);if(e)for(let r in e)n[r]=new cj(t,r,e[r]);return n}let Jw=class zE{constructor(e,n,r){this.name=e,this.schema=n,this.spec=r,this.markSet=null,this.groups=r.group?r.group.split(" "):[],this.attrs=BE(e,r.attrs),this.defaultAttrs=LE(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(r.inline||e=="text"),this.isText=e=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==ps.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(e){return this.groups.indexOf(e)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}compatibleContent(e){return this==e||this.contentMatch.compatible(e.contentMatch)}computeAttrs(e){return!e&&this.defaultAttrs?this.defaultAttrs:$E(this.attrs,e)}create(e=null,n,r){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new qi(this,this.computeAttrs(e),j.from(n),Se.setFrom(r))}createChecked(e=null,n,r){return n=j.from(n),this.checkContent(n),new qi(this,this.computeAttrs(e),n,Se.setFrom(r))}createAndFill(e=null,n,r){if(e=this.computeAttrs(e),n=j.from(n),n.size){let s=this.contentMatch.fillBefore(n);if(!s)return null;n=s.append(n)}let i=this.contentMatch.matchFragment(n),o=i&&i.fillBefore(j.empty,!0);return o?new qi(this,e,n.append(o),Se.setFrom(r)):null}validContent(e){let n=this.contentMatch.matchFragment(e);if(!n||!n.validEnd)return!1;for(let r=0;r<e.childCount;r++)if(!this.allowsMarks(e.child(r).marks))return!1;return!0}checkContent(e){if(!this.validContent(e))throw new RangeError(`Invalid content for node ${this.name}: ${e.toString().slice(0,50)}`)}checkAttrs(e){FE(this.attrs,e,"node",this.name)}allowsMarkType(e){return this.markSet==null||this.markSet.indexOf(e)>-1}allowsMarks(e){if(this.markSet==null)return!0;for(let n=0;n<e.length;n++)if(!this.allowsMarkType(e[n].type))return!1;return!0}allowedMarks(e){if(this.markSet==null)return e;let n;for(let r=0;r<e.length;r++)this.allowsMarkType(e[r].type)?n&&n.push(e[r]):n||(n=e.slice(0,r));return n?n.length?n:Se.none:e}static compile(e,n){let r=Object.create(null);e.forEach((o,s)=>r[o]=new zE(o,n,s));let i=n.spec.topNode||"doc";if(!r[i])throw new RangeError("Schema is missing its top node type ('"+i+"')");if(!r.text)throw new RangeError("Every schema needs a 'text' type");for(let o in r.text.attrs)throw new RangeError("The text node type should not have attributes");return r}};function lj(t,e,n){let r=n.split("|");return i=>{let o=i===null?"null":typeof i;if(r.indexOf(o)<0)throw new RangeError(`Expected value of type ${r} for attribute ${e} on type ${t}, got ${o}`)}}class cj{constructor(e,n,r){this.hasDefault=Object.prototype.hasOwnProperty.call(r,"default"),this.default=r.default,this.validate=typeof r.validate=="string"?lj(e,n,r.validate):r.validate}get isRequired(){return!this.hasDefault}}class kh{constructor(e,n,r,i){this.name=e,this.rank=n,this.schema=r,this.spec=i,this.attrs=BE(e,i.attrs),this.excluded=null;let o=LE(this.attrs);this.instance=o?new Se(this,o):null}create(e=null){return!e&&this.instance?this.instance:new Se(this,$E(this.attrs,e))}static compile(e,n){let r=Object.create(null),i=0;return e.forEach((o,s)=>r[o]=new kh(o,i++,n,s)),r}removeFromSet(e){for(var n=0;n<e.length;n++)e[n].type==this&&(e=e.slice(0,n).concat(e.slice(n+1)),n--);return e}isInSet(e){for(let n=0;n<e.length;n++)if(e[n].type==this)return e[n]}checkAttrs(e){FE(this.attrs,e,"mark",this.name)}excludes(e){return this.excluded.indexOf(e)>-1}}class UE{constructor(e){this.linebreakReplacement=null,this.cached=Object.create(null);let n=this.spec={};for(let i in e)n[i]=e[i];n.nodes=lt.from(e.nodes),n.marks=lt.from(e.marks||{}),this.nodes=Jw.compile(this.spec.nodes,this),this.marks=kh.compile(this.spec.marks,this);let r=Object.create(null);for(let i in this.nodes){if(i in this.marks)throw new RangeError(i+" can not be both a node and a mark");let o=this.nodes[i],s=o.spec.content||"",a=o.spec.marks;if(o.contentMatch=r[s]||(r[s]=ps.parse(s,this.nodes)),o.inlineContent=o.contentMatch.inlineContent,o.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!o.isInline||!o.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=o}o.markSet=a=="_"?null:a?Yw(this,a.split(" ")):a==""||!o.inlineContent?[]:null}for(let i in this.marks){let o=this.marks[i],s=o.spec.excludes;o.excluded=s==null?[o]:s==""?[]:Yw(this,s.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(e,n=null,r,i){if(typeof e=="string")e=this.nodeType(e);else if(e instanceof Jw){if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}else throw new RangeError("Invalid node type: "+e);return e.createChecked(n,r,i)}text(e,n){let r=this.nodes.text;return new _f(r,r.defaultAttrs,e,Se.setFrom(n))}mark(e,n){return typeof e=="string"&&(e=this.marks[e]),e.create(n)}nodeFromJSON(e){return qi.fromJSON(this,e)}markFromJSON(e){return Se.fromJSON(this,e)}nodeType(e){let n=this.nodes[e];if(!n)throw new RangeError("Unknown node type: "+e);return n}}function Yw(t,e){let n=[];for(let r=0;r<e.length;r++){let i=e[r],o=t.marks[i],s=o;if(o)n.push(o);else for(let a in t.marks){let l=t.marks[a];(i=="_"||l.spec.group&&l.spec.group.split(" ").indexOf(i)>-1)&&n.push(s=l)}if(!s)throw new SyntaxError("Unknown mark type: '"+e[r]+"'")}return n}function uj(t){return t.tag!=null}function dj(t){return t.style!=null}class Gi{constructor(e,n){this.schema=e,this.rules=n,this.tags=[],this.styles=[];let r=this.matchedStyles=[];n.forEach(i=>{if(uj(i))this.tags.push(i);else if(dj(i)){let o=/[^=]*/.exec(i.style)[0];r.indexOf(o)<0&&r.push(o),this.styles.push(i)}}),this.normalizeLists=!this.tags.some(i=>{if(!/^(ul|ol)\b/.test(i.tag)||!i.node)return!1;let o=e.nodes[i.node];return o.contentMatch.matchType(o)})}parse(e,n={}){let r=new Xw(this,n,!1);return r.addAll(e,Se.none,n.from,n.to),r.finish()}parseSlice(e,n={}){let r=new Xw(this,n,!0);return r.addAll(e,Se.none,n.from,n.to),V.maxOpen(r.finish())}matchTag(e,n,r){for(let i=r?this.tags.indexOf(r)+1:0;i<this.tags.length;i++){let o=this.tags[i];if(pj(e,o.tag)&&(o.namespace===void 0||e.namespaceURI==o.namespace)&&(!o.context||n.matchesContext(o.context))){if(o.getAttrs){let s=o.getAttrs(e);if(s===!1)continue;o.attrs=s||void 0}return o}}}matchStyle(e,n,r,i){for(let o=i?this.styles.indexOf(i)+1:0;o<this.styles.length;o++){let s=this.styles[o],a=s.style;if(!(a.indexOf(e)!=0||s.context&&!r.matchesContext(s.context)||a.length>e.length&&(a.charCodeAt(e.length)!=61||a.slice(e.length+1)!=n))){if(s.getAttrs){let l=s.getAttrs(n);if(l===!1)continue;s.attrs=l||void 0}return s}}}static schemaRules(e){let n=[];function r(i){let o=i.priority==null?50:i.priority,s=0;for(;s<n.length;s++){let a=n[s];if((a.priority==null?50:a.priority)<o)break}n.splice(s,0,i)}for(let i in e.marks){let o=e.marks[i].spec.parseDOM;o&&o.forEach(s=>{r(s=Zw(s)),s.mark||s.ignore||s.clearMark||(s.mark=i)})}for(let i in e.nodes){let o=e.nodes[i].spec.parseDOM;o&&o.forEach(s=>{r(s=Zw(s)),s.node||s.ignore||s.mark||(s.node=i)})}return n}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new Gi(e,Gi.schemaRules(e)))}}const VE={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},fj={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},HE={ol:!0,ul:!0},Mc=1,Yg=2,nc=4;function Qw(t,e,n){return e!=null?(e?Mc:0)|(e==="full"?Yg:0):t&&t.whitespace=="pre"?Mc|Yg:n&~nc}class sd{constructor(e,n,r,i,o,s){this.type=e,this.attrs=n,this.marks=r,this.solid=i,this.options=s,this.content=[],this.activeMarks=Se.none,this.match=o||(s&nc?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let n=this.type.contentMatch.fillBefore(j.from(e));if(n)this.match=this.type.contentMatch.matchFragment(n);else{let r=this.type.contentMatch,i;return(i=r.findWrapping(e.type))?(this.match=r,i):null}}return this.match.findWrapping(e.type)}finish(e){if(!(this.options&Mc)){let r=this.content[this.content.length-1],i;if(r&&r.isText&&(i=/[ \t\r\n\u000c]+$/.exec(r.text))){let o=r;r.text.length==i[0].length?this.content.pop():this.content[this.content.length-1]=o.withText(o.text.slice(0,o.text.length-i[0].length))}}let n=j.from(this.content);return!e&&this.match&&(n=n.append(this.match.fillBefore(j.empty,!0))),this.type?this.type.create(this.attrs,n,this.marks):n}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!VE.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}class Xw{constructor(e,n,r){this.parser=e,this.options=n,this.isOpen=r,this.open=0,this.localPreserveWS=!1;let i=n.topNode,o,s=Qw(null,n.preserveWhitespace,0)|(r?nc:0);i?o=new sd(i.type,i.attrs,Se.none,!0,n.topMatch||i.type.contentMatch,s):r?o=new sd(null,null,Se.none,!0,null,s):o=new sd(e.schema.topNodeType,null,Se.none,!0,null,s),this.nodes=[o],this.find=n.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e,n){e.nodeType==3?this.addTextNode(e,n):e.nodeType==1&&this.addElement(e,n)}addTextNode(e,n){let r=e.nodeValue,i=this.top,o=i.options&Yg?"full":this.localPreserveWS||(i.options&Mc)>0;if(o==="full"||i.inlineContext(e)||/[^ \t\r\n\u000c]/.test(r)){if(o)o!=="full"?r=r.replace(/\r?\n|\r/g," "):r=r.replace(/\r\n?/g,`
`);else if(r=r.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(r)&&this.open==this.nodes.length-1){let s=i.content[i.content.length-1],a=e.previousSibling;(!s||a&&a.nodeName=="BR"||s.isText&&/[ \t\r\n\u000c]$/.test(s.text))&&(r=r.slice(1))}r&&this.insertNode(this.parser.schema.text(r),n),this.findInText(e)}else this.findInside(e)}addElement(e,n,r){let i=this.localPreserveWS,o=this.top;(e.tagName=="PRE"||/pre/.test(e.style&&e.style.whiteSpace))&&(this.localPreserveWS=!0);let s=e.nodeName.toLowerCase(),a;HE.hasOwnProperty(s)&&this.parser.normalizeLists&&hj(e);let l=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(a=this.parser.matchTag(e,this,r));e:if(l?l.ignore:fj.hasOwnProperty(s))this.findInside(e),this.ignoreFallback(e,n);else if(!l||l.skip||l.closeParent){l&&l.closeParent?this.open=Math.max(0,this.open-1):l&&l.skip.nodeType&&(e=l.skip);let c,u=this.needsBlock;if(VE.hasOwnProperty(s))o.content.length&&o.content[0].isInline&&this.open&&(this.open--,o=this.top),c=!0,o.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e,n);break e}let d=l&&l.skip?n:this.readStyles(e,n);d&&this.addAll(e,d),c&&this.sync(o),this.needsBlock=u}else{let c=this.readStyles(e,n);c&&this.addElementByRule(e,l,c,l.consuming===!1?a:void 0)}this.localPreserveWS=i}leafFallback(e,n){e.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode(`
`),n)}ignoreFallback(e,n){e.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"),n)}readStyles(e,n){let r=e.style;if(r&&r.length)for(let i=0;i<this.parser.matchedStyles.length;i++){let o=this.parser.matchedStyles[i],s=r.getPropertyValue(o);if(s)for(let a=void 0;;){let l=this.parser.matchStyle(o,s,this,a);if(!l)break;if(l.ignore)return null;if(l.clearMark?n=n.filter(c=>!l.clearMark(c)):n=n.concat(this.parser.schema.marks[l.mark].create(l.attrs)),l.consuming===!1)a=l;else break}}return n}addElementByRule(e,n,r,i){let o,s;if(n.node)if(s=this.parser.schema.nodes[n.node],s.isLeaf)this.insertNode(s.create(n.attrs),r)||this.leafFallback(e,r);else{let l=this.enter(s,n.attrs||null,r,n.preserveWhitespace);l&&(o=!0,r=l)}else{let l=this.parser.schema.marks[n.mark];r=r.concat(l.create(n.attrs))}let a=this.top;if(s&&s.isLeaf)this.findInside(e);else if(i)this.addElement(e,r,i);else if(n.getContent)this.findInside(e),n.getContent(e,this.parser.schema).forEach(l=>this.insertNode(l,r));else{let l=e;typeof n.contentElement=="string"?l=e.querySelector(n.contentElement):typeof n.contentElement=="function"?l=n.contentElement(e):n.contentElement&&(l=n.contentElement),this.findAround(e,l,!0),this.addAll(l,r),this.findAround(e,l,!1)}o&&this.sync(a)&&this.open--}addAll(e,n,r,i){let o=r||0;for(let s=r?e.childNodes[r]:e.firstChild,a=i==null?null:e.childNodes[i];s!=a;s=s.nextSibling,++o)this.findAtPoint(e,o),this.addDOM(s,n);this.findAtPoint(e,o)}findPlace(e,n){let r,i;for(let o=this.open;o>=0;o--){let s=this.nodes[o],a=s.findWrapping(e);if(a&&(!r||r.length>a.length)&&(r=a,i=s,!a.length)||s.solid)break}if(!r)return null;this.sync(i);for(let o=0;o<r.length;o++)n=this.enterInner(r[o],null,n,!1);return n}insertNode(e,n){if(e.isInline&&this.needsBlock&&!this.top.type){let i=this.textblockFromContext();i&&(n=this.enterInner(i,null,n))}let r=this.findPlace(e,n);if(r){this.closeExtra();let i=this.top;i.match&&(i.match=i.match.matchType(e.type));let o=Se.none;for(let s of r.concat(e.marks))(i.type?i.type.allowsMarkType(s.type):eb(s.type,e.type))&&(o=s.addToSet(o));return i.content.push(e.mark(o)),!0}return!1}enter(e,n,r,i){let o=this.findPlace(e.create(n),r);return o&&(o=this.enterInner(e,n,r,!0,i)),o}enterInner(e,n,r,i=!1,o){this.closeExtra();let s=this.top;s.match=s.match&&s.match.matchType(e);let a=Qw(e,o,s.options);s.options&nc&&s.content.length==0&&(a|=nc);let l=Se.none;return r=r.filter(c=>(s.type?s.type.allowsMarkType(c.type):eb(c.type,e))?(l=c.addToSet(l),!1):!0),this.nodes.push(new sd(e,n,l,i,null,a)),this.open++,r}closeExtra(e=!1){let n=this.nodes.length-1;if(n>this.open){for(;n>this.open;n--)this.nodes[n-1].content.push(this.nodes[n].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!!(this.isOpen||this.options.topOpen))}sync(e){for(let n=this.open;n>=0;n--){if(this.nodes[n]==e)return this.open=n,!0;this.localPreserveWS&&(this.nodes[n].options|=Mc)}return!1}get currentPos(){this.closeExtra();let e=0;for(let n=this.open;n>=0;n--){let r=this.nodes[n].content;for(let i=r.length-1;i>=0;i--)e+=r[i].nodeSize;n&&e++}return e}findAtPoint(e,n){if(this.find)for(let r=0;r<this.find.length;r++)this.find[r].node==e&&this.find[r].offset==n&&(this.find[r].pos=this.currentPos)}findInside(e){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].pos==null&&e.nodeType==1&&e.contains(this.find[n].node)&&(this.find[n].pos=this.currentPos)}findAround(e,n,r){if(e!=n&&this.find)for(let i=0;i<this.find.length;i++)this.find[i].pos==null&&e.nodeType==1&&e.contains(this.find[i].node)&&n.compareDocumentPosition(this.find[i].node)&(r?2:4)&&(this.find[i].pos=this.currentPos)}findInText(e){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].node==e&&(this.find[n].pos=this.currentPos-(e.nodeValue.length-this.find[n].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let n=e.split("/"),r=this.options.context,i=!this.isOpen&&(!r||r.parent.type==this.nodes[0].type),o=-(r?r.depth+1:0)+(i?0:1),s=(a,l)=>{for(;a>=0;a--){let c=n[a];if(c==""){if(a==n.length-1||a==0)continue;for(;l>=o;l--)if(s(a-1,l))return!0;return!1}else{let u=l>0||l==0&&i?this.nodes[l].type:r&&l>=o?r.node(l-o).type:null;if(!u||u.name!=c&&!u.isInGroup(c))return!1;l--}}return!0};return s(n.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let n=e.depth;n>=0;n--){let r=e.node(n).contentMatchAt(e.indexAfter(n)).defaultType;if(r&&r.isTextblock&&r.defaultAttrs)return r}for(let n in this.parser.schema.nodes){let r=this.parser.schema.nodes[n];if(r.isTextblock&&r.defaultAttrs)return r}}}function hj(t){for(let e=t.firstChild,n=null;e;e=e.nextSibling){let r=e.nodeType==1?e.nodeName.toLowerCase():null;r&&HE.hasOwnProperty(r)&&n?(n.appendChild(e),e=n):r=="li"?n=e:r&&(n=null)}}function pj(t,e){return(t.matches||t.msMatchesSelector||t.webkitMatchesSelector||t.mozMatchesSelector).call(t,e)}function Zw(t){let e={};for(let n in t)e[n]=t[n];return e}function eb(t,e){let n=e.schema.nodes;for(let r in n){let i=n[r];if(!i.allowsMarkType(t))continue;let o=[],s=a=>{o.push(a);for(let l=0;l<a.edgeCount;l++){let{type:c,next:u}=a.edge(l);if(c==e||o.indexOf(u)<0&&s(u))return!0}};if(s(i.contentMatch))return!0}}class Es{constructor(e,n){this.nodes=e,this.marks=n}serializeFragment(e,n={},r){r||(r=Bp(n).createDocumentFragment());let i=r,o=[];return e.forEach(s=>{if(o.length||s.marks.length){let a=0,l=0;for(;a<o.length&&l<s.marks.length;){let c=s.marks[l];if(!this.marks[c.type.name]){l++;continue}if(!c.eq(o[a][0])||c.type.spec.spanning===!1)break;a++,l++}for(;a<o.length;)i=o.pop()[1];for(;l<s.marks.length;){let c=s.marks[l++],u=this.serializeMark(c,s.isInline,n);u&&(o.push([c,i]),i.appendChild(u.dom),i=u.contentDOM||u.dom)}}i.appendChild(this.serializeNodeInner(s,n))}),r}serializeNodeInner(e,n){let{dom:r,contentDOM:i}=Fd(Bp(n),this.nodes[e.type.name](e),null,e.attrs);if(i){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(e.content,n,i)}return r}serializeNode(e,n={}){let r=this.serializeNodeInner(e,n);for(let i=e.marks.length-1;i>=0;i--){let o=this.serializeMark(e.marks[i],e.isInline,n);o&&((o.contentDOM||o.dom).appendChild(r),r=o.dom)}return r}serializeMark(e,n,r={}){let i=this.marks[e.type.name];return i&&Fd(Bp(r),i(e,n),null,e.attrs)}static renderSpec(e,n,r=null,i){return Fd(e,n,r,i)}static fromSchema(e){return e.cached.domSerializer||(e.cached.domSerializer=new Es(this.nodesFromSchema(e),this.marksFromSchema(e)))}static nodesFromSchema(e){let n=tb(e.nodes);return n.text||(n.text=r=>r.text),n}static marksFromSchema(e){return tb(e.marks)}}function tb(t){let e={};for(let n in t){let r=t[n].spec.toDOM;r&&(e[n]=r)}return e}function Bp(t){return t.document||window.document}const nb=new WeakMap;function mj(t){let e=nb.get(t);return e===void 0&&nb.set(t,e=gj(t)),e}function gj(t){let e=null;function n(r){if(r&&typeof r=="object")if(Array.isArray(r))if(typeof r[0]=="string")e||(e=[]),e.push(r);else for(let i=0;i<r.length;i++)n(r[i]);else for(let i in r)n(r[i])}return n(t),e}function Fd(t,e,n,r){if(typeof e=="string")return{dom:t.createTextNode(e)};if(e.nodeType!=null)return{dom:e};if(e.dom&&e.dom.nodeType!=null)return e;let i=e[0],o;if(typeof i!="string")throw new RangeError("Invalid array passed to renderSpec");if(r&&(o=mj(r))&&o.indexOf(e)>-1)throw new RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let s=i.indexOf(" ");s>0&&(n=i.slice(0,s),i=i.slice(s+1));let a,l=n?t.createElementNS(n,i):t.createElement(i),c=e[1],u=1;if(c&&typeof c=="object"&&c.nodeType==null&&!Array.isArray(c)){u=2;for(let d in c)if(c[d]!=null){let f=d.indexOf(" ");f>0?l.setAttributeNS(d.slice(0,f),d.slice(f+1),c[d]):l.setAttribute(d,c[d])}}for(let d=u;d<e.length;d++){let f=e[d];if(f===0){if(d<e.length-1||d>u)throw new RangeError("Content hole must be the only child of its parent node");return{dom:l,contentDOM:l}}else{let{dom:p,contentDOM:m}=Fd(t,f,n,r);if(l.appendChild(p),m){if(a)throw new RangeError("Multiple content holes");a=m}}}return{dom:l,contentDOM:a}}const WE=65535,KE=Math.pow(2,16);function yj(t,e){return t+e*KE}function rb(t){return t&WE}function vj(t){return(t-(t&WE))/KE}const qE=1,GE=2,Bd=4,JE=8;class Qg{constructor(e,n,r){this.pos=e,this.delInfo=n,this.recover=r}get deleted(){return(this.delInfo&JE)>0}get deletedBefore(){return(this.delInfo&(qE|Bd))>0}get deletedAfter(){return(this.delInfo&(GE|Bd))>0}get deletedAcross(){return(this.delInfo&Bd)>0}}class fn{constructor(e,n=!1){if(this.ranges=e,this.inverted=n,!e.length&&fn.empty)return fn.empty}recover(e){let n=0,r=rb(e);if(!this.inverted)for(let i=0;i<r;i++)n+=this.ranges[i*3+2]-this.ranges[i*3+1];return this.ranges[r*3]+n+vj(e)}mapResult(e,n=1){return this._map(e,n,!1)}map(e,n=1){return this._map(e,n,!0)}_map(e,n,r){let i=0,o=this.inverted?2:1,s=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let l=this.ranges[a]-(this.inverted?i:0);if(l>e)break;let c=this.ranges[a+o],u=this.ranges[a+s],d=l+c;if(e<=d){let f=c?e==l?-1:e==d?1:n:n,p=l+i+(f<0?0:u);if(r)return p;let m=e==(n<0?l:d)?null:yj(a/3,e-l),g=e==l?GE:e==d?qE:Bd;return(n<0?e!=l:e!=d)&&(g|=JE),new Qg(p,g,m)}i+=u-c}return r?e+i:new Qg(e+i,0,null)}touches(e,n){let r=0,i=rb(n),o=this.inverted?2:1,s=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let l=this.ranges[a]-(this.inverted?r:0);if(l>e)break;let c=this.ranges[a+o],u=l+c;if(e<=u&&a==i*3)return!0;r+=this.ranges[a+s]-c}return!1}forEach(e){let n=this.inverted?2:1,r=this.inverted?1:2;for(let i=0,o=0;i<this.ranges.length;i+=3){let s=this.ranges[i],a=s-(this.inverted?o:0),l=s+(this.inverted?0:o),c=this.ranges[i+n],u=this.ranges[i+r];e(a,a+c,l,l+u),o+=u-c}}invert(){return new fn(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?fn.empty:new fn(e<0?[0,-e,0]:[0,0,e])}}fn.empty=new fn([]);class Ac{constructor(e,n,r=0,i=e?e.length:0){this.mirror=n,this.from=r,this.to=i,this._maps=e||[],this.ownData=!(e||n)}get maps(){return this._maps}slice(e=0,n=this.maps.length){return new Ac(this._maps,this.mirror,e,n)}appendMap(e,n){this.ownData||(this._maps=this._maps.slice(),this.mirror=this.mirror&&this.mirror.slice(),this.ownData=!0),this.to=this._maps.push(e),n!=null&&this.setMirror(this._maps.length-1,n)}appendMapping(e){for(let n=0,r=this._maps.length;n<e._maps.length;n++){let i=e.getMirror(n);this.appendMap(e._maps[n],i!=null&&i<n?r+i:void 0)}}getMirror(e){if(this.mirror){for(let n=0;n<this.mirror.length;n++)if(this.mirror[n]==e)return this.mirror[n+(n%2?-1:1)]}}setMirror(e,n){this.mirror||(this.mirror=[]),this.mirror.push(e,n)}appendMappingInverted(e){for(let n=e.maps.length-1,r=this._maps.length+e._maps.length;n>=0;n--){let i=e.getMirror(n);this.appendMap(e._maps[n].invert(),i!=null&&i>n?r-i-1:void 0)}}invert(){let e=new Ac;return e.appendMappingInverted(this),e}map(e,n=1){if(this.mirror)return this._map(e,n,!0);for(let r=this.from;r<this.to;r++)e=this._maps[r].map(e,n);return e}mapResult(e,n=1){return this._map(e,n,!1)}_map(e,n,r){let i=0;for(let o=this.from;o<this.to;o++){let s=this._maps[o],a=s.mapResult(e,n);if(a.recover!=null){let l=this.getMirror(o);if(l!=null&&l>o&&l<this.to){o=l,e=this._maps[l].recover(a.recover);continue}}i|=a.delInfo,e=a.pos}return r?e:new Qg(e,i,null)}}const zp=Object.create(null);class Ct{getMap(){return fn.empty}merge(e){return null}static fromJSON(e,n){if(!n||!n.stepType)throw new RangeError("Invalid input for Step.fromJSON");let r=zp[n.stepType];if(!r)throw new RangeError(`No step type ${n.stepType} defined`);return r.fromJSON(e,n)}static jsonID(e,n){if(e in zp)throw new RangeError("Duplicate use of step JSON ID "+e);return zp[e]=n,n.prototype.jsonID=e,n}}class Ke{constructor(e,n){this.doc=e,this.failed=n}static ok(e){return new Ke(e,null)}static fail(e){return new Ke(null,e)}static fromReplace(e,n,r,i){try{return Ke.ok(e.replace(n,r,i))}catch(o){if(o instanceof kf)return Ke.fail(o.message);throw o}}}function Yv(t,e,n){let r=[];for(let i=0;i<t.childCount;i++){let o=t.child(i);o.content.size&&(o=o.copy(Yv(o.content,e,o))),o.isInline&&(o=e(o,n,i)),r.push(o)}return j.fromArray(r)}class Ni extends Ct{constructor(e,n,r){super(),this.from=e,this.to=n,this.mark=r}apply(e){let n=e.slice(this.from,this.to),r=e.resolve(this.from),i=r.node(r.sharedDepth(this.to)),o=new V(Yv(n.content,(s,a)=>!s.isAtom||!a.type.allowsMarkType(this.mark.type)?s:s.mark(this.mark.addToSet(s.marks)),i),n.openStart,n.openEnd);return Ke.fromReplace(e,this.from,this.to,o)}invert(){return new br(this.from,this.to,this.mark)}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deleted&&r.deleted||n.pos>=r.pos?null:new Ni(n.pos,r.pos,this.mark)}merge(e){return e instanceof Ni&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Ni(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new Ni(n.from,n.to,e.markFromJSON(n.mark))}}Ct.jsonID("addMark",Ni);class br extends Ct{constructor(e,n,r){super(),this.from=e,this.to=n,this.mark=r}apply(e){let n=e.slice(this.from,this.to),r=new V(Yv(n.content,i=>i.mark(this.mark.removeFromSet(i.marks)),e),n.openStart,n.openEnd);return Ke.fromReplace(e,this.from,this.to,r)}invert(){return new Ni(this.from,this.to,this.mark)}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deleted&&r.deleted||n.pos>=r.pos?null:new br(n.pos,r.pos,this.mark)}merge(e){return e instanceof br&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new br(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new br(n.from,n.to,e.markFromJSON(n.mark))}}Ct.jsonID("removeMark",br);class ji extends Ct{constructor(e,n){super(),this.pos=e,this.mark=n}apply(e){let n=e.nodeAt(this.pos);if(!n)return Ke.fail("No node at mark step's position");let r=n.type.create(n.attrs,null,this.mark.addToSet(n.marks));return Ke.fromReplace(e,this.pos,this.pos+1,new V(j.from(r),0,n.isLeaf?0:1))}invert(e){let n=e.nodeAt(this.pos);if(n){let r=this.mark.addToSet(n.marks);if(r.length==n.marks.length){for(let i=0;i<n.marks.length;i++)if(!n.marks[i].isInSet(r))return new ji(this.pos,n.marks[i]);return new ji(this.pos,this.mark)}}return new Va(this.pos,this.mark)}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new ji(n.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new ji(n.pos,e.markFromJSON(n.mark))}}Ct.jsonID("addNodeMark",ji);class Va extends Ct{constructor(e,n){super(),this.pos=e,this.mark=n}apply(e){let n=e.nodeAt(this.pos);if(!n)return Ke.fail("No node at mark step's position");let r=n.type.create(n.attrs,null,this.mark.removeFromSet(n.marks));return Ke.fromReplace(e,this.pos,this.pos+1,new V(j.from(r),0,n.isLeaf?0:1))}invert(e){let n=e.nodeAt(this.pos);return!n||!this.mark.isInSet(n.marks)?this:new ji(this.pos,this.mark)}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new Va(n.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new Va(n.pos,e.markFromJSON(n.mark))}}Ct.jsonID("removeNodeMark",Va);class et extends Ct{constructor(e,n,r,i=!1){super(),this.from=e,this.to=n,this.slice=r,this.structure=i}apply(e){return this.structure&&Xg(e,this.from,this.to)?Ke.fail("Structure replace would overwrite content"):Ke.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new fn([this.from,this.to-this.from,this.slice.size])}invert(e){return new et(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deletedAcross&&r.deletedAcross?null:new et(n.pos,Math.max(n.pos,r.pos),this.slice)}merge(e){if(!(e instanceof et)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let n=this.slice.size+e.slice.size==0?V.empty:new V(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new et(this.from,this.to+(e.to-e.from),n,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let n=this.slice.size+e.slice.size==0?V.empty:new V(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new et(e.from,this.to,n,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new et(n.from,n.to,V.fromJSON(e,n.slice),!!n.structure)}}Ct.jsonID("replace",et);class nt extends Ct{constructor(e,n,r,i,o,s,a=!1){super(),this.from=e,this.to=n,this.gapFrom=r,this.gapTo=i,this.slice=o,this.insert=s,this.structure=a}apply(e){if(this.structure&&(Xg(e,this.from,this.gapFrom)||Xg(e,this.gapTo,this.to)))return Ke.fail("Structure gap-replace would overwrite content");let n=e.slice(this.gapFrom,this.gapTo);if(n.openStart||n.openEnd)return Ke.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,n.content);return r?Ke.fromReplace(e,this.from,this.to,r):Ke.fail("Content does not fit in gap")}getMap(){return new fn([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let n=this.gapTo-this.gapFrom;return new nt(this.from,this.from+this.slice.size+n,this.from+this.insert,this.from+this.insert+n,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1),i=this.from==this.gapFrom?n.pos:e.map(this.gapFrom,-1),o=this.to==this.gapTo?r.pos:e.map(this.gapTo,1);return n.deletedAcross&&r.deletedAcross||i<n.pos||o>r.pos?null:new nt(n.pos,r.pos,i,o,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number"||typeof n.gapFrom!="number"||typeof n.gapTo!="number"||typeof n.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new nt(n.from,n.to,n.gapFrom,n.gapTo,V.fromJSON(e,n.slice),n.insert,!!n.structure)}}Ct.jsonID("replaceAround",nt);function Xg(t,e,n){let r=t.resolve(e),i=n-e,o=r.depth;for(;i>0&&o>0&&r.indexAfter(o)==r.node(o).childCount;)o--,i--;if(i>0){let s=r.node(o).maybeChild(r.indexAfter(o));for(;i>0;){if(!s||s.isLeaf)return!0;s=s.firstChild,i--}}return!1}function xj(t,e,n,r){let i=[],o=[],s,a;t.doc.nodesBetween(e,n,(l,c,u)=>{if(!l.isInline)return;let d=l.marks;if(!r.isInSet(d)&&u.type.allowsMarkType(r.type)){let f=Math.max(c,e),p=Math.min(c+l.nodeSize,n),m=r.addToSet(d);for(let g=0;g<d.length;g++)d[g].isInSet(m)||(s&&s.to==f&&s.mark.eq(d[g])?s.to=p:i.push(s=new br(f,p,d[g])));a&&a.to==f?a.to=p:o.push(a=new Ni(f,p,r))}}),i.forEach(l=>t.step(l)),o.forEach(l=>t.step(l))}function wj(t,e,n,r){let i=[],o=0;t.doc.nodesBetween(e,n,(s,a)=>{if(!s.isInline)return;o++;let l=null;if(r instanceof kh){let c=s.marks,u;for(;u=r.isInSet(c);)(l||(l=[])).push(u),c=u.removeFromSet(c)}else r?r.isInSet(s.marks)&&(l=[r]):l=s.marks;if(l&&l.length){let c=Math.min(a+s.nodeSize,n);for(let u=0;u<l.length;u++){let d=l[u],f;for(let p=0;p<i.length;p++){let m=i[p];m.step==o-1&&d.eq(i[p].style)&&(f=m)}f?(f.to=c,f.step=o):i.push({style:d,from:Math.max(a,e),to:c,step:o})}}}),i.forEach(s=>t.step(new br(s.from,s.to,s.style)))}function Qv(t,e,n,r=n.contentMatch,i=!0){let o=t.doc.nodeAt(e),s=[],a=e+1;for(let l=0;l<o.childCount;l++){let c=o.child(l),u=a+c.nodeSize,d=r.matchType(c.type);if(!d)s.push(new et(a,u,V.empty));else{r=d;for(let f=0;f<c.marks.length;f++)n.allowsMarkType(c.marks[f].type)||t.step(new br(a,u,c.marks[f]));if(i&&c.isText&&n.whitespace!="pre"){let f,p=/\r?\n|\r/g,m;for(;f=p.exec(c.text);)m||(m=new V(j.from(n.schema.text(" ",n.allowedMarks(c.marks))),0,0)),s.push(new et(a+f.index,a+f.index+f[0].length,m))}}a=u}if(!r.validEnd){let l=r.fillBefore(j.empty,!0);t.replace(a,a,new V(l,0,0))}for(let l=s.length-1;l>=0;l--)t.step(s[l])}function bj(t,e,n){return(e==0||t.canReplace(e,t.childCount))&&(n==t.childCount||t.canReplace(0,n))}function ml(t){let n=t.parent.content.cutByIndex(t.startIndex,t.endIndex);for(let r=t.depth;;--r){let i=t.$from.node(r),o=t.$from.index(r),s=t.$to.indexAfter(r);if(r<t.depth&&i.canReplace(o,s,n))return r;if(r==0||i.type.spec.isolating||!bj(i,o,s))break}return null}function Sj(t,e,n){let{$from:r,$to:i,depth:o}=e,s=r.before(o+1),a=i.after(o+1),l=s,c=a,u=j.empty,d=0;for(let m=o,g=!1;m>n;m--)g||r.index(m)>0?(g=!0,u=j.from(r.node(m).copy(u)),d++):l--;let f=j.empty,p=0;for(let m=o,g=!1;m>n;m--)g||i.after(m+1)<i.end(m)?(g=!0,f=j.from(i.node(m).copy(f)),p++):c++;t.step(new nt(l,c,s,a,new V(u.append(f),d,p),u.size-d,!0))}function Xv(t,e,n=null,r=t){let i=Cj(t,e),o=i&&kj(r,e);return o?i.map(ib).concat({type:e,attrs:n}).concat(o.map(ib)):null}function ib(t){return{type:t,attrs:null}}function Cj(t,e){let{parent:n,startIndex:r,endIndex:i}=t,o=n.contentMatchAt(r).findWrapping(e);if(!o)return null;let s=o.length?o[0]:e;return n.canReplaceWith(r,i,s)?o:null}function kj(t,e){let{parent:n,startIndex:r,endIndex:i}=t,o=n.child(r),s=e.contentMatch.findWrapping(o.type);if(!s)return null;let l=(s.length?s[s.length-1]:e).contentMatch;for(let c=r;l&&c<i;c++)l=l.matchType(n.child(c).type);return!l||!l.validEnd?null:s}function Ej(t,e,n){let r=j.empty;for(let s=n.length-1;s>=0;s--){if(r.size){let a=n[s].type.contentMatch.matchFragment(r);if(!a||!a.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}r=j.from(n[s].type.create(n[s].attrs,r))}let i=e.start,o=e.end;t.step(new nt(i,o,i,o,new V(r,0,0),n.length,!0))}function Tj(t,e,n,r,i){if(!r.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let o=t.steps.length;t.doc.nodesBetween(e,n,(s,a)=>{let l=typeof i=="function"?i(s):i;if(s.isTextblock&&!s.hasMarkup(r,l)&&_j(t.doc,t.mapping.slice(o).map(a),r)){let c=null;if(r.schema.linebreakReplacement){let p=r.whitespace=="pre",m=!!r.contentMatch.matchType(r.schema.linebreakReplacement);p&&!m?c=!1:!p&&m&&(c=!0)}c===!1&&QE(t,s,a,o),Qv(t,t.mapping.slice(o).map(a,1),r,void 0,c===null);let u=t.mapping.slice(o),d=u.map(a,1),f=u.map(a+s.nodeSize,1);return t.step(new nt(d,f,d+1,f-1,new V(j.from(r.create(l,null,s.marks)),0,0),1,!0)),c===!0&&YE(t,s,a,o),!1}})}function YE(t,e,n,r){e.forEach((i,o)=>{if(i.isText){let s,a=/\r?\n|\r/g;for(;s=a.exec(i.text);){let l=t.mapping.slice(r).map(n+1+o+s.index);t.replaceWith(l,l+1,e.type.schema.linebreakReplacement.create())}}})}function QE(t,e,n,r){e.forEach((i,o)=>{if(i.type==i.type.schema.linebreakReplacement){let s=t.mapping.slice(r).map(n+1+o);t.replaceWith(s,s+1,e.type.schema.text(`
`))}})}function _j(t,e,n){let r=t.resolve(e),i=r.index();return r.parent.canReplaceWith(i,i+1,n)}function Rj(t,e,n,r,i){let o=t.doc.nodeAt(e);if(!o)throw new RangeError("No node at given position");n||(n=o.type);let s=n.create(r,null,i||o.marks);if(o.isLeaf)return t.replaceWith(e,e+o.nodeSize,s);if(!n.validContent(o.content))throw new RangeError("Invalid content for node type "+n.name);t.step(new nt(e,e+o.nodeSize,e+1,e+o.nodeSize-1,new V(j.from(s),0,0),1,!0))}function ga(t,e,n=1,r){let i=t.resolve(e),o=i.depth-n,s=r&&r[r.length-1]||i.parent;if(o<0||i.parent.type.spec.isolating||!i.parent.canReplace(i.index(),i.parent.childCount)||!s.type.validContent(i.parent.content.cutByIndex(i.index(),i.parent.childCount)))return!1;for(let c=i.depth-1,u=n-2;c>o;c--,u--){let d=i.node(c),f=i.index(c);if(d.type.spec.isolating)return!1;let p=d.content.cutByIndex(f,d.childCount),m=r&&r[u+1];m&&(p=p.replaceChild(0,m.type.create(m.attrs)));let g=r&&r[u]||d;if(!d.canReplace(f+1,d.childCount)||!g.type.validContent(p))return!1}let a=i.indexAfter(o),l=r&&r[0];return i.node(o).canReplaceWith(a,a,l?l.type:i.node(o+1).type)}function Oj(t,e,n=1,r){let i=t.doc.resolve(e),o=j.empty,s=j.empty;for(let a=i.depth,l=i.depth-n,c=n-1;a>l;a--,c--){o=j.from(i.node(a).copy(o));let u=r&&r[c];s=j.from(u?u.type.create(u.attrs,s):i.node(a).copy(s))}t.step(new et(e,e,new V(o.append(s),n,n),!0))}function fo(t,e){let n=t.resolve(e),r=n.index();return XE(n.nodeBefore,n.nodeAfter)&&n.parent.canReplace(r,r+1)}function Pj(t,e){e.content.size||t.type.compatibleContent(e.type);let n=t.contentMatchAt(t.childCount),{linebreakReplacement:r}=t.type.schema;for(let i=0;i<e.childCount;i++){let o=e.child(i),s=o.type==r?t.type.schema.nodes.text:o.type;if(n=n.matchType(s),!n||!t.type.allowsMarks(o.marks))return!1}return n.validEnd}function XE(t,e){return!!(t&&e&&!t.isLeaf&&Pj(t,e))}function Eh(t,e,n=-1){let r=t.resolve(e);for(let i=r.depth;;i--){let o,s,a=r.index(i);if(i==r.depth?(o=r.nodeBefore,s=r.nodeAfter):n>0?(o=r.node(i+1),a++,s=r.node(i).maybeChild(a)):(o=r.node(i).maybeChild(a-1),s=r.node(i+1)),o&&!o.isTextblock&&XE(o,s)&&r.node(i).canReplace(a,a+1))return e;if(i==0)break;e=n<0?r.before(i):r.after(i)}}function Mj(t,e,n){let r=null,{linebreakReplacement:i}=t.doc.type.schema,o=t.doc.resolve(e-n),s=o.node().type;if(i&&s.inlineContent){let u=s.whitespace=="pre",d=!!s.contentMatch.matchType(i);u&&!d?r=!1:!u&&d&&(r=!0)}let a=t.steps.length;if(r===!1){let u=t.doc.resolve(e+n);QE(t,u.node(),u.before(),a)}s.inlineContent&&Qv(t,e+n-1,s,o.node().contentMatchAt(o.index()),r==null);let l=t.mapping.slice(a),c=l.map(e-n);if(t.step(new et(c,l.map(e+n,-1),V.empty,!0)),r===!0){let u=t.doc.resolve(c);YE(t,u.node(),u.before(),t.steps.length)}return t}function Aj(t,e,n){let r=t.resolve(e);if(r.parent.canReplaceWith(r.index(),r.index(),n))return e;if(r.parentOffset==0)for(let i=r.depth-1;i>=0;i--){let o=r.index(i);if(r.node(i).canReplaceWith(o,o,n))return r.before(i+1);if(o>0)return null}if(r.parentOffset==r.parent.content.size)for(let i=r.depth-1;i>=0;i--){let o=r.indexAfter(i);if(r.node(i).canReplaceWith(o,o,n))return r.after(i+1);if(o<r.node(i).childCount)return null}return null}function ZE(t,e,n){let r=t.resolve(e);if(!n.content.size)return e;let i=n.content;for(let o=0;o<n.openStart;o++)i=i.firstChild.content;for(let o=1;o<=(n.openStart==0&&n.size?2:1);o++)for(let s=r.depth;s>=0;s--){let a=s==r.depth?0:r.pos<=(r.start(s+1)+r.end(s+1))/2?-1:1,l=r.index(s)+(a>0?1:0),c=r.node(s),u=!1;if(o==1)u=c.canReplace(l,l,i);else{let d=c.contentMatchAt(l).findWrapping(i.firstChild.type);u=d&&c.canReplaceWith(l,l,d[0])}if(u)return a==0?r.pos:a<0?r.before(s+1):r.after(s+1)}return null}function Th(t,e,n=e,r=V.empty){if(e==n&&!r.size)return null;let i=t.resolve(e),o=t.resolve(n);return eT(i,o,r)?new et(e,n,r):new Dj(i,o,r).fit()}function eT(t,e,n){return!n.openStart&&!n.openEnd&&t.start()==e.start()&&t.parent.canReplace(t.index(),e.index(),n.content)}class Dj{constructor(e,n,r){this.$from=e,this.$to=n,this.unplaced=r,this.frontier=[],this.placed=j.empty;for(let i=0;i<=e.depth;i++){let o=e.node(i);this.frontier.push({type:o.type,match:o.contentMatchAt(e.indexAfter(i))})}for(let i=e.depth;i>0;i--)this.placed=j.from(e.node(i).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let c=this.findFittable();c?this.placeNodes(c):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),n=this.placed.size-this.depth-this.$from.depth,r=this.$from,i=this.close(e<0?this.$to:r.doc.resolve(e));if(!i)return null;let o=this.placed,s=r.depth,a=i.depth;for(;s&&a&&o.childCount==1;)o=o.firstChild.content,s--,a--;let l=new V(o,s,a);return e>-1?new nt(r.pos,e,this.$to.pos,this.$to.end(),l,n):l.size||r.pos!=this.$to.pos?new et(r.pos,i.pos,l):null}findFittable(){let e=this.unplaced.openStart;for(let n=this.unplaced.content,r=0,i=this.unplaced.openEnd;r<e;r++){let o=n.firstChild;if(n.childCount>1&&(i=0),o.type.spec.isolating&&i<=r){e=r;break}n=o.content}for(let n=1;n<=2;n++)for(let r=n==1?e:this.unplaced.openStart;r>=0;r--){let i,o=null;r?(o=Up(this.unplaced.content,r-1).firstChild,i=o.content):i=this.unplaced.content;let s=i.firstChild;for(let a=this.depth;a>=0;a--){let{type:l,match:c}=this.frontier[a],u,d=null;if(n==1&&(s?c.matchType(s.type)||(d=c.fillBefore(j.from(s),!1)):o&&l.compatibleContent(o.type)))return{sliceDepth:r,frontierDepth:a,parent:o,inject:d};if(n==2&&s&&(u=c.findWrapping(s.type)))return{sliceDepth:r,frontierDepth:a,parent:o,wrap:u};if(o&&c.matchType(o.type))break}}}openMore(){let{content:e,openStart:n,openEnd:r}=this.unplaced,i=Up(e,n);return!i.childCount||i.firstChild.isLeaf?!1:(this.unplaced=new V(e,n+1,Math.max(r,i.size+n>=e.size-r?n+1:0)),!0)}dropNode(){let{content:e,openStart:n,openEnd:r}=this.unplaced,i=Up(e,n);if(i.childCount<=1&&n>0){let o=e.size-n<=n+i.size;this.unplaced=new V(Fl(e,n-1,1),n-1,o?n-1:r)}else this.unplaced=new V(Fl(e,n,1),n,r)}placeNodes({sliceDepth:e,frontierDepth:n,parent:r,inject:i,wrap:o}){for(;this.depth>n;)this.closeFrontierNode();if(o)for(let g=0;g<o.length;g++)this.openFrontierNode(o[g]);let s=this.unplaced,a=r?r.content:s.content,l=s.openStart-e,c=0,u=[],{match:d,type:f}=this.frontier[n];if(i){for(let g=0;g<i.childCount;g++)u.push(i.child(g));d=d.matchFragment(i)}let p=a.size+e-(s.content.size-s.openEnd);for(;c<a.childCount;){let g=a.child(c),v=d.matchType(g.type);if(!v)break;c++,(c>1||l==0||g.content.size)&&(d=v,u.push(tT(g.mark(f.allowedMarks(g.marks)),c==1?l:0,c==a.childCount?p:-1)))}let m=c==a.childCount;m||(p=-1),this.placed=Bl(this.placed,n,j.from(u)),this.frontier[n].match=d,m&&p<0&&r&&r.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let g=0,v=a;g<p;g++){let x=v.lastChild;this.frontier.push({type:x.type,match:x.contentMatchAt(x.childCount)}),v=x.content}this.unplaced=m?e==0?V.empty:new V(Fl(s.content,e-1,1),e-1,p<0?s.openEnd:e-1):new V(Fl(s.content,e,c),s.openStart,s.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e=this.frontier[this.depth],n;if(!e.type.isTextblock||!Vp(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(n=this.findCloseLevel(this.$to))&&n.depth==this.depth)return-1;let{depth:r}=this.$to,i=this.$to.after(r);for(;r>1&&i==this.$to.end(--r);)++i;return i}findCloseLevel(e){e:for(let n=Math.min(this.depth,e.depth);n>=0;n--){let{match:r,type:i}=this.frontier[n],o=n<e.depth&&e.end(n+1)==e.pos+(e.depth-(n+1)),s=Vp(e,n,i,r,o);if(s){for(let a=n-1;a>=0;a--){let{match:l,type:c}=this.frontier[a],u=Vp(e,a,c,l,!0);if(!u||u.childCount)continue e}return{depth:n,fit:s,move:o?e.doc.resolve(e.after(n+1)):e}}}}close(e){let n=this.findCloseLevel(e);if(!n)return null;for(;this.depth>n.depth;)this.closeFrontierNode();n.fit.childCount&&(this.placed=Bl(this.placed,n.depth,n.fit)),e=n.move;for(let r=n.depth+1;r<=e.depth;r++){let i=e.node(r),o=i.type.contentMatch.fillBefore(i.content,!0,e.index(r));this.openFrontierNode(i.type,i.attrs,o)}return e}openFrontierNode(e,n=null,r){let i=this.frontier[this.depth];i.match=i.match.matchType(e),this.placed=Bl(this.placed,this.depth,j.from(e.create(n,r))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let n=this.frontier.pop().match.fillBefore(j.empty,!0);n.childCount&&(this.placed=Bl(this.placed,this.frontier.length,n))}}function Fl(t,e,n){return e==0?t.cutByIndex(n,t.childCount):t.replaceChild(0,t.firstChild.copy(Fl(t.firstChild.content,e-1,n)))}function Bl(t,e,n){return e==0?t.append(n):t.replaceChild(t.childCount-1,t.lastChild.copy(Bl(t.lastChild.content,e-1,n)))}function Up(t,e){for(let n=0;n<e;n++)t=t.firstChild.content;return t}function tT(t,e,n){if(e<=0)return t;let r=t.content;return e>1&&(r=r.replaceChild(0,tT(r.firstChild,e-1,r.childCount==1?n-1:0))),e>0&&(r=t.type.contentMatch.fillBefore(r).append(r),n<=0&&(r=r.append(t.type.contentMatch.matchFragment(r).fillBefore(j.empty,!0)))),t.copy(r)}function Vp(t,e,n,r,i){let o=t.node(e),s=i?t.indexAfter(e):t.index(e);if(s==o.childCount&&!n.compatibleContent(o.type))return null;let a=r.fillBefore(o.content,!0,s);return a&&!Ij(n,o.content,s)?a:null}function Ij(t,e,n){for(let r=n;r<e.childCount;r++)if(!t.allowsMarks(e.child(r).marks))return!0;return!1}function Nj(t){return t.spec.defining||t.spec.definingForContent}function jj(t,e,n,r){if(!r.size)return t.deleteRange(e,n);let i=t.doc.resolve(e),o=t.doc.resolve(n);if(eT(i,o,r))return t.step(new et(e,n,r));let s=rT(i,t.doc.resolve(n));s[s.length-1]==0&&s.pop();let a=-(i.depth+1);s.unshift(a);for(let f=i.depth,p=i.pos-1;f>0;f--,p--){let m=i.node(f).type.spec;if(m.defining||m.definingAsContext||m.isolating)break;s.indexOf(f)>-1?a=f:i.before(f)==p&&s.splice(1,0,-f)}let l=s.indexOf(a),c=[],u=r.openStart;for(let f=r.content,p=0;;p++){let m=f.firstChild;if(c.push(m),p==r.openStart)break;f=m.content}for(let f=u-1;f>=0;f--){let p=c[f],m=Nj(p.type);if(m&&!p.sameMarkup(i.node(Math.abs(a)-1)))u=f;else if(m||!p.type.isTextblock)break}for(let f=r.openStart;f>=0;f--){let p=(f+u+1)%(r.openStart+1),m=c[p];if(m)for(let g=0;g<s.length;g++){let v=s[(g+l)%s.length],x=!0;v<0&&(x=!1,v=-v);let w=i.node(v-1),S=i.index(v-1);if(w.canReplaceWith(S,S,m.type,m.marks))return t.replace(i.before(v),x?o.after(v):n,new V(nT(r.content,0,r.openStart,p),p,r.openEnd))}}let d=t.steps.length;for(let f=s.length-1;f>=0&&(t.replace(e,n,r),!(t.steps.length>d));f--){let p=s[f];p<0||(e=i.before(p),n=o.after(p))}}function nT(t,e,n,r,i){if(e<n){let o=t.firstChild;t=t.replaceChild(0,o.copy(nT(o.content,e+1,n,r,o)))}if(e>r){let o=i.contentMatchAt(0),s=o.fillBefore(t).append(t);t=s.append(o.matchFragment(s).fillBefore(j.empty,!0))}return t}function Lj(t,e,n,r){if(!r.isInline&&e==n&&t.doc.resolve(e).parent.content.size){let i=Aj(t.doc,e,r.type);i!=null&&(e=n=i)}t.replaceRange(e,n,new V(j.from(r),0,0))}function $j(t,e,n){let r=t.doc.resolve(e),i=t.doc.resolve(n),o=rT(r,i);for(let s=0;s<o.length;s++){let a=o[s],l=s==o.length-1;if(l&&a==0||r.node(a).type.contentMatch.validEnd)return t.delete(r.start(a),i.end(a));if(a>0&&(l||r.node(a-1).canReplace(r.index(a-1),i.indexAfter(a-1))))return t.delete(r.before(a),i.after(a))}for(let s=1;s<=r.depth&&s<=i.depth;s++)if(e-r.start(s)==r.depth-s&&n>r.end(s)&&i.end(s)-n!=i.depth-s&&r.start(s-1)==i.start(s-1)&&r.node(s-1).canReplace(r.index(s-1),i.index(s-1)))return t.delete(r.before(s),n);t.delete(e,n)}function rT(t,e){let n=[],r=Math.min(t.depth,e.depth);for(let i=r;i>=0;i--){let o=t.start(i);if(o<t.pos-(t.depth-i)||e.end(i)>e.pos+(e.depth-i)||t.node(i).type.spec.isolating||e.node(i).type.spec.isolating)break;(o==e.start(i)||i==t.depth&&i==e.depth&&t.parent.inlineContent&&e.parent.inlineContent&&i&&e.start(i-1)==o-1)&&n.push(i)}return n}class ya extends Ct{constructor(e,n,r){super(),this.pos=e,this.attr=n,this.value=r}apply(e){let n=e.nodeAt(this.pos);if(!n)return Ke.fail("No node at attribute step's position");let r=Object.create(null);for(let o in n.attrs)r[o]=n.attrs[o];r[this.attr]=this.value;let i=n.type.create(r,null,n.marks);return Ke.fromReplace(e,this.pos,this.pos+1,new V(j.from(i),0,n.isLeaf?0:1))}getMap(){return fn.empty}invert(e){return new ya(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new ya(n.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,n){if(typeof n.pos!="number"||typeof n.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new ya(n.pos,n.attr,n.value)}}Ct.jsonID("attr",ya);class Dc extends Ct{constructor(e,n){super(),this.attr=e,this.value=n}apply(e){let n=Object.create(null);for(let i in e.attrs)n[i]=e.attrs[i];n[this.attr]=this.value;let r=e.type.create(n,e.content,e.marks);return Ke.ok(r)}getMap(){return fn.empty}invert(e){return new Dc(this.attr,e.attrs[this.attr])}map(e){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(e,n){if(typeof n.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new Dc(n.attr,n.value)}}Ct.jsonID("docAttr",Dc);let Ha=class extends Error{};Ha=function t(e){let n=Error.call(this,e);return n.__proto__=t.prototype,n};Ha.prototype=Object.create(Error.prototype);Ha.prototype.constructor=Ha;Ha.prototype.name="TransformError";class Fj{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new Ac}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let n=this.maybeStep(e);if(n.failed)throw new Ha(n.failed);return this}maybeStep(e){let n=e.apply(this.doc);return n.failed||this.addStep(e,n.doc),n}get docChanged(){return this.steps.length>0}addStep(e,n){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=n}replace(e,n=e,r=V.empty){let i=Th(this.doc,e,n,r);return i&&this.step(i),this}replaceWith(e,n,r){return this.replace(e,n,new V(j.from(r),0,0))}delete(e,n){return this.replace(e,n,V.empty)}insert(e,n){return this.replaceWith(e,e,n)}replaceRange(e,n,r){return jj(this,e,n,r),this}replaceRangeWith(e,n,r){return Lj(this,e,n,r),this}deleteRange(e,n){return $j(this,e,n),this}lift(e,n){return Sj(this,e,n),this}join(e,n=1){return Mj(this,e,n),this}wrap(e,n){return Ej(this,e,n),this}setBlockType(e,n=e,r,i=null){return Tj(this,e,n,r,i),this}setNodeMarkup(e,n,r=null,i){return Rj(this,e,n,r,i),this}setNodeAttribute(e,n,r){return this.step(new ya(e,n,r)),this}setDocAttribute(e,n){return this.step(new Dc(e,n)),this}addNodeMark(e,n){return this.step(new ji(e,n)),this}removeNodeMark(e,n){if(!(n instanceof Se)){let r=this.doc.nodeAt(e);if(!r)throw new RangeError("No node at position "+e);if(n=n.isInSet(r.marks),!n)return this}return this.step(new Va(e,n)),this}split(e,n=1,r){return Oj(this,e,n,r),this}addMark(e,n,r){return xj(this,e,n,r),this}removeMark(e,n,r){return wj(this,e,n,r),this}clearIncompatible(e,n,r){return Qv(this,e,n,r),this}}const Hp=Object.create(null);class oe{constructor(e,n,r){this.$anchor=e,this.$head=n,this.ranges=r||[new Bj(e.min(n),e.max(n))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let n=0;n<e.length;n++)if(e[n].$from.pos!=e[n].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,n=V.empty){let r=n.content.lastChild,i=null;for(let a=0;a<n.openEnd;a++)i=r,r=r.lastChild;let o=e.steps.length,s=this.ranges;for(let a=0;a<s.length;a++){let{$from:l,$to:c}=s[a],u=e.mapping.slice(o);e.replaceRange(u.map(l.pos),u.map(c.pos),a?V.empty:n),a==0&&ab(e,o,(r?r.isInline:i&&i.isTextblock)?-1:1)}}replaceWith(e,n){let r=e.steps.length,i=this.ranges;for(let o=0;o<i.length;o++){let{$from:s,$to:a}=i[o],l=e.mapping.slice(r),c=l.map(s.pos),u=l.map(a.pos);o?e.deleteRange(c,u):(e.replaceRangeWith(c,u,n),ab(e,r,n.isInline?-1:1))}}static findFrom(e,n,r=!1){let i=e.parent.inlineContent?new ie(e):Hs(e.node(0),e.parent,e.pos,e.index(),n,r);if(i)return i;for(let o=e.depth-1;o>=0;o--){let s=n<0?Hs(e.node(0),e.node(o),e.before(o+1),e.index(o),n,r):Hs(e.node(0),e.node(o),e.after(o+1),e.index(o)+1,n,r);if(s)return s}return null}static near(e,n=1){return this.findFrom(e,n)||this.findFrom(e,-n)||new Mn(e.node(0))}static atStart(e){return Hs(e,e,0,0,1)||new Mn(e)}static atEnd(e){return Hs(e,e,e.content.size,e.childCount,-1)||new Mn(e)}static fromJSON(e,n){if(!n||!n.type)throw new RangeError("Invalid input for Selection.fromJSON");let r=Hp[n.type];if(!r)throw new RangeError(`No selection type ${n.type} defined`);return r.fromJSON(e,n)}static jsonID(e,n){if(e in Hp)throw new RangeError("Duplicate use of selection JSON ID "+e);return Hp[e]=n,n.prototype.jsonID=e,n}getBookmark(){return ie.between(this.$anchor,this.$head).getBookmark()}}oe.prototype.visible=!0;class Bj{constructor(e,n){this.$from=e,this.$to=n}}let ob=!1;function sb(t){!ob&&!t.parent.inlineContent&&(ob=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+t.parent.type.name+")"))}class ie extends oe{constructor(e,n=e){sb(e),sb(n),super(e,n)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,n){let r=e.resolve(n.map(this.head));if(!r.parent.inlineContent)return oe.near(r);let i=e.resolve(n.map(this.anchor));return new ie(i.parent.inlineContent?i:r,r)}replace(e,n=V.empty){if(super.replace(e,n),n==V.empty){let r=this.$from.marksAcross(this.$to);r&&e.ensureMarks(r)}}eq(e){return e instanceof ie&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new _h(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,n){if(typeof n.anchor!="number"||typeof n.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new ie(e.resolve(n.anchor),e.resolve(n.head))}static create(e,n,r=n){let i=e.resolve(n);return new this(i,r==n?i:e.resolve(r))}static between(e,n,r){let i=e.pos-n.pos;if((!r||i)&&(r=i>=0?1:-1),!n.parent.inlineContent){let o=oe.findFrom(n,r,!0)||oe.findFrom(n,-r,!0);if(o)n=o.$head;else return oe.near(n,r)}return e.parent.inlineContent||(i==0?e=n:(e=(oe.findFrom(e,-r,!0)||oe.findFrom(e,r,!0)).$anchor,e.pos<n.pos!=i<0&&(e=n))),new ie(e,n)}}oe.jsonID("text",ie);class _h{constructor(e,n){this.anchor=e,this.head=n}map(e){return new _h(e.map(this.anchor),e.map(this.head))}resolve(e){return ie.between(e.resolve(this.anchor),e.resolve(this.head))}}class X extends oe{constructor(e){let n=e.nodeAfter,r=e.node(0).resolve(e.pos+n.nodeSize);super(e,r),this.node=n}map(e,n){let{deleted:r,pos:i}=n.mapResult(this.anchor),o=e.resolve(i);return r?oe.near(o):new X(o)}content(){return new V(j.from(this.node),0,0)}eq(e){return e instanceof X&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new Zv(this.anchor)}static fromJSON(e,n){if(typeof n.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new X(e.resolve(n.anchor))}static create(e,n){return new X(e.resolve(n))}static isSelectable(e){return!e.isText&&e.type.spec.selectable!==!1}}X.prototype.visible=!1;oe.jsonID("node",X);class Zv{constructor(e){this.anchor=e}map(e){let{deleted:n,pos:r}=e.mapResult(this.anchor);return n?new _h(r,r):new Zv(r)}resolve(e){let n=e.resolve(this.anchor),r=n.nodeAfter;return r&&X.isSelectable(r)?new X(n):oe.near(n)}}class Mn extends oe{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,n=V.empty){if(n==V.empty){e.delete(0,e.doc.content.size);let r=oe.atStart(e.doc);r.eq(e.selection)||e.setSelection(r)}else super.replace(e,n)}toJSON(){return{type:"all"}}static fromJSON(e){return new Mn(e)}map(e){return new Mn(e)}eq(e){return e instanceof Mn}getBookmark(){return zj}}oe.jsonID("all",Mn);const zj={map(){return this},resolve(t){return new Mn(t)}};function Hs(t,e,n,r,i,o=!1){if(e.inlineContent)return ie.create(t,n);for(let s=r-(i>0?0:1);i>0?s<e.childCount:s>=0;s+=i){let a=e.child(s);if(a.isAtom){if(!o&&X.isSelectable(a))return X.create(t,n-(i<0?a.nodeSize:0))}else{let l=Hs(t,a,n+i,i<0?a.childCount:0,i,o);if(l)return l}n+=a.nodeSize*i}return null}function ab(t,e,n){let r=t.steps.length-1;if(r<e)return;let i=t.steps[r];if(!(i instanceof et||i instanceof nt))return;let o=t.mapping.maps[r],s;o.forEach((a,l,c,u)=>{s==null&&(s=u)}),t.setSelection(oe.near(t.doc.resolve(s),n))}const lb=1,ad=2,cb=4;class Uj extends Fj{constructor(e){super(e.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=e.selection,this.storedMarks=e.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(e){if(e.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=(this.updated|lb)&~ad,this.storedMarks=null,this}get selectionSet(){return(this.updated&lb)>0}setStoredMarks(e){return this.storedMarks=e,this.updated|=ad,this}ensureMarks(e){return Se.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this}addStoredMark(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(this.updated&ad)>0}addStep(e,n){super.addStep(e,n),this.updated=this.updated&~ad,this.storedMarks=null}setTime(e){return this.time=e,this}replaceSelection(e){return this.selection.replace(this,e),this}replaceSelectionWith(e,n=!0){let r=this.selection;return n&&(e=e.mark(this.storedMarks||(r.empty?r.$from.marks():r.$from.marksAcross(r.$to)||Se.none))),r.replaceWith(this,e),this}deleteSelection(){return this.selection.replace(this),this}insertText(e,n,r){let i=this.doc.type.schema;if(n==null)return e?this.replaceSelectionWith(i.text(e),!0):this.deleteSelection();{if(r==null&&(r=n),r=r??n,!e)return this.deleteRange(n,r);let o=this.storedMarks;if(!o){let s=this.doc.resolve(n);o=r==n?s.marks():s.marksAcross(this.doc.resolve(r))}return this.replaceRangeWith(n,r,i.text(e,o)),this.selection.empty||this.setSelection(oe.near(this.selection.$to)),this}}setMeta(e,n){return this.meta[typeof e=="string"?e:e.key]=n,this}getMeta(e){return this.meta[typeof e=="string"?e:e.key]}get isGeneric(){for(let e in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=cb,this}get scrolledIntoView(){return(this.updated&cb)>0}}function ub(t,e){return!e||!t?t:t.bind(e)}class zl{constructor(e,n,r){this.name=e,this.init=ub(n.init,r),this.apply=ub(n.apply,r)}}const Vj=[new zl("doc",{init(t){return t.doc||t.schema.topNodeType.createAndFill()},apply(t){return t.doc}}),new zl("selection",{init(t,e){return t.selection||oe.atStart(e.doc)},apply(t){return t.selection}}),new zl("storedMarks",{init(t){return t.storedMarks||null},apply(t,e,n,r){return r.selection.$cursor?t.storedMarks:null}}),new zl("scrollToSelection",{init(){return 0},apply(t,e){return t.scrolledIntoView?e+1:e}})];class Wp{constructor(e,n){this.schema=e,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=Vj.slice(),n&&n.forEach(r=>{if(this.pluginsByKey[r.key])throw new RangeError("Adding different instances of a keyed plugin ("+r.key+")");this.plugins.push(r),this.pluginsByKey[r.key]=r,r.spec.state&&this.fields.push(new zl(r.key,r.spec.state,r))})}}class sa{constructor(e){this.config=e}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(e){return this.applyTransaction(e).state}filterTransaction(e,n=-1){for(let r=0;r<this.config.plugins.length;r++)if(r!=n){let i=this.config.plugins[r];if(i.spec.filterTransaction&&!i.spec.filterTransaction.call(i,e,this))return!1}return!0}applyTransaction(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};let n=[e],r=this.applyInner(e),i=null;for(;;){let o=!1;for(let s=0;s<this.config.plugins.length;s++){let a=this.config.plugins[s];if(a.spec.appendTransaction){let l=i?i[s].n:0,c=i?i[s].state:this,u=l<n.length&&a.spec.appendTransaction.call(a,l?n.slice(l):n,c,r);if(u&&r.filterTransaction(u,s)){if(u.setMeta("appendedTransaction",e),!i){i=[];for(let d=0;d<this.config.plugins.length;d++)i.push(d<s?{state:r,n:n.length}:{state:this,n:0})}n.push(u),r=r.applyInner(u),o=!0}i&&(i[s]={state:r,n:n.length})}}if(!o)return{state:r,transactions:n}}}applyInner(e){if(!e.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let n=new sa(this.config),r=this.config.fields;for(let i=0;i<r.length;i++){let o=r[i];n[o.name]=o.apply(e,this[o.name],this,n)}return n}get tr(){return new Uj(this)}static create(e){let n=new Wp(e.doc?e.doc.type.schema:e.schema,e.plugins),r=new sa(n);for(let i=0;i<n.fields.length;i++)r[n.fields[i].name]=n.fields[i].init(e,r);return r}reconfigure(e){let n=new Wp(this.schema,e.plugins),r=n.fields,i=new sa(n);for(let o=0;o<r.length;o++){let s=r[o].name;i[s]=this.hasOwnProperty(s)?this[s]:r[o].init(e,i)}return i}toJSON(e){let n={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(n.storedMarks=this.storedMarks.map(r=>r.toJSON())),e&&typeof e=="object")for(let r in e){if(r=="doc"||r=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");let i=e[r],o=i.spec.state;o&&o.toJSON&&(n[r]=o.toJSON.call(i,this[i.key]))}return n}static fromJSON(e,n,r){if(!n)throw new RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw new RangeError("Required config field 'schema' missing");let i=new Wp(e.schema,e.plugins),o=new sa(i);return i.fields.forEach(s=>{if(s.name=="doc")o.doc=qi.fromJSON(e.schema,n.doc);else if(s.name=="selection")o.selection=oe.fromJSON(o.doc,n.selection);else if(s.name=="storedMarks")n.storedMarks&&(o.storedMarks=n.storedMarks.map(e.schema.markFromJSON));else{if(r)for(let a in r){let l=r[a],c=l.spec.state;if(l.key==s.name&&c&&c.fromJSON&&Object.prototype.hasOwnProperty.call(n,a)){o[s.name]=c.fromJSON.call(l,e,n[a],o);return}}o[s.name]=s.init(e,o)}}),o}}function iT(t,e,n){for(let r in t){let i=t[r];i instanceof Function?i=i.bind(e):r=="handleDOMEvents"&&(i=iT(i,e,{})),n[r]=i}return n}class ht{constructor(e){this.spec=e,this.props={},e.props&&iT(e.props,this,this.props),this.key=e.key?e.key.key:oT("plugin")}getState(e){return e[this.key]}}const Kp=Object.create(null);function oT(t){return t in Kp?t+"$"+ ++Kp[t]:(Kp[t]=0,t+"$")}class bn{constructor(e="key"){this.key=oT(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}}const ct=function(t){for(var e=0;;e++)if(t=t.previousSibling,!t)return e},Wa=function(t){let e=t.assignedSlot||t.parentNode;return e&&e.nodeType==11?e.host:e};let Zg=null;const Fr=function(t,e,n){let r=Zg||(Zg=document.createRange());return r.setEnd(t,n??t.nodeValue.length),r.setStart(t,e||0),r},Hj=function(){Zg=null},ms=function(t,e,n,r){return n&&(db(t,e,n,r,-1)||db(t,e,n,r,1))},Wj=/^(img|br|input|textarea|hr)$/i;function db(t,e,n,r,i){for(;;){if(t==n&&e==r)return!0;if(e==(i<0?0:Rn(t))){let o=t.parentNode;if(!o||o.nodeType!=1||gu(t)||Wj.test(t.nodeName)||t.contentEditable=="false")return!1;e=ct(t)+(i<0?0:1),t=o}else if(t.nodeType==1){if(t=t.childNodes[e+(i<0?-1:0)],t.contentEditable=="false")return!1;e=i<0?Rn(t):0}else return!1}}function Rn(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function Kj(t,e){for(;;){if(t.nodeType==3&&e)return t;if(t.nodeType==1&&e>0){if(t.contentEditable=="false")return null;t=t.childNodes[e-1],e=Rn(t)}else if(t.parentNode&&!gu(t))e=ct(t),t=t.parentNode;else return null}}function qj(t,e){for(;;){if(t.nodeType==3&&e<t.nodeValue.length)return t;if(t.nodeType==1&&e<t.childNodes.length){if(t.contentEditable=="false")return null;t=t.childNodes[e],e=0}else if(t.parentNode&&!gu(t))e=ct(t)+1,t=t.parentNode;else return null}}function Gj(t,e,n){for(let r=e==0,i=e==Rn(t);r||i;){if(t==n)return!0;let o=ct(t);if(t=t.parentNode,!t)return!1;r=r&&o==0,i=i&&o==Rn(t)}}function gu(t){let e;for(let n=t;n&&!(e=n.pmViewDesc);n=n.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==t||e.contentDOM==t)}const Rh=function(t){return t.focusNode&&ms(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset)};function Ao(t,e){let n=document.createEvent("Event");return n.initEvent("keydown",!0,!0),n.keyCode=t,n.key=n.code=e,n}function Jj(t){let e=t.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}function Yj(t,e,n){if(t.caretPositionFromPoint)try{let r=t.caretPositionFromPoint(e,n);if(r)return{node:r.offsetNode,offset:Math.min(Rn(r.offsetNode),r.offset)}}catch{}if(t.caretRangeFromPoint){let r=t.caretRangeFromPoint(e,n);if(r)return{node:r.startContainer,offset:Math.min(Rn(r.startContainer),r.startOffset)}}}const _r=typeof navigator<"u"?navigator:null,fb=typeof document<"u"?document:null,ho=_r&&_r.userAgent||"",ey=/Edge\/(\d+)/.exec(ho),sT=/MSIE \d/.exec(ho),ty=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(ho),nn=!!(sT||ty||ey),Ji=sT?document.documentMode:ty?+ty[1]:ey?+ey[1]:0,nr=!nn&&/gecko\/(\d+)/i.test(ho);nr&&+(/Firefox\/(\d+)/.exec(ho)||[0,0])[1];const ny=!nn&&/Chrome\/(\d+)/.exec(ho),bt=!!ny,aT=ny?+ny[1]:0,At=!nn&&!!_r&&/Apple Computer/.test(_r.vendor),Ka=At&&(/Mobile\/\w+/.test(ho)||!!_r&&_r.maxTouchPoints>2),En=Ka||(_r?/Mac/.test(_r.platform):!1),Qj=_r?/Win/.test(_r.platform):!1,Wr=/Android \d/.test(ho),yu=!!fb&&"webkitFontSmoothing"in fb.documentElement.style,Xj=yu?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function Zj(t){let e=t.defaultView&&t.defaultView.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:t.documentElement.clientWidth,top:0,bottom:t.documentElement.clientHeight}}function Nr(t,e){return typeof t=="number"?t:t[e]}function eL(t){let e=t.getBoundingClientRect(),n=e.width/t.offsetWidth||1,r=e.height/t.offsetHeight||1;return{left:e.left,right:e.left+t.clientWidth*n,top:e.top,bottom:e.top+t.clientHeight*r}}function hb(t,e,n){let r=t.someProp("scrollThreshold")||0,i=t.someProp("scrollMargin")||5,o=t.dom.ownerDocument;for(let s=n||t.dom;s;){if(s.nodeType!=1){s=Wa(s);continue}let a=s,l=a==o.body,c=l?Zj(o):eL(a),u=0,d=0;if(e.top<c.top+Nr(r,"top")?d=-(c.top-e.top+Nr(i,"top")):e.bottom>c.bottom-Nr(r,"bottom")&&(d=e.bottom-e.top>c.bottom-c.top?e.top+Nr(i,"top")-c.top:e.bottom-c.bottom+Nr(i,"bottom")),e.left<c.left+Nr(r,"left")?u=-(c.left-e.left+Nr(i,"left")):e.right>c.right-Nr(r,"right")&&(u=e.right-c.right+Nr(i,"right")),u||d)if(l)o.defaultView.scrollBy(u,d);else{let p=a.scrollLeft,m=a.scrollTop;d&&(a.scrollTop+=d),u&&(a.scrollLeft+=u);let g=a.scrollLeft-p,v=a.scrollTop-m;e={left:e.left-g,top:e.top-v,right:e.right-g,bottom:e.bottom-v}}let f=l?"fixed":getComputedStyle(s).position;if(/^(fixed|sticky)$/.test(f))break;s=f=="absolute"?s.offsetParent:Wa(s)}}function tL(t){let e=t.dom.getBoundingClientRect(),n=Math.max(0,e.top),r,i;for(let o=(e.left+e.right)/2,s=n+1;s<Math.min(innerHeight,e.bottom);s+=5){let a=t.root.elementFromPoint(o,s);if(!a||a==t.dom||!t.dom.contains(a))continue;let l=a.getBoundingClientRect();if(l.top>=n-20){r=a,i=l.top;break}}return{refDOM:r,refTop:i,stack:lT(t.dom)}}function lT(t){let e=[],n=t.ownerDocument;for(let r=t;r&&(e.push({dom:r,top:r.scrollTop,left:r.scrollLeft}),t!=n);r=Wa(r));return e}function nL({refDOM:t,refTop:e,stack:n}){let r=t?t.getBoundingClientRect().top:0;cT(n,r==0?0:r-e)}function cT(t,e){for(let n=0;n<t.length;n++){let{dom:r,top:i,left:o}=t[n];r.scrollTop!=i+e&&(r.scrollTop=i+e),r.scrollLeft!=o&&(r.scrollLeft=o)}}let js=null;function rL(t){if(t.setActive)return t.setActive();if(js)return t.focus(js);let e=lT(t);t.focus(js==null?{get preventScroll(){return js={preventScroll:!0},!0}}:void 0),js||(js=!1,cT(e,0))}function uT(t,e){let n,r=2e8,i,o=0,s=e.top,a=e.top,l,c;for(let u=t.firstChild,d=0;u;u=u.nextSibling,d++){let f;if(u.nodeType==1)f=u.getClientRects();else if(u.nodeType==3)f=Fr(u).getClientRects();else continue;for(let p=0;p<f.length;p++){let m=f[p];if(m.top<=s&&m.bottom>=a){s=Math.max(m.bottom,s),a=Math.min(m.top,a);let g=m.left>e.left?m.left-e.left:m.right<e.left?e.left-m.right:0;if(g<r){n=u,r=g,i=g&&n.nodeType==3?{left:m.right<e.left?m.right:m.left,top:e.top}:e,u.nodeType==1&&g&&(o=d+(e.left>=(m.left+m.right)/2?1:0));continue}}else m.top>e.top&&!l&&m.left<=e.left&&m.right>=e.left&&(l=u,c={left:Math.max(m.left,Math.min(m.right,e.left)),top:m.top});!n&&(e.left>=m.right&&e.top>=m.top||e.left>=m.left&&e.top>=m.bottom)&&(o=d+1)}}return!n&&l&&(n=l,i=c,r=0),n&&n.nodeType==3?iL(n,i):!n||r&&n.nodeType==1?{node:t,offset:o}:uT(n,i)}function iL(t,e){let n=t.nodeValue.length,r=document.createRange();for(let i=0;i<n;i++){r.setEnd(t,i+1),r.setStart(t,i);let o=hi(r,1);if(o.top!=o.bottom&&e0(e,o))return{node:t,offset:i+(e.left>=(o.left+o.right)/2?1:0)}}return{node:t,offset:0}}function e0(t,e){return t.left>=e.left-1&&t.left<=e.right+1&&t.top>=e.top-1&&t.top<=e.bottom+1}function oL(t,e){let n=t.parentNode;return n&&/^li$/i.test(n.nodeName)&&e.left<t.getBoundingClientRect().left?n:t}function sL(t,e,n){let{node:r,offset:i}=uT(e,n),o=-1;if(r.nodeType==1&&!r.firstChild){let s=r.getBoundingClientRect();o=s.left!=s.right&&n.left>(s.left+s.right)/2?1:-1}return t.docView.posFromDOM(r,i,o)}function aL(t,e,n,r){let i=-1;for(let o=e,s=!1;o!=t.dom;){let a=t.docView.nearestDesc(o,!0),l;if(!a)return null;if(a.dom.nodeType==1&&(a.node.isBlock&&a.parent||!a.contentDOM)&&((l=a.dom.getBoundingClientRect()).width||l.height)&&(a.node.isBlock&&a.parent&&(!s&&l.left>r.left||l.top>r.top?i=a.posBefore:(!s&&l.right<r.left||l.bottom<r.top)&&(i=a.posAfter),s=!0),!a.contentDOM&&i<0&&!a.node.isText))return(a.node.isBlock?r.top<(l.top+l.bottom)/2:r.left<(l.left+l.right)/2)?a.posBefore:a.posAfter;o=a.dom.parentNode}return i>-1?i:t.docView.posFromDOM(e,n,-1)}function dT(t,e,n){let r=t.childNodes.length;if(r&&n.top<n.bottom)for(let i=Math.max(0,Math.min(r-1,Math.floor(r*(e.top-n.top)/(n.bottom-n.top))-2)),o=i;;){let s=t.childNodes[o];if(s.nodeType==1){let a=s.getClientRects();for(let l=0;l<a.length;l++){let c=a[l];if(e0(e,c))return dT(s,e,c)}}if((o=(o+1)%r)==i)break}return t}function lL(t,e){let n=t.dom.ownerDocument,r,i=0,o=Yj(n,e.left,e.top);o&&({node:r,offset:i}=o);let s=(t.root.elementFromPoint?t.root:n).elementFromPoint(e.left,e.top),a;if(!s||!t.dom.contains(s.nodeType!=1?s.parentNode:s)){let c=t.dom.getBoundingClientRect();if(!e0(e,c)||(s=dT(t.dom,e,c),!s))return null}if(At)for(let c=s;r&&c;c=Wa(c))c.draggable&&(r=void 0);if(s=oL(s,e),r){if(nr&&r.nodeType==1&&(i=Math.min(i,r.childNodes.length),i<r.childNodes.length)){let u=r.childNodes[i],d;u.nodeName=="IMG"&&(d=u.getBoundingClientRect()).right<=e.left&&d.bottom>e.top&&i++}let c;yu&&i&&r.nodeType==1&&(c=r.childNodes[i-1]).nodeType==1&&c.contentEditable=="false"&&c.getBoundingClientRect().top>=e.top&&i--,r==t.dom&&i==r.childNodes.length-1&&r.lastChild.nodeType==1&&e.top>r.lastChild.getBoundingClientRect().bottom?a=t.state.doc.content.size:(i==0||r.nodeType!=1||r.childNodes[i-1].nodeName!="BR")&&(a=aL(t,r,i,e))}a==null&&(a=sL(t,s,e));let l=t.docView.nearestDesc(s,!0);return{pos:a,inside:l?l.posAtStart-l.border:-1}}function pb(t){return t.top<t.bottom||t.left<t.right}function hi(t,e){let n=t.getClientRects();if(n.length){let r=n[e<0?0:n.length-1];if(pb(r))return r}return Array.prototype.find.call(n,pb)||t.getBoundingClientRect()}const cL=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function fT(t,e,n){let{node:r,offset:i,atom:o}=t.docView.domFromPos(e,n<0?-1:1),s=yu||nr;if(r.nodeType==3)if(s&&(cL.test(r.nodeValue)||(n<0?!i:i==r.nodeValue.length))){let l=hi(Fr(r,i,i),n);if(nr&&i&&/\s/.test(r.nodeValue[i-1])&&i<r.nodeValue.length){let c=hi(Fr(r,i-1,i-1),-1);if(c.top==l.top){let u=hi(Fr(r,i,i+1),-1);if(u.top!=l.top)return Pl(u,u.left<c.left)}}return l}else{let l=i,c=i,u=n<0?1:-1;return n<0&&!i?(c++,u=-1):n>=0&&i==r.nodeValue.length?(l--,u=1):n<0?l--:c++,Pl(hi(Fr(r,l,c),u),u<0)}if(!t.state.doc.resolve(e-(o||0)).parent.inlineContent){if(o==null&&i&&(n<0||i==Rn(r))){let l=r.childNodes[i-1];if(l.nodeType==1)return qp(l.getBoundingClientRect(),!1)}if(o==null&&i<Rn(r)){let l=r.childNodes[i];if(l.nodeType==1)return qp(l.getBoundingClientRect(),!0)}return qp(r.getBoundingClientRect(),n>=0)}if(o==null&&i&&(n<0||i==Rn(r))){let l=r.childNodes[i-1],c=l.nodeType==3?Fr(l,Rn(l)-(s?0:1)):l.nodeType==1&&(l.nodeName!="BR"||!l.nextSibling)?l:null;if(c)return Pl(hi(c,1),!1)}if(o==null&&i<Rn(r)){let l=r.childNodes[i];for(;l.pmViewDesc&&l.pmViewDesc.ignoreForCoords;)l=l.nextSibling;let c=l?l.nodeType==3?Fr(l,0,s?0:1):l.nodeType==1?l:null:null;if(c)return Pl(hi(c,-1),!0)}return Pl(hi(r.nodeType==3?Fr(r):r,-n),n>=0)}function Pl(t,e){if(t.width==0)return t;let n=e?t.left:t.right;return{top:t.top,bottom:t.bottom,left:n,right:n}}function qp(t,e){if(t.height==0)return t;let n=e?t.top:t.bottom;return{top:n,bottom:n,left:t.left,right:t.right}}function hT(t,e,n){let r=t.state,i=t.root.activeElement;r!=e&&t.updateState(e),i!=t.dom&&t.focus();try{return n()}finally{r!=e&&t.updateState(r),i!=t.dom&&i&&i.focus()}}function uL(t,e,n){let r=e.selection,i=n=="up"?r.$from:r.$to;return hT(t,e,()=>{let{node:o}=t.docView.domFromPos(i.pos,n=="up"?-1:1);for(;;){let a=t.docView.nearestDesc(o,!0);if(!a)break;if(a.node.isBlock){o=a.contentDOM||a.dom;break}o=a.dom.parentNode}let s=fT(t,i.pos,1);for(let a=o.firstChild;a;a=a.nextSibling){let l;if(a.nodeType==1)l=a.getClientRects();else if(a.nodeType==3)l=Fr(a,0,a.nodeValue.length).getClientRects();else continue;for(let c=0;c<l.length;c++){let u=l[c];if(u.bottom>u.top+1&&(n=="up"?s.top-u.top>(u.bottom-s.top)*2:u.bottom-s.bottom>(s.bottom-u.top)*2))return!1}}return!0})}const dL=/[\u0590-\u08ac]/;function fL(t,e,n){let{$head:r}=e.selection;if(!r.parent.isTextblock)return!1;let i=r.parentOffset,o=!i,s=i==r.parent.content.size,a=t.domSelection();return a?!dL.test(r.parent.textContent)||!a.modify?n=="left"||n=="backward"?o:s:hT(t,e,()=>{let{focusNode:l,focusOffset:c,anchorNode:u,anchorOffset:d}=t.domSelectionRange(),f=a.caretBidiLevel;a.modify("move",n,"character");let p=r.depth?t.docView.domAfterPos(r.before()):t.dom,{focusNode:m,focusOffset:g}=t.domSelectionRange(),v=m&&!p.contains(m.nodeType==1?m:m.parentNode)||l==m&&c==g;try{a.collapse(u,d),l&&(l!=u||c!=d)&&a.extend&&a.extend(l,c)}catch{}return f!=null&&(a.caretBidiLevel=f),v}):r.pos==r.start()||r.pos==r.end()}let mb=null,gb=null,yb=!1;function hL(t,e,n){return mb==e&&gb==n?yb:(mb=e,gb=n,yb=n=="up"||n=="down"?uL(t,e,n):fL(t,e,n))}const An=0,vb=1,$o=2,Rr=3;class vu{constructor(e,n,r,i){this.parent=e,this.children=n,this.dom=r,this.contentDOM=i,this.dirty=An,r.pmViewDesc=this}matchesWidget(e){return!1}matchesMark(e){return!1}matchesNode(e,n,r){return!1}matchesHack(e){return!1}parseRule(){return null}stopEvent(e){return!1}get size(){let e=0;for(let n=0;n<this.children.length;n++)e+=this.children[n].size;return e}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let e=0;e<this.children.length;e++)this.children[e].destroy()}posBeforeChild(e){for(let n=0,r=this.posAtStart;;n++){let i=this.children[n];if(i==e)return r;r+=i.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(e,n,r){if(this.contentDOM&&this.contentDOM.contains(e.nodeType==1?e:e.parentNode))if(r<0){let o,s;if(e==this.contentDOM)o=e.childNodes[n-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;o=e.previousSibling}for(;o&&!((s=o.pmViewDesc)&&s.parent==this);)o=o.previousSibling;return o?this.posBeforeChild(s)+s.size:this.posAtStart}else{let o,s;if(e==this.contentDOM)o=e.childNodes[n];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;o=e.nextSibling}for(;o&&!((s=o.pmViewDesc)&&s.parent==this);)o=o.nextSibling;return o?this.posBeforeChild(s):this.posAtEnd}let i;if(e==this.dom&&this.contentDOM)i=n>ct(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))i=e.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(n==0)for(let o=e;;o=o.parentNode){if(o==this.dom){i=!1;break}if(o.previousSibling)break}if(i==null&&n==e.childNodes.length)for(let o=e;;o=o.parentNode){if(o==this.dom){i=!0;break}if(o.nextSibling)break}}return i??r>0?this.posAtEnd:this.posAtStart}nearestDesc(e,n=!1){for(let r=!0,i=e;i;i=i.parentNode){let o=this.getDesc(i),s;if(o&&(!n||o.node))if(r&&(s=o.nodeDOM)&&!(s.nodeType==1?s.contains(e.nodeType==1?e:e.parentNode):s==e))r=!1;else return o}}getDesc(e){let n=e.pmViewDesc;for(let r=n;r;r=r.parent)if(r==this)return n}posFromDOM(e,n,r){for(let i=e;i;i=i.parentNode){let o=this.getDesc(i);if(o)return o.localPosFromDOM(e,n,r)}return-1}descAt(e){for(let n=0,r=0;n<this.children.length;n++){let i=this.children[n],o=r+i.size;if(r==e&&o!=r){for(;!i.border&&i.children.length;)for(let s=0;s<i.children.length;s++){let a=i.children[s];if(a.size){i=a;break}}return i}if(e<o)return i.descAt(e-r-i.border);r=o}}domFromPos(e,n){if(!this.contentDOM)return{node:this.dom,offset:0,atom:e+1};let r=0,i=0;for(let o=0;r<this.children.length;r++){let s=this.children[r],a=o+s.size;if(a>e||s instanceof mT){i=e-o;break}o=a}if(i)return this.children[r].domFromPos(i-this.children[r].border,n);for(let o;r&&!(o=this.children[r-1]).size&&o instanceof pT&&o.side>=0;r--);if(n<=0){let o,s=!0;for(;o=r?this.children[r-1]:null,!(!o||o.dom.parentNode==this.contentDOM);r--,s=!1);return o&&n&&s&&!o.border&&!o.domAtom?o.domFromPos(o.size,n):{node:this.contentDOM,offset:o?ct(o.dom)+1:0}}else{let o,s=!0;for(;o=r<this.children.length?this.children[r]:null,!(!o||o.dom.parentNode==this.contentDOM);r++,s=!1);return o&&s&&!o.border&&!o.domAtom?o.domFromPos(0,n):{node:this.contentDOM,offset:o?ct(o.dom):this.contentDOM.childNodes.length}}}parseRange(e,n,r=0){if(this.children.length==0)return{node:this.contentDOM,from:e,to:n,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let i=-1,o=-1;for(let s=r,a=0;;a++){let l=this.children[a],c=s+l.size;if(i==-1&&e<=c){let u=s+l.border;if(e>=u&&n<=c-l.border&&l.node&&l.contentDOM&&this.contentDOM.contains(l.contentDOM))return l.parseRange(e,n,u);e=s;for(let d=a;d>0;d--){let f=this.children[d-1];if(f.size&&f.dom.parentNode==this.contentDOM&&!f.emptyChildAt(1)){i=ct(f.dom)+1;break}e-=f.size}i==-1&&(i=0)}if(i>-1&&(c>n||a==this.children.length-1)){n=c;for(let u=a+1;u<this.children.length;u++){let d=this.children[u];if(d.size&&d.dom.parentNode==this.contentDOM&&!d.emptyChildAt(-1)){o=ct(d.dom);break}n+=d.size}o==-1&&(o=this.contentDOM.childNodes.length);break}s=c}return{node:this.contentDOM,from:e,to:n,fromOffset:i,toOffset:o}}emptyChildAt(e){if(this.border||!this.contentDOM||!this.children.length)return!1;let n=this.children[e<0?0:this.children.length-1];return n.size==0||n.emptyChildAt(e)}domAfterPos(e){let{node:n,offset:r}=this.domFromPos(e,0);if(n.nodeType!=1||r==n.childNodes.length)throw new RangeError("No node after pos "+e);return n.childNodes[r]}setSelection(e,n,r,i=!1){let o=Math.min(e,n),s=Math.max(e,n);for(let p=0,m=0;p<this.children.length;p++){let g=this.children[p],v=m+g.size;if(o>m&&s<v)return g.setSelection(e-m-g.border,n-m-g.border,r,i);m=v}let a=this.domFromPos(e,e?-1:1),l=n==e?a:this.domFromPos(n,n?-1:1),c=r.root.getSelection(),u=r.domSelectionRange(),d=!1;if((nr||At)&&e==n){let{node:p,offset:m}=a;if(p.nodeType==3){if(d=!!(m&&p.nodeValue[m-1]==`
`),d&&m==p.nodeValue.length)for(let g=p,v;g;g=g.parentNode){if(v=g.nextSibling){v.nodeName=="BR"&&(a=l={node:v.parentNode,offset:ct(v)+1});break}let x=g.pmViewDesc;if(x&&x.node&&x.node.isBlock)break}}else{let g=p.childNodes[m-1];d=g&&(g.nodeName=="BR"||g.contentEditable=="false")}}if(nr&&u.focusNode&&u.focusNode!=l.node&&u.focusNode.nodeType==1){let p=u.focusNode.childNodes[u.focusOffset];p&&p.contentEditable=="false"&&(i=!0)}if(!(i||d&&At)&&ms(a.node,a.offset,u.anchorNode,u.anchorOffset)&&ms(l.node,l.offset,u.focusNode,u.focusOffset))return;let f=!1;if((c.extend||e==n)&&!d){c.collapse(a.node,a.offset);try{e!=n&&c.extend(l.node,l.offset),f=!0}catch{}}if(!f){if(e>n){let m=a;a=l,l=m}let p=document.createRange();p.setEnd(l.node,l.offset),p.setStart(a.node,a.offset),c.removeAllRanges(),c.addRange(p)}}ignoreMutation(e){return!this.contentDOM&&e.type!="selection"}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(e,n){for(let r=0,i=0;i<this.children.length;i++){let o=this.children[i],s=r+o.size;if(r==s?e<=s&&n>=r:e<s&&n>r){let a=r+o.border,l=s-o.border;if(e>=a&&n<=l){this.dirty=e==r||n==s?$o:vb,e==a&&n==l&&(o.contentLost||o.dom.parentNode!=this.contentDOM)?o.dirty=Rr:o.markDirty(e-a,n-a);return}else o.dirty=o.dom==o.contentDOM&&o.dom.parentNode==this.contentDOM&&!o.children.length?$o:Rr}r=s}this.dirty=$o}markParentsDirty(){let e=1;for(let n=this.parent;n;n=n.parent,e++){let r=e==1?$o:vb;n.dirty<r&&(n.dirty=r)}}get domAtom(){return!1}get ignoreForCoords(){return!1}isText(e){return!1}}class pT extends vu{constructor(e,n,r,i){let o,s=n.type.toDOM;if(typeof s=="function"&&(s=s(r,()=>{if(!o)return i;if(o.parent)return o.parent.posBeforeChild(o)})),!n.type.spec.raw){if(s.nodeType!=1){let a=document.createElement("span");a.appendChild(s),s=a}s.contentEditable="false",s.classList.add("ProseMirror-widget")}super(e,[],s,null),this.widget=n,this.widget=n,o=this}matchesWidget(e){return this.dirty==An&&e.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(e){let n=this.widget.spec.stopEvent;return n?n(e):!1}ignoreMutation(e){return e.type!="selection"||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get side(){return this.widget.type.side}}class pL extends vu{constructor(e,n,r,i){super(e,[],n,null),this.textDOM=r,this.text=i}get size(){return this.text.length}localPosFromDOM(e,n){return e!=this.textDOM?this.posAtStart+(n?this.size:0):this.posAtStart+n}domFromPos(e){return{node:this.textDOM,offset:e}}ignoreMutation(e){return e.type==="characterData"&&e.target.nodeValue==e.oldValue}}class gs extends vu{constructor(e,n,r,i,o){super(e,[],r,i),this.mark=n,this.spec=o}static create(e,n,r,i){let o=i.nodeViews[n.type.name],s=o&&o(n,i,r);return(!s||!s.dom)&&(s=Es.renderSpec(document,n.type.spec.toDOM(n,r),null,n.attrs)),new gs(e,n,s.dom,s.contentDOM||s.dom,s)}parseRule(){return this.dirty&Rr||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(e){return this.dirty!=Rr&&this.mark.eq(e)}markDirty(e,n){if(super.markDirty(e,n),this.dirty!=An){let r=this.parent;for(;!r.node;)r=r.parent;r.dirty<this.dirty&&(r.dirty=this.dirty),this.dirty=An}}slice(e,n,r){let i=gs.create(this.parent,this.mark,!0,r),o=this.children,s=this.size;n<s&&(o=iy(o,n,s,r)),e>0&&(o=iy(o,0,e,r));for(let a=0;a<o.length;a++)o[a].parent=i;return i.children=o,i}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}}class Yi extends vu{constructor(e,n,r,i,o,s,a,l,c){super(e,[],o,s),this.node=n,this.outerDeco=r,this.innerDeco=i,this.nodeDOM=a}static create(e,n,r,i,o,s){let a=o.nodeViews[n.type.name],l,c=a&&a(n,o,()=>{if(!l)return s;if(l.parent)return l.parent.posBeforeChild(l)},r,i),u=c&&c.dom,d=c&&c.contentDOM;if(n.isText){if(!u)u=document.createTextNode(n.text);else if(u.nodeType!=3)throw new RangeError("Text must be rendered as a DOM text node")}else u||({dom:u,contentDOM:d}=Es.renderSpec(document,n.type.spec.toDOM(n),null,n.attrs));!d&&!n.isText&&u.nodeName!="BR"&&(u.hasAttribute("contenteditable")||(u.contentEditable="false"),n.type.spec.draggable&&(u.draggable=!0));let f=u;return u=vT(u,r,n),c?l=new mL(e,n,r,i,u,d||null,f,c,o,s+1):n.isText?new Oh(e,n,r,i,u,f,o):new Yi(e,n,r,i,u,d||null,f,o,s+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let e={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre"&&(e.preserveWhitespace="full"),!this.contentDOM)e.getContent=()=>this.node.content;else if(!this.contentLost)e.contentElement=this.contentDOM;else{for(let n=this.children.length-1;n>=0;n--){let r=this.children[n];if(this.dom.contains(r.dom.parentNode)){e.contentElement=r.dom.parentNode;break}}e.contentElement||(e.getContent=()=>j.empty)}return e}matchesNode(e,n,r){return this.dirty==An&&e.eq(this.node)&&Rf(n,this.outerDeco)&&r.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(e,n){let r=this.node.inlineContent,i=n,o=e.composing?this.localCompositionInfo(e,n):null,s=o&&o.pos>-1?o:null,a=o&&o.pos<0,l=new yL(this,s&&s.node,e);wL(this.node,this.innerDeco,(c,u,d)=>{c.spec.marks?l.syncToMarks(c.spec.marks,r,e):c.type.side>=0&&!d&&l.syncToMarks(u==this.node.childCount?Se.none:this.node.child(u).marks,r,e),l.placeWidget(c,e,i)},(c,u,d,f)=>{l.syncToMarks(c.marks,r,e);let p;l.findNodeMatch(c,u,d,f)||a&&e.state.selection.from>i&&e.state.selection.to<i+c.nodeSize&&(p=l.findIndexWithChild(o.node))>-1&&l.updateNodeAt(c,u,d,p,e)||l.updateNextNode(c,u,d,e,f,i)||l.addNode(c,u,d,e,i),i+=c.nodeSize}),l.syncToMarks([],r,e),this.node.isTextblock&&l.addTextblockHacks(),l.destroyRest(),(l.changed||this.dirty==$o)&&(s&&this.protectLocalComposition(e,s),gT(this.contentDOM,this.children,e),Ka&&bL(this.dom))}localCompositionInfo(e,n){let{from:r,to:i}=e.state.selection;if(!(e.state.selection instanceof ie)||r<n||i>n+this.node.content.size)return null;let o=e.input.compositionNode;if(!o||!this.dom.contains(o.parentNode))return null;if(this.node.inlineContent){let s=o.nodeValue,a=SL(this.node.content,s,r-n,i-n);return a<0?null:{node:o,pos:a,text:s}}else return{node:o,pos:-1,text:""}}protectLocalComposition(e,{node:n,pos:r,text:i}){if(this.getDesc(n))return;let o=n;for(;o.parentNode!=this.contentDOM;o=o.parentNode){for(;o.previousSibling;)o.parentNode.removeChild(o.previousSibling);for(;o.nextSibling;)o.parentNode.removeChild(o.nextSibling);o.pmViewDesc&&(o.pmViewDesc=void 0)}let s=new pL(this,o,n,i);e.input.compositionNodes.push(s),this.children=iy(this.children,r,r+i.length,e,s)}update(e,n,r,i){return this.dirty==Rr||!e.sameMarkup(this.node)?!1:(this.updateInner(e,n,r,i),!0)}updateInner(e,n,r,i){this.updateOuterDeco(n),this.node=e,this.innerDeco=r,this.contentDOM&&this.updateChildren(i,this.posAtStart),this.dirty=An}updateOuterDeco(e){if(Rf(e,this.outerDeco))return;let n=this.nodeDOM.nodeType!=1,r=this.dom;this.dom=yT(this.dom,this.nodeDOM,ry(this.outerDeco,this.node,n),ry(e,this.node,n)),this.dom!=r&&(r.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=e}selectNode(){this.nodeDOM.nodeType==1&&this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.dom.draggable=!0)}deselectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.dom.removeAttribute("draggable"))}get domAtom(){return this.node.isAtom}}function xb(t,e,n,r,i){vT(r,e,t);let o=new Yi(void 0,t,e,n,r,r,r,i,0);return o.contentDOM&&o.updateChildren(i,0),o}class Oh extends Yi{constructor(e,n,r,i,o,s,a){super(e,n,r,i,o,null,s,a,0)}parseRule(){let e=this.nodeDOM.parentNode;for(;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}}update(e,n,r,i){return this.dirty==Rr||this.dirty!=An&&!this.inParent()||!e.sameMarkup(this.node)?!1:(this.updateOuterDeco(n),(this.dirty!=An||e.text!=this.node.text)&&e.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=e.text,i.trackWrites==this.nodeDOM&&(i.trackWrites=null)),this.node=e,this.dirty=An,!0)}inParent(){let e=this.parent.contentDOM;for(let n=this.nodeDOM;n;n=n.parentNode)if(n==e)return!0;return!1}domFromPos(e){return{node:this.nodeDOM,offset:e}}localPosFromDOM(e,n,r){return e==this.nodeDOM?this.posAtStart+Math.min(n,this.node.text.length):super.localPosFromDOM(e,n,r)}ignoreMutation(e){return e.type!="characterData"&&e.type!="selection"}slice(e,n,r){let i=this.node.cut(e,n),o=document.createTextNode(i.text);return new Oh(this.parent,i,this.outerDeco,this.innerDeco,o,o,r)}markDirty(e,n){super.markDirty(e,n),this.dom!=this.nodeDOM&&(e==0||n==this.nodeDOM.nodeValue.length)&&(this.dirty=Rr)}get domAtom(){return!1}isText(e){return this.node.text==e}}class mT extends vu{parseRule(){return{ignore:!0}}matchesHack(e){return this.dirty==An&&this.dom.nodeName==e}get domAtom(){return!0}get ignoreForCoords(){return this.dom.nodeName=="IMG"}}class mL extends Yi{constructor(e,n,r,i,o,s,a,l,c,u){super(e,n,r,i,o,s,a,c,u),this.spec=l}update(e,n,r,i){if(this.dirty==Rr)return!1;if(this.spec.update&&(this.node.type==e.type||this.spec.multiType)){let o=this.spec.update(e,n,r);return o&&this.updateInner(e,n,r,i),o}else return!this.contentDOM&&!e.isLeaf?!1:super.update(e,n,r,i)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(e,n,r,i){this.spec.setSelection?this.spec.setSelection(e,n,r.root):super.setSelection(e,n,r,i)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(e){return this.spec.stopEvent?this.spec.stopEvent(e):!1}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}}function gT(t,e,n){let r=t.firstChild,i=!1;for(let o=0;o<e.length;o++){let s=e[o],a=s.dom;if(a.parentNode==t){for(;a!=r;)r=wb(r),i=!0;r=r.nextSibling}else i=!0,t.insertBefore(a,r);if(s instanceof gs){let l=r?r.previousSibling:t.lastChild;gT(s.contentDOM,s.children,n),r=l?l.nextSibling:t.firstChild}}for(;r;)r=wb(r),i=!0;i&&n.trackWrites==t&&(n.trackWrites=null)}const rc=function(t){t&&(this.nodeName=t)};rc.prototype=Object.create(null);const Fo=[new rc];function ry(t,e,n){if(t.length==0)return Fo;let r=n?Fo[0]:new rc,i=[r];for(let o=0;o<t.length;o++){let s=t[o].type.attrs;if(s){s.nodeName&&i.push(r=new rc(s.nodeName));for(let a in s){let l=s[a];l!=null&&(n&&i.length==1&&i.push(r=new rc(e.isInline?"span":"div")),a=="class"?r.class=(r.class?r.class+" ":"")+l:a=="style"?r.style=(r.style?r.style+";":"")+l:a!="nodeName"&&(r[a]=l))}}}return i}function yT(t,e,n,r){if(n==Fo&&r==Fo)return e;let i=e;for(let o=0;o<r.length;o++){let s=r[o],a=n[o];if(o){let l;a&&a.nodeName==s.nodeName&&i!=t&&(l=i.parentNode)&&l.nodeName.toLowerCase()==s.nodeName||(l=document.createElement(s.nodeName),l.pmIsDeco=!0,l.appendChild(i),a=Fo[0]),i=l}gL(i,a||Fo[0],s)}return i}function gL(t,e,n){for(let r in e)r!="class"&&r!="style"&&r!="nodeName"&&!(r in n)&&t.removeAttribute(r);for(let r in n)r!="class"&&r!="style"&&r!="nodeName"&&n[r]!=e[r]&&t.setAttribute(r,n[r]);if(e.class!=n.class){let r=e.class?e.class.split(" ").filter(Boolean):[],i=n.class?n.class.split(" ").filter(Boolean):[];for(let o=0;o<r.length;o++)i.indexOf(r[o])==-1&&t.classList.remove(r[o]);for(let o=0;o<i.length;o++)r.indexOf(i[o])==-1&&t.classList.add(i[o]);t.classList.length==0&&t.removeAttribute("class")}if(e.style!=n.style){if(e.style){let r=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,i;for(;i=r.exec(e.style);)t.style.removeProperty(i[1])}n.style&&(t.style.cssText+=n.style)}}function vT(t,e,n){return yT(t,t,Fo,ry(e,n,t.nodeType!=1))}function Rf(t,e){if(t.length!=e.length)return!1;for(let n=0;n<t.length;n++)if(!t[n].type.eq(e[n].type))return!1;return!0}function wb(t){let e=t.nextSibling;return t.parentNode.removeChild(t),e}class yL{constructor(e,n,r){this.lock=n,this.view=r,this.index=0,this.stack=[],this.changed=!1,this.top=e,this.preMatch=vL(e.node.content,e)}destroyBetween(e,n){if(e!=n){for(let r=e;r<n;r++)this.top.children[r].destroy();this.top.children.splice(e,n-e),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(e,n,r){let i=0,o=this.stack.length>>1,s=Math.min(o,e.length);for(;i<s&&(i==o-1?this.top:this.stack[i+1<<1]).matchesMark(e[i])&&e[i].type.spec.spanning!==!1;)i++;for(;i<o;)this.destroyRest(),this.top.dirty=An,this.index=this.stack.pop(),this.top=this.stack.pop(),o--;for(;o<e.length;){this.stack.push(this.top,this.index+1);let a=-1;for(let l=this.index;l<Math.min(this.index+3,this.top.children.length);l++){let c=this.top.children[l];if(c.matchesMark(e[o])&&!this.isLocked(c.dom)){a=l;break}}if(a>-1)a>this.index&&(this.changed=!0,this.destroyBetween(this.index,a)),this.top=this.top.children[this.index];else{let l=gs.create(this.top,e[o],n,r);this.top.children.splice(this.index,0,l),this.top=l,this.changed=!0}this.index=0,o++}}findNodeMatch(e,n,r,i){let o=-1,s;if(i>=this.preMatch.index&&(s=this.preMatch.matches[i-this.preMatch.index]).parent==this.top&&s.matchesNode(e,n,r))o=this.top.children.indexOf(s,this.index);else for(let a=this.index,l=Math.min(this.top.children.length,a+5);a<l;a++){let c=this.top.children[a];if(c.matchesNode(e,n,r)&&!this.preMatch.matched.has(c)){o=a;break}}return o<0?!1:(this.destroyBetween(this.index,o),this.index++,!0)}updateNodeAt(e,n,r,i,o){let s=this.top.children[i];return s.dirty==Rr&&s.dom==s.contentDOM&&(s.dirty=$o),s.update(e,n,r,o)?(this.destroyBetween(this.index,i),this.index++,!0):!1}findIndexWithChild(e){for(;;){let n=e.parentNode;if(!n)return-1;if(n==this.top.contentDOM){let r=e.pmViewDesc;if(r){for(let i=this.index;i<this.top.children.length;i++)if(this.top.children[i]==r)return i}return-1}e=n}}updateNextNode(e,n,r,i,o,s){for(let a=this.index;a<this.top.children.length;a++){let l=this.top.children[a];if(l instanceof Yi){let c=this.preMatch.matched.get(l);if(c!=null&&c!=o)return!1;let u=l.dom,d,f=this.isLocked(u)&&!(e.isText&&l.node&&l.node.isText&&l.nodeDOM.nodeValue==e.text&&l.dirty!=Rr&&Rf(n,l.outerDeco));if(!f&&l.update(e,n,r,i))return this.destroyBetween(this.index,a),l.dom!=u&&(this.changed=!0),this.index++,!0;if(!f&&(d=this.recreateWrapper(l,e,n,r,i,s)))return this.destroyBetween(this.index,a),this.top.children[this.index]=d,d.contentDOM&&(d.dirty=$o,d.updateChildren(i,s+1),d.dirty=An),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(e,n,r,i,o,s){if(e.dirty||n.isAtom||!e.children.length||!e.node.content.eq(n.content)||!Rf(r,e.outerDeco)||!i.eq(e.innerDeco))return null;let a=Yi.create(this.top,n,r,i,o,s);if(a.contentDOM){a.children=e.children,e.children=[];for(let l of a.children)l.parent=a}return e.destroy(),a}addNode(e,n,r,i,o){let s=Yi.create(this.top,e,n,r,i,o);s.contentDOM&&s.updateChildren(i,o+1),this.top.children.splice(this.index++,0,s),this.changed=!0}placeWidget(e,n,r){let i=this.index<this.top.children.length?this.top.children[this.index]:null;if(i&&i.matchesWidget(e)&&(e==i.widget||!i.widget.type.toDOM.parentNode))this.index++;else{let o=new pT(this.top,e,n,r);this.top.children.splice(this.index++,0,o),this.changed=!0}}addTextblockHacks(){let e=this.top.children[this.index-1],n=this.top;for(;e instanceof gs;)n=e,e=n.children[n.children.length-1];(!e||!(e instanceof Oh)||/\n$/.test(e.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(e.node.text))&&((At||bt)&&e&&e.dom.contentEditable=="false"&&this.addHackNode("IMG",n),this.addHackNode("BR",this.top))}addHackNode(e,n){if(n==this.top&&this.index<n.children.length&&n.children[this.index].matchesHack(e))this.index++;else{let r=document.createElement(e);e=="IMG"&&(r.className="ProseMirror-separator",r.alt=""),e=="BR"&&(r.className="ProseMirror-trailingBreak");let i=new mT(this.top,[],r,null);n!=this.top?n.children.push(i):n.children.splice(this.index++,0,i),this.changed=!0}}isLocked(e){return this.lock&&(e==this.lock||e.nodeType==1&&e.contains(this.lock.parentNode))}}function vL(t,e){let n=e,r=n.children.length,i=t.childCount,o=new Map,s=[];e:for(;i>0;){let a;for(;;)if(r){let c=n.children[r-1];if(c instanceof gs)n=c,r=c.children.length;else{a=c,r--;break}}else{if(n==e)break e;r=n.parent.children.indexOf(n),n=n.parent}let l=a.node;if(l){if(l!=t.child(i-1))break;--i,o.set(a,i),s.push(a)}}return{index:i,matched:o,matches:s.reverse()}}function xL(t,e){return t.type.side-e.type.side}function wL(t,e,n,r){let i=e.locals(t),o=0;if(i.length==0){for(let c=0;c<t.childCount;c++){let u=t.child(c);r(u,i,e.forChild(o,u),c),o+=u.nodeSize}return}let s=0,a=[],l=null;for(let c=0;;){let u,d;for(;s<i.length&&i[s].to==o;){let v=i[s++];v.widget&&(u?(d||(d=[u])).push(v):u=v)}if(u)if(d){d.sort(xL);for(let v=0;v<d.length;v++)n(d[v],c,!!l)}else n(u,c,!!l);let f,p;if(l)p=-1,f=l,l=null;else if(c<t.childCount)p=c,f=t.child(c++);else break;for(let v=0;v<a.length;v++)a[v].to<=o&&a.splice(v--,1);for(;s<i.length&&i[s].from<=o&&i[s].to>o;)a.push(i[s++]);let m=o+f.nodeSize;if(f.isText){let v=m;s<i.length&&i[s].from<v&&(v=i[s].from);for(let x=0;x<a.length;x++)a[x].to<v&&(v=a[x].to);v<m&&(l=f.cut(v-o),f=f.cut(0,v-o),m=v,p=-1)}else for(;s<i.length&&i[s].to<m;)s++;let g=f.isInline&&!f.isLeaf?a.filter(v=>!v.inline):a.slice();r(f,g,e.forChild(o,f),p),o=m}}function bL(t){if(t.nodeName=="UL"||t.nodeName=="OL"){let e=t.style.cssText;t.style.cssText=e+"; list-style: square !important",window.getComputedStyle(t).listStyle,t.style.cssText=e}}function SL(t,e,n,r){for(let i=0,o=0;i<t.childCount&&o<=r;){let s=t.child(i++),a=o;if(o+=s.nodeSize,!s.isText)continue;let l=s.text;for(;i<t.childCount;){let c=t.child(i++);if(o+=c.nodeSize,!c.isText)break;l+=c.text}if(o>=n){if(o>=r&&l.slice(r-e.length-a,r-a)==e)return r-e.length;let c=a<r?l.lastIndexOf(e,r-a-1):-1;if(c>=0&&c+e.length+a>=n)return a+c;if(n==r&&l.length>=r+e.length-a&&l.slice(r-a,r-a+e.length)==e)return r}}return-1}function iy(t,e,n,r,i){let o=[];for(let s=0,a=0;s<t.length;s++){let l=t[s],c=a,u=a+=l.size;c>=n||u<=e?o.push(l):(c<e&&o.push(l.slice(0,e-c,r)),i&&(o.push(i),i=void 0),u>n&&o.push(l.slice(n-c,l.size,r)))}return o}function t0(t,e=null){let n=t.domSelectionRange(),r=t.state.doc;if(!n.focusNode)return null;let i=t.docView.nearestDesc(n.focusNode),o=i&&i.size==0,s=t.docView.posFromDOM(n.focusNode,n.focusOffset,1);if(s<0)return null;let a=r.resolve(s),l,c;if(Rh(n)){for(l=s;i&&!i.node;)i=i.parent;let d=i.node;if(i&&d.isAtom&&X.isSelectable(d)&&i.parent&&!(d.isInline&&Gj(n.focusNode,n.focusOffset,i.dom))){let f=i.posBefore;c=new X(s==f?a:r.resolve(f))}}else{if(n instanceof t.dom.ownerDocument.defaultView.Selection&&n.rangeCount>1){let d=s,f=s;for(let p=0;p<n.rangeCount;p++){let m=n.getRangeAt(p);d=Math.min(d,t.docView.posFromDOM(m.startContainer,m.startOffset,1)),f=Math.max(f,t.docView.posFromDOM(m.endContainer,m.endOffset,-1))}if(d<0)return null;[l,s]=f==t.state.selection.anchor?[f,d]:[d,f],a=r.resolve(s)}else l=t.docView.posFromDOM(n.anchorNode,n.anchorOffset,1);if(l<0)return null}let u=r.resolve(l);if(!c){let d=e=="pointer"||t.state.selection.head<a.pos&&!o?1:-1;c=n0(t,u,a,d)}return c}function xT(t){return t.editable?t.hasFocus():bT(t)&&document.activeElement&&document.activeElement.contains(t.dom)}function Jr(t,e=!1){let n=t.state.selection;if(wT(t,n),!!xT(t)){if(!e&&t.input.mouseDown&&t.input.mouseDown.allowDefault&&bt){let r=t.domSelectionRange(),i=t.domObserver.currentSelection;if(r.anchorNode&&i.anchorNode&&ms(r.anchorNode,r.anchorOffset,i.anchorNode,i.anchorOffset)){t.input.mouseDown.delayedSelectionSync=!0,t.domObserver.setCurSelection();return}}if(t.domObserver.disconnectSelection(),t.cursorWrapper)kL(t);else{let{anchor:r,head:i}=n,o,s;bb&&!(n instanceof ie)&&(n.$from.parent.inlineContent||(o=Sb(t,n.from)),!n.empty&&!n.$from.parent.inlineContent&&(s=Sb(t,n.to))),t.docView.setSelection(r,i,t,e),bb&&(o&&Cb(o),s&&Cb(s)),n.visible?t.dom.classList.remove("ProseMirror-hideselection"):(t.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&CL(t))}t.domObserver.setCurSelection(),t.domObserver.connectSelection()}}const bb=At||bt&&aT<63;function Sb(t,e){let{node:n,offset:r}=t.docView.domFromPos(e,0),i=r<n.childNodes.length?n.childNodes[r]:null,o=r?n.childNodes[r-1]:null;if(At&&i&&i.contentEditable=="false")return Gp(i);if((!i||i.contentEditable=="false")&&(!o||o.contentEditable=="false")){if(i)return Gp(i);if(o)return Gp(o)}}function Gp(t){return t.contentEditable="true",At&&t.draggable&&(t.draggable=!1,t.wasDraggable=!0),t}function Cb(t){t.contentEditable="false",t.wasDraggable&&(t.draggable=!0,t.wasDraggable=null)}function CL(t){let e=t.dom.ownerDocument;e.removeEventListener("selectionchange",t.input.hideSelectionGuard);let n=t.domSelectionRange(),r=n.anchorNode,i=n.anchorOffset;e.addEventListener("selectionchange",t.input.hideSelectionGuard=()=>{(n.anchorNode!=r||n.anchorOffset!=i)&&(e.removeEventListener("selectionchange",t.input.hideSelectionGuard),setTimeout(()=>{(!xT(t)||t.state.selection.visible)&&t.dom.classList.remove("ProseMirror-hideselection")},20))})}function kL(t){let e=t.domSelection(),n=document.createRange();if(!e)return;let r=t.cursorWrapper.dom,i=r.nodeName=="IMG";i?n.setStart(r.parentNode,ct(r)+1):n.setStart(r,0),n.collapse(!0),e.removeAllRanges(),e.addRange(n),!i&&!t.state.selection.visible&&nn&&Ji<=11&&(r.disabled=!0,r.disabled=!1)}function wT(t,e){if(e instanceof X){let n=t.docView.descAt(e.from);n!=t.lastSelectedViewDesc&&(kb(t),n&&n.selectNode(),t.lastSelectedViewDesc=n)}else kb(t)}function kb(t){t.lastSelectedViewDesc&&(t.lastSelectedViewDesc.parent&&t.lastSelectedViewDesc.deselectNode(),t.lastSelectedViewDesc=void 0)}function n0(t,e,n,r){return t.someProp("createSelectionBetween",i=>i(t,e,n))||ie.between(e,n,r)}function Eb(t){return t.editable&&!t.hasFocus()?!1:bT(t)}function bT(t){let e=t.domSelectionRange();if(!e.anchorNode)return!1;try{return t.dom.contains(e.anchorNode.nodeType==3?e.anchorNode.parentNode:e.anchorNode)&&(t.editable||t.dom.contains(e.focusNode.nodeType==3?e.focusNode.parentNode:e.focusNode))}catch{return!1}}function EL(t){let e=t.docView.domFromPos(t.state.selection.anchor,0),n=t.domSelectionRange();return ms(e.node,e.offset,n.anchorNode,n.anchorOffset)}function oy(t,e){let{$anchor:n,$head:r}=t.selection,i=e>0?n.max(r):n.min(r),o=i.parent.inlineContent?i.depth?t.doc.resolve(e>0?i.after():i.before()):null:i;return o&&oe.findFrom(o,e)}function vi(t,e){return t.dispatch(t.state.tr.setSelection(e).scrollIntoView()),!0}function Tb(t,e,n){let r=t.state.selection;if(r instanceof ie)if(n.indexOf("s")>-1){let{$head:i}=r,o=i.textOffset?null:e<0?i.nodeBefore:i.nodeAfter;if(!o||o.isText||!o.isLeaf)return!1;let s=t.state.doc.resolve(i.pos+o.nodeSize*(e<0?-1:1));return vi(t,new ie(r.$anchor,s))}else if(r.empty){if(t.endOfTextblock(e>0?"forward":"backward")){let i=oy(t.state,e);return i&&i instanceof X?vi(t,i):!1}else if(!(En&&n.indexOf("m")>-1)){let i=r.$head,o=i.textOffset?null:e<0?i.nodeBefore:i.nodeAfter,s;if(!o||o.isText)return!1;let a=e<0?i.pos-o.nodeSize:i.pos;return o.isAtom||(s=t.docView.descAt(a))&&!s.contentDOM?X.isSelectable(o)?vi(t,new X(e<0?t.state.doc.resolve(i.pos-o.nodeSize):i)):yu?vi(t,new ie(t.state.doc.resolve(e<0?a:a+o.nodeSize))):!1:!1}}else return!1;else{if(r instanceof X&&r.node.isInline)return vi(t,new ie(e>0?r.$to:r.$from));{let i=oy(t.state,e);return i?vi(t,i):!1}}}function Of(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function ic(t,e){let n=t.pmViewDesc;return n&&n.size==0&&(e<0||t.nextSibling||t.nodeName!="BR")}function Ls(t,e){return e<0?TL(t):_L(t)}function TL(t){let e=t.domSelectionRange(),n=e.focusNode,r=e.focusOffset;if(!n)return;let i,o,s=!1;for(nr&&n.nodeType==1&&r<Of(n)&&ic(n.childNodes[r],-1)&&(s=!0);;)if(r>0){if(n.nodeType!=1)break;{let a=n.childNodes[r-1];if(ic(a,-1))i=n,o=--r;else if(a.nodeType==3)n=a,r=n.nodeValue.length;else break}}else{if(ST(n))break;{let a=n.previousSibling;for(;a&&ic(a,-1);)i=n.parentNode,o=ct(a),a=a.previousSibling;if(a)n=a,r=Of(n);else{if(n=n.parentNode,n==t.dom)break;r=0}}}s?sy(t,n,r):i&&sy(t,i,o)}function _L(t){let e=t.domSelectionRange(),n=e.focusNode,r=e.focusOffset;if(!n)return;let i=Of(n),o,s;for(;;)if(r<i){if(n.nodeType!=1)break;let a=n.childNodes[r];if(ic(a,1))o=n,s=++r;else break}else{if(ST(n))break;{let a=n.nextSibling;for(;a&&ic(a,1);)o=a.parentNode,s=ct(a)+1,a=a.nextSibling;if(a)n=a,r=0,i=Of(n);else{if(n=n.parentNode,n==t.dom)break;r=i=0}}}o&&sy(t,o,s)}function ST(t){let e=t.pmViewDesc;return e&&e.node&&e.node.isBlock}function RL(t,e){for(;t&&e==t.childNodes.length&&!gu(t);)e=ct(t)+1,t=t.parentNode;for(;t&&e<t.childNodes.length;){let n=t.childNodes[e];if(n.nodeType==3)return n;if(n.nodeType==1&&n.contentEditable=="false")break;t=n,e=0}}function OL(t,e){for(;t&&!e&&!gu(t);)e=ct(t),t=t.parentNode;for(;t&&e;){let n=t.childNodes[e-1];if(n.nodeType==3)return n;if(n.nodeType==1&&n.contentEditable=="false")break;t=n,e=t.childNodes.length}}function sy(t,e,n){if(e.nodeType!=3){let o,s;(s=RL(e,n))?(e=s,n=0):(o=OL(e,n))&&(e=o,n=o.nodeValue.length)}let r=t.domSelection();if(!r)return;if(Rh(r)){let o=document.createRange();o.setEnd(e,n),o.setStart(e,n),r.removeAllRanges(),r.addRange(o)}else r.extend&&r.extend(e,n);t.domObserver.setCurSelection();let{state:i}=t;setTimeout(()=>{t.state==i&&Jr(t)},50)}function _b(t,e){let n=t.state.doc.resolve(e);if(!(bt||Qj)&&n.parent.inlineContent){let i=t.coordsAtPos(e);if(e>n.start()){let o=t.coordsAtPos(e-1),s=(o.top+o.bottom)/2;if(s>i.top&&s<i.bottom&&Math.abs(o.left-i.left)>1)return o.left<i.left?"ltr":"rtl"}if(e<n.end()){let o=t.coordsAtPos(e+1),s=(o.top+o.bottom)/2;if(s>i.top&&s<i.bottom&&Math.abs(o.left-i.left)>1)return o.left>i.left?"ltr":"rtl"}}return getComputedStyle(t.dom).direction=="rtl"?"rtl":"ltr"}function Rb(t,e,n){let r=t.state.selection;if(r instanceof ie&&!r.empty||n.indexOf("s")>-1||En&&n.indexOf("m")>-1)return!1;let{$from:i,$to:o}=r;if(!i.parent.inlineContent||t.endOfTextblock(e<0?"up":"down")){let s=oy(t.state,e);if(s&&s instanceof X)return vi(t,s)}if(!i.parent.inlineContent){let s=e<0?i:o,a=r instanceof Mn?oe.near(s,e):oe.findFrom(s,e);return a?vi(t,a):!1}return!1}function Ob(t,e){if(!(t.state.selection instanceof ie))return!0;let{$head:n,$anchor:r,empty:i}=t.state.selection;if(!n.sameParent(r))return!0;if(!i)return!1;if(t.endOfTextblock(e>0?"forward":"backward"))return!0;let o=!n.textOffset&&(e<0?n.nodeBefore:n.nodeAfter);if(o&&!o.isText){let s=t.state.tr;return e<0?s.delete(n.pos-o.nodeSize,n.pos):s.delete(n.pos,n.pos+o.nodeSize),t.dispatch(s),!0}return!1}function Pb(t,e,n){t.domObserver.stop(),e.contentEditable=n,t.domObserver.start()}function PL(t){if(!At||t.state.selection.$head.parentOffset>0)return!1;let{focusNode:e,focusOffset:n}=t.domSelectionRange();if(e&&e.nodeType==1&&n==0&&e.firstChild&&e.firstChild.contentEditable=="false"){let r=e.firstChild;Pb(t,r,"true"),setTimeout(()=>Pb(t,r,"false"),20)}return!1}function ML(t){let e="";return t.ctrlKey&&(e+="c"),t.metaKey&&(e+="m"),t.altKey&&(e+="a"),t.shiftKey&&(e+="s"),e}function AL(t,e){let n=e.keyCode,r=ML(e);if(n==8||En&&n==72&&r=="c")return Ob(t,-1)||Ls(t,-1);if(n==46&&!e.shiftKey||En&&n==68&&r=="c")return Ob(t,1)||Ls(t,1);if(n==13||n==27)return!0;if(n==37||En&&n==66&&r=="c"){let i=n==37?_b(t,t.state.selection.from)=="ltr"?-1:1:-1;return Tb(t,i,r)||Ls(t,i)}else if(n==39||En&&n==70&&r=="c"){let i=n==39?_b(t,t.state.selection.from)=="ltr"?1:-1:1;return Tb(t,i,r)||Ls(t,i)}else{if(n==38||En&&n==80&&r=="c")return Rb(t,-1,r)||Ls(t,-1);if(n==40||En&&n==78&&r=="c")return PL(t)||Rb(t,1,r)||Ls(t,1);if(r==(En?"m":"c")&&(n==66||n==73||n==89||n==90))return!0}return!1}function r0(t,e){t.someProp("transformCopied",p=>{e=p(e,t)});let n=[],{content:r,openStart:i,openEnd:o}=e;for(;i>1&&o>1&&r.childCount==1&&r.firstChild.childCount==1;){i--,o--;let p=r.firstChild;n.push(p.type.name,p.attrs!=p.type.defaultAttrs?p.attrs:null),r=p.content}let s=t.someProp("clipboardSerializer")||Es.fromSchema(t.state.schema),a=RT(),l=a.createElement("div");l.appendChild(s.serializeFragment(r,{document:a}));let c=l.firstChild,u,d=0;for(;c&&c.nodeType==1&&(u=_T[c.nodeName.toLowerCase()]);){for(let p=u.length-1;p>=0;p--){let m=a.createElement(u[p]);for(;l.firstChild;)m.appendChild(l.firstChild);l.appendChild(m),d++}c=l.firstChild}c&&c.nodeType==1&&c.setAttribute("data-pm-slice",`${i} ${o}${d?` -${d}`:""} ${JSON.stringify(n)}`);let f=t.someProp("clipboardTextSerializer",p=>p(e,t))||e.content.textBetween(0,e.content.size,`

`);return{dom:l,text:f,slice:e}}function CT(t,e,n,r,i){let o=i.parent.type.spec.code,s,a;if(!n&&!e)return null;let l=e&&(r||o||!n);if(l){if(t.someProp("transformPastedText",f=>{e=f(e,o||r,t)}),o)return e?new V(j.from(t.state.schema.text(e.replace(/\r\n?/g,`
`))),0,0):V.empty;let d=t.someProp("clipboardTextParser",f=>f(e,i,r,t));if(d)a=d;else{let f=i.marks(),{schema:p}=t.state,m=Es.fromSchema(p);s=document.createElement("div"),e.split(/(?:\r\n?|\n)+/).forEach(g=>{let v=s.appendChild(document.createElement("p"));g&&v.appendChild(m.serializeNode(p.text(g,f)))})}}else t.someProp("transformPastedHTML",d=>{n=d(n,t)}),s=jL(n),yu&&LL(s);let c=s&&s.querySelector("[data-pm-slice]"),u=c&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(c.getAttribute("data-pm-slice")||"");if(u&&u[3])for(let d=+u[3];d>0;d--){let f=s.firstChild;for(;f&&f.nodeType!=1;)f=f.nextSibling;if(!f)break;s=f}if(a||(a=(t.someProp("clipboardParser")||t.someProp("domParser")||Gi.fromSchema(t.state.schema)).parseSlice(s,{preserveWhitespace:!!(l||u),context:i,ruleFromNode(f){return f.nodeName=="BR"&&!f.nextSibling&&f.parentNode&&!DL.test(f.parentNode.nodeName)?{ignore:!0}:null}})),u)a=$L(Mb(a,+u[1],+u[2]),u[4]);else if(a=V.maxOpen(IL(a.content,i),!0),a.openStart||a.openEnd){let d=0,f=0;for(let p=a.content.firstChild;d<a.openStart&&!p.type.spec.isolating;d++,p=p.firstChild);for(let p=a.content.lastChild;f<a.openEnd&&!p.type.spec.isolating;f++,p=p.lastChild);a=Mb(a,d,f)}return t.someProp("transformPasted",d=>{a=d(a,t)}),a}const DL=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function IL(t,e){if(t.childCount<2)return t;for(let n=e.depth;n>=0;n--){let i=e.node(n).contentMatchAt(e.index(n)),o,s=[];if(t.forEach(a=>{if(!s)return;let l=i.findWrapping(a.type),c;if(!l)return s=null;if(c=s.length&&o.length&&ET(l,o,a,s[s.length-1],0))s[s.length-1]=c;else{s.length&&(s[s.length-1]=TT(s[s.length-1],o.length));let u=kT(a,l);s.push(u),i=i.matchType(u.type),o=l}}),s)return j.from(s)}return t}function kT(t,e,n=0){for(let r=e.length-1;r>=n;r--)t=e[r].create(null,j.from(t));return t}function ET(t,e,n,r,i){if(i<t.length&&i<e.length&&t[i]==e[i]){let o=ET(t,e,n,r.lastChild,i+1);if(o)return r.copy(r.content.replaceChild(r.childCount-1,o));if(r.contentMatchAt(r.childCount).matchType(i==t.length-1?n.type:t[i+1]))return r.copy(r.content.append(j.from(kT(n,t,i+1))))}}function TT(t,e){if(e==0)return t;let n=t.content.replaceChild(t.childCount-1,TT(t.lastChild,e-1)),r=t.contentMatchAt(t.childCount).fillBefore(j.empty,!0);return t.copy(n.append(r))}function ay(t,e,n,r,i,o){let s=e<0?t.firstChild:t.lastChild,a=s.content;return t.childCount>1&&(o=0),i<r-1&&(a=ay(a,e,n,r,i+1,o)),i>=n&&(a=e<0?s.contentMatchAt(0).fillBefore(a,o<=i).append(a):a.append(s.contentMatchAt(s.childCount).fillBefore(j.empty,!0))),t.replaceChild(e<0?0:t.childCount-1,s.copy(a))}function Mb(t,e,n){return e<t.openStart&&(t=new V(ay(t.content,-1,e,t.openStart,0,t.openEnd),e,t.openEnd)),n<t.openEnd&&(t=new V(ay(t.content,1,n,t.openEnd,0,0),t.openStart,n)),t}const _T={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let Ab=null;function RT(){return Ab||(Ab=document.implementation.createHTMLDocument("title"))}let Jp=null;function NL(t){let e=window.trustedTypes;return e?(Jp||(Jp=e.createPolicy("ProseMirrorClipboard",{createHTML:n=>n})),Jp.createHTML(t)):t}function jL(t){let e=/^(\s*<meta [^>]*>)*/.exec(t);e&&(t=t.slice(e[0].length));let n=RT().createElement("div"),r=/<([a-z][^>\s]+)/i.exec(t),i;if((i=r&&_T[r[1].toLowerCase()])&&(t=i.map(o=>"<"+o+">").join("")+t+i.map(o=>"</"+o+">").reverse().join("")),n.innerHTML=NL(t),i)for(let o=0;o<i.length;o++)n=n.querySelector(i[o])||n;return n}function LL(t){let e=t.querySelectorAll(bt?"span:not([class]):not([style])":"span.Apple-converted-space");for(let n=0;n<e.length;n++){let r=e[n];r.childNodes.length==1&&r.textContent==""&&r.parentNode&&r.parentNode.replaceChild(t.ownerDocument.createTextNode(" "),r)}}function $L(t,e){if(!t.size)return t;let n=t.content.firstChild.type.schema,r;try{r=JSON.parse(e)}catch{return t}let{content:i,openStart:o,openEnd:s}=t;for(let a=r.length-2;a>=0;a-=2){let l=n.nodes[r[a]];if(!l||l.hasRequiredAttrs())break;i=j.from(l.create(r[a+1],i)),o++,s++}return new V(i,o,s)}const Dt={},It={},FL={touchstart:!0,touchmove:!0};class BL{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:""},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastChromeDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function zL(t){for(let e in Dt){let n=Dt[e];t.dom.addEventListener(e,t.input.eventHandlers[e]=r=>{VL(t,r)&&!i0(t,r)&&(t.editable||!(r.type in It))&&n(t,r)},FL[e]?{passive:!0}:void 0)}At&&t.dom.addEventListener("input",()=>null),ly(t)}function Li(t,e){t.input.lastSelectionOrigin=e,t.input.lastSelectionTime=Date.now()}function UL(t){t.domObserver.stop();for(let e in t.input.eventHandlers)t.dom.removeEventListener(e,t.input.eventHandlers[e]);clearTimeout(t.input.composingTimeout),clearTimeout(t.input.lastIOSEnterFallbackTimeout)}function ly(t){t.someProp("handleDOMEvents",e=>{for(let n in e)t.input.eventHandlers[n]||t.dom.addEventListener(n,t.input.eventHandlers[n]=r=>i0(t,r))})}function i0(t,e){return t.someProp("handleDOMEvents",n=>{let r=n[e.type];return r?r(t,e)||e.defaultPrevented:!1})}function VL(t,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let n=e.target;n!=t.dom;n=n.parentNode)if(!n||n.nodeType==11||n.pmViewDesc&&n.pmViewDesc.stopEvent(e))return!1;return!0}function HL(t,e){!i0(t,e)&&Dt[e.type]&&(t.editable||!(e.type in It))&&Dt[e.type](t,e)}It.keydown=(t,e)=>{let n=e;if(t.input.shiftKey=n.keyCode==16||n.shiftKey,!PT(t,n)&&(t.input.lastKeyCode=n.keyCode,t.input.lastKeyCodeTime=Date.now(),!(Wr&&bt&&n.keyCode==13)))if(n.keyCode!=229&&t.domObserver.forceFlush(),Ka&&n.keyCode==13&&!n.ctrlKey&&!n.altKey&&!n.metaKey){let r=Date.now();t.input.lastIOSEnter=r,t.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{t.input.lastIOSEnter==r&&(t.someProp("handleKeyDown",i=>i(t,Ao(13,"Enter"))),t.input.lastIOSEnter=0)},200)}else t.someProp("handleKeyDown",r=>r(t,n))||AL(t,n)?n.preventDefault():Li(t,"key")};It.keyup=(t,e)=>{e.keyCode==16&&(t.input.shiftKey=!1)};It.keypress=(t,e)=>{let n=e;if(PT(t,n)||!n.charCode||n.ctrlKey&&!n.altKey||En&&n.metaKey)return;if(t.someProp("handleKeyPress",i=>i(t,n))){n.preventDefault();return}let r=t.state.selection;if(!(r instanceof ie)||!r.$from.sameParent(r.$to)){let i=String.fromCharCode(n.charCode);!/[\r\n]/.test(i)&&!t.someProp("handleTextInput",o=>o(t,r.$from.pos,r.$to.pos,i))&&t.dispatch(t.state.tr.insertText(i).scrollIntoView()),n.preventDefault()}};function Ph(t){return{left:t.clientX,top:t.clientY}}function WL(t,e){let n=e.x-t.clientX,r=e.y-t.clientY;return n*n+r*r<100}function o0(t,e,n,r,i){if(r==-1)return!1;let o=t.state.doc.resolve(r);for(let s=o.depth+1;s>0;s--)if(t.someProp(e,a=>s>o.depth?a(t,n,o.nodeAfter,o.before(s),i,!0):a(t,n,o.node(s),o.before(s),i,!1)))return!0;return!1}function va(t,e,n){if(t.focused||t.focus(),t.state.selection.eq(e))return;let r=t.state.tr.setSelection(e);n=="pointer"&&r.setMeta("pointer",!0),t.dispatch(r)}function KL(t,e){if(e==-1)return!1;let n=t.state.doc.resolve(e),r=n.nodeAfter;return r&&r.isAtom&&X.isSelectable(r)?(va(t,new X(n),"pointer"),!0):!1}function qL(t,e){if(e==-1)return!1;let n=t.state.selection,r,i;n instanceof X&&(r=n.node);let o=t.state.doc.resolve(e);for(let s=o.depth+1;s>0;s--){let a=s>o.depth?o.nodeAfter:o.node(s);if(X.isSelectable(a)){r&&n.$from.depth>0&&s>=n.$from.depth&&o.before(n.$from.depth+1)==n.$from.pos?i=o.before(n.$from.depth):i=o.before(s);break}}return i!=null?(va(t,X.create(t.state.doc,i),"pointer"),!0):!1}function GL(t,e,n,r,i){return o0(t,"handleClickOn",e,n,r)||t.someProp("handleClick",o=>o(t,e,r))||(i?qL(t,n):KL(t,n))}function JL(t,e,n,r){return o0(t,"handleDoubleClickOn",e,n,r)||t.someProp("handleDoubleClick",i=>i(t,e,r))}function YL(t,e,n,r){return o0(t,"handleTripleClickOn",e,n,r)||t.someProp("handleTripleClick",i=>i(t,e,r))||QL(t,n,r)}function QL(t,e,n){if(n.button!=0)return!1;let r=t.state.doc;if(e==-1)return r.inlineContent?(va(t,ie.create(r,0,r.content.size),"pointer"),!0):!1;let i=r.resolve(e);for(let o=i.depth+1;o>0;o--){let s=o>i.depth?i.nodeAfter:i.node(o),a=i.before(o);if(s.inlineContent)va(t,ie.create(r,a+1,a+1+s.content.size),"pointer");else if(X.isSelectable(s))va(t,X.create(r,a),"pointer");else continue;return!0}}function s0(t){return Pf(t)}const OT=En?"metaKey":"ctrlKey";Dt.mousedown=(t,e)=>{let n=e;t.input.shiftKey=n.shiftKey;let r=s0(t),i=Date.now(),o="singleClick";i-t.input.lastClick.time<500&&WL(n,t.input.lastClick)&&!n[OT]&&(t.input.lastClick.type=="singleClick"?o="doubleClick":t.input.lastClick.type=="doubleClick"&&(o="tripleClick")),t.input.lastClick={time:i,x:n.clientX,y:n.clientY,type:o};let s=t.posAtCoords(Ph(n));s&&(o=="singleClick"?(t.input.mouseDown&&t.input.mouseDown.done(),t.input.mouseDown=new XL(t,s,n,!!r)):(o=="doubleClick"?JL:YL)(t,s.pos,s.inside,n)?n.preventDefault():Li(t,"pointer"))};class XL{constructor(e,n,r,i){this.view=e,this.pos=n,this.event=r,this.flushed=i,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!r[OT],this.allowDefault=r.shiftKey;let o,s;if(n.inside>-1)o=e.state.doc.nodeAt(n.inside),s=n.inside;else{let u=e.state.doc.resolve(n.pos);o=u.parent,s=u.depth?u.before():0}const a=i?null:r.target,l=a?e.docView.nearestDesc(a,!0):null;this.target=l&&l.dom.nodeType==1?l.dom:null;let{selection:c}=e.state;(r.button==0&&o.type.spec.draggable&&o.type.spec.selectable!==!1||c instanceof X&&c.from<=s&&c.to>s)&&(this.mightDrag={node:o,pos:s,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&nr&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),Li(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>Jr(this.view)),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let n=this.pos;this.view.state.doc!=this.startDoc&&(n=this.view.posAtCoords(Ph(e))),this.updateAllowDefault(e),this.allowDefault||!n?Li(this.view,"pointer"):GL(this.view,n.pos,n.inside,e,this.selectNode)?e.preventDefault():e.button==0&&(this.flushed||At&&this.mightDrag&&!this.mightDrag.node.isAtom||bt&&!this.view.state.selection.visible&&Math.min(Math.abs(n.pos-this.view.state.selection.from),Math.abs(n.pos-this.view.state.selection.to))<=2)?(va(this.view,oe.near(this.view.state.doc.resolve(n.pos)),"pointer"),e.preventDefault()):Li(this.view,"pointer")}move(e){this.updateAllowDefault(e),Li(this.view,"pointer"),e.buttons==0&&this.done()}updateAllowDefault(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}}Dt.touchstart=t=>{t.input.lastTouch=Date.now(),s0(t),Li(t,"pointer")};Dt.touchmove=t=>{t.input.lastTouch=Date.now(),Li(t,"pointer")};Dt.contextmenu=t=>s0(t);function PT(t,e){return t.composing?!0:At&&Math.abs(e.timeStamp-t.input.compositionEndedAt)<500?(t.input.compositionEndedAt=-2e8,!0):!1}const ZL=Wr?5e3:-1;It.compositionstart=It.compositionupdate=t=>{if(!t.composing){t.domObserver.flush();let{state:e}=t,n=e.selection.$to;if(e.selection instanceof ie&&(e.storedMarks||!n.textOffset&&n.parentOffset&&n.nodeBefore.marks.some(r=>r.type.spec.inclusive===!1)))t.markCursor=t.state.storedMarks||n.marks(),Pf(t,!0),t.markCursor=null;else if(Pf(t,!e.selection.empty),nr&&e.selection.empty&&n.parentOffset&&!n.textOffset&&n.nodeBefore.marks.length){let r=t.domSelectionRange();for(let i=r.focusNode,o=r.focusOffset;i&&i.nodeType==1&&o!=0;){let s=o<0?i.lastChild:i.childNodes[o-1];if(!s)break;if(s.nodeType==3){let a=t.domSelection();a&&a.collapse(s,s.nodeValue.length);break}else i=s,o=-1}}t.input.composing=!0}MT(t,ZL)};It.compositionend=(t,e)=>{t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=e.timeStamp,t.input.compositionPendingChanges=t.domObserver.pendingRecords().length?t.input.compositionID:0,t.input.compositionNode=null,t.input.compositionPendingChanges&&Promise.resolve().then(()=>t.domObserver.flush()),t.input.compositionID++,MT(t,20))};function MT(t,e){clearTimeout(t.input.composingTimeout),e>-1&&(t.input.composingTimeout=setTimeout(()=>Pf(t),e))}function AT(t){for(t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=t3());t.input.compositionNodes.length>0;)t.input.compositionNodes.pop().markParentsDirty()}function e3(t){let e=t.domSelectionRange();if(!e.focusNode)return null;let n=Kj(e.focusNode,e.focusOffset),r=qj(e.focusNode,e.focusOffset);if(n&&r&&n!=r){let i=r.pmViewDesc,o=t.domObserver.lastChangedTextNode;if(n==o||r==o)return o;if(!i||!i.isText(r.nodeValue))return r;if(t.input.compositionNode==r){let s=n.pmViewDesc;if(!(!s||!s.isText(n.nodeValue)))return r}}return n||r}function t3(){let t=document.createEvent("Event");return t.initEvent("event",!0,!0),t.timeStamp}function Pf(t,e=!1){if(!(Wr&&t.domObserver.flushingSoon>=0)){if(t.domObserver.forceFlush(),AT(t),e||t.docView&&t.docView.dirty){let n=t0(t);return n&&!n.eq(t.state.selection)?t.dispatch(t.state.tr.setSelection(n)):(t.markCursor||e)&&!t.state.selection.empty?t.dispatch(t.state.tr.deleteSelection()):t.updateState(t.state),!0}return!1}}function n3(t,e){if(!t.dom.parentNode)return;let n=t.dom.parentNode.appendChild(document.createElement("div"));n.appendChild(e),n.style.cssText="position: fixed; left: -10000px; top: 10px";let r=getSelection(),i=document.createRange();i.selectNodeContents(e),t.dom.blur(),r.removeAllRanges(),r.addRange(i),setTimeout(()=>{n.parentNode&&n.parentNode.removeChild(n),t.focus()},50)}const Ic=nn&&Ji<15||Ka&&Xj<604;Dt.copy=It.cut=(t,e)=>{let n=e,r=t.state.selection,i=n.type=="cut";if(r.empty)return;let o=Ic?null:n.clipboardData,s=r.content(),{dom:a,text:l}=r0(t,s);o?(n.preventDefault(),o.clearData(),o.setData("text/html",a.innerHTML),o.setData("text/plain",l)):n3(t,a),i&&t.dispatch(t.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function r3(t){return t.openStart==0&&t.openEnd==0&&t.content.childCount==1?t.content.firstChild:null}function i3(t,e){if(!t.dom.parentNode)return;let n=t.input.shiftKey||t.state.selection.$from.parent.type.spec.code,r=t.dom.parentNode.appendChild(document.createElement(n?"textarea":"div"));n||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus();let i=t.input.shiftKey&&t.input.lastKeyCode!=45;setTimeout(()=>{t.focus(),r.parentNode&&r.parentNode.removeChild(r),n?Nc(t,r.value,null,i,e):Nc(t,r.textContent,r.innerHTML,i,e)},50)}function Nc(t,e,n,r,i){let o=CT(t,e,n,r,t.state.selection.$from);if(t.someProp("handlePaste",l=>l(t,i,o||V.empty)))return!0;if(!o)return!1;let s=r3(o),a=s?t.state.tr.replaceSelectionWith(s,r):t.state.tr.replaceSelection(o);return t.dispatch(a.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function DT(t){let e=t.getData("text/plain")||t.getData("Text");if(e)return e;let n=t.getData("text/uri-list");return n?n.replace(/\r?\n/g," "):""}It.paste=(t,e)=>{let n=e;if(t.composing&&!Wr)return;let r=Ic?null:n.clipboardData,i=t.input.shiftKey&&t.input.lastKeyCode!=45;r&&Nc(t,DT(r),r.getData("text/html"),i,n)?n.preventDefault():i3(t,n)};class IT{constructor(e,n,r){this.slice=e,this.move=n,this.node=r}}const NT=En?"altKey":"ctrlKey";Dt.dragstart=(t,e)=>{let n=e,r=t.input.mouseDown;if(r&&r.done(),!n.dataTransfer)return;let i=t.state.selection,o=i.empty?null:t.posAtCoords(Ph(n)),s;if(!(o&&o.pos>=i.from&&o.pos<=(i instanceof X?i.to-1:i.to))){if(r&&r.mightDrag)s=X.create(t.state.doc,r.mightDrag.pos);else if(n.target&&n.target.nodeType==1){let d=t.docView.nearestDesc(n.target,!0);d&&d.node.type.spec.draggable&&d!=t.docView&&(s=X.create(t.state.doc,d.posBefore))}}let a=(s||t.state.selection).content(),{dom:l,text:c,slice:u}=r0(t,a);(!n.dataTransfer.files.length||!bt||aT>120)&&n.dataTransfer.clearData(),n.dataTransfer.setData(Ic?"Text":"text/html",l.innerHTML),n.dataTransfer.effectAllowed="copyMove",Ic||n.dataTransfer.setData("text/plain",c),t.dragging=new IT(u,!n[NT],s)};Dt.dragend=t=>{let e=t.dragging;window.setTimeout(()=>{t.dragging==e&&(t.dragging=null)},50)};It.dragover=It.dragenter=(t,e)=>e.preventDefault();It.drop=(t,e)=>{let n=e,r=t.dragging;if(t.dragging=null,!n.dataTransfer)return;let i=t.posAtCoords(Ph(n));if(!i)return;let o=t.state.doc.resolve(i.pos),s=r&&r.slice;s?t.someProp("transformPasted",m=>{s=m(s,t)}):s=CT(t,DT(n.dataTransfer),Ic?null:n.dataTransfer.getData("text/html"),!1,o);let a=!!(r&&!n[NT]);if(t.someProp("handleDrop",m=>m(t,n,s||V.empty,a))){n.preventDefault();return}if(!s)return;n.preventDefault();let l=s?ZE(t.state.doc,o.pos,s):o.pos;l==null&&(l=o.pos);let c=t.state.tr;if(a){let{node:m}=r;m?m.replace(c):c.deleteSelection()}let u=c.mapping.map(l),d=s.openStart==0&&s.openEnd==0&&s.content.childCount==1,f=c.doc;if(d?c.replaceRangeWith(u,u,s.content.firstChild):c.replaceRange(u,u,s),c.doc.eq(f))return;let p=c.doc.resolve(u);if(d&&X.isSelectable(s.content.firstChild)&&p.nodeAfter&&p.nodeAfter.sameMarkup(s.content.firstChild))c.setSelection(new X(p));else{let m=c.mapping.map(l);c.mapping.maps[c.mapping.maps.length-1].forEach((g,v,x,w)=>m=w),c.setSelection(n0(t,p,c.doc.resolve(m)))}t.focus(),t.dispatch(c.setMeta("uiEvent","drop"))};Dt.focus=t=>{t.input.lastFocus=Date.now(),t.focused||(t.domObserver.stop(),t.dom.classList.add("ProseMirror-focused"),t.domObserver.start(),t.focused=!0,setTimeout(()=>{t.docView&&t.hasFocus()&&!t.domObserver.currentSelection.eq(t.domSelectionRange())&&Jr(t)},20))};Dt.blur=(t,e)=>{let n=e;t.focused&&(t.domObserver.stop(),t.dom.classList.remove("ProseMirror-focused"),t.domObserver.start(),n.relatedTarget&&t.dom.contains(n.relatedTarget)&&t.domObserver.currentSelection.clear(),t.focused=!1)};Dt.beforeinput=(t,e)=>{if(bt&&Wr&&e.inputType=="deleteContentBackward"){t.domObserver.flushSoon();let{domChangeCount:r}=t.input;setTimeout(()=>{if(t.input.domChangeCount!=r||(t.dom.blur(),t.focus(),t.someProp("handleKeyDown",o=>o(t,Ao(8,"Backspace")))))return;let{$cursor:i}=t.state.selection;i&&i.pos>0&&t.dispatch(t.state.tr.delete(i.pos-1,i.pos).scrollIntoView())},50)}};for(let t in It)Dt[t]=It[t];function jc(t,e){if(t==e)return!0;for(let n in t)if(t[n]!==e[n])return!1;for(let n in e)if(!(n in t))return!1;return!0}class Mf{constructor(e,n){this.toDOM=e,this.spec=n||Zo,this.side=this.spec.side||0}map(e,n,r,i){let{pos:o,deleted:s}=e.mapResult(n.from+i,this.side<0?-1:1);return s?null:new Xt(o-r,o-r,this)}valid(){return!0}eq(e){return this==e||e instanceof Mf&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&jc(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}}class Qi{constructor(e,n){this.attrs=e,this.spec=n||Zo}map(e,n,r,i){let o=e.map(n.from+i,this.spec.inclusiveStart?-1:1)-r,s=e.map(n.to+i,this.spec.inclusiveEnd?1:-1)-r;return o>=s?null:new Xt(o,s,this)}valid(e,n){return n.from<n.to}eq(e){return this==e||e instanceof Qi&&jc(this.attrs,e.attrs)&&jc(this.spec,e.spec)}static is(e){return e.type instanceof Qi}destroy(){}}class a0{constructor(e,n){this.attrs=e,this.spec=n||Zo}map(e,n,r,i){let o=e.mapResult(n.from+i,1);if(o.deleted)return null;let s=e.mapResult(n.to+i,-1);return s.deleted||s.pos<=o.pos?null:new Xt(o.pos-r,s.pos-r,this)}valid(e,n){let{index:r,offset:i}=e.content.findIndex(n.from),o;return i==n.from&&!(o=e.child(r)).isText&&i+o.nodeSize==n.to}eq(e){return this==e||e instanceof a0&&jc(this.attrs,e.attrs)&&jc(this.spec,e.spec)}destroy(){}}class Xt{constructor(e,n,r){this.from=e,this.to=n,this.type=r}copy(e,n){return new Xt(e,n,this.type)}eq(e,n=0){return this.type.eq(e.type)&&this.from+n==e.from&&this.to+n==e.to}map(e,n,r){return this.type.map(e,this,n,r)}static widget(e,n,r){return new Xt(e,e,new Mf(n,r))}static inline(e,n,r,i){return new Xt(e,n,new Qi(r,i))}static node(e,n,r,i){return new Xt(e,n,new a0(r,i))}get spec(){return this.type.spec}get inline(){return this.type instanceof Qi}get widget(){return this.type instanceof Mf}}const Ws=[],Zo={};class Ue{constructor(e,n){this.local=e.length?e:Ws,this.children=n.length?n:Ws}static create(e,n){return n.length?Af(n,e,0,Zo):xt}find(e,n,r){let i=[];return this.findInner(e??0,n??1e9,i,0,r),i}findInner(e,n,r,i,o){for(let s=0;s<this.local.length;s++){let a=this.local[s];a.from<=n&&a.to>=e&&(!o||o(a.spec))&&r.push(a.copy(a.from+i,a.to+i))}for(let s=0;s<this.children.length;s+=3)if(this.children[s]<n&&this.children[s+1]>e){let a=this.children[s]+1;this.children[s+2].findInner(e-a,n-a,r,i+a,o)}}map(e,n,r){return this==xt||e.maps.length==0?this:this.mapInner(e,n,0,0,r||Zo)}mapInner(e,n,r,i,o){let s;for(let a=0;a<this.local.length;a++){let l=this.local[a].map(e,r,i);l&&l.type.valid(n,l)?(s||(s=[])).push(l):o.onRemove&&o.onRemove(this.local[a].spec)}return this.children.length?o3(this.children,s||[],e,n,r,i,o):s?new Ue(s.sort(es),Ws):xt}add(e,n){return n.length?this==xt?Ue.create(e,n):this.addInner(e,n,0):this}addInner(e,n,r){let i,o=0;e.forEach((a,l)=>{let c=l+r,u;if(u=LT(n,a,c)){for(i||(i=this.children.slice());o<i.length&&i[o]<l;)o+=3;i[o]==l?i[o+2]=i[o+2].addInner(a,u,c+1):i.splice(o,0,l,l+a.nodeSize,Af(u,a,c+1,Zo)),o+=3}});let s=jT(o?$T(n):n,-r);for(let a=0;a<s.length;a++)s[a].type.valid(e,s[a])||s.splice(a--,1);return new Ue(s.length?this.local.concat(s).sort(es):this.local,i||this.children)}remove(e){return e.length==0||this==xt?this:this.removeInner(e,0)}removeInner(e,n){let r=this.children,i=this.local;for(let o=0;o<r.length;o+=3){let s,a=r[o]+n,l=r[o+1]+n;for(let u=0,d;u<e.length;u++)(d=e[u])&&d.from>a&&d.to<l&&(e[u]=null,(s||(s=[])).push(d));if(!s)continue;r==this.children&&(r=this.children.slice());let c=r[o+2].removeInner(s,a+1);c!=xt?r[o+2]=c:(r.splice(o,3),o-=3)}if(i.length){for(let o=0,s;o<e.length;o++)if(s=e[o])for(let a=0;a<i.length;a++)i[a].eq(s,n)&&(i==this.local&&(i=this.local.slice()),i.splice(a--,1))}return r==this.children&&i==this.local?this:i.length||r.length?new Ue(i,r):xt}forChild(e,n){if(this==xt)return this;if(n.isLeaf)return Ue.empty;let r,i;for(let a=0;a<this.children.length;a+=3)if(this.children[a]>=e){this.children[a]==e&&(r=this.children[a+2]);break}let o=e+1,s=o+n.content.size;for(let a=0;a<this.local.length;a++){let l=this.local[a];if(l.from<s&&l.to>o&&l.type instanceof Qi){let c=Math.max(o,l.from)-o,u=Math.min(s,l.to)-o;c<u&&(i||(i=[])).push(l.copy(c,u))}}if(i){let a=new Ue(i.sort(es),Ws);return r?new Ci([a,r]):a}return r||xt}eq(e){if(this==e)return!0;if(!(e instanceof Ue)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let n=0;n<this.local.length;n++)if(!this.local[n].eq(e.local[n]))return!1;for(let n=0;n<this.children.length;n+=3)if(this.children[n]!=e.children[n]||this.children[n+1]!=e.children[n+1]||!this.children[n+2].eq(e.children[n+2]))return!1;return!0}locals(e){return l0(this.localsInner(e))}localsInner(e){if(this==xt)return Ws;if(e.inlineContent||!this.local.some(Qi.is))return this.local;let n=[];for(let r=0;r<this.local.length;r++)this.local[r].type instanceof Qi||n.push(this.local[r]);return n}forEachSet(e){e(this)}}Ue.empty=new Ue([],[]);Ue.removeOverlap=l0;const xt=Ue.empty;class Ci{constructor(e){this.members=e}map(e,n){const r=this.members.map(i=>i.map(e,n,Zo));return Ci.from(r)}forChild(e,n){if(n.isLeaf)return Ue.empty;let r=[];for(let i=0;i<this.members.length;i++){let o=this.members[i].forChild(e,n);o!=xt&&(o instanceof Ci?r=r.concat(o.members):r.push(o))}return Ci.from(r)}eq(e){if(!(e instanceof Ci)||e.members.length!=this.members.length)return!1;for(let n=0;n<this.members.length;n++)if(!this.members[n].eq(e.members[n]))return!1;return!0}locals(e){let n,r=!0;for(let i=0;i<this.members.length;i++){let o=this.members[i].localsInner(e);if(o.length)if(!n)n=o;else{r&&(n=n.slice(),r=!1);for(let s=0;s<o.length;s++)n.push(o[s])}}return n?l0(r?n:n.sort(es)):Ws}static from(e){switch(e.length){case 0:return xt;case 1:return e[0];default:return new Ci(e.every(n=>n instanceof Ue)?e:e.reduce((n,r)=>n.concat(r instanceof Ue?r:r.members),[]))}}forEachSet(e){for(let n=0;n<this.members.length;n++)this.members[n].forEachSet(e)}}function o3(t,e,n,r,i,o,s){let a=t.slice();for(let c=0,u=o;c<n.maps.length;c++){let d=0;n.maps[c].forEach((f,p,m,g)=>{let v=g-m-(p-f);for(let x=0;x<a.length;x+=3){let w=a[x+1];if(w<0||f>w+u-d)continue;let S=a[x]+u-d;p>=S?a[x+1]=f<=S?-2:-1:f>=u&&v&&(a[x]+=v,a[x+1]+=v)}d+=v}),u=n.maps[c].map(u,-1)}let l=!1;for(let c=0;c<a.length;c+=3)if(a[c+1]<0){if(a[c+1]==-2){l=!0,a[c+1]=-1;continue}let u=n.map(t[c]+o),d=u-i;if(d<0||d>=r.content.size){l=!0;continue}let f=n.map(t[c+1]+o,-1),p=f-i,{index:m,offset:g}=r.content.findIndex(d),v=r.maybeChild(m);if(v&&g==d&&g+v.nodeSize==p){let x=a[c+2].mapInner(n,v,u+1,t[c]+o+1,s);x!=xt?(a[c]=d,a[c+1]=p,a[c+2]=x):(a[c+1]=-2,l=!0)}else l=!0}if(l){let c=s3(a,t,e,n,i,o,s),u=Af(c,r,0,s);e=u.local;for(let d=0;d<a.length;d+=3)a[d+1]<0&&(a.splice(d,3),d-=3);for(let d=0,f=0;d<u.children.length;d+=3){let p=u.children[d];for(;f<a.length&&a[f]<p;)f+=3;a.splice(f,0,u.children[d],u.children[d+1],u.children[d+2])}}return new Ue(e.sort(es),a)}function jT(t,e){if(!e||!t.length)return t;let n=[];for(let r=0;r<t.length;r++){let i=t[r];n.push(new Xt(i.from+e,i.to+e,i.type))}return n}function s3(t,e,n,r,i,o,s){function a(l,c){for(let u=0;u<l.local.length;u++){let d=l.local[u].map(r,i,c);d?n.push(d):s.onRemove&&s.onRemove(l.local[u].spec)}for(let u=0;u<l.children.length;u+=3)a(l.children[u+2],l.children[u]+c+1)}for(let l=0;l<t.length;l+=3)t[l+1]==-1&&a(t[l+2],e[l]+o+1);return n}function LT(t,e,n){if(e.isLeaf)return null;let r=n+e.nodeSize,i=null;for(let o=0,s;o<t.length;o++)(s=t[o])&&s.from>n&&s.to<r&&((i||(i=[])).push(s),t[o]=null);return i}function $T(t){let e=[];for(let n=0;n<t.length;n++)t[n]!=null&&e.push(t[n]);return e}function Af(t,e,n,r){let i=[],o=!1;e.forEach((a,l)=>{let c=LT(t,a,l+n);if(c){o=!0;let u=Af(c,a,n+l+1,r);u!=xt&&i.push(l,l+a.nodeSize,u)}});let s=jT(o?$T(t):t,-n).sort(es);for(let a=0;a<s.length;a++)s[a].type.valid(e,s[a])||(r.onRemove&&r.onRemove(s[a].spec),s.splice(a--,1));return s.length||i.length?new Ue(s,i):xt}function es(t,e){return t.from-e.from||t.to-e.to}function l0(t){let e=t;for(let n=0;n<e.length-1;n++){let r=e[n];if(r.from!=r.to)for(let i=n+1;i<e.length;i++){let o=e[i];if(o.from==r.from){o.to!=r.to&&(e==t&&(e=t.slice()),e[i]=o.copy(o.from,r.to),Db(e,i+1,o.copy(r.to,o.to)));continue}else{o.from<r.to&&(e==t&&(e=t.slice()),e[n]=r.copy(r.from,o.from),Db(e,i,r.copy(o.from,r.to)));break}}}return e}function Db(t,e,n){for(;e<t.length&&es(n,t[e])>0;)e++;t.splice(e,0,n)}function Yp(t){let e=[];return t.someProp("decorations",n=>{let r=n(t.state);r&&r!=xt&&e.push(r)}),t.cursorWrapper&&e.push(Ue.create(t.state.doc,[t.cursorWrapper.deco])),Ci.from(e)}const a3={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},l3=nn&&Ji<=11;class c3{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}}class u3{constructor(e,n){this.view=e,this.handleDOMChange=n,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new c3,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver(r=>{for(let i=0;i<r.length;i++)this.queue.push(r[i]);nn&&Ji<=11&&r.some(i=>i.type=="childList"&&i.removedNodes.length||i.type=="characterData"&&i.oldValue.length>i.target.nodeValue.length)?this.flushSoon():this.flush()}),l3&&(this.onCharData=r=>{this.queue.push({target:r.target,type:"characterData",oldValue:r.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,a3)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let e=this.observer.takeRecords();if(e.length){for(let n=0;n<e.length;n++)this.queue.push(e[n]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(Eb(this.view)){if(this.suppressingSelectionUpdates)return Jr(this.view);if(nn&&Ji<=11&&!this.view.state.selection.empty){let e=this.view.domSelectionRange();if(e.focusNode&&ms(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(e){if(!e.focusNode)return!0;let n=new Set,r;for(let o=e.focusNode;o;o=Wa(o))n.add(o);for(let o=e.anchorNode;o;o=Wa(o))if(n.has(o)){r=o;break}let i=r&&this.view.docView.nearestDesc(r);if(i&&i.ignoreMutation({type:"selection",target:r.nodeType==3?r.parentNode:r}))return this.setCurSelection(),!0}pendingRecords(){if(this.observer)for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}flush(){let{view:e}=this;if(!e.docView||this.flushingSoon>-1)return;let n=this.pendingRecords();n.length&&(this.queue=[]);let r=e.domSelectionRange(),i=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(r)&&Eb(e)&&!this.ignoreSelectionChange(r),o=-1,s=-1,a=!1,l=[];if(e.editable)for(let u=0;u<n.length;u++){let d=this.registerMutation(n[u],l);d&&(o=o<0?d.from:Math.min(d.from,o),s=s<0?d.to:Math.max(d.to,s),d.typeOver&&(a=!0))}if(nr&&l.length){let u=l.filter(d=>d.nodeName=="BR");if(u.length==2){let[d,f]=u;d.parentNode&&d.parentNode.parentNode==f.parentNode?f.remove():d.remove()}else{let{focusNode:d}=this.currentSelection;for(let f of u){let p=f.parentNode;p&&p.nodeName=="LI"&&(!d||h3(e,d)!=p)&&f.remove()}}}let c=null;o<0&&i&&e.input.lastFocus>Date.now()-200&&Math.max(e.input.lastTouch,e.input.lastClick.time)<Date.now()-300&&Rh(r)&&(c=t0(e))&&c.eq(oe.near(e.state.doc.resolve(0),1))?(e.input.lastFocus=0,Jr(e),this.currentSelection.set(r),e.scrollToSelection()):(o>-1||i)&&(o>-1&&(e.docView.markDirty(o,s),d3(e)),this.handleDOMChange(o,s,a,l),e.docView&&e.docView.dirty?e.updateState(e.state):this.currentSelection.eq(r)||Jr(e),this.currentSelection.set(r))}registerMutation(e,n){if(n.indexOf(e.target)>-1)return null;let r=this.view.docView.nearestDesc(e.target);if(e.type=="attributes"&&(r==this.view.docView||e.attributeName=="contenteditable"||e.attributeName=="style"&&!e.oldValue&&!e.target.getAttribute("style"))||!r||r.ignoreMutation(e))return null;if(e.type=="childList"){for(let u=0;u<e.addedNodes.length;u++){let d=e.addedNodes[u];n.push(d),d.nodeType==3&&(this.lastChangedTextNode=d)}if(r.contentDOM&&r.contentDOM!=r.dom&&!r.contentDOM.contains(e.target))return{from:r.posBefore,to:r.posAfter};let i=e.previousSibling,o=e.nextSibling;if(nn&&Ji<=11&&e.addedNodes.length)for(let u=0;u<e.addedNodes.length;u++){let{previousSibling:d,nextSibling:f}=e.addedNodes[u];(!d||Array.prototype.indexOf.call(e.addedNodes,d)<0)&&(i=d),(!f||Array.prototype.indexOf.call(e.addedNodes,f)<0)&&(o=f)}let s=i&&i.parentNode==e.target?ct(i)+1:0,a=r.localPosFromDOM(e.target,s,-1),l=o&&o.parentNode==e.target?ct(o):e.target.childNodes.length,c=r.localPosFromDOM(e.target,l,1);return{from:a,to:c}}else return e.type=="attributes"?{from:r.posAtStart-r.border,to:r.posAtEnd+r.border}:(this.lastChangedTextNode=e.target,{from:r.posAtStart,to:r.posAtEnd,typeOver:e.target.nodeValue==e.oldValue})}}let Ib=new WeakMap,Nb=!1;function d3(t){if(!Ib.has(t)&&(Ib.set(t,null),["normal","nowrap","pre-line"].indexOf(getComputedStyle(t.dom).whiteSpace)!==-1)){if(t.requiresGeckoHackNode=nr,Nb)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),Nb=!0}}function jb(t,e){let n=e.startContainer,r=e.startOffset,i=e.endContainer,o=e.endOffset,s=t.domAtPos(t.state.selection.anchor);return ms(s.node,s.offset,i,o)&&([n,r,i,o]=[i,o,n,r]),{anchorNode:n,anchorOffset:r,focusNode:i,focusOffset:o}}function f3(t,e){if(e.getComposedRanges){let i=e.getComposedRanges(t.root)[0];if(i)return jb(t,i)}let n;function r(i){i.preventDefault(),i.stopImmediatePropagation(),n=i.getTargetRanges()[0]}return t.dom.addEventListener("beforeinput",r,!0),document.execCommand("indent"),t.dom.removeEventListener("beforeinput",r,!0),n?jb(t,n):null}function h3(t,e){for(let n=e.parentNode;n&&n!=t.dom;n=n.parentNode){let r=t.docView.nearestDesc(n,!0);if(r&&r.node.isBlock)return n}return null}function p3(t,e,n){let{node:r,fromOffset:i,toOffset:o,from:s,to:a}=t.docView.parseRange(e,n),l=t.domSelectionRange(),c,u=l.anchorNode;if(u&&t.dom.contains(u.nodeType==1?u:u.parentNode)&&(c=[{node:u,offset:l.anchorOffset}],Rh(l)||c.push({node:l.focusNode,offset:l.focusOffset})),bt&&t.input.lastKeyCode===8)for(let v=o;v>i;v--){let x=r.childNodes[v-1],w=x.pmViewDesc;if(x.nodeName=="BR"&&!w){o=v;break}if(!w||w.size)break}let d=t.state.doc,f=t.someProp("domParser")||Gi.fromSchema(t.state.schema),p=d.resolve(s),m=null,g=f.parse(r,{topNode:p.parent,topMatch:p.parent.contentMatchAt(p.index()),topOpen:!0,from:i,to:o,preserveWhitespace:p.parent.type.whitespace=="pre"?"full":!0,findPositions:c,ruleFromNode:m3,context:p});if(c&&c[0].pos!=null){let v=c[0].pos,x=c[1]&&c[1].pos;x==null&&(x=v),m={anchor:v+s,head:x+s}}return{doc:g,sel:m,from:s,to:a}}function m3(t){let e=t.pmViewDesc;if(e)return e.parseRule();if(t.nodeName=="BR"&&t.parentNode){if(At&&/^(ul|ol)$/i.test(t.parentNode.nodeName)){let n=document.createElement("div");return n.appendChild(document.createElement("li")),{skip:n}}else if(t.parentNode.lastChild==t||At&&/^(tr|table)$/i.test(t.parentNode.nodeName))return{ignore:!0}}else if(t.nodeName=="IMG"&&t.getAttribute("mark-placeholder"))return{ignore:!0};return null}const g3=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function y3(t,e,n,r,i){let o=t.input.compositionPendingChanges||(t.composing?t.input.compositionID:0);if(t.input.compositionPendingChanges=0,e<0){let O=t.input.lastSelectionTime>Date.now()-50?t.input.lastSelectionOrigin:null,R=t0(t,O);if(R&&!t.state.selection.eq(R)){if(bt&&Wr&&t.input.lastKeyCode===13&&Date.now()-100<t.input.lastKeyCodeTime&&t.someProp("handleKeyDown",$=>$(t,Ao(13,"Enter"))))return;let I=t.state.tr.setSelection(R);O=="pointer"?I.setMeta("pointer",!0):O=="key"&&I.scrollIntoView(),o&&I.setMeta("composition",o),t.dispatch(I)}return}let s=t.state.doc.resolve(e),a=s.sharedDepth(n);e=s.before(a+1),n=t.state.doc.resolve(n).after(a+1);let l=t.state.selection,c=p3(t,e,n),u=t.state.doc,d=u.slice(c.from,c.to),f,p;t.input.lastKeyCode===8&&Date.now()-100<t.input.lastKeyCodeTime?(f=t.state.selection.to,p="end"):(f=t.state.selection.from,p="start"),t.input.lastKeyCode=null;let m=w3(d.content,c.doc.content,c.from,f,p);if(m&&t.input.domChangeCount++,(Ka&&t.input.lastIOSEnter>Date.now()-225||Wr)&&i.some(O=>O.nodeType==1&&!g3.test(O.nodeName))&&(!m||m.endA>=m.endB)&&t.someProp("handleKeyDown",O=>O(t,Ao(13,"Enter")))){t.input.lastIOSEnter=0;return}if(!m)if(r&&l instanceof ie&&!l.empty&&l.$head.sameParent(l.$anchor)&&!t.composing&&!(c.sel&&c.sel.anchor!=c.sel.head))m={start:l.from,endA:l.to,endB:l.to};else{if(c.sel){let O=Lb(t,t.state.doc,c.sel);if(O&&!O.eq(t.state.selection)){let R=t.state.tr.setSelection(O);o&&R.setMeta("composition",o),t.dispatch(R)}}return}t.state.selection.from<t.state.selection.to&&m.start==m.endB&&t.state.selection instanceof ie&&(m.start>t.state.selection.from&&m.start<=t.state.selection.from+2&&t.state.selection.from>=c.from?m.start=t.state.selection.from:m.endA<t.state.selection.to&&m.endA>=t.state.selection.to-2&&t.state.selection.to<=c.to&&(m.endB+=t.state.selection.to-m.endA,m.endA=t.state.selection.to)),nn&&Ji<=11&&m.endB==m.start+1&&m.endA==m.start&&m.start>c.from&&c.doc.textBetween(m.start-c.from-1,m.start-c.from+1)==" "&&(m.start--,m.endA--,m.endB--);let g=c.doc.resolveNoCache(m.start-c.from),v=c.doc.resolveNoCache(m.endB-c.from),x=u.resolve(m.start),w=g.sameParent(v)&&g.parent.inlineContent&&x.end()>=m.endA,S;if((Ka&&t.input.lastIOSEnter>Date.now()-225&&(!w||i.some(O=>O.nodeName=="DIV"||O.nodeName=="P"))||!w&&g.pos<c.doc.content.size&&!g.sameParent(v)&&(S=oe.findFrom(c.doc.resolve(g.pos+1),1,!0))&&S.head==v.pos)&&t.someProp("handleKeyDown",O=>O(t,Ao(13,"Enter")))){t.input.lastIOSEnter=0;return}if(t.state.selection.anchor>m.start&&x3(u,m.start,m.endA,g,v)&&t.someProp("handleKeyDown",O=>O(t,Ao(8,"Backspace")))){Wr&&bt&&t.domObserver.suppressSelectionUpdates();return}bt&&m.endB==m.start&&(t.input.lastChromeDelete=Date.now()),Wr&&!w&&g.start()!=v.start()&&v.parentOffset==0&&g.depth==v.depth&&c.sel&&c.sel.anchor==c.sel.head&&c.sel.head==m.endA&&(m.endB-=2,v=c.doc.resolveNoCache(m.endB-c.from),setTimeout(()=>{t.someProp("handleKeyDown",function(O){return O(t,Ao(13,"Enter"))})},20));let b=m.start,C=m.endA,k,E,T;if(w){if(g.pos==v.pos)nn&&Ji<=11&&g.parentOffset==0&&(t.domObserver.suppressSelectionUpdates(),setTimeout(()=>Jr(t),20)),k=t.state.tr.delete(b,C),E=u.resolve(m.start).marksAcross(u.resolve(m.endA));else if(m.endA==m.endB&&(T=v3(g.parent.content.cut(g.parentOffset,v.parentOffset),x.parent.content.cut(x.parentOffset,m.endA-x.start()))))k=t.state.tr,T.type=="add"?k.addMark(b,C,T.mark):k.removeMark(b,C,T.mark);else if(g.parent.child(g.index()).isText&&g.index()==v.index()-(v.textOffset?0:1)){let O=g.parent.textBetween(g.parentOffset,v.parentOffset);if(t.someProp("handleTextInput",R=>R(t,b,C,O)))return;k=t.state.tr.insertText(O,b,C)}}if(k||(k=t.state.tr.replace(b,C,c.doc.slice(m.start-c.from,m.endB-c.from))),c.sel){let O=Lb(t,k.doc,c.sel);O&&!(bt&&t.composing&&O.empty&&(m.start!=m.endB||t.input.lastChromeDelete<Date.now()-100)&&(O.head==b||O.head==k.mapping.map(C)-1)||nn&&O.empty&&O.head==b)&&k.setSelection(O)}E&&k.ensureMarks(E),o&&k.setMeta("composition",o),t.dispatch(k.scrollIntoView())}function Lb(t,e,n){return Math.max(n.anchor,n.head)>e.content.size?null:n0(t,e.resolve(n.anchor),e.resolve(n.head))}function v3(t,e){let n=t.firstChild.marks,r=e.firstChild.marks,i=n,o=r,s,a,l;for(let u=0;u<r.length;u++)i=r[u].removeFromSet(i);for(let u=0;u<n.length;u++)o=n[u].removeFromSet(o);if(i.length==1&&o.length==0)a=i[0],s="add",l=u=>u.mark(a.addToSet(u.marks));else if(i.length==0&&o.length==1)a=o[0],s="remove",l=u=>u.mark(a.removeFromSet(u.marks));else return null;let c=[];for(let u=0;u<e.childCount;u++)c.push(l(e.child(u)));if(j.from(c).eq(t))return{mark:a,type:s}}function x3(t,e,n,r,i){if(n-e<=i.pos-r.pos||Qp(r,!0,!1)<i.pos)return!1;let o=t.resolve(e);if(!r.parent.isTextblock){let a=o.nodeAfter;return a!=null&&n==e+a.nodeSize}if(o.parentOffset<o.parent.content.size||!o.parent.isTextblock)return!1;let s=t.resolve(Qp(o,!0,!0));return!s.parent.isTextblock||s.pos>n||Qp(s,!0,!1)<n?!1:r.parent.content.cut(r.parentOffset).eq(s.parent.content)}function Qp(t,e,n){let r=t.depth,i=e?t.end():t.pos;for(;r>0&&(e||t.indexAfter(r)==t.node(r).childCount);)r--,i++,e=!1;if(n){let o=t.node(r).maybeChild(t.indexAfter(r));for(;o&&!o.isLeaf;)o=o.firstChild,i++}return i}function w3(t,e,n,r,i){let o=t.findDiffStart(e,n);if(o==null)return null;let{a:s,b:a}=t.findDiffEnd(e,n+t.size,n+e.size);if(i=="end"){let l=Math.max(0,o-Math.min(s,a));r-=s+l-o}if(s<o&&t.size<e.size){let l=r<=o&&r>=s?o-r:0;o-=l,o&&o<e.size&&$b(e.textBetween(o-1,o+1))&&(o+=l?1:-1),a=o+(a-s),s=o}else if(a<o){let l=r<=o&&r>=a?o-r:0;o-=l,o&&o<t.size&&$b(t.textBetween(o-1,o+1))&&(o+=l?1:-1),s=o+(s-a),a=o}return{start:o,endA:s,endB:a}}function $b(t){if(t.length!=2)return!1;let e=t.charCodeAt(0),n=t.charCodeAt(1);return e>=56320&&e<=57343&&n>=55296&&n<=56319}class b3{constructor(e,n){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new BL,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=n,this.state=n.state,this.directPlugins=n.plugins||[],this.directPlugins.forEach(Vb),this.dispatch=this.dispatch.bind(this),this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):typeof e=="function"?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=zb(this),Bb(this),this.nodeViews=Ub(this),this.docView=xb(this.state.doc,Fb(this),Yp(this),this.dom,this),this.domObserver=new u3(this,(r,i,o,s)=>y3(this,r,i,o,s)),this.domObserver.start(),zL(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let e=this._props;this._props={};for(let n in e)this._props[n]=e[n];this._props.state=this.state}return this._props}update(e){e.handleDOMEvents!=this._props.handleDOMEvents&&ly(this);let n=this._props;this._props=e,e.plugins&&(e.plugins.forEach(Vb),this.directPlugins=e.plugins),this.updateStateInner(e.state,n)}setProps(e){let n={};for(let r in this._props)n[r]=this._props[r];n.state=this.state;for(let r in e)n[r]=e[r];this.update(n)}updateState(e){this.updateStateInner(e,this._props)}updateStateInner(e,n){var r;let i=this.state,o=!1,s=!1;e.storedMarks&&this.composing&&(AT(this),s=!0),this.state=e;let a=i.plugins!=e.plugins||this._props.plugins!=n.plugins;if(a||this._props.plugins!=n.plugins||this._props.nodeViews!=n.nodeViews){let p=Ub(this);C3(p,this.nodeViews)&&(this.nodeViews=p,o=!0)}(a||n.handleDOMEvents!=this._props.handleDOMEvents)&&ly(this),this.editable=zb(this),Bb(this);let l=Yp(this),c=Fb(this),u=i.plugins!=e.plugins&&!i.doc.eq(e.doc)?"reset":e.scrollToSelection>i.scrollToSelection?"to selection":"preserve",d=o||!this.docView.matchesNode(e.doc,c,l);(d||!e.selection.eq(i.selection))&&(s=!0);let f=u=="preserve"&&s&&this.dom.style.overflowAnchor==null&&tL(this);if(s){this.domObserver.stop();let p=d&&(nn||bt)&&!this.composing&&!i.selection.empty&&!e.selection.empty&&S3(i.selection,e.selection);if(d){let m=bt?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=e3(this)),(o||!this.docView.update(e.doc,c,l,this))&&(this.docView.updateOuterDeco(c),this.docView.destroy(),this.docView=xb(e.doc,c,l,this.dom,this)),m&&!this.trackWrites&&(p=!0)}p||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&EL(this))?Jr(this,p):(wT(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(i),!((r=this.dragging)===null||r===void 0)&&r.node&&!i.doc.eq(e.doc)&&this.updateDraggedNode(this.dragging,i),u=="reset"?this.dom.scrollTop=0:u=="to selection"?this.scrollToSelection():f&&nL(f)}scrollToSelection(){let e=this.domSelectionRange().focusNode;if(!(!e||!this.dom.contains(e.nodeType==1?e:e.parentNode))){if(!this.someProp("handleScrollToSelection",n=>n(this)))if(this.state.selection instanceof X){let n=this.docView.domAfterPos(this.state.selection.from);n.nodeType==1&&hb(this,n.getBoundingClientRect(),e)}else hb(this,this.coordsAtPos(this.state.selection.head,1),e)}}destroyPluginViews(){let e;for(;e=this.pluginViews.pop();)e.destroy&&e.destroy()}updatePluginViews(e){if(!e||e.plugins!=this.state.plugins||this.directPlugins!=this.prevDirectPlugins){this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let n=0;n<this.directPlugins.length;n++){let r=this.directPlugins[n];r.spec.view&&this.pluginViews.push(r.spec.view(this))}for(let n=0;n<this.state.plugins.length;n++){let r=this.state.plugins[n];r.spec.view&&this.pluginViews.push(r.spec.view(this))}}else for(let n=0;n<this.pluginViews.length;n++){let r=this.pluginViews[n];r.update&&r.update(this,e)}}updateDraggedNode(e,n){let r=e.node,i=-1;if(this.state.doc.nodeAt(r.from)==r.node)i=r.from;else{let o=r.from+(this.state.doc.content.size-n.doc.content.size);(o>0&&this.state.doc.nodeAt(o))==r.node&&(i=o)}this.dragging=new IT(e.slice,e.move,i<0?void 0:X.create(this.state.doc,i))}someProp(e,n){let r=this._props&&this._props[e],i;if(r!=null&&(i=n?n(r):r))return i;for(let s=0;s<this.directPlugins.length;s++){let a=this.directPlugins[s].props[e];if(a!=null&&(i=n?n(a):a))return i}let o=this.state.plugins;if(o)for(let s=0;s<o.length;s++){let a=o[s].props[e];if(a!=null&&(i=n?n(a):a))return i}}hasFocus(){if(nn){let e=this.root.activeElement;if(e==this.dom)return!0;if(!e||!this.dom.contains(e))return!1;for(;e&&this.dom!=e&&this.dom.contains(e);){if(e.contentEditable=="false")return!1;e=e.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&rL(this.dom),Jr(this),this.domObserver.start()}get root(){let e=this._root;if(e==null){for(let n=this.dom.parentNode;n;n=n.parentNode)if(n.nodeType==9||n.nodeType==11&&n.host)return n.getSelection||(Object.getPrototypeOf(n).getSelection=()=>n.ownerDocument.getSelection()),this._root=n}return e||document}updateRoot(){this._root=null}posAtCoords(e){return lL(this,e)}coordsAtPos(e,n=1){return fT(this,e,n)}domAtPos(e,n=0){return this.docView.domFromPos(e,n)}nodeDOM(e){let n=this.docView.descAt(e);return n?n.nodeDOM:null}posAtDOM(e,n,r=-1){let i=this.docView.posFromDOM(e,n,r);if(i==null)throw new RangeError("DOM position not inside the editor");return i}endOfTextblock(e,n){return hL(this,n||this.state,e)}pasteHTML(e,n){return Nc(this,"",e,!1,n||new ClipboardEvent("paste"))}pasteText(e,n){return Nc(this,e,null,!0,n||new ClipboardEvent("paste"))}serializeForClipboard(e){return r0(this,e)}destroy(){this.docView&&(UL(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],Yp(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,Hj())}get isDestroyed(){return this.docView==null}dispatchEvent(e){return HL(this,e)}dispatch(e){let n=this._props.dispatchTransaction;n?n.call(this,e):this.updateState(this.state.apply(e))}domSelectionRange(){let e=this.domSelection();return e?At&&this.root.nodeType===11&&Jj(this.dom.ownerDocument)==this.dom&&f3(this,e)||e:{focusNode:null,focusOffset:0,anchorNode:null,anchorOffset:0}}domSelection(){return this.root.getSelection()}}function Fb(t){let e=Object.create(null);return e.class="ProseMirror",e.contenteditable=String(t.editable),t.someProp("attributes",n=>{if(typeof n=="function"&&(n=n(t.state)),n)for(let r in n)r=="class"?e.class+=" "+n[r]:r=="style"?e.style=(e.style?e.style+";":"")+n[r]:!e[r]&&r!="contenteditable"&&r!="nodeName"&&(e[r]=String(n[r]))}),e.translate||(e.translate="no"),[Xt.node(0,t.state.doc.content.size,e)]}function Bb(t){if(t.markCursor){let e=document.createElement("img");e.className="ProseMirror-separator",e.setAttribute("mark-placeholder","true"),e.setAttribute("alt",""),t.cursorWrapper={dom:e,deco:Xt.widget(t.state.selection.from,e,{raw:!0,marks:t.markCursor})}}else t.cursorWrapper=null}function zb(t){return!t.someProp("editable",e=>e(t.state)===!1)}function S3(t,e){let n=Math.min(t.$anchor.sharedDepth(t.head),e.$anchor.sharedDepth(e.head));return t.$anchor.start(n)!=e.$anchor.start(n)}function Ub(t){let e=Object.create(null);function n(r){for(let i in r)Object.prototype.hasOwnProperty.call(e,i)||(e[i]=r[i])}return t.someProp("nodeViews",n),t.someProp("markViews",n),e}function C3(t,e){let n=0,r=0;for(let i in t){if(t[i]!=e[i])return!0;n++}for(let i in e)r++;return n!=r}function Vb(t){if(t.spec.state||t.spec.filterTransaction||t.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}var to={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},Df={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},k3=typeof navigator<"u"&&/Mac/.test(navigator.platform),E3=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var ut=0;ut<10;ut++)to[48+ut]=to[96+ut]=String(ut);for(var ut=1;ut<=24;ut++)to[ut+111]="F"+ut;for(var ut=65;ut<=90;ut++)to[ut]=String.fromCharCode(ut+32),Df[ut]=String.fromCharCode(ut);for(var Xp in to)Df.hasOwnProperty(Xp)||(Df[Xp]=to[Xp]);function T3(t){var e=k3&&t.metaKey&&t.shiftKey&&!t.ctrlKey&&!t.altKey||E3&&t.shiftKey&&t.key&&t.key.length==1||t.key=="Unidentified",n=!e&&t.key||(t.shiftKey?Df:to)[t.keyCode]||t.key||"Unidentified";return n=="Esc"&&(n="Escape"),n=="Del"&&(n="Delete"),n=="Left"&&(n="ArrowLeft"),n=="Up"&&(n="ArrowUp"),n=="Right"&&(n="ArrowRight"),n=="Down"&&(n="ArrowDown"),n}const _3=typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):!1;function R3(t){let e=t.split(/-(?!$)/),n=e[e.length-1];n=="Space"&&(n=" ");let r,i,o,s;for(let a=0;a<e.length-1;a++){let l=e[a];if(/^(cmd|meta|m)$/i.test(l))s=!0;else if(/^a(lt)?$/i.test(l))r=!0;else if(/^(c|ctrl|control)$/i.test(l))i=!0;else if(/^s(hift)?$/i.test(l))o=!0;else if(/^mod$/i.test(l))_3?s=!0:i=!0;else throw new Error("Unrecognized modifier name: "+l)}return r&&(n="Alt-"+n),i&&(n="Ctrl-"+n),s&&(n="Meta-"+n),o&&(n="Shift-"+n),n}function O3(t){let e=Object.create(null);for(let n in t)e[R3(n)]=t[n];return e}function Zp(t,e,n=!0){return e.altKey&&(t="Alt-"+t),e.ctrlKey&&(t="Ctrl-"+t),e.metaKey&&(t="Meta-"+t),n&&e.shiftKey&&(t="Shift-"+t),t}function P3(t){return new ht({props:{handleKeyDown:FT(t)}})}function FT(t){let e=O3(t);return function(n,r){let i=T3(r),o,s=e[Zp(i,r)];if(s&&s(n.state,n.dispatch,n))return!0;if(i.length==1&&i!=" "){if(r.shiftKey){let a=e[Zp(i,r,!1)];if(a&&a(n.state,n.dispatch,n))return!0}if((r.shiftKey||r.altKey||r.metaKey||i.charCodeAt(0)>127)&&(o=to[r.keyCode])&&o!=i){let a=e[Zp(o,r)];if(a&&a(n.state,n.dispatch,n))return!0}}return!1}}const M3=(t,e)=>t.selection.empty?!1:(e&&e(t.tr.deleteSelection().scrollIntoView()),!0);function BT(t,e){let{$cursor:n}=t.selection;return!n||(e?!e.endOfTextblock("backward",t):n.parentOffset>0)?null:n}const A3=(t,e,n)=>{let r=BT(t,n);if(!r)return!1;let i=c0(r);if(!i){let s=r.blockRange(),a=s&&ml(s);return a==null?!1:(e&&e(t.tr.lift(s,a).scrollIntoView()),!0)}let o=i.nodeBefore;if(HT(t,i,e,-1))return!0;if(r.parent.content.size==0&&(qa(o,"end")||X.isSelectable(o)))for(let s=r.depth;;s--){let a=Th(t.doc,r.before(s),r.after(s),V.empty);if(a&&a.slice.size<a.to-a.from){if(e){let l=t.tr.step(a);l.setSelection(qa(o,"end")?oe.findFrom(l.doc.resolve(l.mapping.map(i.pos,-1)),-1):X.create(l.doc,i.pos-o.nodeSize)),e(l.scrollIntoView())}return!0}if(s==1||r.node(s-1).childCount>1)break}return o.isAtom&&i.depth==r.depth-1?(e&&e(t.tr.delete(i.pos-o.nodeSize,i.pos).scrollIntoView()),!0):!1},D3=(t,e,n)=>{let r=BT(t,n);if(!r)return!1;let i=c0(r);return i?zT(t,i,e):!1},I3=(t,e,n)=>{let r=UT(t,n);if(!r)return!1;let i=u0(r);return i?zT(t,i,e):!1};function zT(t,e,n){let r=e.nodeBefore,i=r,o=e.pos-1;for(;!i.isTextblock;o--){if(i.type.spec.isolating)return!1;let u=i.lastChild;if(!u)return!1;i=u}let s=e.nodeAfter,a=s,l=e.pos+1;for(;!a.isTextblock;l++){if(a.type.spec.isolating)return!1;let u=a.firstChild;if(!u)return!1;a=u}let c=Th(t.doc,o,l,V.empty);if(!c||c.from!=o||c instanceof et&&c.slice.size>=l-o)return!1;if(n){let u=t.tr.step(c);u.setSelection(ie.create(u.doc,o)),n(u.scrollIntoView())}return!0}function qa(t,e,n=!1){for(let r=t;r;r=e=="start"?r.firstChild:r.lastChild){if(r.isTextblock)return!0;if(n&&r.childCount!=1)return!1}return!1}const N3=(t,e,n)=>{let{$head:r,empty:i}=t.selection,o=r;if(!i)return!1;if(r.parent.isTextblock){if(n?!n.endOfTextblock("backward",t):r.parentOffset>0)return!1;o=c0(r)}let s=o&&o.nodeBefore;return!s||!X.isSelectable(s)?!1:(e&&e(t.tr.setSelection(X.create(t.doc,o.pos-s.nodeSize)).scrollIntoView()),!0)};function c0(t){if(!t.parent.type.spec.isolating)for(let e=t.depth-1;e>=0;e--){if(t.index(e)>0)return t.doc.resolve(t.before(e+1));if(t.node(e).type.spec.isolating)break}return null}function UT(t,e){let{$cursor:n}=t.selection;return!n||(e?!e.endOfTextblock("forward",t):n.parentOffset<n.parent.content.size)?null:n}const j3=(t,e,n)=>{let r=UT(t,n);if(!r)return!1;let i=u0(r);if(!i)return!1;let o=i.nodeAfter;if(HT(t,i,e,1))return!0;if(r.parent.content.size==0&&(qa(o,"start")||X.isSelectable(o))){let s=Th(t.doc,r.before(),r.after(),V.empty);if(s&&s.slice.size<s.to-s.from){if(e){let a=t.tr.step(s);a.setSelection(qa(o,"start")?oe.findFrom(a.doc.resolve(a.mapping.map(i.pos)),1):X.create(a.doc,a.mapping.map(i.pos))),e(a.scrollIntoView())}return!0}}return o.isAtom&&i.depth==r.depth-1?(e&&e(t.tr.delete(i.pos,i.pos+o.nodeSize).scrollIntoView()),!0):!1},L3=(t,e,n)=>{let{$head:r,empty:i}=t.selection,o=r;if(!i)return!1;if(r.parent.isTextblock){if(n?!n.endOfTextblock("forward",t):r.parentOffset<r.parent.content.size)return!1;o=u0(r)}let s=o&&o.nodeAfter;return!s||!X.isSelectable(s)?!1:(e&&e(t.tr.setSelection(X.create(t.doc,o.pos)).scrollIntoView()),!0)};function u0(t){if(!t.parent.type.spec.isolating)for(let e=t.depth-1;e>=0;e--){let n=t.node(e);if(t.index(e)+1<n.childCount)return t.doc.resolve(t.after(e+1));if(n.type.spec.isolating)break}return null}const $3=(t,e)=>{let n=t.selection,r=n instanceof X,i;if(r){if(n.node.isTextblock||!fo(t.doc,n.from))return!1;i=n.from}else if(i=Eh(t.doc,n.from,-1),i==null)return!1;if(e){let o=t.tr.join(i);r&&o.setSelection(X.create(o.doc,i-t.doc.resolve(i).nodeBefore.nodeSize)),e(o.scrollIntoView())}return!0},F3=(t,e)=>{let n=t.selection,r;if(n instanceof X){if(n.node.isTextblock||!fo(t.doc,n.to))return!1;r=n.to}else if(r=Eh(t.doc,n.to,1),r==null)return!1;return e&&e(t.tr.join(r).scrollIntoView()),!0},B3=(t,e)=>{let{$from:n,$to:r}=t.selection,i=n.blockRange(r),o=i&&ml(i);return o==null?!1:(e&&e(t.tr.lift(i,o).scrollIntoView()),!0)},z3=(t,e)=>{let{$head:n,$anchor:r}=t.selection;return!n.parent.type.spec.code||!n.sameParent(r)?!1:(e&&e(t.tr.insertText(`
`).scrollIntoView()),!0)};function VT(t){for(let e=0;e<t.edgeCount;e++){let{type:n}=t.edge(e);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}const U3=(t,e)=>{let{$head:n,$anchor:r}=t.selection;if(!n.parent.type.spec.code||!n.sameParent(r))return!1;let i=n.node(-1),o=n.indexAfter(-1),s=VT(i.contentMatchAt(o));if(!s||!i.canReplaceWith(o,o,s))return!1;if(e){let a=n.after(),l=t.tr.replaceWith(a,a,s.createAndFill());l.setSelection(oe.near(l.doc.resolve(a),1)),e(l.scrollIntoView())}return!0},V3=(t,e)=>{let n=t.selection,{$from:r,$to:i}=n;if(n instanceof Mn||r.parent.inlineContent||i.parent.inlineContent)return!1;let o=VT(i.parent.contentMatchAt(i.indexAfter()));if(!o||!o.isTextblock)return!1;if(e){let s=(!r.parentOffset&&i.index()<i.parent.childCount?r:i).pos,a=t.tr.insert(s,o.createAndFill());a.setSelection(ie.create(a.doc,s+1)),e(a.scrollIntoView())}return!0},H3=(t,e)=>{let{$cursor:n}=t.selection;if(!n||n.parent.content.size)return!1;if(n.depth>1&&n.after()!=n.end(-1)){let o=n.before();if(ga(t.doc,o))return e&&e(t.tr.split(o).scrollIntoView()),!0}let r=n.blockRange(),i=r&&ml(r);return i==null?!1:(e&&e(t.tr.lift(r,i).scrollIntoView()),!0)},W3=(t,e)=>{let{$from:n,to:r}=t.selection,i,o=n.sharedDepth(r);return o==0?!1:(i=n.before(o),e&&e(t.tr.setSelection(X.create(t.doc,i))),!0)};function K3(t,e,n){let r=e.nodeBefore,i=e.nodeAfter,o=e.index();return!r||!i||!r.type.compatibleContent(i.type)?!1:!r.content.size&&e.parent.canReplace(o-1,o)?(n&&n(t.tr.delete(e.pos-r.nodeSize,e.pos).scrollIntoView()),!0):!e.parent.canReplace(o,o+1)||!(i.isTextblock||fo(t.doc,e.pos))?!1:(n&&n(t.tr.join(e.pos).scrollIntoView()),!0)}function HT(t,e,n,r){let i=e.nodeBefore,o=e.nodeAfter,s,a,l=i.type.spec.isolating||o.type.spec.isolating;if(!l&&K3(t,e,n))return!0;let c=!l&&e.parent.canReplace(e.index(),e.index()+1);if(c&&(s=(a=i.contentMatchAt(i.childCount)).findWrapping(o.type))&&a.matchType(s[0]||o.type).validEnd){if(n){let p=e.pos+o.nodeSize,m=j.empty;for(let x=s.length-1;x>=0;x--)m=j.from(s[x].create(null,m));m=j.from(i.copy(m));let g=t.tr.step(new nt(e.pos-1,p,e.pos,p,new V(m,1,0),s.length,!0)),v=g.doc.resolve(p+2*s.length);v.nodeAfter&&v.nodeAfter.type==i.type&&fo(g.doc,v.pos)&&g.join(v.pos),n(g.scrollIntoView())}return!0}let u=o.type.spec.isolating||r>0&&l?null:oe.findFrom(e,1),d=u&&u.$from.blockRange(u.$to),f=d&&ml(d);if(f!=null&&f>=e.depth)return n&&n(t.tr.lift(d,f).scrollIntoView()),!0;if(c&&qa(o,"start",!0)&&qa(i,"end")){let p=i,m=[];for(;m.push(p),!p.isTextblock;)p=p.lastChild;let g=o,v=1;for(;!g.isTextblock;g=g.firstChild)v++;if(p.canReplace(p.childCount,p.childCount,g.content)){if(n){let x=j.empty;for(let S=m.length-1;S>=0;S--)x=j.from(m[S].copy(x));let w=t.tr.step(new nt(e.pos-m.length,e.pos+o.nodeSize,e.pos+v,e.pos+o.nodeSize-v,new V(x,m.length,0),0,!0));n(w.scrollIntoView())}return!0}}return!1}function WT(t){return function(e,n){let r=e.selection,i=t<0?r.$from:r.$to,o=i.depth;for(;i.node(o).isInline;){if(!o)return!1;o--}return i.node(o).isTextblock?(n&&n(e.tr.setSelection(ie.create(e.doc,t<0?i.start(o):i.end(o)))),!0):!1}}const q3=WT(-1),G3=WT(1);function J3(t,e=null){return function(n,r){let{$from:i,$to:o}=n.selection,s=i.blockRange(o),a=s&&Xv(s,t,e);return a?(r&&r(n.tr.wrap(s,a).scrollIntoView()),!0):!1}}function Hb(t,e=null){return function(n,r){let i=!1;for(let o=0;o<n.selection.ranges.length&&!i;o++){let{$from:{pos:s},$to:{pos:a}}=n.selection.ranges[o];n.doc.nodesBetween(s,a,(l,c)=>{if(i)return!1;if(!(!l.isTextblock||l.hasMarkup(t,e)))if(l.type==t)i=!0;else{let u=n.doc.resolve(c),d=u.index();i=u.parent.canReplaceWith(d,d+1,t)}})}if(!i)return!1;if(r){let o=n.tr;for(let s=0;s<n.selection.ranges.length;s++){let{$from:{pos:a},$to:{pos:l}}=n.selection.ranges[s];o.setBlockType(a,l,t,e)}r(o.scrollIntoView())}return!0}}typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform&&os.platform()=="darwin";function Y3(t,e=null){return function(n,r){let{$from:i,$to:o}=n.selection,s=i.blockRange(o);if(!s)return!1;let a=r?n.tr:null;return Q3(a,s,t,e)?(r&&r(a.scrollIntoView()),!0):!1}}function Q3(t,e,n,r=null){let i=!1,o=e,s=e.$from.doc;if(e.depth>=2&&e.$from.node(e.depth-1).type.compatibleContent(n)&&e.startIndex==0){if(e.$from.index(e.depth-1)==0)return!1;let l=s.resolve(e.start-2);o=new Tf(l,l,e.depth),e.endIndex<e.parent.childCount&&(e=new Tf(e.$from,s.resolve(e.$to.end(e.depth)),e.depth)),i=!0}let a=Xv(o,n,r,e);return a?(t&&X3(t,e,a,i,n),!0):!1}function X3(t,e,n,r,i){let o=j.empty;for(let u=n.length-1;u>=0;u--)o=j.from(n[u].type.create(n[u].attrs,o));t.step(new nt(e.start-(r?2:0),e.end,e.start,e.end,new V(o,0,0),n.length,!0));let s=0;for(let u=0;u<n.length;u++)n[u].type==i&&(s=u+1);let a=n.length-s,l=e.start+n.length-(r?2:0),c=e.parent;for(let u=e.startIndex,d=e.endIndex,f=!0;u<d;u++,f=!1)!f&&ga(t.doc,l,a)&&(t.split(l,a),l+=2*a),l+=c.child(u).nodeSize;return t}function Z3(t){return function(e,n){let{$from:r,$to:i}=e.selection,o=r.blockRange(i,s=>s.childCount>0&&s.firstChild.type==t);return o?n?r.node(o.depth-1).type==t?e$(e,n,t,o):t$(e,n,o):!0:!1}}function e$(t,e,n,r){let i=t.tr,o=r.end,s=r.$to.end(r.depth);o<s&&(i.step(new nt(o-1,s,o,s,new V(j.from(n.create(null,r.parent.copy())),1,0),1,!0)),r=new Tf(i.doc.resolve(r.$from.pos),i.doc.resolve(s),r.depth));const a=ml(r);if(a==null)return!1;i.lift(r,a);let l=i.doc.resolve(i.mapping.map(o,-1)-1);return fo(i.doc,l.pos)&&l.nodeBefore.type==l.nodeAfter.type&&i.join(l.pos),e(i.scrollIntoView()),!0}function t$(t,e,n){let r=t.tr,i=n.parent;for(let p=n.end,m=n.endIndex-1,g=n.startIndex;m>g;m--)p-=i.child(m).nodeSize,r.delete(p-1,p+1);let o=r.doc.resolve(n.start),s=o.nodeAfter;if(r.mapping.map(n.end)!=n.start+o.nodeAfter.nodeSize)return!1;let a=n.startIndex==0,l=n.endIndex==i.childCount,c=o.node(-1),u=o.index(-1);if(!c.canReplace(u+(a?0:1),u+1,s.content.append(l?j.empty:j.from(i))))return!1;let d=o.pos,f=d+s.nodeSize;return r.step(new nt(d-(a?1:0),f+(l?1:0),d+1,f-1,new V((a?j.empty:j.from(i.copy(j.empty))).append(l?j.empty:j.from(i.copy(j.empty))),a?0:1,l?0:1),a?0:1)),e(r.scrollIntoView()),!0}function n$(t){return function(e,n){let{$from:r,$to:i}=e.selection,o=r.blockRange(i,c=>c.childCount>0&&c.firstChild.type==t);if(!o)return!1;let s=o.startIndex;if(s==0)return!1;let a=o.parent,l=a.child(s-1);if(l.type!=t)return!1;if(n){let c=l.lastChild&&l.lastChild.type==a.type,u=j.from(c?t.create():null),d=new V(j.from(t.create(null,j.from(a.type.create(null,u)))),c?3:1,0),f=o.start,p=o.end;n(e.tr.step(new nt(f-(c?3:1),p,f,p,d,1,!0)).scrollIntoView())}return!0}}function Mh(t){const{state:e,transaction:n}=t;let{selection:r}=n,{doc:i}=n,{storedMarks:o}=n;return{...e,apply:e.apply.bind(e),applyTransaction:e.applyTransaction.bind(e),plugins:e.plugins,schema:e.schema,reconfigure:e.reconfigure.bind(e),toJSON:e.toJSON.bind(e),get storedMarks(){return o},get selection(){return r},get doc(){return i},get tr(){return r=n.selection,i=n.doc,o=n.storedMarks,n}}}class Ah{constructor(e){this.editor=e.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=e.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:e,editor:n,state:r}=this,{view:i}=n,{tr:o}=r,s=this.buildProps(o);return Object.fromEntries(Object.entries(e).map(([a,l])=>[a,(...u)=>{const d=l(...u)(s);return!o.getMeta("preventDispatch")&&!this.hasCustomState&&i.dispatch(o),d}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(e,n=!0){const{rawCommands:r,editor:i,state:o}=this,{view:s}=i,a=[],l=!!e,c=e||o.tr,u=()=>(!l&&n&&!c.getMeta("preventDispatch")&&!this.hasCustomState&&s.dispatch(c),a.every(f=>f===!0)),d={...Object.fromEntries(Object.entries(r).map(([f,p])=>[f,(...g)=>{const v=this.buildProps(c,n),x=p(...g)(v);return a.push(x),d}])),run:u};return d}createCan(e){const{rawCommands:n,state:r}=this,i=!1,o=e||r.tr,s=this.buildProps(o,i);return{...Object.fromEntries(Object.entries(n).map(([l,c])=>[l,(...u)=>c(...u)({...s,dispatch:void 0})])),chain:()=>this.createChain(o,i)}}buildProps(e,n=!0){const{rawCommands:r,editor:i,state:o}=this,{view:s}=i,a={tr:e,editor:i,view:s,state:Mh({state:o,transaction:e}),dispatch:n?()=>{}:void 0,chain:()=>this.createChain(e,n),can:()=>this.createCan(e),get commands(){return Object.fromEntries(Object.entries(r).map(([l,c])=>[l,(...u)=>c(...u)(a)]))}};return a}}class r${constructor(){this.callbacks={}}on(e,n){return this.callbacks[e]||(this.callbacks[e]=[]),this.callbacks[e].push(n),this}emit(e,...n){const r=this.callbacks[e];return r&&r.forEach(i=>i.apply(this,n)),this}off(e,n){const r=this.callbacks[e];return r&&(n?this.callbacks[e]=r.filter(i=>i!==n):delete this.callbacks[e]),this}once(e,n){const r=(...i)=>{this.off(e,r),n.apply(this,i)};return this.on(e,r)}removeAllListeners(){this.callbacks={}}}function K(t,e,n){return t.config[e]===void 0&&t.parent?K(t.parent,e,n):typeof t.config[e]=="function"?t.config[e].bind({...n,parent:t.parent?K(t.parent,e,n):null}):t.config[e]}function Dh(t){const e=t.filter(i=>i.type==="extension"),n=t.filter(i=>i.type==="node"),r=t.filter(i=>i.type==="mark");return{baseExtensions:e,nodeExtensions:n,markExtensions:r}}function KT(t){const e=[],{nodeExtensions:n,markExtensions:r}=Dh(t),i=[...n,...r],o={default:null,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return t.forEach(s=>{const a={name:s.name,options:s.options,storage:s.storage,extensions:i},l=K(s,"addGlobalAttributes",a);if(!l)return;l().forEach(u=>{u.types.forEach(d=>{Object.entries(u.attributes).forEach(([f,p])=>{e.push({type:d,name:f,attribute:{...o,...p}})})})})}),i.forEach(s=>{const a={name:s.name,options:s.options,storage:s.storage},l=K(s,"addAttributes",a);if(!l)return;const c=l();Object.entries(c).forEach(([u,d])=>{const f={...o,...d};typeof(f==null?void 0:f.default)=="function"&&(f.default=f.default()),f!=null&&f.isRequired&&(f==null?void 0:f.default)===void 0&&delete f.default,e.push({type:s.name,name:u,attribute:f})})}),e}function it(t,e){if(typeof t=="string"){if(!e.nodes[t])throw Error(`There is no node type named '${t}'. Maybe you forgot to add the extension?`);return e.nodes[t]}return t}function Nt(...t){return t.filter(e=>!!e).reduce((e,n)=>{const r={...e};return Object.entries(n).forEach(([i,o])=>{if(!r[i]){r[i]=o;return}if(i==="class"){const a=o?String(o).split(" "):[],l=r[i]?r[i].split(" "):[],c=a.filter(u=>!l.includes(u));r[i]=[...l,...c].join(" ")}else if(i==="style"){const a=o?o.split(";").map(u=>u.trim()).filter(Boolean):[],l=r[i]?r[i].split(";").map(u=>u.trim()).filter(Boolean):[],c=new Map;l.forEach(u=>{const[d,f]=u.split(":").map(p=>p.trim());c.set(d,f)}),a.forEach(u=>{const[d,f]=u.split(":").map(p=>p.trim());c.set(d,f)}),r[i]=Array.from(c.entries()).map(([u,d])=>`${u}: ${d}`).join("; ")}else r[i]=o}),r},{})}function cy(t,e){return e.filter(n=>n.type===t.type.name).filter(n=>n.attribute.rendered).map(n=>n.attribute.renderHTML?n.attribute.renderHTML(t.attrs)||{}:{[n.name]:t.attrs[n.name]}).reduce((n,r)=>Nt(n,r),{})}function qT(t){return typeof t=="function"}function le(t,e=void 0,...n){return qT(t)?e?t.bind(e)(...n):t(...n):t}function i$(t={}){return Object.keys(t).length===0&&t.constructor===Object}function o$(t){return typeof t!="string"?t:t.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(t):t==="true"?!0:t==="false"?!1:t}function Wb(t,e){return"style"in t?t:{...t,getAttrs:n=>{const r=t.getAttrs?t.getAttrs(n):t.attrs;if(r===!1)return!1;const i=e.reduce((o,s)=>{const a=s.attribute.parseHTML?s.attribute.parseHTML(n):o$(n.getAttribute(s.name));return a==null?o:{...o,[s.name]:a}},{});return{...r,...i}}}}function Kb(t){return Object.fromEntries(Object.entries(t).filter(([e,n])=>e==="attrs"&&i$(n)?!1:n!=null))}function s$(t,e){var n;const r=KT(t),{nodeExtensions:i,markExtensions:o}=Dh(t),s=(n=i.find(c=>K(c,"topNode")))===null||n===void 0?void 0:n.name,a=Object.fromEntries(i.map(c=>{const u=r.filter(x=>x.type===c.name),d={name:c.name,options:c.options,storage:c.storage,editor:e},f=t.reduce((x,w)=>{const S=K(w,"extendNodeSchema",d);return{...x,...S?S(c):{}}},{}),p=Kb({...f,content:le(K(c,"content",d)),marks:le(K(c,"marks",d)),group:le(K(c,"group",d)),inline:le(K(c,"inline",d)),atom:le(K(c,"atom",d)),selectable:le(K(c,"selectable",d)),draggable:le(K(c,"draggable",d)),code:le(K(c,"code",d)),whitespace:le(K(c,"whitespace",d)),linebreakReplacement:le(K(c,"linebreakReplacement",d)),defining:le(K(c,"defining",d)),isolating:le(K(c,"isolating",d)),attrs:Object.fromEntries(u.map(x=>{var w;return[x.name,{default:(w=x==null?void 0:x.attribute)===null||w===void 0?void 0:w.default}]}))}),m=le(K(c,"parseHTML",d));m&&(p.parseDOM=m.map(x=>Wb(x,u)));const g=K(c,"renderHTML",d);g&&(p.toDOM=x=>g({node:x,HTMLAttributes:cy(x,u)}));const v=K(c,"renderText",d);return v&&(p.toText=v),[c.name,p]})),l=Object.fromEntries(o.map(c=>{const u=r.filter(v=>v.type===c.name),d={name:c.name,options:c.options,storage:c.storage,editor:e},f=t.reduce((v,x)=>{const w=K(x,"extendMarkSchema",d);return{...v,...w?w(c):{}}},{}),p=Kb({...f,inclusive:le(K(c,"inclusive",d)),excludes:le(K(c,"excludes",d)),group:le(K(c,"group",d)),spanning:le(K(c,"spanning",d)),code:le(K(c,"code",d)),attrs:Object.fromEntries(u.map(v=>{var x;return[v.name,{default:(x=v==null?void 0:v.attribute)===null||x===void 0?void 0:x.default}]}))}),m=le(K(c,"parseHTML",d));m&&(p.parseDOM=m.map(v=>Wb(v,u)));const g=K(c,"renderHTML",d);return g&&(p.toDOM=v=>g({mark:v,HTMLAttributes:cy(v,u)})),[c.name,p]}));return new UE({topNode:s,nodes:a,marks:l})}function em(t,e){return e.nodes[t]||e.marks[t]||null}function qb(t,e){return Array.isArray(e)?e.some(n=>(typeof n=="string"?n:n.name)===t.name):e}function d0(t,e){const n=Es.fromSchema(e).serializeFragment(t),i=document.implementation.createHTMLDocument().createElement("div");return i.appendChild(n),i.innerHTML}const a$=(t,e=500)=>{let n="";const r=t.parentOffset;return t.parent.nodesBetween(Math.max(0,r-e),r,(i,o,s,a)=>{var l,c;const u=((c=(l=i.type.spec).toText)===null||c===void 0?void 0:c.call(l,{node:i,pos:o,parent:s,index:a}))||i.textContent||"%leaf%";n+=i.isAtom&&!i.isText?u:u.slice(0,Math.max(0,r-o))}),n};function f0(t){return Object.prototype.toString.call(t)==="[object RegExp]"}class Ih{constructor(e){this.find=e.find,this.handler=e.handler}}const l$=(t,e)=>{if(f0(e))return e.exec(t);const n=e(t);if(!n)return null;const r=[n.text];return r.index=n.index,r.input=t,r.data=n.data,n.replaceWith&&(n.text.includes(n.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),r.push(n.replaceWith)),r};function ld(t){var e;const{editor:n,from:r,to:i,text:o,rules:s,plugin:a}=t,{view:l}=n;if(l.composing)return!1;const c=l.state.doc.resolve(r);if(c.parent.type.spec.code||!((e=c.nodeBefore||c.nodeAfter)===null||e===void 0)&&e.marks.find(f=>f.type.spec.code))return!1;let u=!1;const d=a$(c)+o;return s.forEach(f=>{if(u)return;const p=l$(d,f.find);if(!p)return;const m=l.state.tr,g=Mh({state:l.state,transaction:m}),v={from:r-(p[0].length-o.length),to:i},{commands:x,chain:w,can:S}=new Ah({editor:n,state:g});f.handler({state:g,range:v,match:p,commands:x,chain:w,can:S})===null||!m.steps.length||(m.setMeta(a,{transform:m,from:r,to:i,text:o}),l.dispatch(m),u=!0)}),u}function c$(t){const{editor:e,rules:n}=t,r=new ht({state:{init(){return null},apply(i,o,s){const a=i.getMeta(r);if(a)return a;const l=i.getMeta("applyInputRules");return!!l&&setTimeout(()=>{let{text:u}=l;typeof u=="string"?u=u:u=d0(j.from(u),s.schema);const{from:d}=l,f=d+u.length;ld({editor:e,from:d,to:f,text:u,rules:n,plugin:r})}),i.selectionSet||i.docChanged?null:o}},props:{handleTextInput(i,o,s,a){return ld({editor:e,from:o,to:s,text:a,rules:n,plugin:r})},handleDOMEvents:{compositionend:i=>(setTimeout(()=>{const{$cursor:o}=i.state.selection;o&&ld({editor:e,from:o.pos,to:o.pos,text:"",rules:n,plugin:r})}),!1)},handleKeyDown(i,o){if(o.key!=="Enter")return!1;const{$cursor:s}=i.state.selection;return s?ld({editor:e,from:s.pos,to:s.pos,text:`
`,rules:n,plugin:r}):!1}},isInputRules:!0});return r}function u$(t){return Object.prototype.toString.call(t).slice(8,-1)}function cd(t){return u$(t)!=="Object"?!1:t.constructor===Object&&Object.getPrototypeOf(t)===Object.prototype}function Nh(t,e){const n={...t};return cd(t)&&cd(e)&&Object.keys(e).forEach(r=>{cd(e[r])&&cd(t[r])?n[r]=Nh(t[r],e[r]):n[r]=e[r]}),n}class no{constructor(e={}){this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=le(K(this,"addOptions",{name:this.name}))),this.storage=le(K(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new no(e)}configure(e={}){const n=this.extend({...this.config,addOptions:()=>Nh(this.options,e)});return n.name=this.name,n.parent=this.parent,n}extend(e={}){const n=new no(e);return n.parent=this,this.child=n,n.name=e.name?e.name:n.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=le(K(n,"addOptions",{name:n.name})),n.storage=le(K(n,"addStorage",{name:n.name,options:n.options})),n}static handleExit({editor:e,mark:n}){const{tr:r}=e.state,i=e.state.selection.$from;if(i.pos===i.end()){const s=i.marks();if(!!!s.find(c=>(c==null?void 0:c.type.name)===n.name))return!1;const l=s.find(c=>(c==null?void 0:c.type.name)===n.name);return l&&r.removeStoredMark(l),r.insertText(" ",i.pos),e.view.dispatch(r),!0}return!1}}function d$(t){return typeof t=="number"}class f${constructor(e){this.find=e.find,this.handler=e.handler}}const h$=(t,e,n)=>{if(f0(e))return[...t.matchAll(e)];const r=e(t,n);return r?r.map(i=>{const o=[i.text];return o.index=i.index,o.input=t,o.data=i.data,i.replaceWith&&(i.text.includes(i.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),o.push(i.replaceWith)),o}):[]};function p$(t){const{editor:e,state:n,from:r,to:i,rule:o,pasteEvent:s,dropEvent:a}=t,{commands:l,chain:c,can:u}=new Ah({editor:e,state:n}),d=[];return n.doc.nodesBetween(r,i,(p,m)=>{if(!p.isTextblock||p.type.spec.code)return;const g=Math.max(r,m),v=Math.min(i,m+p.content.size),x=p.textBetween(g-m,v-m,void 0,"");h$(x,o.find,s).forEach(S=>{if(S.index===void 0)return;const b=g+S.index+1,C=b+S[0].length,k={from:n.tr.mapping.map(b),to:n.tr.mapping.map(C)},E=o.handler({state:n,range:k,match:S,commands:l,chain:c,can:u,pasteEvent:s,dropEvent:a});d.push(E)})}),d.every(p=>p!==null)}let ud=null;const m$=t=>{var e;const n=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return(e=n.clipboardData)===null||e===void 0||e.setData("text/html",t),n};function g$(t){const{editor:e,rules:n}=t;let r=null,i=!1,o=!1,s=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,a;try{a=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{a=null}const l=({state:u,from:d,to:f,rule:p,pasteEvt:m})=>{const g=u.tr,v=Mh({state:u,transaction:g});if(!(!p$({editor:e,state:v,from:Math.max(d-1,0),to:f.b-1,rule:p,pasteEvent:m,dropEvent:a})||!g.steps.length)){try{a=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{a=null}return s=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,g}};return n.map(u=>new ht({view(d){const f=m=>{var g;r=!((g=d.dom.parentElement)===null||g===void 0)&&g.contains(m.target)?d.dom.parentElement:null,r&&(ud=e)},p=()=>{ud&&(ud=null)};return window.addEventListener("dragstart",f),window.addEventListener("dragend",p),{destroy(){window.removeEventListener("dragstart",f),window.removeEventListener("dragend",p)}}},props:{handleDOMEvents:{drop:(d,f)=>{if(o=r===d.dom.parentElement,a=f,!o){const p=ud;p&&setTimeout(()=>{const m=p.state.selection;m&&p.commands.deleteRange({from:m.from,to:m.to})},10)}return!1},paste:(d,f)=>{var p;const m=(p=f.clipboardData)===null||p===void 0?void 0:p.getData("text/html");return s=f,i=!!(m!=null&&m.includes("data-pm-slice")),!1}}},appendTransaction:(d,f,p)=>{const m=d[0],g=m.getMeta("uiEvent")==="paste"&&!i,v=m.getMeta("uiEvent")==="drop"&&!o,x=m.getMeta("applyPasteRules"),w=!!x;if(!g&&!v&&!w)return;if(w){let{text:C}=x;typeof C=="string"?C=C:C=d0(j.from(C),p.schema);const{from:k}=x,E=k+C.length,T=m$(C);return l({rule:u,state:p,from:k,to:{b:E},pasteEvt:T})}const S=f.doc.content.findDiffStart(p.doc.content),b=f.doc.content.findDiffEnd(p.doc.content);if(!(!d$(S)||!b||S===b.b))return l({rule:u,state:p,from:S,to:b,pasteEvt:s})}}))}function y$(t){const e=t.filter((n,r)=>t.indexOf(n)!==r);return Array.from(new Set(e))}class aa{constructor(e,n){this.splittableMarks=[],this.editor=n,this.extensions=aa.resolve(e),this.schema=s$(this.extensions,n),this.setupExtensions()}static resolve(e){const n=aa.sort(aa.flatten(e)),r=y$(n.map(i=>i.name));return r.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${r.map(i=>`'${i}'`).join(", ")}]. This can lead to issues.`),n}static flatten(e){return e.map(n=>{const r={name:n.name,options:n.options,storage:n.storage},i=K(n,"addExtensions",r);return i?[n,...this.flatten(i())]:n}).flat(10)}static sort(e){return e.sort((r,i)=>{const o=K(r,"priority")||100,s=K(i,"priority")||100;return o>s?-1:o<s?1:0})}get commands(){return this.extensions.reduce((e,n)=>{const r={name:n.name,options:n.options,storage:n.storage,editor:this.editor,type:em(n.name,this.schema)},i=K(n,"addCommands",r);return i?{...e,...i()}:e},{})}get plugins(){const{editor:e}=this,n=aa.sort([...this.extensions].reverse()),r=[],i=[],o=n.map(s=>{const a={name:s.name,options:s.options,storage:s.storage,editor:e,type:em(s.name,this.schema)},l=[],c=K(s,"addKeyboardShortcuts",a);let u={};if(s.type==="mark"&&K(s,"exitable",a)&&(u.ArrowRight=()=>no.handleExit({editor:e,mark:s})),c){const g=Object.fromEntries(Object.entries(c()).map(([v,x])=>[v,()=>x({editor:e})]));u={...u,...g}}const d=P3(u);l.push(d);const f=K(s,"addInputRules",a);qb(s,e.options.enableInputRules)&&f&&r.push(...f());const p=K(s,"addPasteRules",a);qb(s,e.options.enablePasteRules)&&p&&i.push(...p());const m=K(s,"addProseMirrorPlugins",a);if(m){const g=m();l.push(...g)}return l}).flat();return[c$({editor:e,rules:r}),...g$({editor:e,rules:i}),...o]}get attributes(){return KT(this.extensions)}get nodeViews(){const{editor:e}=this,{nodeExtensions:n}=Dh(this.extensions);return Object.fromEntries(n.filter(r=>!!K(r,"addNodeView")).map(r=>{const i=this.attributes.filter(l=>l.type===r.name),o={name:r.name,options:r.options,storage:r.storage,editor:e,type:it(r.name,this.schema)},s=K(r,"addNodeView",o);if(!s)return[];const a=(l,c,u,d,f)=>{const p=cy(l,i);return s()({node:l,view:c,getPos:u,decorations:d,innerDecorations:f,editor:e,extension:r,HTMLAttributes:p})};return[r.name,a]}))}setupExtensions(){this.extensions.forEach(e=>{var n;this.editor.extensionStorage[e.name]=e.storage;const r={name:e.name,options:e.options,storage:e.storage,editor:this.editor,type:em(e.name,this.schema)};e.type==="mark"&&(!((n=le(K(e,"keepOnSplit",r)))!==null&&n!==void 0)||n)&&this.splittableMarks.push(e.name);const i=K(e,"onBeforeCreate",r),o=K(e,"onCreate",r),s=K(e,"onUpdate",r),a=K(e,"onSelectionUpdate",r),l=K(e,"onTransaction",r),c=K(e,"onFocus",r),u=K(e,"onBlur",r),d=K(e,"onDestroy",r);i&&this.editor.on("beforeCreate",i),o&&this.editor.on("create",o),s&&this.editor.on("update",s),a&&this.editor.on("selectionUpdate",a),l&&this.editor.on("transaction",l),c&&this.editor.on("focus",c),u&&this.editor.on("blur",u),d&&this.editor.on("destroy",d)})}}class ot{constructor(e={}){this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=le(K(this,"addOptions",{name:this.name}))),this.storage=le(K(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new ot(e)}configure(e={}){const n=this.extend({...this.config,addOptions:()=>Nh(this.options,e)});return n.name=this.name,n.parent=this.parent,n}extend(e={}){const n=new ot({...this.config,...e});return n.parent=this,this.child=n,n.name=e.name?e.name:n.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=le(K(n,"addOptions",{name:n.name})),n.storage=le(K(n,"addStorage",{name:n.name,options:n.options})),n}}function GT(t,e,n){const{from:r,to:i}=e,{blockSeparator:o=`

`,textSerializers:s={}}=n||{};let a="";return t.nodesBetween(r,i,(l,c,u,d)=>{var f;l.isBlock&&c>r&&(a+=o);const p=s==null?void 0:s[l.type.name];if(p)return u&&(a+=p({node:l,pos:c,parent:u,index:d,range:e})),!1;l.isText&&(a+=(f=l==null?void 0:l.text)===null||f===void 0?void 0:f.slice(Math.max(r,c)-c,i-c))}),a}function JT(t){return Object.fromEntries(Object.entries(t.nodes).filter(([,e])=>e.spec.toText).map(([e,n])=>[e,n.spec.toText]))}const v$=ot.create({name:"clipboardTextSerializer",addOptions(){return{blockSeparator:void 0}},addProseMirrorPlugins(){return[new ht({key:new bn("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:t}=this,{state:e,schema:n}=t,{doc:r,selection:i}=e,{ranges:o}=i,s=Math.min(...o.map(u=>u.$from.pos)),a=Math.max(...o.map(u=>u.$to.pos)),l=JT(n);return GT(r,{from:s,to:a},{...this.options.blockSeparator!==void 0?{blockSeparator:this.options.blockSeparator}:{},textSerializers:l})}}})]}}),x$=()=>({editor:t,view:e})=>(requestAnimationFrame(()=>{var n;t.isDestroyed||(e.dom.blur(),(n=window==null?void 0:window.getSelection())===null||n===void 0||n.removeAllRanges())}),!0),w$=(t=!1)=>({commands:e})=>e.setContent("",t),b$=()=>({state:t,tr:e,dispatch:n})=>{const{selection:r}=e,{ranges:i}=r;return n&&i.forEach(({$from:o,$to:s})=>{t.doc.nodesBetween(o.pos,s.pos,(a,l)=>{if(a.type.isText)return;const{doc:c,mapping:u}=e,d=c.resolve(u.map(l)),f=c.resolve(u.map(l+a.nodeSize)),p=d.blockRange(f);if(!p)return;const m=ml(p);if(a.type.isTextblock){const{defaultType:g}=d.parent.contentMatchAt(d.index());e.setNodeMarkup(p.start,g)}(m||m===0)&&e.lift(p,m)})}),!0},S$=t=>e=>t(e),C$=()=>({state:t,dispatch:e})=>V3(t,e),k$=(t,e)=>({editor:n,tr:r})=>{const{state:i}=n,o=i.doc.slice(t.from,t.to);r.deleteRange(t.from,t.to);const s=r.mapping.map(e);return r.insert(s,o.content),r.setSelection(new ie(r.doc.resolve(s-1))),!0},E$=()=>({tr:t,dispatch:e})=>{const{selection:n}=t,r=n.$anchor.node();if(r.content.size>0)return!1;const i=t.selection.$anchor;for(let o=i.depth;o>0;o-=1)if(i.node(o).type===r.type){if(e){const a=i.before(o),l=i.after(o);t.delete(a,l).scrollIntoView()}return!0}return!1},T$=t=>({tr:e,state:n,dispatch:r})=>{const i=it(t,n.schema),o=e.selection.$anchor;for(let s=o.depth;s>0;s-=1)if(o.node(s).type===i){if(r){const l=o.before(s),c=o.after(s);e.delete(l,c).scrollIntoView()}return!0}return!1},_$=t=>({tr:e,dispatch:n})=>{const{from:r,to:i}=t;return n&&e.delete(r,i),!0},R$=()=>({state:t,dispatch:e})=>M3(t,e),O$=()=>({commands:t})=>t.keyboardShortcut("Enter"),P$=()=>({state:t,dispatch:e})=>U3(t,e);function If(t,e,n={strict:!0}){const r=Object.keys(e);return r.length?r.every(i=>n.strict?e[i]===t[i]:f0(e[i])?e[i].test(t[i]):e[i]===t[i]):!0}function YT(t,e,n={}){return t.find(r=>r.type===e&&If(Object.fromEntries(Object.keys(n).map(i=>[i,r.attrs[i]])),n))}function Gb(t,e,n={}){return!!YT(t,e,n)}function h0(t,e,n){var r;if(!t||!e)return;let i=t.parent.childAfter(t.parentOffset);if((!i.node||!i.node.marks.some(u=>u.type===e))&&(i=t.parent.childBefore(t.parentOffset)),!i.node||!i.node.marks.some(u=>u.type===e)||(n=n||((r=i.node.marks[0])===null||r===void 0?void 0:r.attrs),!YT([...i.node.marks],e,n)))return;let s=i.index,a=t.start()+i.offset,l=s+1,c=a+i.node.nodeSize;for(;s>0&&Gb([...t.parent.child(s-1).marks],e,n);)s-=1,a-=t.parent.child(s).nodeSize;for(;l<t.parent.childCount&&Gb([...t.parent.child(l).marks],e,n);)c+=t.parent.child(l).nodeSize,l+=1;return{from:a,to:c}}function po(t,e){if(typeof t=="string"){if(!e.marks[t])throw Error(`There is no mark type named '${t}'. Maybe you forgot to add the extension?`);return e.marks[t]}return t}const M$=(t,e={})=>({tr:n,state:r,dispatch:i})=>{const o=po(t,r.schema),{doc:s,selection:a}=n,{$from:l,from:c,to:u}=a;if(i){const d=h0(l,o,e);if(d&&d.from<=c&&d.to>=u){const f=ie.create(s,d.from,d.to);n.setSelection(f)}}return!0},A$=t=>e=>{const n=typeof t=="function"?t(e):t;for(let r=0;r<n.length;r+=1)if(n[r](e))return!0;return!1};function p0(t){return t instanceof ie}function Kr(t=0,e=0,n=0){return Math.min(Math.max(t,e),n)}function QT(t,e=null){if(!e)return null;const n=oe.atStart(t),r=oe.atEnd(t);if(e==="start"||e===!0)return n;if(e==="end")return r;const i=n.from,o=r.to;return e==="all"?ie.create(t,Kr(0,i,o),Kr(t.content.size,i,o)):ie.create(t,Kr(e,i,o),Kr(e,i,o))}function D$(){return navigator.platform==="Android"||/android/i.test(navigator.userAgent)}function m0(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}const I$=(t=null,e={})=>({editor:n,view:r,tr:i,dispatch:o})=>{e={scrollIntoView:!0,...e};const s=()=>{(m0()||D$())&&r.dom.focus(),requestAnimationFrame(()=>{n.isDestroyed||(r.focus(),e!=null&&e.scrollIntoView&&n.commands.scrollIntoView())})};if(r.hasFocus()&&t===null||t===!1)return!0;if(o&&t===null&&!p0(n.state.selection))return s(),!0;const a=QT(i.doc,t)||n.state.selection,l=n.state.selection.eq(a);return o&&(l||i.setSelection(a),l&&i.storedMarks&&i.setStoredMarks(i.storedMarks),s()),!0},N$=(t,e)=>n=>t.every((r,i)=>e(r,{...n,index:i})),j$=(t,e)=>({tr:n,commands:r})=>r.insertContentAt({from:n.selection.from,to:n.selection.to},t,e),XT=t=>{const e=t.childNodes;for(let n=e.length-1;n>=0;n-=1){const r=e[n];r.nodeType===3&&r.nodeValue&&/^(\n\s\s|\n)$/.test(r.nodeValue)?t.removeChild(r):r.nodeType===1&&XT(r)}return t};function dd(t){const e=`<body>${t}</body>`,n=new window.DOMParser().parseFromString(e,"text/html").body;return XT(n)}function Nf(t,e,n){if(t instanceof qi||t instanceof j)return t;n={slice:!0,parseOptions:{},...n};const r=typeof t=="object"&&t!==null,i=typeof t=="string";if(r)try{if(Array.isArray(t)&&t.length>0)return j.fromArray(t.map(a=>e.nodeFromJSON(a)));const s=e.nodeFromJSON(t);return n.errorOnInvalidContent&&s.check(),s}catch(o){if(n.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:o});return console.warn("[tiptap warn]: Invalid content.","Passed value:",t,"Error:",o),Nf("",e,n)}if(i){if(n.errorOnInvalidContent){let s=!1,a="";const l=new UE({topNode:e.spec.topNode,marks:e.spec.marks,nodes:e.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:c=>(s=!0,a=typeof c=="string"?c:c.outerHTML,null)}]}})});if(n.slice?Gi.fromSchema(l).parseSlice(dd(t),n.parseOptions):Gi.fromSchema(l).parse(dd(t),n.parseOptions),n.errorOnInvalidContent&&s)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${a}`)})}const o=Gi.fromSchema(e);return n.slice?o.parseSlice(dd(t),n.parseOptions).content:o.parse(dd(t),n.parseOptions)}return Nf("",e,n)}function L$(t,e,n){const r=t.steps.length-1;if(r<e)return;const i=t.steps[r];if(!(i instanceof et||i instanceof nt))return;const o=t.mapping.maps[r];let s=0;o.forEach((a,l,c,u)=>{s===0&&(s=u)}),t.setSelection(oe.near(t.doc.resolve(s),n))}const $$=t=>!("type"in t),F$=(t,e,n)=>({tr:r,dispatch:i,editor:o})=>{var s;if(i){n={parseOptions:o.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...n};let a;try{a=Nf(e,o.schema,{parseOptions:{preserveWhitespace:"full",...n.parseOptions},errorOnInvalidContent:(s=n.errorOnInvalidContent)!==null&&s!==void 0?s:o.options.enableContentCheck})}catch(m){return o.emit("contentError",{editor:o,error:m,disableCollaboration:()=>{o.storage.collaboration&&(o.storage.collaboration.isDisabled=!0)}}),!1}let{from:l,to:c}=typeof t=="number"?{from:t,to:t}:{from:t.from,to:t.to},u=!0,d=!0;if(($$(a)?a:[a]).forEach(m=>{m.check(),u=u?m.isText&&m.marks.length===0:!1,d=d?m.isBlock:!1}),l===c&&d){const{parent:m}=r.doc.resolve(l);m.isTextblock&&!m.type.spec.code&&!m.childCount&&(l-=1,c+=1)}let p;if(u){if(Array.isArray(e))p=e.map(m=>m.text||"").join("");else if(e instanceof j){let m="";e.forEach(g=>{g.text&&(m+=g.text)}),p=m}else typeof e=="object"&&e&&e.text?p=e.text:p=e;r.insertText(p,l,c)}else p=a,r.replaceWith(l,c,p);n.updateSelection&&L$(r,r.steps.length-1,-1),n.applyInputRules&&r.setMeta("applyInputRules",{from:l,text:p}),n.applyPasteRules&&r.setMeta("applyPasteRules",{from:l,text:p})}return!0},B$=()=>({state:t,dispatch:e})=>$3(t,e),z$=()=>({state:t,dispatch:e})=>F3(t,e),U$=()=>({state:t,dispatch:e})=>A3(t,e),V$=()=>({state:t,dispatch:e})=>j3(t,e),H$=()=>({state:t,dispatch:e,tr:n})=>{try{const r=Eh(t.doc,t.selection.$from.pos,-1);return r==null?!1:(n.join(r,2),e&&e(n),!0)}catch{return!1}},W$=()=>({state:t,dispatch:e,tr:n})=>{try{const r=Eh(t.doc,t.selection.$from.pos,1);return r==null?!1:(n.join(r,2),e&&e(n),!0)}catch{return!1}},K$=()=>({state:t,dispatch:e})=>D3(t,e),q$=()=>({state:t,dispatch:e})=>I3(t,e);function ZT(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function G$(t){const e=t.split(/-(?!$)/);let n=e[e.length-1];n==="Space"&&(n=" ");let r,i,o,s;for(let a=0;a<e.length-1;a+=1){const l=e[a];if(/^(cmd|meta|m)$/i.test(l))s=!0;else if(/^a(lt)?$/i.test(l))r=!0;else if(/^(c|ctrl|control)$/i.test(l))i=!0;else if(/^s(hift)?$/i.test(l))o=!0;else if(/^mod$/i.test(l))m0()||ZT()?s=!0:i=!0;else throw new Error(`Unrecognized modifier name: ${l}`)}return r&&(n=`Alt-${n}`),i&&(n=`Ctrl-${n}`),s&&(n=`Meta-${n}`),o&&(n=`Shift-${n}`),n}const J$=t=>({editor:e,view:n,tr:r,dispatch:i})=>{const o=G$(t).split(/-(?!$)/),s=o.find(c=>!["Alt","Ctrl","Meta","Shift"].includes(c)),a=new KeyboardEvent("keydown",{key:s==="Space"?" ":s,altKey:o.includes("Alt"),ctrlKey:o.includes("Ctrl"),metaKey:o.includes("Meta"),shiftKey:o.includes("Shift"),bubbles:!0,cancelable:!0}),l=e.captureTransaction(()=>{n.someProp("handleKeyDown",c=>c(n,a))});return l==null||l.steps.forEach(c=>{const u=c.map(r.mapping);u&&i&&r.maybeStep(u)}),!0};function Lc(t,e,n={}){const{from:r,to:i,empty:o}=t.selection,s=e?it(e,t.schema):null,a=[];t.doc.nodesBetween(r,i,(d,f)=>{if(d.isText)return;const p=Math.max(r,f),m=Math.min(i,f+d.nodeSize);a.push({node:d,from:p,to:m})});const l=i-r,c=a.filter(d=>s?s.name===d.node.type.name:!0).filter(d=>If(d.node.attrs,n,{strict:!1}));return o?!!c.length:c.reduce((d,f)=>d+f.to-f.from,0)>=l}const Y$=(t,e={})=>({state:n,dispatch:r})=>{const i=it(t,n.schema);return Lc(n,i,e)?B3(n,r):!1},Q$=()=>({state:t,dispatch:e})=>H3(t,e),X$=t=>({state:e,dispatch:n})=>{const r=it(t,e.schema);return Z3(r)(e,n)},Z$=()=>({state:t,dispatch:e})=>z3(t,e);function jh(t,e){return e.nodes[t]?"node":e.marks[t]?"mark":null}function Jb(t,e){const n=typeof e=="string"?[e]:e;return Object.keys(t).reduce((r,i)=>(n.includes(i)||(r[i]=t[i]),r),{})}const eF=(t,e)=>({tr:n,state:r,dispatch:i})=>{let o=null,s=null;const a=jh(typeof t=="string"?t:t.name,r.schema);return a?(a==="node"&&(o=it(t,r.schema)),a==="mark"&&(s=po(t,r.schema)),i&&n.selection.ranges.forEach(l=>{r.doc.nodesBetween(l.$from.pos,l.$to.pos,(c,u)=>{o&&o===c.type&&n.setNodeMarkup(u,void 0,Jb(c.attrs,e)),s&&c.marks.length&&c.marks.forEach(d=>{s===d.type&&n.addMark(u,u+c.nodeSize,s.create(Jb(d.attrs,e)))})})}),!0):!1},tF=()=>({tr:t,dispatch:e})=>(e&&t.scrollIntoView(),!0),nF=()=>({tr:t,dispatch:e})=>{if(e){const n=new Mn(t.doc);t.setSelection(n)}return!0},rF=()=>({state:t,dispatch:e})=>N3(t,e),iF=()=>({state:t,dispatch:e})=>L3(t,e),oF=()=>({state:t,dispatch:e})=>W3(t,e),sF=()=>({state:t,dispatch:e})=>G3(t,e),aF=()=>({state:t,dispatch:e})=>q3(t,e);function uy(t,e,n={},r={}){return Nf(t,e,{slice:!1,parseOptions:n,errorOnInvalidContent:r.errorOnInvalidContent})}const lF=(t,e=!1,n={},r={})=>({editor:i,tr:o,dispatch:s,commands:a})=>{var l,c;const{doc:u}=o;if(n.preserveWhitespace!=="full"){const d=uy(t,i.schema,n,{errorOnInvalidContent:(l=r.errorOnInvalidContent)!==null&&l!==void 0?l:i.options.enableContentCheck});return s&&o.replaceWith(0,u.content.size,d).setMeta("preventUpdate",!e),!0}return s&&o.setMeta("preventUpdate",!e),a.insertContentAt({from:0,to:u.content.size},t,{parseOptions:n,errorOnInvalidContent:(c=r.errorOnInvalidContent)!==null&&c!==void 0?c:i.options.enableContentCheck})};function e_(t,e){const n=po(e,t.schema),{from:r,to:i,empty:o}=t.selection,s=[];o?(t.storedMarks&&s.push(...t.storedMarks),s.push(...t.selection.$head.marks())):t.doc.nodesBetween(r,i,l=>{s.push(...l.marks)});const a=s.find(l=>l.type.name===n.name);return a?{...a.attrs}:{}}function cF(t){for(let e=0;e<t.edgeCount;e+=1){const{type:n}=t.edge(e);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}function uF(t,e){for(let n=t.depth;n>0;n-=1){const r=t.node(n);if(e(r))return{pos:n>0?t.before(n):0,start:t.start(n),depth:n,node:r}}}function g0(t){return e=>uF(e.$from,t)}function dF(t,e){const n={from:0,to:t.content.size};return GT(t,n,e)}function fF(t,e){const n=it(e,t.schema),{from:r,to:i}=t.selection,o=[];t.doc.nodesBetween(r,i,a=>{o.push(a)});const s=o.reverse().find(a=>a.type.name===n.name);return s?{...s.attrs}:{}}function hF(t,e){const n=jh(typeof e=="string"?e:e.name,t.schema);return n==="node"?fF(t,e):n==="mark"?e_(t,e):{}}function t_(t,e,n){const r=[];return t===e?n.resolve(t).marks().forEach(i=>{const o=n.resolve(t),s=h0(o,i.type);s&&r.push({mark:i,...s})}):n.nodesBetween(t,e,(i,o)=>{!i||(i==null?void 0:i.nodeSize)===void 0||r.push(...i.marks.map(s=>({from:o,to:o+i.nodeSize,mark:s})))}),r}function zd(t,e,n){return Object.fromEntries(Object.entries(n).filter(([r])=>{const i=t.find(o=>o.type===e&&o.name===r);return i?i.attribute.keepOnSplit:!1}))}function dy(t,e,n={}){const{empty:r,ranges:i}=t.selection,o=e?po(e,t.schema):null;if(r)return!!(t.storedMarks||t.selection.$from.marks()).filter(d=>o?o.name===d.type.name:!0).find(d=>If(d.attrs,n,{strict:!1}));let s=0;const a=[];if(i.forEach(({$from:d,$to:f})=>{const p=d.pos,m=f.pos;t.doc.nodesBetween(p,m,(g,v)=>{if(!g.isText&&!g.marks.length)return;const x=Math.max(p,v),w=Math.min(m,v+g.nodeSize),S=w-x;s+=S,a.push(...g.marks.map(b=>({mark:b,from:x,to:w})))})}),s===0)return!1;const l=a.filter(d=>o?o.name===d.mark.type.name:!0).filter(d=>If(d.mark.attrs,n,{strict:!1})).reduce((d,f)=>d+f.to-f.from,0),c=a.filter(d=>o?d.mark.type!==o&&d.mark.type.excludes(o):!0).reduce((d,f)=>d+f.to-f.from,0);return(l>0?l+c:l)>=s}function pF(t,e,n={}){if(!e)return Lc(t,null,n)||dy(t,null,n);const r=jh(e,t.schema);return r==="node"?Lc(t,e,n):r==="mark"?dy(t,e,n):!1}function Yb(t,e){const{nodeExtensions:n}=Dh(e),r=n.find(s=>s.name===t);if(!r)return!1;const i={name:r.name,options:r.options,storage:r.storage},o=le(K(r,"group",i));return typeof o!="string"?!1:o.split(" ").includes("list")}function Lh(t,{checkChildren:e=!0,ignoreWhitespace:n=!1}={}){var r;if(n){if(t.type.name==="hardBreak")return!0;if(t.isText)return/^\s*$/m.test((r=t.text)!==null&&r!==void 0?r:"")}if(t.isText)return!t.text;if(t.isAtom||t.isLeaf)return!1;if(t.content.childCount===0)return!0;if(e){let i=!0;return t.content.forEach(o=>{i!==!1&&(Lh(o,{ignoreWhitespace:n,checkChildren:e})||(i=!1))}),i}return!1}function n_(t){return t instanceof X}function mF(t,e,n){const i=t.state.doc.content.size,o=Kr(e,0,i),s=Kr(n,0,i),a=t.coordsAtPos(o),l=t.coordsAtPos(s,-1),c=Math.min(a.top,l.top),u=Math.max(a.bottom,l.bottom),d=Math.min(a.left,l.left),f=Math.max(a.right,l.right),p=f-d,m=u-c,x={top:c,bottom:u,left:d,right:f,width:p,height:m,x:d,y:c};return{...x,toJSON:()=>x}}function gF(t,e,n){var r;const{selection:i}=e;let o=null;if(p0(i)&&(o=i.$cursor),o){const a=(r=t.storedMarks)!==null&&r!==void 0?r:o.marks();return!!n.isInSet(a)||!a.some(l=>l.type.excludes(n))}const{ranges:s}=i;return s.some(({$from:a,$to:l})=>{let c=a.depth===0?t.doc.inlineContent&&t.doc.type.allowsMarkType(n):!1;return t.doc.nodesBetween(a.pos,l.pos,(u,d,f)=>{if(c)return!1;if(u.isInline){const p=!f||f.type.allowsMarkType(n),m=!!n.isInSet(u.marks)||!u.marks.some(g=>g.type.excludes(n));c=p&&m}return!c}),c})}const yF=(t,e={})=>({tr:n,state:r,dispatch:i})=>{const{selection:o}=n,{empty:s,ranges:a}=o,l=po(t,r.schema);if(i)if(s){const c=e_(r,l);n.addStoredMark(l.create({...c,...e}))}else a.forEach(c=>{const u=c.$from.pos,d=c.$to.pos;r.doc.nodesBetween(u,d,(f,p)=>{const m=Math.max(p,u),g=Math.min(p+f.nodeSize,d);f.marks.find(x=>x.type===l)?f.marks.forEach(x=>{l===x.type&&n.addMark(m,g,l.create({...x.attrs,...e}))}):n.addMark(m,g,l.create(e))})});return gF(r,n,l)},vF=(t,e)=>({tr:n})=>(n.setMeta(t,e),!0),xF=(t,e={})=>({state:n,dispatch:r,chain:i})=>{const o=it(t,n.schema);let s;return n.selection.$anchor.sameParent(n.selection.$head)&&(s=n.selection.$anchor.parent.attrs),o.isTextblock?i().command(({commands:a})=>Hb(o,{...s,...e})(n)?!0:a.clearNodes()).command(({state:a})=>Hb(o,{...s,...e})(a,r)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},wF=t=>({tr:e,dispatch:n})=>{if(n){const{doc:r}=e,i=Kr(t,0,r.content.size),o=X.create(r,i);e.setSelection(o)}return!0},bF=t=>({tr:e,dispatch:n})=>{if(n){const{doc:r}=e,{from:i,to:o}=typeof t=="number"?{from:t,to:t}:t,s=ie.atStart(r).from,a=ie.atEnd(r).to,l=Kr(i,s,a),c=Kr(o,s,a),u=ie.create(r,l,c);e.setSelection(u)}return!0},SF=t=>({state:e,dispatch:n})=>{const r=it(t,e.schema);return n$(r)(e,n)};function Qb(t,e){const n=t.storedMarks||t.selection.$to.parentOffset&&t.selection.$from.marks();if(n){const r=n.filter(i=>e==null?void 0:e.includes(i.type.name));t.tr.ensureMarks(r)}}const CF=({keepMarks:t=!0}={})=>({tr:e,state:n,dispatch:r,editor:i})=>{const{selection:o,doc:s}=e,{$from:a,$to:l}=o,c=i.extensionManager.attributes,u=zd(c,a.node().type.name,a.node().attrs);if(o instanceof X&&o.node.isBlock)return!a.parentOffset||!ga(s,a.pos)?!1:(r&&(t&&Qb(n,i.extensionManager.splittableMarks),e.split(a.pos).scrollIntoView()),!0);if(!a.parent.isBlock)return!1;const d=l.parentOffset===l.parent.content.size,f=a.depth===0?void 0:cF(a.node(-1).contentMatchAt(a.indexAfter(-1)));let p=d&&f?[{type:f,attrs:u}]:void 0,m=ga(e.doc,e.mapping.map(a.pos),1,p);if(!p&&!m&&ga(e.doc,e.mapping.map(a.pos),1,f?[{type:f}]:void 0)&&(m=!0,p=f?[{type:f,attrs:u}]:void 0),r){if(m&&(o instanceof ie&&e.deleteSelection(),e.split(e.mapping.map(a.pos),1,p),f&&!d&&!a.parentOffset&&a.parent.type!==f)){const g=e.mapping.map(a.before()),v=e.doc.resolve(g);a.node(-1).canReplaceWith(v.index(),v.index()+1,f)&&e.setNodeMarkup(e.mapping.map(a.before()),f)}t&&Qb(n,i.extensionManager.splittableMarks),e.scrollIntoView()}return m},kF=(t,e={})=>({tr:n,state:r,dispatch:i,editor:o})=>{var s;const a=it(t,r.schema),{$from:l,$to:c}=r.selection,u=r.selection.node;if(u&&u.isBlock||l.depth<2||!l.sameParent(c))return!1;const d=l.node(-1);if(d.type!==a)return!1;const f=o.extensionManager.attributes;if(l.parent.content.size===0&&l.node(-1).childCount===l.indexAfter(-1)){if(l.depth===2||l.node(-3).type!==a||l.index(-2)!==l.node(-2).childCount-1)return!1;if(i){let x=j.empty;const w=l.index(-1)?1:l.index(-2)?2:3;for(let T=l.depth-w;T>=l.depth-3;T-=1)x=j.from(l.node(T).copy(x));const S=l.indexAfter(-1)<l.node(-2).childCount?1:l.indexAfter(-2)<l.node(-3).childCount?2:3,b={...zd(f,l.node().type.name,l.node().attrs),...e},C=((s=a.contentMatch.defaultType)===null||s===void 0?void 0:s.createAndFill(b))||void 0;x=x.append(j.from(a.createAndFill(null,C)||void 0));const k=l.before(l.depth-(w-1));n.replace(k,l.after(-S),new V(x,4-w,0));let E=-1;n.doc.nodesBetween(k,n.doc.content.size,(T,O)=>{if(E>-1)return!1;T.isTextblock&&T.content.size===0&&(E=O+1)}),E>-1&&n.setSelection(ie.near(n.doc.resolve(E))),n.scrollIntoView()}return!0}const p=c.pos===l.end()?d.contentMatchAt(0).defaultType:null,m={...zd(f,d.type.name,d.attrs),...e},g={...zd(f,l.node().type.name,l.node().attrs),...e};n.delete(l.pos,c.pos);const v=p?[{type:a,attrs:m},{type:p,attrs:g}]:[{type:a,attrs:m}];if(!ga(n.doc,l.pos,2))return!1;if(i){const{selection:x,storedMarks:w}=r,{splittableMarks:S}=o.extensionManager,b=w||x.$to.parentOffset&&x.$from.marks();if(n.split(l.pos,2,v).scrollIntoView(),!b||!i)return!0;const C=b.filter(k=>S.includes(k.type.name));n.ensureMarks(C)}return!0},tm=(t,e)=>{const n=g0(s=>s.type===e)(t.selection);if(!n)return!0;const r=t.doc.resolve(Math.max(0,n.pos-1)).before(n.depth);if(r===void 0)return!0;const i=t.doc.nodeAt(r);return n.node.type===(i==null?void 0:i.type)&&fo(t.doc,n.pos)&&t.join(n.pos),!0},nm=(t,e)=>{const n=g0(s=>s.type===e)(t.selection);if(!n)return!0;const r=t.doc.resolve(n.start).after(n.depth);if(r===void 0)return!0;const i=t.doc.nodeAt(r);return n.node.type===(i==null?void 0:i.type)&&fo(t.doc,r)&&t.join(r),!0},EF=(t,e,n,r={})=>({editor:i,tr:o,state:s,dispatch:a,chain:l,commands:c,can:u})=>{const{extensions:d,splittableMarks:f}=i.extensionManager,p=it(t,s.schema),m=it(e,s.schema),{selection:g,storedMarks:v}=s,{$from:x,$to:w}=g,S=x.blockRange(w),b=v||g.$to.parentOffset&&g.$from.marks();if(!S)return!1;const C=g0(k=>Yb(k.type.name,d))(g);if(S.depth>=1&&C&&S.depth-C.depth<=1){if(C.node.type===p)return c.liftListItem(m);if(Yb(C.node.type.name,d)&&p.validContent(C.node.content)&&a)return l().command(()=>(o.setNodeMarkup(C.pos,p),!0)).command(()=>tm(o,p)).command(()=>nm(o,p)).run()}return!n||!b||!a?l().command(()=>u().wrapInList(p,r)?!0:c.clearNodes()).wrapInList(p,r).command(()=>tm(o,p)).command(()=>nm(o,p)).run():l().command(()=>{const k=u().wrapInList(p,r),E=b.filter(T=>f.includes(T.type.name));return o.ensureMarks(E),k?!0:c.clearNodes()}).wrapInList(p,r).command(()=>tm(o,p)).command(()=>nm(o,p)).run()},TF=(t,e={},n={})=>({state:r,commands:i})=>{const{extendEmptyMarkRange:o=!1}=n,s=po(t,r.schema);return dy(r,s,e)?i.unsetMark(s,{extendEmptyMarkRange:o}):i.setMark(s,e)},_F=(t,e,n={})=>({state:r,commands:i})=>{const o=it(t,r.schema),s=it(e,r.schema),a=Lc(r,o,n);let l;return r.selection.$anchor.sameParent(r.selection.$head)&&(l=r.selection.$anchor.parent.attrs),a?i.setNode(s,l):i.setNode(o,{...l,...n})},RF=(t,e={})=>({state:n,commands:r})=>{const i=it(t,n.schema);return Lc(n,i,e)?r.lift(i):r.wrapIn(i,e)},OF=()=>({state:t,dispatch:e})=>{const n=t.plugins;for(let r=0;r<n.length;r+=1){const i=n[r];let o;if(i.spec.isInputRules&&(o=i.getState(t))){if(e){const s=t.tr,a=o.transform;for(let l=a.steps.length-1;l>=0;l-=1)s.step(a.steps[l].invert(a.docs[l]));if(o.text){const l=s.doc.resolve(o.from).marks();s.replaceWith(o.from,o.to,t.schema.text(o.text,l))}else s.delete(o.from,o.to)}return!0}}return!1},PF=()=>({tr:t,dispatch:e})=>{const{selection:n}=t,{empty:r,ranges:i}=n;return r||e&&i.forEach(o=>{t.removeMark(o.$from.pos,o.$to.pos)}),!0},MF=(t,e={})=>({tr:n,state:r,dispatch:i})=>{var o;const{extendEmptyMarkRange:s=!1}=e,{selection:a}=n,l=po(t,r.schema),{$from:c,empty:u,ranges:d}=a;if(!i)return!0;if(u&&s){let{from:f,to:p}=a;const m=(o=c.marks().find(v=>v.type===l))===null||o===void 0?void 0:o.attrs,g=h0(c,l,m);g&&(f=g.from,p=g.to),n.removeMark(f,p,l)}else d.forEach(f=>{n.removeMark(f.$from.pos,f.$to.pos,l)});return n.removeStoredMark(l),!0},AF=(t,e={})=>({tr:n,state:r,dispatch:i})=>{let o=null,s=null;const a=jh(typeof t=="string"?t:t.name,r.schema);return a?(a==="node"&&(o=it(t,r.schema)),a==="mark"&&(s=po(t,r.schema)),i&&n.selection.ranges.forEach(l=>{const c=l.$from.pos,u=l.$to.pos;let d,f,p,m;n.selection.empty?r.doc.nodesBetween(c,u,(g,v)=>{o&&o===g.type&&(p=Math.max(v,c),m=Math.min(v+g.nodeSize,u),d=v,f=g)}):r.doc.nodesBetween(c,u,(g,v)=>{v<c&&o&&o===g.type&&(p=Math.max(v,c),m=Math.min(v+g.nodeSize,u),d=v,f=g),v>=c&&v<=u&&(o&&o===g.type&&n.setNodeMarkup(v,void 0,{...g.attrs,...e}),s&&g.marks.length&&g.marks.forEach(x=>{if(s===x.type){const w=Math.max(v,c),S=Math.min(v+g.nodeSize,u);n.addMark(w,S,s.create({...x.attrs,...e}))}}))}),f&&(d!==void 0&&n.setNodeMarkup(d,void 0,{...f.attrs,...e}),s&&f.marks.length&&f.marks.forEach(g=>{s===g.type&&n.addMark(p,m,s.create({...g.attrs,...e}))}))}),!0):!1},DF=(t,e={})=>({state:n,dispatch:r})=>{const i=it(t,n.schema);return J3(i,e)(n,r)},IF=(t,e={})=>({state:n,dispatch:r})=>{const i=it(t,n.schema);return Y3(i,e)(n,r)};var NF=Object.freeze({__proto__:null,blur:x$,clearContent:w$,clearNodes:b$,command:S$,createParagraphNear:C$,cut:k$,deleteCurrentNode:E$,deleteNode:T$,deleteRange:_$,deleteSelection:R$,enter:O$,exitCode:P$,extendMarkRange:M$,first:A$,focus:I$,forEach:N$,insertContent:j$,insertContentAt:F$,joinBackward:U$,joinDown:z$,joinForward:V$,joinItemBackward:H$,joinItemForward:W$,joinTextblockBackward:K$,joinTextblockForward:q$,joinUp:B$,keyboardShortcut:J$,lift:Y$,liftEmptyBlock:Q$,liftListItem:X$,newlineInCode:Z$,resetAttributes:eF,scrollIntoView:tF,selectAll:nF,selectNodeBackward:rF,selectNodeForward:iF,selectParentNode:oF,selectTextblockEnd:sF,selectTextblockStart:aF,setContent:lF,setMark:yF,setMeta:vF,setNode:xF,setNodeSelection:wF,setTextSelection:bF,sinkListItem:SF,splitBlock:CF,splitListItem:kF,toggleList:EF,toggleMark:TF,toggleNode:_F,toggleWrap:RF,undoInputRule:OF,unsetAllMarks:PF,unsetMark:MF,updateAttributes:AF,wrapIn:DF,wrapInList:IF});const jF=ot.create({name:"commands",addCommands(){return{...NF}}}),LF=ot.create({name:"drop",addProseMirrorPlugins(){return[new ht({key:new bn("tiptapDrop"),props:{handleDrop:(t,e,n,r)=>{this.editor.emit("drop",{editor:this.editor,event:e,slice:n,moved:r})}}})]}}),$F=ot.create({name:"editable",addProseMirrorPlugins(){return[new ht({key:new bn("editable"),props:{editable:()=>this.editor.options.editable}})]}}),FF=ot.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:t}=this;return[new ht({key:new bn("focusEvents"),props:{handleDOMEvents:{focus:(e,n)=>{t.isFocused=!0;const r=t.state.tr.setMeta("focus",{event:n}).setMeta("addToHistory",!1);return e.dispatch(r),!1},blur:(e,n)=>{t.isFocused=!1;const r=t.state.tr.setMeta("blur",{event:n}).setMeta("addToHistory",!1);return e.dispatch(r),!1}}}})]}}),BF=ot.create({name:"keymap",addKeyboardShortcuts(){const t=()=>this.editor.commands.first(({commands:s})=>[()=>s.undoInputRule(),()=>s.command(({tr:a})=>{const{selection:l,doc:c}=a,{empty:u,$anchor:d}=l,{pos:f,parent:p}=d,m=d.parent.isTextblock&&f>0?a.doc.resolve(f-1):d,g=m.parent.type.spec.isolating,v=d.pos-d.parentOffset,x=g&&m.parent.childCount===1?v===d.pos:oe.atStart(c).from===f;return!u||!p.type.isTextblock||p.textContent.length||!x||x&&d.parent.type.name==="paragraph"?!1:s.clearNodes()}),()=>s.deleteSelection(),()=>s.joinBackward(),()=>s.selectNodeBackward()]),e=()=>this.editor.commands.first(({commands:s})=>[()=>s.deleteSelection(),()=>s.deleteCurrentNode(),()=>s.joinForward(),()=>s.selectNodeForward()]),r={Enter:()=>this.editor.commands.first(({commands:s})=>[()=>s.newlineInCode(),()=>s.createParagraphNear(),()=>s.liftEmptyBlock(),()=>s.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:t,"Mod-Backspace":t,"Shift-Backspace":t,Delete:e,"Mod-Delete":e,"Mod-a":()=>this.editor.commands.selectAll()},i={...r},o={...r,"Ctrl-h":t,"Alt-Backspace":t,"Ctrl-d":e,"Ctrl-Alt-Backspace":e,"Alt-Delete":e,"Alt-d":e,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return m0()||ZT()?o:i},addProseMirrorPlugins(){return[new ht({key:new bn("clearDocument"),appendTransaction:(t,e,n)=>{if(t.some(g=>g.getMeta("composition")))return;const r=t.some(g=>g.docChanged)&&!e.doc.eq(n.doc),i=t.some(g=>g.getMeta("preventClearDocument"));if(!r||i)return;const{empty:o,from:s,to:a}=e.selection,l=oe.atStart(e.doc).from,c=oe.atEnd(e.doc).to;if(o||!(s===l&&a===c)||!Lh(n.doc))return;const f=n.tr,p=Mh({state:n,transaction:f}),{commands:m}=new Ah({editor:this.editor,state:p});if(m.clearNodes(),!!f.steps.length)return f}})]}}),zF=ot.create({name:"paste",addProseMirrorPlugins(){return[new ht({key:new bn("tiptapPaste"),props:{handlePaste:(t,e,n)=>{this.editor.emit("paste",{editor:this.editor,event:e,slice:n})}}})]}}),UF=ot.create({name:"tabindex",addProseMirrorPlugins(){return[new ht({key:new bn("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}});class Do{get name(){return this.node.type.name}constructor(e,n,r=!1,i=null){this.currentNode=null,this.actualDepth=null,this.isBlock=r,this.resolvedPos=e,this.editor=n,this.currentNode=i}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var e;return(e=this.actualDepth)!==null&&e!==void 0?e:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(e){let n=this.from,r=this.to;if(this.isBlock){if(this.content.size===0){console.error(`You cant set content on a block node. Tried to set content on ${this.name} at ${this.pos}`);return}n=this.from+1,r=this.to-1}this.editor.commands.insertContentAt({from:n,to:r},e)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(this.depth===0)return null;const e=this.resolvedPos.start(this.resolvedPos.depth-1),n=this.resolvedPos.doc.resolve(e);return new Do(n,this.editor)}get before(){let e=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.from-3)),new Do(e,this.editor)}get after(){let e=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.to+3)),new Do(e,this.editor)}get children(){const e=[];return this.node.content.forEach((n,r)=>{const i=n.isBlock&&!n.isTextblock,o=n.isAtom&&!n.isText,s=this.pos+r+(o?0:1),a=this.resolvedPos.doc.resolve(s);if(!i&&a.depth<=this.depth)return;const l=new Do(a,this.editor,i,i?n:null);i&&(l.actualDepth=this.depth+1),e.push(new Do(a,this.editor,i,i?n:null))}),e}get firstChild(){return this.children[0]||null}get lastChild(){const e=this.children;return e[e.length-1]||null}closest(e,n={}){let r=null,i=this.parent;for(;i&&!r;){if(i.node.type.name===e)if(Object.keys(n).length>0){const o=i.node.attrs,s=Object.keys(n);for(let a=0;a<s.length;a+=1){const l=s[a];if(o[l]!==n[l])break}}else r=i;i=i.parent}return r}querySelector(e,n={}){return this.querySelectorAll(e,n,!0)[0]||null}querySelectorAll(e,n={},r=!1){let i=[];if(!this.children||this.children.length===0)return i;const o=Object.keys(n);return this.children.forEach(s=>{r&&i.length>0||(s.node.type.name===e&&o.every(l=>n[l]===s.node.attrs[l])&&i.push(s),!(r&&i.length>0)&&(i=i.concat(s.querySelectorAll(e,n,r))))}),i}setAttribute(e){const{tr:n}=this.editor.state;n.setNodeMarkup(this.from,void 0,{...this.node.attrs,...e}),this.editor.view.dispatch(n)}}const VF=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 0 !important;
  height: 0 !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}

.tippy-box[data-animation=fade][data-state=hidden] {
  opacity: 0
}`;function HF(t,e,n){const r=document.querySelector(`style[data-tiptap-style${n?`-${n}`:""}]`);if(r!==null)return r;const i=document.createElement("style");return e&&i.setAttribute("nonce",e),i.setAttribute(`data-tiptap-style${n?`-${n}`:""}`,""),i.innerHTML=t,document.getElementsByTagName("head")[0].appendChild(i),i}class WF extends r${constructor(e={}){super(),this.isFocused=!1,this.isInitialized=!1,this.extensionStorage={},this.options={element:document.createElement("div"),content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,enableContentCheck:!1,onBeforeCreate:()=>null,onCreate:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null,onContentError:({error:n})=>{throw n},onPaste:()=>null,onDrop:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(e),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.on("contentError",this.options.onContentError),this.createView(),this.injectCSS(),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),this.on("drop",({event:n,slice:r,moved:i})=>this.options.onDrop(n,r,i)),this.on("paste",({event:n,slice:r})=>this.options.onPaste(n,r)),window.setTimeout(()=>{this.isDestroyed||(this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}),this.isInitialized=!0)},0)}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&document&&(this.css=HF(VF,this.options.injectNonce))}setOptions(e={}){this.options={...this.options,...e},!(!this.view||!this.state||this.isDestroyed)&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(e,n=!0){this.setOptions({editable:e}),n&&this.emit("update",{editor:this,transaction:this.state.tr})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get state(){return this.view.state}registerPlugin(e,n){const r=qT(n)?n(e,[...this.state.plugins]):[...this.state.plugins,e],i=this.state.reconfigure({plugins:r});return this.view.updateState(i),i}unregisterPlugin(e){if(this.isDestroyed)return;const n=this.state.plugins;let r=n;if([].concat(e).forEach(o=>{const s=typeof o=="string"?`${o}$`:o.key;r=n.filter(a=>!a.key.startsWith(s))}),n.length===r.length)return;const i=this.state.reconfigure({plugins:r});return this.view.updateState(i),i}createExtensionManager(){var e,n;const i=[...this.options.enableCoreExtensions?[$F,v$.configure({blockSeparator:(n=(e=this.options.coreExtensionOptions)===null||e===void 0?void 0:e.clipboardTextSerializer)===null||n===void 0?void 0:n.blockSeparator}),jF,FF,BF,UF,LF,zF].filter(o=>typeof this.options.enableCoreExtensions=="object"?this.options.enableCoreExtensions[o.name]!==!1:!0):[],...this.options.extensions].filter(o=>["extension","node","mark"].includes(o==null?void 0:o.type));this.extensionManager=new aa(i,this)}createCommandManager(){this.commandManager=new Ah({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createView(){var e;let n;try{n=uy(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:this.options.enableContentCheck})}catch(s){if(!(s instanceof Error)||!["[tiptap error]: Invalid JSON content","[tiptap error]: Invalid HTML content"].includes(s.message))throw s;this.emit("contentError",{editor:this,error:s,disableCollaboration:()=>{this.storage.collaboration&&(this.storage.collaboration.isDisabled=!0),this.options.extensions=this.options.extensions.filter(a=>a.name!=="collaboration"),this.createExtensionManager()}}),n=uy(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:!1})}const r=QT(n,this.options.autofocus);this.view=new b3(this.options.element,{...this.options.editorProps,attributes:{role:"textbox",...(e=this.options.editorProps)===null||e===void 0?void 0:e.attributes},dispatchTransaction:this.dispatchTransaction.bind(this),state:sa.create({doc:n,selection:r||void 0})});const i=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(i),this.createNodeViews(),this.prependClass();const o=this.view.dom;o.editor=this}createNodeViews(){this.view.isDestroyed||this.view.setProps({nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`tiptap ${this.view.dom.className}`}captureTransaction(e){this.isCapturingTransaction=!0,e(),this.isCapturingTransaction=!1;const n=this.capturedTransaction;return this.capturedTransaction=null,n}dispatchTransaction(e){if(this.view.isDestroyed)return;if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=e;return}e.steps.forEach(s=>{var a;return(a=this.capturedTransaction)===null||a===void 0?void 0:a.step(s)});return}const n=this.state.apply(e),r=!this.state.selection.eq(n.selection);this.emit("beforeTransaction",{editor:this,transaction:e,nextState:n}),this.view.updateState(n),this.emit("transaction",{editor:this,transaction:e}),r&&this.emit("selectionUpdate",{editor:this,transaction:e});const i=e.getMeta("focus"),o=e.getMeta("blur");i&&this.emit("focus",{editor:this,event:i.event,transaction:e}),o&&this.emit("blur",{editor:this,event:o.event,transaction:e}),!(!e.docChanged||e.getMeta("preventUpdate"))&&this.emit("update",{editor:this,transaction:e})}getAttributes(e){return hF(this.state,e)}isActive(e,n){const r=typeof e=="string"?e:null,i=typeof e=="string"?n:e;return pF(this.state,r,i)}getJSON(){return this.state.doc.toJSON()}getHTML(){return d0(this.state.doc.content,this.schema)}getText(e){const{blockSeparator:n=`

`,textSerializers:r={}}=e||{};return dF(this.state.doc,{blockSeparator:n,textSerializers:{...JT(this.schema),...r}})}get isEmpty(){return Lh(this.state.doc)}getCharacterCount(){return console.warn('[tiptap warn]: "editor.getCharacterCount()" is deprecated. Please use "editor.storage.characterCount.characters()" instead.'),this.state.doc.content.size-2}destroy(){if(this.emit("destroy"),this.view){const e=this.view.dom;e&&e.editor&&delete e.editor,this.view.destroy()}this.removeAllListeners()}get isDestroyed(){var e;return!(!((e=this.view)===null||e===void 0)&&e.docView)}$node(e,n){var r;return((r=this.$doc)===null||r===void 0?void 0:r.querySelector(e,n))||null}$nodes(e,n){var r;return((r=this.$doc)===null||r===void 0?void 0:r.querySelectorAll(e,n))||null}$pos(e){const n=this.state.doc.resolve(e);return new Do(n,this)}get $doc(){return this.$pos(0)}}function Ga(t){return new Ih({find:t.find,handler:({state:e,range:n,match:r})=>{const i=le(t.getAttributes,void 0,r);if(i===!1||i===null)return null;const{tr:o}=e,s=r[r.length-1],a=r[0];if(s){const l=a.search(/\S/),c=n.from+a.indexOf(s),u=c+s.length;if(t_(n.from,n.to,e.doc).filter(p=>p.mark.type.excluded.find(g=>g===t.type&&g!==p.mark.type)).filter(p=>p.to>c).length)return null;u<n.to&&o.delete(u,n.to),c>n.from&&o.delete(n.from+l,c);const f=n.from+l+s.length;o.addMark(n.from+l,f,t.type.create(i||{})),o.removeStoredMark(t.type)}}})}function KF(t){return new Ih({find:t.find,handler:({state:e,range:n,match:r})=>{const i=le(t.getAttributes,void 0,r)||{},{tr:o}=e,s=n.from;let a=n.to;const l=t.type.create(i);if(r[1]){const c=r[0].lastIndexOf(r[1]);let u=s+c;u>a?u=a:a=u+r[1].length;const d=r[0][r[0].length-1];o.insertText(d,s+r[0].length-1),o.replaceWith(u,a,l)}else if(r[0]){const c=t.type.isInline?s:s-1;o.insert(c,t.type.create(i)).delete(o.mapping.map(s),o.mapping.map(a))}o.scrollIntoView()}})}function fy(t){return new Ih({find:t.find,handler:({state:e,range:n,match:r})=>{const i=e.doc.resolve(n.from),o=le(t.getAttributes,void 0,r)||{};if(!i.node(-1).canReplaceWith(i.index(-1),i.indexAfter(-1),t.type))return null;e.tr.delete(n.from,n.to).setBlockType(n.from,n.from,t.type,o)}})}function $c(t){return new Ih({find:t.find,handler:({state:e,range:n,match:r,chain:i})=>{const o=le(t.getAttributes,void 0,r)||{},s=e.tr.delete(n.from,n.to),l=s.doc.resolve(n.from).blockRange(),c=l&&Xv(l,t.type,o);if(!c)return null;if(s.wrap(l,c),t.keepMarks&&t.editor){const{selection:d,storedMarks:f}=e,{splittableMarks:p}=t.editor.extensionManager,m=f||d.$to.parentOffset&&d.$from.marks();if(m){const g=m.filter(v=>p.includes(v.type.name));s.ensureMarks(g)}}if(t.keepAttributes){const d=t.type.name==="bulletList"||t.type.name==="orderedList"?"listItem":"taskList";i().updateAttributes(d,o).run()}const u=s.doc.resolve(n.from-1).nodeBefore;u&&u.type===t.type&&fo(s.doc,n.from-1)&&(!t.joinPredicate||t.joinPredicate(r,u))&&s.join(n.from-1)}})}let ar=class hy{constructor(e={}){this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=le(K(this,"addOptions",{name:this.name}))),this.storage=le(K(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new hy(e)}configure(e={}){const n=this.extend({...this.config,addOptions:()=>Nh(this.options,e)});return n.name=this.name,n.parent=this.parent,n}extend(e={}){const n=new hy(e);return n.parent=this,this.child=n,n.name=e.name?e.name:n.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=le(K(n,"addOptions",{name:n.name})),n.storage=le(K(n,"addStorage",{name:n.name,options:n.options})),n}};function Ja(t){return new f$({find:t.find,handler:({state:e,range:n,match:r,pasteEvent:i})=>{const o=le(t.getAttributes,void 0,r,i);if(o===!1||o===null)return null;const{tr:s}=e,a=r[r.length-1],l=r[0];let c=n.to;if(a){const u=l.search(/\S/),d=n.from+l.indexOf(a),f=d+a.length;if(t_(n.from,n.to,e.doc).filter(m=>m.mark.type.excluded.find(v=>v===t.type&&v!==m.mark.type)).filter(m=>m.to>d).length)return null;f<n.to&&s.delete(f,n.to),d>n.from&&s.delete(n.from+u,d),c=n.from+u+a.length,s.addMark(n.from+u,c,t.type.create(o||{})),s.removeStoredMark(t.type)}}})}function qF(t){return t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}var rn="top",Fn="bottom",Bn="right",on="left",y0="auto",xu=[rn,Fn,Bn,on],Ya="start",Fc="end",GF="clippingParents",r_="viewport",Ml="popper",JF="reference",Xb=xu.reduce(function(t,e){return t.concat([e+"-"+Ya,e+"-"+Fc])},[]),i_=[].concat(xu,[y0]).reduce(function(t,e){return t.concat([e,e+"-"+Ya,e+"-"+Fc])},[]),YF="beforeRead",QF="read",XF="afterRead",ZF="beforeMain",e4="main",t4="afterMain",n4="beforeWrite",r4="write",i4="afterWrite",o4=[YF,QF,XF,ZF,e4,t4,n4,r4,i4];function Or(t){return t?(t.nodeName||"").toLowerCase():null}function vn(t){if(t==null)return window;if(t.toString()!=="[object Window]"){var e=t.ownerDocument;return e&&e.defaultView||window}return t}function ys(t){var e=vn(t).Element;return t instanceof e||t instanceof Element}function Dn(t){var e=vn(t).HTMLElement;return t instanceof e||t instanceof HTMLElement}function v0(t){if(typeof ShadowRoot>"u")return!1;var e=vn(t).ShadowRoot;return t instanceof e||t instanceof ShadowRoot}function s4(t){var e=t.state;Object.keys(e.elements).forEach(function(n){var r=e.styles[n]||{},i=e.attributes[n]||{},o=e.elements[n];!Dn(o)||!Or(o)||(Object.assign(o.style,r),Object.keys(i).forEach(function(s){var a=i[s];a===!1?o.removeAttribute(s):o.setAttribute(s,a===!0?"":a)}))})}function a4(t){var e=t.state,n={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,n.popper),e.styles=n,e.elements.arrow&&Object.assign(e.elements.arrow.style,n.arrow),function(){Object.keys(e.elements).forEach(function(r){var i=e.elements[r],o=e.attributes[r]||{},s=Object.keys(e.styles.hasOwnProperty(r)?e.styles[r]:n[r]),a=s.reduce(function(l,c){return l[c]="",l},{});!Dn(i)||!Or(i)||(Object.assign(i.style,a),Object.keys(o).forEach(function(l){i.removeAttribute(l)}))})}}const o_={name:"applyStyles",enabled:!0,phase:"write",fn:s4,effect:a4,requires:["computeStyles"]};function kr(t){return t.split("-")[0]}var ts=Math.max,jf=Math.min,Qa=Math.round;function py(){var t=navigator.userAgentData;return t!=null&&t.brands&&Array.isArray(t.brands)?t.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function s_(){return!/^((?!chrome|android).)*safari/i.test(py())}function Xa(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!1);var r=t.getBoundingClientRect(),i=1,o=1;e&&Dn(t)&&(i=t.offsetWidth>0&&Qa(r.width)/t.offsetWidth||1,o=t.offsetHeight>0&&Qa(r.height)/t.offsetHeight||1);var s=ys(t)?vn(t):window,a=s.visualViewport,l=!s_()&&n,c=(r.left+(l&&a?a.offsetLeft:0))/i,u=(r.top+(l&&a?a.offsetTop:0))/o,d=r.width/i,f=r.height/o;return{width:d,height:f,top:u,right:c+d,bottom:u+f,left:c,x:c,y:u}}function x0(t){var e=Xa(t),n=t.offsetWidth,r=t.offsetHeight;return Math.abs(e.width-n)<=1&&(n=e.width),Math.abs(e.height-r)<=1&&(r=e.height),{x:t.offsetLeft,y:t.offsetTop,width:n,height:r}}function a_(t,e){var n=e.getRootNode&&e.getRootNode();if(t.contains(e))return!0;if(n&&v0(n)){var r=e;do{if(r&&t.isSameNode(r))return!0;r=r.parentNode||r.host}while(r)}return!1}function ei(t){return vn(t).getComputedStyle(t)}function l4(t){return["table","td","th"].indexOf(Or(t))>=0}function mo(t){return((ys(t)?t.ownerDocument:t.document)||window.document).documentElement}function $h(t){return Or(t)==="html"?t:t.assignedSlot||t.parentNode||(v0(t)?t.host:null)||mo(t)}function Zb(t){return!Dn(t)||ei(t).position==="fixed"?null:t.offsetParent}function c4(t){var e=/firefox/i.test(py()),n=/Trident/i.test(py());if(n&&Dn(t)){var r=ei(t);if(r.position==="fixed")return null}var i=$h(t);for(v0(i)&&(i=i.host);Dn(i)&&["html","body"].indexOf(Or(i))<0;){var o=ei(i);if(o.transform!=="none"||o.perspective!=="none"||o.contain==="paint"||["transform","perspective"].indexOf(o.willChange)!==-1||e&&o.willChange==="filter"||e&&o.filter&&o.filter!=="none")return i;i=i.parentNode}return null}function wu(t){for(var e=vn(t),n=Zb(t);n&&l4(n)&&ei(n).position==="static";)n=Zb(n);return n&&(Or(n)==="html"||Or(n)==="body"&&ei(n).position==="static")?e:n||c4(t)||e}function w0(t){return["top","bottom"].indexOf(t)>=0?"x":"y"}function oc(t,e,n){return ts(t,jf(e,n))}function u4(t,e,n){var r=oc(t,e,n);return r>n?n:r}function l_(){return{top:0,right:0,bottom:0,left:0}}function c_(t){return Object.assign({},l_(),t)}function u_(t,e){return e.reduce(function(n,r){return n[r]=t,n},{})}var d4=function(e,n){return e=typeof e=="function"?e(Object.assign({},n.rects,{placement:n.placement})):e,c_(typeof e!="number"?e:u_(e,xu))};function f4(t){var e,n=t.state,r=t.name,i=t.options,o=n.elements.arrow,s=n.modifiersData.popperOffsets,a=kr(n.placement),l=w0(a),c=[on,Bn].indexOf(a)>=0,u=c?"height":"width";if(!(!o||!s)){var d=d4(i.padding,n),f=x0(o),p=l==="y"?rn:on,m=l==="y"?Fn:Bn,g=n.rects.reference[u]+n.rects.reference[l]-s[l]-n.rects.popper[u],v=s[l]-n.rects.reference[l],x=wu(o),w=x?l==="y"?x.clientHeight||0:x.clientWidth||0:0,S=g/2-v/2,b=d[p],C=w-f[u]-d[m],k=w/2-f[u]/2+S,E=oc(b,k,C),T=l;n.modifiersData[r]=(e={},e[T]=E,e.centerOffset=E-k,e)}}function h4(t){var e=t.state,n=t.options,r=n.element,i=r===void 0?"[data-popper-arrow]":r;i!=null&&(typeof i=="string"&&(i=e.elements.popper.querySelector(i),!i)||a_(e.elements.popper,i)&&(e.elements.arrow=i))}const p4={name:"arrow",enabled:!0,phase:"main",fn:f4,effect:h4,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Za(t){return t.split("-")[1]}var m4={top:"auto",right:"auto",bottom:"auto",left:"auto"};function g4(t,e){var n=t.x,r=t.y,i=e.devicePixelRatio||1;return{x:Qa(n*i)/i||0,y:Qa(r*i)/i||0}}function e1(t){var e,n=t.popper,r=t.popperRect,i=t.placement,o=t.variation,s=t.offsets,a=t.position,l=t.gpuAcceleration,c=t.adaptive,u=t.roundOffsets,d=t.isFixed,f=s.x,p=f===void 0?0:f,m=s.y,g=m===void 0?0:m,v=typeof u=="function"?u({x:p,y:g}):{x:p,y:g};p=v.x,g=v.y;var x=s.hasOwnProperty("x"),w=s.hasOwnProperty("y"),S=on,b=rn,C=window;if(c){var k=wu(n),E="clientHeight",T="clientWidth";if(k===vn(n)&&(k=mo(n),ei(k).position!=="static"&&a==="absolute"&&(E="scrollHeight",T="scrollWidth")),k=k,i===rn||(i===on||i===Bn)&&o===Fc){b=Fn;var O=d&&k===C&&C.visualViewport?C.visualViewport.height:k[E];g-=O-r.height,g*=l?1:-1}if(i===on||(i===rn||i===Fn)&&o===Fc){S=Bn;var R=d&&k===C&&C.visualViewport?C.visualViewport.width:k[T];p-=R-r.width,p*=l?1:-1}}var I=Object.assign({position:a},c&&m4),$=u===!0?g4({x:p,y:g},vn(n)):{x:p,y:g};if(p=$.x,g=$.y,l){var P;return Object.assign({},I,(P={},P[b]=w?"0":"",P[S]=x?"0":"",P.transform=(C.devicePixelRatio||1)<=1?"translate("+p+"px, "+g+"px)":"translate3d("+p+"px, "+g+"px, 0)",P))}return Object.assign({},I,(e={},e[b]=w?g+"px":"",e[S]=x?p+"px":"",e.transform="",e))}function y4(t){var e=t.state,n=t.options,r=n.gpuAcceleration,i=r===void 0?!0:r,o=n.adaptive,s=o===void 0?!0:o,a=n.roundOffsets,l=a===void 0?!0:a,c={placement:kr(e.placement),variation:Za(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:i,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,e1(Object.assign({},c,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:s,roundOffsets:l})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,e1(Object.assign({},c,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const v4={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:y4,data:{}};var fd={passive:!0};function x4(t){var e=t.state,n=t.instance,r=t.options,i=r.scroll,o=i===void 0?!0:i,s=r.resize,a=s===void 0?!0:s,l=vn(e.elements.popper),c=[].concat(e.scrollParents.reference,e.scrollParents.popper);return o&&c.forEach(function(u){u.addEventListener("scroll",n.update,fd)}),a&&l.addEventListener("resize",n.update,fd),function(){o&&c.forEach(function(u){u.removeEventListener("scroll",n.update,fd)}),a&&l.removeEventListener("resize",n.update,fd)}}const w4={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:x4,data:{}};var b4={left:"right",right:"left",bottom:"top",top:"bottom"};function Ud(t){return t.replace(/left|right|bottom|top/g,function(e){return b4[e]})}var S4={start:"end",end:"start"};function t1(t){return t.replace(/start|end/g,function(e){return S4[e]})}function b0(t){var e=vn(t),n=e.pageXOffset,r=e.pageYOffset;return{scrollLeft:n,scrollTop:r}}function S0(t){return Xa(mo(t)).left+b0(t).scrollLeft}function C4(t,e){var n=vn(t),r=mo(t),i=n.visualViewport,o=r.clientWidth,s=r.clientHeight,a=0,l=0;if(i){o=i.width,s=i.height;var c=s_();(c||!c&&e==="fixed")&&(a=i.offsetLeft,l=i.offsetTop)}return{width:o,height:s,x:a+S0(t),y:l}}function k4(t){var e,n=mo(t),r=b0(t),i=(e=t.ownerDocument)==null?void 0:e.body,o=ts(n.scrollWidth,n.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),s=ts(n.scrollHeight,n.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),a=-r.scrollLeft+S0(t),l=-r.scrollTop;return ei(i||n).direction==="rtl"&&(a+=ts(n.clientWidth,i?i.clientWidth:0)-o),{width:o,height:s,x:a,y:l}}function C0(t){var e=ei(t),n=e.overflow,r=e.overflowX,i=e.overflowY;return/auto|scroll|overlay|hidden/.test(n+i+r)}function d_(t){return["html","body","#document"].indexOf(Or(t))>=0?t.ownerDocument.body:Dn(t)&&C0(t)?t:d_($h(t))}function sc(t,e){var n;e===void 0&&(e=[]);var r=d_(t),i=r===((n=t.ownerDocument)==null?void 0:n.body),o=vn(r),s=i?[o].concat(o.visualViewport||[],C0(r)?r:[]):r,a=e.concat(s);return i?a:a.concat(sc($h(s)))}function my(t){return Object.assign({},t,{left:t.x,top:t.y,right:t.x+t.width,bottom:t.y+t.height})}function E4(t,e){var n=Xa(t,!1,e==="fixed");return n.top=n.top+t.clientTop,n.left=n.left+t.clientLeft,n.bottom=n.top+t.clientHeight,n.right=n.left+t.clientWidth,n.width=t.clientWidth,n.height=t.clientHeight,n.x=n.left,n.y=n.top,n}function n1(t,e,n){return e===r_?my(C4(t,n)):ys(e)?E4(e,n):my(k4(mo(t)))}function T4(t){var e=sc($h(t)),n=["absolute","fixed"].indexOf(ei(t).position)>=0,r=n&&Dn(t)?wu(t):t;return ys(r)?e.filter(function(i){return ys(i)&&a_(i,r)&&Or(i)!=="body"}):[]}function _4(t,e,n,r){var i=e==="clippingParents"?T4(t):[].concat(e),o=[].concat(i,[n]),s=o[0],a=o.reduce(function(l,c){var u=n1(t,c,r);return l.top=ts(u.top,l.top),l.right=jf(u.right,l.right),l.bottom=jf(u.bottom,l.bottom),l.left=ts(u.left,l.left),l},n1(t,s,r));return a.width=a.right-a.left,a.height=a.bottom-a.top,a.x=a.left,a.y=a.top,a}function f_(t){var e=t.reference,n=t.element,r=t.placement,i=r?kr(r):null,o=r?Za(r):null,s=e.x+e.width/2-n.width/2,a=e.y+e.height/2-n.height/2,l;switch(i){case rn:l={x:s,y:e.y-n.height};break;case Fn:l={x:s,y:e.y+e.height};break;case Bn:l={x:e.x+e.width,y:a};break;case on:l={x:e.x-n.width,y:a};break;default:l={x:e.x,y:e.y}}var c=i?w0(i):null;if(c!=null){var u=c==="y"?"height":"width";switch(o){case Ya:l[c]=l[c]-(e[u]/2-n[u]/2);break;case Fc:l[c]=l[c]+(e[u]/2-n[u]/2);break}}return l}function Bc(t,e){e===void 0&&(e={});var n=e,r=n.placement,i=r===void 0?t.placement:r,o=n.strategy,s=o===void 0?t.strategy:o,a=n.boundary,l=a===void 0?GF:a,c=n.rootBoundary,u=c===void 0?r_:c,d=n.elementContext,f=d===void 0?Ml:d,p=n.altBoundary,m=p===void 0?!1:p,g=n.padding,v=g===void 0?0:g,x=c_(typeof v!="number"?v:u_(v,xu)),w=f===Ml?JF:Ml,S=t.rects.popper,b=t.elements[m?w:f],C=_4(ys(b)?b:b.contextElement||mo(t.elements.popper),l,u,s),k=Xa(t.elements.reference),E=f_({reference:k,element:S,strategy:"absolute",placement:i}),T=my(Object.assign({},S,E)),O=f===Ml?T:k,R={top:C.top-O.top+x.top,bottom:O.bottom-C.bottom+x.bottom,left:C.left-O.left+x.left,right:O.right-C.right+x.right},I=t.modifiersData.offset;if(f===Ml&&I){var $=I[i];Object.keys(R).forEach(function(P){var M=[Bn,Fn].indexOf(P)>=0?1:-1,z=[rn,Fn].indexOf(P)>=0?"y":"x";R[P]+=$[z]*M})}return R}function R4(t,e){e===void 0&&(e={});var n=e,r=n.placement,i=n.boundary,o=n.rootBoundary,s=n.padding,a=n.flipVariations,l=n.allowedAutoPlacements,c=l===void 0?i_:l,u=Za(r),d=u?a?Xb:Xb.filter(function(m){return Za(m)===u}):xu,f=d.filter(function(m){return c.indexOf(m)>=0});f.length===0&&(f=d);var p=f.reduce(function(m,g){return m[g]=Bc(t,{placement:g,boundary:i,rootBoundary:o,padding:s})[kr(g)],m},{});return Object.keys(p).sort(function(m,g){return p[m]-p[g]})}function O4(t){if(kr(t)===y0)return[];var e=Ud(t);return[t1(t),e,t1(e)]}function P4(t){var e=t.state,n=t.options,r=t.name;if(!e.modifiersData[r]._skip){for(var i=n.mainAxis,o=i===void 0?!0:i,s=n.altAxis,a=s===void 0?!0:s,l=n.fallbackPlacements,c=n.padding,u=n.boundary,d=n.rootBoundary,f=n.altBoundary,p=n.flipVariations,m=p===void 0?!0:p,g=n.allowedAutoPlacements,v=e.options.placement,x=kr(v),w=x===v,S=l||(w||!m?[Ud(v)]:O4(v)),b=[v].concat(S).reduce(function(Z,xe){return Z.concat(kr(xe)===y0?R4(e,{placement:xe,boundary:u,rootBoundary:d,padding:c,flipVariations:m,allowedAutoPlacements:g}):xe)},[]),C=e.rects.reference,k=e.rects.popper,E=new Map,T=!0,O=b[0],R=0;R<b.length;R++){var I=b[R],$=kr(I),P=Za(I)===Ya,M=[rn,Fn].indexOf($)>=0,z=M?"width":"height",B=Bc(e,{placement:I,boundary:u,rootBoundary:d,altBoundary:f,padding:c}),H=M?P?Bn:on:P?Fn:rn;C[z]>k[z]&&(H=Ud(H));var A=Ud(H),D=[];if(o&&D.push(B[$]<=0),a&&D.push(B[H]<=0,B[A]<=0),D.every(function(Z){return Z})){O=I,T=!1;break}E.set(I,D)}if(T)for(var L=m?3:1,Y=function(xe){var we=b.find(function(ze){var kt=E.get(ze);if(kt)return kt.slice(0,xe).every(function(qe){return qe})});if(we)return O=we,"break"},ee=L;ee>0;ee--){var G=Y(ee);if(G==="break")break}e.placement!==O&&(e.modifiersData[r]._skip=!0,e.placement=O,e.reset=!0)}}const M4={name:"flip",enabled:!0,phase:"main",fn:P4,requiresIfExists:["offset"],data:{_skip:!1}};function r1(t,e,n){return n===void 0&&(n={x:0,y:0}),{top:t.top-e.height-n.y,right:t.right-e.width+n.x,bottom:t.bottom-e.height+n.y,left:t.left-e.width-n.x}}function i1(t){return[rn,Bn,Fn,on].some(function(e){return t[e]>=0})}function A4(t){var e=t.state,n=t.name,r=e.rects.reference,i=e.rects.popper,o=e.modifiersData.preventOverflow,s=Bc(e,{elementContext:"reference"}),a=Bc(e,{altBoundary:!0}),l=r1(s,r),c=r1(a,i,o),u=i1(l),d=i1(c);e.modifiersData[n]={referenceClippingOffsets:l,popperEscapeOffsets:c,isReferenceHidden:u,hasPopperEscaped:d},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":u,"data-popper-escaped":d})}const D4={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:A4};function I4(t,e,n){var r=kr(t),i=[on,rn].indexOf(r)>=0?-1:1,o=typeof n=="function"?n(Object.assign({},e,{placement:t})):n,s=o[0],a=o[1];return s=s||0,a=(a||0)*i,[on,Bn].indexOf(r)>=0?{x:a,y:s}:{x:s,y:a}}function N4(t){var e=t.state,n=t.options,r=t.name,i=n.offset,o=i===void 0?[0,0]:i,s=i_.reduce(function(u,d){return u[d]=I4(d,e.rects,o),u},{}),a=s[e.placement],l=a.x,c=a.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=l,e.modifiersData.popperOffsets.y+=c),e.modifiersData[r]=s}const j4={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:N4};function L4(t){var e=t.state,n=t.name;e.modifiersData[n]=f_({reference:e.rects.reference,element:e.rects.popper,strategy:"absolute",placement:e.placement})}const $4={name:"popperOffsets",enabled:!0,phase:"read",fn:L4,data:{}};function F4(t){return t==="x"?"y":"x"}function B4(t){var e=t.state,n=t.options,r=t.name,i=n.mainAxis,o=i===void 0?!0:i,s=n.altAxis,a=s===void 0?!1:s,l=n.boundary,c=n.rootBoundary,u=n.altBoundary,d=n.padding,f=n.tether,p=f===void 0?!0:f,m=n.tetherOffset,g=m===void 0?0:m,v=Bc(e,{boundary:l,rootBoundary:c,padding:d,altBoundary:u}),x=kr(e.placement),w=Za(e.placement),S=!w,b=w0(x),C=F4(b),k=e.modifiersData.popperOffsets,E=e.rects.reference,T=e.rects.popper,O=typeof g=="function"?g(Object.assign({},e.rects,{placement:e.placement})):g,R=typeof O=="number"?{mainAxis:O,altAxis:O}:Object.assign({mainAxis:0,altAxis:0},O),I=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,$={x:0,y:0};if(k){if(o){var P,M=b==="y"?rn:on,z=b==="y"?Fn:Bn,B=b==="y"?"height":"width",H=k[b],A=H+v[M],D=H-v[z],L=p?-T[B]/2:0,Y=w===Ya?E[B]:T[B],ee=w===Ya?-T[B]:-E[B],G=e.elements.arrow,Z=p&&G?x0(G):{width:0,height:0},xe=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:l_(),we=xe[M],ze=xe[z],kt=oc(0,E[B],Z[B]),qe=S?E[B]/2-L-kt-we-R.mainAxis:Y-kt-we-R.mainAxis,Ut=S?-E[B]/2+L+kt+ze+R.mainAxis:ee+kt+ze+R.mainAxis,Ar=e.elements.arrow&&wu(e.elements.arrow),xo=Ar?b==="y"?Ar.clientTop||0:Ar.clientLeft||0:0,Vn=(P=I==null?void 0:I[b])!=null?P:0,wo=H+qe-Vn-xo,Rs=H+Ut-Vn,bo=oc(p?jf(A,wo):A,H,p?ts(D,Rs):D);k[b]=bo,$[b]=bo-H}if(a){var So,Os=b==="x"?rn:on,Dr=b==="x"?Fn:Bn,Ir=k[C],ii=C==="y"?"height":"width",vl=Ir+v[Os],Co=Ir-v[Dr],xl=[rn,on].indexOf(x)!==-1,Ou=(So=I==null?void 0:I[C])!=null?So:0,Pu=xl?vl:Ir-E[ii]-T[ii]-Ou+R.altAxis,Mu=xl?Ir+E[ii]+T[ii]-Ou-R.altAxis:Co,Au=p&&xl?u4(Pu,Ir,Mu):oc(p?Pu:vl,Ir,p?Mu:Co);k[C]=Au,$[C]=Au-Ir}e.modifiersData[r]=$}}const z4={name:"preventOverflow",enabled:!0,phase:"main",fn:B4,requiresIfExists:["offset"]};function U4(t){return{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}}function V4(t){return t===vn(t)||!Dn(t)?b0(t):U4(t)}function H4(t){var e=t.getBoundingClientRect(),n=Qa(e.width)/t.offsetWidth||1,r=Qa(e.height)/t.offsetHeight||1;return n!==1||r!==1}function W4(t,e,n){n===void 0&&(n=!1);var r=Dn(e),i=Dn(e)&&H4(e),o=mo(e),s=Xa(t,i,n),a={scrollLeft:0,scrollTop:0},l={x:0,y:0};return(r||!r&&!n)&&((Or(e)!=="body"||C0(o))&&(a=V4(e)),Dn(e)?(l=Xa(e,!0),l.x+=e.clientLeft,l.y+=e.clientTop):o&&(l.x=S0(o))),{x:s.left+a.scrollLeft-l.x,y:s.top+a.scrollTop-l.y,width:s.width,height:s.height}}function K4(t){var e=new Map,n=new Set,r=[];t.forEach(function(o){e.set(o.name,o)});function i(o){n.add(o.name);var s=[].concat(o.requires||[],o.requiresIfExists||[]);s.forEach(function(a){if(!n.has(a)){var l=e.get(a);l&&i(l)}}),r.push(o)}return t.forEach(function(o){n.has(o.name)||i(o)}),r}function q4(t){var e=K4(t);return o4.reduce(function(n,r){return n.concat(e.filter(function(i){return i.phase===r}))},[])}function G4(t){var e;return function(){return e||(e=new Promise(function(n){Promise.resolve().then(function(){e=void 0,n(t())})})),e}}function J4(t){var e=t.reduce(function(n,r){var i=n[r.name];return n[r.name]=i?Object.assign({},i,r,{options:Object.assign({},i.options,r.options),data:Object.assign({},i.data,r.data)}):r,n},{});return Object.keys(e).map(function(n){return e[n]})}var o1={placement:"bottom",modifiers:[],strategy:"absolute"};function s1(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return!e.some(function(r){return!(r&&typeof r.getBoundingClientRect=="function")})}function Y4(t){t===void 0&&(t={});var e=t,n=e.defaultModifiers,r=n===void 0?[]:n,i=e.defaultOptions,o=i===void 0?o1:i;return function(a,l,c){c===void 0&&(c=o);var u={placement:"bottom",orderedModifiers:[],options:Object.assign({},o1,o),modifiersData:{},elements:{reference:a,popper:l},attributes:{},styles:{}},d=[],f=!1,p={state:u,setOptions:function(x){var w=typeof x=="function"?x(u.options):x;g(),u.options=Object.assign({},o,u.options,w),u.scrollParents={reference:ys(a)?sc(a):a.contextElement?sc(a.contextElement):[],popper:sc(l)};var S=q4(J4([].concat(r,u.options.modifiers)));return u.orderedModifiers=S.filter(function(b){return b.enabled}),m(),p.update()},forceUpdate:function(){if(!f){var x=u.elements,w=x.reference,S=x.popper;if(s1(w,S)){u.rects={reference:W4(w,wu(S),u.options.strategy==="fixed"),popper:x0(S)},u.reset=!1,u.placement=u.options.placement,u.orderedModifiers.forEach(function(R){return u.modifiersData[R.name]=Object.assign({},R.data)});for(var b=0;b<u.orderedModifiers.length;b++){if(u.reset===!0){u.reset=!1,b=-1;continue}var C=u.orderedModifiers[b],k=C.fn,E=C.options,T=E===void 0?{}:E,O=C.name;typeof k=="function"&&(u=k({state:u,options:T,name:O,instance:p})||u)}}}},update:G4(function(){return new Promise(function(v){p.forceUpdate(),v(u)})}),destroy:function(){g(),f=!0}};if(!s1(a,l))return p;p.setOptions(c).then(function(v){!f&&c.onFirstUpdate&&c.onFirstUpdate(v)});function m(){u.orderedModifiers.forEach(function(v){var x=v.name,w=v.options,S=w===void 0?{}:w,b=v.effect;if(typeof b=="function"){var C=b({state:u,name:x,instance:p,options:S}),k=function(){};d.push(C||k)}})}function g(){d.forEach(function(v){return v()}),d=[]}return p}}var Q4=[w4,$4,v4,o_,j4,M4,z4,p4,D4],X4=Y4({defaultModifiers:Q4}),Z4="tippy-box",h_="tippy-content",eB="tippy-backdrop",p_="tippy-arrow",m_="tippy-svg-arrow",Po={passive:!0,capture:!0},g_=function(){return document.body};function rm(t,e,n){if(Array.isArray(t)){var r=t[e];return r??(Array.isArray(n)?n[e]:n)}return t}function k0(t,e){var n={}.toString.call(t);return n.indexOf("[object")===0&&n.indexOf(e+"]")>-1}function y_(t,e){return typeof t=="function"?t.apply(void 0,e):t}function a1(t,e){if(e===0)return t;var n;return function(r){clearTimeout(n),n=setTimeout(function(){t(r)},e)}}function tB(t){return t.split(/\s+/).filter(Boolean)}function Ks(t){return[].concat(t)}function l1(t,e){t.indexOf(e)===-1&&t.push(e)}function nB(t){return t.filter(function(e,n){return t.indexOf(e)===n})}function rB(t){return t.split("-")[0]}function Lf(t){return[].slice.call(t)}function c1(t){return Object.keys(t).reduce(function(e,n){return t[n]!==void 0&&(e[n]=t[n]),e},{})}function ac(){return document.createElement("div")}function Fh(t){return["Element","Fragment"].some(function(e){return k0(t,e)})}function iB(t){return k0(t,"NodeList")}function oB(t){return k0(t,"MouseEvent")}function sB(t){return!!(t&&t._tippy&&t._tippy.reference===t)}function aB(t){return Fh(t)?[t]:iB(t)?Lf(t):Array.isArray(t)?t:Lf(document.querySelectorAll(t))}function im(t,e){t.forEach(function(n){n&&(n.style.transitionDuration=e+"ms")})}function u1(t,e){t.forEach(function(n){n&&n.setAttribute("data-state",e)})}function lB(t){var e,n=Ks(t),r=n[0];return r!=null&&(e=r.ownerDocument)!=null&&e.body?r.ownerDocument:document}function cB(t,e){var n=e.clientX,r=e.clientY;return t.every(function(i){var o=i.popperRect,s=i.popperState,a=i.props,l=a.interactiveBorder,c=rB(s.placement),u=s.modifiersData.offset;if(!u)return!0;var d=c==="bottom"?u.top.y:0,f=c==="top"?u.bottom.y:0,p=c==="right"?u.left.x:0,m=c==="left"?u.right.x:0,g=o.top-r+d>l,v=r-o.bottom-f>l,x=o.left-n+p>l,w=n-o.right-m>l;return g||v||x||w})}function om(t,e,n){var r=e+"EventListener";["transitionend","webkitTransitionEnd"].forEach(function(i){t[r](i,n)})}function d1(t,e){for(var n=e;n;){var r;if(t.contains(n))return!0;n=n.getRootNode==null||(r=n.getRootNode())==null?void 0:r.host}return!1}var vr={isTouch:!1},f1=0;function uB(){vr.isTouch||(vr.isTouch=!0,window.performance&&document.addEventListener("mousemove",v_))}function v_(){var t=performance.now();t-f1<20&&(vr.isTouch=!1,document.removeEventListener("mousemove",v_)),f1=t}function dB(){var t=document.activeElement;if(sB(t)){var e=t._tippy;t.blur&&!e.state.isVisible&&t.blur()}}function fB(){document.addEventListener("touchstart",uB,Po),window.addEventListener("blur",dB)}var hB=typeof window<"u"&&typeof document<"u",pB=hB?!!window.msCrypto:!1,mB={animateFill:!1,followCursor:!1,inlinePositioning:!1,sticky:!1},gB={allowHTML:!1,animation:"fade",arrow:!0,content:"",inertia:!1,maxWidth:350,role:"tooltip",theme:"",zIndex:9999},Xn=Object.assign({appendTo:g_,aria:{content:"auto",expanded:"auto"},delay:0,duration:[300,250],getReferenceClientRect:null,hideOnClick:!0,ignoreAttributes:!1,interactive:!1,interactiveBorder:2,interactiveDebounce:0,moveTransition:"",offset:[0,10],onAfterUpdate:function(){},onBeforeUpdate:function(){},onCreate:function(){},onDestroy:function(){},onHidden:function(){},onHide:function(){},onMount:function(){},onShow:function(){},onShown:function(){},onTrigger:function(){},onUntrigger:function(){},onClickOutside:function(){},placement:"top",plugins:[],popperOptions:{},render:null,showOnCreate:!1,touch:!0,trigger:"mouseenter focus",triggerTarget:null},mB,gB),yB=Object.keys(Xn),vB=function(e){var n=Object.keys(e);n.forEach(function(r){Xn[r]=e[r]})};function x_(t){var e=t.plugins||[],n=e.reduce(function(r,i){var o=i.name,s=i.defaultValue;if(o){var a;r[o]=t[o]!==void 0?t[o]:(a=Xn[o])!=null?a:s}return r},{});return Object.assign({},t,n)}function xB(t,e){var n=e?Object.keys(x_(Object.assign({},Xn,{plugins:e}))):yB,r=n.reduce(function(i,o){var s=(t.getAttribute("data-tippy-"+o)||"").trim();if(!s)return i;if(o==="content")i[o]=s;else try{i[o]=JSON.parse(s)}catch{i[o]=s}return i},{});return r}function h1(t,e){var n=Object.assign({},e,{content:y_(e.content,[t])},e.ignoreAttributes?{}:xB(t,e.plugins));return n.aria=Object.assign({},Xn.aria,n.aria),n.aria={expanded:n.aria.expanded==="auto"?e.interactive:n.aria.expanded,content:n.aria.content==="auto"?e.interactive?null:"describedby":n.aria.content},n}var wB=function(){return"innerHTML"};function gy(t,e){t[wB()]=e}function p1(t){var e=ac();return t===!0?e.className=p_:(e.className=m_,Fh(t)?e.appendChild(t):gy(e,t)),e}function m1(t,e){Fh(e.content)?(gy(t,""),t.appendChild(e.content)):typeof e.content!="function"&&(e.allowHTML?gy(t,e.content):t.textContent=e.content)}function yy(t){var e=t.firstElementChild,n=Lf(e.children);return{box:e,content:n.find(function(r){return r.classList.contains(h_)}),arrow:n.find(function(r){return r.classList.contains(p_)||r.classList.contains(m_)}),backdrop:n.find(function(r){return r.classList.contains(eB)})}}function w_(t){var e=ac(),n=ac();n.className=Z4,n.setAttribute("data-state","hidden"),n.setAttribute("tabindex","-1");var r=ac();r.className=h_,r.setAttribute("data-state","hidden"),m1(r,t.props),e.appendChild(n),n.appendChild(r),i(t.props,t.props);function i(o,s){var a=yy(e),l=a.box,c=a.content,u=a.arrow;s.theme?l.setAttribute("data-theme",s.theme):l.removeAttribute("data-theme"),typeof s.animation=="string"?l.setAttribute("data-animation",s.animation):l.removeAttribute("data-animation"),s.inertia?l.setAttribute("data-inertia",""):l.removeAttribute("data-inertia"),l.style.maxWidth=typeof s.maxWidth=="number"?s.maxWidth+"px":s.maxWidth,s.role?l.setAttribute("role",s.role):l.removeAttribute("role"),(o.content!==s.content||o.allowHTML!==s.allowHTML)&&m1(c,t.props),s.arrow?u?o.arrow!==s.arrow&&(l.removeChild(u),l.appendChild(p1(s.arrow))):l.appendChild(p1(s.arrow)):u&&l.removeChild(u)}return{popper:e,onUpdate:i}}w_.$$tippy=!0;var bB=1,hd=[],sm=[];function SB(t,e){var n=h1(t,Object.assign({},Xn,x_(c1(e)))),r,i,o,s=!1,a=!1,l=!1,c=!1,u,d,f,p=[],m=a1(wo,n.interactiveDebounce),g,v=bB++,x=null,w=nB(n.plugins),S={isEnabled:!0,isVisible:!1,isDestroyed:!1,isMounted:!1,isShown:!1},b={id:v,reference:t,popper:ac(),popperInstance:x,props:n,state:S,plugins:w,clearDelayTimeouts:Pu,setProps:Mu,setContent:Au,show:KO,hide:qO,hideWithInteractivity:GO,enable:xl,disable:Ou,unmount:JO,destroy:YO};if(!n.render)return b;var C=n.render(b),k=C.popper,E=C.onUpdate;k.setAttribute("data-tippy-root",""),k.id="tippy-"+b.id,b.popper=k,t._tippy=b,k._tippy=b;var T=w.map(function(N){return N.fn(b)}),O=t.hasAttribute("aria-expanded");return Ar(),L(),H(),A("onCreate",[b]),n.showOnCreate&&vl(),k.addEventListener("mouseenter",function(){b.props.interactive&&b.state.isVisible&&b.clearDelayTimeouts()}),k.addEventListener("mouseleave",function(){b.props.interactive&&b.props.trigger.indexOf("mouseenter")>=0&&M().addEventListener("mousemove",m)}),b;function R(){var N=b.props.touch;return Array.isArray(N)?N:[N,0]}function I(){return R()[0]==="hold"}function $(){var N;return!!((N=b.props.render)!=null&&N.$$tippy)}function P(){return g||t}function M(){var N=P().parentNode;return N?lB(N):document}function z(){return yy(k)}function B(N){return b.state.isMounted&&!b.state.isVisible||vr.isTouch||u&&u.type==="focus"?0:rm(b.props.delay,N?0:1,Xn.delay)}function H(N){N===void 0&&(N=!1),k.style.pointerEvents=b.props.interactive&&!N?"":"none",k.style.zIndex=""+b.props.zIndex}function A(N,J,re){if(re===void 0&&(re=!0),T.forEach(function(fe){fe[N]&&fe[N].apply(fe,J)}),re){var pe;(pe=b.props)[N].apply(pe,J)}}function D(){var N=b.props.aria;if(N.content){var J="aria-"+N.content,re=k.id,pe=Ks(b.props.triggerTarget||t);pe.forEach(function(fe){var Et=fe.getAttribute(J);if(b.state.isVisible)fe.setAttribute(J,Et?Et+" "+re:re);else{var Sn=Et&&Et.replace(re,"").trim();Sn?fe.setAttribute(J,Sn):fe.removeAttribute(J)}})}}function L(){if(!(O||!b.props.aria.expanded)){var N=Ks(b.props.triggerTarget||t);N.forEach(function(J){b.props.interactive?J.setAttribute("aria-expanded",b.state.isVisible&&J===P()?"true":"false"):J.removeAttribute("aria-expanded")})}}function Y(){M().removeEventListener("mousemove",m),hd=hd.filter(function(N){return N!==m})}function ee(N){if(!(vr.isTouch&&(l||N.type==="mousedown"))){var J=N.composedPath&&N.composedPath()[0]||N.target;if(!(b.props.interactive&&d1(k,J))){if(Ks(b.props.triggerTarget||t).some(function(re){return d1(re,J)})){if(vr.isTouch||b.state.isVisible&&b.props.trigger.indexOf("click")>=0)return}else A("onClickOutside",[b,N]);b.props.hideOnClick===!0&&(b.clearDelayTimeouts(),b.hide(),a=!0,setTimeout(function(){a=!1}),b.state.isMounted||we())}}}function G(){l=!0}function Z(){l=!1}function xe(){var N=M();N.addEventListener("mousedown",ee,!0),N.addEventListener("touchend",ee,Po),N.addEventListener("touchstart",Z,Po),N.addEventListener("touchmove",G,Po)}function we(){var N=M();N.removeEventListener("mousedown",ee,!0),N.removeEventListener("touchend",ee,Po),N.removeEventListener("touchstart",Z,Po),N.removeEventListener("touchmove",G,Po)}function ze(N,J){qe(N,function(){!b.state.isVisible&&k.parentNode&&k.parentNode.contains(k)&&J()})}function kt(N,J){qe(N,J)}function qe(N,J){var re=z().box;function pe(fe){fe.target===re&&(om(re,"remove",pe),J())}if(N===0)return J();om(re,"remove",d),om(re,"add",pe),d=pe}function Ut(N,J,re){re===void 0&&(re=!1);var pe=Ks(b.props.triggerTarget||t);pe.forEach(function(fe){fe.addEventListener(N,J,re),p.push({node:fe,eventType:N,handler:J,options:re})})}function Ar(){I()&&(Ut("touchstart",Vn,{passive:!0}),Ut("touchend",Rs,{passive:!0})),tB(b.props.trigger).forEach(function(N){if(N!=="manual")switch(Ut(N,Vn),N){case"mouseenter":Ut("mouseleave",Rs);break;case"focus":Ut(pB?"focusout":"blur",bo);break;case"focusin":Ut("focusout",bo);break}})}function xo(){p.forEach(function(N){var J=N.node,re=N.eventType,pe=N.handler,fe=N.options;J.removeEventListener(re,pe,fe)}),p=[]}function Vn(N){var J,re=!1;if(!(!b.state.isEnabled||So(N)||a)){var pe=((J=u)==null?void 0:J.type)==="focus";u=N,g=N.currentTarget,L(),!b.state.isVisible&&oB(N)&&hd.forEach(function(fe){return fe(N)}),N.type==="click"&&(b.props.trigger.indexOf("mouseenter")<0||s)&&b.props.hideOnClick!==!1&&b.state.isVisible?re=!0:vl(N),N.type==="click"&&(s=!re),re&&!pe&&Co(N)}}function wo(N){var J=N.target,re=P().contains(J)||k.contains(J);if(!(N.type==="mousemove"&&re)){var pe=ii().concat(k).map(function(fe){var Et,Sn=fe._tippy,Ps=(Et=Sn.popperInstance)==null?void 0:Et.state;return Ps?{popperRect:fe.getBoundingClientRect(),popperState:Ps,props:n}:null}).filter(Boolean);cB(pe,N)&&(Y(),Co(N))}}function Rs(N){var J=So(N)||b.props.trigger.indexOf("click")>=0&&s;if(!J){if(b.props.interactive){b.hideWithInteractivity(N);return}Co(N)}}function bo(N){b.props.trigger.indexOf("focusin")<0&&N.target!==P()||b.props.interactive&&N.relatedTarget&&k.contains(N.relatedTarget)||Co(N)}function So(N){return vr.isTouch?I()!==N.type.indexOf("touch")>=0:!1}function Os(){Dr();var N=b.props,J=N.popperOptions,re=N.placement,pe=N.offset,fe=N.getReferenceClientRect,Et=N.moveTransition,Sn=$()?yy(k).arrow:null,Ps=fe?{getBoundingClientRect:fe,contextElement:fe.contextElement||P()}:t,lx={name:"$$tippy",enabled:!0,phase:"beforeWrite",requires:["computeStyles"],fn:function(Du){var Ms=Du.state;if($()){var QO=z(),rp=QO.box;["placement","reference-hidden","escaped"].forEach(function(Iu){Iu==="placement"?rp.setAttribute("data-placement",Ms.placement):Ms.attributes.popper["data-popper-"+Iu]?rp.setAttribute("data-"+Iu,""):rp.removeAttribute("data-"+Iu)}),Ms.attributes.popper={}}}},ko=[{name:"offset",options:{offset:pe}},{name:"preventOverflow",options:{padding:{top:2,bottom:2,left:5,right:5}}},{name:"flip",options:{padding:5}},{name:"computeStyles",options:{adaptive:!Et}},lx];$()&&Sn&&ko.push({name:"arrow",options:{element:Sn,padding:3}}),ko.push.apply(ko,(J==null?void 0:J.modifiers)||[]),b.popperInstance=X4(Ps,k,Object.assign({},J,{placement:re,onFirstUpdate:f,modifiers:ko}))}function Dr(){b.popperInstance&&(b.popperInstance.destroy(),b.popperInstance=null)}function Ir(){var N=b.props.appendTo,J,re=P();b.props.interactive&&N===g_||N==="parent"?J=re.parentNode:J=y_(N,[re]),J.contains(k)||J.appendChild(k),b.state.isMounted=!0,Os()}function ii(){return Lf(k.querySelectorAll("[data-tippy-root]"))}function vl(N){b.clearDelayTimeouts(),N&&A("onTrigger",[b,N]),xe();var J=B(!0),re=R(),pe=re[0],fe=re[1];vr.isTouch&&pe==="hold"&&fe&&(J=fe),J?r=setTimeout(function(){b.show()},J):b.show()}function Co(N){if(b.clearDelayTimeouts(),A("onUntrigger",[b,N]),!b.state.isVisible){we();return}if(!(b.props.trigger.indexOf("mouseenter")>=0&&b.props.trigger.indexOf("click")>=0&&["mouseleave","mousemove"].indexOf(N.type)>=0&&s)){var J=B(!1);J?i=setTimeout(function(){b.state.isVisible&&b.hide()},J):o=requestAnimationFrame(function(){b.hide()})}}function xl(){b.state.isEnabled=!0}function Ou(){b.hide(),b.state.isEnabled=!1}function Pu(){clearTimeout(r),clearTimeout(i),cancelAnimationFrame(o)}function Mu(N){if(!b.state.isDestroyed){A("onBeforeUpdate",[b,N]),xo();var J=b.props,re=h1(t,Object.assign({},J,c1(N),{ignoreAttributes:!0}));b.props=re,Ar(),J.interactiveDebounce!==re.interactiveDebounce&&(Y(),m=a1(wo,re.interactiveDebounce)),J.triggerTarget&&!re.triggerTarget?Ks(J.triggerTarget).forEach(function(pe){pe.removeAttribute("aria-expanded")}):re.triggerTarget&&t.removeAttribute("aria-expanded"),L(),H(),E&&E(J,re),b.popperInstance&&(Os(),ii().forEach(function(pe){requestAnimationFrame(pe._tippy.popperInstance.forceUpdate)})),A("onAfterUpdate",[b,N])}}function Au(N){b.setProps({content:N})}function KO(){var N=b.state.isVisible,J=b.state.isDestroyed,re=!b.state.isEnabled,pe=vr.isTouch&&!b.props.touch,fe=rm(b.props.duration,0,Xn.duration);if(!(N||J||re||pe)&&!P().hasAttribute("disabled")&&(A("onShow",[b],!1),b.props.onShow(b)!==!1)){if(b.state.isVisible=!0,$()&&(k.style.visibility="visible"),H(),xe(),b.state.isMounted||(k.style.transition="none"),$()){var Et=z(),Sn=Et.box,Ps=Et.content;im([Sn,Ps],0)}f=function(){var ko;if(!(!b.state.isVisible||c)){if(c=!0,k.offsetHeight,k.style.transition=b.props.moveTransition,$()&&b.props.animation){var np=z(),Du=np.box,Ms=np.content;im([Du,Ms],fe),u1([Du,Ms],"visible")}D(),L(),l1(sm,b),(ko=b.popperInstance)==null||ko.forceUpdate(),A("onMount",[b]),b.props.animation&&$()&&kt(fe,function(){b.state.isShown=!0,A("onShown",[b])})}},Ir()}}function qO(){var N=!b.state.isVisible,J=b.state.isDestroyed,re=!b.state.isEnabled,pe=rm(b.props.duration,1,Xn.duration);if(!(N||J||re)&&(A("onHide",[b],!1),b.props.onHide(b)!==!1)){if(b.state.isVisible=!1,b.state.isShown=!1,c=!1,s=!1,$()&&(k.style.visibility="hidden"),Y(),we(),H(!0),$()){var fe=z(),Et=fe.box,Sn=fe.content;b.props.animation&&(im([Et,Sn],pe),u1([Et,Sn],"hidden"))}D(),L(),b.props.animation?$()&&ze(pe,b.unmount):b.unmount()}}function GO(N){M().addEventListener("mousemove",m),l1(hd,m),m(N)}function JO(){b.state.isVisible&&b.hide(),b.state.isMounted&&(Dr(),ii().forEach(function(N){N._tippy.unmount()}),k.parentNode&&k.parentNode.removeChild(k),sm=sm.filter(function(N){return N!==b}),b.state.isMounted=!1,A("onHidden",[b]))}function YO(){b.state.isDestroyed||(b.clearDelayTimeouts(),b.unmount(),xo(),delete t._tippy,b.state.isDestroyed=!0,A("onDestroy",[b]))}}function bu(t,e){e===void 0&&(e={});var n=Xn.plugins.concat(e.plugins||[]);fB();var r=Object.assign({},e,{plugins:n}),i=aB(t),o=i.reduce(function(s,a){var l=a&&SB(a,r);return l&&s.push(l),s},[]);return Fh(t)?o[0]:o}bu.defaultProps=Xn;bu.setDefaultProps=vB;bu.currentInput=vr;Object.assign({},o_,{effect:function(e){var n=e.state,r={popper:{position:n.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};Object.assign(n.elements.popper.style,r.popper),n.styles=r,n.elements.arrow&&Object.assign(n.elements.arrow.style,r.arrow)}});bu.setDefaultProps({render:w_});class CB{constructor({editor:e,element:n,view:r,tippyOptions:i={},updateDelay:o=250,shouldShow:s}){this.preventHide=!1,this.shouldShow=({view:a,state:l,from:c,to:u})=>{const{doc:d,selection:f}=l,{empty:p}=f,m=!d.textBetween(c,u).length&&p0(l.selection),g=this.element.contains(document.activeElement);return!(!(a.hasFocus()||g)||p||m||!this.editor.isEditable)},this.mousedownHandler=()=>{this.preventHide=!0},this.dragstartHandler=()=>{this.hide()},this.focusHandler=()=>{setTimeout(()=>this.update(this.editor.view))},this.blurHandler=({event:a})=>{var l;if(this.preventHide){this.preventHide=!1;return}a!=null&&a.relatedTarget&&(!((l=this.element.parentNode)===null||l===void 0)&&l.contains(a.relatedTarget))||(a==null?void 0:a.relatedTarget)!==this.editor.view.dom&&this.hide()},this.tippyBlurHandler=a=>{this.blurHandler({event:a})},this.handleDebouncedUpdate=(a,l)=>{const c=!(l!=null&&l.selection.eq(a.state.selection)),u=!(l!=null&&l.doc.eq(a.state.doc));!c&&!u||(this.updateDebounceTimer&&clearTimeout(this.updateDebounceTimer),this.updateDebounceTimer=window.setTimeout(()=>{this.updateHandler(a,c,u,l)},this.updateDelay))},this.updateHandler=(a,l,c,u)=>{var d,f,p;const{state:m,composing:g}=a,{selection:v}=m;if(g||!l&&!c)return;this.createTooltip();const{ranges:w}=v,S=Math.min(...w.map(k=>k.$from.pos)),b=Math.max(...w.map(k=>k.$to.pos));if(!((d=this.shouldShow)===null||d===void 0?void 0:d.call(this,{editor:this.editor,element:this.element,view:a,state:m,oldState:u,from:S,to:b}))){this.hide();return}(f=this.tippy)===null||f===void 0||f.setProps({getReferenceClientRect:((p=this.tippyOptions)===null||p===void 0?void 0:p.getReferenceClientRect)||(()=>{if(n_(m.selection)){let k=a.nodeDOM(S);if(k){const E=k.dataset.nodeViewWrapper?k:k.querySelector("[data-node-view-wrapper]");if(E&&(k=E.firstChild),k)return k.getBoundingClientRect()}}return mF(a,S,b)})}),this.show()},this.editor=e,this.element=n,this.view=r,this.updateDelay=o,s&&(this.shouldShow=s),this.element.addEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.view.dom.addEventListener("dragstart",this.dragstartHandler),this.editor.on("focus",this.focusHandler),this.editor.on("blur",this.blurHandler),this.tippyOptions=i,this.element.remove(),this.element.style.visibility="visible"}createTooltip(){const{element:e}=this.editor.options,n=!!e.parentElement;this.tippy||!n||(this.tippy=bu(e,{duration:0,getReferenceClientRect:null,content:this.element,interactive:!0,trigger:"manual",placement:"top",hideOnClick:"toggle",...this.tippyOptions}),this.tippy.popper.firstChild&&this.tippy.popper.firstChild.addEventListener("blur",this.tippyBlurHandler))}update(e,n){const{state:r}=e,i=r.selection.from!==r.selection.to;if(this.updateDelay>0&&i){this.handleDebouncedUpdate(e,n);return}const o=!(n!=null&&n.selection.eq(e.state.selection)),s=!(n!=null&&n.doc.eq(e.state.doc));this.updateHandler(e,o,s,n)}show(){var e;(e=this.tippy)===null||e===void 0||e.show()}hide(){var e;(e=this.tippy)===null||e===void 0||e.hide()}destroy(){var e,n;!((e=this.tippy)===null||e===void 0)&&e.popper.firstChild&&this.tippy.popper.firstChild.removeEventListener("blur",this.tippyBlurHandler),(n=this.tippy)===null||n===void 0||n.destroy(),this.element.removeEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.view.dom.removeEventListener("dragstart",this.dragstartHandler),this.editor.off("focus",this.focusHandler),this.editor.off("blur",this.blurHandler)}}const b_=t=>new ht({key:typeof t.pluginKey=="string"?new bn(t.pluginKey):t.pluginKey,view:e=>new CB({view:e,...t})});ot.create({name:"bubbleMenu",addOptions(){return{element:null,tippyOptions:{},pluginKey:"bubbleMenu",updateDelay:void 0,shouldShow:null}},addProseMirrorPlugins(){return this.options.element?[b_({pluginKey:this.options.pluginKey,editor:this.editor,element:this.options.element,tippyOptions:this.options.tippyOptions,updateDelay:this.options.updateDelay,shouldShow:this.options.shouldShow})]:[]}});function kB(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var S_={exports:{}},am={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var g1;function EB(){if(g1)return am;g1=1;var t=ve;function e(d,f){return d===f&&(d!==0||1/d===1/f)||d!==d&&f!==f}var n=typeof Object.is=="function"?Object.is:e,r=t.useState,i=t.useEffect,o=t.useLayoutEffect,s=t.useDebugValue;function a(d,f){var p=f(),m=r({inst:{value:p,getSnapshot:f}}),g=m[0].inst,v=m[1];return o(function(){g.value=p,g.getSnapshot=f,l(g)&&v({inst:g})},[d,p,f]),i(function(){return l(g)&&v({inst:g}),d(function(){l(g)&&v({inst:g})})},[d]),s(p),p}function l(d){var f=d.getSnapshot;d=d.value;try{var p=f();return!n(d,p)}catch{return!0}}function c(d,f){return f()}var u=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?c:a;return am.useSyncExternalStore=t.useSyncExternalStore!==void 0?t.useSyncExternalStore:u,am}S_.exports=EB();var E0=S_.exports;const TB=(...t)=>e=>{t.forEach(n=>{typeof n=="function"?n(e):n&&(n.current=e)})},_B=({contentComponent:t})=>{const e=E0.useSyncExternalStore(t.subscribe,t.getSnapshot,t.getServerSnapshot);return ve.createElement(ve.Fragment,null,Object.values(e))};function RB(){const t=new Set;let e={};return{subscribe(n){return t.add(n),()=>{t.delete(n)}},getSnapshot(){return e},getServerSnapshot(){return e},setRenderer(n,r){e={...e,[n]:Rk.createPortal(r.reactElement,r.element,n)},t.forEach(i=>i())},removeRenderer(n){const r={...e};delete r[n],e=r,t.forEach(i=>i())}}}class OB extends ve.Component{constructor(e){var n;super(e),this.editorContentRef=ve.createRef(),this.initialized=!1,this.state={hasContentComponentInitialized:!!(!((n=e.editor)===null||n===void 0)&&n.contentComponent)}}componentDidMount(){this.init()}componentDidUpdate(){this.init()}init(){const e=this.props.editor;if(e&&!e.isDestroyed&&e.options.element){if(e.contentComponent)return;const n=this.editorContentRef.current;n.append(...e.options.element.childNodes),e.setOptions({element:n}),e.contentComponent=RB(),this.state.hasContentComponentInitialized||(this.unsubscribeToContentComponent=e.contentComponent.subscribe(()=>{this.setState(r=>r.hasContentComponentInitialized?r:{hasContentComponentInitialized:!0}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent()})),e.createNodeViews(),this.initialized=!0}}componentWillUnmount(){const e=this.props.editor;if(!e||(this.initialized=!1,e.isDestroyed||e.view.setProps({nodeViews:{}}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent(),e.contentComponent=null,!e.options.element.firstChild))return;const n=document.createElement("div");n.append(...e.options.element.childNodes),e.setOptions({element:n})}render(){const{editor:e,innerRef:n,...r}=this.props;return ve.createElement(ve.Fragment,null,ve.createElement("div",{ref:TB(n,this.editorContentRef),...r}),(e==null?void 0:e.contentComponent)&&ve.createElement(_B,{contentComponent:e.contentComponent}))}}const PB=y.forwardRef((t,e)=>{const n=ve.useMemo(()=>Math.floor(Math.random()*4294967295).toString(),[t.editor]);return ve.createElement(OB,{key:n,innerRef:e,...t})}),MB=ve.memo(PB);var AB=function t(e,n){if(e===n)return!0;if(e&&n&&typeof e=="object"&&typeof n=="object"){if(e.constructor!==n.constructor)return!1;var r,i,o;if(Array.isArray(e)){if(r=e.length,r!=n.length)return!1;for(i=r;i--!==0;)if(!t(e[i],n[i]))return!1;return!0}if(e instanceof Map&&n instanceof Map){if(e.size!==n.size)return!1;for(i of e.entries())if(!n.has(i[0]))return!1;for(i of e.entries())if(!t(i[1],n.get(i[0])))return!1;return!0}if(e instanceof Set&&n instanceof Set){if(e.size!==n.size)return!1;for(i of e.entries())if(!n.has(i[0]))return!1;return!0}if(ArrayBuffer.isView(e)&&ArrayBuffer.isView(n)){if(r=e.length,r!=n.length)return!1;for(i=r;i--!==0;)if(e[i]!==n[i])return!1;return!0}if(e.constructor===RegExp)return e.source===n.source&&e.flags===n.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===n.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===n.toString();if(o=Object.keys(e),r=o.length,r!==Object.keys(n).length)return!1;for(i=r;i--!==0;)if(!Object.prototype.hasOwnProperty.call(n,o[i]))return!1;for(i=r;i--!==0;){var s=o[i];if(!(s==="_owner"&&e.$$typeof)&&!t(e[s],n[s]))return!1}return!0}return e!==e&&n!==n},DB=kB(AB),C_={exports:{}},lm={};/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var y1;function IB(){if(y1)return lm;y1=1;var t=ve,e=E0;function n(c,u){return c===u&&(c!==0||1/c===1/u)||c!==c&&u!==u}var r=typeof Object.is=="function"?Object.is:n,i=e.useSyncExternalStore,o=t.useRef,s=t.useEffect,a=t.useMemo,l=t.useDebugValue;return lm.useSyncExternalStoreWithSelector=function(c,u,d,f,p){var m=o(null);if(m.current===null){var g={hasValue:!1,value:null};m.current=g}else g=m.current;m=a(function(){function x(k){if(!w){if(w=!0,S=k,k=f(k),p!==void 0&&g.hasValue){var E=g.value;if(p(E,k))return b=E}return b=k}if(E=b,r(S,k))return E;var T=f(k);return p!==void 0&&p(E,T)?E:(S=k,b=T)}var w=!1,S,b,C=d===void 0?null:d;return[function(){return x(u())},C===null?void 0:function(){return x(C())}]},[u,d,f,p]);var v=i(c,m[0],m[1]);return s(function(){g.hasValue=!0,g.value=v},[v]),l(v),v},lm}C_.exports=IB();var NB=C_.exports;const jB=typeof window<"u"?y.useLayoutEffect:y.useEffect;class LB{constructor(e){this.transactionNumber=0,this.lastTransactionNumber=0,this.subscribers=new Set,this.editor=e,this.lastSnapshot={editor:e,transactionNumber:0},this.getSnapshot=this.getSnapshot.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.watch=this.watch.bind(this),this.subscribe=this.subscribe.bind(this)}getSnapshot(){return this.transactionNumber===this.lastTransactionNumber?this.lastSnapshot:(this.lastTransactionNumber=this.transactionNumber,this.lastSnapshot={editor:this.editor,transactionNumber:this.transactionNumber},this.lastSnapshot)}getServerSnapshot(){return{editor:null,transactionNumber:0}}subscribe(e){return this.subscribers.add(e),()=>{this.subscribers.delete(e)}}watch(e){if(this.editor=e,this.editor){const n=()=>{this.transactionNumber+=1,this.subscribers.forEach(i=>i())},r=this.editor;return r.on("transaction",n),()=>{r.off("transaction",n)}}}}function $B(t){var e;const[n]=y.useState(()=>new LB(t.editor)),r=NB.useSyncExternalStoreWithSelector(n.subscribe,n.getSnapshot,n.getServerSnapshot,t.selector,(e=t.equalityFn)!==null&&e!==void 0?e:DB);return jB(()=>n.watch(t.editor),[t.editor,n]),y.useDebugValue(r),r}const FB=!1,vy=typeof window>"u",BB=vy||!!(typeof window<"u"&&window.next);class T0{constructor(e){this.editor=null,this.subscriptions=new Set,this.isComponentMounted=!1,this.previousDeps=null,this.instanceId="",this.options=e,this.subscriptions=new Set,this.setEditor(this.getInitialEditor()),this.scheduleDestroy(),this.getEditor=this.getEditor.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.subscribe=this.subscribe.bind(this),this.refreshEditorInstance=this.refreshEditorInstance.bind(this),this.scheduleDestroy=this.scheduleDestroy.bind(this),this.onRender=this.onRender.bind(this),this.createEditor=this.createEditor.bind(this)}setEditor(e){this.editor=e,this.instanceId=Math.random().toString(36).slice(2,9),this.subscriptions.forEach(n=>n())}getInitialEditor(){if(this.options.current.immediatelyRender===void 0)return vy||BB?null:this.createEditor();if(this.options.current.immediatelyRender&&vy&&FB)throw new Error("Tiptap Error: SSR has been detected, and `immediatelyRender` has been set to `true` this is an unsupported configuration that may result in errors, explicitly set `immediatelyRender` to `false` to avoid hydration mismatches.");return this.options.current.immediatelyRender?this.createEditor():null}createEditor(){const e={...this.options.current,onBeforeCreate:(...r)=>{var i,o;return(o=(i=this.options.current).onBeforeCreate)===null||o===void 0?void 0:o.call(i,...r)},onBlur:(...r)=>{var i,o;return(o=(i=this.options.current).onBlur)===null||o===void 0?void 0:o.call(i,...r)},onCreate:(...r)=>{var i,o;return(o=(i=this.options.current).onCreate)===null||o===void 0?void 0:o.call(i,...r)},onDestroy:(...r)=>{var i,o;return(o=(i=this.options.current).onDestroy)===null||o===void 0?void 0:o.call(i,...r)},onFocus:(...r)=>{var i,o;return(o=(i=this.options.current).onFocus)===null||o===void 0?void 0:o.call(i,...r)},onSelectionUpdate:(...r)=>{var i,o;return(o=(i=this.options.current).onSelectionUpdate)===null||o===void 0?void 0:o.call(i,...r)},onTransaction:(...r)=>{var i,o;return(o=(i=this.options.current).onTransaction)===null||o===void 0?void 0:o.call(i,...r)},onUpdate:(...r)=>{var i,o;return(o=(i=this.options.current).onUpdate)===null||o===void 0?void 0:o.call(i,...r)},onContentError:(...r)=>{var i,o;return(o=(i=this.options.current).onContentError)===null||o===void 0?void 0:o.call(i,...r)},onDrop:(...r)=>{var i,o;return(o=(i=this.options.current).onDrop)===null||o===void 0?void 0:o.call(i,...r)},onPaste:(...r)=>{var i,o;return(o=(i=this.options.current).onPaste)===null||o===void 0?void 0:o.call(i,...r)}};return new WF(e)}getEditor(){return this.editor}getServerSnapshot(){return null}subscribe(e){return this.subscriptions.add(e),()=>{this.subscriptions.delete(e)}}static compareOptions(e,n){return Object.keys(e).every(r=>["onCreate","onBeforeCreate","onDestroy","onUpdate","onTransaction","onFocus","onBlur","onSelectionUpdate","onContentError","onDrop","onPaste"].includes(r)?!0:r==="extensions"&&e.extensions&&n.extensions?e.extensions.length!==n.extensions.length?!1:e.extensions.every((i,o)=>{var s;return i===((s=n.extensions)===null||s===void 0?void 0:s[o])}):e[r]===n[r])}onRender(e){return()=>(this.isComponentMounted=!0,clearTimeout(this.scheduledDestructionTimeout),this.editor&&!this.editor.isDestroyed&&e.length===0?T0.compareOptions(this.options.current,this.editor.options)||this.editor.setOptions({...this.options.current,editable:this.editor.isEditable}):this.refreshEditorInstance(e),()=>{this.isComponentMounted=!1,this.scheduleDestroy()})}refreshEditorInstance(e){if(this.editor&&!this.editor.isDestroyed){if(this.previousDeps===null){this.previousDeps=e;return}if(this.previousDeps.length===e.length&&this.previousDeps.every((r,i)=>r===e[i]))return}this.editor&&!this.editor.isDestroyed&&this.editor.destroy(),this.setEditor(this.createEditor()),this.previousDeps=e}scheduleDestroy(){const e=this.instanceId,n=this.editor;this.scheduledDestructionTimeout=setTimeout(()=>{if(this.isComponentMounted&&this.instanceId===e){n&&n.setOptions(this.options.current);return}n&&!n.isDestroyed&&(n.destroy(),this.instanceId===e&&this.setEditor(null))},1)}}function zB(t={},e=[]){const n=y.useRef(t);n.current=t;const[r]=y.useState(()=>new T0(n)),i=E0.useSyncExternalStore(r.subscribe,r.getEditor,r.getServerSnapshot);return y.useDebugValue(i),y.useEffect(r.onRender(e)),$B({editor:i,selector:({transactionNumber:o})=>t.shouldRerenderOnTransaction===!1?null:t.immediatelyRender&&o===0?0:o+1}),i}const k_=y.createContext({editor:null});k_.Consumer;const UB=()=>y.useContext(k_),VB=t=>{const[e,n]=y.useState(null),{editor:r}=UB();return y.useEffect(()=>{var i;if(!e||!((i=t.editor)===null||i===void 0)&&i.isDestroyed||r!=null&&r.isDestroyed)return;const{pluginKey:o="bubbleMenu",editor:s,tippyOptions:a={},updateDelay:l,shouldShow:c=null}=t,u=s||r;if(!u){console.warn("BubbleMenu component is not rendered inside of an editor component or does not have editor prop.");return}const d=b_({updateDelay:l,editor:u,element:e,pluginKey:o,shouldShow:c,tippyOptions:a});return u.registerPlugin(d),()=>{u.unregisterPlugin(o)}},[t.editor,r,e]),ve.createElement("div",{ref:n,className:t.className,style:{visibility:"hidden"}},t.children)},HB=y.createContext({onDragStart:void 0}),WB=()=>y.useContext(HB);ve.forwardRef((t,e)=>{const{onDragStart:n}=WB(),r=t.as||"div";return ve.createElement(r,{...t,ref:e,"data-node-view-wrapper":"",onDragStart:n,style:{whiteSpace:"normal",...t.style}})});const KB=/^\s*>\s$/,qB=ar.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:t}){return["blockquote",Nt(this.options.HTMLAttributes,t),0]},addCommands(){return{setBlockquote:()=>({commands:t})=>t.wrapIn(this.name),toggleBlockquote:()=>({commands:t})=>t.toggleWrap(this.name),unsetBlockquote:()=>({commands:t})=>t.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[$c({find:KB,type:this.type})]}}),GB=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,JB=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,YB=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,QB=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,XB=no.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:t=>t.style.fontWeight!=="normal"&&null},{style:"font-weight=400",clearMark:t=>t.type.name===this.name},{style:"font-weight",getAttrs:t=>/^(bold(er)?|[5-9]\d{2,})$/.test(t)&&null}]},renderHTML({HTMLAttributes:t}){return["strong",Nt(this.options.HTMLAttributes,t),0]},addCommands(){return{setBold:()=>({commands:t})=>t.setMark(this.name),toggleBold:()=>({commands:t})=>t.toggleMark(this.name),unsetBold:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[Ga({find:GB,type:this.type}),Ga({find:YB,type:this.type})]},addPasteRules(){return[Ja({find:JB,type:this.type}),Ja({find:QB,type:this.type})]}}),ZB="listItem",v1="textStyle",x1=/^\s*([-+*])\s$/,e5=ar.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:t}){return["ul",Nt(this.options.HTMLAttributes,t),0]},addCommands(){return{toggleBulletList:()=>({commands:t,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(ZB,this.editor.getAttributes(v1)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let t=$c({find:x1,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(t=$c({find:x1,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(v1),editor:this.editor})),[t]}}),t5=/(^|[^`])`([^`]+)`(?!`)/,n5=/(^|[^`])`([^`]+)`(?!`)/g,r5=no.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:t}){return["code",Nt(this.options.HTMLAttributes,t),0]},addCommands(){return{setCode:()=>({commands:t})=>t.setMark(this.name),toggleCode:()=>({commands:t})=>t.toggleMark(this.name),unsetCode:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[Ga({find:t5,type:this.type})]},addPasteRules(){return[Ja({find:n5,type:this.type})]}}),i5=/^```([a-z]+)?[\s\n]$/,o5=/^~~~([a-z]+)?[\s\n]$/,s5=ar.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:this.options.defaultLanguage,parseHTML:t=>{var e;const{languageClassPrefix:n}=this.options,o=[...((e=t.firstElementChild)===null||e===void 0?void 0:e.classList)||[]].filter(s=>s.startsWith(n)).map(s=>s.replace(n,""))[0];return o||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:t,HTMLAttributes:e}){return["pre",Nt(this.options.HTMLAttributes,e),["code",{class:t.attrs.language?this.options.languageClassPrefix+t.attrs.language:null},0]]},addCommands(){return{setCodeBlock:t=>({commands:e})=>e.setNode(this.name,t),toggleCodeBlock:t=>({commands:e})=>e.toggleNode(this.name,"paragraph",t)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:t,$anchor:e}=this.editor.state.selection,n=e.pos===1;return!t||e.parent.type.name!==this.name?!1:n||!e.parent.textContent.length?this.editor.commands.clearNodes():!1},Enter:({editor:t})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:e}=t,{selection:n}=e,{$from:r,empty:i}=n;if(!i||r.parent.type!==this.type)return!1;const o=r.parentOffset===r.parent.nodeSize-2,s=r.parent.textContent.endsWith(`

`);return!o||!s?!1:t.chain().command(({tr:a})=>(a.delete(r.pos-2,r.pos),!0)).exitCode().run()},ArrowDown:({editor:t})=>{if(!this.options.exitOnArrowDown)return!1;const{state:e}=t,{selection:n,doc:r}=e,{$from:i,empty:o}=n;if(!o||i.parent.type!==this.type||!(i.parentOffset===i.parent.nodeSize-2))return!1;const a=i.after();return a===void 0?!1:r.nodeAt(a)?t.commands.command(({tr:c})=>(c.setSelection(oe.near(r.resolve(a))),!0)):t.commands.exitCode()}}},addInputRules(){return[fy({find:i5,type:this.type,getAttributes:t=>({language:t[1]})}),fy({find:o5,type:this.type,getAttributes:t=>({language:t[1]})})]},addProseMirrorPlugins(){return[new ht({key:new bn("codeBlockVSCodeHandler"),props:{handlePaste:(t,e)=>{if(!e.clipboardData||this.editor.isActive(this.type.name))return!1;const n=e.clipboardData.getData("text/plain"),r=e.clipboardData.getData("vscode-editor-data"),i=r?JSON.parse(r):void 0,o=i==null?void 0:i.mode;if(!n||!o)return!1;const{tr:s,schema:a}=t.state,l=a.text(n.replace(/\r\n?/g,`
`));return s.replaceSelectionWith(this.type.create({language:o},l)),s.selection.$from.parent.type!==this.type&&s.setSelection(ie.near(s.doc.resolve(Math.max(0,s.selection.from-2)))),s.setMeta("paste",!0),t.dispatch(s),!0}}})]}}),a5=ar.create({name:"doc",topNode:!0,content:"block+"});function l5(t={}){return new ht({view(e){return new c5(e,t)}})}class c5{constructor(e,n){var r;this.editorView=e,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=(r=n.width)!==null&&r!==void 0?r:1,this.color=n.color===!1?void 0:n.color||"black",this.class=n.class,this.handlers=["dragover","dragend","drop","dragleave"].map(i=>{let o=s=>{this[i](s)};return e.dom.addEventListener(i,o),{name:i,handler:o}})}destroy(){this.handlers.forEach(({name:e,handler:n})=>this.editorView.dom.removeEventListener(e,n))}update(e,n){this.cursorPos!=null&&n.doc!=e.state.doc&&(this.cursorPos>e.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(e){e!=this.cursorPos&&(this.cursorPos=e,e==null?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let e=this.editorView.state.doc.resolve(this.cursorPos),n=!e.parent.inlineContent,r;if(n){let a=e.nodeBefore,l=e.nodeAfter;if(a||l){let c=this.editorView.nodeDOM(this.cursorPos-(a?a.nodeSize:0));if(c){let u=c.getBoundingClientRect(),d=a?u.bottom:u.top;a&&l&&(d=(d+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2),r={left:u.left,right:u.right,top:d-this.width/2,bottom:d+this.width/2}}}}if(!r){let a=this.editorView.coordsAtPos(this.cursorPos);r={left:a.left-this.width/2,right:a.left+this.width/2,top:a.top,bottom:a.bottom}}let i=this.editorView.dom.offsetParent;this.element||(this.element=i.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",n),this.element.classList.toggle("prosemirror-dropcursor-inline",!n);let o,s;if(!i||i==document.body&&getComputedStyle(i).position=="static")o=-pageXOffset,s=-pageYOffset;else{let a=i.getBoundingClientRect();o=a.left-i.scrollLeft,s=a.top-i.scrollTop}this.element.style.left=r.left-o+"px",this.element.style.top=r.top-s+"px",this.element.style.width=r.right-r.left+"px",this.element.style.height=r.bottom-r.top+"px"}scheduleRemoval(e){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),e)}dragover(e){if(!this.editorView.editable)return;let n=this.editorView.posAtCoords({left:e.clientX,top:e.clientY}),r=n&&n.inside>=0&&this.editorView.state.doc.nodeAt(n.inside),i=r&&r.type.spec.disableDropCursor,o=typeof i=="function"?i(this.editorView,n,e):i;if(n&&!o){let s=n.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let a=ZE(this.editorView.state.doc,s,this.editorView.dragging.slice);a!=null&&(s=a)}this.setCursor(s),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(e){(e.target==this.editorView.dom||!this.editorView.dom.contains(e.relatedTarget))&&this.setCursor(null)}}const u5=ot.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[l5(this.options)]}});class Fe extends oe{constructor(e){super(e,e)}map(e,n){let r=e.resolve(n.map(this.head));return Fe.valid(r)?new Fe(r):oe.near(r)}content(){return V.empty}eq(e){return e instanceof Fe&&e.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(e,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for GapCursor.fromJSON");return new Fe(e.resolve(n.pos))}getBookmark(){return new _0(this.anchor)}static valid(e){let n=e.parent;if(n.isTextblock||!d5(e)||!f5(e))return!1;let r=n.type.spec.allowGapCursor;if(r!=null)return r;let i=n.contentMatchAt(e.index()).defaultType;return i&&i.isTextblock}static findGapCursorFrom(e,n,r=!1){e:for(;;){if(!r&&Fe.valid(e))return e;let i=e.pos,o=null;for(let s=e.depth;;s--){let a=e.node(s);if(n>0?e.indexAfter(s)<a.childCount:e.index(s)>0){o=a.child(n>0?e.indexAfter(s):e.index(s)-1);break}else if(s==0)return null;i+=n;let l=e.doc.resolve(i);if(Fe.valid(l))return l}for(;;){let s=n>0?o.firstChild:o.lastChild;if(!s){if(o.isAtom&&!o.isText&&!X.isSelectable(o)){e=e.doc.resolve(i+o.nodeSize*n),r=!1;continue e}break}o=s,i+=n;let a=e.doc.resolve(i);if(Fe.valid(a))return a}return null}}}Fe.prototype.visible=!1;Fe.findFrom=Fe.findGapCursorFrom;oe.jsonID("gapcursor",Fe);class _0{constructor(e){this.pos=e}map(e){return new _0(e.map(this.pos))}resolve(e){let n=e.resolve(this.pos);return Fe.valid(n)?new Fe(n):oe.near(n)}}function d5(t){for(let e=t.depth;e>=0;e--){let n=t.index(e),r=t.node(e);if(n==0){if(r.type.spec.isolating)return!0;continue}for(let i=r.child(n-1);;i=i.lastChild){if(i.childCount==0&&!i.inlineContent||i.isAtom||i.type.spec.isolating)return!0;if(i.inlineContent)return!1}}return!0}function f5(t){for(let e=t.depth;e>=0;e--){let n=t.indexAfter(e),r=t.node(e);if(n==r.childCount){if(r.type.spec.isolating)return!0;continue}for(let i=r.child(n);;i=i.firstChild){if(i.childCount==0&&!i.inlineContent||i.isAtom||i.type.spec.isolating)return!0;if(i.inlineContent)return!1}}return!0}function h5(){return new ht({props:{decorations:y5,createSelectionBetween(t,e,n){return e.pos==n.pos&&Fe.valid(n)?new Fe(n):null},handleClick:m5,handleKeyDown:p5,handleDOMEvents:{beforeinput:g5}}})}const p5=FT({ArrowLeft:pd("horiz",-1),ArrowRight:pd("horiz",1),ArrowUp:pd("vert",-1),ArrowDown:pd("vert",1)});function pd(t,e){const n=t=="vert"?e>0?"down":"up":e>0?"right":"left";return function(r,i,o){let s=r.selection,a=e>0?s.$to:s.$from,l=s.empty;if(s instanceof ie){if(!o.endOfTextblock(n)||a.depth==0)return!1;l=!1,a=r.doc.resolve(e>0?a.after():a.before())}let c=Fe.findGapCursorFrom(a,e,l);return c?(i&&i(r.tr.setSelection(new Fe(c))),!0):!1}}function m5(t,e,n){if(!t||!t.editable)return!1;let r=t.state.doc.resolve(e);if(!Fe.valid(r))return!1;let i=t.posAtCoords({left:n.clientX,top:n.clientY});return i&&i.inside>-1&&X.isSelectable(t.state.doc.nodeAt(i.inside))?!1:(t.dispatch(t.state.tr.setSelection(new Fe(r))),!0)}function g5(t,e){if(e.inputType!="insertCompositionText"||!(t.state.selection instanceof Fe))return!1;let{$from:n}=t.state.selection,r=n.parent.contentMatchAt(n.index()).findWrapping(t.state.schema.nodes.text);if(!r)return!1;let i=j.empty;for(let s=r.length-1;s>=0;s--)i=j.from(r[s].createAndFill(null,i));let o=t.state.tr.replace(n.pos,n.pos,new V(i,0,0));return o.setSelection(ie.near(o.doc.resolve(n.pos+1))),t.dispatch(o),!1}function y5(t){if(!(t.selection instanceof Fe))return null;let e=document.createElement("div");return e.className="ProseMirror-gapcursor",Ue.create(t.doc,[Xt.widget(t.selection.head,e,{key:"gapcursor"})])}const v5=ot.create({name:"gapCursor",addProseMirrorPlugins(){return[h5()]},extendNodeSchema(t){var e;const n={name:t.name,options:t.options,storage:t.storage};return{allowGapCursor:(e=le(K(t,"allowGapCursor",n)))!==null&&e!==void 0?e:null}}}),x5=ar.create({name:"hardBreak",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:t}){return["br",Nt(this.options.HTMLAttributes,t)]},renderText(){return`
`},addCommands(){return{setHardBreak:()=>({commands:t,chain:e,state:n,editor:r})=>t.first([()=>t.exitCode(),()=>t.command(()=>{const{selection:i,storedMarks:o}=n;if(i.$from.parent.type.spec.isolating)return!1;const{keepMarks:s}=this.options,{splittableMarks:a}=r.extensionManager,l=o||i.$to.parentOffset&&i.$from.marks();return e().insertContent({type:this.name}).command(({tr:c,dispatch:u})=>{if(u&&l&&s){const d=l.filter(f=>a.includes(f.type.name));c.ensureMarks(d)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),w5=ar.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(t=>({tag:`h${t}`,attrs:{level:t}}))},renderHTML({node:t,HTMLAttributes:e}){return[`h${this.options.levels.includes(t.attrs.level)?t.attrs.level:this.options.levels[0]}`,Nt(this.options.HTMLAttributes,e),0]},addCommands(){return{setHeading:t=>({commands:e})=>this.options.levels.includes(t.level)?e.setNode(this.name,t):!1,toggleHeading:t=>({commands:e})=>this.options.levels.includes(t.level)?e.toggleNode(this.name,"paragraph",t):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((t,e)=>({...t,[`Mod-Alt-${e}`]:()=>this.editor.commands.toggleHeading({level:e})}),{})},addInputRules(){return this.options.levels.map(t=>fy({find:new RegExp(`^(#{${Math.min(...this.options.levels)},${t}})\\s$`),type:this.type,getAttributes:{level:t}}))}});var $f=200,rt=function(){};rt.prototype.append=function(e){return e.length?(e=rt.from(e),!this.length&&e||e.length<$f&&this.leafAppend(e)||this.length<$f&&e.leafPrepend(this)||this.appendInner(e)):this};rt.prototype.prepend=function(e){return e.length?rt.from(e).append(this):this};rt.prototype.appendInner=function(e){return new b5(this,e)};rt.prototype.slice=function(e,n){return e===void 0&&(e=0),n===void 0&&(n=this.length),e>=n?rt.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,n))};rt.prototype.get=function(e){if(!(e<0||e>=this.length))return this.getInner(e)};rt.prototype.forEach=function(e,n,r){n===void 0&&(n=0),r===void 0&&(r=this.length),n<=r?this.forEachInner(e,n,r,0):this.forEachInvertedInner(e,n,r,0)};rt.prototype.map=function(e,n,r){n===void 0&&(n=0),r===void 0&&(r=this.length);var i=[];return this.forEach(function(o,s){return i.push(e(o,s))},n,r),i};rt.from=function(e){return e instanceof rt?e:e&&e.length?new E_(e):rt.empty};var E_=function(t){function e(r){t.call(this),this.values=r}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={length:{configurable:!0},depth:{configurable:!0}};return e.prototype.flatten=function(){return this.values},e.prototype.sliceInner=function(i,o){return i==0&&o==this.length?this:new e(this.values.slice(i,o))},e.prototype.getInner=function(i){return this.values[i]},e.prototype.forEachInner=function(i,o,s,a){for(var l=o;l<s;l++)if(i(this.values[l],a+l)===!1)return!1},e.prototype.forEachInvertedInner=function(i,o,s,a){for(var l=o-1;l>=s;l--)if(i(this.values[l],a+l)===!1)return!1},e.prototype.leafAppend=function(i){if(this.length+i.length<=$f)return new e(this.values.concat(i.flatten()))},e.prototype.leafPrepend=function(i){if(this.length+i.length<=$f)return new e(i.flatten().concat(this.values))},n.length.get=function(){return this.values.length},n.depth.get=function(){return 0},Object.defineProperties(e.prototype,n),e}(rt);rt.empty=new E_([]);var b5=function(t){function e(n,r){t.call(this),this.left=n,this.right=r,this.length=n.length+r.length,this.depth=Math.max(n.depth,r.depth)+1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},e.prototype.getInner=function(r){return r<this.left.length?this.left.get(r):this.right.get(r-this.left.length)},e.prototype.forEachInner=function(r,i,o,s){var a=this.left.length;if(i<a&&this.left.forEachInner(r,i,Math.min(o,a),s)===!1||o>a&&this.right.forEachInner(r,Math.max(i-a,0),Math.min(this.length,o)-a,s+a)===!1)return!1},e.prototype.forEachInvertedInner=function(r,i,o,s){var a=this.left.length;if(i>a&&this.right.forEachInvertedInner(r,i-a,Math.max(o,a)-a,s+a)===!1||o<a&&this.left.forEachInvertedInner(r,Math.min(i,a),o,s)===!1)return!1},e.prototype.sliceInner=function(r,i){if(r==0&&i==this.length)return this;var o=this.left.length;return i<=o?this.left.slice(r,i):r>=o?this.right.slice(r-o,i-o):this.left.slice(r,o).append(this.right.slice(0,i-o))},e.prototype.leafAppend=function(r){var i=this.right.leafAppend(r);if(i)return new e(this.left,i)},e.prototype.leafPrepend=function(r){var i=this.left.leafPrepend(r);if(i)return new e(i,this.right)},e.prototype.appendInner=function(r){return this.left.depth>=Math.max(this.right.depth,r.depth)+1?new e(this.left,new e(this.right,r)):new e(this,r)},e}(rt);const S5=500;let zc=class qs{constructor(e,n){this.items=e,this.eventCount=n}popEvent(e,n){if(this.eventCount==0)return null;let r=this.items.length;for(;;r--)if(this.items.get(r-1).selection){--r;break}let i,o;n&&(i=this.remapping(r,this.items.length),o=i.maps.length);let s=e.tr,a,l,c=[],u=[];return this.items.forEach((d,f)=>{if(!d.step){i||(i=this.remapping(r,f+1),o=i.maps.length),o--,u.push(d);return}if(i){u.push(new ai(d.map));let p=d.step.map(i.slice(o)),m;p&&s.maybeStep(p).doc&&(m=s.mapping.maps[s.mapping.maps.length-1],c.push(new ai(m,void 0,void 0,c.length+u.length))),o--,m&&i.appendMap(m,o)}else s.maybeStep(d.step);if(d.selection)return a=i?d.selection.map(i.slice(o)):d.selection,l=new qs(this.items.slice(0,r).append(u.reverse().concat(c)),this.eventCount-1),!1},this.items.length,0),{remaining:l,transform:s,selection:a}}addTransform(e,n,r,i){let o=[],s=this.eventCount,a=this.items,l=!i&&a.length?a.get(a.length-1):null;for(let u=0;u<e.steps.length;u++){let d=e.steps[u].invert(e.docs[u]),f=new ai(e.mapping.maps[u],d,n),p;(p=l&&l.merge(f))&&(f=p,u?o.pop():a=a.slice(0,a.length-1)),o.push(f),n&&(s++,n=void 0),i||(l=f)}let c=s-r.depth;return c>k5&&(a=C5(a,c),s-=c),new qs(a.append(o),s)}remapping(e,n){let r=new Ac;return this.items.forEach((i,o)=>{let s=i.mirrorOffset!=null&&o-i.mirrorOffset>=e?r.maps.length-i.mirrorOffset:void 0;r.appendMap(i.map,s)},e,n),r}addMaps(e){return this.eventCount==0?this:new qs(this.items.append(e.map(n=>new ai(n))),this.eventCount)}rebased(e,n){if(!this.eventCount)return this;let r=[],i=Math.max(0,this.items.length-n),o=e.mapping,s=e.steps.length,a=this.eventCount;this.items.forEach(f=>{f.selection&&a--},i);let l=n;this.items.forEach(f=>{let p=o.getMirror(--l);if(p==null)return;s=Math.min(s,p);let m=o.maps[p];if(f.step){let g=e.steps[p].invert(e.docs[p]),v=f.selection&&f.selection.map(o.slice(l+1,p));v&&a++,r.push(new ai(m,g,v))}else r.push(new ai(m))},i);let c=[];for(let f=n;f<s;f++)c.push(new ai(o.maps[f]));let u=this.items.slice(0,i).append(c).append(r),d=new qs(u,a);return d.emptyItemCount()>S5&&(d=d.compress(this.items.length-r.length)),d}emptyItemCount(){let e=0;return this.items.forEach(n=>{n.step||e++}),e}compress(e=this.items.length){let n=this.remapping(0,e),r=n.maps.length,i=[],o=0;return this.items.forEach((s,a)=>{if(a>=e)i.push(s),s.selection&&o++;else if(s.step){let l=s.step.map(n.slice(r)),c=l&&l.getMap();if(r--,c&&n.appendMap(c,r),l){let u=s.selection&&s.selection.map(n.slice(r));u&&o++;let d=new ai(c.invert(),l,u),f,p=i.length-1;(f=i.length&&i[p].merge(d))?i[p]=f:i.push(d)}}else s.map&&r--},this.items.length,0),new qs(rt.from(i.reverse()),o)}};zc.empty=new zc(rt.empty,0);function C5(t,e){let n;return t.forEach((r,i)=>{if(r.selection&&e--==0)return n=i,!1}),t.slice(n)}let ai=class T_{constructor(e,n,r,i){this.map=e,this.step=n,this.selection=r,this.mirrorOffset=i}merge(e){if(this.step&&e.step&&!e.selection){let n=e.step.merge(this.step);if(n)return new T_(n.getMap().invert(),n,this.selection)}}};class xi{constructor(e,n,r,i,o){this.done=e,this.undone=n,this.prevRanges=r,this.prevTime=i,this.prevComposition=o}}const k5=20;function E5(t,e,n,r){let i=n.getMeta(ns),o;if(i)return i.historyState;n.getMeta(R5)&&(t=new xi(t.done,t.undone,null,0,-1));let s=n.getMeta("appendedTransaction");if(n.steps.length==0)return t;if(s&&s.getMeta(ns))return s.getMeta(ns).redo?new xi(t.done.addTransform(n,void 0,r,Vd(e)),t.undone,w1(n.mapping.maps),t.prevTime,t.prevComposition):new xi(t.done,t.undone.addTransform(n,void 0,r,Vd(e)),null,t.prevTime,t.prevComposition);if(n.getMeta("addToHistory")!==!1&&!(s&&s.getMeta("addToHistory")===!1)){let a=n.getMeta("composition"),l=t.prevTime==0||!s&&t.prevComposition!=a&&(t.prevTime<(n.time||0)-r.newGroupDelay||!T5(n,t.prevRanges)),c=s?cm(t.prevRanges,n.mapping):w1(n.mapping.maps);return new xi(t.done.addTransform(n,l?e.selection.getBookmark():void 0,r,Vd(e)),zc.empty,c,n.time,a??t.prevComposition)}else return(o=n.getMeta("rebased"))?new xi(t.done.rebased(n,o),t.undone.rebased(n,o),cm(t.prevRanges,n.mapping),t.prevTime,t.prevComposition):new xi(t.done.addMaps(n.mapping.maps),t.undone.addMaps(n.mapping.maps),cm(t.prevRanges,n.mapping),t.prevTime,t.prevComposition)}function T5(t,e){if(!e)return!1;if(!t.docChanged)return!0;let n=!1;return t.mapping.maps[0].forEach((r,i)=>{for(let o=0;o<e.length;o+=2)r<=e[o+1]&&i>=e[o]&&(n=!0)}),n}function w1(t){let e=[];for(let n=t.length-1;n>=0&&e.length==0;n--)t[n].forEach((r,i,o,s)=>e.push(o,s));return e}function cm(t,e){if(!t)return null;let n=[];for(let r=0;r<t.length;r+=2){let i=e.map(t[r],1),o=e.map(t[r+1],-1);i<=o&&n.push(i,o)}return n}function _5(t,e,n){let r=Vd(e),i=ns.get(e).spec.config,o=(n?t.undone:t.done).popEvent(e,r);if(!o)return null;let s=o.selection.resolve(o.transform.doc),a=(n?t.done:t.undone).addTransform(o.transform,e.selection.getBookmark(),i,r),l=new xi(n?a:o.remaining,n?o.remaining:a,null,0,-1);return o.transform.setSelection(s).setMeta(ns,{redo:n,historyState:l})}let um=!1,b1=null;function Vd(t){let e=t.plugins;if(b1!=e){um=!1,b1=e;for(let n=0;n<e.length;n++)if(e[n].spec.historyPreserveItems){um=!0;break}}return um}const ns=new bn("history"),R5=new bn("closeHistory");function O5(t={}){return t={depth:t.depth||100,newGroupDelay:t.newGroupDelay||500},new ht({key:ns,state:{init(){return new xi(zc.empty,zc.empty,null,0,-1)},apply(e,n,r){return E5(n,r,e,t)}},config:t,props:{handleDOMEvents:{beforeinput(e,n){let r=n.inputType,i=r=="historyUndo"?R_:r=="historyRedo"?O_:null;return i?(n.preventDefault(),i(e.state,e.dispatch)):!1}}}})}function __(t,e){return(n,r)=>{let i=ns.getState(n);if(!i||(t?i.undone:i.done).eventCount==0)return!1;if(r){let o=_5(i,n,t);o&&r(e?o.scrollIntoView():o)}return!0}}const R_=__(!1,!0),O_=__(!0,!0),P5=ot.create({name:"history",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:t,dispatch:e})=>R_(t,e),redo:()=>({state:t,dispatch:e})=>O_(t,e)}},addProseMirrorPlugins(){return[O5(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-":()=>this.editor.commands.undo(),"Shift-Mod-":()=>this.editor.commands.redo()}}}),M5=ar.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{}}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:t}){return["hr",Nt(this.options.HTMLAttributes,t)]},addCommands(){return{setHorizontalRule:()=>({chain:t,state:e})=>{const{selection:n}=e,{$from:r,$to:i}=n,o=t();return r.parentOffset===0?o.insertContentAt({from:Math.max(r.pos-1,0),to:i.pos},{type:this.name}):n_(n)?o.insertContentAt(i.pos,{type:this.name}):o.insertContent({type:this.name}),o.command(({tr:s,dispatch:a})=>{var l;if(a){const{$to:c}=s.selection,u=c.end();if(c.nodeAfter)c.nodeAfter.isTextblock?s.setSelection(ie.create(s.doc,c.pos+1)):c.nodeAfter.isBlock?s.setSelection(X.create(s.doc,c.pos)):s.setSelection(ie.create(s.doc,c.pos));else{const d=(l=c.parent.type.contentMatch.defaultType)===null||l===void 0?void 0:l.create();d&&(s.insert(u,d),s.setSelection(ie.create(s.doc,u+1)))}s.scrollIntoView()}return!0}).run()}}},addInputRules(){return[KF({find:/^(?:---|-|___\s|\*\*\*\s)$/,type:this.type})]}}),A5=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,D5=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,I5=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,N5=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,j5=no.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:t=>t.style.fontStyle!=="normal"&&null},{style:"font-style=normal",clearMark:t=>t.type.name===this.name},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:t}){return["em",Nt(this.options.HTMLAttributes,t),0]},addCommands(){return{setItalic:()=>({commands:t})=>t.setMark(this.name),toggleItalic:()=>({commands:t})=>t.toggleMark(this.name),unsetItalic:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[Ga({find:A5,type:this.type}),Ga({find:I5,type:this.type})]},addPasteRules(){return[Ja({find:D5,type:this.type}),Ja({find:N5,type:this.type})]}}),L5=ar.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:t}){return["li",Nt(this.options.HTMLAttributes,t),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),$5="listItem",S1="textStyle",C1=/^(\d+)\.\s$/,F5=ar.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:t=>t.hasAttribute("start")?parseInt(t.getAttribute("start")||"",10):1},type:{default:void 0,parseHTML:t=>t.getAttribute("type")}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:t}){const{start:e,...n}=t;return e===1?["ol",Nt(this.options.HTMLAttributes,n),0]:["ol",Nt(this.options.HTMLAttributes,t),0]},addCommands(){return{toggleOrderedList:()=>({commands:t,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes($5,this.editor.getAttributes(S1)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let t=$c({find:C1,type:this.type,getAttributes:e=>({start:+e[1]}),joinPredicate:(e,n)=>n.childCount+n.attrs.start===+e[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(t=$c({find:C1,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:e=>({start:+e[1],...this.editor.getAttributes(S1)}),joinPredicate:(e,n)=>n.childCount+n.attrs.start===+e[1],editor:this.editor})),[t]}}),B5=ar.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:t}){return["p",Nt(this.options.HTMLAttributes,t),0]},addCommands(){return{setParagraph:()=>({commands:t})=>t.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),z5=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,U5=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,V5=no.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:t=>t.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:t}){return["s",Nt(this.options.HTMLAttributes,t),0]},addCommands(){return{setStrike:()=>({commands:t})=>t.setMark(this.name),toggleStrike:()=>({commands:t})=>t.toggleMark(this.name),unsetStrike:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[Ga({find:z5,type:this.type})]},addPasteRules(){return[Ja({find:U5,type:this.type})]}}),H5=ar.create({name:"text",group:"inline"}),W5=ot.create({name:"starterKit",addExtensions(){var t,e,n,r,i,o,s,a,l,c,u,d,f,p,m,g,v,x;const w=[];return this.options.bold!==!1&&w.push(XB.configure((t=this.options)===null||t===void 0?void 0:t.bold)),this.options.blockquote!==!1&&w.push(qB.configure((e=this.options)===null||e===void 0?void 0:e.blockquote)),this.options.bulletList!==!1&&w.push(e5.configure((n=this.options)===null||n===void 0?void 0:n.bulletList)),this.options.code!==!1&&w.push(r5.configure((r=this.options)===null||r===void 0?void 0:r.code)),this.options.codeBlock!==!1&&w.push(s5.configure((i=this.options)===null||i===void 0?void 0:i.codeBlock)),this.options.document!==!1&&w.push(a5.configure((o=this.options)===null||o===void 0?void 0:o.document)),this.options.dropcursor!==!1&&w.push(u5.configure((s=this.options)===null||s===void 0?void 0:s.dropcursor)),this.options.gapcursor!==!1&&w.push(v5.configure((a=this.options)===null||a===void 0?void 0:a.gapcursor)),this.options.hardBreak!==!1&&w.push(x5.configure((l=this.options)===null||l===void 0?void 0:l.hardBreak)),this.options.heading!==!1&&w.push(w5.configure((c=this.options)===null||c===void 0?void 0:c.heading)),this.options.history!==!1&&w.push(P5.configure((u=this.options)===null||u===void 0?void 0:u.history)),this.options.horizontalRule!==!1&&w.push(M5.configure((d=this.options)===null||d===void 0?void 0:d.horizontalRule)),this.options.italic!==!1&&w.push(j5.configure((f=this.options)===null||f===void 0?void 0:f.italic)),this.options.listItem!==!1&&w.push(L5.configure((p=this.options)===null||p===void 0?void 0:p.listItem)),this.options.orderedList!==!1&&w.push(F5.configure((m=this.options)===null||m===void 0?void 0:m.orderedList)),this.options.paragraph!==!1&&w.push(B5.configure((g=this.options)===null||g===void 0?void 0:g.paragraph)),this.options.strike!==!1&&w.push(V5.configure((v=this.options)===null||v===void 0?void 0:v.strike)),this.options.text!==!1&&w.push(H5.configure((x=this.options)===null||x===void 0?void 0:x.text)),w}}),K5=ot.create({name:"placeholder",addOptions(){return{emptyEditorClass:"is-editor-empty",emptyNodeClass:"is-empty",placeholder:"Write something ",showOnlyWhenEditable:!0,showOnlyCurrent:!0,includeChildren:!1}},addProseMirrorPlugins(){return[new ht({key:new bn("placeholder"),props:{decorations:({doc:t,selection:e})=>{const n=this.editor.isEditable||!this.options.showOnlyWhenEditable,{anchor:r}=e,i=[];if(!n)return null;const o=this.editor.isEmpty;return t.descendants((s,a)=>{const l=r>=a&&r<=a+s.nodeSize,c=!s.isLeaf&&Lh(s);if((l||!this.options.showOnlyCurrent)&&c){const u=[this.options.emptyNodeClass];o&&u.push(this.options.emptyEditorClass);const d=Xt.node(a,a+s.nodeSize,{class:u.join(" "),"data-placeholder":typeof this.options.placeholder=="function"?this.options.placeholder({editor:this.editor,node:s,pos:a,hasAnchor:l}):this.options.placeholder});i.push(d)}return this.options.includeChildren}),Ue.create(t,i)}}})]}});function R0(t,e){if(typeof t!="function"){const[n,r]=y.useState(t);return y.useEffect(()=>{const i=setTimeout(()=>{r(t)},e);return()=>{clearTimeout(i)}},[t,e]),n}return y.useCallback((...n)=>{const r=t,i=setTimeout(()=>{r(...n)},e);return()=>{clearTimeout(i)}},[t,e])}function q5(t){var e;const{char:n,allowSpaces:r,allowToIncludeChar:i,allowedPrefixes:o,startOfLine:s,$position:a}=t,l=r&&!i,c=qF(n),u=new RegExp(`\\s${c}$`),d=s?"^":"",f=i?"":c,p=l?new RegExp(`${d}${c}.*?(?=\\s${f}|$)`,"gm"):new RegExp(`${d}(?:^)?${c}[^\\s${f}]*`,"gm"),m=((e=a.nodeBefore)===null||e===void 0?void 0:e.isText)&&a.nodeBefore.text;if(!m)return null;const g=a.pos-m.length,v=Array.from(m.matchAll(p)).pop();if(!v||v.input===void 0||v.index===void 0)return null;const x=v.input.slice(Math.max(0,v.index-1),v.index),w=new RegExp(`^[${o==null?void 0:o.join("")}\0]?$`).test(x);if(o!==null&&!w)return null;const S=g+v.index;let b=S+v[0].length;return l&&u.test(m.slice(b-1,b+1))&&(v[0]+=" ",b+=1),S<a.pos&&b>=a.pos?{range:{from:S,to:b},query:v[0].slice(n.length),text:v[0]}:null}const G5=new bn("suggestion");function J5({pluginKey:t=G5,editor:e,char:n="@",allowSpaces:r=!1,allowToIncludeChar:i=!1,allowedPrefixes:o=[" "],startOfLine:s=!1,decorationTag:a="span",decorationClass:l="suggestion",command:c=()=>null,items:u=()=>[],render:d=()=>({}),allow:f=()=>!0,findSuggestionMatch:p=q5}){let m;const g=d==null?void 0:d(),v=new ht({key:t,view(){return{update:async(x,w)=>{var S,b,C,k,E,T,O;const R=(S=this.key)===null||S===void 0?void 0:S.getState(w),I=(b=this.key)===null||b===void 0?void 0:b.getState(x.state),$=R.active&&I.active&&R.range.from!==I.range.from,P=!R.active&&I.active,M=R.active&&!I.active,z=!P&&!M&&R.query!==I.query,B=P||$&&z,H=z||$,A=M||$&&z;if(!B&&!H&&!A)return;const D=A&&!B?R:I,L=x.dom.querySelector(`[data-decoration-id="${D.decorationId}"]`);m={editor:e,range:D.range,query:D.query,text:D.text,items:[],command:Y=>c({editor:e,range:D.range,props:Y}),decorationNode:L,clientRect:L?()=>{var Y;const{decorationId:ee}=(Y=this.key)===null||Y===void 0?void 0:Y.getState(e.state),G=x.dom.querySelector(`[data-decoration-id="${ee}"]`);return(G==null?void 0:G.getBoundingClientRect())||null}:null},B&&((C=g==null?void 0:g.onBeforeStart)===null||C===void 0||C.call(g,m)),H&&((k=g==null?void 0:g.onBeforeUpdate)===null||k===void 0||k.call(g,m)),(H||B)&&(m.items=await u({editor:e,query:D.query})),A&&((E=g==null?void 0:g.onExit)===null||E===void 0||E.call(g,m)),H&&((T=g==null?void 0:g.onUpdate)===null||T===void 0||T.call(g,m)),B&&((O=g==null?void 0:g.onStart)===null||O===void 0||O.call(g,m))},destroy:()=>{var x;m&&((x=g==null?void 0:g.onExit)===null||x===void 0||x.call(g,m))}}},state:{init(){return{active:!1,range:{from:0,to:0},query:null,text:null,composing:!1}},apply(x,w,S,b){const{isEditable:C}=e,{composing:k}=e.view,{selection:E}=x,{empty:T,from:O}=E,R={...w};if(R.composing=k,C&&(T||e.view.composing)){(O<w.range.from||O>w.range.to)&&!k&&!w.composing&&(R.active=!1);const I=p({char:n,allowSpaces:r,allowToIncludeChar:i,allowedPrefixes:o,startOfLine:s,$position:E.$from}),$=`id_${Math.floor(Math.random()*4294967295)}`;I&&f({editor:e,state:b,range:I.range,isActive:w.active})?(R.active=!0,R.decorationId=w.decorationId?w.decorationId:$,R.range=I.range,R.query=I.query,R.text=I.text):R.active=!1}else R.active=!1;return R.active||(R.decorationId=null,R.range={from:0,to:0},R.query=null,R.text=null),R}},props:{handleKeyDown(x,w){var S;const{active:b,range:C}=v.getState(x.state);return b&&((S=g==null?void 0:g.onKeyDown)===null||S===void 0?void 0:S.call(g,{view:x,event:w,range:C}))||!1},decorations(x){const{active:w,range:S,decorationId:b}=v.getState(x);return w?Ue.create(x.doc,[Xt.inline(S.from,S.to,{nodeName:a,class:l,"data-decoration-id":b})]):null}}});return v}const Y5=ot.create({name:"slashCommand",addOptions(){return{snippets:[],suggestion:{char:"/",command:({editor:e,range:n,props:r})=>{r.command({editor:e,range:n})},items:({query:e,editor:n})=>{var o;const r=n.extensionManager.extensions.find(s=>s.name==="slashCommand");return(((o=r==null?void 0:r.options)==null?void 0:o.snippets)||[]).filter(s=>s.command.toLowerCase().includes(e.toLowerCase())).map(s=>({title:s.command,previewText:s.text,command:({editor:a,range:l})=>{a.chain().focus().deleteRange(l).insertContent(s.text).run()}}))},render:()=>{let e,n=0,r;return{onStart:i=>{var s;r=i,e=document.createElement("div"),e.style.cssText=`
            position: absolute;
            z-index: 100;
            background: white;
            border: 1px solid #e5e7eb;
            border-radius: 6px;
            padding: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            min-width: 300px;
            max-width: 400px;
          `,r.items.forEach((a,l)=>{var f;const c=document.createElement("button");c.style.cssText=`
              display: flex;
              width: 100%;
              align-items: center;
              gap: 8px;
              text-align: left;
              padding: 8px 12px;
              border: none;
              background: none;
              cursor: pointer;
              border-radius: 4px;
              ${l===n?"background-color: #f3f4f6;":""}
            `;const u=document.createElement("div");u.textContent=a.title,u.style.cssText=`
              font-weight: 500;
              color: #1f2937;
              flex-shrink: 0;
            `;const d=document.createElement("div");d.textContent=(f=a.previewText)!=null&&f.length&&a.previewText.length>100?a.previewText.substring(0,100)+"...":a.previewText||"",d.style.cssText=`
              font-size: 14px;
              color: #6b7280;
              white-space: nowrap;
              overflow: hidden;
              text-overflow: ellipsis;
            `,c.appendChild(u),c.appendChild(d),c.addEventListener("click",()=>{r.command(a),e.remove()}),e.appendChild(c)}),document.body.appendChild(e);const o=(s=r.clientRect)==null?void 0:s.call(r);o&&(e.style.top=`${o.top+window.scrollY-e.offsetHeight-10}px`,e.style.left=`${o.left+window.scrollX}px`)},onUpdate:i=>{var s;r=i;const o=(s=r.clientRect)==null?void 0:s.call(r);o&&(e.style.top=`${o.top+window.scrollY-e.offsetHeight-10}px`,e.style.left=`${o.left+window.scrollX}px`)},onKeyDown:({event:i})=>i.key==="ArrowDown"?(n=(n+1)%e.children.length,Array.from(e.children).forEach((o,s)=>{o.style.backgroundColor=s===n?"#f3f4f6":""}),!0):i.key==="ArrowUp"?(n=(n-1+e.children.length)%e.children.length,Array.from(e.children).forEach((o,s)=>{o.style.backgroundColor=s===n?"#f3f4f6":""}),!0):i.key==="Enter"&&e.children.length>0?(r.command(r.items[n]),e.remove(),!0):!1,onExit:()=>{e.remove()}}}}}},addProseMirrorPlugins(){return[J5({editor:this.editor,...this.options.suggestion})]}});function Q5(t){return/<(.|\n)*?>/g.test(t.trim())}function X5(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function Z5(t){return`<p>${X5(t).split(/\r?\n/).join("<br/>")}</p>`}function k1(t){return t.trim()?Q5(t)?t:Z5(t):""}const $s={editor:{flex:1,width:"100%",height:"100%",fontSize:"16px",lineHeight:"1.5",color:"#374151",outline:"none",cursor:"text",display:"flex",flexDirection:"column",position:"relative",overflow:"auto",backgroundColor:"#ffffff","& .ProseMirror":{outline:"none !important",border:"none !important",flex:1,padding:"12px",whiteSpace:"pre-wrap",overflowY:"auto",overflowX:"hidden",minHeight:"100%",height:"100%",display:"flex",flexDirection:"column",position:"relative","& > *:first-child":{marginTop:0},"& > *:last-child":{marginBottom:"auto"},"&::after":{content:'""',position:"absolute",top:0,left:0,right:0,bottom:0,pointerEvents:"none",zIndex:-1},"&.ProseMirror p.is-editor-empty:first-child::before":{content:"attr(data-placeholder)",float:"left",color:"#adb5bd",pointerEvents:"none",height:"0"},"& .preserve-whitespace":{whiteSpace:"pre-wrap"},"&:focus":{outline:"none !important",border:"none !important"},"&.ProseMirror-focused":{outline:"none !important",border:"none !important"},"& ul":{listStyleType:"disc",paddingLeft:"1.5em",marginTop:"0.5em",marginBottom:"0.5em"},"& ol":{listStyleType:"decimal",paddingLeft:"1.5em",marginTop:"0.5em",marginBottom:"0.5em"}}},bubbleMenu:{display:"flex",gap:"8px",backgroundColor:"white",padding:"8px",borderRadius:"6px",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)",border:"1px solid #e5e7eb"},menuButton:{padding:"4px 8px",backgroundColor:"transparent",border:"none",borderRadius:"4px",cursor:"pointer",color:"#6b7280","&:hover":{backgroundColor:"#f3f4f6"}},copyButton:{position:"absolute",right:"8px",top:"8px",padding:"4px 8px",backgroundColor:"#f3f4f6",borderRadius:"4px",cursor:"pointer",fontSize:"14px",color:"#6b7280","&:hover":{backgroundColor:"#e5e7eb"}},editorToolbar:{display:"flex",gap:"8px",alignItems:"center",marginBottom:"8px",height:"36px"},toolbarButton:{padding:"4px 8px",backgroundColor:"#f3f4f6",border:"1px solid #e5e7eb",borderRadius:"4px",cursor:"pointer",fontSize:"14px",color:"#6b7280",display:"flex",alignItems:"center",gap:"4px","&:hover":{backgroundColor:"#e5e7eb"},"&:disabled":{opacity:.5,cursor:"not-allowed"}}};function dm({content:t,onChange:e,readOnly:n=!1,placeholder:r="Start typing...",snippets:i=[],onEditorReady:o}){const[s,a]=y.useState(""),l=y.useRef(!1),c=y.useRef(t),u=y.useMemo(()=>k1(t),[t]),d=zB({extensions:[W5.configure({bulletList:{keepMarks:!0,keepAttributes:!1},orderedList:{keepMarks:!0,keepAttributes:!1}}),K5.configure({placeholder:r}),Y5.configure({snippets:i})],editorProps:{attributes:{class:"focus:outline-none w-full h-full prose prose-sm sm:prose lg:prose-lg"},handleClick(p,m,g){return m!==null?!1:(d&&d.commands.focus("end"),!0)}},content:u,onUpdate:({editor:p})=>{l.current||(l.current=!0);const m=p.getHTML();a(m)},editable:!n});y.useEffect(()=>{d&&o&&o(d)},[d,o]),y.useEffect(()=>{if(d&&t!==c.current&&!l.current){const p=k1(t);d.commands.setContent(p),c.current=t}},[t,d]);const f=R0(s,200);if(y.useEffect(()=>{f&&l.current&&e&&(e(f),l.current=!1,c.current=f)},[f,e]),!!d)return h.jsxs("div",{style:{height:"100%",display:"flex",flexDirection:"column",position:"relative"},children:[!n&&h.jsx(VB,{editor:d,tippyOptions:{duration:100},children:h.jsxs("div",{style:$s.bubbleMenu,children:[h.jsx("button",{onClick:()=>d.chain().focus().toggleBold().run(),className:d.isActive("bold")?"is-active":"",style:$s.menuButton,children:"Bold"}),h.jsx("button",{onClick:()=>d.chain().focus().toggleItalic().run(),className:d.isActive("italic")?"is-active":"",style:$s.menuButton,children:"Italic"}),h.jsx("button",{onClick:()=>d.chain().focus().toggleBulletList().run(),className:d.isActive("bulletList")?"is-active":"",style:$s.menuButton,children:"Bullet List"}),h.jsx("button",{onClick:()=>d.chain().focus().toggleOrderedList().run(),className:d.isActive("orderedList")?"is-active":"",style:$s.menuButton,children:"Numbered List"})]})}),h.jsx(MB,{editor:d,style:{...$s.editor,position:"relative",zIndex:1},onClick:p=>{(p.target===p.currentTarget||p.target.className.includes("ProseMirror"))&&d.commands.focus("end")}})]})}const ne={container:{padding:"32px 32px 0",width:"100%",height:"100%",backgroundColor:"#fff",overflow:"hidden",display:"flex",flexDirection:"column"},section:{maxWidth:"1200px",margin:"0 auto",width:"100%",height:"100%",display:"flex",flexDirection:"column"},header:{flex:"0 0 auto"},contentContainer:{flex:1,overflow:"auto",minHeight:0},title:{fontSize:"16px",fontWeight:"500",marginBottom:"8px",color:"#1f2937"},tabs:{display:"flex",gap:"24px",marginBottom:"16px",borderBottom:"1px solid #e5e7eb"},tab:{padding:"12px 0",fontSize:"14px",color:"#6b7280",cursor:"pointer",borderBottomWidth:"2px",borderBottomStyle:"solid",borderBottomColor:"transparent",marginBottom:"-1px"},activeTab:{color:"#2563eb",borderBottomColor:"#2563eb"},formGrid:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",columnGap:"24px",rowGap:"8px"},field:{marginBottom:"8px"},label:{display:"block",fontSize:"14px",color:"#4b5563",marginBottom:"8px"},sublabel:{display:"block",fontSize:"14px",color:"#6b7280",marginBottom:"8px"},select:{width:"100%",padding:"8px 12px",fontSize:"14px",border:"1px solid #d1d5db",borderRadius:"6px",color:"#1f2937",backgroundColor:"#fff",cursor:"pointer",appearance:"none",backgroundImage:'url("data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2224%22%20height%3D%2224%22%20viewBox%3D%220%200%2024%2024%22%20fill%3D%22none%22%20stroke%3D%22%236b7280%22%20stroke-width%3D%222%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%3E%3Cpolyline%20points%3D%226%209%2012%2015%2018%209%22%3E%3C%2Fpolyline%3E%3C%2Fsvg%3E")',backgroundRepeat:"no-repeat",backgroundPosition:"right 8px center",backgroundSize:"16px",paddingRight:"32px"},input:{width:"100%",padding:"8px 12px",fontSize:"14px",border:"1px solid #d1d5db",borderRadius:"6px",color:"#1f2937",backgroundColor:"#fff","&:focus":{outline:"none",borderColor:"#2563eb",boxShadow:"0 0 0 2px rgba(37, 99, 235, 0.2)"}},sectionTitle:{fontSize:"16px",fontWeight:"500",marginTop:"8px",color:"#1f2937"}};function go(t,e){if(t==null)return{};var n={},r=Object.keys(t),i,o;for(o=0;o<r.length;o++)i=r[o],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}var e6=["color"],Bh=y.forwardRef(function(t,e){var n=t.color,r=n===void 0?"currentColor":n,i=go(t,e6);return y.createElement("svg",Object.assign({width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},i,{ref:e}),y.createElement("path",{d:"M3.13523 6.15803C3.3241 5.95657 3.64052 5.94637 3.84197 6.13523L7.5 9.56464L11.158 6.13523C11.3595 5.94637 11.6759 5.95657 11.8648 6.15803C12.0536 6.35949 12.0434 6.67591 11.842 6.86477L7.84197 10.6148C7.64964 10.7951 7.35036 10.7951 7.15803 10.6148L3.15803 6.86477C2.95657 6.67591 2.94637 6.35949 3.13523 6.15803Z",fill:r,fillRule:"evenodd",clipRule:"evenodd"}))}),t6=["color"],Uc=y.forwardRef(function(t,e){var n=t.color,r=n===void 0?"currentColor":n,i=go(t,t6);return y.createElement("svg",Object.assign({width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},i,{ref:e}),y.createElement("path",{d:"M11.7816 4.03157C12.0062 3.80702 12.0062 3.44295 11.7816 3.2184C11.5571 2.99385 11.193 2.99385 10.9685 3.2184L7.50005 6.68682L4.03164 3.2184C3.80708 2.99385 3.44301 2.99385 3.21846 3.2184C2.99391 3.44295 2.99391 3.80702 3.21846 4.03157L6.68688 7.49999L3.21846 10.9684C2.99391 11.193 2.99391 11.557 3.21846 11.7816C3.44301 12.0061 3.80708 12.0061 4.03164 11.7816L7.50005 8.31316L10.9685 11.7816C11.193 12.0061 11.5571 12.0061 11.7816 11.7816C12.0062 11.557 12.0062 11.193 11.7816 10.9684L8.31322 7.49999L11.7816 4.03157Z",fill:r,fillRule:"evenodd",clipRule:"evenodd"}))}),n6=["color"],r6=y.forwardRef(function(t,e){var n=t.color,r=n===void 0?"currentColor":n,i=go(t,n6);return y.createElement("svg",Object.assign({width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},i,{ref:e}),y.createElement("path",{d:"M8.625 2.5C8.625 3.12132 8.12132 3.625 7.5 3.625C6.87868 3.625 6.375 3.12132 6.375 2.5C6.375 1.87868 6.87868 1.375 7.5 1.375C8.12132 1.375 8.625 1.87868 8.625 2.5ZM8.625 7.5C8.625 8.12132 8.12132 8.625 7.5 8.625C6.87868 8.625 6.375 8.12132 6.375 7.5C6.375 6.87868 6.87868 6.375 7.5 6.375C8.12132 6.375 8.625 6.87868 8.625 7.5ZM7.5 13.625C8.12132 13.625 8.625 13.1213 8.625 12.5C8.625 11.8787 8.12132 11.375 7.5 11.375C6.87868 11.375 6.375 11.8787 6.375 12.5C6.375 13.1213 6.87868 13.625 7.5 13.625Z",fill:r,fillRule:"evenodd",clipRule:"evenodd"}))}),i6=["color"],o6=y.forwardRef(function(t,e){var n=t.color,r=n===void 0?"currentColor":n,i=go(t,i6);return y.createElement("svg",Object.assign({width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},i,{ref:e}),y.createElement("path",{d:"M10 6.5C10 8.433 8.433 10 6.5 10C4.567 10 3 8.433 3 6.5C3 4.567 4.567 3 6.5 3C8.433 3 10 4.567 10 6.5ZM9.30884 10.0159C8.53901 10.6318 7.56251 11 6.5 11C4.01472 11 2 8.98528 2 6.5C2 4.01472 4.01472 2 6.5 2C8.98528 2 11 4.01472 11 6.5C11 7.56251 10.6318 8.53901 10.0159 9.30884L12.8536 12.1464C13.0488 12.3417 13.0488 12.6583 12.8536 12.8536C12.6583 13.0488 12.3417 13.0488 12.1464 12.8536L9.30884 10.0159Z",fill:r,fillRule:"evenodd",clipRule:"evenodd"}))}),s6=["color"],a6=y.forwardRef(function(t,e){var n=t.color,r=n===void 0?"currentColor":n,i=go(t,s6);return y.createElement("svg",Object.assign({width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},i,{ref:e}),y.createElement("path",{d:"M11.8536 1.14645C11.6583 0.951184 11.3417 0.951184 11.1465 1.14645L3.71455 8.57836C3.62459 8.66832 3.55263 8.77461 3.50251 8.89155L2.04044 12.303C1.9599 12.491 2.00189 12.709 2.14646 12.8536C2.29103 12.9981 2.50905 13.0401 2.69697 12.9596L6.10847 11.4975C6.2254 11.4474 6.3317 11.3754 6.42166 11.2855L13.8536 3.85355C14.0488 3.65829 14.0488 3.34171 13.8536 3.14645L11.8536 1.14645ZM4.42166 9.28547L11.5 2.20711L12.7929 3.5L5.71455 10.5784L4.21924 11.2192L3.78081 10.7808L4.42166 9.28547Z",fill:r,fillRule:"evenodd",clipRule:"evenodd"}))}),l6=["color"],Vc=y.forwardRef(function(t,e){var n=t.color,r=n===void 0?"currentColor":n,i=go(t,l6);return y.createElement("svg",Object.assign({width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},i,{ref:e}),y.createElement("path",{d:"M8 2.75C8 2.47386 7.77614 2.25 7.5 2.25C7.22386 2.25 7 2.47386 7 2.75V7H2.75C2.47386 7 2.25 7.22386 2.25 7.5C2.25 7.77614 2.47386 8 2.75 8H7V12.25C7 12.5261 7.22386 12.75 7.5 12.75C7.77614 12.75 8 12.5261 8 12.25V8H12.25C12.5261 8 12.75 7.77614 12.75 7.5C12.75 7.22386 12.5261 7 12.25 7H8V2.75Z",fill:r,fillRule:"evenodd",clipRule:"evenodd"}))}),c6=["color"],u6=y.forwardRef(function(t,e){var n=t.color,r=n===void 0?"currentColor":n,i=go(t,c6);return y.createElement("svg",Object.assign({width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},i,{ref:e}),y.createElement("path",{d:"M7.49998 0.849976C7.22383 0.849976 6.99998 1.07383 6.99998 1.34998V3.52234C6.99998 3.79848 7.22383 4.02234 7.49998 4.02234C7.77612 4.02234 7.99998 3.79848 7.99998 3.52234V1.8718C10.8862 2.12488 13.15 4.54806 13.15 7.49998C13.15 10.6204 10.6204 13.15 7.49998 13.15C4.37957 13.15 1.84998 10.6204 1.84998 7.49998C1.84998 6.10612 2.35407 4.83128 3.19049 3.8459C3.36919 3.63538 3.34339 3.31985 3.13286 3.14115C2.92234 2.96245 2.60681 2.98825 2.42811 3.19877C1.44405 4.35808 0.849976 5.86029 0.849976 7.49998C0.849976 11.1727 3.82728 14.15 7.49998 14.15C11.1727 14.15 14.15 11.1727 14.15 7.49998C14.15 3.82728 11.1727 0.849976 7.49998 0.849976ZM6.74049 8.08072L4.22363 4.57237C4.15231 4.47295 4.16346 4.33652 4.24998 4.25C4.33649 4.16348 4.47293 4.15233 4.57234 4.22365L8.08069 6.74051C8.56227 7.08599 8.61906 7.78091 8.19998 8.2C7.78089 8.61909 7.08597 8.56229 6.74049 8.08072Z",fill:r,fillRule:"evenodd",clipRule:"evenodd"}))}),d6=["color"],xy=y.forwardRef(function(t,e){var n=t.color,r=n===void 0?"currentColor":n,i=go(t,d6);return y.createElement("svg",Object.assign({width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},i,{ref:e}),y.createElement("path",{d:"M5.5 1C5.22386 1 5 1.22386 5 1.5C5 1.77614 5.22386 2 5.5 2H9.5C9.77614 2 10 1.77614 10 1.5C10 1.22386 9.77614 1 9.5 1H5.5ZM3 3.5C3 3.22386 3.22386 3 3.5 3H5H10H11.5C11.7761 3 12 3.22386 12 3.5C12 3.77614 11.7761 4 11.5 4H11V12C11 12.5523 10.5523 13 10 13H5C4.44772 13 4 12.5523 4 12V4L3.5 4C3.22386 4 3 3.77614 3 3.5ZM5 4H10V12H5V4Z",fill:r,fillRule:"evenodd",clipRule:"evenodd"}))});function Q(t,e,{checkForDefaultPrevented:n=!0}={}){return function(i){if(t==null||t(i),n===!1||!i.defaultPrevented)return e==null?void 0:e(i)}}function E1(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function zh(...t){return e=>{let n=!1;const r=t.map(i=>{const o=E1(i,e);return!n&&typeof o=="function"&&(n=!0),o});if(n)return()=>{for(let i=0;i<r.length;i++){const o=r[i];typeof o=="function"?o():E1(t[i],null)}}}}function He(...t){return y.useCallback(zh(...t),t)}function f6(t,e){const n=y.createContext(e),r=o=>{const{children:s,...a}=o,l=y.useMemo(()=>a,Object.values(a));return h.jsx(n.Provider,{value:l,children:s})};r.displayName=t+"Provider";function i(o){const s=y.useContext(n);if(s)return s;if(e!==void 0)return e;throw new Error(`\`${o}\` must be used within \`${t}\``)}return[r,i]}function yo(t,e=[]){let n=[];function r(o,s){const a=y.createContext(s),l=n.length;n=[...n,s];const c=d=>{var x;const{scope:f,children:p,...m}=d,g=((x=f==null?void 0:f[t])==null?void 0:x[l])||a,v=y.useMemo(()=>m,Object.values(m));return h.jsx(g.Provider,{value:v,children:p})};c.displayName=o+"Provider";function u(d,f){var g;const p=((g=f==null?void 0:f[t])==null?void 0:g[l])||a,m=y.useContext(p);if(m)return m;if(s!==void 0)return s;throw new Error(`\`${d}\` must be used within \`${o}\``)}return[c,u]}const i=()=>{const o=n.map(s=>y.createContext(s));return function(a){const l=(a==null?void 0:a[t])||o;return y.useMemo(()=>({[`__scope${t}`]:{...a,[t]:l}}),[a,l])}};return i.scopeName=t,[r,h6(i,...e)]}function h6(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const r=t.map(i=>({useScope:i(),scopeName:i.scopeName}));return function(o){const s=r.reduce((a,{useScope:l,scopeName:c})=>{const d=l(o)[`__scope${c}`];return{...a,...d}},{});return y.useMemo(()=>({[`__scope${e.scopeName}`]:s}),[s])}};return n.scopeName=e.scopeName,n}var ro=globalThis!=null&&globalThis.document?y.useLayoutEffect:()=>{},p6=mP["useId".toString()]||(()=>{}),m6=0;function rs(t){const[e,n]=y.useState(p6());return ro(()=>{t||n(r=>r??String(m6++))},[t]),t||(e?`radix-${e}`:"")}function jt(t){const e=y.useRef(t);return y.useEffect(()=>{e.current=t}),y.useMemo(()=>(...n)=>{var r;return(r=e.current)==null?void 0:r.call(e,...n)},[])}function Su({prop:t,defaultProp:e,onChange:n=()=>{}}){const[r,i]=g6({defaultProp:e,onChange:n}),o=t!==void 0,s=o?t:r,a=jt(n),l=y.useCallback(c=>{if(o){const d=typeof c=="function"?c(t):c;d!==t&&a(d)}else i(c)},[o,t,i,a]);return[s,l]}function g6({defaultProp:t,onChange:e}){const n=y.useState(t),[r]=n,i=y.useRef(r),o=jt(e);return y.useEffect(()=>{i.current!==r&&(o(r),i.current=r)},[r,i,o]),n}var vs=y.forwardRef((t,e)=>{const{children:n,...r}=t,i=y.Children.toArray(n),o=i.find(v6);if(o){const s=o.props.children,a=i.map(l=>l===o?y.Children.count(s)>1?y.Children.only(null):y.isValidElement(s)?s.props.children:null:l);return h.jsx(wy,{...r,ref:e,children:y.isValidElement(s)?y.cloneElement(s,void 0,a):null})}return h.jsx(wy,{...r,ref:e,children:n})});vs.displayName="Slot";var wy=y.forwardRef((t,e)=>{const{children:n,...r}=t;if(y.isValidElement(n)){const i=w6(n),o=x6(r,n.props);return n.type!==y.Fragment&&(o.ref=e?zh(e,i):i),y.cloneElement(n,o)}return y.Children.count(n)>1?y.Children.only(null):null});wy.displayName="SlotClone";var y6=({children:t})=>h.jsx(h.Fragment,{children:t});function v6(t){return y.isValidElement(t)&&t.type===y6}function x6(t,e){const n={...e};for(const r in e){const i=t[r],o=e[r];/^on[A-Z]/.test(r)?i&&o?n[r]=(...a)=>{o(...a),i(...a)}:i&&(n[r]=i):r==="style"?n[r]={...i,...o}:r==="className"&&(n[r]=[i,o].filter(Boolean).join(" "))}return{...t,...n}}function w6(t){var r,i;let e=(r=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(i=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:i.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}var b6=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],ge=b6.reduce((t,e)=>{const n=y.forwardRef((r,i)=>{const{asChild:o,...s}=r,a=o?vs:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),h.jsx(a,{...s,ref:i})});return n.displayName=`Primitive.${e}`,{...t,[e]:n}},{});function O0(t,e){t&&du.flushSync(()=>t.dispatchEvent(e))}function S6(t,e=globalThis==null?void 0:globalThis.document){const n=jt(t);y.useEffect(()=>{const r=i=>{i.key==="Escape"&&n(i)};return e.addEventListener("keydown",r,{capture:!0}),()=>e.removeEventListener("keydown",r,{capture:!0})},[n,e])}var C6="DismissableLayer",by="dismissableLayer.update",k6="dismissableLayer.pointerDownOutside",E6="dismissableLayer.focusOutside",T1,P_=y.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Cu=y.forwardRef((t,e)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:i,onFocusOutside:o,onInteractOutside:s,onDismiss:a,...l}=t,c=y.useContext(P_),[u,d]=y.useState(null),f=(u==null?void 0:u.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,p]=y.useState({}),m=He(e,E=>d(E)),g=Array.from(c.layers),[v]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),x=g.indexOf(v),w=u?g.indexOf(u):-1,S=c.layersWithOutsidePointerEventsDisabled.size>0,b=w>=x,C=_6(E=>{const T=E.target,O=[...c.branches].some(R=>R.contains(T));!b||O||(i==null||i(E),s==null||s(E),E.defaultPrevented||a==null||a())},f),k=R6(E=>{const T=E.target;[...c.branches].some(R=>R.contains(T))||(o==null||o(E),s==null||s(E),E.defaultPrevented||a==null||a())},f);return S6(E=>{w===c.layers.size-1&&(r==null||r(E),!E.defaultPrevented&&a&&(E.preventDefault(),a()))},f),y.useEffect(()=>{if(u)return n&&(c.layersWithOutsidePointerEventsDisabled.size===0&&(T1=f.body.style.pointerEvents,f.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(u)),c.layers.add(u),_1(),()=>{n&&c.layersWithOutsidePointerEventsDisabled.size===1&&(f.body.style.pointerEvents=T1)}},[u,f,n,c]),y.useEffect(()=>()=>{u&&(c.layers.delete(u),c.layersWithOutsidePointerEventsDisabled.delete(u),_1())},[u,c]),y.useEffect(()=>{const E=()=>p({});return document.addEventListener(by,E),()=>document.removeEventListener(by,E)},[]),h.jsx(ge.div,{...l,ref:m,style:{pointerEvents:S?b?"auto":"none":void 0,...t.style},onFocusCapture:Q(t.onFocusCapture,k.onFocusCapture),onBlurCapture:Q(t.onBlurCapture,k.onBlurCapture),onPointerDownCapture:Q(t.onPointerDownCapture,C.onPointerDownCapture)})});Cu.displayName=C6;var T6="DismissableLayerBranch",M_=y.forwardRef((t,e)=>{const n=y.useContext(P_),r=y.useRef(null),i=He(e,r);return y.useEffect(()=>{const o=r.current;if(o)return n.branches.add(o),()=>{n.branches.delete(o)}},[n.branches]),h.jsx(ge.div,{...t,ref:i})});M_.displayName=T6;function _6(t,e=globalThis==null?void 0:globalThis.document){const n=jt(t),r=y.useRef(!1),i=y.useRef(()=>{});return y.useEffect(()=>{const o=a=>{if(a.target&&!r.current){let l=function(){A_(k6,n,c,{discrete:!0})};const c={originalEvent:a};a.pointerType==="touch"?(e.removeEventListener("click",i.current),i.current=l,e.addEventListener("click",i.current,{once:!0})):l()}else e.removeEventListener("click",i.current);r.current=!1},s=window.setTimeout(()=>{e.addEventListener("pointerdown",o)},0);return()=>{window.clearTimeout(s),e.removeEventListener("pointerdown",o),e.removeEventListener("click",i.current)}},[e,n]),{onPointerDownCapture:()=>r.current=!0}}function R6(t,e=globalThis==null?void 0:globalThis.document){const n=jt(t),r=y.useRef(!1);return y.useEffect(()=>{const i=o=>{o.target&&!r.current&&A_(E6,n,{originalEvent:o},{discrete:!1})};return e.addEventListener("focusin",i),()=>e.removeEventListener("focusin",i)},[e,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function _1(){const t=new CustomEvent(by);document.dispatchEvent(t)}function A_(t,e,n,{discrete:r}){const i=n.originalEvent.target,o=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:n});e&&i.addEventListener(t,e,{once:!0}),r?O0(i,o):i.dispatchEvent(o)}var O6=Cu,P6=M_,fm="focusScope.autoFocusOnMount",hm="focusScope.autoFocusOnUnmount",R1={bubbles:!1,cancelable:!0},M6="FocusScope",Uh=y.forwardRef((t,e)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:i,onUnmountAutoFocus:o,...s}=t,[a,l]=y.useState(null),c=jt(i),u=jt(o),d=y.useRef(null),f=He(e,g=>l(g)),p=y.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;y.useEffect(()=>{if(r){let g=function(S){if(p.paused||!a)return;const b=S.target;a.contains(b)?d.current=b:pi(d.current,{select:!0})},v=function(S){if(p.paused||!a)return;const b=S.relatedTarget;b!==null&&(a.contains(b)||pi(d.current,{select:!0}))},x=function(S){if(document.activeElement===document.body)for(const C of S)C.removedNodes.length>0&&pi(a)};document.addEventListener("focusin",g),document.addEventListener("focusout",v);const w=new MutationObserver(x);return a&&w.observe(a,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",g),document.removeEventListener("focusout",v),w.disconnect()}}},[r,a,p.paused]),y.useEffect(()=>{if(a){P1.add(p);const g=document.activeElement;if(!a.contains(g)){const x=new CustomEvent(fm,R1);a.addEventListener(fm,c),a.dispatchEvent(x),x.defaultPrevented||(A6(L6(D_(a)),{select:!0}),document.activeElement===g&&pi(a))}return()=>{a.removeEventListener(fm,c),setTimeout(()=>{const x=new CustomEvent(hm,R1);a.addEventListener(hm,u),a.dispatchEvent(x),x.defaultPrevented||pi(g??document.body,{select:!0}),a.removeEventListener(hm,u),P1.remove(p)},0)}}},[a,c,u,p]);const m=y.useCallback(g=>{if(!n&&!r||p.paused)return;const v=g.key==="Tab"&&!g.altKey&&!g.ctrlKey&&!g.metaKey,x=document.activeElement;if(v&&x){const w=g.currentTarget,[S,b]=D6(w);S&&b?!g.shiftKey&&x===b?(g.preventDefault(),n&&pi(S,{select:!0})):g.shiftKey&&x===S&&(g.preventDefault(),n&&pi(b,{select:!0})):x===w&&g.preventDefault()}},[n,r,p.paused]);return h.jsx(ge.div,{tabIndex:-1,...s,ref:f,onKeyDown:m})});Uh.displayName=M6;function A6(t,{select:e=!1}={}){const n=document.activeElement;for(const r of t)if(pi(r,{select:e}),document.activeElement!==n)return}function D6(t){const e=D_(t),n=O1(e,t),r=O1(e.reverse(),t);return[n,r]}function D_(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const i=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||i?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function O1(t,e){for(const n of t)if(!I6(n,{upTo:e}))return n}function I6(t,{upTo:e}){if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(e!==void 0&&t===e)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1}function N6(t){return t instanceof HTMLInputElement&&"select"in t}function pi(t,{select:e=!1}={}){if(t&&t.focus){const n=document.activeElement;t.focus({preventScroll:!0}),t!==n&&N6(t)&&e&&t.select()}}var P1=j6();function j6(){let t=[];return{add(e){const n=t[0];e!==n&&(n==null||n.pause()),t=M1(t,e),t.unshift(e)},remove(e){var n;t=M1(t,e),(n=t[0])==null||n.resume()}}}function M1(t,e){const n=[...t],r=n.indexOf(e);return r!==-1&&n.splice(r,1),n}function L6(t){return t.filter(e=>e.tagName!=="A")}var $6="Portal",ku=y.forwardRef((t,e)=>{var a;const{container:n,...r}=t,[i,o]=y.useState(!1);ro(()=>o(!0),[]);const s=n||i&&((a=globalThis==null?void 0:globalThis.document)==null?void 0:a.body);return s?Rk.createPortal(h.jsx(ge.div,{...r,ref:e}),s):null});ku.displayName=$6;function F6(t,e){return y.useReducer((n,r)=>e[n][r]??n,t)}var lr=t=>{const{present:e,children:n}=t,r=B6(e),i=typeof n=="function"?n({present:r.isPresent}):y.Children.only(n),o=He(r.ref,z6(i));return typeof n=="function"||r.isPresent?y.cloneElement(i,{ref:o}):null};lr.displayName="Presence";function B6(t){const[e,n]=y.useState(),r=y.useRef({}),i=y.useRef(t),o=y.useRef("none"),s=t?"mounted":"unmounted",[a,l]=F6(s,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return y.useEffect(()=>{const c=md(r.current);o.current=a==="mounted"?c:"none"},[a]),ro(()=>{const c=r.current,u=i.current;if(u!==t){const f=o.current,p=md(c);t?l("MOUNT"):p==="none"||(c==null?void 0:c.display)==="none"?l("UNMOUNT"):l(u&&f!==p?"ANIMATION_OUT":"UNMOUNT"),i.current=t}},[t,l]),ro(()=>{if(e){let c;const u=e.ownerDocument.defaultView??window,d=p=>{const g=md(r.current).includes(p.animationName);if(p.target===e&&g&&(l("ANIMATION_END"),!i.current)){const v=e.style.animationFillMode;e.style.animationFillMode="forwards",c=u.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=v)})}},f=p=>{p.target===e&&(o.current=md(r.current))};return e.addEventListener("animationstart",f),e.addEventListener("animationcancel",d),e.addEventListener("animationend",d),()=>{u.clearTimeout(c),e.removeEventListener("animationstart",f),e.removeEventListener("animationcancel",d),e.removeEventListener("animationend",d)}}else l("ANIMATION_END")},[e,l]),{isPresent:["mounted","unmountSuspended"].includes(a),ref:y.useCallback(c=>{c&&(r.current=getComputedStyle(c)),n(c)},[])}}function md(t){return(t==null?void 0:t.animationName)||"none"}function z6(t){var r,i;let e=(r=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(i=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:i.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}var pm=0;function P0(){y.useEffect(()=>{const t=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",t[0]??A1()),document.body.insertAdjacentElement("beforeend",t[1]??A1()),pm++,()=>{pm===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),pm--}},[])}function A1(){const t=document.createElement("span");return t.setAttribute("data-radix-focus-guard",""),t.tabIndex=0,t.style.outline="none",t.style.opacity="0",t.style.position="fixed",t.style.pointerEvents="none",t}var wr=function(){return wr=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},wr.apply(this,arguments)};function I_(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n}function U6(t,e,n){if(n||arguments.length===2)for(var r=0,i=e.length,o;r<i;r++)(o||!(r in e))&&(o||(o=Array.prototype.slice.call(e,0,r)),o[r]=e[r]);return t.concat(o||Array.prototype.slice.call(e))}var Hd="right-scroll-bar-position",Wd="width-before-scroll-bar",V6="with-scroll-bars-hidden",H6="--removed-body-scroll-bar-size";function mm(t,e){return typeof t=="function"?t(e):t&&(t.current=e),t}function W6(t,e){var n=y.useState(function(){return{value:t,callback:e,facade:{get current(){return n.value},set current(r){var i=n.value;i!==r&&(n.value=r,n.callback(r,i))}}}})[0];return n.callback=e,n.facade}var K6=typeof window<"u"?y.useLayoutEffect:y.useEffect,D1=new WeakMap;function q6(t,e){var n=W6(e||null,function(r){return t.forEach(function(i){return mm(i,r)})});return K6(function(){var r=D1.get(n);if(r){var i=new Set(r),o=new Set(t),s=n.current;i.forEach(function(a){o.has(a)||mm(a,null)}),o.forEach(function(a){i.has(a)||mm(a,s)})}D1.set(n,t)},[t]),n}function G6(t){return t}function J6(t,e){e===void 0&&(e=G6);var n=[],r=!1,i={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:t},useMedium:function(o){var s=e(o,r);return n.push(s),function(){n=n.filter(function(a){return a!==s})}},assignSyncMedium:function(o){for(r=!0;n.length;){var s=n;n=[],s.forEach(o)}n={push:function(a){return o(a)},filter:function(){return n}}},assignMedium:function(o){r=!0;var s=[];if(n.length){var a=n;n=[],a.forEach(o),s=n}var l=function(){var u=s;s=[],u.forEach(o)},c=function(){return Promise.resolve().then(l)};c(),n={push:function(u){s.push(u),c()},filter:function(u){return s=s.filter(u),n}}}};return i}function Y6(t){t===void 0&&(t={});var e=J6(null);return e.options=wr({async:!0,ssr:!1},t),e}var N_=function(t){var e=t.sideCar,n=I_(t,["sideCar"]);if(!e)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=e.read();if(!r)throw new Error("Sidecar medium not found");return y.createElement(r,wr({},n))};N_.isSideCarExport=!0;function Q6(t,e){return t.useMedium(e),N_}var j_=Y6(),gm=function(){},Vh=y.forwardRef(function(t,e){var n=y.useRef(null),r=y.useState({onScrollCapture:gm,onWheelCapture:gm,onTouchMoveCapture:gm}),i=r[0],o=r[1],s=t.forwardProps,a=t.children,l=t.className,c=t.removeScrollBar,u=t.enabled,d=t.shards,f=t.sideCar,p=t.noIsolation,m=t.inert,g=t.allowPinchZoom,v=t.as,x=v===void 0?"div":v,w=t.gapMode,S=I_(t,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),b=f,C=q6([n,e]),k=wr(wr({},S),i);return y.createElement(y.Fragment,null,u&&y.createElement(b,{sideCar:j_,removeScrollBar:c,shards:d,noIsolation:p,inert:m,setCallbacks:o,allowPinchZoom:!!g,lockRef:n,gapMode:w}),s?y.cloneElement(y.Children.only(a),wr(wr({},k),{ref:C})):y.createElement(x,wr({},k,{className:l,ref:C}),a))});Vh.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};Vh.classNames={fullWidth:Wd,zeroRight:Hd};var I1,X6=function(){if(I1)return I1;if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function Z6(){if(!document)return null;var t=document.createElement("style");t.type="text/css";var e=X6();return e&&t.setAttribute("nonce",e),t}function ez(t,e){t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e))}function tz(t){var e=document.head||document.getElementsByTagName("head")[0];e.appendChild(t)}var nz=function(){var t=0,e=null;return{add:function(n){t==0&&(e=Z6())&&(ez(e,n),tz(e)),t++},remove:function(){t--,!t&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},rz=function(){var t=nz();return function(e,n){y.useEffect(function(){return t.add(e),function(){t.remove()}},[e&&n])}},L_=function(){var t=rz(),e=function(n){var r=n.styles,i=n.dynamic;return t(r,i),null};return e},iz={left:0,top:0,right:0,gap:0},ym=function(t){return parseInt(t||"",10)||0},oz=function(t){var e=window.getComputedStyle(document.body),n=e[t==="padding"?"paddingLeft":"marginLeft"],r=e[t==="padding"?"paddingTop":"marginTop"],i=e[t==="padding"?"paddingRight":"marginRight"];return[ym(n),ym(r),ym(i)]},sz=function(t){if(t===void 0&&(t="margin"),typeof window>"u")return iz;var e=oz(t),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,r-n+e[2]-e[0])}},az=L_(),xa="data-scroll-locked",lz=function(t,e,n,r){var i=t.left,o=t.top,s=t.right,a=t.gap;return n===void 0&&(n="margin"),`
  .`.concat(V6,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(a,"px ").concat(r,`;
  }
  body[`).concat(xa,`] {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([e&&"position: relative ".concat(r,";"),n==="margin"&&`
    padding-left: `.concat(i,`px;
    padding-top: `).concat(o,`px;
    padding-right: `).concat(s,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(a,"px ").concat(r,`;
    `),n==="padding"&&"padding-right: ".concat(a,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(Hd,` {
    right: `).concat(a,"px ").concat(r,`;
  }
  
  .`).concat(Wd,` {
    margin-right: `).concat(a,"px ").concat(r,`;
  }
  
  .`).concat(Hd," .").concat(Hd,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(Wd," .").concat(Wd,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body[`).concat(xa,`] {
    `).concat(H6,": ").concat(a,`px;
  }
`)},N1=function(){var t=parseInt(document.body.getAttribute(xa)||"0",10);return isFinite(t)?t:0},cz=function(){y.useEffect(function(){return document.body.setAttribute(xa,(N1()+1).toString()),function(){var t=N1()-1;t<=0?document.body.removeAttribute(xa):document.body.setAttribute(xa,t.toString())}},[])},uz=function(t){var e=t.noRelative,n=t.noImportant,r=t.gapMode,i=r===void 0?"margin":r;cz();var o=y.useMemo(function(){return sz(i)},[i]);return y.createElement(az,{styles:lz(o,!e,i,n?"":"!important")})},Sy=!1;if(typeof window<"u")try{var gd=Object.defineProperty({},"passive",{get:function(){return Sy=!0,!0}});window.addEventListener("test",gd,gd),window.removeEventListener("test",gd,gd)}catch{Sy=!1}var Fs=Sy?{passive:!1}:!1,dz=function(t){return t.tagName==="TEXTAREA"},$_=function(t,e){if(!(t instanceof Element))return!1;var n=window.getComputedStyle(t);return n[e]!=="hidden"&&!(n.overflowY===n.overflowX&&!dz(t)&&n[e]==="visible")},fz=function(t){return $_(t,"overflowY")},hz=function(t){return $_(t,"overflowX")},j1=function(t,e){var n=e.ownerDocument,r=e;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var i=F_(t,r);if(i){var o=B_(t,r),s=o[1],a=o[2];if(s>a)return!0}r=r.parentNode}while(r&&r!==n.body);return!1},pz=function(t){var e=t.scrollTop,n=t.scrollHeight,r=t.clientHeight;return[e,n,r]},mz=function(t){var e=t.scrollLeft,n=t.scrollWidth,r=t.clientWidth;return[e,n,r]},F_=function(t,e){return t==="v"?fz(e):hz(e)},B_=function(t,e){return t==="v"?pz(e):mz(e)},gz=function(t,e){return t==="h"&&e==="rtl"?-1:1},yz=function(t,e,n,r,i){var o=gz(t,window.getComputedStyle(e).direction),s=o*r,a=n.target,l=e.contains(a),c=!1,u=s>0,d=0,f=0;do{var p=B_(t,a),m=p[0],g=p[1],v=p[2],x=g-v-o*m;(m||x)&&F_(t,a)&&(d+=x,f+=m),a instanceof ShadowRoot?a=a.host:a=a.parentNode}while(!l&&a!==document.body||l&&(e.contains(a)||e===a));return(u&&(i&&Math.abs(d)<1||!i&&s>d)||!u&&(i&&Math.abs(f)<1||!i&&-s>f))&&(c=!0),c},yd=function(t){return"changedTouches"in t?[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:[0,0]},L1=function(t){return[t.deltaX,t.deltaY]},$1=function(t){return t&&"current"in t?t.current:t},vz=function(t,e){return t[0]===e[0]&&t[1]===e[1]},xz=function(t){return`
  .block-interactivity-`.concat(t,` {pointer-events: none;}
  .allow-interactivity-`).concat(t,` {pointer-events: all;}
`)},wz=0,Bs=[];function bz(t){var e=y.useRef([]),n=y.useRef([0,0]),r=y.useRef(),i=y.useState(wz++)[0],o=y.useState(L_)[0],s=y.useRef(t);y.useEffect(function(){s.current=t},[t]),y.useEffect(function(){if(t.inert){document.body.classList.add("block-interactivity-".concat(i));var g=U6([t.lockRef.current],(t.shards||[]).map($1),!0).filter(Boolean);return g.forEach(function(v){return v.classList.add("allow-interactivity-".concat(i))}),function(){document.body.classList.remove("block-interactivity-".concat(i)),g.forEach(function(v){return v.classList.remove("allow-interactivity-".concat(i))})}}},[t.inert,t.lockRef.current,t.shards]);var a=y.useCallback(function(g,v){if("touches"in g&&g.touches.length===2||g.type==="wheel"&&g.ctrlKey)return!s.current.allowPinchZoom;var x=yd(g),w=n.current,S="deltaX"in g?g.deltaX:w[0]-x[0],b="deltaY"in g?g.deltaY:w[1]-x[1],C,k=g.target,E=Math.abs(S)>Math.abs(b)?"h":"v";if("touches"in g&&E==="h"&&k.type==="range")return!1;var T=j1(E,k);if(!T)return!0;if(T?C=E:(C=E==="v"?"h":"v",T=j1(E,k)),!T)return!1;if(!r.current&&"changedTouches"in g&&(S||b)&&(r.current=C),!C)return!0;var O=r.current||C;return yz(O,v,g,O==="h"?S:b,!0)},[]),l=y.useCallback(function(g){var v=g;if(!(!Bs.length||Bs[Bs.length-1]!==o)){var x="deltaY"in v?L1(v):yd(v),w=e.current.filter(function(C){return C.name===v.type&&(C.target===v.target||v.target===C.shadowParent)&&vz(C.delta,x)})[0];if(w&&w.should){v.cancelable&&v.preventDefault();return}if(!w){var S=(s.current.shards||[]).map($1).filter(Boolean).filter(function(C){return C.contains(v.target)}),b=S.length>0?a(v,S[0]):!s.current.noIsolation;b&&v.cancelable&&v.preventDefault()}}},[]),c=y.useCallback(function(g,v,x,w){var S={name:g,delta:v,target:x,should:w,shadowParent:Sz(x)};e.current.push(S),setTimeout(function(){e.current=e.current.filter(function(b){return b!==S})},1)},[]),u=y.useCallback(function(g){n.current=yd(g),r.current=void 0},[]),d=y.useCallback(function(g){c(g.type,L1(g),g.target,a(g,t.lockRef.current))},[]),f=y.useCallback(function(g){c(g.type,yd(g),g.target,a(g,t.lockRef.current))},[]);y.useEffect(function(){return Bs.push(o),t.setCallbacks({onScrollCapture:d,onWheelCapture:d,onTouchMoveCapture:f}),document.addEventListener("wheel",l,Fs),document.addEventListener("touchmove",l,Fs),document.addEventListener("touchstart",u,Fs),function(){Bs=Bs.filter(function(g){return g!==o}),document.removeEventListener("wheel",l,Fs),document.removeEventListener("touchmove",l,Fs),document.removeEventListener("touchstart",u,Fs)}},[]);var p=t.removeScrollBar,m=t.inert;return y.createElement(y.Fragment,null,m?y.createElement(o,{styles:xz(i)}):null,p?y.createElement(uz,{gapMode:t.gapMode}):null)}function Sz(t){for(var e=null;t!==null;)t instanceof ShadowRoot&&(e=t.host,t=t.host),t=t.parentNode;return e}const Cz=Q6(j_,bz);var z_=y.forwardRef(function(t,e){return y.createElement(Vh,wr({},t,{ref:e,sideCar:Cz}))});z_.classNames=Vh.classNames;const M0=z_;var kz=function(t){if(typeof document>"u")return null;var e=Array.isArray(t)?t[0]:t;return e.ownerDocument.body},zs=new WeakMap,vd=new WeakMap,xd={},vm=0,U_=function(t){return t&&(t.host||U_(t.parentNode))},Ez=function(t,e){return e.map(function(n){if(t.contains(n))return n;var r=U_(n);return r&&t.contains(r)?r:(console.error("aria-hidden",n,"in not contained inside",t,". Doing nothing"),null)}).filter(function(n){return!!n})},Tz=function(t,e,n,r){var i=Ez(e,Array.isArray(t)?t:[t]);xd[n]||(xd[n]=new WeakMap);var o=xd[n],s=[],a=new Set,l=new Set(i),c=function(d){!d||a.has(d)||(a.add(d),c(d.parentNode))};i.forEach(c);var u=function(d){!d||l.has(d)||Array.prototype.forEach.call(d.children,function(f){if(a.has(f))u(f);else try{var p=f.getAttribute(r),m=p!==null&&p!=="false",g=(zs.get(f)||0)+1,v=(o.get(f)||0)+1;zs.set(f,g),o.set(f,v),s.push(f),g===1&&m&&vd.set(f,!0),v===1&&f.setAttribute(n,"true"),m||f.setAttribute(r,"true")}catch(x){console.error("aria-hidden: cannot operate on ",f,x)}})};return u(e),a.clear(),vm++,function(){s.forEach(function(d){var f=zs.get(d)-1,p=o.get(d)-1;zs.set(d,f),o.set(d,p),f||(vd.has(d)||d.removeAttribute(r),vd.delete(d)),p||d.removeAttribute(n)}),vm--,vm||(zs=new WeakMap,zs=new WeakMap,vd=new WeakMap,xd={})}},A0=function(t,e,n){n===void 0&&(n="data-aria-hidden");var r=Array.from(Array.isArray(t)?t:[t]),i=e||kz(t);return i?(r.push.apply(r,Array.from(i.querySelectorAll("[aria-live]"))),Tz(r,i,n,"aria-hidden")):function(){return null}},D0="Dialog",[V_,YH]=yo(D0),[_z,cr]=V_(D0),H_=t=>{const{__scopeDialog:e,children:n,open:r,defaultOpen:i,onOpenChange:o,modal:s=!0}=t,a=y.useRef(null),l=y.useRef(null),[c=!1,u]=Su({prop:r,defaultProp:i,onChange:o});return h.jsx(_z,{scope:e,triggerRef:a,contentRef:l,contentId:rs(),titleId:rs(),descriptionId:rs(),open:c,onOpenChange:u,onOpenToggle:y.useCallback(()=>u(d=>!d),[u]),modal:s,children:n})};H_.displayName=D0;var W_="DialogTrigger",Rz=y.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,i=cr(W_,n),o=He(e,i.triggerRef);return h.jsx(ge.button,{type:"button","aria-haspopup":"dialog","aria-expanded":i.open,"aria-controls":i.contentId,"data-state":j0(i.open),...r,ref:o,onClick:Q(t.onClick,i.onOpenToggle)})});Rz.displayName=W_;var I0="DialogPortal",[Oz,K_]=V_(I0,{forceMount:void 0}),q_=t=>{const{__scopeDialog:e,forceMount:n,children:r,container:i}=t,o=cr(I0,e);return h.jsx(Oz,{scope:e,forceMount:n,children:y.Children.map(r,s=>h.jsx(lr,{present:n||o.open,children:h.jsx(ku,{asChild:!0,container:i,children:s})}))})};q_.displayName=I0;var Ff="DialogOverlay",G_=y.forwardRef((t,e)=>{const n=K_(Ff,t.__scopeDialog),{forceMount:r=n.forceMount,...i}=t,o=cr(Ff,t.__scopeDialog);return o.modal?h.jsx(lr,{present:r||o.open,children:h.jsx(Pz,{...i,ref:e})}):null});G_.displayName=Ff;var Pz=y.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,i=cr(Ff,n);return h.jsx(M0,{as:vs,allowPinchZoom:!0,shards:[i.contentRef],children:h.jsx(ge.div,{"data-state":j0(i.open),...r,ref:e,style:{pointerEvents:"auto",...r.style}})})}),xs="DialogContent",J_=y.forwardRef((t,e)=>{const n=K_(xs,t.__scopeDialog),{forceMount:r=n.forceMount,...i}=t,o=cr(xs,t.__scopeDialog);return h.jsx(lr,{present:r||o.open,children:o.modal?h.jsx(Mz,{...i,ref:e}):h.jsx(Az,{...i,ref:e})})});J_.displayName=xs;var Mz=y.forwardRef((t,e)=>{const n=cr(xs,t.__scopeDialog),r=y.useRef(null),i=He(e,n.contentRef,r);return y.useEffect(()=>{const o=r.current;if(o)return A0(o)},[]),h.jsx(Y_,{...t,ref:i,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Q(t.onCloseAutoFocus,o=>{var s;o.preventDefault(),(s=n.triggerRef.current)==null||s.focus()}),onPointerDownOutside:Q(t.onPointerDownOutside,o=>{const s=o.detail.originalEvent,a=s.button===0&&s.ctrlKey===!0;(s.button===2||a)&&o.preventDefault()}),onFocusOutside:Q(t.onFocusOutside,o=>o.preventDefault())})}),Az=y.forwardRef((t,e)=>{const n=cr(xs,t.__scopeDialog),r=y.useRef(!1),i=y.useRef(!1);return h.jsx(Y_,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:o=>{var s,a;(s=t.onCloseAutoFocus)==null||s.call(t,o),o.defaultPrevented||(r.current||(a=n.triggerRef.current)==null||a.focus(),o.preventDefault()),r.current=!1,i.current=!1},onInteractOutside:o=>{var l,c;(l=t.onInteractOutside)==null||l.call(t,o),o.defaultPrevented||(r.current=!0,o.detail.originalEvent.type==="pointerdown"&&(i.current=!0));const s=o.target;((c=n.triggerRef.current)==null?void 0:c.contains(s))&&o.preventDefault(),o.detail.originalEvent.type==="focusin"&&i.current&&o.preventDefault()}})}),Y_=y.forwardRef((t,e)=>{const{__scopeDialog:n,trapFocus:r,onOpenAutoFocus:i,onCloseAutoFocus:o,...s}=t,a=cr(xs,n),l=y.useRef(null),c=He(e,l);return P0(),h.jsxs(h.Fragment,{children:[h.jsx(Uh,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:i,onUnmountAutoFocus:o,children:h.jsx(Cu,{role:"dialog",id:a.contentId,"aria-describedby":a.descriptionId,"aria-labelledby":a.titleId,"data-state":j0(a.open),...s,ref:c,onDismiss:()=>a.onOpenChange(!1)})}),h.jsxs(h.Fragment,{children:[h.jsx(Dz,{titleId:a.titleId}),h.jsx(Nz,{contentRef:l,descriptionId:a.descriptionId})]})]})}),N0="DialogTitle",Q_=y.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,i=cr(N0,n);return h.jsx(ge.h2,{id:i.titleId,...r,ref:e})});Q_.displayName=N0;var X_="DialogDescription",Z_=y.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,i=cr(X_,n);return h.jsx(ge.p,{id:i.descriptionId,...r,ref:e})});Z_.displayName=X_;var eR="DialogClose",tR=y.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,i=cr(eR,n);return h.jsx(ge.button,{type:"button",...r,ref:e,onClick:Q(t.onClick,()=>i.onOpenChange(!1))})});tR.displayName=eR;function j0(t){return t?"open":"closed"}var nR="DialogTitleWarning",[QH,rR]=f6(nR,{contentName:xs,titleName:N0,docsSlug:"dialog"}),Dz=({titleId:t})=>{const e=rR(nR),n=`\`${e.contentName}\` requires a \`${e.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${e.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${e.docsSlug}`;return y.useEffect(()=>{t&&(document.getElementById(t)||console.error(n))},[n,t]),null},Iz="DialogDescriptionWarning",Nz=({contentRef:t,descriptionId:e})=>{const r=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${rR(Iz).contentName}}.`;return y.useEffect(()=>{var o;const i=(o=t.current)==null?void 0:o.getAttribute("aria-describedby");e&&i&&(document.getElementById(e)||console.warn(r))},[r,t,e]),null},Bf=H_,zf=q_,Uf=G_,Vf=J_,Hf=Q_,iR=Z_,Cy=tR;const sn={overlay:{backgroundColor:"rgba(0, 0, 0, 0.4)",position:"fixed",inset:0,animation:"overlayShow 150ms cubic-bezier(0.16, 1, 0.3, 1)"},content:{backgroundColor:"white",borderRadius:"8px",boxShadow:"0 10px 25px rgba(0, 0, 0, 0.2)",position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"90vw",maxWidth:"600px",maxHeight:"85vh",padding:"24px"},title:{fontSize:"20px",fontWeight:"500",color:"#1f2937",marginBottom:"24px"},field:{marginBottom:"24px"},label:{display:"block",fontSize:"14px",color:"#4b5563",marginBottom:"8px"},input:{width:"100%",padding:"8px 12px",fontSize:"14px",border:"1px solid #d1d5db",borderRadius:"6px",color:"#1f2937"},textarea:{width:"100%",padding:"8px 12px",fontSize:"14px",border:"1px solid #d1d5db",borderRadius:"6px",color:"#1f2937",minHeight:"200px",resize:"vertical"},closeButton:{position:"absolute",top:"16px",right:"16px",padding:"4px",color:"#6b7280",cursor:"pointer",background:"none",border:"none","&:hover":{color:"#1f2937"}},footer:{display:"flex",justifyContent:"flex-end",gap:"12px",marginTop:"24px"},cancelButton:{padding:"8px 16px",fontSize:"14px",color:"#6b7280",backgroundColor:"#f3f4f6",border:"none",borderRadius:"6px",cursor:"pointer","&:hover":{backgroundColor:"#e5e7eb"}},saveButton:{padding:"8px 16px",fontSize:"14px",color:"white",backgroundColor:"#2563eb",border:"none",borderRadius:"6px",cursor:"pointer","&:hover":{backgroundColor:"#1d4ed8"}}};function jz({open:t,onClose:e,onSave:n}){const[r,i]=y.useState(""),[o,s]=y.useState(""),a=()=>{n(r,o),i(""),s(""),e()};return h.jsx(Bf,{open:t,onOpenChange:e,children:h.jsxs(zf,{children:[h.jsx(Uf,{style:sn.overlay}),h.jsxs(Vf,{style:sn.content,children:[h.jsx(Hf,{style:sn.title,children:"Create snippet"}),h.jsx("button",{style:sn.closeButton,onClick:e,children:h.jsx(Uc,{})}),h.jsxs("div",{style:sn.field,children:[h.jsx("label",{style:sn.label,children:"Shorthand"}),h.jsx("div",{style:{position:"relative"},children:h.jsx("input",{style:sn.input,type:"text",value:r,onChange:l=>i(l.target.value),placeholder:"Short, memorable trigger for your snippet"})})]}),h.jsxs("div",{style:sn.field,children:[h.jsx("label",{style:sn.label,children:"Content"}),h.jsx("textarea",{style:sn.textarea,value:o,onChange:l=>s(l.target.value),placeholder:"Type or paste your snippet content here..."})]}),h.jsxs("div",{style:sn.footer,children:[h.jsx("button",{style:sn.cancelButton,onClick:e,children:"Cancel"}),h.jsx("button",{style:sn.saveButton,onClick:a,disabled:!r.trim()||!o.trim(),children:"Create Snippet"})]})]})]})})}const gt={...ne,section:{marginBottom:"48px"},description:{fontSize:"14px",color:"#6b7280",marginBottom:"24px"},table:{width:"100%",backgroundColor:"#f3f6f9",borderRadius:"8px",padding:"16px"},tableHeader:{display:"grid",gridTemplateColumns:"1fr 1fr auto",gap:"16px",padding:"8px 16px",color:"#6b7280",fontSize:"14px",fontWeight:"500"},tableRow:{display:"grid",gridTemplateColumns:"1fr 1fr auto",gap:"16px",padding:"8px 16px",alignItems:"center"},addButton:{display:"flex",alignItems:"center",gap:"8px",color:"#6b7280",fontSize:"14px",padding:"8px 16px",cursor:"pointer",border:"none",background:"none","&:hover":{color:"#2563eb"}},iconButton:{padding:"4px",border:"none",background:"none",cursor:"pointer",color:"#6b7280","&:hover":{color:"#ef4444"}},snippetCard:{backgroundColor:"white",borderRadius:"8px",padding:"16px",marginBottom:"16px",border:"1px solid #e5e7eb"},snippetHeader:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},snippetCommand:{fontSize:"14px",fontWeight:"500",color:"#1f2937"},snippetText:{fontSize:"14px",color:"#6b7280"}};function oR(){const[t,e]=y.useState([{command:"/test",text:"Tests are not covered under your insurance and may be subject..."}]);return{snippets:t,addSnippet:(i,o)=>{e([...t,{command:`/${i}`,text:o}])},deleteSnippet:i=>{e(t.filter((o,s)=>s!==i))}}}function Lz(){const[t,e]=y.useState([{instead:"Chi",doThis:"Qi"}]),{snippets:n,addSnippet:r,deleteSnippet:i}=oR(),[o,s]=y.useState(!1),a=()=>{e([...t,{instead:"",doThis:""}])},l=u=>{e(t.filter((d,f)=>f!==u))},c=(u,d)=>{r(u,d)};return h.jsxs("div",{style:{height:"100%",overflow:"auto",paddingRight:"16px"},children:[h.jsxs("div",{style:gt.section,children:[h.jsx("h2",{style:ne.sectionTitle,children:"Replace"}),h.jsx("p",{style:gt.description,children:"Specify any abbreviations or alternative spellings of words you use in your notes"}),h.jsxs("div",{style:gt.table,children:[h.jsxs("div",{style:gt.tableHeader,children:[h.jsx("div",{children:"Instead of"}),h.jsx("div",{children:"Do this"}),h.jsx("div",{})]}),t.map((u,d)=>h.jsxs("div",{style:gt.tableRow,children:[h.jsx("input",{style:ne.input,value:u.instead,placeholder:"Type word or phrase"}),h.jsx("input",{style:ne.input,value:u.doThis,placeholder:"Type replacement"}),h.jsx("button",{style:gt.iconButton,onClick:()=>l(d),children:h.jsx(xy,{width:20,height:20})})]},d))]}),h.jsxs("button",{style:gt.addButton,onClick:a,children:[h.jsx(Vc,{width:20,height:20}),"New replacement"]})]}),h.jsxs("div",{style:gt.section,children:[h.jsx("h2",{style:ne.sectionTitle,children:"Snippets"}),h.jsx("p",{style:gt.description,children:"Type / to insert your pre-written text snippets"}),n.map((u,d)=>h.jsxs("div",{style:gt.snippetCard,children:[h.jsxs("div",{style:gt.snippetHeader,children:[h.jsx("div",{style:gt.snippetCommand,children:u.command}),h.jsxs("div",{style:{display:"flex",gap:"8px"},children:[h.jsx("button",{style:gt.iconButton,children:h.jsx(r6,{width:20,height:20})}),h.jsx("button",{style:gt.iconButton,onClick:()=>i(d),children:h.jsx(xy,{width:20,height:20})})]})]}),h.jsx("div",{style:gt.snippetText,children:u.text})]},d)),h.jsxs("button",{style:gt.addButton,onClick:()=>s(!0),children:[h.jsx(Vc,{width:20,height:20}),"New snippet"]})]}),h.jsx(jz,{open:o,onClose:()=>s(!1),onSave:c})]})}const dr={tabsContainer:{display:"flex",gap:"1px",alignItems:"flex-end",height:"44px",flexShrink:0,overflow:"auto hidden",WebkitOverflowScrolling:"touch",borderBottom:"1px solid #e5e7eb",position:"relative",zIndex:10},tab:{padding:"0 12px",backgroundColor:"#f3f4f6",borderTopLeftRadius:"6px",borderTopRightRadius:"6px",borderBottomLeftRadius:"0px",borderBottomRightRadius:"0px",cursor:"pointer",fontWeight:"500",color:"#6b7280",transition:"all 0.15s ease",height:"44px",display:"flex",alignItems:"center",fontSize:"13px",whiteSpace:"nowrap",position:"relative",marginBottom:"-1px","&:hover":{backgroundColor:"#f9fafb"}},activeTab:{backgroundColor:"#ffffff",color:"#111827",zIndex:1,borderLeft:"1px solid rgb(229, 231, 235)",borderRight:"1px solid rgb(229, 231, 235)",borderTop:"1px solid rgb(229, 231, 235)"},generateButton:{display:"flex",alignItems:"center",justifyContent:"center",minWidth:"32px",height:"32px",padding:0,backgroundColor:"#ffffff",border:"1px solid #e5e7eb",borderRadius:"6px",cursor:"pointer",transition:"all 0.15s ease",fontSize:"16px",lineHeight:"1",flexShrink:0,marginLeft:"4px",marginBottom:"4px",boxShadow:"0 1px 2px rgba(0, 0, 0, 0.05)","&:hover":{backgroundColor:"#f9fafb"}}};function $z({activeTab:t,setActiveTab:e,aiContextVersion:n,soapNoteVersion:r,templateNotes:i,onOpenTemplateModal:o}){const a=[...i].sort((l,c)=>{const u=new Date(l.created_at||0),d=new Date(c.created_at||0);return u.getTime()-d.getTime()}).reduce((l,c)=>{const u=l.find(d=>d.template_id===c.template_id);return!u||(u.version_id||0)<(c.version_id||0)?[...l.filter(f=>f.template_id!==c.template_id),c]:l},[]);return console.log("[TranscriptionTabs] Template notes:",a),h.jsxs("div",{style:dr.tabsContainer,className:"tabs-container",children:[h.jsx("button",{style:{...dr.tab,...t==="transcript"?dr.activeTab:{}},onClick:()=>e("transcript"),children:"Transcript"}),n&&h.jsxs("button",{style:{...dr.tab,...t==="ai_context"?dr.activeTab:{}},onClick:()=>e("ai_context"),children:["Context ",n>1?` (v${n})`:""]}),r&&h.jsxs("button",{style:{...dr.tab,...t==="soap"?dr.activeTab:{}},onClick:()=>e("soap"),children:["SOAP Note ",r>1?` (v${r})`:""]}),a.map(l=>{const c=l.metadata;return h.jsxs("button",{style:{...dr.tab,...t===l.template_id?dr.activeTab:{}},onClick:()=>e(l.template_id||""),children:[(c==null?void 0:c.template_name)||"Template Note",l.version_id&&l.version_id>1?` (v${l.version_id})`:""]},l.template_id)}),r&&h.jsx("button",{style:dr.generateButton,onClick:o,title:"Generate from template",children:"+"})]})}function Hh(){const t=Be();return{getValidSessionToken:async()=>{const{data:{session:n},error:r}=await t.auth.getSession();if(r)throw new Error("Failed to get session: "+r.message);if(!(n!=null&&n.access_token)){const{data:{session:i},error:o}=await t.auth.refreshSession();if(o||!(i!=null&&i.access_token))throw new Error("No valid session available");return console.log("[Session] Using refreshed session token"),i.access_token}return console.log("[Session] Using existing session token"),n.access_token}}}function Fz({visitId:t,onSuccess:e}){const[n,r]=y.useState(!1),i=Be(),{getValidSessionToken:o}=Hh();return{generateFromTemplate:async a=>{if(!(!t||n)){r(!0);try{const{data:l,error:c}=await i.from("notes").insert({visit_id:t,content:"Generating note...",type:"template",template_id:a.id,metadata:{template_name:a.name,status:"processing"},user_facing:!0,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}).select("id").single();if(c){console.error("Error creating placeholder note:",c);return}const{data:u,error:d}=await i.from("notes").select("*").eq("visit_id",t).eq("type","template").order("created_at",{ascending:!1});!d&&u&&(e==null||e(a.id,u));const f=await o(),p=await fetch(`${Tr.apiUrl}/generate-from-template`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${f}`},body:JSON.stringify({visitId:t,templateId:a.id,noteId:l.id})});if(!p.ok){const m=await p.json();throw new Error(m.error||"Failed to generate note")}}catch(l){console.error("Error generating template note:",l);const{error:c}=await i.from("notes").upsert({visit_id:t,content:"Failed to generate note. Please try again.",type:"template",user_facing:!0,updated_at:new Date().toISOString(),metadata:{template_id:a.id,template_name:a.name,status:"error"}},{onConflict:"visit_id,type,metadata->template_id"});c&&console.error("Error updating note status:",c)}finally{r(!1)}}},isGenerating:n}}/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bz=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),sR=(...t)=>t.filter((e,n,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===n).join(" ").trim();/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var zz={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uz=y.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:i="",children:o,iconNode:s,...a},l)=>y.createElement("svg",{ref:l,...zz,width:e,height:e,stroke:t,strokeWidth:r?Number(n)*24/Number(e):n,className:sR("lucide",i),...a},[...s.map(([c,u])=>y.createElement(c,u)),...Array.isArray(o)?o:[o]]));/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ft=(t,e)=>{const n=y.forwardRef(({className:r,...i},o)=>y.createElement(Uz,{ref:o,iconNode:e,className:sR(`lucide-${Bz(t)}`,r),...i}));return n.displayName=`${t}`,n};/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vz=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],aR=Ft("ChevronDown",Vz);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hz=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],Wz=Ft("ChevronRight",Hz);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kz=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],qz=Ft("CircleAlert",Kz);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gz=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],Jz=Ft("CircleCheck",Gz);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yz=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],Qz=Ft("Copy",Yz);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xz=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]],Zz=Ft("Ellipsis",Xz);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e8=[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]],Wf=Ft("Mic",e8);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t8=[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]],n8=Ft("Pause",t8);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r8=[["path",{d:"M21 7v6h-6",key:"3ptur4"}],["path",{d:"M3 17a9 9 0 0 1 9-9 9 9 0 0 1 6 2.3l3 2.7",key:"1kgawr"}]],i8=Ft("Redo",r8);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o8=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],lR=Ft("RefreshCw",o8);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s8=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],a8=Ft("Save",s8);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l8=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],c8=Ft("Square",l8);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u8=[["path",{d:"M3 7v6h6",key:"1v2h90"}],["path",{d:"M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13",key:"1r6uu6"}]],d8=Ft("Undo",u8);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f8=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]],h8=Ft("Upload",f8);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p8=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],m8=Ft("X",p8);function L0(t){const e=t+"CollectionProvider",[n,r]=yo(e),[i,o]=n(e,{collectionRef:{current:null},itemMap:new Map}),s=p=>{const{scope:m,children:g}=p,v=ve.useRef(null),x=ve.useRef(new Map).current;return h.jsx(i,{scope:m,itemMap:x,collectionRef:v,children:g})};s.displayName=e;const a=t+"CollectionSlot",l=ve.forwardRef((p,m)=>{const{scope:g,children:v}=p,x=o(a,g),w=He(m,x.collectionRef);return h.jsx(vs,{ref:w,children:v})});l.displayName=a;const c=t+"CollectionItemSlot",u="data-radix-collection-item",d=ve.forwardRef((p,m)=>{const{scope:g,children:v,...x}=p,w=ve.useRef(null),S=He(m,w),b=o(c,g);return ve.useEffect(()=>(b.itemMap.set(w,{ref:w,...x}),()=>void b.itemMap.delete(w))),h.jsx(vs,{[u]:"",ref:S,children:v})});d.displayName=c;function f(p){const m=o(t+"CollectionConsumer",p);return ve.useCallback(()=>{const v=m.collectionRef.current;if(!v)return[];const x=Array.from(v.querySelectorAll(`[${u}]`));return Array.from(m.itemMap.values()).sort((b,C)=>x.indexOf(b.ref.current)-x.indexOf(C.ref.current))},[m.collectionRef,m.itemMap])}return[{Provider:s,Slot:l,ItemSlot:d},f,r]}var g8=y.createContext(void 0);function cR(t){const e=y.useContext(g8);return t||e||"ltr"}const y8=["top","right","bottom","left"],io=Math.min,dn=Math.max,Kf=Math.round,wd=Math.floor,Er=t=>({x:t,y:t}),v8={left:"right",right:"left",bottom:"top",top:"bottom"},x8={start:"end",end:"start"};function ky(t,e,n){return dn(t,io(e,n))}function ti(t,e){return typeof t=="function"?t(e):t}function ni(t){return t.split("-")[0]}function gl(t){return t.split("-")[1]}function $0(t){return t==="x"?"y":"x"}function F0(t){return t==="y"?"height":"width"}function oo(t){return["top","bottom"].includes(ni(t))?"y":"x"}function B0(t){return $0(oo(t))}function w8(t,e,n){n===void 0&&(n=!1);const r=gl(t),i=B0(t),o=F0(i);let s=i==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return e.reference[o]>e.floating[o]&&(s=qf(s)),[s,qf(s)]}function b8(t){const e=qf(t);return[Ey(t),e,Ey(e)]}function Ey(t){return t.replace(/start|end/g,e=>x8[e])}function S8(t,e,n){const r=["left","right"],i=["right","left"],o=["top","bottom"],s=["bottom","top"];switch(t){case"top":case"bottom":return n?e?i:r:e?r:i;case"left":case"right":return e?o:s;default:return[]}}function C8(t,e,n,r){const i=gl(t);let o=S8(ni(t),n==="start",r);return i&&(o=o.map(s=>s+"-"+i),e&&(o=o.concat(o.map(Ey)))),o}function qf(t){return t.replace(/left|right|bottom|top/g,e=>v8[e])}function k8(t){return{top:0,right:0,bottom:0,left:0,...t}}function uR(t){return typeof t!="number"?k8(t):{top:t,right:t,bottom:t,left:t}}function Gf(t){const{x:e,y:n,width:r,height:i}=t;return{width:r,height:i,top:n,left:e,right:e+r,bottom:n+i,x:e,y:n}}function F1(t,e,n){let{reference:r,floating:i}=t;const o=oo(e),s=B0(e),a=F0(s),l=ni(e),c=o==="y",u=r.x+r.width/2-i.width/2,d=r.y+r.height/2-i.height/2,f=r[a]/2-i[a]/2;let p;switch(l){case"top":p={x:u,y:r.y-i.height};break;case"bottom":p={x:u,y:r.y+r.height};break;case"right":p={x:r.x+r.width,y:d};break;case"left":p={x:r.x-i.width,y:d};break;default:p={x:r.x,y:r.y}}switch(gl(e)){case"start":p[s]-=f*(n&&c?-1:1);break;case"end":p[s]+=f*(n&&c?-1:1);break}return p}const E8=async(t,e,n)=>{const{placement:r="bottom",strategy:i="absolute",middleware:o=[],platform:s}=n,a=o.filter(Boolean),l=await(s.isRTL==null?void 0:s.isRTL(e));let c=await s.getElementRects({reference:t,floating:e,strategy:i}),{x:u,y:d}=F1(c,r,l),f=r,p={},m=0;for(let g=0;g<a.length;g++){const{name:v,fn:x}=a[g],{x:w,y:S,data:b,reset:C}=await x({x:u,y:d,initialPlacement:r,placement:f,strategy:i,middlewareData:p,rects:c,platform:s,elements:{reference:t,floating:e}});u=w??u,d=S??d,p={...p,[v]:{...p[v],...b}},C&&m<=50&&(m++,typeof C=="object"&&(C.placement&&(f=C.placement),C.rects&&(c=C.rects===!0?await s.getElementRects({reference:t,floating:e,strategy:i}):C.rects),{x:u,y:d}=F1(c,f,l)),g=-1)}return{x:u,y:d,placement:f,strategy:i,middlewareData:p}};async function Hc(t,e){var n;e===void 0&&(e={});const{x:r,y:i,platform:o,rects:s,elements:a,strategy:l}=t,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:d="floating",altBoundary:f=!1,padding:p=0}=ti(e,t),m=uR(p),v=a[f?d==="floating"?"reference":"floating":d],x=Gf(await o.getClippingRect({element:(n=await(o.isElement==null?void 0:o.isElement(v)))==null||n?v:v.contextElement||await(o.getDocumentElement==null?void 0:o.getDocumentElement(a.floating)),boundary:c,rootBoundary:u,strategy:l})),w=d==="floating"?{x:r,y:i,width:s.floating.width,height:s.floating.height}:s.reference,S=await(o.getOffsetParent==null?void 0:o.getOffsetParent(a.floating)),b=await(o.isElement==null?void 0:o.isElement(S))?await(o.getScale==null?void 0:o.getScale(S))||{x:1,y:1}:{x:1,y:1},C=Gf(o.convertOffsetParentRelativeRectToViewportRelativeRect?await o.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:w,offsetParent:S,strategy:l}):w);return{top:(x.top-C.top+m.top)/b.y,bottom:(C.bottom-x.bottom+m.bottom)/b.y,left:(x.left-C.left+m.left)/b.x,right:(C.right-x.right+m.right)/b.x}}const T8=t=>({name:"arrow",options:t,async fn(e){const{x:n,y:r,placement:i,rects:o,platform:s,elements:a,middlewareData:l}=e,{element:c,padding:u=0}=ti(t,e)||{};if(c==null)return{};const d=uR(u),f={x:n,y:r},p=B0(i),m=F0(p),g=await s.getDimensions(c),v=p==="y",x=v?"top":"left",w=v?"bottom":"right",S=v?"clientHeight":"clientWidth",b=o.reference[m]+o.reference[p]-f[p]-o.floating[m],C=f[p]-o.reference[p],k=await(s.getOffsetParent==null?void 0:s.getOffsetParent(c));let E=k?k[S]:0;(!E||!await(s.isElement==null?void 0:s.isElement(k)))&&(E=a.floating[S]||o.floating[m]);const T=b/2-C/2,O=E/2-g[m]/2-1,R=io(d[x],O),I=io(d[w],O),$=R,P=E-g[m]-I,M=E/2-g[m]/2+T,z=ky($,M,P),B=!l.arrow&&gl(i)!=null&&M!==z&&o.reference[m]/2-(M<$?R:I)-g[m]/2<0,H=B?M<$?M-$:M-P:0;return{[p]:f[p]+H,data:{[p]:z,centerOffset:M-z-H,...B&&{alignmentOffset:H}},reset:B}}}),_8=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var n,r;const{placement:i,middlewareData:o,rects:s,initialPlacement:a,platform:l,elements:c}=e,{mainAxis:u=!0,crossAxis:d=!0,fallbackPlacements:f,fallbackStrategy:p="bestFit",fallbackAxisSideDirection:m="none",flipAlignment:g=!0,...v}=ti(t,e);if((n=o.arrow)!=null&&n.alignmentOffset)return{};const x=ni(i),w=oo(a),S=ni(a)===a,b=await(l.isRTL==null?void 0:l.isRTL(c.floating)),C=f||(S||!g?[qf(a)]:b8(a)),k=m!=="none";!f&&k&&C.push(...C8(a,g,m,b));const E=[a,...C],T=await Hc(e,v),O=[];let R=((r=o.flip)==null?void 0:r.overflows)||[];if(u&&O.push(T[x]),d){const M=w8(i,s,b);O.push(T[M[0]],T[M[1]])}if(R=[...R,{placement:i,overflows:O}],!O.every(M=>M<=0)){var I,$;const M=(((I=o.flip)==null?void 0:I.index)||0)+1,z=E[M];if(z)return{data:{index:M,overflows:R},reset:{placement:z}};let B=($=R.filter(H=>H.overflows[0]<=0).sort((H,A)=>H.overflows[1]-A.overflows[1])[0])==null?void 0:$.placement;if(!B)switch(p){case"bestFit":{var P;const H=(P=R.filter(A=>{if(k){const D=oo(A.placement);return D===w||D==="y"}return!0}).map(A=>[A.placement,A.overflows.filter(D=>D>0).reduce((D,L)=>D+L,0)]).sort((A,D)=>A[1]-D[1])[0])==null?void 0:P[0];H&&(B=H);break}case"initialPlacement":B=a;break}if(i!==B)return{reset:{placement:B}}}return{}}}};function B1(t,e){return{top:t.top-e.height,right:t.right-e.width,bottom:t.bottom-e.height,left:t.left-e.width}}function z1(t){return y8.some(e=>t[e]>=0)}const R8=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(e){const{rects:n}=e,{strategy:r="referenceHidden",...i}=ti(t,e);switch(r){case"referenceHidden":{const o=await Hc(e,{...i,elementContext:"reference"}),s=B1(o,n.reference);return{data:{referenceHiddenOffsets:s,referenceHidden:z1(s)}}}case"escaped":{const o=await Hc(e,{...i,altBoundary:!0}),s=B1(o,n.floating);return{data:{escapedOffsets:s,escaped:z1(s)}}}default:return{}}}}};async function O8(t,e){const{placement:n,platform:r,elements:i}=t,o=await(r.isRTL==null?void 0:r.isRTL(i.floating)),s=ni(n),a=gl(n),l=oo(n)==="y",c=["left","top"].includes(s)?-1:1,u=o&&l?-1:1,d=ti(e,t);let{mainAxis:f,crossAxis:p,alignmentAxis:m}=typeof d=="number"?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:d.mainAxis||0,crossAxis:d.crossAxis||0,alignmentAxis:d.alignmentAxis};return a&&typeof m=="number"&&(p=a==="end"?m*-1:m),l?{x:p*u,y:f*c}:{x:f*c,y:p*u}}const P8=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var n,r;const{x:i,y:o,placement:s,middlewareData:a}=e,l=await O8(e,t);return s===((n=a.offset)==null?void 0:n.placement)&&(r=a.arrow)!=null&&r.alignmentOffset?{}:{x:i+l.x,y:o+l.y,data:{...l,placement:s}}}}},M8=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:n,y:r,placement:i}=e,{mainAxis:o=!0,crossAxis:s=!1,limiter:a={fn:v=>{let{x,y:w}=v;return{x,y:w}}},...l}=ti(t,e),c={x:n,y:r},u=await Hc(e,l),d=oo(ni(i)),f=$0(d);let p=c[f],m=c[d];if(o){const v=f==="y"?"top":"left",x=f==="y"?"bottom":"right",w=p+u[v],S=p-u[x];p=ky(w,p,S)}if(s){const v=d==="y"?"top":"left",x=d==="y"?"bottom":"right",w=m+u[v],S=m-u[x];m=ky(w,m,S)}const g=a.fn({...e,[f]:p,[d]:m});return{...g,data:{x:g.x-n,y:g.y-r,enabled:{[f]:o,[d]:s}}}}}},A8=function(t){return t===void 0&&(t={}),{options:t,fn(e){const{x:n,y:r,placement:i,rects:o,middlewareData:s}=e,{offset:a=0,mainAxis:l=!0,crossAxis:c=!0}=ti(t,e),u={x:n,y:r},d=oo(i),f=$0(d);let p=u[f],m=u[d];const g=ti(a,e),v=typeof g=="number"?{mainAxis:g,crossAxis:0}:{mainAxis:0,crossAxis:0,...g};if(l){const S=f==="y"?"height":"width",b=o.reference[f]-o.floating[S]+v.mainAxis,C=o.reference[f]+o.reference[S]-v.mainAxis;p<b?p=b:p>C&&(p=C)}if(c){var x,w;const S=f==="y"?"width":"height",b=["top","left"].includes(ni(i)),C=o.reference[d]-o.floating[S]+(b&&((x=s.offset)==null?void 0:x[d])||0)+(b?0:v.crossAxis),k=o.reference[d]+o.reference[S]+(b?0:((w=s.offset)==null?void 0:w[d])||0)-(b?v.crossAxis:0);m<C?m=C:m>k&&(m=k)}return{[f]:p,[d]:m}}}},D8=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(e){var n,r;const{placement:i,rects:o,platform:s,elements:a}=e,{apply:l=()=>{},...c}=ti(t,e),u=await Hc(e,c),d=ni(i),f=gl(i),p=oo(i)==="y",{width:m,height:g}=o.floating;let v,x;d==="top"||d==="bottom"?(v=d,x=f===(await(s.isRTL==null?void 0:s.isRTL(a.floating))?"start":"end")?"left":"right"):(x=d,v=f==="end"?"top":"bottom");const w=g-u.top-u.bottom,S=m-u.left-u.right,b=io(g-u[v],w),C=io(m-u[x],S),k=!e.middlewareData.shift;let E=b,T=C;if((n=e.middlewareData.shift)!=null&&n.enabled.x&&(T=S),(r=e.middlewareData.shift)!=null&&r.enabled.y&&(E=w),k&&!f){const R=dn(u.left,0),I=dn(u.right,0),$=dn(u.top,0),P=dn(u.bottom,0);p?T=m-2*(R!==0||I!==0?R+I:dn(u.left,u.right)):E=g-2*($!==0||P!==0?$+P:dn(u.top,u.bottom))}await l({...e,availableWidth:T,availableHeight:E});const O=await s.getDimensions(a.floating);return m!==O.width||g!==O.height?{reset:{rects:!0}}:{}}}};function Wh(){return typeof window<"u"}function yl(t){return dR(t)?(t.nodeName||"").toLowerCase():"#document"}function gn(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function Mr(t){var e;return(e=(dR(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function dR(t){return Wh()?t instanceof Node||t instanceof gn(t).Node:!1}function rr(t){return Wh()?t instanceof Element||t instanceof gn(t).Element:!1}function Pr(t){return Wh()?t instanceof HTMLElement||t instanceof gn(t).HTMLElement:!1}function U1(t){return!Wh()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof gn(t).ShadowRoot}function Eu(t){const{overflow:e,overflowX:n,overflowY:r,display:i}=ir(t);return/auto|scroll|overlay|hidden|clip/.test(e+r+n)&&!["inline","contents"].includes(i)}function I8(t){return["table","td","th"].includes(yl(t))}function Kh(t){return[":popover-open",":modal"].some(e=>{try{return t.matches(e)}catch{return!1}})}function z0(t){const e=U0(),n=rr(t)?ir(t):t;return["transform","translate","scale","rotate","perspective"].some(r=>n[r]?n[r]!=="none":!1)||(n.containerType?n.containerType!=="normal":!1)||!e&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!e&&(n.filter?n.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(r=>(n.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(n.contain||"").includes(r))}function N8(t){let e=so(t);for(;Pr(e)&&!el(e);){if(z0(e))return e;if(Kh(e))return null;e=so(e)}return null}function U0(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function el(t){return["html","body","#document"].includes(yl(t))}function ir(t){return gn(t).getComputedStyle(t)}function qh(t){return rr(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function so(t){if(yl(t)==="html")return t;const e=t.assignedSlot||t.parentNode||U1(t)&&t.host||Mr(t);return U1(e)?e.host:e}function fR(t){const e=so(t);return el(e)?t.ownerDocument?t.ownerDocument.body:t.body:Pr(e)&&Eu(e)?e:fR(e)}function Wc(t,e,n){var r;e===void 0&&(e=[]),n===void 0&&(n=!0);const i=fR(t),o=i===((r=t.ownerDocument)==null?void 0:r.body),s=gn(i);if(o){const a=Ty(s);return e.concat(s,s.visualViewport||[],Eu(i)?i:[],a&&n?Wc(a):[])}return e.concat(i,Wc(i,[],n))}function Ty(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function hR(t){const e=ir(t);let n=parseFloat(e.width)||0,r=parseFloat(e.height)||0;const i=Pr(t),o=i?t.offsetWidth:n,s=i?t.offsetHeight:r,a=Kf(n)!==o||Kf(r)!==s;return a&&(n=o,r=s),{width:n,height:r,$:a}}function V0(t){return rr(t)?t:t.contextElement}function wa(t){const e=V0(t);if(!Pr(e))return Er(1);const n=e.getBoundingClientRect(),{width:r,height:i,$:o}=hR(e);let s=(o?Kf(n.width):n.width)/r,a=(o?Kf(n.height):n.height)/i;return(!s||!Number.isFinite(s))&&(s=1),(!a||!Number.isFinite(a))&&(a=1),{x:s,y:a}}const j8=Er(0);function pR(t){const e=gn(t);return!U0()||!e.visualViewport?j8:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function L8(t,e,n){return e===void 0&&(e=!1),!n||e&&n!==gn(t)?!1:e}function ws(t,e,n,r){e===void 0&&(e=!1),n===void 0&&(n=!1);const i=t.getBoundingClientRect(),o=V0(t);let s=Er(1);e&&(r?rr(r)&&(s=wa(r)):s=wa(t));const a=L8(o,n,r)?pR(o):Er(0);let l=(i.left+a.x)/s.x,c=(i.top+a.y)/s.y,u=i.width/s.x,d=i.height/s.y;if(o){const f=gn(o),p=r&&rr(r)?gn(r):r;let m=f,g=Ty(m);for(;g&&r&&p!==m;){const v=wa(g),x=g.getBoundingClientRect(),w=ir(g),S=x.left+(g.clientLeft+parseFloat(w.paddingLeft))*v.x,b=x.top+(g.clientTop+parseFloat(w.paddingTop))*v.y;l*=v.x,c*=v.y,u*=v.x,d*=v.y,l+=S,c+=b,m=gn(g),g=Ty(m)}}return Gf({width:u,height:d,x:l,y:c})}function H0(t,e){const n=qh(t).scrollLeft;return e?e.left+n:ws(Mr(t)).left+n}function mR(t,e,n){n===void 0&&(n=!1);const r=t.getBoundingClientRect(),i=r.left+e.scrollLeft-(n?0:H0(t,r)),o=r.top+e.scrollTop;return{x:i,y:o}}function $8(t){let{elements:e,rect:n,offsetParent:r,strategy:i}=t;const o=i==="fixed",s=Mr(r),a=e?Kh(e.floating):!1;if(r===s||a&&o)return n;let l={scrollLeft:0,scrollTop:0},c=Er(1);const u=Er(0),d=Pr(r);if((d||!d&&!o)&&((yl(r)!=="body"||Eu(s))&&(l=qh(r)),Pr(r))){const p=ws(r);c=wa(r),u.x=p.x+r.clientLeft,u.y=p.y+r.clientTop}const f=s&&!d&&!o?mR(s,l,!0):Er(0);return{width:n.width*c.x,height:n.height*c.y,x:n.x*c.x-l.scrollLeft*c.x+u.x+f.x,y:n.y*c.y-l.scrollTop*c.y+u.y+f.y}}function F8(t){return Array.from(t.getClientRects())}function B8(t){const e=Mr(t),n=qh(t),r=t.ownerDocument.body,i=dn(e.scrollWidth,e.clientWidth,r.scrollWidth,r.clientWidth),o=dn(e.scrollHeight,e.clientHeight,r.scrollHeight,r.clientHeight);let s=-n.scrollLeft+H0(t);const a=-n.scrollTop;return ir(r).direction==="rtl"&&(s+=dn(e.clientWidth,r.clientWidth)-i),{width:i,height:o,x:s,y:a}}function z8(t,e){const n=gn(t),r=Mr(t),i=n.visualViewport;let o=r.clientWidth,s=r.clientHeight,a=0,l=0;if(i){o=i.width,s=i.height;const c=U0();(!c||c&&e==="fixed")&&(a=i.offsetLeft,l=i.offsetTop)}return{width:o,height:s,x:a,y:l}}function U8(t,e){const n=ws(t,!0,e==="fixed"),r=n.top+t.clientTop,i=n.left+t.clientLeft,o=Pr(t)?wa(t):Er(1),s=t.clientWidth*o.x,a=t.clientHeight*o.y,l=i*o.x,c=r*o.y;return{width:s,height:a,x:l,y:c}}function V1(t,e,n){let r;if(e==="viewport")r=z8(t,n);else if(e==="document")r=B8(Mr(t));else if(rr(e))r=U8(e,n);else{const i=pR(t);r={x:e.x-i.x,y:e.y-i.y,width:e.width,height:e.height}}return Gf(r)}function gR(t,e){const n=so(t);return n===e||!rr(n)||el(n)?!1:ir(n).position==="fixed"||gR(n,e)}function V8(t,e){const n=e.get(t);if(n)return n;let r=Wc(t,[],!1).filter(a=>rr(a)&&yl(a)!=="body"),i=null;const o=ir(t).position==="fixed";let s=o?so(t):t;for(;rr(s)&&!el(s);){const a=ir(s),l=z0(s);!l&&a.position==="fixed"&&(i=null),(o?!l&&!i:!l&&a.position==="static"&&!!i&&["absolute","fixed"].includes(i.position)||Eu(s)&&!l&&gR(t,s))?r=r.filter(u=>u!==s):i=a,s=so(s)}return e.set(t,r),r}function H8(t){let{element:e,boundary:n,rootBoundary:r,strategy:i}=t;const s=[...n==="clippingAncestors"?Kh(e)?[]:V8(e,this._c):[].concat(n),r],a=s[0],l=s.reduce((c,u)=>{const d=V1(e,u,i);return c.top=dn(d.top,c.top),c.right=io(d.right,c.right),c.bottom=io(d.bottom,c.bottom),c.left=dn(d.left,c.left),c},V1(e,a,i));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function W8(t){const{width:e,height:n}=hR(t);return{width:e,height:n}}function K8(t,e,n){const r=Pr(e),i=Mr(e),o=n==="fixed",s=ws(t,!0,o,e);let a={scrollLeft:0,scrollTop:0};const l=Er(0);if(r||!r&&!o)if((yl(e)!=="body"||Eu(i))&&(a=qh(e)),r){const f=ws(e,!0,o,e);l.x=f.x+e.clientLeft,l.y=f.y+e.clientTop}else i&&(l.x=H0(i));const c=i&&!r&&!o?mR(i,a):Er(0),u=s.left+a.scrollLeft-l.x-c.x,d=s.top+a.scrollTop-l.y-c.y;return{x:u,y:d,width:s.width,height:s.height}}function xm(t){return ir(t).position==="static"}function H1(t,e){if(!Pr(t)||ir(t).position==="fixed")return null;if(e)return e(t);let n=t.offsetParent;return Mr(t)===n&&(n=n.ownerDocument.body),n}function yR(t,e){const n=gn(t);if(Kh(t))return n;if(!Pr(t)){let i=so(t);for(;i&&!el(i);){if(rr(i)&&!xm(i))return i;i=so(i)}return n}let r=H1(t,e);for(;r&&I8(r)&&xm(r);)r=H1(r,e);return r&&el(r)&&xm(r)&&!z0(r)?n:r||N8(t)||n}const q8=async function(t){const e=this.getOffsetParent||yR,n=this.getDimensions,r=await n(t.floating);return{reference:K8(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function G8(t){return ir(t).direction==="rtl"}const J8={convertOffsetParentRelativeRectToViewportRelativeRect:$8,getDocumentElement:Mr,getClippingRect:H8,getOffsetParent:yR,getElementRects:q8,getClientRects:F8,getDimensions:W8,getScale:wa,isElement:rr,isRTL:G8};function vR(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height}function Y8(t,e){let n=null,r;const i=Mr(t);function o(){var a;clearTimeout(r),(a=n)==null||a.disconnect(),n=null}function s(a,l){a===void 0&&(a=!1),l===void 0&&(l=1),o();const c=t.getBoundingClientRect(),{left:u,top:d,width:f,height:p}=c;if(a||e(),!f||!p)return;const m=wd(d),g=wd(i.clientWidth-(u+f)),v=wd(i.clientHeight-(d+p)),x=wd(u),S={rootMargin:-m+"px "+-g+"px "+-v+"px "+-x+"px",threshold:dn(0,io(1,l))||1};let b=!0;function C(k){const E=k[0].intersectionRatio;if(E!==l){if(!b)return s();E?s(!1,E):r=setTimeout(()=>{s(!1,1e-7)},1e3)}E===1&&!vR(c,t.getBoundingClientRect())&&s(),b=!1}try{n=new IntersectionObserver(C,{...S,root:i.ownerDocument})}catch{n=new IntersectionObserver(C,S)}n.observe(t)}return s(!0),o}function Q8(t,e,n,r){r===void 0&&(r={});const{ancestorScroll:i=!0,ancestorResize:o=!0,elementResize:s=typeof ResizeObserver=="function",layoutShift:a=typeof IntersectionObserver=="function",animationFrame:l=!1}=r,c=V0(t),u=i||o?[...c?Wc(c):[],...Wc(e)]:[];u.forEach(x=>{i&&x.addEventListener("scroll",n,{passive:!0}),o&&x.addEventListener("resize",n)});const d=c&&a?Y8(c,n):null;let f=-1,p=null;s&&(p=new ResizeObserver(x=>{let[w]=x;w&&w.target===c&&p&&(p.unobserve(e),cancelAnimationFrame(f),f=requestAnimationFrame(()=>{var S;(S=p)==null||S.observe(e)})),n()}),c&&!l&&p.observe(c),p.observe(e));let m,g=l?ws(t):null;l&&v();function v(){const x=ws(t);g&&!vR(g,x)&&n(),g=x,m=requestAnimationFrame(v)}return n(),()=>{var x;u.forEach(w=>{i&&w.removeEventListener("scroll",n),o&&w.removeEventListener("resize",n)}),d==null||d(),(x=p)==null||x.disconnect(),p=null,l&&cancelAnimationFrame(m)}}const X8=P8,Z8=M8,eU=_8,tU=D8,nU=R8,W1=T8,rU=A8,iU=(t,e,n)=>{const r=new Map,i={platform:J8,...n},o={...i.platform,_c:r};return E8(t,e,{...i,platform:o})};var Kd=typeof document<"u"?y.useLayoutEffect:y.useEffect;function Jf(t,e){if(t===e)return!0;if(typeof t!=typeof e)return!1;if(typeof t=="function"&&t.toString()===e.toString())return!0;let n,r,i;if(t&&e&&typeof t=="object"){if(Array.isArray(t)){if(n=t.length,n!==e.length)return!1;for(r=n;r--!==0;)if(!Jf(t[r],e[r]))return!1;return!0}if(i=Object.keys(t),n=i.length,n!==Object.keys(e).length)return!1;for(r=n;r--!==0;)if(!{}.hasOwnProperty.call(e,i[r]))return!1;for(r=n;r--!==0;){const o=i[r];if(!(o==="_owner"&&t.$$typeof)&&!Jf(t[o],e[o]))return!1}return!0}return t!==t&&e!==e}function xR(t){return typeof window>"u"?1:(t.ownerDocument.defaultView||window).devicePixelRatio||1}function K1(t,e){const n=xR(t);return Math.round(e*n)/n}function wm(t){const e=y.useRef(t);return Kd(()=>{e.current=t}),e}function oU(t){t===void 0&&(t={});const{placement:e="bottom",strategy:n="absolute",middleware:r=[],platform:i,elements:{reference:o,floating:s}={},transform:a=!0,whileElementsMounted:l,open:c}=t,[u,d]=y.useState({x:0,y:0,strategy:n,placement:e,middlewareData:{},isPositioned:!1}),[f,p]=y.useState(r);Jf(f,r)||p(r);const[m,g]=y.useState(null),[v,x]=y.useState(null),w=y.useCallback(A=>{A!==k.current&&(k.current=A,g(A))},[]),S=y.useCallback(A=>{A!==E.current&&(E.current=A,x(A))},[]),b=o||m,C=s||v,k=y.useRef(null),E=y.useRef(null),T=y.useRef(u),O=l!=null,R=wm(l),I=wm(i),$=wm(c),P=y.useCallback(()=>{if(!k.current||!E.current)return;const A={placement:e,strategy:n,middleware:f};I.current&&(A.platform=I.current),iU(k.current,E.current,A).then(D=>{const L={...D,isPositioned:$.current!==!1};M.current&&!Jf(T.current,L)&&(T.current=L,du.flushSync(()=>{d(L)}))})},[f,e,n,I,$]);Kd(()=>{c===!1&&T.current.isPositioned&&(T.current.isPositioned=!1,d(A=>({...A,isPositioned:!1})))},[c]);const M=y.useRef(!1);Kd(()=>(M.current=!0,()=>{M.current=!1}),[]),Kd(()=>{if(b&&(k.current=b),C&&(E.current=C),b&&C){if(R.current)return R.current(b,C,P);P()}},[b,C,P,R,O]);const z=y.useMemo(()=>({reference:k,floating:E,setReference:w,setFloating:S}),[w,S]),B=y.useMemo(()=>({reference:b,floating:C}),[b,C]),H=y.useMemo(()=>{const A={position:n,left:0,top:0};if(!B.floating)return A;const D=K1(B.floating,u.x),L=K1(B.floating,u.y);return a?{...A,transform:"translate("+D+"px, "+L+"px)",...xR(B.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:D,top:L}},[n,a,B.floating,u.x,u.y]);return y.useMemo(()=>({...u,update:P,refs:z,elements:B,floatingStyles:H}),[u,P,z,B,H])}const sU=t=>{function e(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:t,fn(n){const{element:r,padding:i}=typeof t=="function"?t(n):t;return r&&e(r)?r.current!=null?W1({element:r.current,padding:i}).fn(n):{}:r?W1({element:r,padding:i}).fn(n):{}}}},aU=(t,e)=>({...X8(t),options:[t,e]}),lU=(t,e)=>({...Z8(t),options:[t,e]}),cU=(t,e)=>({...rU(t),options:[t,e]}),uU=(t,e)=>({...eU(t),options:[t,e]}),dU=(t,e)=>({...tU(t),options:[t,e]}),fU=(t,e)=>({...nU(t),options:[t,e]}),hU=(t,e)=>({...sU(t),options:[t,e]});var pU="Arrow",wR=y.forwardRef((t,e)=>{const{children:n,width:r=10,height:i=5,...o}=t;return h.jsx(ge.svg,{...o,ref:e,width:r,height:i,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:t.asChild?n:h.jsx("polygon",{points:"0,0 30,0 15,10"})})});wR.displayName=pU;var mU=wR;function gU(t){const[e,n]=y.useState(void 0);return ro(()=>{if(t){n({width:t.offsetWidth,height:t.offsetHeight});const r=new ResizeObserver(i=>{if(!Array.isArray(i)||!i.length)return;const o=i[0];let s,a;if("borderBoxSize"in o){const l=o.borderBoxSize,c=Array.isArray(l)?l[0]:l;s=c.inlineSize,a=c.blockSize}else s=t.offsetWidth,a=t.offsetHeight;n({width:s,height:a})});return r.observe(t,{box:"border-box"}),()=>r.unobserve(t)}else n(void 0)},[t]),e}var W0="Popper",[bR,Gh]=yo(W0),[yU,SR]=bR(W0),CR=t=>{const{__scopePopper:e,children:n}=t,[r,i]=y.useState(null);return h.jsx(yU,{scope:e,anchor:r,onAnchorChange:i,children:n})};CR.displayName=W0;var kR="PopperAnchor",ER=y.forwardRef((t,e)=>{const{__scopePopper:n,virtualRef:r,...i}=t,o=SR(kR,n),s=y.useRef(null),a=He(e,s);return y.useEffect(()=>{o.onAnchorChange((r==null?void 0:r.current)||s.current)}),r?null:h.jsx(ge.div,{...i,ref:a})});ER.displayName=kR;var K0="PopperContent",[vU,xU]=bR(K0),TR=y.forwardRef((t,e)=>{var ze,kt,qe,Ut,Ar,xo;const{__scopePopper:n,side:r="bottom",sideOffset:i=0,align:o="center",alignOffset:s=0,arrowPadding:a=0,avoidCollisions:l=!0,collisionBoundary:c=[],collisionPadding:u=0,sticky:d="partial",hideWhenDetached:f=!1,updatePositionStrategy:p="optimized",onPlaced:m,...g}=t,v=SR(K0,n),[x,w]=y.useState(null),S=He(e,Vn=>w(Vn)),[b,C]=y.useState(null),k=gU(b),E=(k==null?void 0:k.width)??0,T=(k==null?void 0:k.height)??0,O=r+(o!=="center"?"-"+o:""),R=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},I=Array.isArray(c)?c:[c],$=I.length>0,P={padding:R,boundary:I.filter(bU),altBoundary:$},{refs:M,floatingStyles:z,placement:B,isPositioned:H,middlewareData:A}=oU({strategy:"fixed",placement:O,whileElementsMounted:(...Vn)=>Q8(...Vn,{animationFrame:p==="always"}),elements:{reference:v.anchor},middleware:[aU({mainAxis:i+T,alignmentAxis:s}),l&&lU({mainAxis:!0,crossAxis:!1,limiter:d==="partial"?cU():void 0,...P}),l&&uU({...P}),dU({...P,apply:({elements:Vn,rects:wo,availableWidth:Rs,availableHeight:bo})=>{const{width:So,height:Os}=wo.reference,Dr=Vn.floating.style;Dr.setProperty("--radix-popper-available-width",`${Rs}px`),Dr.setProperty("--radix-popper-available-height",`${bo}px`),Dr.setProperty("--radix-popper-anchor-width",`${So}px`),Dr.setProperty("--radix-popper-anchor-height",`${Os}px`)}}),b&&hU({element:b,padding:a}),SU({arrowWidth:E,arrowHeight:T}),f&&fU({strategy:"referenceHidden",...P})]}),[D,L]=OR(B),Y=jt(m);ro(()=>{H&&(Y==null||Y())},[H,Y]);const ee=(ze=A.arrow)==null?void 0:ze.x,G=(kt=A.arrow)==null?void 0:kt.y,Z=((qe=A.arrow)==null?void 0:qe.centerOffset)!==0,[xe,we]=y.useState();return ro(()=>{x&&we(window.getComputedStyle(x).zIndex)},[x]),h.jsx("div",{ref:M.setFloating,"data-radix-popper-content-wrapper":"",style:{...z,transform:H?z.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:xe,"--radix-popper-transform-origin":[(Ut=A.transformOrigin)==null?void 0:Ut.x,(Ar=A.transformOrigin)==null?void 0:Ar.y].join(" "),...((xo=A.hide)==null?void 0:xo.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:t.dir,children:h.jsx(vU,{scope:n,placedSide:D,onArrowChange:C,arrowX:ee,arrowY:G,shouldHideArrow:Z,children:h.jsx(ge.div,{"data-side":D,"data-align":L,...g,ref:S,style:{...g.style,animation:H?void 0:"none"}})})})});TR.displayName=K0;var _R="PopperArrow",wU={top:"bottom",right:"left",bottom:"top",left:"right"},RR=y.forwardRef(function(e,n){const{__scopePopper:r,...i}=e,o=xU(_R,r),s=wU[o.placedSide];return h.jsx("span",{ref:o.onArrowChange,style:{position:"absolute",left:o.arrowX,top:o.arrowY,[s]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[o.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[o.placedSide],visibility:o.shouldHideArrow?"hidden":void 0},children:h.jsx(mU,{...i,ref:n,style:{...i.style,display:"block"}})})});RR.displayName=_R;function bU(t){return t!==null}var SU=t=>({name:"transformOrigin",options:t,fn(e){var v,x,w;const{placement:n,rects:r,middlewareData:i}=e,s=((v=i.arrow)==null?void 0:v.centerOffset)!==0,a=s?0:t.arrowWidth,l=s?0:t.arrowHeight,[c,u]=OR(n),d={start:"0%",center:"50%",end:"100%"}[u],f=(((x=i.arrow)==null?void 0:x.x)??0)+a/2,p=(((w=i.arrow)==null?void 0:w.y)??0)+l/2;let m="",g="";return c==="bottom"?(m=s?d:`${f}px`,g=`${-l}px`):c==="top"?(m=s?d:`${f}px`,g=`${r.floating.height+l}px`):c==="right"?(m=`${-l}px`,g=s?d:`${p}px`):c==="left"&&(m=`${r.floating.width+l}px`,g=s?d:`${p}px`),{data:{x:m,y:g}}}});function OR(t){const[e,n="center"]=t.split("-");return[e,n]}var PR=CR,q0=ER,MR=TR,AR=RR,bm="rovingFocusGroup.onEntryFocus",CU={bubbles:!1,cancelable:!0},Jh="RovingFocusGroup",[_y,DR,kU]=L0(Jh),[EU,IR]=yo(Jh,[kU]),[TU,_U]=EU(Jh),NR=y.forwardRef((t,e)=>h.jsx(_y.Provider,{scope:t.__scopeRovingFocusGroup,children:h.jsx(_y.Slot,{scope:t.__scopeRovingFocusGroup,children:h.jsx(RU,{...t,ref:e})})}));NR.displayName=Jh;var RU=y.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:n,orientation:r,loop:i=!1,dir:o,currentTabStopId:s,defaultCurrentTabStopId:a,onCurrentTabStopIdChange:l,onEntryFocus:c,preventScrollOnEntryFocus:u=!1,...d}=t,f=y.useRef(null),p=He(e,f),m=cR(o),[g=null,v]=Su({prop:s,defaultProp:a,onChange:l}),[x,w]=y.useState(!1),S=jt(c),b=DR(n),C=y.useRef(!1),[k,E]=y.useState(0);return y.useEffect(()=>{const T=f.current;if(T)return T.addEventListener(bm,S),()=>T.removeEventListener(bm,S)},[S]),h.jsx(TU,{scope:n,orientation:r,dir:m,loop:i,currentTabStopId:g,onItemFocus:y.useCallback(T=>v(T),[v]),onItemShiftTab:y.useCallback(()=>w(!0),[]),onFocusableItemAdd:y.useCallback(()=>E(T=>T+1),[]),onFocusableItemRemove:y.useCallback(()=>E(T=>T-1),[]),children:h.jsx(ge.div,{tabIndex:x||k===0?-1:0,"data-orientation":r,...d,ref:p,style:{outline:"none",...t.style},onMouseDown:Q(t.onMouseDown,()=>{C.current=!0}),onFocus:Q(t.onFocus,T=>{const O=!C.current;if(T.target===T.currentTarget&&O&&!x){const R=new CustomEvent(bm,CU);if(T.currentTarget.dispatchEvent(R),!R.defaultPrevented){const I=b().filter(B=>B.focusable),$=I.find(B=>B.active),P=I.find(B=>B.id===g),z=[$,P,...I].filter(Boolean).map(B=>B.ref.current);$R(z,u)}}C.current=!1}),onBlur:Q(t.onBlur,()=>w(!1))})})}),jR="RovingFocusGroupItem",LR=y.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:n,focusable:r=!0,active:i=!1,tabStopId:o,...s}=t,a=rs(),l=o||a,c=_U(jR,n),u=c.currentTabStopId===l,d=DR(n),{onFocusableItemAdd:f,onFocusableItemRemove:p}=c;return y.useEffect(()=>{if(r)return f(),()=>p()},[r,f,p]),h.jsx(_y.ItemSlot,{scope:n,id:l,focusable:r,active:i,children:h.jsx(ge.span,{tabIndex:u?0:-1,"data-orientation":c.orientation,...s,ref:e,onMouseDown:Q(t.onMouseDown,m=>{r?c.onItemFocus(l):m.preventDefault()}),onFocus:Q(t.onFocus,()=>c.onItemFocus(l)),onKeyDown:Q(t.onKeyDown,m=>{if(m.key==="Tab"&&m.shiftKey){c.onItemShiftTab();return}if(m.target!==m.currentTarget)return;const g=MU(m,c.orientation,c.dir);if(g!==void 0){if(m.metaKey||m.ctrlKey||m.altKey||m.shiftKey)return;m.preventDefault();let x=d().filter(w=>w.focusable).map(w=>w.ref.current);if(g==="last")x.reverse();else if(g==="prev"||g==="next"){g==="prev"&&x.reverse();const w=x.indexOf(m.currentTarget);x=c.loop?AU(x,w+1):x.slice(w+1)}setTimeout(()=>$R(x))}})})})});LR.displayName=jR;var OU={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function PU(t,e){return e!=="rtl"?t:t==="ArrowLeft"?"ArrowRight":t==="ArrowRight"?"ArrowLeft":t}function MU(t,e,n){const r=PU(t.key,n);if(!(e==="vertical"&&["ArrowLeft","ArrowRight"].includes(r))&&!(e==="horizontal"&&["ArrowUp","ArrowDown"].includes(r)))return OU[r]}function $R(t,e=!1){const n=document.activeElement;for(const r of t)if(r===n||(r.focus({preventScroll:e}),document.activeElement!==n))return}function AU(t,e){return t.map((n,r)=>t[(e+r)%t.length])}var DU=NR,IU=LR,Ry=["Enter"," "],NU=["ArrowDown","PageUp","Home"],FR=["ArrowUp","PageDown","End"],jU=[...NU,...FR],LU={ltr:[...Ry,"ArrowRight"],rtl:[...Ry,"ArrowLeft"]},$U={ltr:["ArrowLeft"],rtl:["ArrowRight"]},Tu="Menu",[Kc,FU,BU]=L0(Tu),[Ts,BR]=yo(Tu,[BU,Gh,IR]),Yh=Gh(),zR=IR(),[zU,_s]=Ts(Tu),[UU,_u]=Ts(Tu),UR=t=>{const{__scopeMenu:e,open:n=!1,children:r,dir:i,onOpenChange:o,modal:s=!0}=t,a=Yh(e),[l,c]=y.useState(null),u=y.useRef(!1),d=jt(o),f=cR(i);return y.useEffect(()=>{const p=()=>{u.current=!0,document.addEventListener("pointerdown",m,{capture:!0,once:!0}),document.addEventListener("pointermove",m,{capture:!0,once:!0})},m=()=>u.current=!1;return document.addEventListener("keydown",p,{capture:!0}),()=>{document.removeEventListener("keydown",p,{capture:!0}),document.removeEventListener("pointerdown",m,{capture:!0}),document.removeEventListener("pointermove",m,{capture:!0})}},[]),h.jsx(PR,{...a,children:h.jsx(zU,{scope:e,open:n,onOpenChange:d,content:l,onContentChange:c,children:h.jsx(UU,{scope:e,onClose:y.useCallback(()=>d(!1),[d]),isUsingKeyboardRef:u,dir:f,modal:s,children:r})})})};UR.displayName=Tu;var VU="MenuAnchor",G0=y.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t,i=Yh(n);return h.jsx(q0,{...i,...r,ref:e})});G0.displayName=VU;var J0="MenuPortal",[HU,VR]=Ts(J0,{forceMount:void 0}),HR=t=>{const{__scopeMenu:e,forceMount:n,children:r,container:i}=t,o=_s(J0,e);return h.jsx(HU,{scope:e,forceMount:n,children:h.jsx(lr,{present:n||o.open,children:h.jsx(ku,{asChild:!0,container:i,children:r})})})};HR.displayName=J0;var In="MenuContent",[WU,Y0]=Ts(In),WR=y.forwardRef((t,e)=>{const n=VR(In,t.__scopeMenu),{forceMount:r=n.forceMount,...i}=t,o=_s(In,t.__scopeMenu),s=_u(In,t.__scopeMenu);return h.jsx(Kc.Provider,{scope:t.__scopeMenu,children:h.jsx(lr,{present:r||o.open,children:h.jsx(Kc.Slot,{scope:t.__scopeMenu,children:s.modal?h.jsx(KU,{...i,ref:e}):h.jsx(qU,{...i,ref:e})})})})}),KU=y.forwardRef((t,e)=>{const n=_s(In,t.__scopeMenu),r=y.useRef(null),i=He(e,r);return y.useEffect(()=>{const o=r.current;if(o)return A0(o)},[]),h.jsx(Q0,{...t,ref:i,trapFocus:n.open,disableOutsidePointerEvents:n.open,disableOutsideScroll:!0,onFocusOutside:Q(t.onFocusOutside,o=>o.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>n.onOpenChange(!1)})}),qU=y.forwardRef((t,e)=>{const n=_s(In,t.__scopeMenu);return h.jsx(Q0,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>n.onOpenChange(!1)})}),Q0=y.forwardRef((t,e)=>{const{__scopeMenu:n,loop:r=!1,trapFocus:i,onOpenAutoFocus:o,onCloseAutoFocus:s,disableOutsidePointerEvents:a,onEntryFocus:l,onEscapeKeyDown:c,onPointerDownOutside:u,onFocusOutside:d,onInteractOutside:f,onDismiss:p,disableOutsideScroll:m,...g}=t,v=_s(In,n),x=_u(In,n),w=Yh(n),S=zR(n),b=FU(n),[C,k]=y.useState(null),E=y.useRef(null),T=He(e,E,v.onContentChange),O=y.useRef(0),R=y.useRef(""),I=y.useRef(0),$=y.useRef(null),P=y.useRef("right"),M=y.useRef(0),z=m?M0:y.Fragment,B=m?{as:vs,allowPinchZoom:!0}:void 0,H=D=>{var ze,kt;const L=R.current+D,Y=b().filter(qe=>!qe.disabled),ee=document.activeElement,G=(ze=Y.find(qe=>qe.ref.current===ee))==null?void 0:ze.textValue,Z=Y.map(qe=>qe.textValue),xe=oV(Z,L,G),we=(kt=Y.find(qe=>qe.textValue===xe))==null?void 0:kt.ref.current;(function qe(Ut){R.current=Ut,window.clearTimeout(O.current),Ut!==""&&(O.current=window.setTimeout(()=>qe(""),1e3))})(L),we&&setTimeout(()=>we.focus())};y.useEffect(()=>()=>window.clearTimeout(O.current),[]),P0();const A=y.useCallback(D=>{var Y,ee;return P.current===((Y=$.current)==null?void 0:Y.side)&&aV(D,(ee=$.current)==null?void 0:ee.area)},[]);return h.jsx(WU,{scope:n,searchRef:R,onItemEnter:y.useCallback(D=>{A(D)&&D.preventDefault()},[A]),onItemLeave:y.useCallback(D=>{var L;A(D)||((L=E.current)==null||L.focus(),k(null))},[A]),onTriggerLeave:y.useCallback(D=>{A(D)&&D.preventDefault()},[A]),pointerGraceTimerRef:I,onPointerGraceIntentChange:y.useCallback(D=>{$.current=D},[]),children:h.jsx(z,{...B,children:h.jsx(Uh,{asChild:!0,trapped:i,onMountAutoFocus:Q(o,D=>{var L;D.preventDefault(),(L=E.current)==null||L.focus({preventScroll:!0})}),onUnmountAutoFocus:s,children:h.jsx(Cu,{asChild:!0,disableOutsidePointerEvents:a,onEscapeKeyDown:c,onPointerDownOutside:u,onFocusOutside:d,onInteractOutside:f,onDismiss:p,children:h.jsx(DU,{asChild:!0,...S,dir:x.dir,orientation:"vertical",loop:r,currentTabStopId:C,onCurrentTabStopIdChange:k,onEntryFocus:Q(l,D=>{x.isUsingKeyboardRef.current||D.preventDefault()}),preventScrollOnEntryFocus:!0,children:h.jsx(MR,{role:"menu","aria-orientation":"vertical","data-state":aO(v.open),"data-radix-menu-content":"",dir:x.dir,...w,...g,ref:T,style:{outline:"none",...g.style},onKeyDown:Q(g.onKeyDown,D=>{const Y=D.target.closest("[data-radix-menu-content]")===D.currentTarget,ee=D.ctrlKey||D.altKey||D.metaKey,G=D.key.length===1;Y&&(D.key==="Tab"&&D.preventDefault(),!ee&&G&&H(D.key));const Z=E.current;if(D.target!==Z||!jU.includes(D.key))return;D.preventDefault();const we=b().filter(ze=>!ze.disabled).map(ze=>ze.ref.current);FR.includes(D.key)&&we.reverse(),rV(we)}),onBlur:Q(t.onBlur,D=>{D.currentTarget.contains(D.target)||(window.clearTimeout(O.current),R.current="")}),onPointerMove:Q(t.onPointerMove,qc(D=>{const L=D.target,Y=M.current!==D.clientX;if(D.currentTarget.contains(L)&&Y){const ee=D.clientX>M.current?"right":"left";P.current=ee,M.current=D.clientX}}))})})})})})})});WR.displayName=In;var GU="MenuGroup",X0=y.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t;return h.jsx(ge.div,{role:"group",...r,ref:e})});X0.displayName=GU;var JU="MenuLabel",KR=y.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t;return h.jsx(ge.div,{...r,ref:e})});KR.displayName=JU;var Yf="MenuItem",q1="menu.itemSelect",Qh=y.forwardRef((t,e)=>{const{disabled:n=!1,onSelect:r,...i}=t,o=y.useRef(null),s=_u(Yf,t.__scopeMenu),a=Y0(Yf,t.__scopeMenu),l=He(e,o),c=y.useRef(!1),u=()=>{const d=o.current;if(!n&&d){const f=new CustomEvent(q1,{bubbles:!0,cancelable:!0});d.addEventListener(q1,p=>r==null?void 0:r(p),{once:!0}),O0(d,f),f.defaultPrevented?c.current=!1:s.onClose()}};return h.jsx(qR,{...i,ref:l,disabled:n,onClick:Q(t.onClick,u),onPointerDown:d=>{var f;(f=t.onPointerDown)==null||f.call(t,d),c.current=!0},onPointerUp:Q(t.onPointerUp,d=>{var f;c.current||(f=d.currentTarget)==null||f.click()}),onKeyDown:Q(t.onKeyDown,d=>{const f=a.searchRef.current!=="";n||f&&d.key===" "||Ry.includes(d.key)&&(d.currentTarget.click(),d.preventDefault())})})});Qh.displayName=Yf;var qR=y.forwardRef((t,e)=>{const{__scopeMenu:n,disabled:r=!1,textValue:i,...o}=t,s=Y0(Yf,n),a=zR(n),l=y.useRef(null),c=He(e,l),[u,d]=y.useState(!1),[f,p]=y.useState("");return y.useEffect(()=>{const m=l.current;m&&p((m.textContent??"").trim())},[o.children]),h.jsx(Kc.ItemSlot,{scope:n,disabled:r,textValue:i??f,children:h.jsx(IU,{asChild:!0,...a,focusable:!r,children:h.jsx(ge.div,{role:"menuitem","data-highlighted":u?"":void 0,"aria-disabled":r||void 0,"data-disabled":r?"":void 0,...o,ref:c,onPointerMove:Q(t.onPointerMove,qc(m=>{r?s.onItemLeave(m):(s.onItemEnter(m),m.defaultPrevented||m.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:Q(t.onPointerLeave,qc(m=>s.onItemLeave(m))),onFocus:Q(t.onFocus,()=>d(!0)),onBlur:Q(t.onBlur,()=>d(!1))})})})}),YU="MenuCheckboxItem",GR=y.forwardRef((t,e)=>{const{checked:n=!1,onCheckedChange:r,...i}=t;return h.jsx(ZR,{scope:t.__scopeMenu,checked:n,children:h.jsx(Qh,{role:"menuitemcheckbox","aria-checked":Qf(n)?"mixed":n,...i,ref:e,"data-state":ex(n),onSelect:Q(i.onSelect,()=>r==null?void 0:r(Qf(n)?!0:!n),{checkForDefaultPrevented:!1})})})});GR.displayName=YU;var JR="MenuRadioGroup",[QU,XU]=Ts(JR,{value:void 0,onValueChange:()=>{}}),YR=y.forwardRef((t,e)=>{const{value:n,onValueChange:r,...i}=t,o=jt(r);return h.jsx(QU,{scope:t.__scopeMenu,value:n,onValueChange:o,children:h.jsx(X0,{...i,ref:e})})});YR.displayName=JR;var QR="MenuRadioItem",XR=y.forwardRef((t,e)=>{const{value:n,...r}=t,i=XU(QR,t.__scopeMenu),o=n===i.value;return h.jsx(ZR,{scope:t.__scopeMenu,checked:o,children:h.jsx(Qh,{role:"menuitemradio","aria-checked":o,...r,ref:e,"data-state":ex(o),onSelect:Q(r.onSelect,()=>{var s;return(s=i.onValueChange)==null?void 0:s.call(i,n)},{checkForDefaultPrevented:!1})})})});XR.displayName=QR;var Z0="MenuItemIndicator",[ZR,ZU]=Ts(Z0,{checked:!1}),eO=y.forwardRef((t,e)=>{const{__scopeMenu:n,forceMount:r,...i}=t,o=ZU(Z0,n);return h.jsx(lr,{present:r||Qf(o.checked)||o.checked===!0,children:h.jsx(ge.span,{...i,ref:e,"data-state":ex(o.checked)})})});eO.displayName=Z0;var eV="MenuSeparator",tO=y.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t;return h.jsx(ge.div,{role:"separator","aria-orientation":"horizontal",...r,ref:e})});tO.displayName=eV;var tV="MenuArrow",nO=y.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t,i=Yh(n);return h.jsx(AR,{...i,...r,ref:e})});nO.displayName=tV;var nV="MenuSub",[XH,rO]=Ts(nV),Ul="MenuSubTrigger",iO=y.forwardRef((t,e)=>{const n=_s(Ul,t.__scopeMenu),r=_u(Ul,t.__scopeMenu),i=rO(Ul,t.__scopeMenu),o=Y0(Ul,t.__scopeMenu),s=y.useRef(null),{pointerGraceTimerRef:a,onPointerGraceIntentChange:l}=o,c={__scopeMenu:t.__scopeMenu},u=y.useCallback(()=>{s.current&&window.clearTimeout(s.current),s.current=null},[]);return y.useEffect(()=>u,[u]),y.useEffect(()=>{const d=a.current;return()=>{window.clearTimeout(d),l(null)}},[a,l]),h.jsx(G0,{asChild:!0,...c,children:h.jsx(qR,{id:i.triggerId,"aria-haspopup":"menu","aria-expanded":n.open,"aria-controls":i.contentId,"data-state":aO(n.open),...t,ref:zh(e,i.onTriggerChange),onClick:d=>{var f;(f=t.onClick)==null||f.call(t,d),!(t.disabled||d.defaultPrevented)&&(d.currentTarget.focus(),n.open||n.onOpenChange(!0))},onPointerMove:Q(t.onPointerMove,qc(d=>{o.onItemEnter(d),!d.defaultPrevented&&!t.disabled&&!n.open&&!s.current&&(o.onPointerGraceIntentChange(null),s.current=window.setTimeout(()=>{n.onOpenChange(!0),u()},100))})),onPointerLeave:Q(t.onPointerLeave,qc(d=>{var p,m;u();const f=(p=n.content)==null?void 0:p.getBoundingClientRect();if(f){const g=(m=n.content)==null?void 0:m.dataset.side,v=g==="right",x=v?-5:5,w=f[v?"left":"right"],S=f[v?"right":"left"];o.onPointerGraceIntentChange({area:[{x:d.clientX+x,y:d.clientY},{x:w,y:f.top},{x:S,y:f.top},{x:S,y:f.bottom},{x:w,y:f.bottom}],side:g}),window.clearTimeout(a.current),a.current=window.setTimeout(()=>o.onPointerGraceIntentChange(null),300)}else{if(o.onTriggerLeave(d),d.defaultPrevented)return;o.onPointerGraceIntentChange(null)}})),onKeyDown:Q(t.onKeyDown,d=>{var p;const f=o.searchRef.current!=="";t.disabled||f&&d.key===" "||LU[r.dir].includes(d.key)&&(n.onOpenChange(!0),(p=n.content)==null||p.focus(),d.preventDefault())})})})});iO.displayName=Ul;var oO="MenuSubContent",sO=y.forwardRef((t,e)=>{const n=VR(In,t.__scopeMenu),{forceMount:r=n.forceMount,...i}=t,o=_s(In,t.__scopeMenu),s=_u(In,t.__scopeMenu),a=rO(oO,t.__scopeMenu),l=y.useRef(null),c=He(e,l);return h.jsx(Kc.Provider,{scope:t.__scopeMenu,children:h.jsx(lr,{present:r||o.open,children:h.jsx(Kc.Slot,{scope:t.__scopeMenu,children:h.jsx(Q0,{id:a.contentId,"aria-labelledby":a.triggerId,...i,ref:c,align:"start",side:s.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:u=>{var d;s.isUsingKeyboardRef.current&&((d=l.current)==null||d.focus()),u.preventDefault()},onCloseAutoFocus:u=>u.preventDefault(),onFocusOutside:Q(t.onFocusOutside,u=>{u.target!==a.trigger&&o.onOpenChange(!1)}),onEscapeKeyDown:Q(t.onEscapeKeyDown,u=>{s.onClose(),u.preventDefault()}),onKeyDown:Q(t.onKeyDown,u=>{var p;const d=u.currentTarget.contains(u.target),f=$U[s.dir].includes(u.key);d&&f&&(o.onOpenChange(!1),(p=a.trigger)==null||p.focus(),u.preventDefault())})})})})})});sO.displayName=oO;function aO(t){return t?"open":"closed"}function Qf(t){return t==="indeterminate"}function ex(t){return Qf(t)?"indeterminate":t?"checked":"unchecked"}function rV(t){const e=document.activeElement;for(const n of t)if(n===e||(n.focus(),document.activeElement!==e))return}function iV(t,e){return t.map((n,r)=>t[(e+r)%t.length])}function oV(t,e,n){const i=e.length>1&&Array.from(e).every(c=>c===e[0])?e[0]:e,o=n?t.indexOf(n):-1;let s=iV(t,Math.max(o,0));i.length===1&&(s=s.filter(c=>c!==n));const l=s.find(c=>c.toLowerCase().startsWith(i.toLowerCase()));return l!==n?l:void 0}function sV(t,e){const{x:n,y:r}=t;let i=!1;for(let o=0,s=e.length-1;o<e.length;s=o++){const a=e[o].x,l=e[o].y,c=e[s].x,u=e[s].y;l>r!=u>r&&n<(c-a)*(r-l)/(u-l)+a&&(i=!i)}return i}function aV(t,e){if(!e)return!1;const n={x:t.clientX,y:t.clientY};return sV(n,e)}function qc(t){return e=>e.pointerType==="mouse"?t(e):void 0}var lV=UR,cV=G0,uV=HR,dV=WR,fV=X0,hV=KR,pV=Qh,mV=GR,gV=YR,yV=XR,vV=eO,xV=tO,wV=nO,bV=iO,SV=sO,tx="DropdownMenu",[CV,ZH]=yo(tx,[BR]),Bt=BR(),[kV,lO]=CV(tx),cO=t=>{const{__scopeDropdownMenu:e,children:n,dir:r,open:i,defaultOpen:o,onOpenChange:s,modal:a=!0}=t,l=Bt(e),c=y.useRef(null),[u=!1,d]=Su({prop:i,defaultProp:o,onChange:s});return h.jsx(kV,{scope:e,triggerId:rs(),triggerRef:c,contentId:rs(),open:u,onOpenChange:d,onOpenToggle:y.useCallback(()=>d(f=>!f),[d]),modal:a,children:h.jsx(lV,{...l,open:u,onOpenChange:d,dir:r,modal:a,children:n})})};cO.displayName=tx;var uO="DropdownMenuTrigger",dO=y.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,disabled:r=!1,...i}=t,o=lO(uO,n),s=Bt(n);return h.jsx(cV,{asChild:!0,...s,children:h.jsx(ge.button,{type:"button",id:o.triggerId,"aria-haspopup":"menu","aria-expanded":o.open,"aria-controls":o.open?o.contentId:void 0,"data-state":o.open?"open":"closed","data-disabled":r?"":void 0,disabled:r,...i,ref:zh(e,o.triggerRef),onPointerDown:Q(t.onPointerDown,a=>{!r&&a.button===0&&a.ctrlKey===!1&&(o.onOpenToggle(),o.open||a.preventDefault())}),onKeyDown:Q(t.onKeyDown,a=>{r||(["Enter"," "].includes(a.key)&&o.onOpenToggle(),a.key==="ArrowDown"&&o.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(a.key)&&a.preventDefault())})})})});dO.displayName=uO;var EV="DropdownMenuPortal",fO=t=>{const{__scopeDropdownMenu:e,...n}=t,r=Bt(e);return h.jsx(uV,{...r,...n})};fO.displayName=EV;var hO="DropdownMenuContent",pO=y.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,i=lO(hO,n),o=Bt(n),s=y.useRef(!1);return h.jsx(dV,{id:i.contentId,"aria-labelledby":i.triggerId,...o,...r,ref:e,onCloseAutoFocus:Q(t.onCloseAutoFocus,a=>{var l;s.current||(l=i.triggerRef.current)==null||l.focus(),s.current=!1,a.preventDefault()}),onInteractOutside:Q(t.onInteractOutside,a=>{const l=a.detail.originalEvent,c=l.button===0&&l.ctrlKey===!0,u=l.button===2||c;(!i.modal||u)&&(s.current=!0)}),style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});pO.displayName=hO;var TV="DropdownMenuGroup",_V=y.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,i=Bt(n);return h.jsx(fV,{...i,...r,ref:e})});_V.displayName=TV;var RV="DropdownMenuLabel",OV=y.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,i=Bt(n);return h.jsx(hV,{...i,...r,ref:e})});OV.displayName=RV;var PV="DropdownMenuItem",mO=y.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,i=Bt(n);return h.jsx(pV,{...i,...r,ref:e})});mO.displayName=PV;var MV="DropdownMenuCheckboxItem",AV=y.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,i=Bt(n);return h.jsx(mV,{...i,...r,ref:e})});AV.displayName=MV;var DV="DropdownMenuRadioGroup",IV=y.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,i=Bt(n);return h.jsx(gV,{...i,...r,ref:e})});IV.displayName=DV;var NV="DropdownMenuRadioItem",jV=y.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,i=Bt(n);return h.jsx(yV,{...i,...r,ref:e})});jV.displayName=NV;var LV="DropdownMenuItemIndicator",$V=y.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,i=Bt(n);return h.jsx(vV,{...i,...r,ref:e})});$V.displayName=LV;var FV="DropdownMenuSeparator",gO=y.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,i=Bt(n);return h.jsx(xV,{...i,...r,ref:e})});gO.displayName=FV;var BV="DropdownMenuArrow",zV=y.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,i=Bt(n);return h.jsx(wV,{...i,...r,ref:e})});zV.displayName=BV;var UV="DropdownMenuSubTrigger",VV=y.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,i=Bt(n);return h.jsx(bV,{...i,...r,ref:e})});VV.displayName=UV;var HV="DropdownMenuSubContent",WV=y.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,i=Bt(n);return h.jsx(SV,{...i,...r,ref:e,style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});WV.displayName=HV;var tl=cO,nl=dO,rl=fO,il=pO,Gt=mO,G1=gO,KV="VisuallyHidden",nx=y.forwardRef((t,e)=>h.jsx(ge.span,{...t,ref:e,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...t.style}}));nx.displayName=KV;var rx="ToastProvider",[ix,qV,GV]=L0("Toast"),[yO,eW]=yo("Toast",[GV]),[JV,Xh]=yO(rx),vO=t=>{const{__scopeToast:e,label:n="Notification",duration:r=5e3,swipeDirection:i="right",swipeThreshold:o=50,children:s}=t,[a,l]=y.useState(null),[c,u]=y.useState(0),d=y.useRef(!1),f=y.useRef(!1);return n.trim()||console.error(`Invalid prop \`label\` supplied to \`${rx}\`. Expected non-empty \`string\`.`),h.jsx(ix.Provider,{scope:e,children:h.jsx(JV,{scope:e,label:n,duration:r,swipeDirection:i,swipeThreshold:o,toastCount:c,viewport:a,onViewportChange:l,onToastAdd:y.useCallback(()=>u(p=>p+1),[]),onToastRemove:y.useCallback(()=>u(p=>p-1),[]),isFocusedToastEscapeKeyDownRef:d,isClosePausedRef:f,children:s})})};vO.displayName=rx;var xO="ToastViewport",YV=["F8"],Oy="toast.viewportPause",Py="toast.viewportResume",wO=y.forwardRef((t,e)=>{const{__scopeToast:n,hotkey:r=YV,label:i="Notifications ({hotkey})",...o}=t,s=Xh(xO,n),a=qV(n),l=y.useRef(null),c=y.useRef(null),u=y.useRef(null),d=y.useRef(null),f=He(e,d,s.onViewportChange),p=r.join("+").replace(/Key/g,"").replace(/Digit/g,""),m=s.toastCount>0;y.useEffect(()=>{const v=x=>{var S;r.length!==0&&r.every(b=>x[b]||x.code===b)&&((S=d.current)==null||S.focus())};return document.addEventListener("keydown",v),()=>document.removeEventListener("keydown",v)},[r]),y.useEffect(()=>{const v=l.current,x=d.current;if(m&&v&&x){const w=()=>{if(!s.isClosePausedRef.current){const k=new CustomEvent(Oy);x.dispatchEvent(k),s.isClosePausedRef.current=!0}},S=()=>{if(s.isClosePausedRef.current){const k=new CustomEvent(Py);x.dispatchEvent(k),s.isClosePausedRef.current=!1}},b=k=>{!v.contains(k.relatedTarget)&&S()},C=()=>{v.contains(document.activeElement)||S()};return v.addEventListener("focusin",w),v.addEventListener("focusout",b),v.addEventListener("pointermove",w),v.addEventListener("pointerleave",C),window.addEventListener("blur",w),window.addEventListener("focus",S),()=>{v.removeEventListener("focusin",w),v.removeEventListener("focusout",b),v.removeEventListener("pointermove",w),v.removeEventListener("pointerleave",C),window.removeEventListener("blur",w),window.removeEventListener("focus",S)}}},[m,s.isClosePausedRef]);const g=y.useCallback(({tabbingDirection:v})=>{const w=a().map(S=>{const b=S.ref.current,C=[b,...u7(b)];return v==="forwards"?C:C.reverse()});return(v==="forwards"?w.reverse():w).flat()},[a]);return y.useEffect(()=>{const v=d.current;if(v){const x=w=>{var C,k,E;const S=w.altKey||w.ctrlKey||w.metaKey;if(w.key==="Tab"&&!S){const T=document.activeElement,O=w.shiftKey;if(w.target===v&&O){(C=c.current)==null||C.focus();return}const $=g({tabbingDirection:O?"backwards":"forwards"}),P=$.findIndex(M=>M===T);Sm($.slice(P+1))?w.preventDefault():O?(k=c.current)==null||k.focus():(E=u.current)==null||E.focus()}};return v.addEventListener("keydown",x),()=>v.removeEventListener("keydown",x)}},[a,g]),h.jsxs(P6,{ref:l,role:"region","aria-label":i.replace("{hotkey}",p),tabIndex:-1,style:{pointerEvents:m?void 0:"none"},children:[m&&h.jsx(My,{ref:c,onFocusFromOutsideViewport:()=>{const v=g({tabbingDirection:"forwards"});Sm(v)}}),h.jsx(ix.Slot,{scope:n,children:h.jsx(ge.ol,{tabIndex:-1,...o,ref:f})}),m&&h.jsx(My,{ref:u,onFocusFromOutsideViewport:()=>{const v=g({tabbingDirection:"backwards"});Sm(v)}})]})});wO.displayName=xO;var bO="ToastFocusProxy",My=y.forwardRef((t,e)=>{const{__scopeToast:n,onFocusFromOutsideViewport:r,...i}=t,o=Xh(bO,n);return h.jsx(nx,{"aria-hidden":!0,tabIndex:0,...i,ref:e,style:{position:"fixed"},onFocus:s=>{var c;const a=s.relatedTarget;!((c=o.viewport)!=null&&c.contains(a))&&r()}})});My.displayName=bO;var Zh="Toast",QV="toast.swipeStart",XV="toast.swipeMove",ZV="toast.swipeCancel",e7="toast.swipeEnd",SO=y.forwardRef((t,e)=>{const{forceMount:n,open:r,defaultOpen:i,onOpenChange:o,...s}=t,[a=!0,l]=Su({prop:r,defaultProp:i,onChange:o});return h.jsx(lr,{present:n||a,children:h.jsx(r7,{open:a,...s,ref:e,onClose:()=>l(!1),onPause:jt(t.onPause),onResume:jt(t.onResume),onSwipeStart:Q(t.onSwipeStart,c=>{c.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:Q(t.onSwipeMove,c=>{const{x:u,y:d}=c.detail.delta;c.currentTarget.setAttribute("data-swipe","move"),c.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${u}px`),c.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${d}px`)}),onSwipeCancel:Q(t.onSwipeCancel,c=>{c.currentTarget.setAttribute("data-swipe","cancel"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),c.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),c.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:Q(t.onSwipeEnd,c=>{const{x:u,y:d}=c.detail.delta;c.currentTarget.setAttribute("data-swipe","end"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),c.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${u}px`),c.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${d}px`),l(!1)})})})});SO.displayName=Zh;var[t7,n7]=yO(Zh,{onClose(){}}),r7=y.forwardRef((t,e)=>{const{__scopeToast:n,type:r="foreground",duration:i,open:o,onClose:s,onEscapeKeyDown:a,onPause:l,onResume:c,onSwipeStart:u,onSwipeMove:d,onSwipeCancel:f,onSwipeEnd:p,...m}=t,g=Xh(Zh,n),[v,x]=y.useState(null),w=He(e,M=>x(M)),S=y.useRef(null),b=y.useRef(null),C=i||g.duration,k=y.useRef(0),E=y.useRef(C),T=y.useRef(0),{onToastAdd:O,onToastRemove:R}=g,I=jt(()=>{var z;(v==null?void 0:v.contains(document.activeElement))&&((z=g.viewport)==null||z.focus()),s()}),$=y.useCallback(M=>{!M||M===1/0||(window.clearTimeout(T.current),k.current=new Date().getTime(),T.current=window.setTimeout(I,M))},[I]);y.useEffect(()=>{const M=g.viewport;if(M){const z=()=>{$(E.current),c==null||c()},B=()=>{const H=new Date().getTime()-k.current;E.current=E.current-H,window.clearTimeout(T.current),l==null||l()};return M.addEventListener(Oy,B),M.addEventListener(Py,z),()=>{M.removeEventListener(Oy,B),M.removeEventListener(Py,z)}}},[g.viewport,C,l,c,$]),y.useEffect(()=>{o&&!g.isClosePausedRef.current&&$(C)},[o,C,g.isClosePausedRef,$]),y.useEffect(()=>(O(),()=>R()),[O,R]);const P=y.useMemo(()=>v?RO(v):null,[v]);return g.viewport?h.jsxs(h.Fragment,{children:[P&&h.jsx(i7,{__scopeToast:n,role:"status","aria-live":r==="foreground"?"assertive":"polite","aria-atomic":!0,children:P}),h.jsx(t7,{scope:n,onClose:I,children:du.createPortal(h.jsx(ix.ItemSlot,{scope:n,children:h.jsx(O6,{asChild:!0,onEscapeKeyDown:Q(a,()=>{g.isFocusedToastEscapeKeyDownRef.current||I(),g.isFocusedToastEscapeKeyDownRef.current=!1}),children:h.jsx(ge.li,{role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":o?"open":"closed","data-swipe-direction":g.swipeDirection,...m,ref:w,style:{userSelect:"none",touchAction:"none",...t.style},onKeyDown:Q(t.onKeyDown,M=>{M.key==="Escape"&&(a==null||a(M.nativeEvent),M.nativeEvent.defaultPrevented||(g.isFocusedToastEscapeKeyDownRef.current=!0,I()))}),onPointerDown:Q(t.onPointerDown,M=>{M.button===0&&(S.current={x:M.clientX,y:M.clientY})}),onPointerMove:Q(t.onPointerMove,M=>{if(!S.current)return;const z=M.clientX-S.current.x,B=M.clientY-S.current.y,H=!!b.current,A=["left","right"].includes(g.swipeDirection),D=["left","up"].includes(g.swipeDirection)?Math.min:Math.max,L=A?D(0,z):0,Y=A?0:D(0,B),ee=M.pointerType==="touch"?10:2,G={x:L,y:Y},Z={originalEvent:M,delta:G};H?(b.current=G,bd(XV,d,Z,{discrete:!1})):J1(G,g.swipeDirection,ee)?(b.current=G,bd(QV,u,Z,{discrete:!1}),M.target.setPointerCapture(M.pointerId)):(Math.abs(z)>ee||Math.abs(B)>ee)&&(S.current=null)}),onPointerUp:Q(t.onPointerUp,M=>{const z=b.current,B=M.target;if(B.hasPointerCapture(M.pointerId)&&B.releasePointerCapture(M.pointerId),b.current=null,S.current=null,z){const H=M.currentTarget,A={originalEvent:M,delta:z};J1(z,g.swipeDirection,g.swipeThreshold)?bd(e7,p,A,{discrete:!0}):bd(ZV,f,A,{discrete:!0}),H.addEventListener("click",D=>D.preventDefault(),{once:!0})}})})})}),g.viewport)})]}):null}),i7=t=>{const{__scopeToast:e,children:n,...r}=t,i=Xh(Zh,e),[o,s]=y.useState(!1),[a,l]=y.useState(!1);return l7(()=>s(!0)),y.useEffect(()=>{const c=window.setTimeout(()=>l(!0),1e3);return()=>window.clearTimeout(c)},[]),a?null:h.jsx(ku,{asChild:!0,children:h.jsx(nx,{...r,children:o&&h.jsxs(h.Fragment,{children:[i.label," ",n]})})})},o7="ToastTitle",CO=y.forwardRef((t,e)=>{const{__scopeToast:n,...r}=t;return h.jsx(ge.div,{...r,ref:e})});CO.displayName=o7;var s7="ToastDescription",kO=y.forwardRef((t,e)=>{const{__scopeToast:n,...r}=t;return h.jsx(ge.div,{...r,ref:e})});kO.displayName=s7;var EO="ToastAction",a7=y.forwardRef((t,e)=>{const{altText:n,...r}=t;return n.trim()?h.jsx(_O,{altText:n,asChild:!0,children:h.jsx(ox,{...r,ref:e})}):(console.error(`Invalid prop \`altText\` supplied to \`${EO}\`. Expected non-empty \`string\`.`),null)});a7.displayName=EO;var TO="ToastClose",ox=y.forwardRef((t,e)=>{const{__scopeToast:n,...r}=t,i=n7(TO,n);return h.jsx(_O,{asChild:!0,children:h.jsx(ge.button,{type:"button",...r,ref:e,onClick:Q(t.onClick,i.onClose)})})});ox.displayName=TO;var _O=y.forwardRef((t,e)=>{const{__scopeToast:n,altText:r,...i}=t;return h.jsx(ge.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":r||void 0,...i,ref:e})});function RO(t){const e=[];return Array.from(t.childNodes).forEach(r=>{if(r.nodeType===r.TEXT_NODE&&r.textContent&&e.push(r.textContent),c7(r)){const i=r.ariaHidden||r.hidden||r.style.display==="none",o=r.dataset.radixToastAnnounceExclude==="";if(!i)if(o){const s=r.dataset.radixToastAnnounceAlt;s&&e.push(s)}else e.push(...RO(r))}}),e}function bd(t,e,n,{discrete:r}){const i=n.originalEvent.currentTarget,o=new CustomEvent(t,{bubbles:!0,cancelable:!0,detail:n});e&&i.addEventListener(t,e,{once:!0}),r?O0(i,o):i.dispatchEvent(o)}var J1=(t,e,n=0)=>{const r=Math.abs(t.x),i=Math.abs(t.y),o=r>i;return e==="left"||e==="right"?o&&r>n:!o&&i>n};function l7(t=()=>{}){const e=jt(t);ro(()=>{let n=0,r=0;return n=window.requestAnimationFrame(()=>r=window.requestAnimationFrame(e)),()=>{window.cancelAnimationFrame(n),window.cancelAnimationFrame(r)}},[e])}function c7(t){return t.nodeType===t.ELEMENT_NODE}function u7(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const i=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||i?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function Sm(t){const e=document.activeElement;return t.some(n=>n===e?!0:(n.focus(),document.activeElement!==e))}var d7=vO,f7=wO,h7=SO,p7=CO,m7=kO,g7=ox;const y7=`
  .toast-close-button {
    all: unset;
    cursor: pointer;
    color: #9CA3AF;
    flex-shrink: 0;
    padding: 2px;
    border-radius: 4px;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s ease;
  }
  
  .toast-close-button:hover {
    background-color: #F3F4F6;
    color: #6B7280;
  }

  @keyframes slideIn {
    from {
      transform: translateY(100%);
      opacity: 0;
    }
    to {
      transform: translateY(0);
      opacity: 1;
    }
  }

  @keyframes slideOut {
    from {
      transform: translateY(0);
      opacity: 1;
    }
    to {
      transform: translateY(100%);
      opacity: 0;
    }
  }

  .toast-root[data-state='open'] {
    animation: slideIn 300ms cubic-bezier(0.16, 1, 0.3, 1);
  }

  .toast-root[data-state='closed'] {
    animation: slideOut 300ms cubic-bezier(0.16, 1, 0.3, 1);
  }
`,Us={viewport:{position:"fixed",bottom:"32px",left:"50%",transform:"translateX(-50%)",display:"flex",flexDirection:"column",padding:"25px",gap:"10px",width:"fit-content",minWidth:"300px",maxWidth:"480px",listStyle:"none",zIndex:2147483647,outline:"none"},toast:{backgroundColor:"white",borderRadius:"8px",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.15)",padding:"16px",display:"flex",alignItems:"flex-start",justifyContent:"space-between",gap:"12px",border:"1px solid #e5e7eb",width:"100%"},title:{color:"#111827",fontSize:"14px",fontWeight:600,marginBottom:"4px"},description:{color:"#6b7280",fontSize:"13px"},icon:{flexShrink:0,marginTop:"2px"}},OO=y.createContext(null);function v7({children:t}){const[e,n]=y.useState({open:!1,title:"",description:"",type:"success"}),r=(i,o,s="success")=>{n({open:!0,title:i,description:o,type:s})};return h.jsx(OO.Provider,{value:{showToast:r},children:h.jsxs(d7,{swipeDirection:"down",duration:2e3,children:[h.jsx("style",{children:y7}),t,h.jsxs(h7,{open:e.open,onOpenChange:i=>n(o=>({...o,open:i})),style:Us.toast,className:"toast-root",children:[h.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"12px",flex:1},children:[e.type==="success"?h.jsx(Jz,{size:18,style:{...Us.icon,color:"#10b981"}}):h.jsx(qz,{size:18,style:{...Us.icon,color:"#ef4444"}}),h.jsxs("div",{style:{flex:1},children:[h.jsx(p7,{style:Us.title,children:e.title}),h.jsx(m7,{style:Us.description,children:e.description})]})]}),h.jsx(g7,{asChild:!0,children:h.jsx("button",{className:"toast-close-button",children:h.jsx(m8,{size:16})})})]}),h.jsx(f7,{style:Us.viewport})]})})}function PO(){const t=y.useContext(OO);if(!t)throw new Error("useToast must be used within a ToastProvider");return t}function zt(){const t=Be(),e=uo(),{data:n,isLoading:r,error:i}=_c({queryKey:["user"],queryFn:async()=>{const o=e.getQueryData(["user"]);if(o)return o;const{data:{user:s},error:a}=await t.auth.getUser();if(a)throw a;if(!s)return null;try{const{data:l,error:c}=await t.from("user_profiles").select("*").eq("id",s.id).single();if(c){if(c.code==="PGRST116")return s;throw c}return{...s,...l}}catch{return s}},staleTime:1/0,gcTime:30*60*1e3,retry:!1,refetchOnMount:!1,refetchOnWindowFocus:!1});return y.useEffect(()=>{const{data:{subscription:o}}=t.auth.onAuthStateChange((s,a)=>{s==="SIGNED_OUT"?e.setQueryData(["user"],null):a!=null&&a.user&&e.invalidateQueries({queryKey:["user"]})});return()=>{o.unsubscribe()}},[t,e]),y.useEffect(()=>{if(!(n!=null&&n.id))return;const o=t.channel(`profile-changes-${n.id}`).on("postgres_changes",{event:"*",schema:"public",table:"user_profiles",filter:`id=eq.${n.id}`},s=>{s.new&&e.setQueryData(["user"],a=>a?{...a,name:s.new.name,specialty:s.new.specialty}:null)}).subscribe();return()=>{o.unsubscribe()}},[t,n==null?void 0:n.id,e]),{user:n,loading:r,error:(i==null?void 0:i.message)||null}}function Y1(t){return typeof t=="object"&&t!==null&&"default_copy_mode"in t&&typeof t.default_copy_mode=="string"}function x7(t,e){switch(e){case"plain":return t.getText();case"rich_text":return t.getHTML();case"without_lists":return t.getText();default:return t.getText()}}const ye={toolbar:{display:"flex",gap:"4px",alignItems:"center"},button:{padding:"8px",backgroundColor:"#f3f4f6",border:"1px solid #e5e7eb",borderRadius:"4px",cursor:"pointer",color:"#6b7280",display:"flex",alignItems:"center",justifyContent:"center",height:"36px",width:"36px",transition:"all 0.2s ease","&:hover:not(:disabled)":{backgroundColor:"#e5e7eb"},"&:disabled":{opacity:.5,cursor:"not-allowed",backgroundColor:"#f3f4f6"}},divider:{width:"1px",height:"24px",backgroundColor:"#e5e7eb",margin:"0 4px"},buttonContainer:{position:"relative"},dropdown:{position:"absolute",top:"calc(100% + 4px)",right:"0",backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"6px",padding:"4px",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)",zIndex:1e3,minWidth:"180px"},dropdownButton:{width:"100%",padding:"8px 12px",border:"none",backgroundColor:"transparent",cursor:"pointer",textAlign:"left",fontSize:"14px",color:"#6b7280",borderRadius:"4px","&:hover":{backgroundColor:"#f3f4f6"}},modal:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",backgroundColor:"white",padding:"24px",borderRadius:"8px",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1)",zIndex:100,width:"400px"},modalOverlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",zIndex:99},modalTitle:{fontSize:"18px",fontWeight:"600",color:"#111827",marginBottom:"16px"},modalText:{fontSize:"14px",color:"#4b5563",marginBottom:"24px",lineHeight:"1.5"},modalButtons:{display:"flex",gap:"8px",justifyContent:"flex-end"},modalButton:{padding:"8px 16px",borderRadius:"6px",fontSize:"14px",fontWeight:"500",cursor:"pointer",border:"1px solid #e5e7eb"},modalButtonPrimary:{backgroundColor:"#ef4444",color:"white",border:"none","&:hover":{backgroundColor:"#dc2626"}},modalButtonSecondary:{backgroundColor:"white",color:"#6b7280","&:hover":{backgroundColor:"#f3f4f6"}},copyButtonGroup:{display:"flex",alignItems:"center",gap:"1px"},copyMainButton:{padding:"8px",backgroundColor:"#f3f4f6",border:"1px solid #e5e7eb",borderRadius:"4px 0 0 4px",cursor:"pointer",color:"#6b7280",display:"flex",alignItems:"center",justifyContent:"center",height:"36px",width:"36px",transition:"all 0.2s ease","&:hover":{backgroundColor:"#e5e7eb"}},copyDropdownButton:{padding:"8px 4px",backgroundColor:"#f3f4f6",border:"1px solid #e5e7eb",borderLeft:"none",borderRadius:"0 4px 4px 0",cursor:"pointer",color:"#6b7280",display:"flex",alignItems:"center",justifyContent:"center",height:"36px",width:"24px",transition:"all 0.2s ease","&:hover":{backgroundColor:"#e5e7eb"}},dropdownContent:{minWidth:"220px",backgroundColor:"white",borderRadius:"6px",padding:"5px",boxShadow:"0px 10px 38px -10px rgba(22, 23, 24, 0.35), 0px 10px 20px -15px rgba(22, 23, 24, 0.2)",zIndex:20},dropdownItem:{fontSize:"14px",lineHeight:"1",color:"#374151",borderRadius:"3px",display:"flex",alignItems:"center",justifyContent:"space-between",height:"32px",padding:"0 8px",userSelect:"none",outline:"none",cursor:"pointer","&:hover":{backgroundColor:"#f3f4f6"}},selectedDropdownItem:{backgroundColor:"#f0f9ff",color:"#2563eb","&:hover":{backgroundColor:"#e0f2fe"}},checkmark:{color:"#2563eb",marginLeft:"8px"},toastViewport:{position:"fixed",bottom:0,right:0,display:"flex",flexDirection:"column",padding:"25px",gap:"10px",width:"390px",listStyle:"none",zIndex:2147483647,outline:"none"},toast:{backgroundColor:"white",borderRadius:"6px",boxShadow:"0 2px 10px rgba(0, 0, 0, 0.1)",padding:"15px",display:"flex",alignItems:"center",justifyContent:"space-between",border:"1px solid #e5e7eb"},toastTitle:{color:"#111827",fontSize:"14px",fontWeight:500,marginBottom:"4px"},toastDescription:{color:"#6b7280",fontSize:"13px"},successIcon:{color:"#10b981",marginRight:"12px"}};function w7({editor:t,previousVersions:e=[],onRevertToPreviousVersion:n,hasUnsavedChanges:r=!1,onSave:i,tabType:o,onRegenerateSoapNote:s,onRegenerateCurrentNote:a}){const l=Be(),{showToast:c}=PO(),{user:u}=zt(),[d,f]=y.useState(!1),[p,m]=y.useState("plain");y.useEffect(()=>{u!=null&&u.note_preferences&&Y1(u.note_preferences)&&m(u.note_preferences.default_copy_mode)},[u==null?void 0:u.note_preferences]);const g=(t==null?void 0:t.can().undo())||e.length>0&&!!n,v=t==null?void 0:t.can().redo(),x=async(E=p)=>{if(t)try{const T=x7(t,E);await navigator.clipboard.writeText(T),c("Copied!",`Content copied as ${E.replace(/_/g," ").toLowerCase()}`,"success")}catch(T){console.error("Failed to copy text:",T),c("Copy Failed","Failed to copy content to clipboard","error")}},w=async E=>{try{if(!(u!=null&&u.id))return;const T=u.note_preferences&&Y1(u.note_preferences)?u.note_preferences:{};await l.from("user_profiles").update({note_preferences:{...T,default_copy_mode:E}}).eq("user_id",u.id),m(E),await x(E)}catch(T){console.error("Failed to update default copy mode:",T),c("Error","Failed to update copy mode","error")}},S=()=>{if(!(!t||!g)){if(t.can().undo()){t.chain().focus().undo().run();return}e.length>0&&n&&f(!0)}},b=async()=>{if(!n||e.length===0)return;const E=e[0];await n(E),f(!1)},C=()=>{r&&i&&(i(),c("Saved!","Your changes have been saved","success"))},k=[{value:"plain",label:"Copy as Plain Text"},{value:"rich_text",label:"Copy as Rich Text"},{value:"without_lists",label:"Copy Without Lists"}];return t?h.jsxs("div",{style:ye.toolbar,children:[h.jsx("button",{onClick:S,disabled:!g,style:{...ye.button,opacity:g?1:.5},title:t!=null&&t.can().undo()?"Undo last change":e.length>0?"Revert to previous version":"Nothing to undo",children:h.jsx(d8,{size:18})}),h.jsx("button",{onClick:()=>t.chain().focus().redo().run(),disabled:!v,style:{...ye.button,opacity:v?1:.5},title:v?"Redo":"Nothing to redo",children:h.jsx(i8,{size:18})}),h.jsx("div",{style:ye.divider}),h.jsx("button",{onClick:C,disabled:!r,style:{...ye.button,...r?{backgroundColor:"#10b981",color:"white",border:"none","&:hover":{backgroundColor:"#059669"}}:{}},title:r?"Save changes":"No unsaved changes",children:h.jsx(a8,{size:18})}),h.jsx("div",{style:ye.divider}),h.jsxs("div",{style:ye.copyButtonGroup,children:[h.jsx("button",{onClick:()=>x(),style:ye.copyMainButton,title:`Copy as ${p.replace(/_/g," ").toUpperCase()}`,children:h.jsx(Qz,{size:18})}),h.jsxs(tl,{children:[h.jsx(nl,{asChild:!0,children:h.jsx("button",{style:ye.copyDropdownButton,title:"Copy Options",children:h.jsx(aR,{size:14})})}),h.jsx(rl,{children:h.jsx(il,{style:ye.dropdownContent,sideOffset:5,children:k.map(E=>{const T=E.value===p;return h.jsxs(Gt,{style:{...ye.dropdownItem,...T?ye.selectedDropdownItem:{}},onClick:()=>w(E.value),children:[E.label,T&&h.jsx("span",{style:ye.checkmark,children:""})]},E.value)})})})]})]}),h.jsx("div",{style:ye.divider}),h.jsxs(tl,{children:[h.jsx(nl,{asChild:!0,children:h.jsx("button",{style:ye.button,title:"More Options",children:h.jsx(Zz,{size:18})})}),h.jsx(rl,{children:h.jsxs(il,{style:ye.dropdownContent,sideOffset:5,children:[h.jsx(Gt,{style:ye.dropdownItem,onClick:()=>x(),children:"Copy All"}),(o==="ai_context"||o==="soap")&&s&&h.jsx(Gt,{style:ye.dropdownItem,onClick:()=>{c("Regenerating","Starting SOAP note regeneration...","success"),s()},children:"Regenerate SOAP Note"}),a&&h.jsx(Gt,{style:ye.dropdownItem,onClick:()=>{c("Regenerating","Starting note regeneration...","success"),a()},children:"Regenerate Current Note"})]})})]}),d&&h.jsxs(h.Fragment,{children:[h.jsx("div",{style:ye.modalOverlay,onClick:()=>f(!1)}),h.jsxs("div",{style:ye.modal,children:[h.jsx("h3",{style:ye.modalTitle,children:"Revert to Previous Version?"}),h.jsx("p",{style:ye.modalText,children:"This will delete your current changes and restore the previous version of this note. This action cannot be undone."}),h.jsxs("div",{style:ye.modalButtons,children:[h.jsx("button",{onClick:()=>f(!1),style:{...ye.modalButton,...ye.modalButtonSecondary},children:"Cancel"}),h.jsx("button",{onClick:b,style:{...ye.modalButton,...ye.modalButtonPrimary},children:"Revert to Previous Version"})]})]})]})]}):null}function Ay(t,e){const n=t.filter(r=>r.type===e);if(n.length)return n.reduce((r,i)=>(i.version_id||0)>(r.version_id||0)?i:r)}function Q1(t,e){var n;return((n=Ay(t,e))==null?void 0:n.content)||""}function b7(t){return[...t].sort((e,n)=>(n.version_id||0)-(e.version_id||0))}function S7(t){const e={soap:[],ai_context:[]};return t.forEach(n=>{n.type==="soap"||n.type==="ai_context"?(e[n.type]||(e[n.type]=[]),e[n.type].push(n)):n.type==="template"&&n.template_id&&(e[n.template_id]||(e[n.template_id]=[]),e[n.template_id].push(n))}),Object.keys(e).forEach(n=>{e[n]=b7(e[n])}),e}function C7({visit:t,notes:e,onRevert:n,handleNoteDeleted:r}){const i=Be(),o=y.useRef(!1),{getValidSessionToken:s}=Hh(),[a,l]=y.useState({noteVersions:{soap:[],ai_context:[]},hasUnsavedChanges:!1,pendingContent:null}),{soapNote:c,aiContext:u,templateNotes:d}=y.useMemo(()=>({soapNote:Q1(e,"soap"),aiContext:Q1(e,"ai_context"),templateNotes:e.filter(C=>C.type==="template")}),[e]);y.useEffect(()=>{const C=S7(e);console.log("[useNoteManager] Versions:",C),l(k=>({...k,noteVersions:C}))},[e]),y.useEffect(()=>{console.log("[useNoteManager] Visit changed, resetting state:",t.id),l({noteVersions:{soap:[],ai_context:[]},hasUnsavedChanges:!1,pendingContent:null})},[t.id]);const f=y.useCallback(C=>{l(k=>({...k,templateNotes:C}))},[]),p=y.useCallback(()=>{l(C=>({...C,hasUnsavedChanges:!1,pendingContent:null}))},[]),m=y.useCallback((C,k,E)=>{var O;console.log("[handleContentChange] Content:",C,k,E);const T=k==="soap"?c:k==="ai_context"?u:(O=d.find(R=>R.id===E))==null?void 0:O.content;l(R=>({...R,pendingContent:C?{content:C,type:k,noteId:E}:null,hasUnsavedChanges:C!==T}))},[c,u,d,e]),g=y.useCallback((C,k)=>{var E,T;return C==="soap"||C==="ai_context"?((E=a.noteVersions[C])==null?void 0:E[0])||null:(console.log("[getCurrentNote] Template ID:",k,a.noteVersions),((T=a.noteVersions[k||""])==null?void 0:T[0])||null)},[a.noteVersions]),v=y.useCallback((C,k)=>{var E;return C==="soap"||C==="ai_context"?((E=a.noteVersions[C])==null?void 0:E.slice(1))||[]:a.noteVersions[k||""]||[]},[a.noteVersions]),x=y.useCallback(async()=>{if(!t.id||!a.pendingContent||o.current)return!1;o.current=!0;const{content:C,type:k,noteId:E}=a.pendingContent;try{if(k==="template"&&E){const T=e.find(R=>R.id===E),O=((T==null?void 0:T.version_id)||0)+1;await i.from("notes").insert({visit_id:t.id,content:C,type:k,template_id:T==null?void 0:T.template_id,metadata:{...T==null?void 0:T.metadata,status:"edited"},version_id:O,user_facing:!0})}else{const T=e.filter(I=>I.type===k),R=(T.length>0?Math.max(...T.map(I=>I.version_id||0)):0)+1;await i.from("notes").insert({visit_id:t.id,content:C,type:k,version_id:R,user_facing:!0})}return p(),!0}catch(T){throw console.error("Error saving note:",T),T}finally{o.current=!1}},[t.id,e,a.pendingContent,i,p]),w=y.useCallback(async C=>{if(!(!t.id||o.current)){o.current=!0;try{console.log("[revertToPreviousVersion] Deleting note:",C.type,C.template_id);const k=g(C.type,C.template_id||void 0);if(k){console.log("[useNoteManager] Deleting note:",k.id);const{error:E,data:T}=await i.from("notes").delete().eq("id",k.id).select();if(E)throw console.error("[useNoteManager] Error deleting note:",E),E;console.log("[useNoteManager] Delete operation successful, deleted data:",T),r&&k.id&&(console.log("[useNoteManager] Triggering manual note deletion for:",k.id),r(k.id))}else console.log("[useNoteManager] No current note found to delete");l(E=>({...E,hasUnsavedChanges:!1,pendingContent:null})),n==null||n()}catch(k){console.error("[useNoteManager] Error reverting to previous version:",k)}finally{o.current=!1}}},[t.id,i,g,n,r]),S=y.useCallback(async()=>{var C;try{const k=await s(),E=(C=g("soap",""))==null?void 0:C.id;console.log("[regenerateSoapNote] Attempting to regenerate SOAP note with ID:",E);const T=`${Tr.apiUrl}/notes/${E}/regenerate-soap`;console.log("[regenerateSoapNote] Calling endpoint:",T);const O=await fetch(T,{method:"POST",headers:{Authorization:`Bearer ${k}`,"Content-Type":"application/json"}});if(!O.ok){console.error("[regenerateSoapNote] Error response:",O.status,O.statusText);const I=await O.text();throw console.error("[regenerateSoapNote] Error details:",I),new Error(`Failed to regenerate SOAP note: ${O.status} ${O.statusText}`)}const R=await O.json();console.log("[regenerateSoapNote] Successfully regenerated note:",R.id),l(I=>({...I,hasUnsavedChanges:!1,pendingContent:{content:R.content,type:"soap"}})),n==null||n()}catch(k){console.error("Error regenerating SOAP note:",k)}},[g,n]),b=y.useCallback(async C=>{try{const k=await s(),E=`${Tr.apiUrl}/notes/${C}/regenerate-template`;console.log("[regenerateTemplateNote] Calling endpoint:",E);const T=await fetch(E,{method:"POST",headers:{Authorization:`Bearer ${k}`,"Content-Type":"application/json"}});if(!T.ok)throw new Error("Failed to regenerate template note");const O=await T.json();l(R=>({...R,hasUnsavedChanges:!1,pendingContent:{content:O.content,type:"template",noteId:C}})),n==null||n()}catch(k){console.error("Error regenerating template note:",k)}},[n]);return{hasUnsavedChanges:a.hasUnsavedChanges,handleContentChange:m,saveNote:x,revertToPreviousVersion:w,getCurrentNote:g,getPreviousVersions:v,updateTemplateNotes:f,resetState:p,regenerateSoapNote:S,regenerateTemplateNote:b}}const Al={container:{display:"flex",flexDirection:"column",gap:"0px",height:"100%",overflow:"hidden"},transcriptPanel:{flex:1,display:"flex",flexDirection:"column",backgroundColor:"white",border:"1px solid #e5e7eb",borderTop:"none",borderBottomLeftRadius:"6px",borderBottomRightRadius:"6px",padding:"16px",overflow:"hidden",minHeight:0},text:{fontSize:"16px",color:"#374151",lineHeight:"1.5",whiteSpace:"pre-wrap",margin:0,overflow:"auto",flex:1},contentContainer:{flex:1,display:"flex",flexDirection:"column",minHeight:0,height:"100%",overflow:"hidden",gap:"16px"},toolbarSection:{display:"flex",alignItems:"center",justifyContent:"flex-start",gap:"8px",flexShrink:0}};function k7({visit:t,notes:e,handleNoteDeleted:n}){console.log("[ReadyTranscriptionDisplay] Rendering with visit:",{id:t.id,state:t.state}),console.log("[ReadyTranscriptionDisplay] Received notes count:",e.length);const[r,i]=y.useState("transcript"),[o,s]=y.useState(!1),[a,l]=y.useState(null),[c,u]=y.useState(0),{snippets:d}=oR(),[f,p]=y.useState("");y.useEffect(()=>{i("transcript"),u(G=>G+1)},[t.id]),y.useEffect(()=>{(async()=>{if(t.id)try{const{data:Z,error:xe}=await pn.from("transcripts").select("full_text").eq("visit_id",t.id).single();if(xe){console.error("Error loading transcript:",xe);return}p((Z==null?void 0:Z.full_text)||"")}catch(Z){console.error("Error loading transcript:",Z)}})()},[t.id]);const m=y.useCallback(()=>{u(G=>G+1)},[]),{hasUnsavedChanges:g,handleContentChange:v,saveNote:x,revertToPreviousVersion:w,getCurrentNote:S,getPreviousVersions:b,updateTemplateNotes:C,resetState:k,regenerateSoapNote:E,regenerateTemplateNote:T}=C7({visit:t,notes:e,onRevert:m,handleNoteDeleted:n}),O=y.useCallback((G,Z)=>{C(Z),i(G),s(!1)},[C]),{generateFromTemplate:R,isGenerating:I}=Fz({visitId:t.id,onSuccess:O}),$=y.useCallback(G=>{g&&!window.confirm("You have unsaved changes. Are you sure you want to switch tabs? Your changes will be lost.")||(i(G),u(Z=>Z+1),k())},[g,k]),P=y.useCallback(async()=>{await x()&&u(Z=>Z+1)},[x]),M=y.useCallback(()=>{if(g){if(!window.confirm("You have unsaved changes. Are you sure you want to create a new template? Your changes will be lost."))return;k()}s(!0)},[g,k]),z=y.useCallback(()=>{s(!1)},[]),B=y.useMemo(()=>e.filter((G,Z,xe)=>Z===xe.findIndex(we=>we.template_id===G.template_id)).map(G=>G.template_id).filter(G=>G!==null),[e]),H=y.useCallback(async()=>{g&&await x(),await E()},[g,x,E]),A=y.useCallback(async()=>{g&&await x();const G=S("template",r);G&&await T(G.id)},[g,x,T,S,r]),D=Ay(e,"soap"),L=Ay(e,"ai_context"),Y=e.filter(G=>G.type==="template"),ee=()=>{if(r==="transcript")return h.jsx("p",{style:Al.text,children:f});if(r==="soap")return h.jsx(dm,{content:(D==null?void 0:D.content)||"",readOnly:!1,placeholder:"Start typing your SOAP note...",onChange:Z=>v(Z,"soap"),snippets:d,onEditorReady:l},`soap-editor-${c}`);if(r==="ai_context")return h.jsx(dm,{content:(L==null?void 0:L.content)||"",readOnly:!1,placeholder:"Start typing your context note...",onChange:Z=>v(Z,"ai_context"),snippets:d,onEditorReady:l},`ai_context-${c}`);const G=e.filter(Z=>Z.template_id===r).sort((Z,xe)=>(xe.version_id||0)-(Z.version_id||0))[0];return h.jsx(dm,{content:(G==null?void 0:G.content)||"",readOnly:!1,placeholder:"Start typing your template note...",onChange:Z=>v(Z,"template",G==null?void 0:G.id),snippets:d,onEditorReady:l},`template-${G==null?void 0:G.id}-${c}`)};return h.jsxs("div",{style:Al.container,children:[h.jsx($z,{activeTab:r,setActiveTab:$,aiContextVersion:L==null?void 0:L.version_id,soapNoteVersion:D==null?void 0:D.version_id,templateNotes:Y,onOpenTemplateModal:M}),h.jsx("div",{style:Al.transcriptPanel,children:h.jsxs("div",{style:Al.contentContainer,children:[a&&r!=="transcript"&&h.jsx("div",{style:Al.toolbarSection,children:h.jsx(w7,{editor:a,previousVersions:b(r!=="soap"&&r!=="ai_context"?"template":r,r!=="soap"&&r!=="ai_context"?r:void 0),onRevertToPreviousVersion:w,hasUnsavedChanges:g,onSave:P,tabType:r,onRegenerateSoapNote:H,onRegenerateCurrentNote:r!=="soap"&&r!=="ai_context"&&r!=="transcript"?A:void 0})}),ee()]})}),h.jsx(qN,{isOpen:o,onClose:z,onGenerate:R,existingTemplateIds:B})]})}const Sd=(...t)=>{};function E7({visitId:t,onMessage:e}){const[n,r]=y.useState([]),i=y.useRef(!1),o=y.useRef(null),s=y.useCallback(async()=>{if(!t||t==="")return;const{data:a,error:l}=await pn.from("containers").select("*").eq("visit_id",t).order("chunk_id",{ascending:!0});l||a&&(Sd(`Fetched ${a.length} containers`),r(a),i.current=!0,a.forEach(c=>e==null?void 0:e(c)))},[t,e]);return y.useEffect(()=>{if(!t||t===""){r([]),i.current=!1;return}i.current||s(),o.current&&(o.current.unsubscribe(),o.current=null);const a=pn.channel(`containers_list_${t}`).on("postgres_changes",{event:"*",schema:"public",table:"containers",filter:`visit_id=eq.${t}`},l=>{switch(Sd("Received realtime event:",l.eventType,l),l.eventType){case Ki.INSERT:{const c=l.new;r(u=>{if(u.some(f=>f.id===c.id))return u;const d=[...u,c].sort((f,p)=>f.chunk_id-p.chunk_id);return e==null||e(c),d});break}case Ki.UPDATE:{const c=l.new;r(u=>{const d=u.map(f=>f.id===c.id?c:f);return JSON.stringify(d)===JSON.stringify(u)?u:(e==null||e(c),d)});break}case Ki.DELETE:{const c=l.old;r(u=>{const d=u.filter(f=>f.id!==c.id);return d.length,u.length,d});break}default:Sd("Unhandled event type:",l.eventType);break}}).subscribe(l=>{});return o.current=a,()=>{a.unsubscribe(),o.current=null}},[t,s,e]),y.useEffect(()=>{Sd("Containers state updated:",n.length,"containers")},[n]),n}var sx="Popover",[MO,tW]=yo(sx,[Gh]),Ru=Gh(),[T7,vo]=MO(sx),AO=t=>{const{__scopePopover:e,children:n,open:r,defaultOpen:i,onOpenChange:o,modal:s=!1}=t,a=Ru(e),l=y.useRef(null),[c,u]=y.useState(!1),[d=!1,f]=Su({prop:r,defaultProp:i,onChange:o});return h.jsx(PR,{...a,children:h.jsx(T7,{scope:e,contentId:rs(),triggerRef:l,open:d,onOpenChange:f,onOpenToggle:y.useCallback(()=>f(p=>!p),[f]),hasCustomAnchor:c,onCustomAnchorAdd:y.useCallback(()=>u(!0),[]),onCustomAnchorRemove:y.useCallback(()=>u(!1),[]),modal:s,children:n})})};AO.displayName=sx;var DO="PopoverAnchor",_7=y.forwardRef((t,e)=>{const{__scopePopover:n,...r}=t,i=vo(DO,n),o=Ru(n),{onCustomAnchorAdd:s,onCustomAnchorRemove:a}=i;return y.useEffect(()=>(s(),()=>a()),[s,a]),h.jsx(q0,{...o,...r,ref:e})});_7.displayName=DO;var IO="PopoverTrigger",NO=y.forwardRef((t,e)=>{const{__scopePopover:n,...r}=t,i=vo(IO,n),o=Ru(n),s=He(e,i.triggerRef),a=h.jsx(ge.button,{type:"button","aria-haspopup":"dialog","aria-expanded":i.open,"aria-controls":i.contentId,"data-state":BO(i.open),...r,ref:s,onClick:Q(t.onClick,i.onOpenToggle)});return i.hasCustomAnchor?a:h.jsx(q0,{asChild:!0,...o,children:a})});NO.displayName=IO;var ax="PopoverPortal",[R7,O7]=MO(ax,{forceMount:void 0}),jO=t=>{const{__scopePopover:e,forceMount:n,children:r,container:i}=t,o=vo(ax,e);return h.jsx(R7,{scope:e,forceMount:n,children:h.jsx(lr,{present:n||o.open,children:h.jsx(ku,{asChild:!0,container:i,children:r})})})};jO.displayName=ax;var ol="PopoverContent",LO=y.forwardRef((t,e)=>{const n=O7(ol,t.__scopePopover),{forceMount:r=n.forceMount,...i}=t,o=vo(ol,t.__scopePopover);return h.jsx(lr,{present:r||o.open,children:o.modal?h.jsx(P7,{...i,ref:e}):h.jsx(M7,{...i,ref:e})})});LO.displayName=ol;var P7=y.forwardRef((t,e)=>{const n=vo(ol,t.__scopePopover),r=y.useRef(null),i=He(e,r),o=y.useRef(!1);return y.useEffect(()=>{const s=r.current;if(s)return A0(s)},[]),h.jsx(M0,{as:vs,allowPinchZoom:!0,children:h.jsx($O,{...t,ref:i,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Q(t.onCloseAutoFocus,s=>{var a;s.preventDefault(),o.current||(a=n.triggerRef.current)==null||a.focus()}),onPointerDownOutside:Q(t.onPointerDownOutside,s=>{const a=s.detail.originalEvent,l=a.button===0&&a.ctrlKey===!0,c=a.button===2||l;o.current=c},{checkForDefaultPrevented:!1}),onFocusOutside:Q(t.onFocusOutside,s=>s.preventDefault(),{checkForDefaultPrevented:!1})})})}),M7=y.forwardRef((t,e)=>{const n=vo(ol,t.__scopePopover),r=y.useRef(!1),i=y.useRef(!1);return h.jsx($O,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:o=>{var s,a;(s=t.onCloseAutoFocus)==null||s.call(t,o),o.defaultPrevented||(r.current||(a=n.triggerRef.current)==null||a.focus(),o.preventDefault()),r.current=!1,i.current=!1},onInteractOutside:o=>{var l,c;(l=t.onInteractOutside)==null||l.call(t,o),o.defaultPrevented||(r.current=!0,o.detail.originalEvent.type==="pointerdown"&&(i.current=!0));const s=o.target;((c=n.triggerRef.current)==null?void 0:c.contains(s))&&o.preventDefault(),o.detail.originalEvent.type==="focusin"&&i.current&&o.preventDefault()}})}),$O=y.forwardRef((t,e)=>{const{__scopePopover:n,trapFocus:r,onOpenAutoFocus:i,onCloseAutoFocus:o,disableOutsidePointerEvents:s,onEscapeKeyDown:a,onPointerDownOutside:l,onFocusOutside:c,onInteractOutside:u,...d}=t,f=vo(ol,n),p=Ru(n);return P0(),h.jsx(Uh,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:i,onUnmountAutoFocus:o,children:h.jsx(Cu,{asChild:!0,disableOutsidePointerEvents:s,onInteractOutside:u,onEscapeKeyDown:a,onPointerDownOutside:l,onFocusOutside:c,onDismiss:()=>f.onOpenChange(!1),children:h.jsx(MR,{"data-state":BO(f.open),role:"dialog",id:f.contentId,...p,...d,ref:e,style:{...d.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),FO="PopoverClose",A7=y.forwardRef((t,e)=>{const{__scopePopover:n,...r}=t,i=vo(FO,n);return h.jsx(ge.button,{type:"button",...r,ref:e,onClick:Q(t.onClick,()=>i.onOpenChange(!1))})});A7.displayName=FO;var D7="PopoverArrow",I7=y.forwardRef((t,e)=>{const{__scopePopover:n,...r}=t,i=Ru(n);return h.jsx(AR,{...i,...r,ref:e})});I7.displayName=D7;function BO(t){return t?"open":"closed"}var N7=AO,j7=NO,L7=jO,$7=LO;async function F7(t,e){const{data:n,error:r}=await t.from("visits").insert([{state:"recording",user_id:e.userId,name:e.name,patient_id:e.patientId,started_at:new Date().toISOString(),ended_at:null,updated_at:new Date().toISOString()}]).select().single();if(r)throw r;return n}async function Vl(t,e,n,r){const i={state:n,updated_at:new Date().toISOString()};r&&(i.ended_at=new Date().toISOString());const{error:o}=await t.from("visits").update(i).eq("id",e);if(o)throw o}async function B7(t,e,n){console.log("Updating visit name:",e,n);const{error:r}=await t.from("visits").update({name:n,updated_at:new Date().toISOString()}).eq("id",e);if(r)throw r}const _e={container:{position:"relative",width:"100%",maxWidth:"400px"},inputContainer:{display:"flex",alignItems:"center",gap:"8px",width:"100%"},selectedContainer:{display:"flex",alignItems:"center",gap:"8px",width:"100%",padding:"8px 12px",fontSize:"16px",border:"1px solid #e5e7eb",borderRadius:"6px",backgroundColor:"#f9fafb"},selectedName:{flex:1,fontWeight:"500",color:"#1f2937"},unlinkButton:{display:"flex",alignItems:"center",padding:"4px",border:"none",borderRadius:"4px",backgroundColor:"transparent",color:"#6b7280",cursor:"pointer","&:hover":{backgroundColor:"#f3f4f6",color:"#dc2626"}},input:{width:"100%",padding:"8px 12px",fontSize:"16px",border:"1px solid #e5e7eb",borderRadius:"6px",outline:"none","&:focus":{borderColor:"#3b82f6",boxShadow:"0 0 0 2px rgba(59, 130, 246, 0.1)"}},popoverContent:{backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"6px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)",marginTop:"4px",width:"300px",minHeight:"100px",maxHeight:"300px",overflow:"auto",zIndex:50,padding:"8px 0"},section:{padding:"0"},sectionTitle:{padding:"4px 16px",fontSize:"12px",fontWeight:"500",color:"#6b7280",textTransform:"uppercase"},item:{padding:"8px 16px",cursor:"pointer",outline:"none",width:"100%",border:"none",backgroundColor:"transparent",textAlign:"left","&:hover":{backgroundColor:"#f3f4f6"},"&:focus":{backgroundColor:"#f3f4f6"}},createButton:{display:"flex",alignItems:"center",gap:"8px",width:"100%",padding:"8px 16px",backgroundColor:"#f9fafb",border:"none",borderRadius:"0",cursor:"pointer",fontSize:"14px",color:"#1f2937","&:hover":{backgroundColor:"#f3f4f6"}},patientName:{fontSize:"14px",fontWeight:"500",color:"#1f2937"},patientMrn:{fontSize:"12px",color:"#6b7280"},separator:{height:"1px",backgroundColor:"#e5e7eb",margin:"4px 0"},loadingItem:{padding:"8px 16px",height:"38px",backgroundColor:"#f9fafb",borderRadius:"4px",margin:"4px 0",animation:"pulse 1.5s ease-in-out infinite"},placeholderContainer:{padding:"4px 0"}};function z7({onPatientSelect:t,onVisitNameChange:e,selectedPatientId:n,visitId:r}){const[i,o]=y.useState(""),[s,a]=y.useState(!1),l=R0(i,300),{user:c}=zt(),u=Be(),d=y.useRef(null),f=uo(),[p,m]=y.useState(!1),{data:g=[],isLoading:v}=_c({queryKey:["patients",c==null?void 0:c.id,l],queryFn:async()=>{if(!(c!=null&&c.id))return[];const{data:P,error:M}=await u.rpc("search_patients",{search_term:l||"",user_id_param:c.id});if(M)throw M;return P||[]},enabled:!!(c!=null&&c.id)}),{data:x}=_c({queryKey:["patient",n],queryFn:async()=>{if(!n)return null;const{data:P,error:M}=await u.from("patient_profiles").select("id, name, medical_record_number").eq("id",n).single();if(M)throw M;return P},enabled:!!n}),w=Rc({mutationFn:async P=>{if(!(c!=null&&c.id))throw new Error("No user");const{data:M,error:z}=await u.from("patient_profiles").insert([{name:P.trim(),user_id:c.id}]).select().single();if(z)throw z;return M},onSuccess:P=>{f.invalidateQueries({queryKey:["patients"]}),C(P)}}),S=Rc({mutationFn:async({visitId:P,name:M})=>{if(!P)throw new Error("No visit ID provided");await B7(u,P,M)},onSuccess:(P,M)=>{f.invalidateQueries({queryKey:["visit",M.visitId]})}}),b=l?g:g.slice(0,3),C=P=>{o(P.name),a(!1),t(P),e==null||e(null)},k=async()=>{!i.trim()||!(c!=null&&c.id)||w.mutate(i)},E=P=>{const M=P.target.value;o(M)},T=P=>{if(P.key==="Enter"&&i.trim()){console.log("handleInputKeyDown",r,i),P.preventDefault();const M=i.trim();t(null),e==null||e(M),o(M),m(!0),a(!1),r&&(console.log("handleInputKeyDown here?",r,M),S.mutate({visitId:r,name:M}))}},O=()=>{o(""),m(!1),t(null),e==null||e(null),r&&S.mutate({visitId:r,name:null})};ve.useEffect(()=>{(async()=>{if(n){const{data:M}=await u.from("patient_profiles").select("name").eq("id",n).single();M&&o(M.name)}else if(r){const{data:M}=await u.from("visits").select("name").eq("id",r).single();M!=null&&M.name&&o(M.name)}})()},[n,r,u]),ve.useEffect(()=>{!r&&!n&&(o(""),m(!1),a(!1))},[r,n]);const R=x||p||r&&i&&!s,I=(P,M)=>h.jsxs("button",{style:_e.item,onClick:M,children:[h.jsx("div",{style:_e.patientName,children:P.name}),P.medical_record_number&&h.jsxs("div",{style:_e.patientMrn,children:["MRN: ",P.medical_record_number]})]},P.id),$=()=>h.jsxs("div",{style:_e.placeholderContainer,children:[h.jsx("div",{style:{..._e.loadingItem,marginLeft:"16px",marginRight:"16px"}}),h.jsx("div",{style:{..._e.loadingItem,marginLeft:"16px",marginRight:"16px"}}),h.jsx("div",{style:{..._e.loadingItem,marginLeft:"16px",marginRight:"16px"}})]});return R?h.jsx("div",{style:_e.container,children:h.jsxs("div",{style:_e.selectedContainer,onClick:()=>{a(!0),m(!1),setTimeout(()=>{var P;return(P=d.current)==null?void 0:P.focus()},0)},children:[h.jsx("div",{style:_e.selectedName,children:(x==null?void 0:x.name)||i}),h.jsx("button",{style:_e.unlinkButton,onClick:P=>{P.stopPropagation(),O()},title:"Unlink patient",children:h.jsx(Uc,{})})]})}):h.jsx("div",{style:_e.container,children:h.jsxs(N7,{modal:!1,open:s,onOpenChange:a,children:[h.jsx(j7,{asChild:!0,children:h.jsx("div",{style:_e.inputContainer,children:h.jsx("input",{ref:d,type:"text",value:i,onChange:E,onKeyDown:T,onFocus:()=>a(!0),onClick:P=>{P.stopPropagation(),a(!0),P.currentTarget.focus()},placeholder:"Add patient details",style:_e.input})})}),h.jsx(L7,{children:h.jsx($7,{style:_e.popoverContent,align:"start",sideOffset:4,onEscapeKeyDown:()=>a(!1),onInteractOutside:P=>{var z;const M=P.target;if((z=d.current)!=null&&z.contains(M)){P.preventDefault();return}a(!1)},children:v?h.jsxs(h.Fragment,{children:[h.jsxs("div",{style:_e.section,children:[h.jsx("div",{style:_e.sectionTitle,children:"Suggested"}),$()]}),h.jsx("div",{style:_e.separator}),h.jsxs("button",{style:{..._e.createButton,opacity:.5},disabled:!0,children:[h.jsx(Vc,{}),"Create new patient"]})]}):h.jsxs(h.Fragment,{children:[h.jsxs("div",{style:_e.section,children:[h.jsx("div",{style:_e.sectionTitle,children:"Suggested"}),h.jsx("div",{style:_e.placeholderContainer,children:b.length>0?b.map(P=>I(P,()=>C(P))):h.jsx("div",{style:_e.item,children:"No matches found"})})]}),h.jsx("div",{style:_e.separator}),h.jsxs("button",{style:_e.createButton,onClick:k,disabled:w.isPending||!i.trim(),children:[h.jsx(Vc,{}),w.isPending?"Creating...":i.trim()?`Create new patient "${i}"`:"Create new patient"]})]})})})]})})}const Dy=(t,e)=>e.some(n=>t instanceof n);let X1,Z1;function U7(){return X1||(X1=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function V7(){return Z1||(Z1=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Iy=new WeakMap,Cm=new WeakMap,ep=new WeakMap;function H7(t){const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("success",o),t.removeEventListener("error",s)},o=()=>{n(is(t.result)),i()},s=()=>{r(t.error),i()};t.addEventListener("success",o),t.addEventListener("error",s)});return ep.set(e,t),e}function W7(t){if(Iy.has(t))return;const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("complete",o),t.removeEventListener("error",s),t.removeEventListener("abort",s)},o=()=>{n(),i()},s=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",o),t.addEventListener("error",s),t.addEventListener("abort",s)});Iy.set(t,e)}let Ny={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Iy.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return is(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function zO(t){Ny=t(Ny)}function K7(t){return V7().includes(t)?function(...e){return t.apply(jy(this),e),is(this.request)}:function(...e){return is(t.apply(jy(this),e))}}function q7(t){return typeof t=="function"?K7(t):(t instanceof IDBTransaction&&W7(t),Dy(t,U7())?new Proxy(t,Ny):t)}function is(t){if(t instanceof IDBRequest)return H7(t);if(Cm.has(t))return Cm.get(t);const e=q7(t);return e!==t&&(Cm.set(t,e),ep.set(e,t)),e}const jy=t=>ep.get(t);function G7(t,e,{blocked:n,upgrade:r,blocking:i,terminated:o}={}){const s=indexedDB.open(t,e),a=is(s);return r&&s.addEventListener("upgradeneeded",l=>{r(is(s.result),l.oldVersion,l.newVersion,is(s.transaction),l)}),n&&s.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),a.then(l=>{o&&l.addEventListener("close",()=>o()),i&&l.addEventListener("versionchange",c=>i(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}const J7=["get","getKey","getAll","getAllKeys","count"],Y7=["put","add","delete","clear"],km=new Map;function eS(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(km.get(e))return km.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=Y7.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||J7.includes(n)))return;const o=async function(s,...a){const l=this.transaction(s,i?"readwrite":"readonly");let c=l.store;return r&&(c=c.index(a.shift())),(await Promise.all([c[n](...a),i&&l.done]))[0]};return km.set(e,o),o}zO(t=>({...t,get:(e,n,r)=>eS(e,n)||t.get(e,n,r),has:(e,n)=>!!eS(e,n)||t.has(e,n)}));const Q7=["continue","continuePrimaryKey","advance"],tS={},Ly=new WeakMap,UO=new WeakMap,X7={get(t,e){if(!Q7.includes(e))return t[e];let n=tS[e];return n||(n=tS[e]=function(...r){Ly.set(this,UO.get(this)[e](...r))}),n}};async function*Z7(...t){let e=this;if(e instanceof IDBCursor||(e=await e.openCursor(...t)),!e)return;e=e;const n=new Proxy(e,X7);for(UO.set(n,e),ep.set(n,jy(e));e;)yield n,e=await(Ly.get(n)||e.continue()),Ly.delete(n)}function nS(t,e){return e===Symbol.asyncIterator&&Dy(t,[IDBIndex,IDBObjectStore,IDBCursor])||e==="iterate"&&Dy(t,[IDBIndex,IDBObjectStore])}zO(t=>({...t,get(e,n,r){return nS(e,n)?Z7:t.get(e,n,r)},has(e,n){return nS(e,n)||t.has(e,n)}}));class eH{constructor(){this.db=null,this.DB_NAME="audio-recorder-db",this.STORE_NAME="audio-chunks",this.SYNC_STORE="chunk-sync-metadata",this.DB_VERSION=1}async initialize(){this.db||(this.db=await G7(this.DB_NAME,this.DB_VERSION,{upgrade(e){e.objectStoreNames.contains("audio-chunks")||e.createObjectStore("audio-chunks",{keyPath:["visitId","containerIndex","chunkId"]}).createIndex("by-visit","visitId"),e.objectStoreNames.contains("chunk-sync-metadata")||e.createObjectStore("chunk-sync-metadata",{keyPath:"key"}).createIndex("by-visit","visitId")}}))}async getDb(){return this.db||await this.initialize(),this.db}async storeChunk(e){this.db||await this.initialize(),console.log(` Storing chunk ${e.containerIndex}:${e.chunkId} (${(e.blob.size/1024).toFixed(1)}KB)`),await this.db.put(this.STORE_NAME,e)}async getChunk(e,n,r){return this.db||await this.initialize(),this.db.get(this.STORE_NAME,[e,n,r])}async getChunksByVisit(e){return this.db||await this.initialize(),this.db.getAllFromIndex(this.STORE_NAME,"by-visit",e)}async deleteChunksByVisit(e){this.db||await this.initialize();const n=await this.getChunksByVisit(e),r=this.db.transaction(this.STORE_NAME,"readwrite");await Promise.all(n.map(i=>r.store.delete([i.visitId,i.containerIndex,i.chunkId]))),await r.done}async deleteChunk(e,n,r){this.db||await this.initialize();const i=this.db.transaction(this.STORE_NAME,"readwrite");if(r!==void 0)await i.store.delete([e,n,r]);else{const o=await this.getChunksByVisit(e);await Promise.all(o.filter(s=>s.containerIndex===n).map(s=>i.store.delete([s.visitId,s.containerIndex,s.chunkId])))}await i.done}async getDatabaseStats(){try{this.db||await this.initialize();const r=await this.db.transaction(this.STORE_NAME).objectStore(this.STORE_NAME).getAll(),i={};r.forEach(s=>{i[s.visitId]||(i[s.visitId]={chunks:0,size:0,containers:new Set}),i[s.visitId].chunks++,i[s.visitId].size+=s.blob.size,i[s.visitId].containers.add(s.containerIndex)});const o={totalChunks:r.length,totalVisits:Object.keys(i).length,totalSize:r.reduce((s,a)=>s+a.blob.size,0),visitStats:Object.entries(i).reduce((s,[a,l])=>({...s,[a]:{chunks:l.chunks,size:l.size,containers:l.containers.size}}),{})};return console.log("[AudioStorage] Database stats:",o),o}catch(e){throw console.error("[AudioStorage] Failed to get database stats:",e),e}}}const Io=new eH,tp=class ln{constructor(){this.isSyncing=!1,this.syncPromise=null}async getUnuploadedChunks(){return(await Io.getDb()).transaction(ln.SYNC_STORE).objectStore(ln.SYNC_STORE).getAll()}async markChunkForUpload(e){await(await Io.getDb()).transaction(ln.SYNC_STORE,"readwrite").objectStore(ln.SYNC_STORE).put({...e,uploadAttempts:0,lastAttempt:Date.now()})}async markChunkAsUploaded(e){await(await Io.getDb()).transaction(ln.SYNC_STORE,"readwrite").objectStore(ln.SYNC_STORE).delete(e)}async updateUploadAttempt(e){await(await Io.getDb()).transaction(ln.SYNC_STORE,"readwrite").objectStore(ln.SYNC_STORE).put({...e,uploadAttempts:e.uploadAttempts+1,lastAttempt:Date.now()})}async uploadChunk(e,n){console.log(` Uploading container ${e.containerIndex} (${(e.blob.size/1024).toFixed(1)}KB)`);try{const r=e.blob.type.includes("mp4")?"mp4":"webm",i={key:`audio-chunks/${e.visitId}/${e.containerIndex}-${e.chunkId}-${e.timestamp}.${r}`,contentType:e.blob.type,visitId:e.visitId,chunkId:e.chunkId,isFinal:e.isFinal,containerIndex:e.containerIndex},o=await fetch(`${Tr.apiUrl}/get-upload-url`,{method:"POST",headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json"},body:JSON.stringify(i)});if(!o.ok)throw new Error(`Failed to get upload URL: ${o.status}`);const{uploadUrl:s,fields:a}=await o.json(),l=new FormData;if(Object.entries(a).forEach(([f,p])=>{l.append(f,p)}),l.append("file",e.blob),!(await fetch(s,{method:"POST",body:l})).ok)throw new Error("Failed to upload to S3");const u=await fetch(`${Tr.apiUrl}/process-audio`,{method:"POST",headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json"},body:JSON.stringify({key:i.key,visitId:e.visitId,chunkId:e.chunkId,isFinal:e.isFinal,contentType:e.blob.type,containerIndex:e.containerIndex})});if(!u.ok)throw new Error(`Failed to process audio: ${u.status}`);if(!(await u.json()).success)throw new Error("Processing failed");return console.log(` Uploaded container ${e.containerIndex}`),!0}catch(r){return console.error(` Failed to upload container ${e.containerIndex}:`,r),!1}}async syncChunks(e){return this.isSyncing?this.syncPromise||Promise.resolve():(this.isSyncing=!0,this.syncPromise=(async()=>{try{const n=await this.getUnuploadedChunks();for(const r of n){if(r.uploadAttempts>=ln.MAX_RETRIES){console.log(` Skipping container ${r.containerIndex} (max retries reached)`);continue}const i=await Io.getChunk(r.visitId,r.containerIndex,r.chunkId);if(!i){console.warn(` Container ${r.containerIndex} not found in storage`);continue}await this.uploadChunk(i,e)?await this.markChunkAsUploaded(r.key):(await this.updateUploadAttempt(r),console.log(` Will retry container ${r.containerIndex} later (attempt ${r.uploadAttempts+1}/${ln.MAX_RETRIES})`)),await new Promise(s=>setTimeout(s,ln.RETRY_DELAY))}}finally{this.isSyncing=!1,this.syncPromise=null}})(),this.syncPromise)}async markForUpload(e){const n=e.blob.type.includes("mp4")?"mp4":"webm",r={key:`audio-chunks/${e.visitId}/${e.containerIndex}-${e.chunkId}-${e.timestamp}.${n}`,visitId:e.visitId,chunkId:e.chunkId,containerIndex:e.containerIndex,isFinal:e.isFinal,contentType:e.blob.type};await this.markChunkForUpload(r)}async getSyncStats(){const n=(await this.getUnuploadedChunks()).reduce((r,i)=>{if(r.visitStats[i.visitId]||(r.visitStats[i.visitId]={pending:0,failed:0,lastAttempt:null}),i.uploadAttempts>=ln.MAX_RETRIES?(r.failedUploads++,r.visitStats[i.visitId].failed++):(r.pendingUploads++,r.visitStats[i.visitId].pending++),i.lastAttempt){const o=new Date(i.lastAttempt).toISOString();(!r.visitStats[i.visitId].lastAttempt||o>r.visitStats[i.visitId].lastAttempt)&&(r.visitStats[i.visitId].lastAttempt=o)}return r},{pendingUploads:0,failedUploads:0,visitStats:{}});return console.log("[ChunkSyncManager] Sync stats:",n),n}};tp.SYNC_STORE="chunk-sync-metadata";tp.MAX_RETRIES=3;tp.RETRY_DELAY=5e3;let tH=tp;function VO(){const t=["audio/webm;codecs=opus","audio/webm","audio/mp4;codecs=mp4a","audio/mp4","audio/mpeg"];for(const e of t)if(MediaRecorder.isTypeSupported(e))return console.log(`[MediaRecorder] Using MIME type: ${e}`),e;throw new Error("No supported MIME type found for MediaRecorder")}class nH{constructor(e){this.mediaRecorder=null,this.stream=null,this.isRecording=!1,this.isPaused=!1,this.currentChunkId=0,this.currentContainerIndex=0,this.chunkBatch=[],this.containerChunks=[],this.CHUNK_DURATION=2e3,this.BATCH_SIZE=5,this.CONTAINER_DURATION=2e4,this.containerStartTime=null,this.containerTimer=null,this.visitId=null,this.config={saveLocally:!0,...e},this.syncManager=new tH,this.visitId=e.visitId||null}async saveChunkLocally(e,n,r,i=!1){if(!this.config.saveLocally)return;const o=URL.createObjectURL(e),s=document.createElement("a");s.href=o;const a=i?"container":"chunk",l=e.type.includes("mp4")?"mp4":"webm";s.download=`${a}_${this.config.visitId||"debug"}_${this.currentContainerIndex}_${n}${r?"_final":""}.${l}`,s.click(),URL.revokeObjectURL(o),console.log(`[RecorderV3] Saved ${a} locally: ${s.download}, size: ${e.size} bytes`)}async initialize(e){try{this.stream&&this.cleanup();const n={sampleRate:16e3,channelCount:1,autoGainControl:!0,deviceId:e||void 0};this.stream=await navigator.mediaDevices.getUserMedia({audio:n}),console.log("[RecorderV3] Initialized with device:",e||"default")}catch(n){throw console.error("[RecorderV3] Initialization failed:",n),this.cleanup(),n}}async flushChunks(e=!1){if(this.chunkBatch.length===0)return;const n=new Blob(this.chunkBatch,{type:"audio/webm;codecs=opus"}),r=Date.now();console.log("[RecorderV3] Flushing chunks:",{batchSize:this.chunkBatch.length,totalSize:n.size,containerIndex:this.currentContainerIndex,isFinal:e});try{this.containerChunks.push(n);const i={blob:n,timestamp:r,chunkId:this.currentChunkId,visitId:this.visitId,isFinal:e,containerIndex:this.currentContainerIndex};await Io.storeChunk(i),console.log(`[RecorderV3] Stored chunk in IndexedDB: ${this.currentChunkId}`),this.currentChunkId++,this.chunkBatch=[]}catch(i){throw console.error("[RecorderV3] Error in flushChunks:",i),i}}async flushContainer(e=!1){if(this.containerChunks.length===0)return;this.chunkBatch.length>0&&await this.flushChunks(!1);const n=new Blob(this.containerChunks,{type:"audio/webm;codecs=opus"}),r=Date.now(),i=`audio-chunks/${this.visitId}/${this.currentContainerIndex}-${r}.webm`;console.log(`[RecorderV3] Flushing container ${this.currentContainerIndex}:`,{chunks:this.containerChunks.length,totalSize:n.size,timestamp:r,isFinal:e});try{await this.config.onChunkReady({blob:n,chunkId:this.currentContainerIndex,isFinal:e,key:i,isCompleteContainer:!0,visitId:this.visitId}),console.log(`[RecorderV3] Container ${this.currentContainerIndex} uploaded successfully`)}catch(o){console.error("[RecorderV3] Failed to upload container, storing in IndexedDB for retry:",o);const s={blob:n,timestamp:r,chunkId:this.currentContainerIndex,visitId:this.visitId,isFinal:e,containerIndex:this.currentContainerIndex};await Io.storeChunk(s),await this.syncManager.markForUpload(s)}this.containerChunks=[]}async switchContainer(){var e;if(((e=this.mediaRecorder)==null?void 0:e.state)==="recording"){console.log("[RecorderV3] Switching container:",{currentIndex:this.currentContainerIndex,batchSize:this.chunkBatch.length,containerSize:this.containerChunks.length});try{const n=this.mediaRecorder;await new Promise(r=>{const i=()=>{n.removeEventListener("dataavailable",i),r()};n.addEventListener("dataavailable",i),n.stop()}),this.mediaRecorder=null,this.chunkBatch.length>0&&await this.flushChunks(!1),await this.flushContainer(!1),this.currentContainerIndex++,this.containerStartTime=Date.now(),this.mediaRecorder=this.createRecorder(),this.mediaRecorder.start(this.CHUNK_DURATION),console.log("[RecorderV3] Switched to new container:",{newIndex:this.currentContainerIndex,timestamp:this.containerStartTime})}catch(n){console.error("[RecorderV3] Failed to switch container:",n)}}}createRecorder(){if(!this.stream)throw new Error("No audio stream available");const e=VO(),n=new MediaRecorder(this.stream,{mimeType:e,audioBitsPerSecond:48e3});return n.addEventListener("dataavailable",async r=>{var i;if(!(!(r instanceof BlobEvent)||!((i=r.data)!=null&&i.size))&&(console.log("[RecorderV3] Data available:",{size:r.data.size,batchSize:this.chunkBatch.length,containerIndex:this.currentContainerIndex,isActiveRecorder:this.mediaRecorder===n}),this.chunkBatch.push(r.data),this.chunkBatch.length>=this.BATCH_SIZE))try{await this.flushChunks(!1)}catch(o){console.error("[RecorderV3] Error flushing chunks:",o)}}),n}async startRecording(e){if(!this.isRecording)try{if(this.visitId=e||this.visitId,!this.visitId)throw new Error("No visit ID provided for recording");this.stream||await this.initialize(),this.isRecording=!0,this.currentChunkId=0,this.currentContainerIndex=0,this.chunkBatch=[],this.containerChunks=[],this.containerStartTime=Date.now(),this.mediaRecorder=this.createRecorder(),this.mediaRecorder.start(this.CHUNK_DURATION),this.containerTimer=setInterval(()=>{Date.now()-this.containerStartTime>=this.CONTAINER_DURATION&&this.switchContainer()},1e3),console.log("[RecorderV3] Started recording with visit ID:",this.visitId)}catch(n){throw console.error("[RecorderV3] Failed to start recording:",n),this.cleanup(),n}}async stopRecording(){if(this.isRecording){console.log("[RecorderV3] Stopping recording:",{currentIndex:this.currentContainerIndex,batchSize:this.chunkBatch.length,containerSize:this.containerChunks.length});try{this.containerTimer&&(clearInterval(this.containerTimer),this.containerTimer=null);const e=this.mediaRecorder;this.mediaRecorder=null,this.isRecording=!1;let n=!1;((e==null?void 0:e.state)==="recording"||(e==null?void 0:e.state)==="paused")&&await new Promise((r,i)=>{const o=async s=>{var a;try{e.removeEventListener("dataavailable",o),(a=s.data)!=null&&a.size&&!n&&(console.log("[RecorderV3] Adding final chunk:",{size:s.data.size,existingBatchSize:this.chunkBatch.length}),this.chunkBatch.push(s.data),n=!0),this.chunkBatch.length>0&&await this.flushChunks(!0),await this.flushContainer(!0),r()}catch(l){i(l)}};e.addEventListener("dataavailable",o),e.stop()}),console.log("[RecorderV3] Recording stopped and final data flushed:",{finalContainerIndex:this.currentContainerIndex,finalBatchSize:this.chunkBatch.length,finalContainerSize:this.containerChunks.length}),this.isRecording=!1,this.stream&&(this.stream.getTracks().forEach(r=>r.stop()),this.stream=null),this.chunkBatch=[],this.containerChunks=[]}catch(e){throw console.error("[RecorderV3] Error stopping recording:",e),e}}}async pauseRecording(){if(!(!this.isRecording||this.isPaused))try{this.containerTimer&&(clearInterval(this.containerTimer),this.containerTimer=null);const e=this.mediaRecorder;(e==null?void 0:e.state)==="recording"&&await new Promise(n=>{const r=async()=>{try{e.removeEventListener("dataavailable",r),this.chunkBatch.length>0&&await this.flushChunks(!1),n()}catch(i){console.error("[RecorderV3] Error flushing chunks during pause:",i),n()}};e.addEventListener("dataavailable",r),e.pause()}),this.isPaused=!0,console.log("[RecorderV3] Recording paused")}catch(e){throw console.error("[RecorderV3] Failed to pause recording:",e),e}}async resumeRecording(){var e;if(!(!this.isRecording||!this.isPaused))try{this.stream||await this.initialize(),((e=this.mediaRecorder)==null?void 0:e.state)==="paused"&&this.mediaRecorder.resume(),this.containerStartTime=Date.now(),this.containerTimer=setInterval(()=>{Date.now()-this.containerStartTime>=this.CONTAINER_DURATION&&this.switchContainer()},1e3),this.isPaused=!1,console.log("[RecorderV3] Recording resumed")}catch(n){throw console.error("[RecorderV3] Failed to resume recording:",n),this.isPaused=!0,this.mediaRecorder&&this.mediaRecorder.pause(),n}}cleanup(){var e;this.containerTimer&&(clearInterval(this.containerTimer),this.containerTimer=null),((e=this.mediaRecorder)==null?void 0:e.state)==="recording"&&this.mediaRecorder.stop(),this.mediaRecorder=null,this.stream&&(this.stream.getTracks().forEach(n=>n.stop()),this.stream=null),this.isRecording=!1,this.isPaused=!1,this.chunkBatch=[],this.containerChunks=[],console.log("[RecorderV3] Cleanup complete")}getState(){return{isRecording:this.isRecording,isPaused:this.isPaused,currentChunkId:this.currentChunkId,currentContainerIndex:this.currentContainerIndex,batchSize:this.chunkBatch.length,containerSize:this.containerChunks.length}}}const rH=()=>crypto.randomUUID(),iH=t=>{const e=Math.floor(t/60),n=t%60;return`${e}:${n.toString().padStart(2,"0")}`};function oH(t={}){const[e,n]=y.useState(!1),[r,i]=y.useState(!1),[o,s]=y.useState(0),[a,l]=y.useState(t.initialVisitId||null),c=y.useRef(null),u=y.useRef(null),d=y.useRef(null),{user:f}=zt(),{getValidSessionToken:p}=Hh(),m=Be(),g=Un();y.useEffect(()=>f!=null&&f.id?((async()=>{try{if(!await p())throw new Error("No session token available");c.current=new nH({saveLocally:!0,async onChunkReady({blob:k,chunkId:E,isFinal:T,key:O,visitId:R}){const I=await p(),$={key:O,contentType:k.type,visitId:R,chunkId:E,isFinal:T,userId:f==null?void 0:f.id};if(console.log("[Debug] Request payload:",$),!$.key||!$.contentType||!$.visitId)throw new Error("Missing required fields in payload");const P=await fetch(`${Tr.apiUrl}/get-upload-url`,{method:"POST",headers:{Authorization:`Bearer ${I}`,"Content-Type":"application/json"},body:JSON.stringify($)});if(!P.ok){const L=await P.text();throw console.error("[Debug] Upload URL error response:",{status:P.status,statusText:P.statusText,body:L}),new Error(`Failed to get upload URL: ${P.status} ${P.statusText} - ${L}`)}const{uploadUrl:M,fields:z}=await P.json(),B=new FormData;Object.entries(z).forEach(([L,Y])=>{B.append(L,Y)}),B.append("file",k),console.log("[Debug] Uploading to S3:",{uploadUrl:M,fields:z,formDataKeys:Array.from(B.keys())});const H=await fetch(M,{method:"POST",body:B});if(!H.ok){const L=await H.text();throw console.error("[Debug] S3 upload error:",{status:H.status,statusText:H.statusText,response:L}),new Error(`Failed to upload to S3: ${H.status} ${H.statusText} - ${L}`)}console.log("[Debug] S3 upload successful");const A={key:O,visitId:R,chunkId:Number(E),isFinal:!!T,contentType:k.type},D=await fetch(`${Tr.apiUrl}/process-audio`,{method:"POST",headers:{Authorization:`Bearer ${I}`,"Content-Type":"application/json"},body:JSON.stringify(A)});if(!D.ok){const L=await D.text();throw new Error(`Failed to process audio: ${D.status} ${D.statusText} - ${L}`)}}}),await c.current.initialize()}catch(C){console.error("Failed to initialize recorder:",C)}})(),()=>{var C;return(C=c.current)==null?void 0:C.cleanup()}):void 0,[f==null?void 0:f.id]),y.useEffect(()=>(e&&!r&&u.current&&(d.current=setInterval(()=>{const b=Date.now()-u.current;s(Math.floor(b/1e3))},1e3)),()=>{d.current&&(clearInterval(d.current),d.current=null)}),[e,r]),y.useEffect(()=>{t.initialVisitId&&t.initialState==="recording"?(n(!0),i(!1)):t.initialVisitId&&t.initialState==="paused"&&(n(!0),i(!0))},[t.initialVisitId,t.initialState]);const v=y.useCallback(async(b,C)=>{var k;try{if(!c.current)throw new Error("Recorder not initialized");if(!(f!=null&&f.id))throw new Error("Must be logged in to record");const E=C||a||rH();if(l(E),b&&await c.current.initialize(b),u.current=Date.now(),await c.current.startRecording(E),n(!0),i(!1),!C&&!a){const{error:T}=await m.from("visits").insert([{id:E,user_id:f.id,state:"recording"}]).select().single();T?console.error("Failed to create visit record:",T):g(`/visit/${E}`)}(k=t.onRecordingStateChange)==null||k.call(t,!0,!1)}catch(E){console.error("Failed to start recording:",E)}},[f==null?void 0:f.id,m,a,g]),x=y.useCallback(async()=>{var b;try{c.current&&(await c.current.stopRecording(),a&&await m.from("visits").update({state:"processing"}).eq("id",a),n(!1),i(!1),s(0),(b=t.onRecordingStateChange)==null||b.call(t,!1,!1))}catch(C){console.error("Failed to stop recording:",C)}},[a,m]),w=y.useCallback(async()=>{var b;try{c.current&&(await c.current.pauseRecording(),i(!0),(b=t.onRecordingStateChange)==null||b.call(t,!0,!0))}catch(C){console.error("Failed to pause recording:",C)}},[]),S=y.useCallback(async()=>{var b;try{c.current&&(await c.current.resumeRecording(),i(!1),(b=t.onRecordingStateChange)==null||b.call(t,!0,!1))}catch(C){console.error("Failed to resume recording:",C)}},[]);return{isRecording:e,isPaused:r,startRecording:v,stopRecording:x,pauseRecording:w,resumeRecording:S,formattedTime:iH(o),currentVisitId:a}}class sH{constructor(e={}){this.stream=null,this.monitorRecorder=null,this.audioContext=null,this.analyser=null,this.mediaStreamSource=null,this.reconnectInterval=null,this.isReconnecting=!1,this.onStreamAvailable=e.onStreamAvailable}startStreamMonitoring(){this.reconnectInterval&&clearInterval(this.reconnectInterval),this.reconnectInterval=window.setInterval(async()=>{if(!this.stream)return;if(!this.stream.getAudioTracks().some(r=>r.readyState==="live")&&!this.isReconnecting){console.log("[AudioMonitor] Stream inactive, attempting to reconnect..."),this.isReconnecting=!0;try{await this.initialize(this.lastDeviceId),console.log("[AudioMonitor] Successfully reconnected stream")}catch(r){console.error("[AudioMonitor] Failed to reconnect stream:",r)}finally{this.isReconnecting=!1}}},5e3)}async initialize(e){try{this.lastDeviceId=e,this.cleanup(),this.stream=await navigator.mediaDevices.getUserMedia({audio:{deviceId:e?{exact:e}:void 0,channelCount:1,sampleRate:48e3}}),this.audioContext=new AudioContext,this.analyser=this.audioContext.createAnalyser(),this.analyser.minDecibels=-85,this.analyser.maxDecibels=-10,this.analyser.smoothingTimeConstant=.85,this.analyser.fftSize=1024,this.mediaStreamSource=this.audioContext.createMediaStreamSource(this.stream),this.mediaStreamSource.connect(this.analyser);const n=VO();this.monitorRecorder=new MediaRecorder(this.stream,{mimeType:n,audioBitsPerSecond:48e3}),this.monitorRecorder.start(100),this.startStreamMonitoring(),this.onStreamAvailable&&this.onStreamAvailable(this.stream)}catch(n){throw console.error("[AudioMonitor] Failed to initialize:",n),this.cleanup(),n}}getStream(){return this.stream}getAnalyser(){return this.analyser}getAudioContext(){return this.audioContext}isMonitoring(){return this.monitorRecorder!==null&&this.monitorRecorder.state==="recording"}async resumeContext(){var e;((e=this.audioContext)==null?void 0:e.state)==="suspended"&&await this.audioContext.resume()}cleanup(){if(console.log("[AudioMonitor] Cleaning up..."),this.reconnectInterval&&(clearInterval(this.reconnectInterval),this.reconnectInterval=null),this.monitorRecorder){try{this.monitorRecorder.state==="recording"&&this.monitorRecorder.stop()}catch(e){console.warn("[AudioMonitor] Error stopping monitor recorder:",e)}this.monitorRecorder=null}this.mediaStreamSource&&(this.mediaStreamSource.disconnect(),this.mediaStreamSource=null),this.analyser&&(this.analyser.disconnect(),this.analyser=null),this.audioContext&&(this.audioContext.close(),this.audioContext=null),this.stream&&(this.stream.getTracks().forEach(e=>e.stop()),this.stream=null),console.log("[AudioMonitor] Cleanup complete.")}}const aH=t=>{const e=y.useRef(null),n=y.useRef(null),r=y.useRef(null),i=y.useRef(null),o=async()=>{const a=t.current;if(!a){console.error("AudioMonitor not provided");return}const l=document.getElementById("visualizer");if(!l){console.error("Canvas element not found");return}i.current=l;const c=l.getContext("2d");if(!c){console.error("Unable to get canvas context");return}if(l.width===0||l.height===0){console.error("Canvas has zero dimensions:",l.width,l.height);return}let u=a.getAnalyser(),d=0;const f=5;for(;!u&&d<f;)console.log(`Waiting for analyzer (attempt ${d+1}/${f})...`),await new Promise(O=>{r.current=window.setTimeout(O,500)}),u=a.getAnalyser(),d++;if(!u){console.error("Analyzer not available after retries");return}await a.resumeContext();const p=u.frequencyBinCount,m=new Uint8Array(p),g=8,v=new Float32Array(g).fill(0),x=.85,w=a.getAudioContext();if(!w){console.error("AudioContext not available");return}const b=w.sampleRate/u.fftSize,C=Math.floor(50/b),k=Math.floor(1e3/b),E=k-C;e.current&&(cancelAnimationFrame(e.current),e.current=null);const T=()=>{if(!i.current){console.log("Canvas no longer exists, stopping visualization"),e.current&&(cancelAnimationFrame(e.current),e.current=null);return}e.current=requestAnimationFrame(T),u.getByteFrequencyData(m);const O=m.slice(C,k).every(B=>B===0),R=Date.now();O?n.current||(n.current=R):n.current&&(n.current=null);const I=n.current&&R-n.current>3e4;c.clearRect(0,0,l.width,l.height);const $=1,P=(g-1)*$,M=Math.floor((l.width-P)/g);let z=0;for(let B=0;B<g;B++){const H=C+Math.floor(B/g*E),A=C+Math.floor((B+1)/g*E);if(A<=H)continue;const D=m.slice(H,A).reduce((ee,G)=>ee+G,0)/(A-H);v[B]=v[B]*x+D*(1-x);const L=Math.max(v[B]/255*l.height*1.2,l.height*.2),Y=(l.height-L)/2;c.fillStyle=I?"rgba(239, 68, 68, 0.8)":`rgba(59, 130, 246, ${Math.max(.3,v[B]/255)})`,c.fillRect(z,Y,M,L),z+=M+$}};T()},s=()=>{r.current&&(window.clearTimeout(r.current),r.current=null),e.current&&(cancelAnimationFrame(e.current),e.current=null),i.current=null};return y.useEffect(()=>()=>{s()},[]),{startVisualizer:o,stopVisualizer:s}},li={micSelectorContainer:{display:"flex",alignItems:"center"},visualizerButton:{display:"flex",alignItems:"center",padding:"0",backgroundColor:"transparent",border:"none",cursor:"pointer",outline:"none",WebkitTapHighlightColor:"transparent","&:hover":{backgroundColor:"transparent"},"&:active":{backgroundColor:"transparent"},"&:focus":{backgroundColor:"transparent",outline:"none"}},visualizerGroup:{display:"flex",alignItems:"center",gap:"4px",backgroundColor:"white",padding:"0 12px",borderRadius:"6px",border:"1px solid #e5e7eb",justifyContent:"space-between",height:"36px"},visualizer:{maxWidth:"60px",height:"36px",backgroundColor:"transparent"},dropdownContent:{minWidth:"220px",backgroundColor:"white",borderRadius:"6px",padding:"5px",boxShadow:"0px 10px 38px -10px rgba(22, 23, 24, 0.35), 0px 10px 20px -15px rgba(22, 23, 24, 0.2)"},dropdownItem:{fontSize:"14px",lineHeight:"1",color:"#374151",borderRadius:"3px",display:"flex",alignItems:"center",height:"32px",padding:"0 8px",userSelect:"none",outline:"none",cursor:"pointer","&:hover":{backgroundColor:"#f3f4f6"}},selectedDropdownItem:{backgroundColor:"#f0f9ff",color:"#2563eb","&:hover":{backgroundColor:"#e0f2fe"}},dropdownLabel:{fontSize:"12px",lineHeight:"1",color:"#6b7280",padding:"0 8px",marginBottom:"4px"}};function lH({onDeviceSelect:t,selectedDevice:e}){const[n,r]=y.useState([]),[i,o]=y.useState(null),s=y.useRef(null),a=y.useRef(!1),{startVisualizer:l}=aH(s),c=y.useRef(!0);y.useEffect(()=>(s.current=new sH,c.current=!0,()=>{c.current=!1}),[]);const u=y.useCallback(async()=>{if(c.current)try{await navigator.mediaDevices.getUserMedia({audio:!0});const m=(await navigator.mediaDevices.enumerateDevices()).filter(v=>v.kind==="audioinput");if(r(m),e&&m.some(v=>v.deviceId===e.deviceId)){if(m.length>0&&!e){const v=m.find(x=>x.deviceId!=="default"&&x.deviceId!=="communications")||m[0];t(v)}}else{const v=m.find(x=>x.deviceId!=="default"&&x.deviceId!=="communications")||m[0];v&&(console.log("Previously selected device no longer available. Switching to:",v.label),t(v))}}catch(p){console.error("Failed to load audio devices:",p)}},[e,t]);y.useEffect(()=>(u(),navigator.mediaDevices.addEventListener("devicechange",u),()=>{navigator.mediaDevices.removeEventListener("devicechange",u)}),[u]);const d=y.useCallback(async()=>{if(!(!c.current||!s.current||!e||a.current))try{a.current=!0,s.current.cleanup(),await s.current.initialize(e.deviceId),c.current&&(await new Promise(p=>setTimeout(p,100)),await l())}catch(p){console.error("Failed to initialize audio monitor:",p),c.current&&s.current&&s.current.cleanup()}finally{c.current&&(a.current=!1)}},[e==null?void 0:e.deviceId,l]);y.useEffect(()=>{(i==null?void 0:i.deviceId)!==(e==null?void 0:e.deviceId)&&(o(e),e&&d())},[i==null?void 0:i.deviceId,e==null?void 0:e.deviceId,d]);const f=y.useCallback(p=>{if(!c.current)return;const m=n.find(g=>g.deviceId===p);m&&t(m)},[n,t]);return h.jsx("div",{style:li.micSelectorContainer,children:h.jsxs(tl,{children:[h.jsx(nl,{asChild:!0,children:h.jsx("button",{style:li.visualizerButton,children:h.jsxs("div",{style:li.visualizerGroup,children:[h.jsx(Wf,{size:16,color:"#6b7280"}),h.jsx("canvas",{id:"visualizer",style:li.visualizer,width:"120",height:"36"}),h.jsx(Bh,{width:16,height:16,color:"#6b7280"})]})})}),h.jsx(rl,{children:h.jsxs(il,{style:li.dropdownContent,sideOffset:5,children:[h.jsx("div",{style:li.dropdownLabel,children:"Select Microphone"}),n.filter(p=>p.deviceId!=="default").map(p=>{const m=p.deviceId===(e==null?void 0:e.deviceId);return h.jsxs(Gt,{style:{...li.dropdownItem,...m?li.selectedDropdownItem:{}},onClick:()=>f(p.deviceId),children:[h.jsx(Wf,{size:16,style:{marginRight:"8px",color:m?"#2563eb":"#6b7280"}}),p.label||`Microphone ${p.deviceId.slice(0,4)}`]},p.deviceId)})]})})]})})}const Ht={container:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:"8px"},buttonsContainer:{width:"200px",height:"36px"},buttonGroup:{display:"flex",alignItems:"stretch",height:"100%",width:"100%",minWidth:"200px"},dropdownTrigger:{display:"flex",alignItems:"center",padding:"0 8px",backgroundColor:"#3b82f6",color:"white",border:"none",borderLeft:"1px solid rgba(255,255,255,0.2)",borderRadius:"0 6px 6px 0",cursor:"pointer",transition:"all 0.2s ease",outline:"none",width:"32px","&:hover":{backgroundColor:"#2563eb"},"&:focus":{outline:"none"},"&:active":{outline:"none"},WebkitTapHighlightColor:"transparent"},controlsRow:{display:"flex",alignItems:"center",gap:"16px",userSelect:"none",height:"36px"},timerContainer:{display:"flex",alignItems:"center",pointerEvents:"none",height:"36px"},timer:{display:"flex",alignItems:"center",gap:"4px",fontSize:"14px",color:"#374151",height:"36px",padding:"0 8px"},timerIcon:{width:"16px",height:"16px",color:"#6b7280"},dropdownContent:{minWidth:"220px",backgroundColor:"white",borderRadius:"6px",padding:"5px",boxShadow:"0px 10px 38px -10px rgba(22, 23, 24, 0.35), 0px 10px 20px -15px rgba(22, 23, 24, 0.2)"},dropdownItem:{fontSize:"14px",lineHeight:"1",color:"#374151",borderRadius:"3px",display:"flex",alignItems:"center",height:"32px",padding:"0 8px",userSelect:"none",outline:"none",cursor:"pointer","&:hover":{backgroundColor:"#f3f4f6"}},pauseButton:{display:"flex",alignItems:"center",justifyContent:"center",gap:"6px",padding:"8px 16px",color:"white",border:"none",cursor:"pointer",fontSize:"14px",fontWeight:"500",transition:"all 0.2s ease",outline:"none",borderRadius:"6px 0 0 6px",backgroundColor:"#9ca3af",width:"100px","&:hover":{backgroundColor:"#6b7280"}},resumeButton:{display:"flex",alignItems:"center",justifyContent:"center",gap:"6px",padding:"8px 16px",color:"white",border:"none",cursor:"pointer",fontSize:"14px",fontWeight:"500",transition:"all 0.2s ease",outline:"none",borderRadius:"6px 0 0 6px",backgroundColor:"#3b82f6",flex:"1","&:hover":{backgroundColor:"#2563eb"}},stopButton:{display:"flex",alignItems:"center",justifyContent:"center",gap:"6px",padding:"8px 16px",color:"white",border:"none",cursor:"pointer",fontSize:"14px",fontWeight:"500",transition:"all 0.2s ease",outline:"none",borderRadius:"0 6px 6px 0",backgroundColor:"#dc2626",width:"100px","&:hover":{backgroundColor:"#b91c1c"}},startButton:{display:"flex",alignItems:"center",justifyContent:"center",gap:"6px",padding:"8px 16px",color:"white",border:"none",cursor:"pointer",fontSize:"14px",fontWeight:"500",transition:"all 0.2s ease",outline:"none",borderRadius:"6px 0 0 6px",backgroundColor:"#3b82f6",minWidth:"168px",flex:1,"&:hover":{backgroundColor:"#2563eb"}}};function cH({disabled:t=!1,onRecordingStateChange:e,initialVisitId:n,initialChunkId:r,onVisitIdChange:i,onStartRecording:o}){const[s,a]=y.useState(null),[l,c]=y.useState(n||null),[u,d]=y.useState("new"),{user:f}=zt(),p=Be(),m=Un(),{isRecording:g,isPaused:v,formattedTime:x,startRecording:w,stopRecording:S,pauseRecording:b,resumeRecording:C}=oH({onRecordingStateChange:e,initialVisitId:n,initialChunkId:r});y.useEffect(()=>{n&&u==="paused"&&c(n)},[n,u]),y.useEffect(()=>{console.log("[AudioRecorder] State update:",{isRecording:g,isPaused:v,recordingState:u,initialVisitId:n,currentVisitId:l,disabled:t})},[g,v,u,n,l,t]),y.useEffect(()=>{n===null&&(c(null),d("new"),i==null||i(null))},[n,i]);const k=y.useCallback(async()=>{try{if(!(f!=null&&f.id))throw new Error("User not authenticated");let I;if(o){if(I=await o(),!I)return}else if(n&&u==="paused")I=n,await Vl(p,n,"recording"),m(`/visit/${n}`);else{console.error("No visit ID available and no onStartRecording provided");return}c(I),d("recording"),i==null||i(I),await w(s==null?void 0:s.deviceId,I)}catch(I){console.error("Failed to start recording:",I)}},[f==null?void 0:f.id,n,u,s,w,p,i,m,o]),E=y.useCallback(async()=>{if(l)try{await b(),d("paused"),await Vl(p,l,"paused")}catch(I){console.error("Failed to pause recording:",I)}},[l,b,p]),T=y.useCallback(async()=>{if(l)try{await C(),d("recording"),await Vl(p,l,"recording")}catch(I){console.error("Failed to resume recording:",I)}},[l,C,p]),O=y.useCallback(async()=>{if(l)try{await S(),d("processing"),await Vl(p,l,"processing",!0),c(null),i==null||i(null)}catch(I){console.error("Failed to stop recording:",I)}},[l,S,p,i]);y.useEffect(()=>{e==null||e(g,v)},[g,v,e]);const R=y.useMemo(()=>({startButton:{...Ht.startButton,...t?{opacity:.5,cursor:"not-allowed",backgroundColor:"#9ca3af"}:{}},dropdownTrigger:{...Ht.dropdownTrigger,...t?{opacity:.5,cursor:"not-allowed",backgroundColor:"#9ca3af"}:{}}}),[t]);return h.jsxs("div",{style:Ht.container,children:[h.jsxs("div",{style:Ht.controlsRow,children:[h.jsx("div",{style:Ht.timerContainer,children:h.jsxs("div",{style:Ht.timer,children:[h.jsx(u6,{style:Ht.timerIcon}),x]})}),h.jsx(lH,{selectedDevice:s,onDeviceSelect:a})]}),h.jsx("div",{style:Ht.buttonsContainer,children:h.jsx("div",{style:Ht.buttonGroup,children:g?h.jsxs(h.Fragment,{children:[h.jsxs("button",{onClick:u==="paused"?T:E,style:u==="paused"?Ht.resumeButton:Ht.pauseButton,disabled:t,children:[u==="paused"?h.jsx(Wf,{size:16}):h.jsx(n8,{size:16}),u==="paused"?"Resume":"Pause"]}),h.jsxs("button",{onClick:O,style:Ht.stopButton,disabled:t,children:[h.jsx(c8,{size:16}),"Stop"]})]}):h.jsxs(h.Fragment,{children:[h.jsxs("button",{onClick:k,style:R.startButton,disabled:t,children:[h.jsx(Wf,{size:16}),"Start Recording"]}),h.jsxs(tl,{children:[h.jsx(nl,{asChild:!0,children:h.jsx("button",{style:R.dropdownTrigger,disabled:t,children:h.jsx(Bh,{width:16,height:16})})}),h.jsx(rl,{children:h.jsx(il,{style:Ht.dropdownContent,sideOffset:5,children:h.jsxs(Gt,{style:Ht.dropdownItem,children:[h.jsx(h8,{size:16,style:{marginRight:"8px"}}),"Upload Audio"]})})})]})]})})})]})}const Em={header:{height:"60px",backgroundColor:"#f9fafb",padding:"0 24px 0",display:"flex",alignItems:"flex-end",justifyContent:"space-between",gap:"32px"},headerLeft:{flex:"0 1 auto",minWidth:0,maxWidth:"400px"},headerRight:{flex:"0 0 auto",display:"flex",alignItems:"center",gap:"16px"}};function uH({onPatientSelect:t,selectedPatientId:e,onRecordingStateChange:n,visitId:r}){const[i,o]=y.useState(void 0),[s,a]=y.useState(r),l=Be(),{user:c}=zt(),u=Un(),d=g=>{t(g)},f=g=>{o(g||void 0)},p=g=>{a(g||void 0)},m=y.useCallback(async()=>{try{if(!(c!=null&&c.id))throw new Error("User not authenticated");let g=s;if(r)g=r,await Vl(l,r,"recording");else{const v=await F7(l,{userId:c.id,name:i,patientId:e||void 0});g=v.id,a(v.id)}return u(`/visit/${g}`),g}catch(g){console.error("Failed to create/resume visit:",g);return}},[c==null?void 0:c.id,s,r,l,i,e,u]);return h.jsxs("div",{style:Em.header,children:[h.jsx("div",{style:Em.headerLeft,children:h.jsx(z7,{onPatientSelect:d,onVisitNameChange:f,selectedPatientId:e,visitId:r||s})}),h.jsx("div",{style:Em.headerRight,children:h.jsx(cH,{disabled:!1,onRecordingStateChange:n,initialVisitId:r,onVisitIdChange:p,onStartRecording:m})})]})}const Me=(...t)=>{console.log("[useRealtimeNotes]",...t)};function dH({visitId:t,onMessage:e}){const[n,r]=y.useState([]),i=y.useRef(!1),o=y.useRef(null),s=y.useCallback(async()=>{if(!t||t==="")return;Me("Fetching notes for visit:",t);const{data:l,error:c}=await pn.from("notes").select("*").eq("visit_id",t).order("created_at",{ascending:!0});if(c){Me("Error fetching notes:",c);return}l&&(Me(`Fetched ${l.length} notes`),r(l),i.current=!0,l.forEach(u=>e==null?void 0:e(u)))},[t,e]),a=y.useCallback(l=>{Me("Manual note deletion triggered for ID:",l),r(c=>{const u=c.filter(d=>d.id!==l);return u.length===c.length?Me("No note found to delete with ID (manual):",l):Me("Successfully removed note with ID (manual):",l),u})},[]);return y.useEffect(()=>{if(!t||t===""){Me("No valid visitId provided, skipping subscription"),r([]),i.current=!1;return}Me("Visit ID changed to:",t),r([]),i.current=!1,i.current||(Me("Setting up realtime subscription for visit:",t),s()),o.current&&(Me("Cleaning up existing subscription"),o.current.unsubscribe(),o.current=null);const l=pn.channel(`notes_list_${t}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"notes",filter:`visit_id=eq.${t}`},c=>{Me("Received INSERT event:",c);const u=c.new;Me("Inserting new note:",u),r(d=>{if(d.some(p=>p.id===u.id))return Me("Note already exists, skipping insert"),d;const f=[...d,u].sort((p,m)=>new Date(p.created_at).getTime()-new Date(m.created_at).getTime());return e==null||e(u),f})}).on("postgres_changes",{event:"UPDATE",schema:"public",table:"notes",filter:`visit_id=eq.${t}`},c=>{Me("Received UPDATE event:",c);const u=c.new;Me("Updating note:",u),r(d=>{const f=d.map(p=>p.id===u.id?u:p);return JSON.stringify(f)===JSON.stringify(d)?(Me("No changes detected in update"),d):(e==null||e(u),f)})}).on("postgres_changes",{event:"DELETE",schema:"public",table:"notes",filter:`visit_id=eq.${t}`},c=>{Me("Received DELETE event:",c);const u=c.old;if(Me("Deleting note with ID:",u==null?void 0:u.id),!u||!u.id){Me("Warning: Invalid delete payload, no note ID found",c);return}r(d=>{const f=d.filter(p=>p.id!==u.id);return f.length===d.length?Me("No note found to delete with ID:",u.id):Me("Successfully removed note with ID:",u.id),f})}).subscribe(c=>{Me("Subscription status:",c)});return o.current=l,()=>{Me("Cleaning up subscription"),l.unsubscribe(),o.current=null}},[t,s,e]),y.useEffect(()=>{Me("Notes state updated:",n.length,"notes")},[n]),{notes:n,handleNoteDeleted:a}}const fH=async(t,e,n)=>{try{if(n==="paused"||n==="processing"){const{data:o,error:s}=await t.from("containers").select("transcript_fragment").eq("visit_id",e).order("chunk_id",{ascending:!0});return s?(console.error("Error loading containers:",s),"Error loading partial transcription."):o.map(l=>l.transcript_fragment).filter(l=>l!==null).join(" ").trim()||"Processing..."}else if(n==="recording")return"";const{data:r,error:i}=await t.from("transcripts").select("full_text").eq("visit_id",e).single();return i?i.code==="PGRST116"?"No transcript available for this visit.":(console.error("Error loading transcript:",i),"Error loading transcript. Please try again later."):(r==null?void 0:r.full_text)||"No transcript content available."}catch(r){return console.error("Error processing transcription:",r),"Error loading transcription data. Please try again later."}},Cd={container:{display:"flex",flexDirection:"column",height:"100%",width:"100%",backgroundColor:"#f9fafb"},content:{flex:1,backgroundColor:"#f9fafb",overflow:"hidden",width:"100%",height:"calc(100vh - 60px)",padding:"24px"},transcriptContainer:{height:"100%",overflow:"hidden"},transcriptContent:{lineHeight:"1.5",color:"#374151",height:"100%",display:"flex",flexDirection:"column"}};function hH({placeholder:t="Your transcription will appear here as you speak...",isTranscribing:e=!1,visitId:n,onRecordingStateChange:r,onPatientSelect:i,selectedPatientId:o,visits:s}){const[a,l]=y.useState(""),[c,u]=y.useState({}),[d,f]=y.useState(null),p=Be(),m=y.useMemo(()=>n?s.find(T=>T.id===n):null,[n,s]),g=m==null?void 0:m.state,v=y.useCallback(T=>{const O=T.transcript_fragment,R=T.chunk_id;O&&typeof R=="number"&&u(I=>({...I,[R]:O}))},[]);E7({visitId:n||"",onMessage:v});const x=y.useMemo(()=>e?Object.entries(c).sort(([T],[O])=>Number(T)-Number(O)).map(([T,O])=>O).join(" ").trim():"",[c,e]);y.useEffect(()=>{e&&x!==a&&l(x)},[x,a,e]),y.useEffect(()=>{if(!n||!g||!m){u({}),l(""),f(null);return}(async()=>{try{const O=await fH(p,n,g);f(O),e||l(O)}catch{l("Error loading transcription data.")}})()},[n,g,m,p,e]);const w=y.useCallback(T=>{i((T==null?void 0:T.id)||null)},[i]),S=y.useMemo(()=>e?a:d||a||"",[e,a,d]),{notes:b,handleNoteDeleted:C}=dH({visitId:n||""}),k=b.filter(T=>T.type==="ai_context").sort((T,O)=>new Date(O.created_at).getTime()-new Date(T.created_at).getTime())[0],E=y.useMemo(()=>h.jsx("div",{style:Cd.content,children:h.jsx("div",{style:Cd.transcriptContainer,children:h.jsx("div",{style:Cd.transcriptContent,children:e||!n||!m||(m==null?void 0:m.state)==="processing"?h.jsx(KN,{transcription:S,placeholder:t,isTranscribing:e,visit:m??void 0,aiContextNote:k},`visit-${n}`):h.jsx(k7,{visit:m,notes:b,handleNoteDeleted:C},`visit-${n}`)})})}),[S,t,e,n,m,b,C]);return h.jsxs("div",{style:Cd.container,children:[h.jsx(uH,{onPatientSelect:w,selectedPatientId:o,onRecordingStateChange:r,visitId:n},`visit-${n}`),E]})}function pH(){const t=y.useContext(TE),e=Be();if(t===void 0)throw new Error("useAuth must be used within an AuthProvider");return{...t,signIn:async(r,i)=>{try{const{data:o,error:s}=await e.auth.signInWithPassword({email:r,password:i});if(s)throw s;return await e.auth.getSession(),{data:o,error:null}}catch(o){return console.error("Sign in error:",o),{data:null,error:o}}}}}const _t={container:{minHeight:"100vh",width:"100vw",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#f3f4f6",padding:"20px"},formContainer:{backgroundColor:"white",padding:"48px",borderRadius:"12px",boxShadow:"0 4px 6px rgba(0,0,0,0.1)",width:"100%",maxWidth:"480px"},title:{fontSize:"32px",fontWeight:"bold",color:"#1f2937",marginBottom:"32px",textAlign:"center"},form:{display:"flex",flexDirection:"column",gap:"24px"},inputGroup:{display:"flex",flexDirection:"column",gap:"8px"},label:{fontSize:"14px",color:"#4b5563",fontWeight:"500"},input:{padding:"12px 16px",borderRadius:"8px",border:"1px solid #e5e7eb",fontSize:"16px",backgroundColor:"white",transition:"all 0.2s ease","&:focus":{outline:"none",borderColor:"#3b82f6",boxShadow:"0 0 0 3px rgba(59, 130, 246, 0.1)"}},button:{backgroundColor:"#3b82f6",color:"white",padding:"14px",borderRadius:"8px",border:"none",fontSize:"16px",fontWeight:"500",cursor:"pointer",transition:"all 0.2s ease",marginTop:"8px","&:hover":{backgroundColor:"#2563eb"},"&:disabled":{backgroundColor:"#93c5fd",cursor:"not-allowed"}},error:{color:"#ef4444",fontSize:"14px",textAlign:"center",marginBottom:"16px"},signupText:{textAlign:"center",marginTop:"24px",fontSize:"14px",color:"#6b7280"},signupLink:{color:"#3b82f6",textDecoration:"none",fontWeight:"500","&:hover":{textDecoration:"underline"}}};function mH(){const t=Un(),{signIn:e,user:n}=pH(),[r,i]=y.useState(""),[o,s]=y.useState(""),[a,l]=y.useState(""),[c,u]=y.useState(!1),d=uo(),f=zn();y.useEffect(()=>{var m,g;if(n){console.log("User is logged in, redirecting to record",{user:n.id,email:n.email,location:window.location.pathname});const v=((g=(m=f.state)==null?void 0:m.from)==null?void 0:g.pathname)||"/record";t(v,{replace:!0})}},[n,t,f]);const p=async m=>{if(m.preventDefault(),!c){l(""),u(!0);try{const g=await e(r,o);if(g.error)throw g.error;d.clear()}catch(g){l(g instanceof Error?g.message:"Failed to sign in"),u(!1)}}};return n?h.jsx("div",{style:_t.container,children:h.jsx("div",{style:_t.formContainer,children:h.jsx("div",{style:{textAlign:"center",color:"#4b5563"},children:"Redirecting..."})})}):h.jsx("div",{style:_t.container,children:h.jsxs("div",{style:_t.formContainer,children:[h.jsx("h1",{style:_t.title,children:"Welcome to East Medical AI Scribe"}),h.jsxs("form",{onSubmit:p,style:_t.form,children:[a&&h.jsx("div",{style:_t.error,children:a}),h.jsxs("div",{style:_t.inputGroup,children:[h.jsx("label",{htmlFor:"email",style:_t.label,children:"Email Address"}),h.jsx("input",{id:"email",type:"email",value:r,onChange:m=>i(m.target.value),required:!0,style:_t.input,placeholder:"Enter your email"})]}),h.jsxs("div",{style:_t.inputGroup,children:[h.jsx("label",{htmlFor:"password",style:_t.label,children:"Password"}),h.jsx("input",{id:"password",type:"password",value:o,onChange:m=>s(m.target.value),required:!0,style:_t.input,placeholder:"Enter your password"})]}),h.jsx("button",{type:"submit",disabled:c,style:_t.button,children:c?"Signing in...":"Sign In"})]}),h.jsxs("div",{style:_t.signupText,children:["Don't have an account?"," "]})]})})}const HO=y.createContext(void 0);function gH({children:t}){const[e,n]=y.useState(null),[r,i]=y.useState(!0),o=Be();y.useEffect(()=>{(async()=>{const{data:{session:f},error:p}=await o.auth.getSession();p&&console.error("Error fetching session:",p),n((f==null?void 0:f.user)??null),i(!1)})();const{data:{subscription:d}}=o.auth.onAuthStateChange((f,p)=>{n((p==null?void 0:p.user)??null)});return()=>{d.unsubscribe()}},[o]);const c={user:e,loading:r,signIn:async(u,d)=>{const{error:f}=await o.auth.signInWithPassword({email:u,password:d});if(f)throw f},signUp:async(u,d)=>{const{error:f}=await o.auth.signUp({email:u,password:d});if(f)throw f},signOut:async()=>{const{error:u}=await o.auth.signOut();if(u)throw u}};return h.jsx(HO.Provider,{value:c,children:t})}function WO(){const t=y.useContext(HO);if(t===void 0)throw new Error("useAuth must be used within an AuthProvider");return t}const Wt={container:{minHeight:"100vh",width:"100vw",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#f3f4f6",padding:"20px"},formContainer:{backgroundColor:"white",padding:"48px",borderRadius:"12px",boxShadow:"0 4px 6px rgba(0,0,0,0.1)",width:"100%",maxWidth:"480px"},title:{fontSize:"32px",fontWeight:"bold",color:"#1f2937",marginBottom:"32px",textAlign:"center"},form:{display:"flex",flexDirection:"column",gap:"24px"},inputGroup:{display:"flex",flexDirection:"column",gap:"8px"},label:{fontSize:"14px",color:"#4b5563",fontWeight:"500"},input:{padding:"12px 16px",borderRadius:"8px",border:"1px solid #e5e7eb",fontSize:"16px",backgroundColor:"white",transition:"all 0.2s ease","&:focus":{outline:"none",borderColor:"#3b82f6",boxShadow:"0 0 0 3px rgba(59, 130, 246, 0.1)"}},button:{backgroundColor:"#3b82f6",color:"white",padding:"14px",borderRadius:"8px",border:"none",fontSize:"16px",fontWeight:"500",cursor:"pointer",transition:"all 0.2s ease",marginTop:"8px","&:hover":{backgroundColor:"#2563eb"},"&:disabled":{backgroundColor:"#93c5fd",cursor:"not-allowed"}},error:{color:"#ef4444",fontSize:"14px",textAlign:"center",marginBottom:"16px"},loginText:{textAlign:"center",marginTop:"24px",fontSize:"14px",color:"#6b7280"},loginLink:{color:"#3b82f6",textDecoration:"none",fontWeight:"500","&:hover":{textDecoration:"underline"}}};function yH(){const[t,e]=y.useState(""),[n,r]=y.useState(""),[i,o]=y.useState(""),[s,a]=y.useState(!1),{signUp:l}=WO(),c=Un(),u=async d=>{d.preventDefault();try{o(""),a(!0),await l(t,n),c("/")}catch(f){o("Failed to create account. Please try again."),console.error("Signup error:",f)}finally{a(!1)}};return h.jsx("div",{style:Wt.container,children:h.jsxs("div",{style:Wt.formContainer,children:[h.jsx("h1",{style:Wt.title,children:"Create an Account"}),h.jsxs("form",{onSubmit:u,style:Wt.form,children:[i&&h.jsx("div",{style:Wt.error,children:i}),h.jsxs("div",{style:Wt.inputGroup,children:[h.jsx("label",{htmlFor:"email",style:Wt.label,children:"Email Address"}),h.jsx("input",{id:"email",type:"email",value:t,onChange:d=>e(d.target.value),required:!0,style:Wt.input,placeholder:"Enter your email"})]}),h.jsxs("div",{style:Wt.inputGroup,children:[h.jsx("label",{htmlFor:"password",style:Wt.label,children:"Password"}),h.jsx("input",{id:"password",type:"password",value:n,onChange:d=>r(d.target.value),required:!0,style:Wt.input,placeholder:"Choose a password"})]}),h.jsx("button",{type:"submit",disabled:s,style:Wt.button,children:s?"Creating Account...":"Sign Up"})]}),h.jsxs("div",{style:Wt.loginText,children:["Already have an account?"," ",h.jsx(Bv,{to:"/login",style:Wt.loginLink,children:"Sign in"})]})]})})}const vH=["Accident and Emergency Nurse","Acupuncturist","Addiction Counsellor","Addiction Medicine Specialist","Adolescent and young adult medicine Specialist","Adult Intensive Care Specialist","Aerospace Medicine Specialist","Allergy and Immunologist","Allied Health Professional","Alternative medicine practitioner","Anaesthetist","Anatomical Pathologist","Andrologist","Animal-Assisted Therapist","Aromatherapist","Arts Therapist","Audiologist","Audiology Technician","Audiometrist","Ayurveda","Behaviour Therapist","Bereavement Counselor","Biofeedback Therapist","Blood Transfusion Doctor","Breast Surgeon","Cardiologist","Cardiothoracic Surgeon","Chemical Pathologist","Chemotherapy Nurse","Child and Adolescent Psychiatrist","Chiropractor","Chronic Pain Specialist","Clinical Geneticist","Clinical Immunologist","Clinical Neurophysiologist","Clinical Pathologist","Clinical Pharmacologist","Clinical Physiologist","Clinical Social Worker","Cognitive Behavioral Therapist","Colorectal Surgeon","Community Child Health Specialist","Community Nurse","Coroner","Counselling Psychologist","Counselors","Critical Care Medicine Specialist","Dance Therapist","Dental Auxiliary","Dental Technician","Dental assistant","Dental nurse","Dentist","Dermatologist","Diabetes Dietitian","Diabetes Specialist","Diabetologist","Diagnostic Radiographer","Diagnostic Radiologist","Dietitian","Drama Therapist","ECG Technician","EEG Technician","EMT","Eating Disorder Specialist Dietitian","Eating Disorder Specialist Psychologist","Emergency Medicine Specialist","Endocrine Surgeon","Endocrinologist","Endodontist","Equine Therapist","Exercise Physiologists","Family Medicine Specialist","Family Planning Doctor","Fetal Medicine Specialist","Foot and Ankle Surgeon","Forensic Medicine Specialist","Forensic Psychiatrist","Functional Medicine Specialist","Gastroenterologist","Gastrointestinal Surgeon","General Dietitian","General Gastrointestinal Surgeon","General Practitioner","General Surgeon","Genetic Counselor","Geriatric Medicine Specialist","Geriatrician","Gerodontist","Geropsychologist","Grief Counsellor","Gynaecologist","Haematologist","Haemodialysis Nurse","Hand Surgeon","Health Coach","Health Psychologist","Healthcare Assistant","Healthcare Service Manager","Hepatobiliary Surgeon","Hepatologist","Herbal Medicine Specialist","Hip and Knee Surgeon","Holistic Health Practitioner","Homeopath","Horticultural Therapist","Hospital Administrator","Hydrotherapist","Hypnotherapist","Immunopathologist","Infection Control Nurse","Infectious Diseases Physician","Intensive Care Specialist","Internal Medicine Specialist","Interpreter","Interventional Radiologist","Invasive Cardiologist","Kinesiologist","Laboratory Haematologist","Laboratory Medicine Specialist","Lactation Consultant","Lifestyle medicine Specialist","Liver Dietitian","Lower Gastrointestinal Surgeon","Marriage Guidance Counsellor","Marriage and family therapist","Massage Therapist","Maternal-Fetal Medicine Specialist","Maxillofacial Surgeon","Medical Geneticist","Medical Microbiologist","Medical Oncologist","Medical Pathologist","Medical Record Administrator","Medical Secretary","Medical Technician","Medical X-ray Technician","Mental Health Counselor","Mental Health Nurse","Mental Health and Behavioural Specialist","Midwife","Music Therapist","Naturopath","Neonatal Nurse","Neonatologist","Nephrologist","Neuroendocrinologist","Neurologist","Neuropathologist","Neuropsychiatrist","Neuroradiologist","Neurosurgeon","Nuclear Medicine Physician","Nurse","Nurse Administrator","Nurse Anaesthetist","Nurse Practitioner","Nurse Psychotherapist","Nursing Aid","Nursing Auxiliary","Nutrition & diabetics Specialist","Nutrition Therapist","Obesity Medicine","Obesity Specialist","Obstetrician & Gynaecologist","Occupational Health Nurse","Occupational Medicine Specialist","Occupational Therapist","Oculoplastic Surgeon","Oncologist","Oncology Dietitian","Oncology Nurse","Ophthalmologist","Optician","Optometrist","Oral Pathologist","Oral/Dental Hygienist","Orthodontist","Orthopaedic Surgeon","Orthoptist","Orthotist","Osteopath","Otolaryngologist","Otorhinolaryngologist (ENT Specialist)","Paediatric Allergist","Paediatric Audiologist","Paediatric Cardiologist","Paediatric Dietitian","Paediatric Emergency Medicine Specialist","Paediatric Endocrinologist","Paediatric Gastroenterologist","Paediatric Intensive Care Specialist","Paediatric Nephrologist","Paediatric Neurologist","Paediatric Nurse","Paediatric Oncologist","Paediatric Orthopaedic Surgeon","Paediatric Respirologist","Paediatric Rheumatologist","Paediatric Surgeon","Paediatric haematologist","Paediatrician","Pain Management Specialist","Palantypist","Palliative Care Nurse","Palliative Care Physician","Pancreatic Surgeon","Paramedic","Pathologist","Pediatric Dentist","Pediatric Psychologist","Pediatric Pulmonologist","Pediatric Radiologist","Pediatric Surgeon","Periodontist","Perioperative Nurse","Pharmacist","Physical Medicine and Rehabilitation Specialist","Physician","Physician Assistant","Physiologist","Physiotherapist","Pituitary Surgeon","Plastic & Reconstructive Surgeon","Play Therapist","Podiatrist","Podiatrist Assistant","Practice Manager","Preventive medicine Specialist","Prosthetist","Prosthodontist","Psychiatric Nurse","Psychiatrist","Psychiatrist for Mental Handicap","Psychoanalyst","Psychogeriatrician","Psychologist","Psychotherapist","Public Health Medicine Specialist","Public Health Nurse","Pulmonologist","Radiation Oncologist","Radiation Oncology","Radiation Therapist","Radiologist","Radiology and Imaging Specialist","Radiotherapy Nurse","Recreational Therapist","Reflexologist","Registered Nurse"],Ce={container:{padding:"32px",width:"100%",height:"100%",backgroundColor:"#fff"},title:{fontSize:"16px",fontWeight:"500",marginBottom:"32px",color:"#1f2937"},section:{maxWidth:"1200px",margin:"0 auto"},formGrid:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"24px"},field:{marginBottom:"24px"},label:{display:"block",fontSize:"14px",color:"#4b5563",marginBottom:"8px"},input:{width:"100%",padding:"8px 12px",fontSize:"14px",border:"1px solid #d1d5db",borderRadius:"6px",color:"#1f2937",backgroundColor:"#fff","&:focus":{outline:"none",borderColor:"#2563eb",boxShadow:"0 0 0 2px rgba(37, 99, 235, 0.2)"}},select:{width:"100%",padding:"8px 12px",fontSize:"14px",border:"1px solid #d1d5db",borderRadius:"6px",color:"#1f2937",backgroundColor:"#fff",cursor:"pointer",appearance:"none",backgroundImage:'url("data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2224%22%20height%3D%2224%22%20viewBox%3D%220%200%2024%2024%22%20fill%3D%22none%22%20stroke%3D%22%236b7280%22%20stroke-width%3D%222%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%3E%3Cpolyline%20points%3D%226%209%2012%2015%2018%209%22%3E%3C%2Fpolyline%3E%3C%2Fsvg%3E")',backgroundRepeat:"no-repeat",backgroundPosition:"right 8px center",backgroundSize:"16px",paddingRight:"32px"},saveButton:{backgroundColor:"#2563eb",color:"white",padding:"10px 20px",borderRadius:"6px",border:"none",fontSize:"14px",fontWeight:"500",cursor:"pointer",transition:"background-color 0.2s","&:hover":{backgroundColor:"#1d4ed8"},"&:disabled":{backgroundColor:"#93c5fd",cursor:"not-allowed"}},disabledInput:{backgroundColor:"#f3f4f6",cursor:"not-allowed"}};function xH(){const{user:t,loading:e}=zt(),n=Be(),[r,i]=y.useState({firstName:"",lastName:"",specialty:"",title:"",organization:"",companySize:"Just me",position:"Individual clinician"}),[o,s]=y.useState(!1);if(ve.useEffect(()=>{if(t){const[c="",u=""]=(t.name||"").split(" ");i({firstName:c,lastName:u,specialty:t.specialty||"",title:t.title||"",organization:t.organization||"",companySize:"Just me",position:"Individual clinician"})}},[t]),e)return h.jsx("div",{children:"Loading..."});if(!t)return h.jsx("div",{children:"Not logged in"});const a=c=>{const{name:u,value:d}=c.target;i(f=>({...f,[u]:d}))},l=async()=>{if(t.id){s(!0);try{const{error:c}=await n.from("user_profiles").update({name:`${r.firstName} ${r.lastName}`.trim(),specialty:r.specialty,title:r.title,organization:r.organization,updated_at:new Date().toISOString()}).eq("id",t.id);if(c)throw c}catch(c){console.error("Error updating profile:",c)}finally{s(!1)}}};return h.jsx("div",{style:Ce.container,children:h.jsxs("div",{style:Ce.section,children:[h.jsx("h1",{style:Ce.title,children:"About you"}),h.jsxs("div",{style:Ce.formGrid,children:[h.jsxs("div",{style:Ce.field,children:[h.jsx("label",{style:Ce.label,children:"Title"}),h.jsx("input",{style:Ce.input,name:"title",value:r.title,onChange:a,type:"text",placeholder:"Enter your title"})]}),h.jsxs("div",{style:Ce.field,children:[h.jsx("label",{style:Ce.label,children:"First name"}),h.jsx("input",{style:Ce.input,type:"text",name:"firstName",value:r.firstName,onChange:a,placeholder:"Enter your first name"})]}),h.jsxs("div",{style:Ce.field,children:[h.jsx("label",{style:Ce.label,children:"Last name"}),h.jsx("input",{style:Ce.input,type:"text",name:"lastName",value:r.lastName,onChange:a,placeholder:"Enter your last name"})]}),h.jsxs("div",{style:Ce.field,children:[h.jsx("label",{style:Ce.label,children:"Specialty"}),h.jsxs("select",{style:Ce.select,name:"specialty",value:r.specialty,onChange:a,children:[h.jsx("option",{value:"",children:"Select a specialty"}),vH.map(c=>h.jsx("option",{value:c,children:c},c))]})]}),h.jsxs("div",{style:Ce.field,children:[h.jsx("label",{style:Ce.label,children:"Organization name"}),h.jsx("input",{style:Ce.input,type:"text",name:"organization",value:r.organization,onChange:a,placeholder:"Enter your organization"})]}),h.jsxs("div",{style:Ce.field,children:[h.jsx("label",{style:Ce.label,children:"Company size"}),h.jsxs("select",{style:Ce.select,name:"companySize",value:r.companySize,onChange:a,children:[h.jsx("option",{value:"Just me",children:"Just me"}),h.jsx("option",{value:"2-10",children:"2-10 employees"}),h.jsx("option",{value:"11-50",children:"11-50 employees"}),h.jsx("option",{value:"51+",children:"51+ employees"})]})]}),h.jsxs("div",{style:Ce.field,children:[h.jsx("label",{style:Ce.label,children:"Position"}),h.jsxs("select",{style:Ce.select,name:"position",value:r.position,onChange:a,children:[h.jsx("option",{value:"Individual clinician",children:"Individual clinician"}),h.jsx("option",{value:"Practice owner",children:"Practice owner"}),h.jsx("option",{value:"Administrator",children:"Administrator"})]})]})]}),h.jsx("div",{style:{marginTop:"24px",textAlign:"right"},children:h.jsx("button",{style:Ce.saveButton,onClick:l,disabled:o,children:o?"Saving...":"Save changes"})})]})})}const wH=[{value:"plain",label:"Plain Text"},{value:"rich_text",label:"Formatted Text"},{value:"without_lists",label:"Formatted Text (Without Lists)"}],rS=[{value:"auto",label:"Multi-lingual"},{value:"en",label:"English"},{value:"zh",label:"Mandarin"},{value:"zh-HK",label:"Cantonese"},{value:"cs",label:"Czech"},{value:"da",label:"Danish"},{value:"nl",label:"Dutch"},{value:"nl-BE",label:"Flemish"},{value:"fr",label:"French"},{value:"de",label:"German"},{value:"el",label:"Greek"},{value:"hi",label:"Hindi"},{value:"id",label:"Indonesian"},{value:"it",label:"Italian"},{value:"ja",label:"Japanese"},{value:"ko",label:"Korean"},{value:"ms",label:"Malay"},{value:"no",label:"Norwegian"},{value:"pl",label:"Polish"},{value:"pt",label:"Portuguese"},{value:"ru",label:"Russian"},{value:"es",label:"Spanish"},{value:"sv",label:"Swedish"},{value:"th",label:"Thai"},{value:"tr",label:"Turkish"},{value:"uk",label:"Ukrainian"},{value:"vi",label:"Vietnamese"}];function bH(){const t=Be(),[e,n]=y.useState({default_copy_mode:"plain",date_format:"MM/DD/YYYY",primary_language:"auto",preferred_note_language:"en",patient_instructions_language:"en",spelling:"en-us",patient_reference_format:"",clinician_reference_format:""});y.useEffect(()=>{(async()=>{const{data:{user:a}}=await t.auth.getUser();if(!(a!=null&&a.id))return;const{data:l}=await t.from("user_profiles").select("note_preferences").eq("id",a.id).single();l!=null&&l.note_preferences&&n(c=>({...c,...l.note_preferences}))})()},[t]);const i=R0(async s=>{try{const{data:{user:a}}=await t.auth.getUser();if(!(a!=null&&a.id))return;const{data:l}=await t.from("user_profiles").select("note_preferences").eq("id",a.id).single(),c=(l==null?void 0:l.note_preferences)||{};await t.from("user_profiles").update({note_preferences:{...c,...s}}).eq("id",a.id)}catch(a){console.error("Failed to update preferences:",a)}},500),o=(s,a)=>{n(l=>({...l,[s]:a})),i({[s]:a})};return h.jsxs("div",{style:{height:"100%",overflow:"auto",paddingRight:"16px"},children:[h.jsx("div",{style:ne.sectionTitle,children:"Editor Settings"}),h.jsx("div",{style:ne.formGrid,children:h.jsxs("div",{style:ne.field,children:[h.jsx("label",{style:ne.label,children:"Default Copy Mode"}),h.jsx("select",{style:ne.select,value:e.default_copy_mode,onChange:s=>o("default_copy_mode",s.target.value),children:wH.map(s=>h.jsx("option",{value:s.value,children:s.label},s.value))})]})}),h.jsx("div",{style:ne.sectionTitle,children:"Date"}),h.jsx("div",{style:ne.formGrid,children:h.jsxs("div",{style:ne.field,children:[h.jsx("label",{style:ne.label,children:"Date format"}),h.jsxs("select",{style:ne.select,value:e.date_format,onChange:s=>o("date_format",s.target.value),children:[h.jsx("option",{value:"MM/DD/YYYY",children:"MM/DD/YYYY"}),h.jsx("option",{value:"DD/MM/YYYY",children:"DD/MM/YYYY"}),h.jsx("option",{value:"D MMM YYYY",children:"D MMM YYYY"}),h.jsx("option",{value:"MMMM DD YYYY",children:"MMMM DD YYYY"}),h.jsx("option",{value:"MMM DD YYYY",children:"MMM DD YYYY"}),h.jsx("option",{value:"YYYY/MM/DD",children:"YYYY/MM/DD"})]})]})}),h.jsx("div",{style:ne.sectionTitle,children:"Language & spelling"}),h.jsxs("div",{style:ne.formGrid,children:[h.jsxs("div",{style:ne.field,children:[h.jsx("label",{style:ne.label,children:"Primary spoken language"}),h.jsx("select",{style:ne.select,value:e.primary_language,onChange:s=>o("primary_language",s.target.value),children:rS.map(s=>h.jsx("option",{value:s.value,children:s.label},s.value))})]}),h.jsxs("div",{style:ne.field,children:[h.jsx("label",{style:ne.label,children:"Preferred Note Language"}),h.jsx("select",{style:ne.select,value:e.preferred_note_language,onChange:s=>o("preferred_note_language",s.target.value),children:rS.filter(s=>s.value!=="auto").map(s=>h.jsx("option",{value:s.value,children:s.label},s.value))})]}),h.jsxs("div",{style:ne.field,children:[h.jsx("label",{style:ne.label,children:"Patient Instructions Language"}),h.jsxs("select",{style:ne.select,value:e.patient_instructions_language,onChange:s=>o("patient_instructions_language",s.target.value),children:[h.jsx("option",{value:"en",children:"English"}),h.jsx("option",{value:"match_spoken",children:"Match spoken language"})]})]}),h.jsxs("div",{style:ne.field,children:[h.jsx("label",{style:ne.label,children:"Spelling"}),h.jsxs("select",{style:ne.select,value:e.spelling,onChange:s=>o("spelling",s.target.value),children:[h.jsx("option",{value:"en-us",children:"English (United States)"}),h.jsx("option",{value:"en-gb",children:"English (United Kingdom)"}),h.jsx("option",{value:"en-au",children:"English (Australia)"}),h.jsx("option",{value:"en-ca",children:"English (Canada)"})]})]})]}),h.jsx("div",{style:ne.sectionTitle,children:"Reference format"}),h.jsxs("div",{style:ne.formGrid,children:[h.jsxs("div",{style:ne.field,children:[h.jsx("label",{style:ne.label,children:"Refer to patient"}),h.jsx("input",{style:ne.input,type:"text",value:e.patient_reference_format,onChange:s=>o("patient_reference_format",s.target.value),placeholder:"e.g Title + Firstname + Lastname"})]}),h.jsxs("div",{style:ne.field,children:[h.jsx("label",{style:ne.label,children:"Refer to clinician"}),h.jsx("input",{style:ne.input,type:"text",value:e.clinician_reference_format,onChange:s=>o("clinician_reference_format",s.target.value),placeholder:"e.g Dr Smith"})]})]})]})}function SH(){const[t,e]=y.useState("preferences");return h.jsx("div",{style:ne.container,children:h.jsxs("div",{style:ne.section,children:[h.jsxs("div",{style:ne.header,children:[h.jsx("h1",{style:ne.title,children:"Settings"}),h.jsxs("div",{style:ne.tabs,children:[h.jsx("div",{style:{...ne.tab,...t==="preferences"?ne.activeTab:{}},onClick:()=>e("preferences"),children:"Note Preferences"}),h.jsx("div",{style:{...ne.tab,...t==="memory"?ne.activeTab:{}},onClick:()=>e("memory"),children:"Memory"})]})]}),h.jsx("div",{style:ne.contentContainer,children:t==="preferences"?h.jsx(bH,{}):h.jsx(Lz,{})})]})})}const Re={container:{padding:"32px",width:"100%",height:"100%",backgroundColor:"#fff"},section:{maxWidth:"1200px",margin:"0 auto"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"32px"},title:{fontSize:"24px",fontWeight:"600",color:"#1f2937"},actions:{display:"flex",gap:"12px"},button:{display:"flex",alignItems:"center",gap:"8px",padding:"8px 16px",borderRadius:"6px",fontSize:"14px",fontWeight:"500"},primaryButton:{backgroundColor:"#1f2937",color:"white",border:"none"},secondaryButton:{backgroundColor:"transparent",color:"#1f2937",border:"1px solid #e5e7eb"},searchBar:{display:"flex",gap:"12px",marginBottom:"24px"},searchInput:{flex:"1",maxWidth:"320px",padding:"8px 12px",border:"1px solid #e5e7eb",borderRadius:"6px",fontSize:"14px"},table:{width:"100%",borderCollapse:"collapse"},tableHeader:{textAlign:"left",padding:"12px 16px",fontSize:"14px",fontWeight:"500",color:"#6b7280",borderBottom:"1px solid #e5e7eb"},tableCell:{padding:"12px 16px",fontSize:"14px",color:"#374151",borderBottom:"1px solid #e5e7eb"},templateType:{fontSize:"12px",padding:"4 px 6px",marginLeft:"8px",backgroundColor:"#f3f4f6",borderRadius:"12px",color:"#6b7280"},actionButton:{padding:"4px",border:"none",background:"none",cursor:"pointer",color:"#6b7280","&:hover":{color:"#374151"}}};function CH(){const[t,e]=y.useState([]),[n,r]=y.useState(!0),[i,o]=y.useState(""),s=Be(),{user:a}=zt();y.useEffect(()=>{(async()=>{try{if(!(a!=null&&a.id))return;const{data:u,error:d}=await s.from("template_library").select("*").or(`owner_id.eq.${a.id}`).order("name");if(d)throw d;e(u||[])}catch(u){console.error("Error fetching templates:",u)}finally{r(!1)}})()},[s,a==null?void 0:a.id]);const l=t.filter(c=>c.name.toLowerCase().includes(i.toLowerCase()));return n?h.jsx("div",{style:Re.container,children:h.jsxs("div",{style:Re.section,children:[h.jsx("h1",{style:Re.title,children:"My Templates"}),h.jsx("div",{children:"Loading templates..."})]})}):h.jsx("div",{style:Re.container,children:h.jsxs("div",{style:Re.section,children:[h.jsxs("div",{style:Re.header,children:[h.jsx("h1",{style:Re.title,children:"My Templates"}),h.jsxs("div",{style:Re.actions,children:[h.jsx("button",{style:{...Re.button,...Re.secondaryButton},children:"Browse community"}),h.jsx("button",{style:{...Re.button,...Re.primaryButton},children:"Create template"})]})]}),h.jsx("div",{style:Re.searchBar,children:h.jsx("input",{type:"text",placeholder:"Search templates...",value:i,onChange:c=>o(c.target.value),style:Re.searchInput})}),h.jsxs("table",{style:Re.table,children:[h.jsx("thead",{children:h.jsxs("tr",{children:[h.jsx("th",{style:Re.tableHeader,children:"Template name"}),h.jsx("th",{style:Re.tableHeader,children:"Creator"}),h.jsx("th",{style:Re.tableHeader,children:"Visibility"}),h.jsx("th",{style:Re.tableHeader})]})}),h.jsx("tbody",{children:l.map(c=>h.jsxs("tr",{children:[h.jsxs("td",{style:Re.tableCell,children:[c.name,h.jsx("span",{style:Re.templateType,children:c.type})]}),h.jsx("td",{style:Re.tableCell,children:c.owner_id===(a==null?void 0:a.id)?"Me":"Library"}),h.jsx("td",{style:Re.tableCell,children:"Just me"}),h.jsx("td",{style:Re.tableCell,children:h.jsx("button",{style:Re.actionButton,children:""})})]},c.id))})]})]})})}const st={container:{padding:"32px",width:"100%",height:"100%",backgroundColor:"#fff"},section:{maxWidth:"1200px",margin:"0 auto"},title:{fontSize:"16px",fontWeight:"500",marginBottom:"32px",color:"#1f2937"},searchContainer:{marginBottom:"24px"},searchInput:{width:"100%",maxWidth:"400px",padding:"8px 16px",fontSize:"14px",border:"1px solid #e5e7eb",borderRadius:"6px","&:focus":{outline:"none",borderColor:"#2563eb",boxShadow:"0 0 0 2px rgba(37, 99, 235, 0.2)"}},templateGrid:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:"16px",marginTop:"24px"},templateCard:{backgroundColor:"white",borderRadius:"8px",border:"1px solid #e5e7eb",padding:"16px",transition:"all 0.2s ease","&:hover":{transform:"translateY(-2px)",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)"}},templateName:{fontSize:"18px",fontWeight:"500",color:"#111827",marginBottom:"8px"},templateDescription:{fontSize:"14px",color:"#6b7280",marginBottom:"12px"},templateMeta:{display:"flex",justifyContent:"space-between",alignItems:"center",fontSize:"12px",color:"#6b7280"},templateType:{display:"inline-block",padding:"2px 8px",backgroundColor:"#f3f4f6",borderRadius:"12px",fontSize:"12px",color:"#374151"},noTemplates:{textAlign:"center",padding:"48px",color:"#6b7280",backgroundColor:"#f9fafb",borderRadius:"8px",border:"1px dashed #e5e7eb"},tagsContainer:{display:"flex",flexWrap:"wrap",gap:"8px",marginBottom:"12px"},tag:{display:"inline-block",padding:"2px 8px",backgroundColor:"#e5e7eb",borderRadius:"12px",fontSize:"12px",color:"#374151"}};function kH(){const[t,e]=y.useState([]),[n,r]=y.useState(!0),[i,o]=y.useState(""),s=Be(),{user:a}=zt();return y.useEffect(()=>{(async()=>{try{const c=s.from("template_library").select("*").neq("owner_id",(a==null?void 0:a.id)||"").order("name");i&&c.or(`name.ilike.%${i}%,description.ilike.%${i}%`);const{data:u,error:d}=await c;if(d)throw d;e(u||[])}catch(c){console.error("Error fetching templates:",c)}finally{r(!1)}})()},[s,i,a==null?void 0:a.id]),n?h.jsx("div",{style:st.container,children:h.jsxs("div",{style:st.section,children:[h.jsx("h1",{style:st.title,children:"Community Templates"}),h.jsx("div",{children:"Loading templates..."})]})}):h.jsx("div",{style:st.container,children:h.jsxs("div",{style:st.section,children:[h.jsx("h1",{style:st.title,children:"Community Templates"}),h.jsx("div",{style:st.searchContainer,children:h.jsx("input",{type:"text",placeholder:"Search templates...",value:i,onChange:l=>o(l.target.value),style:st.searchInput})}),t.length===0?h.jsx("div",{style:st.noTemplates,children:i?"No templates found matching your search.":"No community templates available."}):h.jsx("div",{style:st.templateGrid,children:t.map(l=>h.jsxs("div",{style:st.templateCard,children:[h.jsx("div",{style:st.templateName,children:l.name}),l.description&&h.jsx("div",{style:st.templateDescription,children:l.description}),l.tags&&l.tags.length>0&&h.jsx("div",{style:st.tagsContainer,children:l.tags.map((c,u)=>h.jsx("span",{style:st.tag,children:c},u))}),h.jsxs("div",{style:st.templateMeta,children:[h.jsx("div",{style:st.templateType,children:l.type.charAt(0).toUpperCase()+l.type.slice(1)}),l.specialty&&h.jsx("div",{children:l.specialty})]})]},l.id))})]})})}function ci({children:t}){const{user:e,loading:n,error:r}=zt(),i=zn(),[o,s]=y.useState(!0);return console.log("ProtectedRoute state:",{isAuthenticated:!!e,userId:e==null?void 0:e.id,isLoading:n,hasError:!!r,errorMessage:r,path:i.pathname,isInitialLoad:o}),y.useEffect(()=>{!n&&o&&s(!1)},[n]),n||o?h.jsxs("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,height:"100vh",width:"100vw",display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:"#f3f4f6",flexDirection:"column",gap:"12px",zIndex:9999},children:[h.jsx("div",{style:{width:"48px",height:"48px",border:"4px solid #e5e7eb",borderTopColor:"#3b82f6",borderRadius:"50%",animation:"spin 1s linear infinite"}}),h.jsx("div",{style:{fontSize:"16px",color:"#4b5563",marginTop:"16px"},children:"Loading..."}),h.jsx("style",{children:`
          @keyframes spin {
            to {
              transform: rotate(360deg);
            }
          }
        `})]}):(r&&console.error("ProtectedRoute error:",r),e?(console.log("ProtectedRoute: User authenticated, rendering protected content"),h.jsx(h.Fragment,{children:t})):(console.log("ProtectedRoute: No user found, redirecting to login"),h.jsx(xf,{to:"/login",state:{from:i},replace:!0})))}const be={container:{flex:1,overflowY:"auto",display:"flex",flexDirection:"column"},filtersContainer:{padding:"12px",backgroundColor:"white",borderBottom:"1px solid #e5e7eb",display:"flex",gap:"8px",position:"sticky",top:0,zIndex:10},searchContainer:{flex:1,position:"relative"},searchInput:{width:"100%",padding:"8px 12px 8px 36px",fontSize:"14px",borderRadius:"6px",border:"1px solid #e5e7eb",outline:"none"},searchIcon:{position:"absolute",left:"12px",top:"50%",transform:"translateY(-50%)",color:"#6b7280"},filterButton:{display:"flex",alignItems:"center",gap:"4px",padding:"8px 12px",fontSize:"14px",backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"6px",cursor:"pointer"},dropdownContent:{minWidth:"160px",backgroundColor:"white",borderRadius:"6px",padding:"5px",boxShadow:"0px 10px 38px -10px rgba(22, 23, 24, 0.35), 0px 10px 20px -15px rgba(22, 23, 24, 0.2)",zIndex:9999},dropdownItem:{fontSize:"14px",lineHeight:"1",color:"#374151",borderRadius:"3px",display:"flex",alignItems:"center",height:"32px",padding:"0 8px",userSelect:"none",outline:"none",cursor:"pointer"},selectedDropdownItem:{backgroundColor:"#f0f9ff",color:"#2563eb"},listContainer:{flex:1,overflowY:"auto"},dateGroup:{display:"flex",flexDirection:"column",gap:"1px",marginBottom:"16px"},dateHeader:{fontSize:"12px",fontWeight:"600",color:"#6b7280",padding:"4px 12px",backgroundColor:"#f9fafb",borderTop:"1px solid #e5e7eb",borderBottom:"1px solid #e5e7eb",textTransform:"uppercase",letterSpacing:"0.05em"},visitItem:{display:"flex",flexDirection:"column",padding:"8px 12px",backgroundColor:"white",cursor:"pointer",transition:"all 0.2s ease",position:"relative"},selectedVisit:{backgroundColor:"#f0f9ff"},visitHeader:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",gap:"8px"},visitName:{fontSize:"15px",fontWeight:"600",color:"#111827",flex:1},visitState:{fontSize:"12px",padding:"2px 6px",borderRadius:"4px",backgroundColor:"#f3f4f6",color:"#374151",textTransform:"capitalize",flexShrink:0},visitTime:{fontSize:"12px",color:"#6b7280",marginTop:"2px"},loadingContainer:{display:"flex",justifyContent:"center",alignItems:"center",height:"100px",color:"#6b7280"},actionIcons:{position:"absolute",bottom:"8px",right:"12px",display:"flex",gap:"6px",opacity:0,transition:"opacity 0.2s ease"},actionIconsVisible:{opacity:1},iconButton:{background:"none",backgroundColor:"transparent",border:"none",cursor:"pointer",padding:"2px",borderRadius:"4px",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s ease"},iconButtonHover:{backgroundColor:"#d1d5db"},trashIcon:{},letterIcon:{}},EH=y.memo(function({visit:e,isSelected:n,onSelect:r}){const[i,o]=y.useState(!1),[s,a]=y.useState(!1),[l,c]=y.useState(!1),{showToast:u}=PO(),{data:d}=_c({queryKey:["patient",e.patient_id],queryFn:async()=>{if(!e.patient_id)return null;const{data:S}=await pn.from("patient_profiles").select("name").eq("id",e.patient_id).single();return S},enabled:!!e.patient_id}),f=(d==null?void 0:d.name)||e.name||"Untitled",p=new Date(e.started_at).toLocaleTimeString([],{hour:"numeric",minute:"2-digit"}),g=`${new Date(e.started_at).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})} at ${p}`,v=async S=>{S.stopPropagation();const{error:b}=await pn.from("visits").update({state:"trash"}).eq("id",e.id);b?(console.error("Error updating visit state:",b),u("Error","Failed to move visit to trash","error")):u("Success",`"${f}" (${g}) moved to trash`,"success")},x=async S=>{S.stopPropagation();const{error:b}=await pn.from("visits").update({state:"completed"}).eq("id",e.id);b?(console.error("Error updating visit state:",b),u("Error","Failed to mark visit as completed","error")):u("Success",`"${f}" (${g}) marked as completed`,"success")},w=async()=>{if(e.state==="ready"){const{error:S}=await pn.from("visits").update({state:"seen"}).eq("id",e.id);S&&console.error("Error updating visit state:",S)}r(e)};return h.jsxs("div",{style:{...be.visitItem,...n?be.selectedVisit:{}},onClick:w,onMouseEnter:()=>o(!0),onMouseLeave:()=>o(!1),children:[h.jsxs("div",{style:be.visitHeader,children:[h.jsx("div",{style:be.visitName,children:f}),h.jsx("div",{style:be.visitState,children:e.state})]}),h.jsx("div",{style:be.visitTime,children:p}),h.jsxs("div",{style:{...be.actionIcons,...i?be.actionIconsVisible:{}},children:[["ready","seen","completed"].includes(e.state)&&h.jsx("button",{style:{...be.iconButton,...s?be.iconButtonHover:{}},onClick:v,title:"Move to trash",onMouseEnter:()=>a(!0),onMouseLeave:()=>a(!1),children:h.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",fill:"currentColor",viewBox:"0 0 16 16",children:[h.jsx("path",{d:"M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z"}),h.jsx("path",{fillRule:"evenodd",d:"M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"})]})}),["ready","seen"].includes(e.state)&&h.jsx("button",{style:{...be.iconButton,...l?be.iconButtonHover:{}},onClick:x,title:"Mark as completed",onMouseEnter:()=>c(!0),onMouseLeave:()=>c(!1),children:h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",fill:"currentColor",viewBox:"0 0 16 16",children:h.jsx("path",{d:"M8.47 1.318a1 1 0 0 0-.94 0l-6 3.2A1 1 0 0 0 1 5.4v.817l5.75 3.45L8 8.917l1.25.75L15 6.217V5.4a1 1 0 0 0-.53-.882l-6-3.2ZM15 7.383l-4.778 2.867L15 13.117V7.383Zm-.035 6.88L8 10.082l-6.965 4.18A1 1 0 0 0 2 15h12a1 1 0 0 0 .965-.738ZM1 13.116l4.778-2.867L1 7.383v5.734ZM7.059.435a2 2 0 0 1 1.882 0l6 3.2A2 2 0 0 1 16 5.4V14a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V5.4a2 2 0 0 1 1.059-1.765l6-3.2Z"})})})]})]})});function TH({visits:t,onVisitSelect:e,selectedVisitId:n,onContinueRecording:r}){const{user:i}=zt(),[o,s]=y.useState(!0),[a,l]=y.useState(""),[c,u]=y.useState("todo"),[d,f]=y.useState({});y.useEffect(()=>{const w=[...new Set(t.filter(S=>S.patient_id).map(S=>S.patient_id))];w.length>0&&(async()=>{const{data:b,error:C}=await pn.from("patient_profiles").select("id, name").in("id",w);if(!C&&b){const k=b.reduce((E,T)=>(E[T.id]=T.name,E),{});f(k)}})()},[t]);const p=y.useCallback(w=>{w.state==="paused"&&r?r(w):e==null||e(w)},[r,e]),m=y.useMemo(()=>t.filter(w=>{var k,E;if(c==="todo"){if(["trash","completed","deleted"].includes(w.state))return!1}else if(c==="all"){if(["trash","deleted"].includes(w.state))return!1}else if(c==="trash"&&w.state!=="trash")return!1;if(!a)return!0;const S=a.toLowerCase(),b=((k=w.name)==null?void 0:k.toLowerCase())||"",C=w.patient_id&&((E=d[w.patient_id])==null?void 0:E.toLowerCase())||"";return b.includes(S)||C.includes(S)}),[t,a,c,d]),g=y.useMemo(()=>m.reduce((w,S)=>{const b=new Date(S.started_at).toLocaleDateString("en-US",{month:"2-digit",day:"2-digit",year:"numeric"});return w[b]||(w[b]=[]),w[b].push(S),w},{}),[m]);y.useEffect(()=>{i!=null&&i.id&&s(t.length===0)},[i==null?void 0:i.id,t.length]);const v=w=>{switch(w){case"todo":return"To Do";case"all":return"All";case"trash":return"Trash";default:return"To Do"}};if(!(i!=null&&i.id)||o)return h.jsx("div",{style:be.container,children:h.jsx("div",{style:be.loadingContainer,children:o?"Your visits will appear here":"Loading..."})});const x=Object.keys(g).sort((w,S)=>new Date(S).getTime()-new Date(w).getTime());return h.jsxs("div",{style:be.container,children:[h.jsxs("div",{style:be.filtersContainer,children:[h.jsxs("div",{style:be.searchContainer,children:[h.jsx("input",{type:"text",placeholder:"Search",value:a,onChange:w=>l(w.target.value),style:be.searchInput}),h.jsx("span",{style:be.searchIcon,children:h.jsx(o6,{width:16,height:16})})]}),h.jsxs(tl,{children:[h.jsx(nl,{asChild:!0,children:h.jsxs("button",{style:be.filterButton,children:[v(c),h.jsx(Bh,{width:16,height:16})]})}),h.jsx(rl,{children:h.jsx(il,{style:be.dropdownContent,sideOffset:5,children:["todo","all","trash"].map(w=>{const S=w===c;return h.jsx(Gt,{style:{...be.dropdownItem,...S?be.selectedDropdownItem:{}},onClick:()=>u(w),children:v(w)},w)})})})]})]}),h.jsx("div",{style:be.listContainer,children:x.length>0?x.map(w=>h.jsxs("div",{style:be.dateGroup,children:[h.jsx("div",{style:be.dateHeader,children:w}),g[w].sort((S,b)=>new Date(b.started_at).getTime()-new Date(S.started_at).getTime()).map(S=>h.jsx(EH,{visit:S,isSelected:S.id===n,onSelect:p},S.id))]},w)):h.jsx("div",{style:be.loadingContainer,children:a?"No matching visits found":`No visits in ${v(c).toLowerCase()}`})})]})}const _H=({user:t,onSignOut:e})=>{const n=Un();return h.jsx("div",{style:yt.userSection,children:h.jsxs(tl,{children:[h.jsx(nl,{asChild:!0,children:h.jsxs("button",{style:yt.userButton,children:[h.jsxs("div",{style:yt.userInfo,children:[h.jsxs("span",{style:yt.userName,children:[t!=null&&t.title?`${t.title} `:""," ",t!=null&&t.name?`${t.name}`:"User"]}),h.jsx("span",{style:yt.userSpecialty,children:(t==null?void 0:t.specialty)||"No specialty set"})]}),h.jsx(Bh,{style:yt.chevronIcon})]})}),h.jsx(rl,{children:h.jsxs(il,{style:yt.dropdownContent,sideOffset:5,align:"start",children:[h.jsx(Gt,{asChild:!0,children:h.jsx("button",{style:yt.dropdownItem,onClick:()=>n("/profile"),children:"Profile"})}),h.jsx(Gt,{asChild:!0,children:h.jsx("button",{style:yt.dropdownItem,onClick:()=>n("/settings"),children:"Settings"})}),h.jsx(Gt,{asChild:!0,children:h.jsx("button",{style:yt.dropdownItem,onClick:()=>n("/group"),children:"Group Settings"})}),h.jsx(Gt,{asChild:!0,children:h.jsx("button",{style:yt.dropdownItem,onClick:()=>n("/patients"),children:"Patients"})}),h.jsx(G1,{style:yt.dropdownSeparator}),h.jsx(Gt,{asChild:!0,children:h.jsx("button",{style:yt.dropdownItem,onClick:()=>n("/my-templates"),children:"My Templates"})}),h.jsx(Gt,{asChild:!0,children:h.jsx("button",{style:yt.dropdownItem,onClick:()=>n("/community-templates"),children:"Community Templates"})}),h.jsx(G1,{style:yt.dropdownSeparator}),h.jsx(Gt,{asChild:!0,children:h.jsx("button",{style:yt.dropdownItem,onClick:e,children:"Logout"})})]})})]})})},yt={userSection:{padding:"12px",borderBottom:"1px solid #e5e7eb"},userButton:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%",padding:"8px",border:"none",borderRadius:"6px",background:"transparent",cursor:"pointer",":hover":{backgroundColor:"#f5f5f5"}},userInfo:{display:"flex",flexDirection:"column",alignItems:"flex-start",gap:"2px"},userName:{fontSize:"14px",fontWeight:600,color:"#111827"},userSpecialty:{fontSize:"12px",color:"#6b7280",fontWeight:500},chevronIcon:{width:"16px",height:"16px",color:"#666"},dropdownContent:{maxWidth:"280px",backgroundColor:"white",borderRadius:"6px",padding:"4px",boxShadow:"0 2px 10px rgba(0, 0, 0, 0.1)",zIndex:100},dropdownItem:{width:"100%",border:"none",borderRadius:"4px",padding:"8px 12px",fontSize:"14px",textAlign:"left",backgroundColor:"transparent",cursor:"pointer",":hover":{backgroundColor:"#f5f5f5"}},dropdownSeparator:{height:"1px",backgroundColor:"#eaeaea",margin:"4px 0"}},Tm={sidebar:{width:"240px",backgroundColor:"#ffffff",display:"flex",flexDirection:"column",overflow:"hidden",borderRight:"1px solid #d1d5db",height:"100vh",position:"relative",zIndex:50},userSection:{padding:"16px 16px 12px 16px",borderBottom:"1px solid #d1d5db",backgroundColor:"#ffffff",marginBottom:"8px"},userButton:{width:"100%",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"12px",backgroundColor:"transparent",border:"none",cursor:"pointer",transition:"all 0.2s ease","&:hover":{backgroundColor:"#f3f4f6"}},userInfo:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1},userName:{fontSize:"14px",fontWeight:"500",color:"#111827"},userEmail:{fontSize:"12px",color:"#6b7280",marginTop:"2px"},chevronIcon:{color:"#9ca3af",width:"12px",height:"12px",marginLeft:"8px",flexShrink:0},dropdownContent:{minWidth:"200px",backgroundColor:"white",borderRadius:"8px",padding:"6px",boxShadow:"0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05)",border:"1px solid #e5e7eb"},dropdownItem:{fontSize:"14px",padding:"8px 12px",borderRadius:"6px",cursor:"pointer",color:"#374151",display:"block",width:"100%",textAlign:"left",border:"none",backgroundColor:"transparent",transition:"all 0.2s ease","&:hover":{backgroundColor:"#f3f4f6",color:"#111827"}},dropdownSeparator:{height:"1px",backgroundColor:"#e5e7eb",margin:"6px"},newSessionButton:{display:"flex",alignItems:"center",backgroundColor:"#FF8080",color:"#ffffff",border:"none",cursor:"pointer",fontSize:"14px",fontWeight:"600",margin:"16px 12px 16px 12px",width:"calc(100% - 24px)",justifyContent:"center",borderRadius:"8px",transition:"all 0.2s ease","&:hover":{backgroundColor:"#ff6666",transform:"translateY(-1px)"},"&:active":{transform:"translateY(0px)"}},visitsContainer:{flex:1,overflow:"auto",borderTop:"1px solid #e5e7eb"}};function RH({onNewSession:t,onVisitSelect:e,selectedVisitId:n,onContinueRecording:r,visits:i=[]}){const o=Un(),{user:s}=zt(),{signOut:a}=WO();console.log("[Sidebar] Render with visits:",i.length);const l=async()=>{try{await a(),o("/login")}catch(c){console.error("Error signing out:",c)}};if(s)return h.jsxs("div",{style:Tm.sidebar,children:[h.jsx(_H,{user:s,onSignOut:l}),h.jsx("button",{style:Tm.newSessionButton,onClick:t,children:"New Session"}),h.jsx("div",{style:Tm.visitsContainer,children:h.jsx(TH,{visits:i,onVisitSelect:e,selectedVisitId:n,onContinueRecording:r})})]})}const Qe=(...t)=>{console.log("[useRealtimeVisits]",...t)};function OH(t){const[e,n]=y.useState([]),r=y.useRef(!1),i=y.useRef(null),o=y.useRef(null),s=y.useRef([]);y.useEffect(()=>{s.current=e,Qe("Updated visitsRef:",e.length,"visits")},[e]),y.useEffect(()=>{if(!t||r.current)return;(async()=>{Qe("Fetching initial visits for user:",t);const{data:c,error:u}=await pn.from("visits").select("*").eq("user_id",t).order("started_at",{ascending:!1});if(u){Qe("Error fetching initial visits:",u);return}c&&(Qe(`Setting initial ${c.length} visits`),n(c),s.current=c,r.current=!0)})()},[t]);const a=y.useCallback(l=>{const c=[...l].sort((u,d)=>new Date(d.started_at).getTime()-new Date(u.started_at).getTime());n(c)},[]);return y.useEffect(()=>{if(!t){Qe("No userId, skipping subscription");return}Qe("Setting up realtime subscription for user:",t),i.current&&(Qe("Cleaning up existing subscription"),i.current.unsubscribe(),i.current=null);const l=pn.channel(`visits_list_${t}`).on("postgres_changes",{event:"*",schema:"public",table:"visits",filter:`user_id=eq.${t}`},c=>{const u=new Date().toISOString(),d=o.current?new Date(u).getTime()-new Date(o.current).getTime():null;switch(Qe("Received realtime event:",c.eventType,{...c,timeSinceLastUpdate:d?`${d}ms`:"first update",currentVisitsCount:s.current.length}),o.current=u,c.eventType){case Ki.INSERT:{const f=c.new;if(Qe("Processing insert for visit:",f.id),s.current.some(m=>m.id===f.id)){Qe("Visit already exists, skipping insert:",f.id);return}const p=[f,...s.current];Qe(`Updating visits after insert: ${p.length} visits`),a(p);break}case Ki.UPDATE:{const f=c.new;Qe("Processing update for visit:",f.id);const p=s.current.map(m=>m.id===f.id?f:m);Qe(`Updating visits after update: ${p.length} visits`),a(p);break}case Ki.DELETE:{const f=c.old;Qe("Processing delete for visit:",f.id);const p=s.current.filter(m=>m.id!==f.id);Qe(`Updating visits after delete: ${p.length} visits`),a(p);break}}}).subscribe(c=>{Qe("Subscription status:",c)});return i.current=l,()=>{Qe("Cleaning up subscription in effect cleanup"),l.unsubscribe(),i.current=null}},[t,a]),y.useEffect(()=>{Qe("Visits state updated:",e.length,"visits")},[e]),e}function _m({title:t,children:e}){const[n,r]=y.useState(!1);return h.jsxs("div",{className:"border border-gray-200 rounded-md mb-4",children:[h.jsxs("button",{onClick:()=>r(!n),className:"w-full px-4 py-3 flex items-center justify-between bg-gray-50 hover:bg-gray-100 transition-colors rounded-t-md",children:[h.jsx("h3",{className:"text-sm font-medium text-gray-700",children:t}),n?h.jsx(aR,{className:"h-4 w-4 text-gray-500"}):h.jsx(Wz,{className:"h-4 w-4 text-gray-500"})]}),n&&h.jsx("div",{className:"p-4 bg-white rounded-b-md",children:e})]})}function PH({onClick:t,icon:e,label:n,loading:r=!1,disabled:i=!1}){return h.jsxs("button",{onClick:t,disabled:r||i,className:`
        flex items-center gap-2 px-3 py-2 text-sm 
        ${i?"bg-gray-100 text-gray-400":"bg-gray-50 text-gray-700 hover:bg-gray-100"} 
        rounded-md transition-colors
        ${r?"cursor-not-allowed":""}
      `,children:[r?h.jsx(lR,{className:"h-4 w-4 animate-spin"}):e,n]})}function MH(){const[t,e]=i2(),n=Be(),[r,i]=y.useState(t.get("visitId")||""),[o,s]=y.useState(void 0),[a,l]=y.useState(void 0),[c,u]=y.useState([]),[d,f]=y.useState([]),[p,m]=y.useState([]),{getValidSessionToken:g}=Hh(),[v,x]=y.useState(!1);y.useEffect(()=>{const R=t.get("visitId");R&&(i(R),w(R))},[]);const w=async R=>{const I=R||r;if(I.trim()){l(void 0);try{const{data:$,error:P}=await n.from("visits").select("*").eq("id",I.trim()).single();if(P)throw P;s($),e({visitId:I.trim()}),await S(I.trim())}catch($){console.error("Error fetching visit:",$),l("Visit not found"),s(void 0),e({}),u([]),f([]),m([])}}},S=async R=>{try{const{data:I,error:$}=await n.from("transcripts").select("*").eq("visit_id",R).order("created_at",{ascending:!1});if($)throw $;u(I||[]);const{data:P,error:M}=await n.from("containers").select("*").eq("visit_id",R).order("chunk_id",{ascending:!0});if(M)throw M;f(P||[]);const{data:z,error:B}=await n.from("notes").select("*").eq("visit_id",R).order("created_at",{ascending:!1});if(B)throw B;m(z||[])}catch(I){console.error("Error loading visit data:",I),l("Failed to load visit data")}},b=async()=>{if(!(!(o!=null&&o.id)||v))try{x(!0);const R=await g(),I=await fetch(`${Tr.apiUrl}/admin/regenerate-visit`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json",Authorization:`Bearer ${R}`,Accept:"application/json"},body:JSON.stringify({visitId:o.id})});if(!I.ok){const $=await I.text();let P="Failed to regenerate visit";try{P=JSON.parse($).error||P}catch{P=$||P}throw new Error(P)}await S(o.id)}catch(R){console.error("Error regenerating visit:",R),l(R instanceof Error?R.message:"Failed to regenerate visit")}finally{x(!1)}},C=()=>{if(o)return h.jsx("div",{className:"bg-white rounded-lg shadow-sm mb-6",children:h.jsxs("div",{className:"p-6",children:[h.jsx("div",{className:"flex items-center justify-between mb-6",children:h.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"Visit Details"})}),h.jsxs("dl",{className:"grid grid-cols-2 gap-6",children:[h.jsxs("div",{children:[h.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"ID"}),h.jsx("dd",{className:"mt-1 text-sm text-gray-900",children:o.id})]}),h.jsxs("div",{children:[h.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Created At"}),h.jsx("dd",{className:"mt-1 text-sm text-gray-900",children:new Date(o.created_at).toLocaleString()})]}),h.jsxs("div",{children:[h.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Patient ID"}),h.jsx("dd",{className:"mt-1 text-sm text-gray-900",children:o.patient_id||"No patient assigned"})]}),h.jsxs("div",{children:[h.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"State"}),h.jsx("dd",{className:"mt-1 text-sm text-gray-900",children:o.state})]})]})]})})},k=()=>{if(o)return h.jsx("div",{className:"bg-white rounded-lg shadow-sm p-4 mb-6",children:h.jsx("div",{className:"flex items-center gap-4",children:h.jsx(PH,{onClick:b,icon:h.jsx(lR,{className:"h-4 w-4"}),label:"Regenerate SOAP Note",loading:v,disabled:!(o!=null&&o.id)})})})},E=()=>h.jsx(_m,{title:`Transcripts (${c.length})`,children:h.jsx("div",{className:"space-y-4",children:c.map(R=>h.jsxs("div",{className:"border border-gray-200 rounded p-3",children:[h.jsxs("div",{className:"flex justify-between mb-2",children:[h.jsx("span",{className:"text-xs text-gray-500",children:new Date(R.created_at).toLocaleString()}),h.jsxs("span",{className:"text-xs text-gray-500",children:["ID: ",R.id]})]}),h.jsx("p",{className:"text-sm text-gray-700 whitespace-pre-wrap",children:R.full_text})]},R.id))})}),T=()=>h.jsx(_m,{title:`Container Fragments (${d.length})`,children:h.jsx("div",{className:"space-y-4",children:d.map(R=>h.jsxs("div",{className:"border border-gray-200 rounded p-3",children:[h.jsxs("div",{className:"flex justify-between mb-2",children:[h.jsxs("span",{className:"text-xs text-gray-500",children:["Chunk ",R.chunk_id,"  ",R.state]}),h.jsx("span",{className:"text-xs text-gray-500",children:new Date(R.created_at).toLocaleString()})]}),h.jsx("p",{className:"text-sm text-gray-700 whitespace-pre-wrap",children:R.transcript_fragment||"No text available"})]},R.id))})}),O=()=>h.jsx(_m,{title:`Notes (${p.length})`,children:h.jsx("div",{className:"space-y-4",children:p.map(R=>h.jsxs("div",{className:"border border-gray-200 rounded p-3",children:[h.jsxs("div",{className:"flex justify-between mb-2",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("span",{className:"text-xs font-medium text-gray-700",children:R.type}),R.version_id&&h.jsxs("span",{className:"text-xs bg-gray-100 text-gray-600 px-2 py-0.5 rounded",children:["v",R.version_id]}),R.template_id&&h.jsx("span",{className:"text-xs text-gray-500",children:"Template"})]}),h.jsx("span",{className:"text-xs text-gray-500",children:new Date(R.created_at).toLocaleString()})]}),h.jsx("p",{className:"text-sm text-gray-700 whitespace-pre-wrap",children:R.content}),R.metadata&&Object.keys(R.metadata).length>0&&h.jsx("div",{className:"mt-2 pt-2 border-t border-gray-200",children:h.jsxs("details",{children:[h.jsx("summary",{className:"text-xs text-gray-500 cursor-pointer",children:"Metadata"}),h.jsx("pre",{className:"mt-2 text-xs text-gray-600 overflow-auto",children:JSON.stringify(R.metadata,null,2)})]})})]},R.id))})});return h.jsxs("div",{className:"h-screen bg-gray-50 flex",children:[h.jsxs("div",{className:"w-80 bg-white border-r border-gray-200 p-6 flex flex-col gap-6",children:[h.jsx("h1",{className:"text-xl font-semibold text-gray-900",children:"Admin Tools"}),h.jsxs("div",{className:"flex flex-col gap-2",children:[h.jsx("h2",{className:"text-sm font-medium text-gray-700",children:"Visit Search"}),h.jsx("input",{type:"text",value:r,onChange:R=>i(R.target.value),placeholder:"Enter Visit ID",className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),h.jsx("button",{onClick:()=>w(),className:"w-full px-3 py-2 text-sm bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors",children:"Search"})]}),h.jsxs("div",{className:"flex flex-col gap-2",children:[h.jsx("h2",{className:"text-sm font-medium text-gray-700",children:"Actions"}),h.jsx("button",{className:"w-full px-3 py-2 text-sm text-gray-700 bg-gray-50 hover:bg-gray-100 rounded-md text-left transition-colors",children:"Future Action 1"}),h.jsx("button",{className:"w-full px-3 py-2 text-sm text-gray-700 bg-gray-50 hover:bg-gray-100 rounded-md text-left transition-colors",children:"Future Action 2"})]})]}),h.jsxs("div",{className:"flex-1 p-6 overflow-auto",children:[a&&h.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-4 mb-6",children:h.jsx("p",{className:"text-sm text-red-600",children:a})}),o&&h.jsxs(h.Fragment,{children:[C(),k(),E(),T(),O()]})]})]})}const AH=["test@localhost"];function DH({children:t}){const{user:e,loading:n}=zt();return n?h.jsx("div",{children:"Loading..."}):!e||!AH.includes(e.email||"")?h.jsx(xf,{to:"/record",replace:!0}):h.jsx(h.Fragment,{children:t})}function iS({isOpen:t,onOpenChange:e,patient:n,mode:r,onSuccess:i}){const o=Be(),{user:s}=zt(),a=uo(),l=Rc({mutationFn:async v=>{if(!(s!=null&&s.id))throw new Error("No user");const{data:x,error:w}=await o.from("patient_profiles").insert({...v,user_id:s.id,contact_information:{},ai_context:null}).select().single();if(w)throw w;return x},onSuccess:()=>{a.invalidateQueries({queryKey:["patients"]}),e(!1),i&&i()}}),c=Rc({mutationFn:async v=>{const{data:x,error:w}=await o.from("patient_profiles").update(v).eq("id",v.id).select().single();if(w)throw w;return x},onSuccess:()=>{a.invalidateQueries({queryKey:["patients"]}),e(!1),i&&i()}}),u=v=>{v.preventDefault();const x=new FormData(v.currentTarget),w=x.get("name");if(!w)return;const S={name:w,medical_record_number:x.get("medical_record_number")||null,phone:x.get("phone")||null,email:x.get("email")||null,pronoun:x.get("pronoun")||null,notes:x.get("notes")||null};l.mutate(S)},d=v=>{if(v.preventDefault(),!n)return;const x=new FormData(v.currentTarget),w={...n,name:x.get("name"),medical_record_number:x.get("medical_record_number")||null,phone:x.get("phone")||null,email:x.get("email")||null,pronoun:x.get("pronoun")||null,notes:x.get("notes")||null};c.mutate(w)},f=({patient:v,onSubmit:x})=>h.jsxs("form",{onSubmit:x,style:ke.form,children:[h.jsxs("div",{style:ke.formGroup,children:[h.jsx("label",{htmlFor:"name",style:ke.label,children:"Name*"}),h.jsx("input",{id:"name",name:"name",type:"text",required:!0,defaultValue:(v==null?void 0:v.name)||"",style:ke.input})]}),h.jsxs("div",{style:ke.formGroup,children:[h.jsx("label",{htmlFor:"medical_record_number",style:ke.label,children:"Medical Record Number"}),h.jsx("input",{id:"medical_record_number",name:"medical_record_number",type:"text",defaultValue:(v==null?void 0:v.medical_record_number)||"",style:ke.input})]}),h.jsxs("div",{style:ke.formGroup,children:[h.jsx("label",{htmlFor:"pronoun",style:ke.label,children:"Pronoun"}),h.jsx("input",{id:"pronoun",name:"pronoun",type:"text",defaultValue:(v==null?void 0:v.pronoun)||"",style:ke.input})]}),h.jsxs("div",{style:ke.formGroup,children:[h.jsx("label",{htmlFor:"phone",style:ke.label,children:"Phone"}),h.jsx("input",{id:"phone",name:"phone",type:"tel",defaultValue:(v==null?void 0:v.phone)||"",style:ke.input})]}),h.jsxs("div",{style:ke.formGroup,children:[h.jsx("label",{htmlFor:"email",style:ke.label,children:"Email"}),h.jsx("input",{id:"email",name:"email",type:"email",defaultValue:(v==null?void 0:v.email)||"",style:ke.input})]}),h.jsxs("div",{style:ke.formGroup,children:[h.jsx("label",{htmlFor:"notes",style:ke.label,children:"Notes"}),h.jsx("textarea",{id:"notes",name:"notes",defaultValue:(v==null?void 0:v.notes)||"",style:{...ke.input,minHeight:"100px"}})]}),h.jsx("div",{style:ke.formActions,children:h.jsx("button",{type:"submit",style:ke.primaryButton,children:r==="edit"?"Update Patient":"Add Patient"})})]}),p=r==="add"?"Add New Patient":"Edit Patient",m=r==="add"?"Fill in the details to add a new patient.":"Update patient information.",g=r==="add"?u:d;return h.jsx(Bf,{open:t,onOpenChange:e,children:h.jsxs(zf,{children:[h.jsx(Uf,{style:ke.overlay}),h.jsxs(Vf,{style:ke.dialogContent,children:[h.jsx(Hf,{style:ke.dialogTitle,children:p}),h.jsx(iR,{style:ke.dialogDescription,children:m}),h.jsx(f,{patient:n,onSubmit:g}),h.jsx(Cy,{asChild:!0,children:h.jsx("button",{style:ke.closeButton,children:h.jsx(Uc,{})})})]})]})})}const ke={overlay:{backgroundColor:"rgba(0, 0, 0, 0.4)",position:"fixed",inset:0,animation:"overlayShow 150ms cubic-bezier(0.16, 1, 0.3, 1)"},dialogContent:{backgroundColor:"white",borderRadius:"6px",boxShadow:"0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)",position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"90vw",maxWidth:"500px",maxHeight:"85vh",padding:"24px",animation:"contentShow 150ms cubic-bezier(0.16, 1, 0.3, 1)",overflow:"auto"},dialogTitle:{margin:0,fontWeight:600,color:"#111827",fontSize:"18px"},dialogDescription:{marginTop:"8px",marginBottom:"20px",color:"#6b7280",fontSize:"14px"},closeButton:{position:"absolute",top:"16px",right:"16px",backgroundColor:"transparent",border:"none",borderRadius:"4px",cursor:"pointer",color:"#6b7280",display:"flex",padding:"4px"},form:{display:"flex",flexDirection:"column",gap:"16px"},formGroup:{display:"flex",flexDirection:"column",gap:"4px"},label:{fontSize:"14px",fontWeight:500,color:"#374151"},input:{padding:"8px 12px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"14px",color:"#1f2937"},formActions:{display:"flex",justifyContent:"flex-end",gap:"12px",marginTop:"12px"},primaryButton:{padding:"8px 16px",backgroundColor:"#3b82f6",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"14px",fontWeight:500},secondaryButton:{padding:"8px 16px",backgroundColor:"white",color:"#374151",border:"1px solid #d1d5db",borderRadius:"6px",cursor:"pointer",fontSize:"14px",fontWeight:500}};function IH(){const t=Be(),{user:e}=zt(),n=uo(),r=Un(),[i,o]=y.useState(null),[s,a]=y.useState(!1),[l,c]=y.useState(!1),[u,d]=y.useState(!1),[f,p]=y.useState(!1),[m,g]=y.useState([]),[v,x]=y.useState({}),w=async P=>{const{data:M,error:z}=await t.from("visits").select("created_at").eq("patient_id",P).order("created_at",{ascending:!1}).limit(1);return z||!M||M.length===0?null:M[0].created_at},{data:S=[],isLoading:b}=_c({queryKey:["patients",e==null?void 0:e.id],queryFn:async()=>{if(!(e!=null&&e.id))return[];const{data:P,error:M}=await t.from("patient_profiles").select("*").eq("user_id",e.id).order("name",{ascending:!0});if(M)throw M;return(P||[]).sort((z,B)=>z.name.toLowerCase().localeCompare(B.name.toLowerCase()))},enabled:!!(e!=null&&e.id)});y.useEffect(()=>{(async()=>{if(!S.length)return;const M={},z=S.map(async B=>{const H=await w(B.id);M[B.id]=H});await Promise.all(z),x(M)})()},[S,t]);const C=P=>{if(!P)return"Never";const M=new Date(P);return isNaN(M.getTime())?"Invalid date":M.toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})},k=Rc({mutationFn:async P=>{const{error:M}=await t.from("patient_profiles").delete().eq("id",P);if(M)throw M;return P},onSuccess:()=>{n.invalidateQueries({queryKey:["patients"]}),d(!1)}}),E=async P=>{const{data:M,error:z}=await t.from("visits").select("*").eq("patient_id",P).order("created_at",{ascending:!1});if(z){console.error("Error loading patient visits:",z);return}g(M||[])},T=async P=>{o(P),await E(P.id),p(!0)},O=()=>{i&&k.mutate(i.id)},R=P=>({processing:"Processing",completed:"Completed",paused:"Paused",recording:"Recording",preparing:"Preparing",ready:"Ready",cancelled:"Cancelled",failed:"Failed",deleted:"Deleted"})[P]||P,I=P=>({processing:"#fbbf24",completed:"#34d399",paused:"#f59e0b",recording:"#60a5fa",preparing:"#a855f7",ready:"#10b981",cancelled:"#9ca3af",failed:"#ef4444",deleted:"#6b7280"})[P]||"#6b7280",$=P=>{r(`/visit/${P}`)};return h.jsxs("div",{style:te.container,children:[h.jsxs("div",{style:te.header,children:[h.jsx("h1",{style:te.title,children:"Patients"}),h.jsxs("button",{onClick:()=>a(!0),style:te.addButton,children:[h.jsx(Vc,{}),h.jsx("span",{children:"Add Patient"})]})]}),b?h.jsx("div",{style:te.loading,children:"Loading patients..."}):S.length===0?h.jsxs("div",{style:te.emptyState,children:[h.jsx("p",{children:"No patients found. Add your first patient to get started."}),h.jsx("button",{onClick:()=>a(!0),style:te.primaryButton,children:"Add Patient"})]}):h.jsx("div",{style:te.tableContainer,children:h.jsxs("table",{style:te.table,children:[h.jsx("thead",{children:h.jsxs("tr",{children:[h.jsx("th",{style:te.th,children:"Name"}),h.jsx("th",{style:te.th,children:"MRN"}),h.jsx("th",{style:te.th,children:"Phone"}),h.jsx("th",{style:te.th,children:"Email"}),h.jsx("th",{style:te.th,children:"Last Visit"}),h.jsx("th",{style:te.th,children:"Actions"})]})}),h.jsx("tbody",{children:S.map(P=>h.jsxs("tr",{style:te.tr,children:[h.jsx("td",{style:te.td,children:P.name}),h.jsx("td",{style:te.td,children:P.medical_record_number||"-"}),h.jsx("td",{style:te.td,children:P.phone||"-"}),h.jsx("td",{style:te.td,children:P.email||"-"}),h.jsx("td",{style:te.td,children:C(v[P.id])}),h.jsx("td",{style:te.td,children:h.jsxs("div",{style:te.actions,children:[h.jsx("button",{onClick:()=>{o(P),c(!0)},style:te.iconButton,title:"Edit patient",children:h.jsx(a6,{})}),h.jsx("button",{onClick:()=>T(P),style:te.iconButton,title:"View patient visits",children:"Visits"}),h.jsx("button",{onClick:()=>{o(P),d(!0)},style:te.iconButton,title:"Delete patient",children:h.jsx(xy,{})})]})})]},P.id))})]})}),h.jsx(iS,{isOpen:s,onOpenChange:a,mode:"add"}),h.jsx(iS,{isOpen:l,onOpenChange:c,patient:i,mode:"edit"}),h.jsx(Bf,{open:u,onOpenChange:d,children:h.jsxs(zf,{children:[h.jsx(Uf,{style:te.overlay}),h.jsxs(Vf,{style:te.dialogContent,children:[h.jsx(Hf,{style:te.dialogTitle,children:"Delete Patient"}),h.jsxs(iR,{style:te.dialogDescription,children:["Are you sure you want to delete ",i==null?void 0:i.name,"? This action cannot be undone."]}),h.jsxs("div",{style:te.formActions,children:[h.jsx("button",{onClick:()=>d(!1),style:te.secondaryButton,children:"Cancel"}),h.jsx("button",{onClick:O,style:{...te.primaryButton,backgroundColor:"#ef4444"},children:"Delete"})]}),h.jsx(Cy,{asChild:!0,children:h.jsx("button",{style:te.closeButton,children:h.jsx(Uc,{})})})]})]})}),h.jsx(Bf,{open:f,onOpenChange:p,children:h.jsxs(zf,{children:[h.jsx(Uf,{style:te.overlay}),h.jsxs(Vf,{style:{...te.dialogContent,maxWidth:"800px"},children:[h.jsxs(Hf,{style:te.dialogTitle,children:["Visits for ",i==null?void 0:i.name]}),m.length===0?h.jsx("p",{style:te.emptyNotes,children:"No visits found for this patient."}):h.jsx("div",{style:te.notesContainer,children:m.map(P=>h.jsxs("div",{style:te.visitCard,onClick:()=>$(P.id),children:[h.jsxs("div",{style:te.noteHeader,children:[h.jsx("h3",{style:te.noteTitle,children:P.name||new Date(P.created_at).toLocaleDateString()}),h.jsx("span",{style:te.noteDate,children:new Date(P.created_at).toLocaleString()})]}),h.jsxs("div",{style:te.visitContent,children:[h.jsx("div",{style:te.visitInfo,children:P.name||"No name available"}),h.jsx("div",{style:{...te.visitStateBadge,backgroundColor:I(P.state)},children:R(P.state)})]})]},P.id))}),h.jsx(Cy,{asChild:!0,children:h.jsx("button",{style:te.closeButton,children:h.jsx(Uc,{})})})]})]})})]})}const te={container:{padding:"24px",height:"100%",width:"100%",overflow:"auto",backgroundColor:"#f9fafb",display:"flex",flexDirection:"column",flex:1},header:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"24px",width:"100%"},title:{fontSize:"24px",fontWeight:"bold",color:"#111827",margin:0},addButton:{display:"flex",alignItems:"center",gap:"8px",padding:"8px 16px",backgroundColor:"#3b82f6",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"14px",fontWeight:500},loading:{padding:"40px",textAlign:"center",color:"#6b7280"},emptyState:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"60px 20px",textAlign:"center",color:"#6b7280",gap:"16px"},tableContainer:{backgroundColor:"white",borderRadius:"8px",boxShadow:"0 1px 3px 0 rgba(0, 0, 0, 0.1)",overflow:"hidden",flex:1,width:"100%"},table:{width:"100%",borderCollapse:"collapse"},th:{textAlign:"left",padding:"12px 16px",backgroundColor:"#f9fafb",fontSize:"12px",fontWeight:600,color:"#4b5563",borderBottom:"1px solid #e5e7eb"},tr:{borderBottom:"1px solid #e5e7eb",":last-child":{borderBottom:"none"}},td:{padding:"12px 16px",fontSize:"14px",color:"#1f2937"},actions:{display:"flex",gap:"8px"},iconButton:{padding:"4px 8px",backgroundColor:"transparent",border:"none",borderRadius:"4px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",color:"#4b5563",":hover":{backgroundColor:"#f3f4f6",color:"#1f2937"}},overlay:{backgroundColor:"rgba(0, 0, 0, 0.4)",position:"fixed",inset:0,animation:"overlayShow 150ms cubic-bezier(0.16, 1, 0.3, 1)"},dialogContent:{backgroundColor:"white",borderRadius:"6px",boxShadow:"0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)",position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"90vw",maxWidth:"500px",maxHeight:"85vh",padding:"24px",animation:"contentShow 150ms cubic-bezier(0.16, 1, 0.3, 1)",overflow:"auto"},dialogTitle:{margin:0,fontWeight:600,color:"#111827",fontSize:"18px"},dialogDescription:{marginTop:"8px",marginBottom:"20px",color:"#6b7280",fontSize:"14px"},closeButton:{position:"absolute",top:"16px",right:"16px",backgroundColor:"transparent",border:"none",borderRadius:"4px",cursor:"pointer",color:"#6b7280",display:"flex",padding:"4px"},form:{display:"flex",flexDirection:"column",gap:"16px"},formGroup:{display:"flex",flexDirection:"column",gap:"4px"},label:{fontSize:"14px",fontWeight:500,color:"#374151"},input:{padding:"8px 12px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"14px",color:"#1f2937"},formActions:{display:"flex",justifyContent:"flex-end",gap:"12px",marginTop:"12px"},primaryButton:{padding:"8px 16px",backgroundColor:"#3b82f6",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"14px",fontWeight:500},secondaryButton:{padding:"8px 16px",backgroundColor:"white",color:"#374151",border:"1px solid #d1d5db",borderRadius:"6px",cursor:"pointer",fontSize:"14px",fontWeight:500},notesContainer:{display:"flex",flexDirection:"column",gap:"12px",maxHeight:"500px",overflow:"auto"},visitCard:{padding:"16px",backgroundColor:"#f9fafb",borderRadius:"6px",border:"1px solid #e5e7eb",cursor:"pointer",transition:"background-color 0.2s, transform 0.1s",":hover":{backgroundColor:"#f3f4f6",transform:"translateY(-2px)"}},visitContent:{display:"flex",justifyContent:"space-between",alignItems:"center",fontSize:"14px",color:"#1f2937",whiteSpace:"pre-wrap"},visitInfo:{flex:1},visitStateBadge:{padding:"4px 8px",borderRadius:"9999px",fontSize:"12px",fontWeight:500,color:"white",textAlign:"center",minWidth:"80px"},noteHeader:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},noteTitle:{margin:0,fontSize:"16px",fontWeight:600,color:"#111827"},noteDate:{fontSize:"12px",color:"#6b7280"},emptyNotes:{textAlign:"center",color:"#6b7280",padding:"20px"}},Rm={container:{height:"100vh",width:"100vw",display:"flex",flexDirection:"column",backgroundColor:"#f3f4f6"},mainContent:{flex:1,display:"flex",flexDirection:"row",overflow:"hidden"},content:{flex:1,display:"flex",flexDirection:"column",alignItems:"flex-start",overflow:"hidden"}};function To(){const t=Un(),{visitId:e}=fD(),n=zn(),[r,i]=y.useState(null),[o,s]=y.useState(null),[a,l]=y.useState(!1),[c,u]=y.useState(!1),{user:d,loading:f,error:p}=zt(),m=Be();console.log("MainContent rendering:",{path:n.pathname,userId:d==null?void 0:d.id,isLoading:f,hasError:!!p,visitId:e,selectedVisitId:r==null?void 0:r.id});let g=[];try{g=OH((d==null?void 0:d.id)||""),console.log("Visits loaded:",g.length)}catch(C){console.error("Error loading visits:",C)}const v=y.useCallback((C,k=!1)=>{l(C),u(k)},[]);y.useEffect(()=>{e&&n.pathname.startsWith("/visit/")&&(async()=>{try{const{data:k,error:E}=await m.from("visits").select("*, patient_profiles(id, name, medical_record_number)").eq("id",e).single();if(E)throw E;k&&(i(k),s(k.patient_id))}catch(k){console.error("Error loading visit:",k)}})()},[e,n.pathname,m]),y.useEffect(()=>{n.pathname==="/record"&&(i(null),s(null))},[n.pathname]);const x=C=>{t(`/visit/${C.id}`)},w=()=>{i(null),s(null),t("/record")},S=async C=>{if(s(C),r!=null&&r.id)try{const{error:k}=await m.from("visits").update({patient_id:C}).eq("id",r.id);if(k)throw k}catch(k){console.error("Error updating visit with patient:",k)}},b=C=>{if(C.state!=="paused")return;(async()=>{var E;try{const{data:T,error:O}=await m.from("containers").select("chunk_id").eq("visit_id",C.id).order("chunk_id",{ascending:!1}).limit(1);if(O)throw O;return((E=T==null?void 0:T[0])==null?void 0:E.chunk_id)??-1}catch(T){return console.error("Error getting last chunk ID:",T),-1}})().then(E=>{i(C),t(`/visit/${C.id}`,{state:{visitId:C.id,lastChunkId:E,state:"paused",isRecordingEnabled:!0}})})};return f?h.jsx("div",{style:{height:"100vh",width:"100vw",display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:"#f3f4f6"},children:h.jsx("div",{children:"Loading..."})}):p?h.jsxs("div",{children:["Error loading user profile: ",p]}):h.jsx("div",{style:Rm.container,children:h.jsxs("div",{style:Rm.mainContent,children:[h.jsx(RH,{onNewSession:w,onVisitSelect:x,selectedVisitId:r==null?void 0:r.id,onContinueRecording:b,visits:g}),h.jsx("div",{style:Rm.content,children:n.pathname==="/profile"?h.jsx(xH,{}):n.pathname==="/settings"?h.jsx(SH,{}):n.pathname==="/my-templates"?h.jsx(CH,{}):n.pathname==="/community-templates"?h.jsx(kH,{}):n.pathname==="/patients"?h.jsx(IH,{}):h.jsx(hH,{isTranscribing:a&&!c,placeholder:a?c?"Recording paused...":"Your transcription will appear here as you speak...":r?"Loading visit transcription...":"Select a visit or start a new recording session",visitId:r==null?void 0:r.id,onRecordingStateChange:v,onPatientSelect:S,selectedPatientId:o,visits:g})})]})})}const NH=new Qk({defaultOptions:{queries:{retry:1,refetchOnWindowFocus:!1}}});function jH(){return h.jsx(eE,{client:NH,children:h.jsx(gH,{children:h.jsx(v7,{children:h.jsxs(_D,{children:[h.jsx(an,{path:"/login",element:h.jsx(mH,{})}),h.jsx(an,{path:"/signup",element:h.jsx(yH,{})}),h.jsx(an,{path:"/",element:h.jsx(xf,{to:"/record",replace:!0})}),h.jsx(an,{path:"*",element:h.jsx(xf,{to:"/record",replace:!0})}),h.jsx(an,{path:"/record",element:h.jsx(ci,{children:h.jsx(To,{})})}),h.jsx(an,{path:"/visit/:visitId",element:h.jsx(ci,{children:h.jsx(To,{})})}),h.jsx(an,{path:"/profile",element:h.jsx(ci,{children:h.jsx(To,{})})}),h.jsx(an,{path:"/settings",element:h.jsx(ci,{children:h.jsx(To,{})})}),h.jsx(an,{path:"/my-templates",element:h.jsx(ci,{children:h.jsx(To,{})})}),h.jsx(an,{path:"/community-templates",element:h.jsx(ci,{children:h.jsx(To,{})})}),h.jsx(an,{path:"/patients",element:h.jsx(ci,{children:h.jsx(To,{})})}),h.jsx(an,{path:"/admin",element:h.jsx(ci,{children:h.jsx(DH,{children:h.jsx(MH,{})})})})]})})})})}const LH=new Qk({defaultOptions:{queries:{retry:1,refetchOnWindowFocus:!1}}});Om.createRoot(document.getElementById("root")).render(h.jsx(ve.StrictMode,{children:h.jsx(eE,{client:LH,children:h.jsx(WN,{children:h.jsx(ZD,{children:h.jsx(jH,{})})})})}));export{mS as g};
