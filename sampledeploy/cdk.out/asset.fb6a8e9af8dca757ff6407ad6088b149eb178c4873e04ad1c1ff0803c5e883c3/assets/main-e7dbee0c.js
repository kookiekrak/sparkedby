var Np=(t,e,n)=>{if(!e.has(t))throw TypeError("Cannot "+n)};var O=(t,e,n)=>(Np(t,e,"read from private field"),n?n.call(t):e.get(t)),Y=(t,e,n)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,n)},W=(t,e,n,r)=>(Np(t,e,"write to private field"),r?r.call(t,n):e.set(t,n),n);var ad=(t,e,n,r)=>({set _(i){W(t,e,i,n)},get _(){return O(t,e,r)}}),le=(t,e,n)=>(Np(t,e,"access private method"),n);function hM(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in t)){const o=Object.getOwnPropertyDescriptor(r,i);o&&Object.defineProperty(t,i,o.get?o:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();var Vn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function QS(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function pM(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var i=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,i.get?i:{enumerable:!0,get:function(){return t[r]}})}),n}var XS={exports:{}},Ch={},ZS={exports:{}},fe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Nu=Symbol.for("react.element"),mM=Symbol.for("react.portal"),gM=Symbol.for("react.fragment"),yM=Symbol.for("react.strict_mode"),vM=Symbol.for("react.profiler"),xM=Symbol.for("react.provider"),wM=Symbol.for("react.context"),bM=Symbol.for("react.forward_ref"),SM=Symbol.for("react.suspense"),CM=Symbol.for("react.memo"),kM=Symbol.for("react.lazy"),Hx=Symbol.iterator;function EM(t){return t===null||typeof t!="object"?null:(t=Hx&&t[Hx]||t["@@iterator"],typeof t=="function"?t:null)}var eC={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},tC=Object.assign,nC={};function Al(t,e,n){this.props=t,this.context=e,this.refs=nC,this.updater=n||eC}Al.prototype.isReactComponent={};Al.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Al.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function rC(){}rC.prototype=Al.prototype;function vv(t,e,n){this.props=t,this.context=e,this.refs=nC,this.updater=n||eC}var xv=vv.prototype=new rC;xv.constructor=vv;tC(xv,Al.prototype);xv.isPureReactComponent=!0;var Wx=Array.isArray,iC=Object.prototype.hasOwnProperty,wv={current:null},oC={key:!0,ref:!0,__self:!0,__source:!0};function sC(t,e,n){var r,i={},o=null,s=null;if(e!=null)for(r in e.ref!==void 0&&(s=e.ref),e.key!==void 0&&(o=""+e.key),e)iC.call(e,r)&&!oC.hasOwnProperty(r)&&(i[r]=e[r]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];i.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:Nu,type:t,key:o,ref:s,props:i,_owner:wv.current}}function TM(t,e){return{$$typeof:Nu,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function bv(t){return typeof t=="object"&&t!==null&&t.$$typeof===Nu}function _M(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Kx=/\/+/g;function jp(t,e){return typeof t=="object"&&t!==null&&t.key!=null?_M(""+t.key):e.toString(36)}function Qd(t,e,n,r,i){var o=typeof t;(o==="undefined"||o==="boolean")&&(t=null);var s=!1;if(t===null)s=!0;else switch(o){case"string":case"number":s=!0;break;case"object":switch(t.$$typeof){case Nu:case mM:s=!0}}if(s)return s=t,i=i(s),t=r===""?"."+jp(s,0):r,Wx(i)?(n="",t!=null&&(n=t.replace(Kx,"$&/")+"/"),Qd(i,e,n,"",function(c){return c})):i!=null&&(bv(i)&&(i=TM(i,n+(!i.key||s&&s.key===i.key?"":(""+i.key).replace(Kx,"$&/")+"/")+t)),e.push(i)),1;if(s=0,r=r===""?".":r+":",Wx(t))for(var a=0;a<t.length;a++){o=t[a];var l=r+jp(o,a);s+=Qd(o,e,n,l,i)}else if(l=EM(t),typeof l=="function")for(t=l.call(t),a=0;!(o=t.next()).done;)o=o.value,l=r+jp(o,a++),s+=Qd(o,e,n,l,i);else if(o==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return s}function ld(t,e,n){if(t==null)return t;var r=[],i=0;return Qd(t,r,"","",function(o){return e.call(n,o,i++)}),r}function RM(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Jt={current:null},Xd={transition:null},OM={ReactCurrentDispatcher:Jt,ReactCurrentBatchConfig:Xd,ReactCurrentOwner:wv};function aC(){throw Error("act(...) is not supported in production builds of React.")}fe.Children={map:ld,forEach:function(t,e,n){ld(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return ld(t,function(){e++}),e},toArray:function(t){return ld(t,function(e){return e})||[]},only:function(t){if(!bv(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};fe.Component=Al;fe.Fragment=gM;fe.Profiler=vM;fe.PureComponent=vv;fe.StrictMode=yM;fe.Suspense=SM;fe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=OM;fe.act=aC;fe.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=tC({},t.props),i=t.key,o=t.ref,s=t._owner;if(e!=null){if(e.ref!==void 0&&(o=e.ref,s=wv.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)iC.call(e,l)&&!oC.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var c=0;c<l;c++)a[c]=arguments[c+2];r.children=a}return{$$typeof:Nu,type:t.type,key:i,ref:o,props:r,_owner:s}};fe.createContext=function(t){return t={$$typeof:wM,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:xM,_context:t},t.Consumer=t};fe.createElement=sC;fe.createFactory=function(t){var e=sC.bind(null,t);return e.type=t,e};fe.createRef=function(){return{current:null}};fe.forwardRef=function(t){return{$$typeof:bM,render:t}};fe.isValidElement=bv;fe.lazy=function(t){return{$$typeof:kM,_payload:{_status:-1,_result:t},_init:RM}};fe.memo=function(t,e){return{$$typeof:CM,type:t,compare:e===void 0?null:e}};fe.startTransition=function(t){var e=Xd.transition;Xd.transition={};try{t()}finally{Xd.transition=e}};fe.unstable_act=aC;fe.useCallback=function(t,e){return Jt.current.useCallback(t,e)};fe.useContext=function(t){return Jt.current.useContext(t)};fe.useDebugValue=function(){};fe.useDeferredValue=function(t){return Jt.current.useDeferredValue(t)};fe.useEffect=function(t,e){return Jt.current.useEffect(t,e)};fe.useId=function(){return Jt.current.useId()};fe.useImperativeHandle=function(t,e,n){return Jt.current.useImperativeHandle(t,e,n)};fe.useInsertionEffect=function(t,e){return Jt.current.useInsertionEffect(t,e)};fe.useLayoutEffect=function(t,e){return Jt.current.useLayoutEffect(t,e)};fe.useMemo=function(t,e){return Jt.current.useMemo(t,e)};fe.useReducer=function(t,e,n){return Jt.current.useReducer(t,e,n)};fe.useRef=function(t){return Jt.current.useRef(t)};fe.useState=function(t){return Jt.current.useState(t)};fe.useSyncExternalStore=function(t,e,n){return Jt.current.useSyncExternalStore(t,e,n)};fe.useTransition=function(){return Jt.current.useTransition()};fe.version="18.3.1";ZS.exports=fe;var m=ZS.exports;const Te=QS(m),PM=hM({__proto__:null,default:Te},[m]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var MM=m,IM=Symbol.for("react.element"),AM=Symbol.for("react.fragment"),NM=Object.prototype.hasOwnProperty,jM=MM.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,DM={key:!0,ref:!0,__self:!0,__source:!0};function lC(t,e,n){var r,i={},o=null,s=null;n!==void 0&&(o=""+n),e.key!==void 0&&(o=""+e.key),e.ref!==void 0&&(s=e.ref);for(r in e)NM.call(e,r)&&!DM.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:IM,type:t,key:o,ref:s,props:i,_owner:jM.current}}Ch.Fragment=AM;Ch.jsx=lC;Ch.jsxs=lC;XS.exports=Ch;var f=XS.exports;window.global=window;var ig={},cC={exports:{}},Tn={},uC={exports:{}},dC={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(I,P){var D=I.length;I.push(P);e:for(;0<D;){var H=D-1>>>1,Z=I[H];if(0<i(Z,P))I[H]=P,I[D]=Z,D=H;else break e}}function n(I){return I.length===0?null:I[0]}function r(I){if(I.length===0)return null;var P=I[0],D=I.pop();if(D!==P){I[0]=D;e:for(var H=0,Z=I.length,he=Z>>>1;H<he;){var pe=2*(H+1)-1,ee=I[pe],Q=pe+1,U=I[Q];if(0>i(ee,D))Q<Z&&0>i(U,ee)?(I[H]=U,I[Q]=D,H=Q):(I[H]=ee,I[pe]=D,H=pe);else if(Q<Z&&0>i(U,D))I[H]=U,I[Q]=D,H=Q;else break e}}return P}function i(I,P){var D=I.sortIndex-P.sortIndex;return D!==0?D:I.id-P.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var s=Date,a=s.now();t.unstable_now=function(){return s.now()-a}}var l=[],c=[],u=1,d=null,h=3,p=!1,g=!1,y=!1,x=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(I){for(var P=n(c);P!==null;){if(P.callback===null)r(c);else if(P.startTime<=I)r(c),P.sortIndex=P.expirationTime,e(l,P);else break;P=n(c)}}function S(I){if(y=!1,b(I),!g)if(n(l)!==null)g=!0,$(C);else{var P=n(c);P!==null&&V(S,P.startTime-I)}}function C(I,P){g=!1,y&&(y=!1,v(T),T=-1),p=!0;var D=h;try{for(b(P),d=n(l);d!==null&&(!(d.expirationTime>P)||I&&!A());){var H=d.callback;if(typeof H=="function"){d.callback=null,h=d.priorityLevel;var Z=H(d.expirationTime<=P);P=t.unstable_now(),typeof Z=="function"?d.callback=Z:d===n(l)&&r(l),b(P)}else r(l);d=n(l)}if(d!==null)var he=!0;else{var pe=n(c);pe!==null&&V(S,pe.startTime-P),he=!1}return he}finally{d=null,h=D,p=!1}}var k=!1,E=null,T=-1,R=5,_=-1;function A(){return!(t.unstable_now()-_<R)}function L(){if(E!==null){var I=t.unstable_now();_=I;var P=!0;try{P=E(!0,I)}finally{P?N():(k=!1,E=null)}}else k=!1}var N;if(typeof w=="function")N=function(){w(L)};else if(typeof MessageChannel<"u"){var M=new MessageChannel,z=M.port2;M.port1.onmessage=L,N=function(){z.postMessage(null)}}else N=function(){x(L,0)};function $(I){E=I,k||(k=!0,N())}function V(I,P){T=x(function(){I(t.unstable_now())},P)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(I){I.callback=null},t.unstable_continueExecution=function(){g||p||(g=!0,$(C))},t.unstable_forceFrameRate=function(I){0>I||125<I?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<I?Math.floor(1e3/I):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(I){switch(h){case 1:case 2:case 3:var P=3;break;default:P=h}var D=h;h=P;try{return I()}finally{h=D}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(I,P){switch(I){case 1:case 2:case 3:case 4:case 5:break;default:I=3}var D=h;h=I;try{return P()}finally{h=D}},t.unstable_scheduleCallback=function(I,P,D){var H=t.unstable_now();switch(typeof D=="object"&&D!==null?(D=D.delay,D=typeof D=="number"&&0<D?H+D:H):D=H,I){case 1:var Z=-1;break;case 2:Z=250;break;case 5:Z=1073741823;break;case 4:Z=1e4;break;default:Z=5e3}return Z=D+Z,I={id:u++,callback:P,priorityLevel:I,startTime:D,expirationTime:Z,sortIndex:-1},D>H?(I.sortIndex=D,e(c,I),n(l)===null&&I===n(c)&&(y?(v(T),T=-1):y=!0,V(S,D-H))):(I.sortIndex=Z,e(l,I),g||p||(g=!0,$(C))),I},t.unstable_shouldYield=A,t.unstable_wrapCallback=function(I){var P=h;return function(){var D=h;h=P;try{return I.apply(this,arguments)}finally{h=D}}}})(dC);uC.exports=dC;var LM=uC.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $M=m,kn=LM;function B(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var fC=new Set,Fc={};function Ks(t,e){al(t,e),al(t+"Capture",e)}function al(t,e){for(Fc[t]=e,t=0;t<e.length;t++)fC.add(e[t])}var ci=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),og=Object.prototype.hasOwnProperty,FM=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,qx={},Gx={};function BM(t){return og.call(Gx,t)?!0:og.call(qx,t)?!1:FM.test(t)?Gx[t]=!0:(qx[t]=!0,!1)}function zM(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function VM(t,e,n,r){if(e===null||typeof e>"u"||zM(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Yt(t,e,n,r,i,o,s){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=o,this.removeEmptyString=s}var wt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){wt[t]=new Yt(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];wt[e]=new Yt(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){wt[t]=new Yt(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){wt[t]=new Yt(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){wt[t]=new Yt(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){wt[t]=new Yt(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){wt[t]=new Yt(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){wt[t]=new Yt(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){wt[t]=new Yt(t,5,!1,t.toLowerCase(),null,!1,!1)});var Sv=/[\-:]([a-z])/g;function Cv(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Sv,Cv);wt[e]=new Yt(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Sv,Cv);wt[e]=new Yt(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Sv,Cv);wt[e]=new Yt(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){wt[t]=new Yt(t,1,!1,t.toLowerCase(),null,!1,!1)});wt.xlinkHref=new Yt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){wt[t]=new Yt(t,1,!1,t.toLowerCase(),null,!0,!0)});function kv(t,e,n,r){var i=wt.hasOwnProperty(e)?wt[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(VM(e,n,i,r)&&(n=null),r||i===null?BM(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var gi=$M.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,cd=Symbol.for("react.element"),xa=Symbol.for("react.portal"),wa=Symbol.for("react.fragment"),Ev=Symbol.for("react.strict_mode"),sg=Symbol.for("react.profiler"),hC=Symbol.for("react.provider"),pC=Symbol.for("react.context"),Tv=Symbol.for("react.forward_ref"),ag=Symbol.for("react.suspense"),lg=Symbol.for("react.suspense_list"),_v=Symbol.for("react.memo"),Pi=Symbol.for("react.lazy"),mC=Symbol.for("react.offscreen"),Jx=Symbol.iterator;function Ql(t){return t===null||typeof t!="object"?null:(t=Jx&&t[Jx]||t["@@iterator"],typeof t=="function"?t:null)}var Ue=Object.assign,Dp;function uc(t){if(Dp===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Dp=e&&e[1]||""}return`
`+Dp+t}var Lp=!1;function $p(t,e){if(!t||Lp)return"";Lp=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var r=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){r=c}t.call(e.prototype)}else{try{throw Error()}catch(c){r=c}t()}}catch(c){if(c&&r&&typeof c.stack=="string"){for(var i=c.stack.split(`
`),o=r.stack.split(`
`),s=i.length-1,a=o.length-1;1<=s&&0<=a&&i[s]!==o[a];)a--;for(;1<=s&&0<=a;s--,a--)if(i[s]!==o[a]){if(s!==1||a!==1)do if(s--,a--,0>a||i[s]!==o[a]){var l=`
`+i[s].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=s&&0<=a);break}}}finally{Lp=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?uc(t):""}function UM(t){switch(t.tag){case 5:return uc(t.type);case 16:return uc("Lazy");case 13:return uc("Suspense");case 19:return uc("SuspenseList");case 0:case 2:case 15:return t=$p(t.type,!1),t;case 11:return t=$p(t.type.render,!1),t;case 1:return t=$p(t.type,!0),t;default:return""}}function cg(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case wa:return"Fragment";case xa:return"Portal";case sg:return"Profiler";case Ev:return"StrictMode";case ag:return"Suspense";case lg:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case pC:return(t.displayName||"Context")+".Consumer";case hC:return(t._context.displayName||"Context")+".Provider";case Tv:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case _v:return e=t.displayName||null,e!==null?e:cg(t.type)||"Memo";case Pi:e=t._payload,t=t._init;try{return cg(t(e))}catch{}}return null}function HM(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return cg(e);case 8:return e===Ev?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function ko(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function gC(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function WM(t){var e=gC(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,o=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(s){r=""+s,o.call(this,s)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(s){r=""+s},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function ud(t){t._valueTracker||(t._valueTracker=WM(t))}function yC(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=gC(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function bf(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function ug(t,e){var n=e.checked;return Ue({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Yx(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=ko(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function vC(t,e){e=e.checked,e!=null&&kv(t,"checked",e,!1)}function dg(t,e){vC(t,e);var n=ko(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?fg(t,e.type,n):e.hasOwnProperty("defaultValue")&&fg(t,e.type,ko(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Qx(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function fg(t,e,n){(e!=="number"||bf(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var dc=Array.isArray;function Na(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+ko(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function hg(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(B(91));return Ue({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Xx(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(B(92));if(dc(n)){if(1<n.length)throw Error(B(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:ko(n)}}function xC(t,e){var n=ko(e.value),r=ko(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Zx(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function wC(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function pg(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?wC(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var dd,bC=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(dd=dd||document.createElement("div"),dd.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=dd.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Bc(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var bc={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},KM=["Webkit","ms","Moz","O"];Object.keys(bc).forEach(function(t){KM.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),bc[e]=bc[t]})});function SC(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||bc.hasOwnProperty(t)&&bc[t]?(""+e).trim():e+"px"}function CC(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=SC(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var qM=Ue({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function mg(t,e){if(e){if(qM[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(B(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(B(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(B(61))}if(e.style!=null&&typeof e.style!="object")throw Error(B(62))}}function gg(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var yg=null;function Rv(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var vg=null,ja=null,Da=null;function ew(t){if(t=Lu(t)){if(typeof vg!="function")throw Error(B(280));var e=t.stateNode;e&&(e=Rh(e),vg(t.stateNode,t.type,e))}}function kC(t){ja?Da?Da.push(t):Da=[t]:ja=t}function EC(){if(ja){var t=ja,e=Da;if(Da=ja=null,ew(t),e)for(t=0;t<e.length;t++)ew(e[t])}}function TC(t,e){return t(e)}function _C(){}var Fp=!1;function RC(t,e,n){if(Fp)return t(e,n);Fp=!0;try{return TC(t,e,n)}finally{Fp=!1,(ja!==null||Da!==null)&&(_C(),EC())}}function zc(t,e){var n=t.stateNode;if(n===null)return null;var r=Rh(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(B(231,e,typeof n));return n}var xg=!1;if(ci)try{var Xl={};Object.defineProperty(Xl,"passive",{get:function(){xg=!0}}),window.addEventListener("test",Xl,Xl),window.removeEventListener("test",Xl,Xl)}catch{xg=!1}function GM(t,e,n,r,i,o,s,a,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(n,c)}catch(u){this.onError(u)}}var Sc=!1,Sf=null,Cf=!1,wg=null,JM={onError:function(t){Sc=!0,Sf=t}};function YM(t,e,n,r,i,o,s,a,l){Sc=!1,Sf=null,GM.apply(JM,arguments)}function QM(t,e,n,r,i,o,s,a,l){if(YM.apply(this,arguments),Sc){if(Sc){var c=Sf;Sc=!1,Sf=null}else throw Error(B(198));Cf||(Cf=!0,wg=c)}}function qs(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function OC(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function tw(t){if(qs(t)!==t)throw Error(B(188))}function XM(t){var e=t.alternate;if(!e){if(e=qs(t),e===null)throw Error(B(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var o=i.alternate;if(o===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===n)return tw(i),t;if(o===r)return tw(i),e;o=o.sibling}throw Error(B(188))}if(n.return!==r.return)n=i,r=o;else{for(var s=!1,a=i.child;a;){if(a===n){s=!0,n=i,r=o;break}if(a===r){s=!0,r=i,n=o;break}a=a.sibling}if(!s){for(a=o.child;a;){if(a===n){s=!0,n=o,r=i;break}if(a===r){s=!0,r=o,n=i;break}a=a.sibling}if(!s)throw Error(B(189))}}if(n.alternate!==r)throw Error(B(190))}if(n.tag!==3)throw Error(B(188));return n.stateNode.current===n?t:e}function PC(t){return t=XM(t),t!==null?MC(t):null}function MC(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=MC(t);if(e!==null)return e;t=t.sibling}return null}var IC=kn.unstable_scheduleCallback,nw=kn.unstable_cancelCallback,ZM=kn.unstable_shouldYield,e2=kn.unstable_requestPaint,Ye=kn.unstable_now,t2=kn.unstable_getCurrentPriorityLevel,Ov=kn.unstable_ImmediatePriority,AC=kn.unstable_UserBlockingPriority,kf=kn.unstable_NormalPriority,n2=kn.unstable_LowPriority,NC=kn.unstable_IdlePriority,kh=null,Nr=null;function r2(t){if(Nr&&typeof Nr.onCommitFiberRoot=="function")try{Nr.onCommitFiberRoot(kh,t,void 0,(t.current.flags&128)===128)}catch{}}var lr=Math.clz32?Math.clz32:s2,i2=Math.log,o2=Math.LN2;function s2(t){return t>>>=0,t===0?32:31-(i2(t)/o2|0)|0}var fd=64,hd=4194304;function fc(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Ef(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,o=t.pingedLanes,s=n&268435455;if(s!==0){var a=s&~i;a!==0?r=fc(a):(o&=s,o!==0&&(r=fc(o)))}else s=n&~i,s!==0?r=fc(s):o!==0&&(r=fc(o));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,o=e&-e,i>=o||i===16&&(o&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-lr(e),i=1<<n,r|=t[n],e&=~i;return r}function a2(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function l2(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,o=t.pendingLanes;0<o;){var s=31-lr(o),a=1<<s,l=i[s];l===-1?(!(a&n)||a&r)&&(i[s]=a2(a,e)):l<=e&&(t.expiredLanes|=a),o&=~a}}function bg(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function jC(){var t=fd;return fd<<=1,!(fd&4194240)&&(fd=64),t}function Bp(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function ju(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-lr(e),t[e]=n}function c2(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-lr(n),o=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~o}}function Pv(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-lr(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var Ee=0;function DC(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var LC,Mv,$C,FC,BC,Sg=!1,pd=[],co=null,uo=null,fo=null,Vc=new Map,Uc=new Map,Wi=[],u2="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function rw(t,e){switch(t){case"focusin":case"focusout":co=null;break;case"dragenter":case"dragleave":uo=null;break;case"mouseover":case"mouseout":fo=null;break;case"pointerover":case"pointerout":Vc.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Uc.delete(e.pointerId)}}function Zl(t,e,n,r,i,o){return t===null||t.nativeEvent!==o?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[i]},e!==null&&(e=Lu(e),e!==null&&Mv(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function d2(t,e,n,r,i){switch(e){case"focusin":return co=Zl(co,t,e,n,r,i),!0;case"dragenter":return uo=Zl(uo,t,e,n,r,i),!0;case"mouseover":return fo=Zl(fo,t,e,n,r,i),!0;case"pointerover":var o=i.pointerId;return Vc.set(o,Zl(Vc.get(o)||null,t,e,n,r,i)),!0;case"gotpointercapture":return o=i.pointerId,Uc.set(o,Zl(Uc.get(o)||null,t,e,n,r,i)),!0}return!1}function zC(t){var e=ts(t.target);if(e!==null){var n=qs(e);if(n!==null){if(e=n.tag,e===13){if(e=OC(n),e!==null){t.blockedOn=e,BC(t.priority,function(){$C(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Zd(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Cg(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);yg=r,n.target.dispatchEvent(r),yg=null}else return e=Lu(n),e!==null&&Mv(e),t.blockedOn=n,!1;e.shift()}return!0}function iw(t,e,n){Zd(t)&&n.delete(e)}function f2(){Sg=!1,co!==null&&Zd(co)&&(co=null),uo!==null&&Zd(uo)&&(uo=null),fo!==null&&Zd(fo)&&(fo=null),Vc.forEach(iw),Uc.forEach(iw)}function ec(t,e){t.blockedOn===e&&(t.blockedOn=null,Sg||(Sg=!0,kn.unstable_scheduleCallback(kn.unstable_NormalPriority,f2)))}function Hc(t){function e(i){return ec(i,t)}if(0<pd.length){ec(pd[0],t);for(var n=1;n<pd.length;n++){var r=pd[n];r.blockedOn===t&&(r.blockedOn=null)}}for(co!==null&&ec(co,t),uo!==null&&ec(uo,t),fo!==null&&ec(fo,t),Vc.forEach(e),Uc.forEach(e),n=0;n<Wi.length;n++)r=Wi[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Wi.length&&(n=Wi[0],n.blockedOn===null);)zC(n),n.blockedOn===null&&Wi.shift()}var La=gi.ReactCurrentBatchConfig,Tf=!0;function h2(t,e,n,r){var i=Ee,o=La.transition;La.transition=null;try{Ee=1,Iv(t,e,n,r)}finally{Ee=i,La.transition=o}}function p2(t,e,n,r){var i=Ee,o=La.transition;La.transition=null;try{Ee=4,Iv(t,e,n,r)}finally{Ee=i,La.transition=o}}function Iv(t,e,n,r){if(Tf){var i=Cg(t,e,n,r);if(i===null)Yp(t,e,r,_f,n),rw(t,r);else if(d2(i,t,e,n,r))r.stopPropagation();else if(rw(t,r),e&4&&-1<u2.indexOf(t)){for(;i!==null;){var o=Lu(i);if(o!==null&&LC(o),o=Cg(t,e,n,r),o===null&&Yp(t,e,r,_f,n),o===i)break;i=o}i!==null&&r.stopPropagation()}else Yp(t,e,r,null,n)}}var _f=null;function Cg(t,e,n,r){if(_f=null,t=Rv(r),t=ts(t),t!==null)if(e=qs(t),e===null)t=null;else if(n=e.tag,n===13){if(t=OC(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return _f=t,null}function VC(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(t2()){case Ov:return 1;case AC:return 4;case kf:case n2:return 16;case NC:return 536870912;default:return 16}default:return 16}}var io=null,Av=null,ef=null;function UC(){if(ef)return ef;var t,e=Av,n=e.length,r,i="value"in io?io.value:io.textContent,o=i.length;for(t=0;t<n&&e[t]===i[t];t++);var s=n-t;for(r=1;r<=s&&e[n-r]===i[o-r];r++);return ef=i.slice(t,1<r?1-r:void 0)}function tf(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function md(){return!0}function ow(){return!1}function _n(t){function e(n,r,i,o,s){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=o,this.target=s,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(o):o[a]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?md:ow,this.isPropagationStopped=ow,this}return Ue(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=md)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=md)},persist:function(){},isPersistent:md}),e}var Nl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Nv=_n(Nl),Du=Ue({},Nl,{view:0,detail:0}),m2=_n(Du),zp,Vp,tc,Eh=Ue({},Du,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:jv,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==tc&&(tc&&t.type==="mousemove"?(zp=t.screenX-tc.screenX,Vp=t.screenY-tc.screenY):Vp=zp=0,tc=t),zp)},movementY:function(t){return"movementY"in t?t.movementY:Vp}}),sw=_n(Eh),g2=Ue({},Eh,{dataTransfer:0}),y2=_n(g2),v2=Ue({},Du,{relatedTarget:0}),Up=_n(v2),x2=Ue({},Nl,{animationName:0,elapsedTime:0,pseudoElement:0}),w2=_n(x2),b2=Ue({},Nl,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),S2=_n(b2),C2=Ue({},Nl,{data:0}),aw=_n(C2),k2={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},E2={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},T2={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function _2(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=T2[t])?!!e[t]:!1}function jv(){return _2}var R2=Ue({},Du,{key:function(t){if(t.key){var e=k2[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=tf(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?E2[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:jv,charCode:function(t){return t.type==="keypress"?tf(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?tf(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),O2=_n(R2),P2=Ue({},Eh,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),lw=_n(P2),M2=Ue({},Du,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:jv}),I2=_n(M2),A2=Ue({},Nl,{propertyName:0,elapsedTime:0,pseudoElement:0}),N2=_n(A2),j2=Ue({},Eh,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),D2=_n(j2),L2=[9,13,27,32],Dv=ci&&"CompositionEvent"in window,Cc=null;ci&&"documentMode"in document&&(Cc=document.documentMode);var $2=ci&&"TextEvent"in window&&!Cc,HC=ci&&(!Dv||Cc&&8<Cc&&11>=Cc),cw=String.fromCharCode(32),uw=!1;function WC(t,e){switch(t){case"keyup":return L2.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function KC(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var ba=!1;function F2(t,e){switch(t){case"compositionend":return KC(e);case"keypress":return e.which!==32?null:(uw=!0,cw);case"textInput":return t=e.data,t===cw&&uw?null:t;default:return null}}function B2(t,e){if(ba)return t==="compositionend"||!Dv&&WC(t,e)?(t=UC(),ef=Av=io=null,ba=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return HC&&e.locale!=="ko"?null:e.data;default:return null}}var z2={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function dw(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!z2[t.type]:e==="textarea"}function qC(t,e,n,r){kC(r),e=Rf(e,"onChange"),0<e.length&&(n=new Nv("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var kc=null,Wc=null;function V2(t){ik(t,0)}function Th(t){var e=ka(t);if(yC(e))return t}function U2(t,e){if(t==="change")return e}var GC=!1;if(ci){var Hp;if(ci){var Wp="oninput"in document;if(!Wp){var fw=document.createElement("div");fw.setAttribute("oninput","return;"),Wp=typeof fw.oninput=="function"}Hp=Wp}else Hp=!1;GC=Hp&&(!document.documentMode||9<document.documentMode)}function hw(){kc&&(kc.detachEvent("onpropertychange",JC),Wc=kc=null)}function JC(t){if(t.propertyName==="value"&&Th(Wc)){var e=[];qC(e,Wc,t,Rv(t)),RC(V2,e)}}function H2(t,e,n){t==="focusin"?(hw(),kc=e,Wc=n,kc.attachEvent("onpropertychange",JC)):t==="focusout"&&hw()}function W2(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Th(Wc)}function K2(t,e){if(t==="click")return Th(e)}function q2(t,e){if(t==="input"||t==="change")return Th(e)}function G2(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var ur=typeof Object.is=="function"?Object.is:G2;function Kc(t,e){if(ur(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!og.call(e,i)||!ur(t[i],e[i]))return!1}return!0}function pw(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function mw(t,e){var n=pw(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=pw(n)}}function YC(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?YC(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function QC(){for(var t=window,e=bf();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=bf(t.document)}return e}function Lv(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function J2(t){var e=QC(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&YC(n.ownerDocument.documentElement,n)){if(r!==null&&Lv(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,o=Math.min(r.start,i);r=r.end===void 0?o:Math.min(r.end,i),!t.extend&&o>r&&(i=r,r=o,o=i),i=mw(n,o);var s=mw(n,r);i&&s&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==s.node||t.focusOffset!==s.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),o>r?(t.addRange(e),t.extend(s.node,s.offset)):(e.setEnd(s.node,s.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var Y2=ci&&"documentMode"in document&&11>=document.documentMode,Sa=null,kg=null,Ec=null,Eg=!1;function gw(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Eg||Sa==null||Sa!==bf(r)||(r=Sa,"selectionStart"in r&&Lv(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Ec&&Kc(Ec,r)||(Ec=r,r=Rf(kg,"onSelect"),0<r.length&&(e=new Nv("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Sa)))}function gd(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Ca={animationend:gd("Animation","AnimationEnd"),animationiteration:gd("Animation","AnimationIteration"),animationstart:gd("Animation","AnimationStart"),transitionend:gd("Transition","TransitionEnd")},Kp={},XC={};ci&&(XC=document.createElement("div").style,"AnimationEvent"in window||(delete Ca.animationend.animation,delete Ca.animationiteration.animation,delete Ca.animationstart.animation),"TransitionEvent"in window||delete Ca.transitionend.transition);function _h(t){if(Kp[t])return Kp[t];if(!Ca[t])return t;var e=Ca[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in XC)return Kp[t]=e[n];return t}var ZC=_h("animationend"),ek=_h("animationiteration"),tk=_h("animationstart"),nk=_h("transitionend"),rk=new Map,yw="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ao(t,e){rk.set(t,e),Ks(e,[t])}for(var qp=0;qp<yw.length;qp++){var Gp=yw[qp],Q2=Gp.toLowerCase(),X2=Gp[0].toUpperCase()+Gp.slice(1);Ao(Q2,"on"+X2)}Ao(ZC,"onAnimationEnd");Ao(ek,"onAnimationIteration");Ao(tk,"onAnimationStart");Ao("dblclick","onDoubleClick");Ao("focusin","onFocus");Ao("focusout","onBlur");Ao(nk,"onTransitionEnd");al("onMouseEnter",["mouseout","mouseover"]);al("onMouseLeave",["mouseout","mouseover"]);al("onPointerEnter",["pointerout","pointerover"]);al("onPointerLeave",["pointerout","pointerover"]);Ks("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ks("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ks("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ks("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ks("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ks("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var hc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Z2=new Set("cancel close invalid load scroll toggle".split(" ").concat(hc));function vw(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,QM(r,e,void 0,t),t.currentTarget=null}function ik(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var o=void 0;if(e)for(var s=r.length-1;0<=s;s--){var a=r[s],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==o&&i.isPropagationStopped())break e;vw(i,a,c),o=l}else for(s=0;s<r.length;s++){if(a=r[s],l=a.instance,c=a.currentTarget,a=a.listener,l!==o&&i.isPropagationStopped())break e;vw(i,a,c),o=l}}}if(Cf)throw t=wg,Cf=!1,wg=null,t}function De(t,e){var n=e[Pg];n===void 0&&(n=e[Pg]=new Set);var r=t+"__bubble";n.has(r)||(ok(e,t,2,!1),n.add(r))}function Jp(t,e,n){var r=0;e&&(r|=4),ok(n,t,r,e)}var yd="_reactListening"+Math.random().toString(36).slice(2);function qc(t){if(!t[yd]){t[yd]=!0,fC.forEach(function(n){n!=="selectionchange"&&(Z2.has(n)||Jp(n,!1,t),Jp(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[yd]||(e[yd]=!0,Jp("selectionchange",!1,e))}}function ok(t,e,n,r){switch(VC(e)){case 1:var i=h2;break;case 4:i=p2;break;default:i=Iv}n=i.bind(null,e,n,t),i=void 0,!xg||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function Yp(t,e,n,r,i){var o=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var s=r.tag;if(s===3||s===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(s===4)for(s=r.return;s!==null;){var l=s.tag;if((l===3||l===4)&&(l=s.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;s=s.return}for(;a!==null;){if(s=ts(a),s===null)return;if(l=s.tag,l===5||l===6){r=o=s;continue e}a=a.parentNode}}r=r.return}RC(function(){var c=o,u=Rv(n),d=[];e:{var h=rk.get(t);if(h!==void 0){var p=Nv,g=t;switch(t){case"keypress":if(tf(n)===0)break e;case"keydown":case"keyup":p=O2;break;case"focusin":g="focus",p=Up;break;case"focusout":g="blur",p=Up;break;case"beforeblur":case"afterblur":p=Up;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=sw;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=y2;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=I2;break;case ZC:case ek:case tk:p=w2;break;case nk:p=N2;break;case"scroll":p=m2;break;case"wheel":p=D2;break;case"copy":case"cut":case"paste":p=S2;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=lw}var y=(e&4)!==0,x=!y&&t==="scroll",v=y?h!==null?h+"Capture":null:h;y=[];for(var w=c,b;w!==null;){b=w;var S=b.stateNode;if(b.tag===5&&S!==null&&(b=S,v!==null&&(S=zc(w,v),S!=null&&y.push(Gc(w,S,b)))),x)break;w=w.return}0<y.length&&(h=new p(h,g,null,n,u),d.push({event:h,listeners:y}))}}if(!(e&7)){e:{if(h=t==="mouseover"||t==="pointerover",p=t==="mouseout"||t==="pointerout",h&&n!==yg&&(g=n.relatedTarget||n.fromElement)&&(ts(g)||g[ui]))break e;if((p||h)&&(h=u.window===u?u:(h=u.ownerDocument)?h.defaultView||h.parentWindow:window,p?(g=n.relatedTarget||n.toElement,p=c,g=g?ts(g):null,g!==null&&(x=qs(g),g!==x||g.tag!==5&&g.tag!==6)&&(g=null)):(p=null,g=c),p!==g)){if(y=sw,S="onMouseLeave",v="onMouseEnter",w="mouse",(t==="pointerout"||t==="pointerover")&&(y=lw,S="onPointerLeave",v="onPointerEnter",w="pointer"),x=p==null?h:ka(p),b=g==null?h:ka(g),h=new y(S,w+"leave",p,n,u),h.target=x,h.relatedTarget=b,S=null,ts(u)===c&&(y=new y(v,w+"enter",g,n,u),y.target=b,y.relatedTarget=x,S=y),x=S,p&&g)t:{for(y=p,v=g,w=0,b=y;b;b=ra(b))w++;for(b=0,S=v;S;S=ra(S))b++;for(;0<w-b;)y=ra(y),w--;for(;0<b-w;)v=ra(v),b--;for(;w--;){if(y===v||v!==null&&y===v.alternate)break t;y=ra(y),v=ra(v)}y=null}else y=null;p!==null&&xw(d,h,p,y,!1),g!==null&&x!==null&&xw(d,x,g,y,!0)}}e:{if(h=c?ka(c):window,p=h.nodeName&&h.nodeName.toLowerCase(),p==="select"||p==="input"&&h.type==="file")var C=U2;else if(dw(h))if(GC)C=q2;else{C=W2;var k=H2}else(p=h.nodeName)&&p.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(C=K2);if(C&&(C=C(t,c))){qC(d,C,n,u);break e}k&&k(t,h,c),t==="focusout"&&(k=h._wrapperState)&&k.controlled&&h.type==="number"&&fg(h,"number",h.value)}switch(k=c?ka(c):window,t){case"focusin":(dw(k)||k.contentEditable==="true")&&(Sa=k,kg=c,Ec=null);break;case"focusout":Ec=kg=Sa=null;break;case"mousedown":Eg=!0;break;case"contextmenu":case"mouseup":case"dragend":Eg=!1,gw(d,n,u);break;case"selectionchange":if(Y2)break;case"keydown":case"keyup":gw(d,n,u)}var E;if(Dv)e:{switch(t){case"compositionstart":var T="onCompositionStart";break e;case"compositionend":T="onCompositionEnd";break e;case"compositionupdate":T="onCompositionUpdate";break e}T=void 0}else ba?WC(t,n)&&(T="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(T="onCompositionStart");T&&(HC&&n.locale!=="ko"&&(ba||T!=="onCompositionStart"?T==="onCompositionEnd"&&ba&&(E=UC()):(io=u,Av="value"in io?io.value:io.textContent,ba=!0)),k=Rf(c,T),0<k.length&&(T=new aw(T,t,null,n,u),d.push({event:T,listeners:k}),E?T.data=E:(E=KC(n),E!==null&&(T.data=E)))),(E=$2?F2(t,n):B2(t,n))&&(c=Rf(c,"onBeforeInput"),0<c.length&&(u=new aw("onBeforeInput","beforeinput",null,n,u),d.push({event:u,listeners:c}),u.data=E))}ik(d,e)})}function Gc(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Rf(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,o=i.stateNode;i.tag===5&&o!==null&&(i=o,o=zc(t,n),o!=null&&r.unshift(Gc(t,o,i)),o=zc(t,e),o!=null&&r.push(Gc(t,o,i))),t=t.return}return r}function ra(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function xw(t,e,n,r,i){for(var o=e._reactName,s=[];n!==null&&n!==r;){var a=n,l=a.alternate,c=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&c!==null&&(a=c,i?(l=zc(n,o),l!=null&&s.unshift(Gc(n,l,a))):i||(l=zc(n,o),l!=null&&s.push(Gc(n,l,a)))),n=n.return}s.length!==0&&t.push({event:e,listeners:s})}var eI=/\r\n?/g,tI=/\u0000|\uFFFD/g;function ww(t){return(typeof t=="string"?t:""+t).replace(eI,`
`).replace(tI,"")}function vd(t,e,n){if(e=ww(e),ww(t)!==e&&n)throw Error(B(425))}function Of(){}var Tg=null,_g=null;function Rg(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Og=typeof setTimeout=="function"?setTimeout:void 0,nI=typeof clearTimeout=="function"?clearTimeout:void 0,bw=typeof Promise=="function"?Promise:void 0,rI=typeof queueMicrotask=="function"?queueMicrotask:typeof bw<"u"?function(t){return bw.resolve(null).then(t).catch(iI)}:Og;function iI(t){setTimeout(function(){throw t})}function Qp(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),Hc(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);Hc(e)}function ho(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Sw(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var jl=Math.random().toString(36).slice(2),Pr="__reactFiber$"+jl,Jc="__reactProps$"+jl,ui="__reactContainer$"+jl,Pg="__reactEvents$"+jl,oI="__reactListeners$"+jl,sI="__reactHandles$"+jl;function ts(t){var e=t[Pr];if(e)return e;for(var n=t.parentNode;n;){if(e=n[ui]||n[Pr]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=Sw(t);t!==null;){if(n=t[Pr])return n;t=Sw(t)}return e}t=n,n=t.parentNode}return null}function Lu(t){return t=t[Pr]||t[ui],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function ka(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(B(33))}function Rh(t){return t[Jc]||null}var Mg=[],Ea=-1;function No(t){return{current:t}}function Le(t){0>Ea||(t.current=Mg[Ea],Mg[Ea]=null,Ea--)}function Ae(t,e){Ea++,Mg[Ea]=t.current,t.current=e}var Eo={},Pt=No(Eo),ln=No(!1),Es=Eo;function ll(t,e){var n=t.type.contextTypes;if(!n)return Eo;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},o;for(o in n)i[o]=e[o];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function cn(t){return t=t.childContextTypes,t!=null}function Pf(){Le(ln),Le(Pt)}function Cw(t,e,n){if(Pt.current!==Eo)throw Error(B(168));Ae(Pt,e),Ae(ln,n)}function sk(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(B(108,HM(t)||"Unknown",i));return Ue({},n,r)}function Mf(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Eo,Es=Pt.current,Ae(Pt,t),Ae(ln,ln.current),!0}function kw(t,e,n){var r=t.stateNode;if(!r)throw Error(B(169));n?(t=sk(t,e,Es),r.__reactInternalMemoizedMergedChildContext=t,Le(ln),Le(Pt),Ae(Pt,t)):Le(ln),Ae(ln,n)}var Zr=null,Oh=!1,Xp=!1;function ak(t){Zr===null?Zr=[t]:Zr.push(t)}function aI(t){Oh=!0,ak(t)}function jo(){if(!Xp&&Zr!==null){Xp=!0;var t=0,e=Ee;try{var n=Zr;for(Ee=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Zr=null,Oh=!1}catch(i){throw Zr!==null&&(Zr=Zr.slice(t+1)),IC(Ov,jo),i}finally{Ee=e,Xp=!1}}return null}var Ta=[],_a=0,If=null,Af=0,An=[],Nn=0,Ts=null,ni=1,ri="";function qo(t,e){Ta[_a++]=Af,Ta[_a++]=If,If=t,Af=e}function lk(t,e,n){An[Nn++]=ni,An[Nn++]=ri,An[Nn++]=Ts,Ts=t;var r=ni;t=ri;var i=32-lr(r)-1;r&=~(1<<i),n+=1;var o=32-lr(e)+i;if(30<o){var s=i-i%5;o=(r&(1<<s)-1).toString(32),r>>=s,i-=s,ni=1<<32-lr(e)+i|n<<i|r,ri=o+t}else ni=1<<o|n<<i|r,ri=t}function $v(t){t.return!==null&&(qo(t,1),lk(t,1,0))}function Fv(t){for(;t===If;)If=Ta[--_a],Ta[_a]=null,Af=Ta[--_a],Ta[_a]=null;for(;t===Ts;)Ts=An[--Nn],An[Nn]=null,ri=An[--Nn],An[Nn]=null,ni=An[--Nn],An[Nn]=null}var Sn=null,bn=null,Fe=!1,ir=null;function ck(t,e){var n=Dn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function Ew(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Sn=t,bn=ho(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Sn=t,bn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Ts!==null?{id:ni,overflow:ri}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Dn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Sn=t,bn=null,!0):!1;default:return!1}}function Ig(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Ag(t){if(Fe){var e=bn;if(e){var n=e;if(!Ew(t,e)){if(Ig(t))throw Error(B(418));e=ho(n.nextSibling);var r=Sn;e&&Ew(t,e)?ck(r,n):(t.flags=t.flags&-4097|2,Fe=!1,Sn=t)}}else{if(Ig(t))throw Error(B(418));t.flags=t.flags&-4097|2,Fe=!1,Sn=t}}}function Tw(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Sn=t}function xd(t){if(t!==Sn)return!1;if(!Fe)return Tw(t),Fe=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Rg(t.type,t.memoizedProps)),e&&(e=bn)){if(Ig(t))throw uk(),Error(B(418));for(;e;)ck(t,e),e=ho(e.nextSibling)}if(Tw(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(B(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){bn=ho(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}bn=null}}else bn=Sn?ho(t.stateNode.nextSibling):null;return!0}function uk(){for(var t=bn;t;)t=ho(t.nextSibling)}function cl(){bn=Sn=null,Fe=!1}function Bv(t){ir===null?ir=[t]:ir.push(t)}var lI=gi.ReactCurrentBatchConfig;function nc(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(B(309));var r=n.stateNode}if(!r)throw Error(B(147,t));var i=r,o=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===o?e.ref:(e=function(s){var a=i.refs;s===null?delete a[o]:a[o]=s},e._stringRef=o,e)}if(typeof t!="string")throw Error(B(284));if(!n._owner)throw Error(B(290,t))}return t}function wd(t,e){throw t=Object.prototype.toString.call(e),Error(B(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function _w(t){var e=t._init;return e(t._payload)}function dk(t){function e(v,w){if(t){var b=v.deletions;b===null?(v.deletions=[w],v.flags|=16):b.push(w)}}function n(v,w){if(!t)return null;for(;w!==null;)e(v,w),w=w.sibling;return null}function r(v,w){for(v=new Map;w!==null;)w.key!==null?v.set(w.key,w):v.set(w.index,w),w=w.sibling;return v}function i(v,w){return v=yo(v,w),v.index=0,v.sibling=null,v}function o(v,w,b){return v.index=b,t?(b=v.alternate,b!==null?(b=b.index,b<w?(v.flags|=2,w):b):(v.flags|=2,w)):(v.flags|=1048576,w)}function s(v){return t&&v.alternate===null&&(v.flags|=2),v}function a(v,w,b,S){return w===null||w.tag!==6?(w=om(b,v.mode,S),w.return=v,w):(w=i(w,b),w.return=v,w)}function l(v,w,b,S){var C=b.type;return C===wa?u(v,w,b.props.children,S,b.key):w!==null&&(w.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===Pi&&_w(C)===w.type)?(S=i(w,b.props),S.ref=nc(v,w,b),S.return=v,S):(S=cf(b.type,b.key,b.props,null,v.mode,S),S.ref=nc(v,w,b),S.return=v,S)}function c(v,w,b,S){return w===null||w.tag!==4||w.stateNode.containerInfo!==b.containerInfo||w.stateNode.implementation!==b.implementation?(w=sm(b,v.mode,S),w.return=v,w):(w=i(w,b.children||[]),w.return=v,w)}function u(v,w,b,S,C){return w===null||w.tag!==7?(w=ys(b,v.mode,S,C),w.return=v,w):(w=i(w,b),w.return=v,w)}function d(v,w,b){if(typeof w=="string"&&w!==""||typeof w=="number")return w=om(""+w,v.mode,b),w.return=v,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case cd:return b=cf(w.type,w.key,w.props,null,v.mode,b),b.ref=nc(v,null,w),b.return=v,b;case xa:return w=sm(w,v.mode,b),w.return=v,w;case Pi:var S=w._init;return d(v,S(w._payload),b)}if(dc(w)||Ql(w))return w=ys(w,v.mode,b,null),w.return=v,w;wd(v,w)}return null}function h(v,w,b,S){var C=w!==null?w.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return C!==null?null:a(v,w,""+b,S);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case cd:return b.key===C?l(v,w,b,S):null;case xa:return b.key===C?c(v,w,b,S):null;case Pi:return C=b._init,h(v,w,C(b._payload),S)}if(dc(b)||Ql(b))return C!==null?null:u(v,w,b,S,null);wd(v,b)}return null}function p(v,w,b,S,C){if(typeof S=="string"&&S!==""||typeof S=="number")return v=v.get(b)||null,a(w,v,""+S,C);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case cd:return v=v.get(S.key===null?b:S.key)||null,l(w,v,S,C);case xa:return v=v.get(S.key===null?b:S.key)||null,c(w,v,S,C);case Pi:var k=S._init;return p(v,w,b,k(S._payload),C)}if(dc(S)||Ql(S))return v=v.get(b)||null,u(w,v,S,C,null);wd(w,S)}return null}function g(v,w,b,S){for(var C=null,k=null,E=w,T=w=0,R=null;E!==null&&T<b.length;T++){E.index>T?(R=E,E=null):R=E.sibling;var _=h(v,E,b[T],S);if(_===null){E===null&&(E=R);break}t&&E&&_.alternate===null&&e(v,E),w=o(_,w,T),k===null?C=_:k.sibling=_,k=_,E=R}if(T===b.length)return n(v,E),Fe&&qo(v,T),C;if(E===null){for(;T<b.length;T++)E=d(v,b[T],S),E!==null&&(w=o(E,w,T),k===null?C=E:k.sibling=E,k=E);return Fe&&qo(v,T),C}for(E=r(v,E);T<b.length;T++)R=p(E,v,T,b[T],S),R!==null&&(t&&R.alternate!==null&&E.delete(R.key===null?T:R.key),w=o(R,w,T),k===null?C=R:k.sibling=R,k=R);return t&&E.forEach(function(A){return e(v,A)}),Fe&&qo(v,T),C}function y(v,w,b,S){var C=Ql(b);if(typeof C!="function")throw Error(B(150));if(b=C.call(b),b==null)throw Error(B(151));for(var k=C=null,E=w,T=w=0,R=null,_=b.next();E!==null&&!_.done;T++,_=b.next()){E.index>T?(R=E,E=null):R=E.sibling;var A=h(v,E,_.value,S);if(A===null){E===null&&(E=R);break}t&&E&&A.alternate===null&&e(v,E),w=o(A,w,T),k===null?C=A:k.sibling=A,k=A,E=R}if(_.done)return n(v,E),Fe&&qo(v,T),C;if(E===null){for(;!_.done;T++,_=b.next())_=d(v,_.value,S),_!==null&&(w=o(_,w,T),k===null?C=_:k.sibling=_,k=_);return Fe&&qo(v,T),C}for(E=r(v,E);!_.done;T++,_=b.next())_=p(E,v,T,_.value,S),_!==null&&(t&&_.alternate!==null&&E.delete(_.key===null?T:_.key),w=o(_,w,T),k===null?C=_:k.sibling=_,k=_);return t&&E.forEach(function(L){return e(v,L)}),Fe&&qo(v,T),C}function x(v,w,b,S){if(typeof b=="object"&&b!==null&&b.type===wa&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case cd:e:{for(var C=b.key,k=w;k!==null;){if(k.key===C){if(C=b.type,C===wa){if(k.tag===7){n(v,k.sibling),w=i(k,b.props.children),w.return=v,v=w;break e}}else if(k.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===Pi&&_w(C)===k.type){n(v,k.sibling),w=i(k,b.props),w.ref=nc(v,k,b),w.return=v,v=w;break e}n(v,k);break}else e(v,k);k=k.sibling}b.type===wa?(w=ys(b.props.children,v.mode,S,b.key),w.return=v,v=w):(S=cf(b.type,b.key,b.props,null,v.mode,S),S.ref=nc(v,w,b),S.return=v,v=S)}return s(v);case xa:e:{for(k=b.key;w!==null;){if(w.key===k)if(w.tag===4&&w.stateNode.containerInfo===b.containerInfo&&w.stateNode.implementation===b.implementation){n(v,w.sibling),w=i(w,b.children||[]),w.return=v,v=w;break e}else{n(v,w);break}else e(v,w);w=w.sibling}w=sm(b,v.mode,S),w.return=v,v=w}return s(v);case Pi:return k=b._init,x(v,w,k(b._payload),S)}if(dc(b))return g(v,w,b,S);if(Ql(b))return y(v,w,b,S);wd(v,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,w!==null&&w.tag===6?(n(v,w.sibling),w=i(w,b),w.return=v,v=w):(n(v,w),w=om(b,v.mode,S),w.return=v,v=w),s(v)):n(v,w)}return x}var ul=dk(!0),fk=dk(!1),Nf=No(null),jf=null,Ra=null,zv=null;function Vv(){zv=Ra=jf=null}function Uv(t){var e=Nf.current;Le(Nf),t._currentValue=e}function Ng(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function $a(t,e){jf=t,zv=Ra=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(sn=!0),t.firstContext=null)}function Un(t){var e=t._currentValue;if(zv!==t)if(t={context:t,memoizedValue:e,next:null},Ra===null){if(jf===null)throw Error(B(308));Ra=t,jf.dependencies={lanes:0,firstContext:t}}else Ra=Ra.next=t;return e}var ns=null;function Hv(t){ns===null?ns=[t]:ns.push(t)}function hk(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,Hv(e)):(n.next=i.next,i.next=n),e.interleaved=n,di(t,r)}function di(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Mi=!1;function Wv(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function pk(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function si(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function po(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,be&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,di(t,n)}return i=r.interleaved,i===null?(e.next=e,Hv(r)):(e.next=i.next,i.next=e),r.interleaved=e,di(t,n)}function nf(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Pv(t,n)}}function Rw(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,o=null;if(n=n.firstBaseUpdate,n!==null){do{var s={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};o===null?i=o=s:o=o.next=s,n=n.next}while(n!==null);o===null?i=o=e:o=o.next=e}else i=o=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Df(t,e,n,r){var i=t.updateQueue;Mi=!1;var o=i.firstBaseUpdate,s=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var l=a,c=l.next;l.next=null,s===null?o=c:s.next=c,s=l;var u=t.alternate;u!==null&&(u=u.updateQueue,a=u.lastBaseUpdate,a!==s&&(a===null?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(o!==null){var d=i.baseState;s=0,u=c=l=null,a=o;do{var h=a.lane,p=a.eventTime;if((r&h)===h){u!==null&&(u=u.next={eventTime:p,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var g=t,y=a;switch(h=e,p=n,y.tag){case 1:if(g=y.payload,typeof g=="function"){d=g.call(p,d,h);break e}d=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=y.payload,h=typeof g=="function"?g.call(p,d,h):g,h==null)break e;d=Ue({},d,h);break e;case 2:Mi=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,h=i.effects,h===null?i.effects=[a]:h.push(a))}else p={eventTime:p,lane:h,tag:a.tag,payload:a.payload,callback:a.callback,next:null},u===null?(c=u=p,l=d):u=u.next=p,s|=h;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;h=a,a=h.next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}while(1);if(u===null&&(l=d),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=u,e=i.shared.interleaved,e!==null){i=e;do s|=i.lane,i=i.next;while(i!==e)}else o===null&&(i.shared.lanes=0);Rs|=s,t.lanes=s,t.memoizedState=d}}function Ow(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(B(191,i));i.call(r)}}}var $u={},jr=No($u),Yc=No($u),Qc=No($u);function rs(t){if(t===$u)throw Error(B(174));return t}function Kv(t,e){switch(Ae(Qc,e),Ae(Yc,t),Ae(jr,$u),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:pg(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=pg(e,t)}Le(jr),Ae(jr,e)}function dl(){Le(jr),Le(Yc),Le(Qc)}function mk(t){rs(Qc.current);var e=rs(jr.current),n=pg(e,t.type);e!==n&&(Ae(Yc,t),Ae(jr,n))}function qv(t){Yc.current===t&&(Le(jr),Le(Yc))}var ze=No(0);function Lf(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Zp=[];function Gv(){for(var t=0;t<Zp.length;t++)Zp[t]._workInProgressVersionPrimary=null;Zp.length=0}var rf=gi.ReactCurrentDispatcher,em=gi.ReactCurrentBatchConfig,_s=0,Ve=null,nt=null,st=null,$f=!1,Tc=!1,Xc=0,cI=0;function St(){throw Error(B(321))}function Jv(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!ur(t[n],e[n]))return!1;return!0}function Yv(t,e,n,r,i,o){if(_s=o,Ve=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,rf.current=t===null||t.memoizedState===null?hI:pI,t=n(r,i),Tc){o=0;do{if(Tc=!1,Xc=0,25<=o)throw Error(B(301));o+=1,st=nt=null,e.updateQueue=null,rf.current=mI,t=n(r,i)}while(Tc)}if(rf.current=Ff,e=nt!==null&&nt.next!==null,_s=0,st=nt=Ve=null,$f=!1,e)throw Error(B(300));return t}function Qv(){var t=Xc!==0;return Xc=0,t}function kr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return st===null?Ve.memoizedState=st=t:st=st.next=t,st}function Hn(){if(nt===null){var t=Ve.alternate;t=t!==null?t.memoizedState:null}else t=nt.next;var e=st===null?Ve.memoizedState:st.next;if(e!==null)st=e,nt=t;else{if(t===null)throw Error(B(310));nt=t,t={memoizedState:nt.memoizedState,baseState:nt.baseState,baseQueue:nt.baseQueue,queue:nt.queue,next:null},st===null?Ve.memoizedState=st=t:st=st.next=t}return st}function Zc(t,e){return typeof e=="function"?e(t):e}function tm(t){var e=Hn(),n=e.queue;if(n===null)throw Error(B(311));n.lastRenderedReducer=t;var r=nt,i=r.baseQueue,o=n.pending;if(o!==null){if(i!==null){var s=i.next;i.next=o.next,o.next=s}r.baseQueue=i=o,n.pending=null}if(i!==null){o=i.next,r=r.baseState;var a=s=null,l=null,c=o;do{var u=c.lane;if((_s&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:t(r,c.action);else{var d={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(a=l=d,s=r):l=l.next=d,Ve.lanes|=u,Rs|=u}c=c.next}while(c!==null&&c!==o);l===null?s=r:l.next=a,ur(r,e.memoizedState)||(sn=!0),e.memoizedState=r,e.baseState=s,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do o=i.lane,Ve.lanes|=o,Rs|=o,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function nm(t){var e=Hn(),n=e.queue;if(n===null)throw Error(B(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,o=e.memoizedState;if(i!==null){n.pending=null;var s=i=i.next;do o=t(o,s.action),s=s.next;while(s!==i);ur(o,e.memoizedState)||(sn=!0),e.memoizedState=o,e.baseQueue===null&&(e.baseState=o),n.lastRenderedState=o}return[o,r]}function gk(){}function yk(t,e){var n=Ve,r=Hn(),i=e(),o=!ur(r.memoizedState,i);if(o&&(r.memoizedState=i,sn=!0),r=r.queue,Xv(wk.bind(null,n,r,t),[t]),r.getSnapshot!==e||o||st!==null&&st.memoizedState.tag&1){if(n.flags|=2048,eu(9,xk.bind(null,n,r,i,e),void 0,null),lt===null)throw Error(B(349));_s&30||vk(n,e,i)}return i}function vk(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Ve.updateQueue,e===null?(e={lastEffect:null,stores:null},Ve.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function xk(t,e,n,r){e.value=n,e.getSnapshot=r,bk(e)&&Sk(t)}function wk(t,e,n){return n(function(){bk(e)&&Sk(t)})}function bk(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!ur(t,n)}catch{return!0}}function Sk(t){var e=di(t,1);e!==null&&cr(e,t,1,-1)}function Pw(t){var e=kr();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Zc,lastRenderedState:t},e.queue=t,t=t.dispatch=fI.bind(null,Ve,t),[e.memoizedState,t]}function eu(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Ve.updateQueue,e===null?(e={lastEffect:null,stores:null},Ve.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function Ck(){return Hn().memoizedState}function of(t,e,n,r){var i=kr();Ve.flags|=t,i.memoizedState=eu(1|e,n,void 0,r===void 0?null:r)}function Ph(t,e,n,r){var i=Hn();r=r===void 0?null:r;var o=void 0;if(nt!==null){var s=nt.memoizedState;if(o=s.destroy,r!==null&&Jv(r,s.deps)){i.memoizedState=eu(e,n,o,r);return}}Ve.flags|=t,i.memoizedState=eu(1|e,n,o,r)}function Mw(t,e){return of(8390656,8,t,e)}function Xv(t,e){return Ph(2048,8,t,e)}function kk(t,e){return Ph(4,2,t,e)}function Ek(t,e){return Ph(4,4,t,e)}function Tk(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function _k(t,e,n){return n=n!=null?n.concat([t]):null,Ph(4,4,Tk.bind(null,e,t),n)}function Zv(){}function Rk(t,e){var n=Hn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Jv(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function Ok(t,e){var n=Hn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Jv(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function Pk(t,e,n){return _s&21?(ur(n,e)||(n=jC(),Ve.lanes|=n,Rs|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,sn=!0),t.memoizedState=n)}function uI(t,e){var n=Ee;Ee=n!==0&&4>n?n:4,t(!0);var r=em.transition;em.transition={};try{t(!1),e()}finally{Ee=n,em.transition=r}}function Mk(){return Hn().memoizedState}function dI(t,e,n){var r=go(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Ik(t))Ak(e,n);else if(n=hk(t,e,n,r),n!==null){var i=Ht();cr(n,t,r,i),Nk(n,e,r)}}function fI(t,e,n){var r=go(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Ik(t))Ak(e,i);else{var o=t.alternate;if(t.lanes===0&&(o===null||o.lanes===0)&&(o=e.lastRenderedReducer,o!==null))try{var s=e.lastRenderedState,a=o(s,n);if(i.hasEagerState=!0,i.eagerState=a,ur(a,s)){var l=e.interleaved;l===null?(i.next=i,Hv(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}n=hk(t,e,i,r),n!==null&&(i=Ht(),cr(n,t,r,i),Nk(n,e,r))}}function Ik(t){var e=t.alternate;return t===Ve||e!==null&&e===Ve}function Ak(t,e){Tc=$f=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function Nk(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Pv(t,n)}}var Ff={readContext:Un,useCallback:St,useContext:St,useEffect:St,useImperativeHandle:St,useInsertionEffect:St,useLayoutEffect:St,useMemo:St,useReducer:St,useRef:St,useState:St,useDebugValue:St,useDeferredValue:St,useTransition:St,useMutableSource:St,useSyncExternalStore:St,useId:St,unstable_isNewReconciler:!1},hI={readContext:Un,useCallback:function(t,e){return kr().memoizedState=[t,e===void 0?null:e],t},useContext:Un,useEffect:Mw,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,of(4194308,4,Tk.bind(null,e,t),n)},useLayoutEffect:function(t,e){return of(4194308,4,t,e)},useInsertionEffect:function(t,e){return of(4,2,t,e)},useMemo:function(t,e){var n=kr();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=kr();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=dI.bind(null,Ve,t),[r.memoizedState,t]},useRef:function(t){var e=kr();return t={current:t},e.memoizedState=t},useState:Pw,useDebugValue:Zv,useDeferredValue:function(t){return kr().memoizedState=t},useTransition:function(){var t=Pw(!1),e=t[0];return t=uI.bind(null,t[1]),kr().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Ve,i=kr();if(Fe){if(n===void 0)throw Error(B(407));n=n()}else{if(n=e(),lt===null)throw Error(B(349));_s&30||vk(r,e,n)}i.memoizedState=n;var o={value:n,getSnapshot:e};return i.queue=o,Mw(wk.bind(null,r,o,t),[t]),r.flags|=2048,eu(9,xk.bind(null,r,o,n,e),void 0,null),n},useId:function(){var t=kr(),e=lt.identifierPrefix;if(Fe){var n=ri,r=ni;n=(r&~(1<<32-lr(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Xc++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=cI++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},pI={readContext:Un,useCallback:Rk,useContext:Un,useEffect:Xv,useImperativeHandle:_k,useInsertionEffect:kk,useLayoutEffect:Ek,useMemo:Ok,useReducer:tm,useRef:Ck,useState:function(){return tm(Zc)},useDebugValue:Zv,useDeferredValue:function(t){var e=Hn();return Pk(e,nt.memoizedState,t)},useTransition:function(){var t=tm(Zc)[0],e=Hn().memoizedState;return[t,e]},useMutableSource:gk,useSyncExternalStore:yk,useId:Mk,unstable_isNewReconciler:!1},mI={readContext:Un,useCallback:Rk,useContext:Un,useEffect:Xv,useImperativeHandle:_k,useInsertionEffect:kk,useLayoutEffect:Ek,useMemo:Ok,useReducer:nm,useRef:Ck,useState:function(){return nm(Zc)},useDebugValue:Zv,useDeferredValue:function(t){var e=Hn();return nt===null?e.memoizedState=t:Pk(e,nt.memoizedState,t)},useTransition:function(){var t=nm(Zc)[0],e=Hn().memoizedState;return[t,e]},useMutableSource:gk,useSyncExternalStore:yk,useId:Mk,unstable_isNewReconciler:!1};function Zn(t,e){if(t&&t.defaultProps){e=Ue({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function jg(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Ue({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Mh={isMounted:function(t){return(t=t._reactInternals)?qs(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Ht(),i=go(t),o=si(r,i);o.payload=e,n!=null&&(o.callback=n),e=po(t,o,i),e!==null&&(cr(e,t,i,r),nf(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Ht(),i=go(t),o=si(r,i);o.tag=1,o.payload=e,n!=null&&(o.callback=n),e=po(t,o,i),e!==null&&(cr(e,t,i,r),nf(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Ht(),r=go(t),i=si(n,r);i.tag=2,e!=null&&(i.callback=e),e=po(t,i,r),e!==null&&(cr(e,t,r,n),nf(e,t,r))}};function Iw(t,e,n,r,i,o,s){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,o,s):e.prototype&&e.prototype.isPureReactComponent?!Kc(n,r)||!Kc(i,o):!0}function jk(t,e,n){var r=!1,i=Eo,o=e.contextType;return typeof o=="object"&&o!==null?o=Un(o):(i=cn(e)?Es:Pt.current,r=e.contextTypes,o=(r=r!=null)?ll(t,i):Eo),e=new e(n,o),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Mh,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=o),e}function Aw(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Mh.enqueueReplaceState(e,e.state,null)}function Dg(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},Wv(t);var o=e.contextType;typeof o=="object"&&o!==null?i.context=Un(o):(o=cn(e)?Es:Pt.current,i.context=ll(t,o)),i.state=t.memoizedState,o=e.getDerivedStateFromProps,typeof o=="function"&&(jg(t,e,o,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Mh.enqueueReplaceState(i,i.state,null),Df(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function fl(t,e){try{var n="",r=e;do n+=UM(r),r=r.return;while(r);var i=n}catch(o){i=`
Error generating stack: `+o.message+`
`+o.stack}return{value:t,source:e,stack:i,digest:null}}function rm(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Lg(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var gI=typeof WeakMap=="function"?WeakMap:Map;function Dk(t,e,n){n=si(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){zf||(zf=!0,qg=r),Lg(t,e)},n}function Lk(t,e,n){n=si(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){Lg(t,e)}}var o=t.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(n.callback=function(){Lg(t,e),typeof r!="function"&&(mo===null?mo=new Set([this]):mo.add(this));var s=e.stack;this.componentDidCatch(e.value,{componentStack:s!==null?s:""})}),n}function Nw(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new gI;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=PI.bind(null,t,e,n),e.then(t,t))}function jw(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Dw(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=si(-1,1),e.tag=2,po(n,e,1))),n.lanes|=1),t)}var yI=gi.ReactCurrentOwner,sn=!1;function Vt(t,e,n,r){e.child=t===null?fk(e,null,n,r):ul(e,t.child,n,r)}function Lw(t,e,n,r,i){n=n.render;var o=e.ref;return $a(e,i),r=Yv(t,e,n,r,o,i),n=Qv(),t!==null&&!sn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,fi(t,e,i)):(Fe&&n&&$v(e),e.flags|=1,Vt(t,e,r,i),e.child)}function $w(t,e,n,r,i){if(t===null){var o=n.type;return typeof o=="function"&&!a0(o)&&o.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=o,$k(t,e,o,r,i)):(t=cf(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(o=t.child,!(t.lanes&i)){var s=o.memoizedProps;if(n=n.compare,n=n!==null?n:Kc,n(s,r)&&t.ref===e.ref)return fi(t,e,i)}return e.flags|=1,t=yo(o,r),t.ref=e.ref,t.return=e,e.child=t}function $k(t,e,n,r,i){if(t!==null){var o=t.memoizedProps;if(Kc(o,r)&&t.ref===e.ref)if(sn=!1,e.pendingProps=r=o,(t.lanes&i)!==0)t.flags&131072&&(sn=!0);else return e.lanes=t.lanes,fi(t,e,i)}return $g(t,e,n,r,i)}function Fk(t,e,n){var r=e.pendingProps,i=r.children,o=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ae(Pa,vn),vn|=n;else{if(!(n&1073741824))return t=o!==null?o.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Ae(Pa,vn),vn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=o!==null?o.baseLanes:n,Ae(Pa,vn),vn|=r}else o!==null?(r=o.baseLanes|n,e.memoizedState=null):r=n,Ae(Pa,vn),vn|=r;return Vt(t,e,i,n),e.child}function Bk(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function $g(t,e,n,r,i){var o=cn(n)?Es:Pt.current;return o=ll(e,o),$a(e,i),n=Yv(t,e,n,r,o,i),r=Qv(),t!==null&&!sn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,fi(t,e,i)):(Fe&&r&&$v(e),e.flags|=1,Vt(t,e,n,i),e.child)}function Fw(t,e,n,r,i){if(cn(n)){var o=!0;Mf(e)}else o=!1;if($a(e,i),e.stateNode===null)sf(t,e),jk(e,n,r),Dg(e,n,r,i),r=!0;else if(t===null){var s=e.stateNode,a=e.memoizedProps;s.props=a;var l=s.context,c=n.contextType;typeof c=="object"&&c!==null?c=Un(c):(c=cn(n)?Es:Pt.current,c=ll(e,c));var u=n.getDerivedStateFromProps,d=typeof u=="function"||typeof s.getSnapshotBeforeUpdate=="function";d||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(a!==r||l!==c)&&Aw(e,s,r,c),Mi=!1;var h=e.memoizedState;s.state=h,Df(e,r,s,i),l=e.memoizedState,a!==r||h!==l||ln.current||Mi?(typeof u=="function"&&(jg(e,n,u,r),l=e.memoizedState),(a=Mi||Iw(e,n,a,r,h,l,c))?(d||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(e.flags|=4194308)):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),s.props=r,s.state=l,s.context=c,r=a):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{s=e.stateNode,pk(t,e),a=e.memoizedProps,c=e.type===e.elementType?a:Zn(e.type,a),s.props=c,d=e.pendingProps,h=s.context,l=n.contextType,typeof l=="object"&&l!==null?l=Un(l):(l=cn(n)?Es:Pt.current,l=ll(e,l));var p=n.getDerivedStateFromProps;(u=typeof p=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(a!==d||h!==l)&&Aw(e,s,r,l),Mi=!1,h=e.memoizedState,s.state=h,Df(e,r,s,i);var g=e.memoizedState;a!==d||h!==g||ln.current||Mi?(typeof p=="function"&&(jg(e,n,p,r),g=e.memoizedState),(c=Mi||Iw(e,n,c,r,h,g,l)||!1)?(u||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(r,g,l),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(r,g,l)),typeof s.componentDidUpdate=="function"&&(e.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof s.componentDidUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=g),s.props=r,s.state=g,s.context=l,r=c):(typeof s.componentDidUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),r=!1)}return Fg(t,e,n,r,o,i)}function Fg(t,e,n,r,i,o){Bk(t,e);var s=(e.flags&128)!==0;if(!r&&!s)return i&&kw(e,n,!1),fi(t,e,o);r=e.stateNode,yI.current=e;var a=s&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&s?(e.child=ul(e,t.child,null,o),e.child=ul(e,null,a,o)):Vt(t,e,a,o),e.memoizedState=r.state,i&&kw(e,n,!0),e.child}function zk(t){var e=t.stateNode;e.pendingContext?Cw(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Cw(t,e.context,!1),Kv(t,e.containerInfo)}function Bw(t,e,n,r,i){return cl(),Bv(i),e.flags|=256,Vt(t,e,n,r),e.child}var Bg={dehydrated:null,treeContext:null,retryLane:0};function zg(t){return{baseLanes:t,cachePool:null,transitions:null}}function Vk(t,e,n){var r=e.pendingProps,i=ze.current,o=!1,s=(e.flags&128)!==0,a;if((a=s)||(a=t!==null&&t.memoizedState===null?!1:(i&2)!==0),a?(o=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),Ae(ze,i&1),t===null)return Ag(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(s=r.children,t=r.fallback,o?(r=e.mode,o=e.child,s={mode:"hidden",children:s},!(r&1)&&o!==null?(o.childLanes=0,o.pendingProps=s):o=Nh(s,r,0,null),t=ys(t,r,n,null),o.return=e,t.return=e,o.sibling=t,e.child=o,e.child.memoizedState=zg(n),e.memoizedState=Bg,t):e0(e,s));if(i=t.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return vI(t,e,s,r,a,i,n);if(o){o=r.fallback,s=e.mode,i=t.child,a=i.sibling;var l={mode:"hidden",children:r.children};return!(s&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=yo(i,l),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?o=yo(a,o):(o=ys(o,s,n,null),o.flags|=2),o.return=e,r.return=e,r.sibling=o,e.child=r,r=o,o=e.child,s=t.child.memoizedState,s=s===null?zg(n):{baseLanes:s.baseLanes|n,cachePool:null,transitions:s.transitions},o.memoizedState=s,o.childLanes=t.childLanes&~n,e.memoizedState=Bg,r}return o=t.child,t=o.sibling,r=yo(o,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function e0(t,e){return e=Nh({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function bd(t,e,n,r){return r!==null&&Bv(r),ul(e,t.child,null,n),t=e0(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function vI(t,e,n,r,i,o,s){if(n)return e.flags&256?(e.flags&=-257,r=rm(Error(B(422))),bd(t,e,s,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(o=r.fallback,i=e.mode,r=Nh({mode:"visible",children:r.children},i,0,null),o=ys(o,i,s,null),o.flags|=2,r.return=e,o.return=e,r.sibling=o,e.child=r,e.mode&1&&ul(e,t.child,null,s),e.child.memoizedState=zg(s),e.memoizedState=Bg,o);if(!(e.mode&1))return bd(t,e,s,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,o=Error(B(419)),r=rm(o,r,void 0),bd(t,e,s,r)}if(a=(s&t.childLanes)!==0,sn||a){if(r=lt,r!==null){switch(s&-s){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|s)?0:i,i!==0&&i!==o.retryLane&&(o.retryLane=i,di(t,i),cr(r,t,i,-1))}return s0(),r=rm(Error(B(421))),bd(t,e,s,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=MI.bind(null,t),i._reactRetry=e,null):(t=o.treeContext,bn=ho(i.nextSibling),Sn=e,Fe=!0,ir=null,t!==null&&(An[Nn++]=ni,An[Nn++]=ri,An[Nn++]=Ts,ni=t.id,ri=t.overflow,Ts=e),e=e0(e,r.children),e.flags|=4096,e)}function zw(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Ng(t.return,e,n)}function im(t,e,n,r,i){var o=t.memoizedState;o===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(o.isBackwards=e,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=i)}function Uk(t,e,n){var r=e.pendingProps,i=r.revealOrder,o=r.tail;if(Vt(t,e,r.children,n),r=ze.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&zw(t,n,e);else if(t.tag===19)zw(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Ae(ze,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&Lf(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),im(e,!1,i,n,o);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&Lf(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}im(e,!0,n,null,o);break;case"together":im(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function sf(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function fi(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Rs|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(B(153));if(e.child!==null){for(t=e.child,n=yo(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=yo(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function xI(t,e,n){switch(e.tag){case 3:zk(e),cl();break;case 5:mk(e);break;case 1:cn(e.type)&&Mf(e);break;case 4:Kv(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;Ae(Nf,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Ae(ze,ze.current&1),e.flags|=128,null):n&e.child.childLanes?Vk(t,e,n):(Ae(ze,ze.current&1),t=fi(t,e,n),t!==null?t.sibling:null);Ae(ze,ze.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return Uk(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Ae(ze,ze.current),r)break;return null;case 22:case 23:return e.lanes=0,Fk(t,e,n)}return fi(t,e,n)}var Hk,Vg,Wk,Kk;Hk=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Vg=function(){};Wk=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,rs(jr.current);var o=null;switch(n){case"input":i=ug(t,i),r=ug(t,r),o=[];break;case"select":i=Ue({},i,{value:void 0}),r=Ue({},r,{value:void 0}),o=[];break;case"textarea":i=hg(t,i),r=hg(t,r),o=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Of)}mg(n,r);var s;n=null;for(c in i)if(!r.hasOwnProperty(c)&&i.hasOwnProperty(c)&&i[c]!=null)if(c==="style"){var a=i[c];for(s in a)a.hasOwnProperty(s)&&(n||(n={}),n[s]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Fc.hasOwnProperty(c)?o||(o=[]):(o=o||[]).push(c,null));for(c in r){var l=r[c];if(a=i!=null?i[c]:void 0,r.hasOwnProperty(c)&&l!==a&&(l!=null||a!=null))if(c==="style")if(a){for(s in a)!a.hasOwnProperty(s)||l&&l.hasOwnProperty(s)||(n||(n={}),n[s]="");for(s in l)l.hasOwnProperty(s)&&a[s]!==l[s]&&(n||(n={}),n[s]=l[s])}else n||(o||(o=[]),o.push(c,n)),n=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(o=o||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(o=o||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Fc.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&De("scroll",t),o||a===l||(o=[])):(o=o||[]).push(c,l))}n&&(o=o||[]).push("style",n);var c=o;(e.updateQueue=c)&&(e.flags|=4)}};Kk=function(t,e,n,r){n!==r&&(e.flags|=4)};function rc(t,e){if(!Fe)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Ct(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function wI(t,e,n){var r=e.pendingProps;switch(Fv(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ct(e),null;case 1:return cn(e.type)&&Pf(),Ct(e),null;case 3:return r=e.stateNode,dl(),Le(ln),Le(Pt),Gv(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(xd(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,ir!==null&&(Yg(ir),ir=null))),Vg(t,e),Ct(e),null;case 5:qv(e);var i=rs(Qc.current);if(n=e.type,t!==null&&e.stateNode!=null)Wk(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(B(166));return Ct(e),null}if(t=rs(jr.current),xd(e)){r=e.stateNode,n=e.type;var o=e.memoizedProps;switch(r[Pr]=e,r[Jc]=o,t=(e.mode&1)!==0,n){case"dialog":De("cancel",r),De("close",r);break;case"iframe":case"object":case"embed":De("load",r);break;case"video":case"audio":for(i=0;i<hc.length;i++)De(hc[i],r);break;case"source":De("error",r);break;case"img":case"image":case"link":De("error",r),De("load",r);break;case"details":De("toggle",r);break;case"input":Yx(r,o),De("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},De("invalid",r);break;case"textarea":Xx(r,o),De("invalid",r)}mg(n,o),i=null;for(var s in o)if(o.hasOwnProperty(s)){var a=o[s];s==="children"?typeof a=="string"?r.textContent!==a&&(o.suppressHydrationWarning!==!0&&vd(r.textContent,a,t),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(o.suppressHydrationWarning!==!0&&vd(r.textContent,a,t),i=["children",""+a]):Fc.hasOwnProperty(s)&&a!=null&&s==="onScroll"&&De("scroll",r)}switch(n){case"input":ud(r),Qx(r,o,!0);break;case"textarea":ud(r),Zx(r);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(r.onclick=Of)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{s=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=wC(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=s.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=s.createElement(n,{is:r.is}):(t=s.createElement(n),n==="select"&&(s=t,r.multiple?s.multiple=!0:r.size&&(s.size=r.size))):t=s.createElementNS(t,n),t[Pr]=e,t[Jc]=r,Hk(t,e,!1,!1),e.stateNode=t;e:{switch(s=gg(n,r),n){case"dialog":De("cancel",t),De("close",t),i=r;break;case"iframe":case"object":case"embed":De("load",t),i=r;break;case"video":case"audio":for(i=0;i<hc.length;i++)De(hc[i],t);i=r;break;case"source":De("error",t),i=r;break;case"img":case"image":case"link":De("error",t),De("load",t),i=r;break;case"details":De("toggle",t),i=r;break;case"input":Yx(t,r),i=ug(t,r),De("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=Ue({},r,{value:void 0}),De("invalid",t);break;case"textarea":Xx(t,r),i=hg(t,r),De("invalid",t);break;default:i=r}mg(n,i),a=i;for(o in a)if(a.hasOwnProperty(o)){var l=a[o];o==="style"?CC(t,l):o==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&bC(t,l)):o==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&Bc(t,l):typeof l=="number"&&Bc(t,""+l):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(Fc.hasOwnProperty(o)?l!=null&&o==="onScroll"&&De("scroll",t):l!=null&&kv(t,o,l,s))}switch(n){case"input":ud(t),Qx(t,r,!1);break;case"textarea":ud(t),Zx(t);break;case"option":r.value!=null&&t.setAttribute("value",""+ko(r.value));break;case"select":t.multiple=!!r.multiple,o=r.value,o!=null?Na(t,!!r.multiple,o,!1):r.defaultValue!=null&&Na(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=Of)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Ct(e),null;case 6:if(t&&e.stateNode!=null)Kk(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(B(166));if(n=rs(Qc.current),rs(jr.current),xd(e)){if(r=e.stateNode,n=e.memoizedProps,r[Pr]=e,(o=r.nodeValue!==n)&&(t=Sn,t!==null))switch(t.tag){case 3:vd(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&vd(r.nodeValue,n,(t.mode&1)!==0)}o&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Pr]=e,e.stateNode=r}return Ct(e),null;case 13:if(Le(ze),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Fe&&bn!==null&&e.mode&1&&!(e.flags&128))uk(),cl(),e.flags|=98560,o=!1;else if(o=xd(e),r!==null&&r.dehydrated!==null){if(t===null){if(!o)throw Error(B(318));if(o=e.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(B(317));o[Pr]=e}else cl(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Ct(e),o=!1}else ir!==null&&(Yg(ir),ir=null),o=!0;if(!o)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||ze.current&1?it===0&&(it=3):s0())),e.updateQueue!==null&&(e.flags|=4),Ct(e),null);case 4:return dl(),Vg(t,e),t===null&&qc(e.stateNode.containerInfo),Ct(e),null;case 10:return Uv(e.type._context),Ct(e),null;case 17:return cn(e.type)&&Pf(),Ct(e),null;case 19:if(Le(ze),o=e.memoizedState,o===null)return Ct(e),null;if(r=(e.flags&128)!==0,s=o.rendering,s===null)if(r)rc(o,!1);else{if(it!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(s=Lf(t),s!==null){for(e.flags|=128,rc(o,!1),r=s.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)o=n,t=r,o.flags&=14680066,s=o.alternate,s===null?(o.childLanes=0,o.lanes=t,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=s.childLanes,o.lanes=s.lanes,o.child=s.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=s.memoizedProps,o.memoizedState=s.memoizedState,o.updateQueue=s.updateQueue,o.type=s.type,t=s.dependencies,o.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Ae(ze,ze.current&1|2),e.child}t=t.sibling}o.tail!==null&&Ye()>hl&&(e.flags|=128,r=!0,rc(o,!1),e.lanes=4194304)}else{if(!r)if(t=Lf(s),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),rc(o,!0),o.tail===null&&o.tailMode==="hidden"&&!s.alternate&&!Fe)return Ct(e),null}else 2*Ye()-o.renderingStartTime>hl&&n!==1073741824&&(e.flags|=128,r=!0,rc(o,!1),e.lanes=4194304);o.isBackwards?(s.sibling=e.child,e.child=s):(n=o.last,n!==null?n.sibling=s:e.child=s,o.last=s)}return o.tail!==null?(e=o.tail,o.rendering=e,o.tail=e.sibling,o.renderingStartTime=Ye(),e.sibling=null,n=ze.current,Ae(ze,r?n&1|2:n&1),e):(Ct(e),null);case 22:case 23:return o0(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?vn&1073741824&&(Ct(e),e.subtreeFlags&6&&(e.flags|=8192)):Ct(e),null;case 24:return null;case 25:return null}throw Error(B(156,e.tag))}function bI(t,e){switch(Fv(e),e.tag){case 1:return cn(e.type)&&Pf(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return dl(),Le(ln),Le(Pt),Gv(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return qv(e),null;case 13:if(Le(ze),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(B(340));cl()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Le(ze),null;case 4:return dl(),null;case 10:return Uv(e.type._context),null;case 22:case 23:return o0(),null;case 24:return null;default:return null}}var Sd=!1,Rt=!1,SI=typeof WeakSet=="function"?WeakSet:Set,G=null;function Oa(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){We(t,e,r)}else n.current=null}function Ug(t,e,n){try{n()}catch(r){We(t,e,r)}}var Vw=!1;function CI(t,e){if(Tg=Tf,t=QC(),Lv(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch{n=null;break e}var s=0,a=-1,l=-1,c=0,u=0,d=t,h=null;t:for(;;){for(var p;d!==n||i!==0&&d.nodeType!==3||(a=s+i),d!==o||r!==0&&d.nodeType!==3||(l=s+r),d.nodeType===3&&(s+=d.nodeValue.length),(p=d.firstChild)!==null;)h=d,d=p;for(;;){if(d===t)break t;if(h===n&&++c===i&&(a=s),h===o&&++u===r&&(l=s),(p=d.nextSibling)!==null)break;d=h,h=d.parentNode}d=p}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(_g={focusedElem:t,selectionRange:n},Tf=!1,G=e;G!==null;)if(e=G,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,G=t;else for(;G!==null;){e=G;try{var g=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var y=g.memoizedProps,x=g.memoizedState,v=e.stateNode,w=v.getSnapshotBeforeUpdate(e.elementType===e.type?y:Zn(e.type,y),x);v.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var b=e.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(B(163))}}catch(S){We(e,e.return,S)}if(t=e.sibling,t!==null){t.return=e.return,G=t;break}G=e.return}return g=Vw,Vw=!1,g}function _c(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var o=i.destroy;i.destroy=void 0,o!==void 0&&Ug(e,n,o)}i=i.next}while(i!==r)}}function Ih(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Hg(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function qk(t){var e=t.alternate;e!==null&&(t.alternate=null,qk(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Pr],delete e[Jc],delete e[Pg],delete e[oI],delete e[sI])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function Gk(t){return t.tag===5||t.tag===3||t.tag===4}function Uw(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Gk(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Wg(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Of));else if(r!==4&&(t=t.child,t!==null))for(Wg(t,e,n),t=t.sibling;t!==null;)Wg(t,e,n),t=t.sibling}function Kg(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Kg(t,e,n),t=t.sibling;t!==null;)Kg(t,e,n),t=t.sibling}var pt=null,nr=!1;function wi(t,e,n){for(n=n.child;n!==null;)Jk(t,e,n),n=n.sibling}function Jk(t,e,n){if(Nr&&typeof Nr.onCommitFiberUnmount=="function")try{Nr.onCommitFiberUnmount(kh,n)}catch{}switch(n.tag){case 5:Rt||Oa(n,e);case 6:var r=pt,i=nr;pt=null,wi(t,e,n),pt=r,nr=i,pt!==null&&(nr?(t=pt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):pt.removeChild(n.stateNode));break;case 18:pt!==null&&(nr?(t=pt,n=n.stateNode,t.nodeType===8?Qp(t.parentNode,n):t.nodeType===1&&Qp(t,n),Hc(t)):Qp(pt,n.stateNode));break;case 4:r=pt,i=nr,pt=n.stateNode.containerInfo,nr=!0,wi(t,e,n),pt=r,nr=i;break;case 0:case 11:case 14:case 15:if(!Rt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var o=i,s=o.destroy;o=o.tag,s!==void 0&&(o&2||o&4)&&Ug(n,e,s),i=i.next}while(i!==r)}wi(t,e,n);break;case 1:if(!Rt&&(Oa(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){We(n,e,a)}wi(t,e,n);break;case 21:wi(t,e,n);break;case 22:n.mode&1?(Rt=(r=Rt)||n.memoizedState!==null,wi(t,e,n),Rt=r):wi(t,e,n);break;default:wi(t,e,n)}}function Hw(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new SI),e.forEach(function(r){var i=II.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function Qn(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var o=t,s=e,a=s;e:for(;a!==null;){switch(a.tag){case 5:pt=a.stateNode,nr=!1;break e;case 3:pt=a.stateNode.containerInfo,nr=!0;break e;case 4:pt=a.stateNode.containerInfo,nr=!0;break e}a=a.return}if(pt===null)throw Error(B(160));Jk(o,s,i),pt=null,nr=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(c){We(i,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Yk(e,t),e=e.sibling}function Yk(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Qn(e,t),br(t),r&4){try{_c(3,t,t.return),Ih(3,t)}catch(y){We(t,t.return,y)}try{_c(5,t,t.return)}catch(y){We(t,t.return,y)}}break;case 1:Qn(e,t),br(t),r&512&&n!==null&&Oa(n,n.return);break;case 5:if(Qn(e,t),br(t),r&512&&n!==null&&Oa(n,n.return),t.flags&32){var i=t.stateNode;try{Bc(i,"")}catch(y){We(t,t.return,y)}}if(r&4&&(i=t.stateNode,i!=null)){var o=t.memoizedProps,s=n!==null?n.memoizedProps:o,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&o.type==="radio"&&o.name!=null&&vC(i,o),gg(a,s);var c=gg(a,o);for(s=0;s<l.length;s+=2){var u=l[s],d=l[s+1];u==="style"?CC(i,d):u==="dangerouslySetInnerHTML"?bC(i,d):u==="children"?Bc(i,d):kv(i,u,d,c)}switch(a){case"input":dg(i,o);break;case"textarea":xC(i,o);break;case"select":var h=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!o.multiple;var p=o.value;p!=null?Na(i,!!o.multiple,p,!1):h!==!!o.multiple&&(o.defaultValue!=null?Na(i,!!o.multiple,o.defaultValue,!0):Na(i,!!o.multiple,o.multiple?[]:"",!1))}i[Jc]=o}catch(y){We(t,t.return,y)}}break;case 6:if(Qn(e,t),br(t),r&4){if(t.stateNode===null)throw Error(B(162));i=t.stateNode,o=t.memoizedProps;try{i.nodeValue=o}catch(y){We(t,t.return,y)}}break;case 3:if(Qn(e,t),br(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Hc(e.containerInfo)}catch(y){We(t,t.return,y)}break;case 4:Qn(e,t),br(t);break;case 13:Qn(e,t),br(t),i=t.child,i.flags&8192&&(o=i.memoizedState!==null,i.stateNode.isHidden=o,!o||i.alternate!==null&&i.alternate.memoizedState!==null||(r0=Ye())),r&4&&Hw(t);break;case 22:if(u=n!==null&&n.memoizedState!==null,t.mode&1?(Rt=(c=Rt)||u,Qn(e,t),Rt=c):Qn(e,t),br(t),r&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!u&&t.mode&1)for(G=t,u=t.child;u!==null;){for(d=G=u;G!==null;){switch(h=G,p=h.child,h.tag){case 0:case 11:case 14:case 15:_c(4,h,h.return);break;case 1:Oa(h,h.return);var g=h.stateNode;if(typeof g.componentWillUnmount=="function"){r=h,n=h.return;try{e=r,g.props=e.memoizedProps,g.state=e.memoizedState,g.componentWillUnmount()}catch(y){We(r,n,y)}}break;case 5:Oa(h,h.return);break;case 22:if(h.memoizedState!==null){Kw(d);continue}}p!==null?(p.return=h,G=p):Kw(d)}u=u.sibling}e:for(u=null,d=t;;){if(d.tag===5){if(u===null){u=d;try{i=d.stateNode,c?(o=i.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(a=d.stateNode,l=d.memoizedProps.style,s=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=SC("display",s))}catch(y){We(t,t.return,y)}}}else if(d.tag===6){if(u===null)try{d.stateNode.nodeValue=c?"":d.memoizedProps}catch(y){We(t,t.return,y)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===t)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===t)break e;for(;d.sibling===null;){if(d.return===null||d.return===t)break e;u===d&&(u=null),d=d.return}u===d&&(u=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:Qn(e,t),br(t),r&4&&Hw(t);break;case 21:break;default:Qn(e,t),br(t)}}function br(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(Gk(n)){var r=n;break e}n=n.return}throw Error(B(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(Bc(i,""),r.flags&=-33);var o=Uw(t);Kg(t,o,i);break;case 3:case 4:var s=r.stateNode.containerInfo,a=Uw(t);Wg(t,a,s);break;default:throw Error(B(161))}}catch(l){We(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function kI(t,e,n){G=t,Qk(t)}function Qk(t,e,n){for(var r=(t.mode&1)!==0;G!==null;){var i=G,o=i.child;if(i.tag===22&&r){var s=i.memoizedState!==null||Sd;if(!s){var a=i.alternate,l=a!==null&&a.memoizedState!==null||Rt;a=Sd;var c=Rt;if(Sd=s,(Rt=l)&&!c)for(G=i;G!==null;)s=G,l=s.child,s.tag===22&&s.memoizedState!==null?qw(i):l!==null?(l.return=s,G=l):qw(i);for(;o!==null;)G=o,Qk(o),o=o.sibling;G=i,Sd=a,Rt=c}Ww(t)}else i.subtreeFlags&8772&&o!==null?(o.return=i,G=o):Ww(t)}}function Ww(t){for(;G!==null;){var e=G;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Rt||Ih(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Rt)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:Zn(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=e.updateQueue;o!==null&&Ow(e,o,r);break;case 3:var s=e.updateQueue;if(s!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}Ow(e,s,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var d=u.dehydrated;d!==null&&Hc(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(B(163))}Rt||e.flags&512&&Hg(e)}catch(h){We(e,e.return,h)}}if(e===t){G=null;break}if(n=e.sibling,n!==null){n.return=e.return,G=n;break}G=e.return}}function Kw(t){for(;G!==null;){var e=G;if(e===t){G=null;break}var n=e.sibling;if(n!==null){n.return=e.return,G=n;break}G=e.return}}function qw(t){for(;G!==null;){var e=G;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Ih(4,e)}catch(l){We(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(l){We(e,i,l)}}var o=e.return;try{Hg(e)}catch(l){We(e,o,l)}break;case 5:var s=e.return;try{Hg(e)}catch(l){We(e,s,l)}}}catch(l){We(e,e.return,l)}if(e===t){G=null;break}var a=e.sibling;if(a!==null){a.return=e.return,G=a;break}G=e.return}}var EI=Math.ceil,Bf=gi.ReactCurrentDispatcher,t0=gi.ReactCurrentOwner,Ln=gi.ReactCurrentBatchConfig,be=0,lt=null,Ze=null,xt=0,vn=0,Pa=No(0),it=0,tu=null,Rs=0,Ah=0,n0=0,Rc=null,rn=null,r0=0,hl=1/0,Yr=null,zf=!1,qg=null,mo=null,Cd=!1,oo=null,Vf=0,Oc=0,Gg=null,af=-1,lf=0;function Ht(){return be&6?Ye():af!==-1?af:af=Ye()}function go(t){return t.mode&1?be&2&&xt!==0?xt&-xt:lI.transition!==null?(lf===0&&(lf=jC()),lf):(t=Ee,t!==0||(t=window.event,t=t===void 0?16:VC(t.type)),t):1}function cr(t,e,n,r){if(50<Oc)throw Oc=0,Gg=null,Error(B(185));ju(t,n,r),(!(be&2)||t!==lt)&&(t===lt&&(!(be&2)&&(Ah|=n),it===4&&Ki(t,xt)),un(t,r),n===1&&be===0&&!(e.mode&1)&&(hl=Ye()+500,Oh&&jo()))}function un(t,e){var n=t.callbackNode;l2(t,e);var r=Ef(t,t===lt?xt:0);if(r===0)n!==null&&nw(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&nw(n),e===1)t.tag===0?aI(Gw.bind(null,t)):ak(Gw.bind(null,t)),rI(function(){!(be&6)&&jo()}),n=null;else{switch(DC(r)){case 1:n=Ov;break;case 4:n=AC;break;case 16:n=kf;break;case 536870912:n=NC;break;default:n=kf}n=oE(n,Xk.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function Xk(t,e){if(af=-1,lf=0,be&6)throw Error(B(327));var n=t.callbackNode;if(Fa()&&t.callbackNode!==n)return null;var r=Ef(t,t===lt?xt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Uf(t,r);else{e=r;var i=be;be|=2;var o=eE();(lt!==t||xt!==e)&&(Yr=null,hl=Ye()+500,gs(t,e));do try{RI();break}catch(a){Zk(t,a)}while(1);Vv(),Bf.current=o,be=i,Ze!==null?e=0:(lt=null,xt=0,e=it)}if(e!==0){if(e===2&&(i=bg(t),i!==0&&(r=i,e=Jg(t,i))),e===1)throw n=tu,gs(t,0),Ki(t,r),un(t,Ye()),n;if(e===6)Ki(t,r);else{if(i=t.current.alternate,!(r&30)&&!TI(i)&&(e=Uf(t,r),e===2&&(o=bg(t),o!==0&&(r=o,e=Jg(t,o))),e===1))throw n=tu,gs(t,0),Ki(t,r),un(t,Ye()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(B(345));case 2:Go(t,rn,Yr);break;case 3:if(Ki(t,r),(r&130023424)===r&&(e=r0+500-Ye(),10<e)){if(Ef(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){Ht(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=Og(Go.bind(null,t,rn,Yr),e);break}Go(t,rn,Yr);break;case 4:if(Ki(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var s=31-lr(r);o=1<<s,s=e[s],s>i&&(i=s),r&=~o}if(r=i,r=Ye()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*EI(r/1960))-r,10<r){t.timeoutHandle=Og(Go.bind(null,t,rn,Yr),r);break}Go(t,rn,Yr);break;case 5:Go(t,rn,Yr);break;default:throw Error(B(329))}}}return un(t,Ye()),t.callbackNode===n?Xk.bind(null,t):null}function Jg(t,e){var n=Rc;return t.current.memoizedState.isDehydrated&&(gs(t,e).flags|=256),t=Uf(t,e),t!==2&&(e=rn,rn=n,e!==null&&Yg(e)),t}function Yg(t){rn===null?rn=t:rn.push.apply(rn,t)}function TI(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],o=i.getSnapshot;i=i.value;try{if(!ur(o(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Ki(t,e){for(e&=~n0,e&=~Ah,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-lr(e),r=1<<n;t[n]=-1,e&=~r}}function Gw(t){if(be&6)throw Error(B(327));Fa();var e=Ef(t,0);if(!(e&1))return un(t,Ye()),null;var n=Uf(t,e);if(t.tag!==0&&n===2){var r=bg(t);r!==0&&(e=r,n=Jg(t,r))}if(n===1)throw n=tu,gs(t,0),Ki(t,e),un(t,Ye()),n;if(n===6)throw Error(B(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Go(t,rn,Yr),un(t,Ye()),null}function i0(t,e){var n=be;be|=1;try{return t(e)}finally{be=n,be===0&&(hl=Ye()+500,Oh&&jo())}}function Os(t){oo!==null&&oo.tag===0&&!(be&6)&&Fa();var e=be;be|=1;var n=Ln.transition,r=Ee;try{if(Ln.transition=null,Ee=1,t)return t()}finally{Ee=r,Ln.transition=n,be=e,!(be&6)&&jo()}}function o0(){vn=Pa.current,Le(Pa)}function gs(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,nI(n)),Ze!==null)for(n=Ze.return;n!==null;){var r=n;switch(Fv(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Pf();break;case 3:dl(),Le(ln),Le(Pt),Gv();break;case 5:qv(r);break;case 4:dl();break;case 13:Le(ze);break;case 19:Le(ze);break;case 10:Uv(r.type._context);break;case 22:case 23:o0()}n=n.return}if(lt=t,Ze=t=yo(t.current,null),xt=vn=e,it=0,tu=null,n0=Ah=Rs=0,rn=Rc=null,ns!==null){for(e=0;e<ns.length;e++)if(n=ns[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,o=n.pending;if(o!==null){var s=o.next;o.next=i,r.next=s}n.pending=r}ns=null}return t}function Zk(t,e){do{var n=Ze;try{if(Vv(),rf.current=Ff,$f){for(var r=Ve.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}$f=!1}if(_s=0,st=nt=Ve=null,Tc=!1,Xc=0,t0.current=null,n===null||n.return===null){it=1,tu=e,Ze=null;break}e:{var o=t,s=n.return,a=n,l=e;if(e=xt,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=a,d=u.tag;if(!(u.mode&1)&&(d===0||d===11||d===15)){var h=u.alternate;h?(u.updateQueue=h.updateQueue,u.memoizedState=h.memoizedState,u.lanes=h.lanes):(u.updateQueue=null,u.memoizedState=null)}var p=jw(s);if(p!==null){p.flags&=-257,Dw(p,s,a,o,e),p.mode&1&&Nw(o,c,e),e=p,l=c;var g=e.updateQueue;if(g===null){var y=new Set;y.add(l),e.updateQueue=y}else g.add(l);break e}else{if(!(e&1)){Nw(o,c,e),s0();break e}l=Error(B(426))}}else if(Fe&&a.mode&1){var x=jw(s);if(x!==null){!(x.flags&65536)&&(x.flags|=256),Dw(x,s,a,o,e),Bv(fl(l,a));break e}}o=l=fl(l,a),it!==4&&(it=2),Rc===null?Rc=[o]:Rc.push(o),o=s;do{switch(o.tag){case 3:o.flags|=65536,e&=-e,o.lanes|=e;var v=Dk(o,l,e);Rw(o,v);break e;case 1:a=l;var w=o.type,b=o.stateNode;if(!(o.flags&128)&&(typeof w.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(mo===null||!mo.has(b)))){o.flags|=65536,e&=-e,o.lanes|=e;var S=Lk(o,a,e);Rw(o,S);break e}}o=o.return}while(o!==null)}nE(n)}catch(C){e=C,Ze===n&&n!==null&&(Ze=n=n.return);continue}break}while(1)}function eE(){var t=Bf.current;return Bf.current=Ff,t===null?Ff:t}function s0(){(it===0||it===3||it===2)&&(it=4),lt===null||!(Rs&268435455)&&!(Ah&268435455)||Ki(lt,xt)}function Uf(t,e){var n=be;be|=2;var r=eE();(lt!==t||xt!==e)&&(Yr=null,gs(t,e));do try{_I();break}catch(i){Zk(t,i)}while(1);if(Vv(),be=n,Bf.current=r,Ze!==null)throw Error(B(261));return lt=null,xt=0,it}function _I(){for(;Ze!==null;)tE(Ze)}function RI(){for(;Ze!==null&&!ZM();)tE(Ze)}function tE(t){var e=iE(t.alternate,t,vn);t.memoizedProps=t.pendingProps,e===null?nE(t):Ze=e,t0.current=null}function nE(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=bI(n,e),n!==null){n.flags&=32767,Ze=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{it=6,Ze=null;return}}else if(n=wI(n,e,vn),n!==null){Ze=n;return}if(e=e.sibling,e!==null){Ze=e;return}Ze=e=t}while(e!==null);it===0&&(it=5)}function Go(t,e,n){var r=Ee,i=Ln.transition;try{Ln.transition=null,Ee=1,OI(t,e,n,r)}finally{Ln.transition=i,Ee=r}return null}function OI(t,e,n,r){do Fa();while(oo!==null);if(be&6)throw Error(B(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(B(177));t.callbackNode=null,t.callbackPriority=0;var o=n.lanes|n.childLanes;if(c2(t,o),t===lt&&(Ze=lt=null,xt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Cd||(Cd=!0,oE(kf,function(){return Fa(),null})),o=(n.flags&15990)!==0,n.subtreeFlags&15990||o){o=Ln.transition,Ln.transition=null;var s=Ee;Ee=1;var a=be;be|=4,t0.current=null,CI(t,n),Yk(n,t),J2(_g),Tf=!!Tg,_g=Tg=null,t.current=n,kI(n),e2(),be=a,Ee=s,Ln.transition=o}else t.current=n;if(Cd&&(Cd=!1,oo=t,Vf=i),o=t.pendingLanes,o===0&&(mo=null),r2(n.stateNode),un(t,Ye()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(zf)throw zf=!1,t=qg,qg=null,t;return Vf&1&&t.tag!==0&&Fa(),o=t.pendingLanes,o&1?t===Gg?Oc++:(Oc=0,Gg=t):Oc=0,jo(),null}function Fa(){if(oo!==null){var t=DC(Vf),e=Ln.transition,n=Ee;try{if(Ln.transition=null,Ee=16>t?16:t,oo===null)var r=!1;else{if(t=oo,oo=null,Vf=0,be&6)throw Error(B(331));var i=be;for(be|=4,G=t.current;G!==null;){var o=G,s=o.child;if(G.flags&16){var a=o.deletions;if(a!==null){for(var l=0;l<a.length;l++){var c=a[l];for(G=c;G!==null;){var u=G;switch(u.tag){case 0:case 11:case 15:_c(8,u,o)}var d=u.child;if(d!==null)d.return=u,G=d;else for(;G!==null;){u=G;var h=u.sibling,p=u.return;if(qk(u),u===c){G=null;break}if(h!==null){h.return=p,G=h;break}G=p}}}var g=o.alternate;if(g!==null){var y=g.child;if(y!==null){g.child=null;do{var x=y.sibling;y.sibling=null,y=x}while(y!==null)}}G=o}}if(o.subtreeFlags&2064&&s!==null)s.return=o,G=s;else e:for(;G!==null;){if(o=G,o.flags&2048)switch(o.tag){case 0:case 11:case 15:_c(9,o,o.return)}var v=o.sibling;if(v!==null){v.return=o.return,G=v;break e}G=o.return}}var w=t.current;for(G=w;G!==null;){s=G;var b=s.child;if(s.subtreeFlags&2064&&b!==null)b.return=s,G=b;else e:for(s=w;G!==null;){if(a=G,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Ih(9,a)}}catch(C){We(a,a.return,C)}if(a===s){G=null;break e}var S=a.sibling;if(S!==null){S.return=a.return,G=S;break e}G=a.return}}if(be=i,jo(),Nr&&typeof Nr.onPostCommitFiberRoot=="function")try{Nr.onPostCommitFiberRoot(kh,t)}catch{}r=!0}return r}finally{Ee=n,Ln.transition=e}}return!1}function Jw(t,e,n){e=fl(n,e),e=Dk(t,e,1),t=po(t,e,1),e=Ht(),t!==null&&(ju(t,1,e),un(t,e))}function We(t,e,n){if(t.tag===3)Jw(t,t,n);else for(;e!==null;){if(e.tag===3){Jw(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(mo===null||!mo.has(r))){t=fl(n,t),t=Lk(e,t,1),e=po(e,t,1),t=Ht(),e!==null&&(ju(e,1,t),un(e,t));break}}e=e.return}}function PI(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Ht(),t.pingedLanes|=t.suspendedLanes&n,lt===t&&(xt&n)===n&&(it===4||it===3&&(xt&130023424)===xt&&500>Ye()-r0?gs(t,0):n0|=n),un(t,e)}function rE(t,e){e===0&&(t.mode&1?(e=hd,hd<<=1,!(hd&130023424)&&(hd=4194304)):e=1);var n=Ht();t=di(t,e),t!==null&&(ju(t,e,n),un(t,n))}function MI(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),rE(t,n)}function II(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(B(314))}r!==null&&r.delete(e),rE(t,n)}var iE;iE=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||ln.current)sn=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return sn=!1,xI(t,e,n);sn=!!(t.flags&131072)}else sn=!1,Fe&&e.flags&1048576&&lk(e,Af,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;sf(t,e),t=e.pendingProps;var i=ll(e,Pt.current);$a(e,n),i=Yv(null,e,r,t,i,n);var o=Qv();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,cn(r)?(o=!0,Mf(e)):o=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Wv(e),i.updater=Mh,e.stateNode=i,i._reactInternals=e,Dg(e,r,t,n),e=Fg(null,e,r,!0,o,n)):(e.tag=0,Fe&&o&&$v(e),Vt(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(sf(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=NI(r),t=Zn(r,t),i){case 0:e=$g(null,e,r,t,n);break e;case 1:e=Fw(null,e,r,t,n);break e;case 11:e=Lw(null,e,r,t,n);break e;case 14:e=$w(null,e,r,Zn(r.type,t),n);break e}throw Error(B(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Zn(r,i),$g(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Zn(r,i),Fw(t,e,r,i,n);case 3:e:{if(zk(e),t===null)throw Error(B(387));r=e.pendingProps,o=e.memoizedState,i=o.element,pk(t,e),Df(e,r,null,n);var s=e.memoizedState;if(r=s.element,o.isDehydrated)if(o={element:r,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},e.updateQueue.baseState=o,e.memoizedState=o,e.flags&256){i=fl(Error(B(423)),e),e=Bw(t,e,r,n,i);break e}else if(r!==i){i=fl(Error(B(424)),e),e=Bw(t,e,r,n,i);break e}else for(bn=ho(e.stateNode.containerInfo.firstChild),Sn=e,Fe=!0,ir=null,n=fk(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(cl(),r===i){e=fi(t,e,n);break e}Vt(t,e,r,n)}e=e.child}return e;case 5:return mk(e),t===null&&Ag(e),r=e.type,i=e.pendingProps,o=t!==null?t.memoizedProps:null,s=i.children,Rg(r,i)?s=null:o!==null&&Rg(r,o)&&(e.flags|=32),Bk(t,e),Vt(t,e,s,n),e.child;case 6:return t===null&&Ag(e),null;case 13:return Vk(t,e,n);case 4:return Kv(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=ul(e,null,r,n):Vt(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Zn(r,i),Lw(t,e,r,i,n);case 7:return Vt(t,e,e.pendingProps,n),e.child;case 8:return Vt(t,e,e.pendingProps.children,n),e.child;case 12:return Vt(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,o=e.memoizedProps,s=i.value,Ae(Nf,r._currentValue),r._currentValue=s,o!==null)if(ur(o.value,s)){if(o.children===i.children&&!ln.current){e=fi(t,e,n);break e}}else for(o=e.child,o!==null&&(o.return=e);o!==null;){var a=o.dependencies;if(a!==null){s=o.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(o.tag===1){l=si(-1,n&-n),l.tag=2;var c=o.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),Ng(o.return,n,e),a.lanes|=n;break}l=l.next}}else if(o.tag===10)s=o.type===e.type?null:o.child;else if(o.tag===18){if(s=o.return,s===null)throw Error(B(341));s.lanes|=n,a=s.alternate,a!==null&&(a.lanes|=n),Ng(s,n,e),s=o.sibling}else s=o.child;if(s!==null)s.return=o;else for(s=o;s!==null;){if(s===e){s=null;break}if(o=s.sibling,o!==null){o.return=s.return,s=o;break}s=s.return}o=s}Vt(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,$a(e,n),i=Un(i),r=r(i),e.flags|=1,Vt(t,e,r,n),e.child;case 14:return r=e.type,i=Zn(r,e.pendingProps),i=Zn(r.type,i),$w(t,e,r,i,n);case 15:return $k(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Zn(r,i),sf(t,e),e.tag=1,cn(r)?(t=!0,Mf(e)):t=!1,$a(e,n),jk(e,r,i),Dg(e,r,i,n),Fg(null,e,r,!0,t,n);case 19:return Uk(t,e,n);case 22:return Fk(t,e,n)}throw Error(B(156,e.tag))};function oE(t,e){return IC(t,e)}function AI(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Dn(t,e,n,r){return new AI(t,e,n,r)}function a0(t){return t=t.prototype,!(!t||!t.isReactComponent)}function NI(t){if(typeof t=="function")return a0(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Tv)return 11;if(t===_v)return 14}return 2}function yo(t,e){var n=t.alternate;return n===null?(n=Dn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function cf(t,e,n,r,i,o){var s=2;if(r=t,typeof t=="function")a0(t)&&(s=1);else if(typeof t=="string")s=5;else e:switch(t){case wa:return ys(n.children,i,o,e);case Ev:s=8,i|=8;break;case sg:return t=Dn(12,n,e,i|2),t.elementType=sg,t.lanes=o,t;case ag:return t=Dn(13,n,e,i),t.elementType=ag,t.lanes=o,t;case lg:return t=Dn(19,n,e,i),t.elementType=lg,t.lanes=o,t;case mC:return Nh(n,i,o,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case hC:s=10;break e;case pC:s=9;break e;case Tv:s=11;break e;case _v:s=14;break e;case Pi:s=16,r=null;break e}throw Error(B(130,t==null?t:typeof t,""))}return e=Dn(s,n,e,i),e.elementType=t,e.type=r,e.lanes=o,e}function ys(t,e,n,r){return t=Dn(7,t,r,e),t.lanes=n,t}function Nh(t,e,n,r){return t=Dn(22,t,r,e),t.elementType=mC,t.lanes=n,t.stateNode={isHidden:!1},t}function om(t,e,n){return t=Dn(6,t,null,e),t.lanes=n,t}function sm(t,e,n){return e=Dn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function jI(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Bp(0),this.expirationTimes=Bp(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Bp(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function l0(t,e,n,r,i,o,s,a,l){return t=new jI(t,e,n,a,l),e===1?(e=1,o===!0&&(e|=8)):e=0,o=Dn(3,null,null,e),t.current=o,o.stateNode=t,o.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Wv(o),t}function DI(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:xa,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function sE(t){if(!t)return Eo;t=t._reactInternals;e:{if(qs(t)!==t||t.tag!==1)throw Error(B(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(cn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(B(171))}if(t.tag===1){var n=t.type;if(cn(n))return sk(t,n,e)}return e}function aE(t,e,n,r,i,o,s,a,l){return t=l0(n,r,!0,t,i,o,s,a,l),t.context=sE(null),n=t.current,r=Ht(),i=go(n),o=si(r,i),o.callback=e??null,po(n,o,i),t.current.lanes=i,ju(t,i,r),un(t,r),t}function jh(t,e,n,r){var i=e.current,o=Ht(),s=go(i);return n=sE(n),e.context===null?e.context=n:e.pendingContext=n,e=si(o,s),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=po(i,e,s),t!==null&&(cr(t,i,s,o),nf(t,i,s)),s}function Hf(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Yw(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function c0(t,e){Yw(t,e),(t=t.alternate)&&Yw(t,e)}function LI(){return null}var lE=typeof reportError=="function"?reportError:function(t){console.error(t)};function u0(t){this._internalRoot=t}Dh.prototype.render=u0.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(B(409));jh(t,e,null,null)};Dh.prototype.unmount=u0.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Os(function(){jh(null,t,null,null)}),e[ui]=null}};function Dh(t){this._internalRoot=t}Dh.prototype.unstable_scheduleHydration=function(t){if(t){var e=FC();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Wi.length&&e!==0&&e<Wi[n].priority;n++);Wi.splice(n,0,t),n===0&&zC(t)}};function d0(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Lh(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Qw(){}function $I(t,e,n,r,i){if(i){if(typeof r=="function"){var o=r;r=function(){var c=Hf(s);o.call(c)}}var s=aE(e,r,t,0,null,!1,!1,"",Qw);return t._reactRootContainer=s,t[ui]=s.current,qc(t.nodeType===8?t.parentNode:t),Os(),s}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var c=Hf(l);a.call(c)}}var l=l0(t,0,!1,null,null,!1,!1,"",Qw);return t._reactRootContainer=l,t[ui]=l.current,qc(t.nodeType===8?t.parentNode:t),Os(function(){jh(e,l,n,r)}),l}function $h(t,e,n,r,i){var o=n._reactRootContainer;if(o){var s=o;if(typeof i=="function"){var a=i;i=function(){var l=Hf(s);a.call(l)}}jh(e,s,t,i)}else s=$I(n,e,t,i,r);return Hf(s)}LC=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=fc(e.pendingLanes);n!==0&&(Pv(e,n|1),un(e,Ye()),!(be&6)&&(hl=Ye()+500,jo()))}break;case 13:Os(function(){var r=di(t,1);if(r!==null){var i=Ht();cr(r,t,1,i)}}),c0(t,1)}};Mv=function(t){if(t.tag===13){var e=di(t,134217728);if(e!==null){var n=Ht();cr(e,t,134217728,n)}c0(t,134217728)}};$C=function(t){if(t.tag===13){var e=go(t),n=di(t,e);if(n!==null){var r=Ht();cr(n,t,e,r)}c0(t,e)}};FC=function(){return Ee};BC=function(t,e){var n=Ee;try{return Ee=t,e()}finally{Ee=n}};vg=function(t,e,n){switch(e){case"input":if(dg(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=Rh(r);if(!i)throw Error(B(90));yC(r),dg(r,i)}}}break;case"textarea":xC(t,n);break;case"select":e=n.value,e!=null&&Na(t,!!n.multiple,e,!1)}};TC=i0;_C=Os;var FI={usingClientEntryPoint:!1,Events:[Lu,ka,Rh,kC,EC,i0]},ic={findFiberByHostInstance:ts,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},BI={bundleType:ic.bundleType,version:ic.version,rendererPackageName:ic.rendererPackageName,rendererConfig:ic.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:gi.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=PC(t),t===null?null:t.stateNode},findFiberByHostInstance:ic.findFiberByHostInstance||LI,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var kd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!kd.isDisabled&&kd.supportsFiber)try{kh=kd.inject(BI),Nr=kd}catch{}}Tn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=FI;Tn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d0(e))throw Error(B(200));return DI(t,e,null,n)};Tn.createRoot=function(t,e){if(!d0(t))throw Error(B(299));var n=!1,r="",i=lE;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=l0(t,1,!1,null,null,n,!1,r,i),t[ui]=e.current,qc(t.nodeType===8?t.parentNode:t),new u0(e)};Tn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(B(188)):(t=Object.keys(t).join(","),Error(B(268,t)));return t=PC(e),t=t===null?null:t.stateNode,t};Tn.flushSync=function(t){return Os(t)};Tn.hydrate=function(t,e,n){if(!Lh(e))throw Error(B(200));return $h(null,t,e,!0,n)};Tn.hydrateRoot=function(t,e,n){if(!d0(t))throw Error(B(405));var r=n!=null&&n.hydratedSources||null,i=!1,o="",s=lE;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onRecoverableError!==void 0&&(s=n.onRecoverableError)),e=aE(e,null,t,1,n??null,i,!1,o,s),t[ui]=e.current,qc(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new Dh(e)};Tn.render=function(t,e,n){if(!Lh(e))throw Error(B(200));return $h(null,t,e,!1,n)};Tn.unmountComponentAtNode=function(t){if(!Lh(t))throw Error(B(40));return t._reactRootContainer?(Os(function(){$h(null,null,t,!1,function(){t._reactRootContainer=null,t[ui]=null})}),!0):!1};Tn.unstable_batchedUpdates=i0;Tn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Lh(n))throw Error(B(200));if(t==null||t._reactInternals===void 0)throw Error(B(38));return $h(t,e,n,!1,r)};Tn.version="18.3.1-next-f1338f8080-20240426";function cE(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(cE)}catch(t){console.error(t)}}cE(),cC.exports=Tn;var Gs=cC.exports;const uE=QS(Gs);var Xw=Gs;ig.createRoot=Xw.createRoot,ig.hydrateRoot=Xw.hydrateRoot;const zI="modulepreload",VI=function(t){return"/"+t},Zw={},Ps=function(e,n,r){if(!n||n.length===0)return e();const i=document.getElementsByTagName("link");return Promise.all(n.map(o=>{if(o=VI(o),o in Zw)return;Zw[o]=!0;const s=o.endsWith(".css"),a=s?'[rel="stylesheet"]':"";if(!!r)for(let u=i.length-1;u>=0;u--){const d=i[u];if(d.href===o&&(!s||d.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${o}"]${a}`))return;const c=document.createElement("link");if(c.rel=s?"stylesheet":zI,s||(c.as="script",c.crossOrigin=""),c.href=o,document.head.appendChild(c),s)return new Promise((u,d)=>{c.addEventListener("load",u),c.addEventListener("error",()=>d(new Error(`Unable to preload CSS for ${o}`)))})})).then(()=>e()).catch(o=>{const s=new Event("vite:preloadError",{cancelable:!0});if(s.payload=o,window.dispatchEvent(s),!s.defaultPrevented)throw o})};var f0={};Object.defineProperty(f0,"__esModule",{value:!0});f0.parse=JI;f0.serialize=YI;const UI=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,HI=/^[\u0021-\u003A\u003C-\u007E]*$/,WI=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,KI=/^[\u0020-\u003A\u003D-\u007E]*$/,qI=Object.prototype.toString,GI=(()=>{const t=function(){};return t.prototype=Object.create(null),t})();function JI(t,e){const n=new GI,r=t.length;if(r<2)return n;const i=(e==null?void 0:e.decode)||QI;let o=0;do{const s=t.indexOf("=",o);if(s===-1)break;const a=t.indexOf(";",o),l=a===-1?r:a;if(s>l){o=t.lastIndexOf(";",s-1)+1;continue}const c=eb(t,o,s),u=tb(t,s,c),d=t.slice(c,u);if(n[d]===void 0){let h=eb(t,s+1,l),p=tb(t,l,h);const g=i(t.slice(h,p));n[d]=g}o=l+1}while(o<r);return n}function eb(t,e,n){do{const r=t.charCodeAt(e);if(r!==32&&r!==9)return e}while(++e<n);return n}function tb(t,e,n){for(;e>n;){const r=t.charCodeAt(--e);if(r!==32&&r!==9)return e+1}return n}function YI(t,e,n){const r=(n==null?void 0:n.encode)||encodeURIComponent;if(!UI.test(t))throw new TypeError(`argument name is invalid: ${t}`);const i=r(e);if(!HI.test(i))throw new TypeError(`argument val is invalid: ${e}`);let o=t+"="+i;if(!n)return o;if(n.maxAge!==void 0){if(!Number.isInteger(n.maxAge))throw new TypeError(`option maxAge is invalid: ${n.maxAge}`);o+="; Max-Age="+n.maxAge}if(n.domain){if(!WI.test(n.domain))throw new TypeError(`option domain is invalid: ${n.domain}`);o+="; Domain="+n.domain}if(n.path){if(!KI.test(n.path))throw new TypeError(`option path is invalid: ${n.path}`);o+="; Path="+n.path}if(n.expires){if(!XI(n.expires)||!Number.isFinite(n.expires.valueOf()))throw new TypeError(`option expires is invalid: ${n.expires}`);o+="; Expires="+n.expires.toUTCString()}if(n.httpOnly&&(o+="; HttpOnly"),n.secure&&(o+="; Secure"),n.partitioned&&(o+="; Partitioned"),n.priority)switch(typeof n.priority=="string"?n.priority.toLowerCase():void 0){case"low":o+="; Priority=Low";break;case"medium":o+="; Priority=Medium";break;case"high":o+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${n.priority}`)}if(n.sameSite)switch(typeof n.sameSite=="string"?n.sameSite.toLowerCase():n.sameSite){case!0:case"strict":o+="; SameSite=Strict";break;case"lax":o+="; SameSite=Lax";break;case"none":o+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${n.sameSite}`)}return o}function QI(t){if(t.indexOf("%")===-1)return t;try{return decodeURIComponent(t)}catch{return t}}function XI(t){return qI.call(t)==="[object Date]"}var nb="popstate";function ZI(t={}){function e(r,i){let{pathname:o,search:s,hash:a}=r.location;return Qg("",{pathname:o,search:s,hash:a},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function n(r,i){return typeof i=="string"?i:nu(i)}return tA(e,n,null,t)}function Be(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Wn(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function eA(){return Math.random().toString(36).substring(2,10)}function rb(t,e){return{usr:t.state,key:t.key,idx:e}}function Qg(t,e,n=null,r){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?Dl(e):e,state:n,key:e&&e.key||r||eA()}}function nu({pathname:t="/",search:e="",hash:n=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function Dl(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substring(n),t=t.substring(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substring(r),t=t.substring(0,r)),t&&(e.pathname=t)}return e}function tA(t,e,n,r={}){let{window:i=document.defaultView,v5Compat:o=!1}=r,s=i.history,a="POP",l=null,c=u();c==null&&(c=0,s.replaceState({...s.state,idx:c},""));function u(){return(s.state||{idx:null}).idx}function d(){a="POP";let x=u(),v=x==null?null:x-c;c=x,l&&l({action:a,location:y.location,delta:v})}function h(x,v){a="PUSH";let w=Qg(y.location,x,v);n&&n(w,x),c=u()+1;let b=rb(w,c),S=y.createHref(w);try{s.pushState(b,"",S)}catch(C){if(C instanceof DOMException&&C.name==="DataCloneError")throw C;i.location.assign(S)}o&&l&&l({action:a,location:y.location,delta:1})}function p(x,v){a="REPLACE";let w=Qg(y.location,x,v);n&&n(w,x),c=u();let b=rb(w,c),S=y.createHref(w);s.replaceState(b,"",S),o&&l&&l({action:a,location:y.location,delta:0})}function g(x){let v=i.location.origin!=="null"?i.location.origin:i.location.href,w=typeof x=="string"?x:nu(x);return w=w.replace(/ $/,"%20"),Be(v,`No window.location.(origin|href) available to create URL for href: ${w}`),new URL(w,v)}let y={get action(){return a},get location(){return t(i,s)},listen(x){if(l)throw new Error("A history only accepts one active listener");return i.addEventListener(nb,d),l=x,()=>{i.removeEventListener(nb,d),l=null}},createHref(x){return e(i,x)},createURL:g,encodeLocation(x){let v=g(x);return{pathname:v.pathname,search:v.search,hash:v.hash}},push:h,replace:p,go(x){return s.go(x)}};return y}function dE(t,e,n="/"){return nA(t,e,n,!1)}function nA(t,e,n,r){let i=typeof e=="string"?Dl(e):e,o=To(i.pathname||"/",n);if(o==null)return null;let s=fE(t);rA(s);let a=null;for(let l=0;a==null&&l<s.length;++l){let c=pA(o);a=fA(s[l],c,r)}return a}function fE(t,e=[],n=[],r=""){let i=(o,s,a)=>{let l={relativePath:a===void 0?o.path||"":a,caseSensitive:o.caseSensitive===!0,childrenIndex:s,route:o};l.relativePath.startsWith("/")&&(Be(l.relativePath.startsWith(r),`Absolute route path "${l.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),l.relativePath=l.relativePath.slice(r.length));let c=ai([r,l.relativePath]),u=n.concat(l);o.children&&o.children.length>0&&(Be(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${c}".`),fE(o.children,e,u,c)),!(o.path==null&&!o.index)&&e.push({path:c,score:uA(c,o.index),routesMeta:u})};return t.forEach((o,s)=>{var a;if(o.path===""||!((a=o.path)!=null&&a.includes("?")))i(o,s);else for(let l of hE(o.path))i(o,s,l)}),e}function hE(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,i=n.endsWith("?"),o=n.replace(/\?$/,"");if(r.length===0)return i?[o,""]:[o];let s=hE(r.join("/")),a=[];return a.push(...s.map(l=>l===""?o:[o,l].join("/"))),i&&a.push(...s),a.map(l=>t.startsWith("/")&&l===""?"/":l)}function rA(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:dA(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}var iA=/^:[\w-]+$/,oA=3,sA=2,aA=1,lA=10,cA=-2,ib=t=>t==="*";function uA(t,e){let n=t.split("/"),r=n.length;return n.some(ib)&&(r+=cA),e&&(r+=sA),n.filter(i=>!ib(i)).reduce((i,o)=>i+(iA.test(o)?oA:o===""?aA:lA),r)}function dA(t,e){return t.length===e.length&&t.slice(0,-1).every((r,i)=>r===e[i])?t[t.length-1]-e[e.length-1]:0}function fA(t,e,n=!1){let{routesMeta:r}=t,i={},o="/",s=[];for(let a=0;a<r.length;++a){let l=r[a],c=a===r.length-1,u=o==="/"?e:e.slice(o.length)||"/",d=Wf({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},u),h=l.route;if(!d&&c&&n&&!r[r.length-1].route.index&&(d=Wf({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},u)),!d)return null;Object.assign(i,d.params),s.push({params:i,pathname:ai([o,d.pathname]),pathnameBase:vA(ai([o,d.pathnameBase])),route:h}),d.pathnameBase!=="/"&&(o=ai([o,d.pathnameBase]))}return s}function Wf(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=hA(t.path,t.caseSensitive,t.end),i=e.match(n);if(!i)return null;let o=i[0],s=o.replace(/(.)\/+$/,"$1"),a=i.slice(1);return{params:r.reduce((c,{paramName:u,isOptional:d},h)=>{if(u==="*"){let g=a[h]||"";s=o.slice(0,o.length-g.length).replace(/(.)\/+$/,"$1")}const p=a[h];return d&&!p?c[u]=void 0:c[u]=(p||"").replace(/%2F/g,"/"),c},{}),pathname:o,pathnameBase:s,pattern:t}}function hA(t,e=!1,n=!0){Wn(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let r=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(s,a,l)=>(r.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),r]}function pA(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Wn(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function To(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function mA(t,e="/"){let{pathname:n,search:r="",hash:i=""}=typeof t=="string"?Dl(t):t;return{pathname:n?n.startsWith("/")?n:gA(n,e):e,search:xA(r),hash:wA(i)}}function gA(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?n.length>1&&n.pop():i!=="."&&n.push(i)}),n.length>1?n.join("/"):"/"}function am(t,e,n,r){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function yA(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function h0(t){let e=yA(t);return e.map((n,r)=>r===e.length-1?n.pathname:n.pathnameBase)}function p0(t,e,n,r=!1){let i;typeof t=="string"?i=Dl(t):(i={...t},Be(!i.pathname||!i.pathname.includes("?"),am("?","pathname","search",i)),Be(!i.pathname||!i.pathname.includes("#"),am("#","pathname","hash",i)),Be(!i.search||!i.search.includes("#"),am("#","search","hash",i)));let o=t===""||i.pathname==="",s=o?"/":i.pathname,a;if(s==null)a=n;else{let d=e.length-1;if(!r&&s.startsWith("..")){let h=s.split("/");for(;h[0]==="..";)h.shift(),d-=1;i.pathname=h.join("/")}a=d>=0?e[d]:"/"}let l=mA(i,a),c=s&&s!=="/"&&s.endsWith("/"),u=(o||s===".")&&n.endsWith("/");return!l.pathname.endsWith("/")&&(c||u)&&(l.pathname+="/"),l}var ai=t=>t.join("/").replace(/\/\/+/g,"/"),vA=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),xA=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,wA=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function bA(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}var pE=["POST","PUT","PATCH","DELETE"];new Set(pE);var SA=["GET",...pE];new Set(SA);var Ll=m.createContext(null);Ll.displayName="DataRouter";var Fh=m.createContext(null);Fh.displayName="DataRouterState";var mE=m.createContext({isTransitioning:!1});mE.displayName="ViewTransition";var CA=m.createContext(new Map);CA.displayName="Fetchers";var kA=m.createContext(null);kA.displayName="Await";var pr=m.createContext(null);pr.displayName="Navigation";var Fu=m.createContext(null);Fu.displayName="Location";var mr=m.createContext({outlet:null,matches:[],isDataRoute:!1});mr.displayName="Route";var m0=m.createContext(null);m0.displayName="RouteError";function EA(t,{relative:e}={}){Be($l(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:r}=m.useContext(pr),{hash:i,pathname:o,search:s}=Bu(t,{relative:e}),a=o;return n!=="/"&&(a=o==="/"?n:ai([n,o])),r.createHref({pathname:a,search:s,hash:i})}function $l(){return m.useContext(Fu)!=null}function Gn(){return Be($l(),"useLocation() may be used only in the context of a <Router> component."),m.useContext(Fu).location}var gE="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function yE(t){m.useContext(pr).static||m.useLayoutEffect(t)}function gr(){let{isDataRoute:t}=m.useContext(mr);return t?FA():TA()}function TA(){Be($l(),"useNavigate() may be used only in the context of a <Router> component.");let t=m.useContext(Ll),{basename:e,navigator:n}=m.useContext(pr),{matches:r}=m.useContext(mr),{pathname:i}=Gn(),o=JSON.stringify(h0(r)),s=m.useRef(!1);return yE(()=>{s.current=!0}),m.useCallback((l,c={})=>{if(Wn(s.current,gE),!s.current)return;if(typeof l=="number"){n.go(l);return}let u=p0(l,JSON.parse(o),i,c.relative==="path");t==null&&e!=="/"&&(u.pathname=u.pathname==="/"?e:ai([e,u.pathname])),(c.replace?n.replace:n.push)(u,c.state,c)},[e,n,o,i,t])}m.createContext(null);function _A(){let{matches:t}=m.useContext(mr),e=t[t.length-1];return e?e.params:{}}function Bu(t,{relative:e}={}){let{matches:n}=m.useContext(mr),{pathname:r}=Gn(),i=JSON.stringify(h0(n));return m.useMemo(()=>p0(t,JSON.parse(i),r,e==="path"),[t,i,r,e])}function RA(t,e){return vE(t,e)}function vE(t,e,n,r){var w;Be($l(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:i,static:o}=m.useContext(pr),{matches:s}=m.useContext(mr),a=s[s.length-1],l=a?a.params:{},c=a?a.pathname:"/",u=a?a.pathnameBase:"/",d=a&&a.route;{let b=d&&d.path||"";xE(c,!d||b.endsWith("*")||b.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${c}" (under <Route path="${b}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${b}"> to <Route path="${b==="/"?"*":`${b}/*`}">.`)}let h=Gn(),p;if(e){let b=typeof e=="string"?Dl(e):e;Be(u==="/"||((w=b.pathname)==null?void 0:w.startsWith(u)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${u}" but pathname "${b.pathname}" was given in the \`location\` prop.`),p=b}else p=h;let g=p.pathname||"/",y=g;if(u!=="/"){let b=u.replace(/^\//,"").split("/");y="/"+g.replace(/^\//,"").split("/").slice(b.length).join("/")}let x=!o&&n&&n.matches&&n.matches.length>0?n.matches:dE(t,{pathname:y});Wn(d||x!=null,`No routes matched location "${p.pathname}${p.search}${p.hash}" `),Wn(x==null||x[x.length-1].route.element!==void 0||x[x.length-1].route.Component!==void 0||x[x.length-1].route.lazy!==void 0,`Matched leaf route at location "${p.pathname}${p.search}${p.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let v=AA(x&&x.map(b=>Object.assign({},b,{params:Object.assign({},l,b.params),pathname:ai([u,i.encodeLocation?i.encodeLocation(b.pathname).pathname:b.pathname]),pathnameBase:b.pathnameBase==="/"?u:ai([u,i.encodeLocation?i.encodeLocation(b.pathnameBase).pathname:b.pathnameBase])})),s,n,r);return e&&v?m.createElement(Fu.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...p},navigationType:"POP"}},v):v}function OA(){let t=$A(),e=bA(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,r="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:r},o={padding:"2px 4px",backgroundColor:r},s=null;return console.error("Error handled by React Router default ErrorBoundary:",t),s=m.createElement(m.Fragment,null,m.createElement("p",null," Hey developer "),m.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",m.createElement("code",{style:o},"ErrorBoundary")," or"," ",m.createElement("code",{style:o},"errorElement")," prop on your route.")),m.createElement(m.Fragment,null,m.createElement("h2",null,"Unexpected Application Error!"),m.createElement("h3",{style:{fontStyle:"italic"}},e),n?m.createElement("pre",{style:i},n):null,s)}var PA=m.createElement(OA,null),MA=class extends m.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){console.error("React Router caught the following error during render",t,e)}render(){return this.state.error!==void 0?m.createElement(mr.Provider,{value:this.props.routeContext},m.createElement(m0.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function IA({routeContext:t,match:e,children:n}){let r=m.useContext(Ll);return r&&r.static&&r.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=e.route.id),m.createElement(mr.Provider,{value:t},n)}function AA(t,e=[],n=null,r=null){if(t==null){if(!n)return null;if(n.errors)t=n.matches;else if(e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let i=t,o=n==null?void 0:n.errors;if(o!=null){let l=i.findIndex(c=>c.route.id&&(o==null?void 0:o[c.route.id])!==void 0);Be(l>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),i=i.slice(0,Math.min(i.length,l+1))}let s=!1,a=-1;if(n)for(let l=0;l<i.length;l++){let c=i[l];if((c.route.HydrateFallback||c.route.hydrateFallbackElement)&&(a=l),c.route.id){let{loaderData:u,errors:d}=n,h=c.route.loader&&!u.hasOwnProperty(c.route.id)&&(!d||d[c.route.id]===void 0);if(c.route.lazy||h){s=!0,a>=0?i=i.slice(0,a+1):i=[i[0]];break}}}return i.reduceRight((l,c,u)=>{let d,h=!1,p=null,g=null;n&&(d=o&&c.route.id?o[c.route.id]:void 0,p=c.route.errorElement||PA,s&&(a<0&&u===0?(xE("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),h=!0,g=null):a===u&&(h=!0,g=c.route.hydrateFallbackElement||null)));let y=e.concat(i.slice(0,u+1)),x=()=>{let v;return d?v=p:h?v=g:c.route.Component?v=m.createElement(c.route.Component,null):c.route.element?v=c.route.element:v=l,m.createElement(IA,{match:c,routeContext:{outlet:l,matches:y,isDataRoute:n!=null},children:v})};return n&&(c.route.ErrorBoundary||c.route.errorElement||u===0)?m.createElement(MA,{location:n.location,revalidation:n.revalidation,component:p,error:d,children:x(),routeContext:{outlet:null,matches:y,isDataRoute:!0}}):x()},null)}function g0(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function NA(t){let e=m.useContext(Ll);return Be(e,g0(t)),e}function jA(t){let e=m.useContext(Fh);return Be(e,g0(t)),e}function DA(t){let e=m.useContext(mr);return Be(e,g0(t)),e}function y0(t){let e=DA(t),n=e.matches[e.matches.length-1];return Be(n.route.id,`${t} can only be used on routes that contain a unique "id"`),n.route.id}function LA(){return y0("useRouteId")}function $A(){var r;let t=m.useContext(m0),e=jA("useRouteError"),n=y0("useRouteError");return t!==void 0?t:(r=e.errors)==null?void 0:r[n]}function FA(){let{router:t}=NA("useNavigate"),e=y0("useNavigate"),n=m.useRef(!1);return yE(()=>{n.current=!0}),m.useCallback(async(i,o={})=>{Wn(n.current,gE),n.current&&(typeof i=="number"?t.navigate(i):await t.navigate(i,{fromRouteId:e,...o}))},[t,e])}var ob={};function xE(t,e,n){!e&&!ob[t]&&(ob[t]=!0,Wn(!1,n))}m.memo(BA);function BA({routes:t,future:e,state:n}){return vE(t,void 0,n,e)}function Kf({to:t,replace:e,state:n,relative:r}){Be($l(),"<Navigate> may be used only in the context of a <Router> component.");let{static:i}=m.useContext(pr);Wn(!i,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:o}=m.useContext(mr),{pathname:s}=Gn(),a=gr(),l=p0(t,h0(o),s,r==="path"),c=JSON.stringify(l);return m.useEffect(()=>{a(JSON.parse(c),{replace:e,state:n,relative:r})},[a,c,r,e,n]),null}function mn(t){Be(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function zA({basename:t="/",children:e=null,location:n,navigationType:r="POP",navigator:i,static:o=!1}){Be(!$l(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let s=t.replace(/^\/*/,"/"),a=m.useMemo(()=>({basename:s,navigator:i,static:o,future:{}}),[s,i,o]);typeof n=="string"&&(n=Dl(n));let{pathname:l="/",search:c="",hash:u="",state:d=null,key:h="default"}=n,p=m.useMemo(()=>{let g=To(l,s);return g==null?null:{location:{pathname:g,search:c,hash:u,state:d,key:h},navigationType:r}},[s,l,c,u,d,h,r]);return Wn(p!=null,`<Router basename="${s}"> is not able to match the URL "${l}${c}${u}" because it does not start with the basename, so the <Router> won't render anything.`),p==null?null:m.createElement(pr.Provider,{value:a},m.createElement(Fu.Provider,{children:e,value:p}))}function VA({children:t,location:e}){return RA(Xg(t),e)}function Xg(t,e=[]){let n=[];return m.Children.forEach(t,(r,i)=>{if(!m.isValidElement(r))return;let o=[...e,i];if(r.type===m.Fragment){n.push.apply(n,Xg(r.props.children,o));return}Be(r.type===mn,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Be(!r.props.index||!r.props.children,"An index route cannot have child routes.");let s={id:r.props.id||o.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(s.children=Xg(r.props.children,o)),n.push(s)}),n}var uf="get",df="application/x-www-form-urlencoded";function Bh(t){return t!=null&&typeof t.tagName=="string"}function UA(t){return Bh(t)&&t.tagName.toLowerCase()==="button"}function HA(t){return Bh(t)&&t.tagName.toLowerCase()==="form"}function WA(t){return Bh(t)&&t.tagName.toLowerCase()==="input"}function KA(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function qA(t,e){return t.button===0&&(!e||e==="_self")&&!KA(t)}function Zg(t=""){return new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,n)=>{let r=t[n];return e.concat(Array.isArray(r)?r.map(i=>[n,i]):[[n,r]])},[]))}function GA(t,e){let n=Zg(t);return e&&e.forEach((r,i)=>{n.has(i)||e.getAll(i).forEach(o=>{n.append(i,o)})}),n}var Ed=null;function JA(){if(Ed===null)try{new FormData(document.createElement("form"),0),Ed=!1}catch{Ed=!0}return Ed}var YA=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function lm(t){return t!=null&&!YA.has(t)?(Wn(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${df}"`),null):t}function QA(t,e){let n,r,i,o,s;if(HA(t)){let a=t.getAttribute("action");r=a?To(a,e):null,n=t.getAttribute("method")||uf,i=lm(t.getAttribute("enctype"))||df,o=new FormData(t)}else if(UA(t)||WA(t)&&(t.type==="submit"||t.type==="image")){let a=t.form;if(a==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let l=t.getAttribute("formaction")||a.getAttribute("action");if(r=l?To(l,e):null,n=t.getAttribute("formmethod")||a.getAttribute("method")||uf,i=lm(t.getAttribute("formenctype"))||lm(a.getAttribute("enctype"))||df,o=new FormData(a,t),!JA()){let{name:c,type:u,value:d}=t;if(u==="image"){let h=c?`${c}.`:"";o.append(`${h}x`,"0"),o.append(`${h}y`,"0")}else c&&o.append(c,d)}}else{if(Bh(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=uf,r=null,i=df,s=t}return o&&i==="text/plain"&&(s=o,o=void 0),{action:r,method:n.toLowerCase(),encType:i,formData:o,body:s}}function v0(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}async function XA(t,e){if(t.id in e)return e[t.id];try{let n=await Ps(()=>import(t.module),[]);return e[t.id]=n,n}catch(n){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function ZA(t){return t!=null&&typeof t.page=="string"}function eN(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function tN(t,e,n){let r=await Promise.all(t.map(async i=>{let o=e.routes[i.route.id];if(o){let s=await XA(o,n);return s.links?s.links():[]}return[]}));return oN(r.flat(1).filter(eN).filter(i=>i.rel==="stylesheet"||i.rel==="preload").map(i=>i.rel==="stylesheet"?{...i,rel:"prefetch",as:"style"}:{...i,rel:"prefetch"}))}function sb(t,e,n,r,i,o){let s=(l,c)=>n[c]?l.route.id!==n[c].route.id:!0,a=(l,c)=>{var u;return n[c].pathname!==l.pathname||((u=n[c].route.path)==null?void 0:u.endsWith("*"))&&n[c].params["*"]!==l.params["*"]};return o==="assets"?e.filter((l,c)=>s(l,c)||a(l,c)):o==="data"?e.filter((l,c)=>{var d;let u=r.routes[l.route.id];if(!u||!u.hasLoader)return!1;if(s(l,c)||a(l,c))return!0;if(l.route.shouldRevalidate){let h=l.route.shouldRevalidate({currentUrl:new URL(i.pathname+i.search+i.hash,window.origin),currentParams:((d=n[0])==null?void 0:d.params)||{},nextUrl:new URL(t,window.origin),nextParams:l.params,defaultShouldRevalidate:!0});if(typeof h=="boolean")return h}return!0}):[]}function nN(t,e,{includeHydrateFallback:n}={}){return rN(t.map(r=>{let i=e.routes[r.route.id];if(!i)return[];let o=[i.module];return i.clientActionModule&&(o=o.concat(i.clientActionModule)),i.clientLoaderModule&&(o=o.concat(i.clientLoaderModule)),n&&i.hydrateFallbackModule&&(o=o.concat(i.hydrateFallbackModule)),i.imports&&(o=o.concat(i.imports)),o}).flat(1))}function rN(t){return[...new Set(t)]}function iN(t){let e={},n=Object.keys(t).sort();for(let r of n)e[r]=t[r];return e}function oN(t,e){let n=new Set,r=new Set(e);return t.reduce((i,o)=>{if(e&&!ZA(o)&&o.as==="script"&&o.href&&r.has(o.href))return i;let a=JSON.stringify(iN(o));return n.has(a)||(n.add(a),i.push({key:a,link:o})),i},[])}function sN(t){let e=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return e.pathname==="/"?e.pathname="_root.data":e.pathname=`${e.pathname.replace(/\/$/,"")}.data`,e}function aN(){let t=m.useContext(Ll);return v0(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function lN(){let t=m.useContext(Fh);return v0(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var x0=m.createContext(void 0);x0.displayName="FrameworkContext";function wE(){let t=m.useContext(x0);return v0(t,"You must render this element inside a <HydratedRouter> element"),t}function cN(t,e){let n=m.useContext(x0),[r,i]=m.useState(!1),[o,s]=m.useState(!1),{onFocus:a,onBlur:l,onMouseEnter:c,onMouseLeave:u,onTouchStart:d}=e,h=m.useRef(null);m.useEffect(()=>{if(t==="render"&&s(!0),t==="viewport"){let y=v=>{v.forEach(w=>{s(w.isIntersecting)})},x=new IntersectionObserver(y,{threshold:.5});return h.current&&x.observe(h.current),()=>{x.disconnect()}}},[t]),m.useEffect(()=>{if(r){let y=setTimeout(()=>{s(!0)},100);return()=>{clearTimeout(y)}}},[r]);let p=()=>{i(!0)},g=()=>{i(!1),s(!1)};return n?t!=="intent"?[o,h,{}]:[o,h,{onFocus:oc(a,p),onBlur:oc(l,g),onMouseEnter:oc(c,p),onMouseLeave:oc(u,g),onTouchStart:oc(d,p)}]:[!1,h,{}]}function oc(t,e){return n=>{t&&t(n),n.defaultPrevented||e(n)}}function uN({page:t,...e}){let{router:n}=aN(),r=m.useMemo(()=>dE(n.routes,t,n.basename),[n.routes,t,n.basename]);return r?m.createElement(fN,{page:t,matches:r,...e}):null}function dN(t){let{manifest:e,routeModules:n}=wE(),[r,i]=m.useState([]);return m.useEffect(()=>{let o=!1;return tN(t,e,n).then(s=>{o||i(s)}),()=>{o=!0}},[t,e,n]),r}function fN({page:t,matches:e,...n}){let r=Gn(),{manifest:i,routeModules:o}=wE(),{loaderData:s,matches:a}=lN(),l=m.useMemo(()=>sb(t,e,a,i,r,"data"),[t,e,a,i,r]),c=m.useMemo(()=>sb(t,e,a,i,r,"assets"),[t,e,a,i,r]),u=m.useMemo(()=>{if(t===r.pathname+r.search+r.hash)return[];let p=new Set,g=!1;if(e.forEach(x=>{var w;let v=i.routes[x.route.id];!v||!v.hasLoader||(!l.some(b=>b.route.id===x.route.id)&&x.route.id in s&&((w=o[x.route.id])!=null&&w.shouldRevalidate)||v.hasClientLoader?g=!0:p.add(x.route.id))}),p.size===0)return[];let y=sN(t);return g&&p.size>0&&y.searchParams.set("_routes",e.filter(x=>p.has(x.route.id)).map(x=>x.route.id).join(",")),[y.pathname+y.search]},[s,r,i,l,e,t,o]),d=m.useMemo(()=>nN(c,i),[c,i]),h=dN(c);return m.createElement(m.Fragment,null,u.map(p=>m.createElement("link",{key:p,rel:"prefetch",as:"fetch",href:p,...n})),d.map(p=>m.createElement("link",{key:p,rel:"modulepreload",href:p,...n})),h.map(({key:p,link:g})=>m.createElement("link",{key:p,...g})))}function hN(...t){return e=>{t.forEach(n=>{typeof n=="function"?n(e):n!=null&&(n.current=e)})}}var bE=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{bE&&(window.__reactRouterVersion="7.2.0")}catch{}function pN({basename:t,children:e,window:n}){let r=m.useRef();r.current==null&&(r.current=ZI({window:n,v5Compat:!0}));let i=r.current,[o,s]=m.useState({action:i.action,location:i.location}),a=m.useCallback(l=>{m.startTransition(()=>s(l))},[s]);return m.useLayoutEffect(()=>i.listen(a),[i,a]),m.createElement(zA,{basename:t,children:e,location:o.location,navigationType:o.action,navigator:i})}var SE=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,w0=m.forwardRef(function({onClick:e,discover:n="render",prefetch:r="none",relative:i,reloadDocument:o,replace:s,state:a,target:l,to:c,preventScrollReset:u,viewTransition:d,...h},p){let{basename:g}=m.useContext(pr),y=typeof c=="string"&&SE.test(c),x,v=!1;if(typeof c=="string"&&y&&(x=c,bE))try{let R=new URL(window.location.href),_=c.startsWith("//")?new URL(R.protocol+c):new URL(c),A=To(_.pathname,g);_.origin===R.origin&&A!=null?c=A+_.search+_.hash:v=!0}catch{Wn(!1,`<Link to="${c}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let w=EA(c,{relative:i}),[b,S,C]=cN(r,h),k=vN(c,{replace:s,state:a,target:l,preventScrollReset:u,relative:i,viewTransition:d});function E(R){e&&e(R),R.defaultPrevented||k(R)}let T=m.createElement("a",{...h,...C,href:x||w,onClick:v||o?e:E,ref:hN(p,S),target:l,"data-discover":!y&&n==="render"?"true":void 0});return b&&!y?m.createElement(m.Fragment,null,T,m.createElement(uN,{page:w})):T});w0.displayName="Link";var mN=m.forwardRef(function({"aria-current":e="page",caseSensitive:n=!1,className:r="",end:i=!1,style:o,to:s,viewTransition:a,children:l,...c},u){let d=Bu(s,{relative:c.relative}),h=Gn(),p=m.useContext(Fh),{navigator:g,basename:y}=m.useContext(pr),x=p!=null&&kN(d)&&a===!0,v=g.encodeLocation?g.encodeLocation(d).pathname:d.pathname,w=h.pathname,b=p&&p.navigation&&p.navigation.location?p.navigation.location.pathname:null;n||(w=w.toLowerCase(),b=b?b.toLowerCase():null,v=v.toLowerCase()),b&&y&&(b=To(b,y)||b);const S=v!=="/"&&v.endsWith("/")?v.length-1:v.length;let C=w===v||!i&&w.startsWith(v)&&w.charAt(S)==="/",k=b!=null&&(b===v||!i&&b.startsWith(v)&&b.charAt(v.length)==="/"),E={isActive:C,isPending:k,isTransitioning:x},T=C?e:void 0,R;typeof r=="function"?R=r(E):R=[r,C?"active":null,k?"pending":null,x?"transitioning":null].filter(Boolean).join(" ");let _=typeof o=="function"?o(E):o;return m.createElement(w0,{...c,"aria-current":T,className:R,ref:u,style:_,to:s,viewTransition:a},typeof l=="function"?l(E):l)});mN.displayName="NavLink";var gN=m.forwardRef(({discover:t="render",fetcherKey:e,navigate:n,reloadDocument:r,replace:i,state:o,method:s=uf,action:a,onSubmit:l,relative:c,preventScrollReset:u,viewTransition:d,...h},p)=>{let g=SN(),y=CN(a,{relative:c}),x=s.toLowerCase()==="get"?"get":"post",v=typeof a=="string"&&SE.test(a),w=b=>{if(l&&l(b),b.defaultPrevented)return;b.preventDefault();let S=b.nativeEvent.submitter,C=(S==null?void 0:S.getAttribute("formmethod"))||s;g(S||b.currentTarget,{fetcherKey:e,method:C,navigate:n,replace:i,state:o,relative:c,preventScrollReset:u,viewTransition:d})};return m.createElement("form",{ref:p,method:x,action:y,onSubmit:r?l:w,...h,"data-discover":!v&&t==="render"?"true":void 0})});gN.displayName="Form";function yN(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function CE(t){let e=m.useContext(Ll);return Be(e,yN(t)),e}function vN(t,{target:e,replace:n,state:r,preventScrollReset:i,relative:o,viewTransition:s}={}){let a=gr(),l=Gn(),c=Bu(t,{relative:o});return m.useCallback(u=>{if(qA(u,e)){u.preventDefault();let d=n!==void 0?n:nu(l)===nu(c);a(t,{replace:d,state:r,preventScrollReset:i,relative:o,viewTransition:s})}},[l,a,c,n,r,e,t,i,o,s])}function xN(t){Wn(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=m.useRef(Zg(t)),n=m.useRef(!1),r=Gn(),i=m.useMemo(()=>GA(r.search,n.current?null:e.current),[r.search]),o=gr(),s=m.useCallback((a,l)=>{const c=Zg(typeof a=="function"?a(i):a);n.current=!0,o("?"+c,l)},[o,i]);return[i,s]}var wN=0,bN=()=>`__${String(++wN)}__`;function SN(){let{router:t}=CE("useSubmit"),{basename:e}=m.useContext(pr),n=LA();return m.useCallback(async(r,i={})=>{let{action:o,method:s,encType:a,formData:l,body:c}=QA(r,e);if(i.navigate===!1){let u=i.fetcherKey||bN();await t.fetch(u,n,i.action||o,{preventScrollReset:i.preventScrollReset,formData:l,body:c,formMethod:i.method||s,formEncType:i.encType||a,flushSync:i.flushSync})}else await t.navigate(i.action||o,{preventScrollReset:i.preventScrollReset,formData:l,body:c,formMethod:i.method||s,formEncType:i.encType||a,replace:i.replace,state:i.state,fromRouteId:n,flushSync:i.flushSync,viewTransition:i.viewTransition})},[t,e,n])}function CN(t,{relative:e}={}){let{basename:n}=m.useContext(pr),r=m.useContext(mr);Be(r,"useFormAction must be used inside a RouteContext");let[i]=r.matches.slice(-1),o={...Bu(t||".",{relative:e})},s=Gn();if(t==null){o.search=s.search;let a=new URLSearchParams(o.search),l=a.getAll("index");if(l.some(u=>u==="")){a.delete("index"),l.filter(d=>d).forEach(d=>a.append("index",d));let u=a.toString();o.search=u?`?${u}`:""}}return(!t||t===".")&&i.route.index&&(o.search=o.search?o.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(o.pathname=o.pathname==="/"?n:ai([n,o.pathname])),nu(o)}function kN(t,e={}){let n=m.useContext(mE);Be(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=CE("useViewTransitionState"),i=Bu(t,{relative:e.relative});if(!n.isTransitioning)return!1;let o=To(n.currentLocation.pathname,r)||n.currentLocation.pathname,s=To(n.nextLocation.pathname,r)||n.nextLocation.pathname;return Wf(i.pathname,s)!=null||Wf(i.pathname,o)!=null}new TextEncoder;var Fl=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(t){return this.listeners.add(t),this.onSubscribe(),()=>{this.listeners.delete(t),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},Ms=typeof window>"u"||"Deno"in globalThis;function Mn(){}function EN(t,e){return typeof t=="function"?t(e):t}function ey(t){return typeof t=="number"&&t>=0&&t!==1/0}function kE(t,e){return Math.max(t+(e||0)-Date.now(),0)}function Ba(t,e){return typeof t=="function"?t(e):t}function or(t,e){return typeof t=="function"?t(e):t}function ab(t,e){const{type:n="all",exact:r,fetchStatus:i,predicate:o,queryKey:s,stale:a}=t;if(s){if(r){if(e.queryHash!==b0(s,e.options))return!1}else if(!ru(e.queryKey,s))return!1}if(n!=="all"){const l=e.isActive();if(n==="active"&&!l||n==="inactive"&&l)return!1}return!(typeof a=="boolean"&&e.isStale()!==a||i&&i!==e.state.fetchStatus||o&&!o(e))}function lb(t,e){const{exact:n,status:r,predicate:i,mutationKey:o}=t;if(o){if(!e.options.mutationKey)return!1;if(n){if(Is(e.options.mutationKey)!==Is(o))return!1}else if(!ru(e.options.mutationKey,o))return!1}return!(r&&e.state.status!==r||i&&!i(e))}function b0(t,e){return((e==null?void 0:e.queryKeyHashFn)||Is)(t)}function Is(t){return JSON.stringify(t,(e,n)=>ty(n)?Object.keys(n).sort().reduce((r,i)=>(r[i]=n[i],r),{}):n)}function ru(t,e){return t===e?!0:typeof t!=typeof e?!1:t&&e&&typeof t=="object"&&typeof e=="object"?!Object.keys(e).some(n=>!ru(t[n],e[n])):!1}function EE(t,e){if(t===e)return t;const n=cb(t)&&cb(e);if(n||ty(t)&&ty(e)){const r=n?t:Object.keys(t),i=r.length,o=n?e:Object.keys(e),s=o.length,a=n?[]:{};let l=0;for(let c=0;c<s;c++){const u=n?c:o[c];(!n&&r.includes(u)||n)&&t[u]===void 0&&e[u]===void 0?(a[u]=void 0,l++):(a[u]=EE(t[u],e[u]),a[u]===t[u]&&t[u]!==void 0&&l++)}return i===s&&l===i?t:a}return e}function qf(t,e){if(!e||Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(t[n]!==e[n])return!1;return!0}function cb(t){return Array.isArray(t)&&t.length===Object.keys(t).length}function ty(t){if(!ub(t))return!1;const e=t.constructor;if(e===void 0)return!0;const n=e.prototype;return!(!ub(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(t)!==Object.prototype)}function ub(t){return Object.prototype.toString.call(t)==="[object Object]"}function TN(t){return new Promise(e=>{setTimeout(e,t)})}function ny(t,e,n){return typeof n.structuralSharing=="function"?n.structuralSharing(t,e):n.structuralSharing!==!1?EE(t,e):e}function _N(t,e,n=0){const r=[...t,e];return n&&r.length>n?r.slice(1):r}function RN(t,e,n=0){const r=[e,...t];return n&&r.length>n?r.slice(0,-1):r}var S0=Symbol();function TE(t,e){return!t.queryFn&&(e!=null&&e.initialPromise)?()=>e.initialPromise:!t.queryFn||t.queryFn===S0?()=>Promise.reject(new Error(`Missing queryFn: '${t.queryHash}'`)):t.queryFn}var as,Ji,qa,zS,ON=(zS=class extends Fl{constructor(){super();Y(this,as,void 0);Y(this,Ji,void 0);Y(this,qa,void 0);W(this,qa,e=>{if(!Ms&&window.addEventListener){const n=()=>e();return window.addEventListener("visibilitychange",n,!1),()=>{window.removeEventListener("visibilitychange",n)}}})}onSubscribe(){O(this,Ji)||this.setEventListener(O(this,qa))}onUnsubscribe(){var e;this.hasListeners()||((e=O(this,Ji))==null||e.call(this),W(this,Ji,void 0))}setEventListener(e){var n;W(this,qa,e),(n=O(this,Ji))==null||n.call(this),W(this,Ji,e(r=>{typeof r=="boolean"?this.setFocused(r):this.onFocus()}))}setFocused(e){O(this,as)!==e&&(W(this,as,e),this.onFocus())}onFocus(){const e=this.isFocused();this.listeners.forEach(n=>{n(e)})}isFocused(){var e;return typeof O(this,as)=="boolean"?O(this,as):((e=globalThis.document)==null?void 0:e.visibilityState)!=="hidden"}},as=new WeakMap,Ji=new WeakMap,qa=new WeakMap,zS),C0=new ON,Ga,Yi,Ja,VS,PN=(VS=class extends Fl{constructor(){super();Y(this,Ga,!0);Y(this,Yi,void 0);Y(this,Ja,void 0);W(this,Ja,e=>{if(!Ms&&window.addEventListener){const n=()=>e(!0),r=()=>e(!1);return window.addEventListener("online",n,!1),window.addEventListener("offline",r,!1),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",r)}}})}onSubscribe(){O(this,Yi)||this.setEventListener(O(this,Ja))}onUnsubscribe(){var e;this.hasListeners()||((e=O(this,Yi))==null||e.call(this),W(this,Yi,void 0))}setEventListener(e){var n;W(this,Ja,e),(n=O(this,Yi))==null||n.call(this),W(this,Yi,e(this.setOnline.bind(this)))}setOnline(e){O(this,Ga)!==e&&(W(this,Ga,e),this.listeners.forEach(r=>{r(e)}))}isOnline(){return O(this,Ga)}},Ga=new WeakMap,Yi=new WeakMap,Ja=new WeakMap,VS),Gf=new PN;function ry(){let t,e;const n=new Promise((i,o)=>{t=i,e=o});n.status="pending",n.catch(()=>{});function r(i){Object.assign(n,i),delete n.resolve,delete n.reject}return n.resolve=i=>{r({status:"fulfilled",value:i}),t(i)},n.reject=i=>{r({status:"rejected",reason:i}),e(i)},n}function MN(t){return Math.min(1e3*2**t,3e4)}function _E(t){return(t??"online")==="online"?Gf.isOnline():!0}var RE=class extends Error{constructor(t){super("CancelledError"),this.revert=t==null?void 0:t.revert,this.silent=t==null?void 0:t.silent}};function cm(t){return t instanceof RE}function OE(t){let e=!1,n=0,r=!1,i;const o=ry(),s=y=>{var x;r||(h(new RE(y)),(x=t.abort)==null||x.call(t))},a=()=>{e=!0},l=()=>{e=!1},c=()=>C0.isFocused()&&(t.networkMode==="always"||Gf.isOnline())&&t.canRun(),u=()=>_E(t.networkMode)&&t.canRun(),d=y=>{var x;r||(r=!0,(x=t.onSuccess)==null||x.call(t,y),i==null||i(),o.resolve(y))},h=y=>{var x;r||(r=!0,(x=t.onError)==null||x.call(t,y),i==null||i(),o.reject(y))},p=()=>new Promise(y=>{var x;i=v=>{(r||c())&&y(v)},(x=t.onPause)==null||x.call(t)}).then(()=>{var y;i=void 0,r||(y=t.onContinue)==null||y.call(t)}),g=()=>{if(r)return;let y;const x=n===0?t.initialPromise:void 0;try{y=x??t.fn()}catch(v){y=Promise.reject(v)}Promise.resolve(y).then(d).catch(v=>{var k;if(r)return;const w=t.retry??(Ms?0:3),b=t.retryDelay??MN,S=typeof b=="function"?b(n,v):b,C=w===!0||typeof w=="number"&&n<w||typeof w=="function"&&w(n,v);if(e||!C){h(v);return}n++,(k=t.onFail)==null||k.call(t,n,v),TN(S).then(()=>c()?void 0:p()).then(()=>{e?h(v):g()})})};return{promise:o,cancel:s,continue:()=>(i==null||i(),o),cancelRetry:a,continueRetry:l,canStart:u,start:()=>(u()?g():p().then(g),o)}}function IN(){let t=[],e=0,n=a=>{a()},r=a=>{a()},i=a=>setTimeout(a,0);const o=a=>{e?t.push(a):i(()=>{n(a)})},s=()=>{const a=t;t=[],a.length&&i(()=>{r(()=>{a.forEach(l=>{n(l)})})})};return{batch:a=>{let l;e++;try{l=a()}finally{e--,e||s()}return l},batchCalls:a=>(...l)=>{o(()=>{a(...l)})},schedule:o,setNotifyFunction:a=>{n=a},setBatchNotifyFunction:a=>{r=a},setScheduler:a=>{i=a}}}var rt=IN(),ls,US,PE=(US=class{constructor(){Y(this,ls,void 0)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),ey(this.gcTime)&&W(this,ls,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(t){this.gcTime=Math.max(this.gcTime||0,t??(Ms?1/0:5*60*1e3))}clearGcTimeout(){O(this,ls)&&(clearTimeout(O(this,ls)),W(this,ls,void 0))}},ls=new WeakMap,US),Ya,Qa,Pn,cs,Tt,Su,us,er,Jr,HS,AN=(HS=class extends PE{constructor(e){super();Y(this,er);Y(this,Ya,void 0);Y(this,Qa,void 0);Y(this,Pn,void 0);Y(this,cs,void 0);Y(this,Tt,void 0);Y(this,Su,void 0);Y(this,us,void 0);W(this,us,!1),W(this,Su,e.defaultOptions),this.setOptions(e.options),this.observers=[],W(this,cs,e.client),W(this,Pn,O(this,cs).getQueryCache()),this.queryKey=e.queryKey,this.queryHash=e.queryHash,W(this,Ya,NN(this.options)),this.state=e.state??O(this,Ya),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var e;return(e=O(this,Tt))==null?void 0:e.promise}setOptions(e){this.options={...O(this,Su),...e},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&O(this,Pn).remove(this)}setData(e,n){const r=ny(this.state.data,e,this.options);return le(this,er,Jr).call(this,{data:r,type:"success",dataUpdatedAt:n==null?void 0:n.updatedAt,manual:n==null?void 0:n.manual}),r}setState(e,n){le(this,er,Jr).call(this,{type:"setState",state:e,setStateOptions:n})}cancel(e){var r,i;const n=(r=O(this,Tt))==null?void 0:r.promise;return(i=O(this,Tt))==null||i.cancel(e),n?n.then(Mn).catch(Mn):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(O(this,Ya))}isActive(){return this.observers.some(e=>or(e.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===S0||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStale(){return this.state.isInvalidated?!0:this.getObserversCount()>0?this.observers.some(e=>e.getCurrentResult().isStale):this.state.data===void 0}isStaleByTime(e=0){return this.state.isInvalidated||this.state.data===void 0||!kE(this.state.dataUpdatedAt,e)}onFocus(){var n;const e=this.observers.find(r=>r.shouldFetchOnWindowFocus());e==null||e.refetch({cancelRefetch:!1}),(n=O(this,Tt))==null||n.continue()}onOnline(){var n;const e=this.observers.find(r=>r.shouldFetchOnReconnect());e==null||e.refetch({cancelRefetch:!1}),(n=O(this,Tt))==null||n.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),O(this,Pn).notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter(n=>n!==e),this.observers.length||(O(this,Tt)&&(O(this,us)?O(this,Tt).cancel({revert:!0}):O(this,Tt).cancelRetry()),this.scheduleGc()),O(this,Pn).notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||le(this,er,Jr).call(this,{type:"invalidate"})}fetch(e,n){var l,c,u;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(n!=null&&n.cancelRefetch))this.cancel({silent:!0});else if(O(this,Tt))return O(this,Tt).continueRetry(),O(this,Tt).promise}if(e&&this.setOptions(e),!this.options.queryFn){const d=this.observers.find(h=>h.options.queryFn);d&&this.setOptions(d.options)}const r=new AbortController,i=d=>{Object.defineProperty(d,"signal",{enumerable:!0,get:()=>(W(this,us,!0),r.signal)})},o=()=>{const d=TE(this.options,n),h={client:O(this,cs),queryKey:this.queryKey,meta:this.meta};return i(h),W(this,us,!1),this.options.persister?this.options.persister(d,h,this):d(h)},s={fetchOptions:n,options:this.options,queryKey:this.queryKey,client:O(this,cs),state:this.state,fetchFn:o};i(s),(l=this.options.behavior)==null||l.onFetch(s,this),W(this,Qa,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((c=s.fetchOptions)==null?void 0:c.meta))&&le(this,er,Jr).call(this,{type:"fetch",meta:(u=s.fetchOptions)==null?void 0:u.meta});const a=d=>{var h,p,g,y;cm(d)&&d.silent||le(this,er,Jr).call(this,{type:"error",error:d}),cm(d)||((p=(h=O(this,Pn).config).onError)==null||p.call(h,d,this),(y=(g=O(this,Pn).config).onSettled)==null||y.call(g,this.state.data,d,this)),this.scheduleGc()};return W(this,Tt,OE({initialPromise:n==null?void 0:n.initialPromise,fn:s.fetchFn,abort:r.abort.bind(r),onSuccess:d=>{var h,p,g,y;if(d===void 0){a(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(d)}catch(x){a(x);return}(p=(h=O(this,Pn).config).onSuccess)==null||p.call(h,d,this),(y=(g=O(this,Pn).config).onSettled)==null||y.call(g,d,this.state.error,this),this.scheduleGc()},onError:a,onFail:(d,h)=>{le(this,er,Jr).call(this,{type:"failed",failureCount:d,error:h})},onPause:()=>{le(this,er,Jr).call(this,{type:"pause"})},onContinue:()=>{le(this,er,Jr).call(this,{type:"continue"})},retry:s.options.retry,retryDelay:s.options.retryDelay,networkMode:s.options.networkMode,canRun:()=>!0})),O(this,Tt).start()}},Ya=new WeakMap,Qa=new WeakMap,Pn=new WeakMap,cs=new WeakMap,Tt=new WeakMap,Su=new WeakMap,us=new WeakMap,er=new WeakSet,Jr=function(e){const n=r=>{switch(e.type){case"failed":return{...r,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...r,fetchStatus:"paused"};case"continue":return{...r,fetchStatus:"fetching"};case"fetch":return{...r,...ME(r.data,this.options),fetchMeta:e.meta??null};case"success":return{...r,data:e.data,dataUpdateCount:r.dataUpdateCount+1,dataUpdatedAt:e.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const i=e.error;return cm(i)&&i.revert&&O(this,Qa)?{...O(this,Qa),fetchStatus:"idle"}:{...r,error:i,errorUpdateCount:r.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:r.fetchFailureCount+1,fetchFailureReason:i,fetchStatus:"idle",status:"error"};case"invalidate":return{...r,isInvalidated:!0};case"setState":return{...r,...e.state}}};this.state=n(this.state),rt.batch(()=>{this.observers.forEach(r=>{r.onQueryUpdate()}),O(this,Pn).notify({query:this,type:"updated",action:e})})},HS);function ME(t,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:_E(e.networkMode)?"fetching":"paused",...t===void 0&&{error:null,status:"pending"}}}function NN(t){const e=typeof t.initialData=="function"?t.initialData():t.initialData,n=e!==void 0,r=n?typeof t.initialDataUpdatedAt=="function"?t.initialDataUpdatedAt():t.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:n?r??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}var Er,WS,jN=(WS=class extends Fl{constructor(e={}){super();Y(this,Er,void 0);this.config=e,W(this,Er,new Map)}build(e,n,r){const i=n.queryKey,o=n.queryHash??b0(i,n);let s=this.get(o);return s||(s=new AN({client:e,queryKey:i,queryHash:o,options:e.defaultQueryOptions(n),state:r,defaultOptions:e.getQueryDefaults(i)}),this.add(s)),s}add(e){O(this,Er).has(e.queryHash)||(O(this,Er).set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const n=O(this,Er).get(e.queryHash);n&&(e.destroy(),n===e&&O(this,Er).delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){rt.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return O(this,Er).get(e)}getAll(){return[...O(this,Er).values()]}find(e){const n={exact:!0,...e};return this.getAll().find(r=>ab(n,r))}findAll(e={}){const n=this.getAll();return Object.keys(e).length>0?n.filter(r=>ab(e,r)):n}notify(e){rt.batch(()=>{this.listeners.forEach(n=>{n(e)})})}onFocus(){rt.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){rt.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}},Er=new WeakMap,WS),Tr,Ft,ds,_r,Ei,KS,DN=(KS=class extends PE{constructor(e){super();Y(this,_r);Y(this,Tr,void 0);Y(this,Ft,void 0);Y(this,ds,void 0);this.mutationId=e.mutationId,W(this,Ft,e.mutationCache),W(this,Tr,[]),this.state=e.state||IE(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){O(this,Tr).includes(e)||(O(this,Tr).push(e),this.clearGcTimeout(),O(this,Ft).notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){W(this,Tr,O(this,Tr).filter(n=>n!==e)),this.scheduleGc(),O(this,Ft).notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){O(this,Tr).length||(this.state.status==="pending"?this.scheduleGc():O(this,Ft).remove(this))}continue(){var e;return((e=O(this,ds))==null?void 0:e.continue())??this.execute(this.state.variables)}async execute(e){var i,o,s,a,l,c,u,d,h,p,g,y,x,v,w,b,S,C,k,E;W(this,ds,OE({fn:()=>this.options.mutationFn?this.options.mutationFn(e):Promise.reject(new Error("No mutationFn found")),onFail:(T,R)=>{le(this,_r,Ei).call(this,{type:"failed",failureCount:T,error:R})},onPause:()=>{le(this,_r,Ei).call(this,{type:"pause"})},onContinue:()=>{le(this,_r,Ei).call(this,{type:"continue"})},retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>O(this,Ft).canRun(this)}));const n=this.state.status==="pending",r=!O(this,ds).canStart();try{if(!n){le(this,_r,Ei).call(this,{type:"pending",variables:e,isPaused:r}),await((o=(i=O(this,Ft).config).onMutate)==null?void 0:o.call(i,e,this));const R=await((a=(s=this.options).onMutate)==null?void 0:a.call(s,e));R!==this.state.context&&le(this,_r,Ei).call(this,{type:"pending",context:R,variables:e,isPaused:r})}const T=await O(this,ds).start();return await((c=(l=O(this,Ft).config).onSuccess)==null?void 0:c.call(l,T,e,this.state.context,this)),await((d=(u=this.options).onSuccess)==null?void 0:d.call(u,T,e,this.state.context)),await((p=(h=O(this,Ft).config).onSettled)==null?void 0:p.call(h,T,null,this.state.variables,this.state.context,this)),await((y=(g=this.options).onSettled)==null?void 0:y.call(g,T,null,e,this.state.context)),le(this,_r,Ei).call(this,{type:"success",data:T}),T}catch(T){try{throw await((v=(x=O(this,Ft).config).onError)==null?void 0:v.call(x,T,e,this.state.context,this)),await((b=(w=this.options).onError)==null?void 0:b.call(w,T,e,this.state.context)),await((C=(S=O(this,Ft).config).onSettled)==null?void 0:C.call(S,void 0,T,this.state.variables,this.state.context,this)),await((E=(k=this.options).onSettled)==null?void 0:E.call(k,void 0,T,e,this.state.context)),T}finally{le(this,_r,Ei).call(this,{type:"error",error:T})}}finally{O(this,Ft).runNext(this)}}},Tr=new WeakMap,Ft=new WeakMap,ds=new WeakMap,_r=new WeakSet,Ei=function(e){const n=r=>{switch(e.type){case"failed":return{...r,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...r,isPaused:!0};case"continue":return{...r,isPaused:!1};case"pending":return{...r,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...r,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...r,data:void 0,error:e.error,failureCount:r.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}};this.state=n(this.state),rt.batch(()=>{O(this,Tr).forEach(r=>{r.onMutationUpdate(e)}),O(this,Ft).notify({mutation:this,type:"updated",action:e})})},KS);function IE(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var ei,tr,Cu,qS,LN=(qS=class extends Fl{constructor(e={}){super();Y(this,ei,void 0);Y(this,tr,void 0);Y(this,Cu,void 0);this.config=e,W(this,ei,new Set),W(this,tr,new Map),W(this,Cu,0)}build(e,n,r){const i=new DN({mutationCache:this,mutationId:++ad(this,Cu)._,options:e.defaultMutationOptions(n),state:r});return this.add(i),i}add(e){O(this,ei).add(e);const n=Td(e);if(typeof n=="string"){const r=O(this,tr).get(n);r?r.push(e):O(this,tr).set(n,[e])}this.notify({type:"added",mutation:e})}remove(e){if(O(this,ei).delete(e)){const n=Td(e);if(typeof n=="string"){const r=O(this,tr).get(n);if(r)if(r.length>1){const i=r.indexOf(e);i!==-1&&r.splice(i,1)}else r[0]===e&&O(this,tr).delete(n)}}this.notify({type:"removed",mutation:e})}canRun(e){const n=Td(e);if(typeof n=="string"){const r=O(this,tr).get(n),i=r==null?void 0:r.find(o=>o.state.status==="pending");return!i||i===e}else return!0}runNext(e){var r;const n=Td(e);if(typeof n=="string"){const i=(r=O(this,tr).get(n))==null?void 0:r.find(o=>o!==e&&o.state.isPaused);return(i==null?void 0:i.continue())??Promise.resolve()}else return Promise.resolve()}clear(){rt.batch(()=>{O(this,ei).forEach(e=>{this.notify({type:"removed",mutation:e})}),O(this,ei).clear(),O(this,tr).clear()})}getAll(){return Array.from(O(this,ei))}find(e){const n={exact:!0,...e};return this.getAll().find(r=>lb(n,r))}findAll(e={}){return this.getAll().filter(n=>lb(e,n))}notify(e){rt.batch(()=>{this.listeners.forEach(n=>{n(e)})})}resumePausedMutations(){const e=this.getAll().filter(n=>n.state.isPaused);return rt.batch(()=>Promise.all(e.map(n=>n.continue().catch(Mn))))}},ei=new WeakMap,tr=new WeakMap,Cu=new WeakMap,qS);function Td(t){var e;return(e=t.options.scope)==null?void 0:e.id}function db(t){return{onFetch:(e,n)=>{var u,d,h,p,g;const r=e.options,i=(h=(d=(u=e.fetchOptions)==null?void 0:u.meta)==null?void 0:d.fetchMore)==null?void 0:h.direction,o=((p=e.state.data)==null?void 0:p.pages)||[],s=((g=e.state.data)==null?void 0:g.pageParams)||[];let a={pages:[],pageParams:[]},l=0;const c=async()=>{let y=!1;const x=b=>{Object.defineProperty(b,"signal",{enumerable:!0,get:()=>(e.signal.aborted?y=!0:e.signal.addEventListener("abort",()=>{y=!0}),e.signal)})},v=TE(e.options,e.fetchOptions),w=async(b,S,C)=>{if(y)return Promise.reject();if(S==null&&b.pages.length)return Promise.resolve(b);const k={client:e.client,queryKey:e.queryKey,pageParam:S,direction:C?"backward":"forward",meta:e.options.meta};x(k);const E=await v(k),{maxPages:T}=e.options,R=C?RN:_N;return{pages:R(b.pages,E,T),pageParams:R(b.pageParams,S,T)}};if(i&&o.length){const b=i==="backward",S=b?$N:fb,C={pages:o,pageParams:s},k=S(r,C);a=await w(C,k,b)}else{const b=t??o.length;do{const S=l===0?s[0]??r.initialPageParam:fb(r,a);if(l>0&&S==null)break;a=await w(a,S),l++}while(l<b)}return a};e.options.persister?e.fetchFn=()=>{var y,x;return(x=(y=e.options).persister)==null?void 0:x.call(y,c,{client:e.client,queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},n)}:e.fetchFn=c}}}function fb(t,{pages:e,pageParams:n}){const r=e.length-1;return e.length>0?t.getNextPageParam(e[r],e,n[r],n):void 0}function $N(t,{pages:e,pageParams:n}){var r;return e.length>0?(r=t.getPreviousPageParam)==null?void 0:r.call(t,e[0],e,n[0],n):void 0}var He,Qi,Xi,Xa,Za,Zi,el,tl,GS,AE=(GS=class{constructor(t={}){Y(this,He,void 0);Y(this,Qi,void 0);Y(this,Xi,void 0);Y(this,Xa,void 0);Y(this,Za,void 0);Y(this,Zi,void 0);Y(this,el,void 0);Y(this,tl,void 0);W(this,He,t.queryCache||new jN),W(this,Qi,t.mutationCache||new LN),W(this,Xi,t.defaultOptions||{}),W(this,Xa,new Map),W(this,Za,new Map),W(this,Zi,0)}mount(){ad(this,Zi)._++,O(this,Zi)===1&&(W(this,el,C0.subscribe(async t=>{t&&(await this.resumePausedMutations(),O(this,He).onFocus())})),W(this,tl,Gf.subscribe(async t=>{t&&(await this.resumePausedMutations(),O(this,He).onOnline())})))}unmount(){var t,e;ad(this,Zi)._--,O(this,Zi)===0&&((t=O(this,el))==null||t.call(this),W(this,el,void 0),(e=O(this,tl))==null||e.call(this),W(this,tl,void 0))}isFetching(t){return O(this,He).findAll({...t,fetchStatus:"fetching"}).length}isMutating(t){return O(this,Qi).findAll({...t,status:"pending"}).length}getQueryData(t){var n;const e=this.defaultQueryOptions({queryKey:t});return(n=O(this,He).get(e.queryHash))==null?void 0:n.state.data}ensureQueryData(t){const e=this.defaultQueryOptions(t),n=O(this,He).build(this,e),r=n.state.data;return r===void 0?this.fetchQuery(t):(t.revalidateIfStale&&n.isStaleByTime(Ba(e.staleTime,n))&&this.prefetchQuery(e),Promise.resolve(r))}getQueriesData(t){return O(this,He).findAll(t).map(({queryKey:e,state:n})=>{const r=n.data;return[e,r]})}setQueryData(t,e,n){const r=this.defaultQueryOptions({queryKey:t}),i=O(this,He).get(r.queryHash),o=i==null?void 0:i.state.data,s=EN(e,o);if(s!==void 0)return O(this,He).build(this,r).setData(s,{...n,manual:!0})}setQueriesData(t,e,n){return rt.batch(()=>O(this,He).findAll(t).map(({queryKey:r})=>[r,this.setQueryData(r,e,n)]))}getQueryState(t){var n;const e=this.defaultQueryOptions({queryKey:t});return(n=O(this,He).get(e.queryHash))==null?void 0:n.state}removeQueries(t){const e=O(this,He);rt.batch(()=>{e.findAll(t).forEach(n=>{e.remove(n)})})}resetQueries(t,e){const n=O(this,He);return rt.batch(()=>(n.findAll(t).forEach(r=>{r.reset()}),this.refetchQueries({type:"active",...t},e)))}cancelQueries(t,e={}){const n={revert:!0,...e},r=rt.batch(()=>O(this,He).findAll(t).map(i=>i.cancel(n)));return Promise.all(r).then(Mn).catch(Mn)}invalidateQueries(t,e={}){return rt.batch(()=>(O(this,He).findAll(t).forEach(n=>{n.invalidate()}),(t==null?void 0:t.refetchType)==="none"?Promise.resolve():this.refetchQueries({...t,type:(t==null?void 0:t.refetchType)??(t==null?void 0:t.type)??"active"},e)))}refetchQueries(t,e={}){const n={...e,cancelRefetch:e.cancelRefetch??!0},r=rt.batch(()=>O(this,He).findAll(t).filter(i=>!i.isDisabled()).map(i=>{let o=i.fetch(void 0,n);return n.throwOnError||(o=o.catch(Mn)),i.state.fetchStatus==="paused"?Promise.resolve():o}));return Promise.all(r).then(Mn)}fetchQuery(t){const e=this.defaultQueryOptions(t);e.retry===void 0&&(e.retry=!1);const n=O(this,He).build(this,e);return n.isStaleByTime(Ba(e.staleTime,n))?n.fetch(e):Promise.resolve(n.state.data)}prefetchQuery(t){return this.fetchQuery(t).then(Mn).catch(Mn)}fetchInfiniteQuery(t){return t.behavior=db(t.pages),this.fetchQuery(t)}prefetchInfiniteQuery(t){return this.fetchInfiniteQuery(t).then(Mn).catch(Mn)}ensureInfiniteQueryData(t){return t.behavior=db(t.pages),this.ensureQueryData(t)}resumePausedMutations(){return Gf.isOnline()?O(this,Qi).resumePausedMutations():Promise.resolve()}getQueryCache(){return O(this,He)}getMutationCache(){return O(this,Qi)}getDefaultOptions(){return O(this,Xi)}setDefaultOptions(t){W(this,Xi,t)}setQueryDefaults(t,e){O(this,Xa).set(Is(t),{queryKey:t,defaultOptions:e})}getQueryDefaults(t){const e=[...O(this,Xa).values()],n={};return e.forEach(r=>{ru(t,r.queryKey)&&Object.assign(n,r.defaultOptions)}),n}setMutationDefaults(t,e){O(this,Za).set(Is(t),{mutationKey:t,defaultOptions:e})}getMutationDefaults(t){const e=[...O(this,Za).values()],n={};return e.forEach(r=>{ru(t,r.mutationKey)&&Object.assign(n,r.defaultOptions)}),n}defaultQueryOptions(t){if(t._defaulted)return t;const e={...O(this,Xi).queries,...this.getQueryDefaults(t.queryKey),...t,_defaulted:!0};return e.queryHash||(e.queryHash=b0(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.queryFn===S0&&(e.enabled=!1),e}defaultMutationOptions(t){return t!=null&&t._defaulted?t:{...O(this,Xi).mutations,...(t==null?void 0:t.mutationKey)&&this.getMutationDefaults(t.mutationKey),...t,_defaulted:!0}}clear(){O(this,He).clear(),O(this,Qi).clear()}},He=new WeakMap,Qi=new WeakMap,Xi=new WeakMap,Xa=new WeakMap,Za=new WeakMap,Zi=new WeakMap,el=new WeakMap,tl=new WeakMap,GS),tn,ge,ku,Bt,fs,nl,eo,Rr,Eu,rl,il,hs,ps,to,ol,ms,pc,Tu,iy,_u,oy,Ru,sy,Ou,ay,Pu,ly,Mu,cy,Iu,uy,Sh,NE,JS,FN=(JS=class extends Fl{constructor(e,n){super();Y(this,ms);Y(this,Tu);Y(this,_u);Y(this,Ru);Y(this,Ou);Y(this,Pu);Y(this,Mu);Y(this,Iu);Y(this,Sh);Y(this,tn,void 0);Y(this,ge,void 0);Y(this,ku,void 0);Y(this,Bt,void 0);Y(this,fs,void 0);Y(this,nl,void 0);Y(this,eo,void 0);Y(this,Rr,void 0);Y(this,Eu,void 0);Y(this,rl,void 0);Y(this,il,void 0);Y(this,hs,void 0);Y(this,ps,void 0);Y(this,to,void 0);Y(this,ol,new Set);this.options=n,W(this,tn,e),W(this,Rr,null),W(this,eo,ry()),this.options.experimental_prefetchInRender||O(this,eo).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(n)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(O(this,ge).addObserver(this),hb(O(this,ge),this.options)?le(this,ms,pc).call(this):this.updateResult(),le(this,Ou,ay).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return dy(O(this,ge),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return dy(O(this,ge),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,le(this,Pu,ly).call(this),le(this,Mu,cy).call(this),O(this,ge).removeObserver(this)}setOptions(e,n){const r=this.options,i=O(this,ge);if(this.options=O(this,tn).defaultQueryOptions(e),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof or(this.options.enabled,O(this,ge))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");le(this,Iu,uy).call(this),O(this,ge).setOptions(this.options),r._defaulted&&!qf(this.options,r)&&O(this,tn).getQueryCache().notify({type:"observerOptionsUpdated",query:O(this,ge),observer:this});const o=this.hasListeners();o&&pb(O(this,ge),i,this.options,r)&&le(this,ms,pc).call(this),this.updateResult(n),o&&(O(this,ge)!==i||or(this.options.enabled,O(this,ge))!==or(r.enabled,O(this,ge))||Ba(this.options.staleTime,O(this,ge))!==Ba(r.staleTime,O(this,ge)))&&le(this,Tu,iy).call(this);const s=le(this,_u,oy).call(this);o&&(O(this,ge)!==i||or(this.options.enabled,O(this,ge))!==or(r.enabled,O(this,ge))||s!==O(this,to))&&le(this,Ru,sy).call(this,s)}getOptimisticResult(e){const n=O(this,tn).getQueryCache().build(O(this,tn),e),r=this.createResult(n,e);return zN(this,r)&&(W(this,Bt,r),W(this,nl,this.options),W(this,fs,O(this,ge).state)),r}getCurrentResult(){return O(this,Bt)}trackResult(e,n){const r={};return Object.keys(e).forEach(i=>{Object.defineProperty(r,i,{configurable:!1,enumerable:!0,get:()=>(this.trackProp(i),n==null||n(i),e[i])})}),r}trackProp(e){O(this,ol).add(e)}getCurrentQuery(){return O(this,ge)}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){const n=O(this,tn).defaultQueryOptions(e),r=O(this,tn).getQueryCache().build(O(this,tn),n);return r.fetch().then(()=>this.createResult(r,n))}fetch(e){return le(this,ms,pc).call(this,{...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),O(this,Bt)))}createResult(e,n){var T;const r=O(this,ge),i=this.options,o=O(this,Bt),s=O(this,fs),a=O(this,nl),c=e!==r?e.state:O(this,ku),{state:u}=e;let d={...u},h=!1,p;if(n._optimisticResults){const R=this.hasListeners(),_=!R&&hb(e,n),A=R&&pb(e,r,n,i);(_||A)&&(d={...d,...ME(u.data,e.options)}),n._optimisticResults==="isRestoring"&&(d.fetchStatus="idle")}let{error:g,errorUpdatedAt:y,status:x}=d;if(n.select&&d.data!==void 0)if(o&&d.data===(s==null?void 0:s.data)&&n.select===O(this,Eu))p=O(this,rl);else try{W(this,Eu,n.select),p=n.select(d.data),p=ny(o==null?void 0:o.data,p,n),W(this,rl,p),W(this,Rr,null)}catch(R){W(this,Rr,R)}else p=d.data;if(n.placeholderData!==void 0&&p===void 0&&x==="pending"){let R;if(o!=null&&o.isPlaceholderData&&n.placeholderData===(a==null?void 0:a.placeholderData))R=o.data;else if(R=typeof n.placeholderData=="function"?n.placeholderData((T=O(this,il))==null?void 0:T.state.data,O(this,il)):n.placeholderData,n.select&&R!==void 0)try{R=n.select(R),W(this,Rr,null)}catch(_){W(this,Rr,_)}R!==void 0&&(x="success",p=ny(o==null?void 0:o.data,R,n),h=!0)}O(this,Rr)&&(g=O(this,Rr),p=O(this,rl),y=Date.now(),x="error");const v=d.fetchStatus==="fetching",w=x==="pending",b=x==="error",S=w&&v,C=p!==void 0,E={status:x,fetchStatus:d.fetchStatus,isPending:w,isSuccess:x==="success",isError:b,isInitialLoading:S,isLoading:S,data:p,dataUpdatedAt:d.dataUpdatedAt,error:g,errorUpdatedAt:y,failureCount:d.fetchFailureCount,failureReason:d.fetchFailureReason,errorUpdateCount:d.errorUpdateCount,isFetched:d.dataUpdateCount>0||d.errorUpdateCount>0,isFetchedAfterMount:d.dataUpdateCount>c.dataUpdateCount||d.errorUpdateCount>c.errorUpdateCount,isFetching:v,isRefetching:v&&!w,isLoadingError:b&&!C,isPaused:d.fetchStatus==="paused",isPlaceholderData:h,isRefetchError:b&&C,isStale:k0(e,n),refetch:this.refetch,promise:O(this,eo)};if(this.options.experimental_prefetchInRender){const R=L=>{E.status==="error"?L.reject(E.error):E.data!==void 0&&L.resolve(E.data)},_=()=>{const L=W(this,eo,E.promise=ry());R(L)},A=O(this,eo);switch(A.status){case"pending":e.queryHash===r.queryHash&&R(A);break;case"fulfilled":(E.status==="error"||E.data!==A.value)&&_();break;case"rejected":(E.status!=="error"||E.error!==A.reason)&&_();break}}return E}updateResult(e){const n=O(this,Bt),r=this.createResult(O(this,ge),this.options);if(W(this,fs,O(this,ge).state),W(this,nl,this.options),O(this,fs).data!==void 0&&W(this,il,O(this,ge)),qf(r,n))return;W(this,Bt,r);const i={},o=()=>{if(!n)return!0;const{notifyOnChangeProps:s}=this.options,a=typeof s=="function"?s():s;if(a==="all"||!a&&!O(this,ol).size)return!0;const l=new Set(a??O(this,ol));return this.options.throwOnError&&l.add("error"),Object.keys(O(this,Bt)).some(c=>{const u=c;return O(this,Bt)[u]!==n[u]&&l.has(u)})};(e==null?void 0:e.listeners)!==!1&&o()&&(i.listeners=!0),le(this,Sh,NE).call(this,{...i,...e})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&le(this,Ou,ay).call(this)}},tn=new WeakMap,ge=new WeakMap,ku=new WeakMap,Bt=new WeakMap,fs=new WeakMap,nl=new WeakMap,eo=new WeakMap,Rr=new WeakMap,Eu=new WeakMap,rl=new WeakMap,il=new WeakMap,hs=new WeakMap,ps=new WeakMap,to=new WeakMap,ol=new WeakMap,ms=new WeakSet,pc=function(e){le(this,Iu,uy).call(this);let n=O(this,ge).fetch(this.options,e);return e!=null&&e.throwOnError||(n=n.catch(Mn)),n},Tu=new WeakSet,iy=function(){le(this,Pu,ly).call(this);const e=Ba(this.options.staleTime,O(this,ge));if(Ms||O(this,Bt).isStale||!ey(e))return;const r=kE(O(this,Bt).dataUpdatedAt,e)+1;W(this,hs,setTimeout(()=>{O(this,Bt).isStale||this.updateResult()},r))},_u=new WeakSet,oy=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(O(this,ge)):this.options.refetchInterval)??!1},Ru=new WeakSet,sy=function(e){le(this,Mu,cy).call(this),W(this,to,e),!(Ms||or(this.options.enabled,O(this,ge))===!1||!ey(O(this,to))||O(this,to)===0)&&W(this,ps,setInterval(()=>{(this.options.refetchIntervalInBackground||C0.isFocused())&&le(this,ms,pc).call(this)},O(this,to)))},Ou=new WeakSet,ay=function(){le(this,Tu,iy).call(this),le(this,Ru,sy).call(this,le(this,_u,oy).call(this))},Pu=new WeakSet,ly=function(){O(this,hs)&&(clearTimeout(O(this,hs)),W(this,hs,void 0))},Mu=new WeakSet,cy=function(){O(this,ps)&&(clearInterval(O(this,ps)),W(this,ps,void 0))},Iu=new WeakSet,uy=function(){const e=O(this,tn).getQueryCache().build(O(this,tn),this.options);if(e===O(this,ge))return;const n=O(this,ge);W(this,ge,e),W(this,ku,e.state),this.hasListeners()&&(n==null||n.removeObserver(this),e.addObserver(this))},Sh=new WeakSet,NE=function(e){rt.batch(()=>{e.listeners&&this.listeners.forEach(n=>{n(O(this,Bt))}),O(this,tn).getQueryCache().notify({query:O(this,ge),type:"observerResultsUpdated"})})},JS);function BN(t,e){return or(e.enabled,t)!==!1&&t.state.data===void 0&&!(t.state.status==="error"&&e.retryOnMount===!1)}function hb(t,e){return BN(t,e)||t.state.data!==void 0&&dy(t,e,e.refetchOnMount)}function dy(t,e,n){if(or(e.enabled,t)!==!1){const r=typeof n=="function"?n(t):n;return r==="always"||r!==!1&&k0(t,e)}return!1}function pb(t,e,n,r){return(t!==e||or(r.enabled,t)===!1)&&(!n.suspense||t.state.status!=="error")&&k0(t,n)}function k0(t,e){return or(e.enabled,t)!==!1&&t.isStaleByTime(Ba(e.staleTime,t))}function zN(t,e){return!qf(t.getCurrentResult(),e)}var no,ro,nn,ti,sl,ff,Au,fy,YS,VN=(YS=class extends Fl{constructor(n,r){super();Y(this,sl);Y(this,Au);Y(this,no,void 0);Y(this,ro,void 0);Y(this,nn,void 0);Y(this,ti,void 0);W(this,no,n),this.setOptions(r),this.bindMethods(),le(this,sl,ff).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(n){var i;const r=this.options;this.options=O(this,no).defaultMutationOptions(n),qf(this.options,r)||O(this,no).getMutationCache().notify({type:"observerOptionsUpdated",mutation:O(this,nn),observer:this}),r!=null&&r.mutationKey&&this.options.mutationKey&&Is(r.mutationKey)!==Is(this.options.mutationKey)?this.reset():((i=O(this,nn))==null?void 0:i.state.status)==="pending"&&O(this,nn).setOptions(this.options)}onUnsubscribe(){var n;this.hasListeners()||(n=O(this,nn))==null||n.removeObserver(this)}onMutationUpdate(n){le(this,sl,ff).call(this),le(this,Au,fy).call(this,n)}getCurrentResult(){return O(this,ro)}reset(){var n;(n=O(this,nn))==null||n.removeObserver(this),W(this,nn,void 0),le(this,sl,ff).call(this),le(this,Au,fy).call(this)}mutate(n,r){var i;return W(this,ti,r),(i=O(this,nn))==null||i.removeObserver(this),W(this,nn,O(this,no).getMutationCache().build(O(this,no),this.options)),O(this,nn).addObserver(this),O(this,nn).execute(n)}},no=new WeakMap,ro=new WeakMap,nn=new WeakMap,ti=new WeakMap,sl=new WeakSet,ff=function(){var r;const n=((r=O(this,nn))==null?void 0:r.state)??IE();W(this,ro,{...n,isPending:n.status==="pending",isSuccess:n.status==="success",isError:n.status==="error",isIdle:n.status==="idle",mutate:this.mutate,reset:this.reset})},Au=new WeakSet,fy=function(n){rt.batch(()=>{var r,i,o,s,a,l,c,u;if(O(this,ti)&&this.hasListeners()){const d=O(this,ro).variables,h=O(this,ro).context;(n==null?void 0:n.type)==="success"?((i=(r=O(this,ti)).onSuccess)==null||i.call(r,n.data,d,h),(s=(o=O(this,ti)).onSettled)==null||s.call(o,n.data,null,d,h)):(n==null?void 0:n.type)==="error"&&((l=(a=O(this,ti)).onError)==null||l.call(a,n.error,d,h),(u=(c=O(this,ti)).onSettled)==null||u.call(c,void 0,n.error,d,h))}this.listeners.forEach(d=>{d(O(this,ro))})})},YS),jE=m.createContext(void 0),Hr=t=>{const e=m.useContext(jE);if(t)return t;if(!e)throw new Error("No QueryClient set, use QueryClientProvider to set one");return e},DE=({client:t,children:e})=>(m.useEffect(()=>(t.mount(),()=>{t.unmount()}),[t]),f.jsx(jE.Provider,{value:t,children:e})),LE=m.createContext(!1),UN=()=>m.useContext(LE);LE.Provider;function HN(){let t=!1;return{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t}}var WN=m.createContext(HN()),KN=()=>m.useContext(WN);function $E(t,e){return typeof t=="function"?t(...e):!!t}function hy(){}var qN=(t,e)=>{(t.suspense||t.throwOnError||t.experimental_prefetchInRender)&&(e.isReset()||(t.retryOnMount=!1))},GN=t=>{m.useEffect(()=>{t.clearReset()},[t])},JN=({result:t,errorResetBoundary:e,throwOnError:n,query:r,suspense:i})=>t.isError&&!e.isReset()&&!t.isFetching&&r&&(i&&t.data===void 0||$E(n,[t.error,r])),YN=t=>{const e=t.staleTime;t.suspense&&(t.staleTime=typeof e=="function"?(...n)=>Math.max(e(...n),1e3):Math.max(e??1e3,1e3),typeof t.gcTime=="number"&&(t.gcTime=Math.max(t.gcTime,1e3)))},QN=(t,e)=>t.isLoading&&t.isFetching&&!e,XN=(t,e)=>(t==null?void 0:t.suspense)&&e.isPending,mb=(t,e,n)=>e.fetchOptimistic(t).catch(()=>{n.clearReset()});function ZN(t,e,n){var d,h,p,g,y;const r=Hr(n),i=UN(),o=KN(),s=r.defaultQueryOptions(t);(h=(d=r.getDefaultOptions().queries)==null?void 0:d._experimental_beforeQuery)==null||h.call(d,s),s._optimisticResults=i?"isRestoring":"optimistic",YN(s),qN(s,o),GN(o);const a=!r.getQueryCache().get(s.queryHash),[l]=m.useState(()=>new e(r,s)),c=l.getOptimisticResult(s),u=!i&&t.subscribed!==!1;if(m.useSyncExternalStore(m.useCallback(x=>{const v=u?l.subscribe(rt.batchCalls(x)):hy;return l.updateResult(),v},[l,u]),()=>l.getCurrentResult(),()=>l.getCurrentResult()),m.useEffect(()=>{l.setOptions(s,{listeners:!1})},[s,l]),XN(s,c))throw mb(s,l,o);if(JN({result:c,errorResetBoundary:o,throwOnError:s.throwOnError,query:r.getQueryCache().get(s.queryHash),suspense:s.suspense}))throw c.error;if((g=(p=r.getDefaultOptions().queries)==null?void 0:p._experimental_afterQuery)==null||g.call(p,s,c),s.experimental_prefetchInRender&&!Ms&&QN(c,i)){const x=a?mb(s,l,o):(y=r.getQueryCache().get(s.queryHash))==null?void 0:y.promise;x==null||x.catch(hy).finally(()=>{l.updateResult()})}return s.notifyOnChangeProps?c:l.trackResult(c)}function iu(t,e){return ZN(t,FN,e)}function Mr(t,e){const n=Hr(e),[r]=m.useState(()=>new VN(n,t));m.useEffect(()=>{r.setOptions(t)},[r,t]);const i=m.useSyncExternalStore(m.useCallback(s=>r.subscribe(rt.batchCalls(s)),[r]),()=>r.getCurrentResult(),()=>r.getCurrentResult()),o=m.useCallback((s,a)=>{r.mutate(s,a).catch(hy)},[r]);if(i.error&&$E(r.options.throwOnError,[i.error]))throw i.error;return{...i,mutate:o,mutateAsync:i.mutate}}const ej=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>Ps(()=>Promise.resolve().then(()=>Bl),void 0).then(({default:r})=>r(...n)):e=fetch,(...n)=>e(...n)};class E0 extends Error{constructor(e,n="FunctionsError",r){super(e),this.name=n,this.context=r}}class tj extends E0{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class nj extends E0{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class rj extends E0{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var py;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(py||(py={}));var ij=globalThis&&globalThis.__awaiter||function(t,e,n,r){function i(o){return o instanceof n?o:new n(function(s){s(o)})}return new(n||(n=Promise))(function(o,s){function a(u){try{c(r.next(u))}catch(d){s(d)}}function l(u){try{c(r.throw(u))}catch(d){s(d)}}function c(u){u.done?o(u.value):i(u.value).then(a,l)}c((r=r.apply(t,e||[])).next())})};class oj{constructor(e,{headers:n={},customFetch:r,region:i=py.Any}={}){this.url=e,this.headers=n,this.region=i,this.fetch=ej(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,n={}){var r;return ij(this,void 0,void 0,function*(){try{const{headers:i,method:o,body:s}=n;let a={},{region:l}=n;l||(l=this.region),l&&l!=="any"&&(a["x-region"]=l);let c;s&&(i&&!Object.prototype.hasOwnProperty.call(i,"Content-Type")||!i)&&(typeof Blob<"u"&&s instanceof Blob||s instanceof ArrayBuffer?(a["Content-Type"]="application/octet-stream",c=s):typeof s=="string"?(a["Content-Type"]="text/plain",c=s):typeof FormData<"u"&&s instanceof FormData?c=s:(a["Content-Type"]="application/json",c=JSON.stringify(s)));const u=yield this.fetch(`${this.url}/${e}`,{method:o||"POST",headers:Object.assign(Object.assign(Object.assign({},a),this.headers),i),body:c}).catch(g=>{throw new tj(g)}),d=u.headers.get("x-relay-error");if(d&&d==="true")throw new nj(u);if(!u.ok)throw new rj(u);let h=((r=u.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),p;return h==="application/json"?p=yield u.json():h==="application/octet-stream"?p=yield u.blob():h==="text/event-stream"?p=u:h==="multipart/form-data"?p=yield u.formData():p=yield u.text(),{data:p,error:null}}catch(i){return{data:null,error:i}}})}}var on={},T0={},zh={},zu={},Vh={},Uh={},sj=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},pl=sj();const aj=pl.fetch,FE=pl.fetch.bind(pl),BE=pl.Headers,lj=pl.Request,cj=pl.Response,Bl=Object.freeze(Object.defineProperty({__proto__:null,Headers:BE,Request:lj,Response:cj,default:FE,fetch:aj},Symbol.toStringTag,{value:"Module"})),uj=pM(Bl);var Hh={};Object.defineProperty(Hh,"__esModule",{value:!0});let dj=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}};Hh.default=dj;var zE=Vn&&Vn.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Uh,"__esModule",{value:!0});const fj=zE(uj),hj=zE(Hh);let pj=class{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=fj.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,n){return this.headers=Object.assign({},this.headers),this.headers[e]=n,this}then(e,n){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const r=this.fetch;let i=r(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async o=>{var s,a,l;let c=null,u=null,d=null,h=o.status,p=o.statusText;if(o.ok){if(this.method!=="HEAD"){const v=await o.text();v===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?u=v:u=JSON.parse(v))}const y=(s=this.headers.Prefer)===null||s===void 0?void 0:s.match(/count=(exact|planned|estimated)/),x=(a=o.headers.get("content-range"))===null||a===void 0?void 0:a.split("/");y&&x&&x.length>1&&(d=parseInt(x[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(u)&&(u.length>1?(c={code:"PGRST116",details:`Results contain ${u.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},u=null,d=null,h=406,p="Not Acceptable"):u.length===1?u=u[0]:u=null)}else{const y=await o.text();try{c=JSON.parse(y),Array.isArray(c)&&o.status===404&&(u=[],c=null,h=200,p="OK")}catch{o.status===404&&y===""?(h=204,p="No Content"):c={message:y}}if(c&&this.isMaybeSingle&&(!((l=c==null?void 0:c.details)===null||l===void 0)&&l.includes("0 rows"))&&(c=null,h=200,p="OK"),c&&this.shouldThrowOnError)throw new hj.default(c)}return{error:c,data:u,count:d,status:h,statusText:p}});return this.shouldThrowOnError||(i=i.catch(o=>{var s,a,l;return{error:{message:`${(s=o==null?void 0:o.name)!==null&&s!==void 0?s:"FetchError"}: ${o==null?void 0:o.message}`,details:`${(a=o==null?void 0:o.stack)!==null&&a!==void 0?a:""}`,hint:"",code:`${(l=o==null?void 0:o.code)!==null&&l!==void 0?l:""}`},data:null,count:null,status:0,statusText:""}})),i.then(e,n)}returns(){return this}overrideTypes(){return this}};Uh.default=pj;var mj=Vn&&Vn.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Vh,"__esModule",{value:!0});const gj=mj(Uh);let yj=class extends gj.default{select(e){let n=!1;const r=(e??"*").split("").map(i=>/\s/.test(i)&&!n?"":(i==='"'&&(n=!n),i)).join("");return this.url.searchParams.set("select",r),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:n=!0,nullsFirst:r,foreignTable:i,referencedTable:o=i}={}){const s=o?`${o}.order`:"order",a=this.url.searchParams.get(s);return this.url.searchParams.set(s,`${a?`${a},`:""}${e}.${n?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:n,referencedTable:r=n}={}){const i=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(i,`${e}`),this}range(e,n,{foreignTable:r,referencedTable:i=r}={}){const o=typeof i>"u"?"offset":`${i}.offset`,s=typeof i>"u"?"limit":`${i}.limit`;return this.url.searchParams.set(o,`${e}`),this.url.searchParams.set(s,`${n-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:n=!1,settings:r=!1,buffers:i=!1,wal:o=!1,format:s="text"}={}){var a;const l=[e?"analyze":null,n?"verbose":null,r?"settings":null,i?"buffers":null,o?"wal":null].filter(Boolean).join("|"),c=(a=this.headers.Accept)!==null&&a!==void 0?a:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${s}; for="${c}"; options=${l};`,s==="json"?this:this}rollback(){var e;return((e=this.headers.Prefer)!==null&&e!==void 0?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};Vh.default=yj;var vj=Vn&&Vn.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(zu,"__esModule",{value:!0});const xj=vj(Vh);let wj=class extends xj.default{eq(e,n){return this.url.searchParams.append(e,`eq.${n}`),this}neq(e,n){return this.url.searchParams.append(e,`neq.${n}`),this}gt(e,n){return this.url.searchParams.append(e,`gt.${n}`),this}gte(e,n){return this.url.searchParams.append(e,`gte.${n}`),this}lt(e,n){return this.url.searchParams.append(e,`lt.${n}`),this}lte(e,n){return this.url.searchParams.append(e,`lte.${n}`),this}like(e,n){return this.url.searchParams.append(e,`like.${n}`),this}likeAllOf(e,n){return this.url.searchParams.append(e,`like(all).{${n.join(",")}}`),this}likeAnyOf(e,n){return this.url.searchParams.append(e,`like(any).{${n.join(",")}}`),this}ilike(e,n){return this.url.searchParams.append(e,`ilike.${n}`),this}ilikeAllOf(e,n){return this.url.searchParams.append(e,`ilike(all).{${n.join(",")}}`),this}ilikeAnyOf(e,n){return this.url.searchParams.append(e,`ilike(any).{${n.join(",")}}`),this}is(e,n){return this.url.searchParams.append(e,`is.${n}`),this}in(e,n){const r=Array.from(new Set(n)).map(i=>typeof i=="string"&&new RegExp("[,()]").test(i)?`"${i}"`:`${i}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}contains(e,n){return typeof n=="string"?this.url.searchParams.append(e,`cs.${n}`):Array.isArray(n)?this.url.searchParams.append(e,`cs.{${n.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(n)}`),this}containedBy(e,n){return typeof n=="string"?this.url.searchParams.append(e,`cd.${n}`):Array.isArray(n)?this.url.searchParams.append(e,`cd.{${n.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(n)}`),this}rangeGt(e,n){return this.url.searchParams.append(e,`sr.${n}`),this}rangeGte(e,n){return this.url.searchParams.append(e,`nxl.${n}`),this}rangeLt(e,n){return this.url.searchParams.append(e,`sl.${n}`),this}rangeLte(e,n){return this.url.searchParams.append(e,`nxr.${n}`),this}rangeAdjacent(e,n){return this.url.searchParams.append(e,`adj.${n}`),this}overlaps(e,n){return typeof n=="string"?this.url.searchParams.append(e,`ov.${n}`):this.url.searchParams.append(e,`ov.{${n.join(",")}}`),this}textSearch(e,n,{config:r,type:i}={}){let o="";i==="plain"?o="pl":i==="phrase"?o="ph":i==="websearch"&&(o="w");const s=r===void 0?"":`(${r})`;return this.url.searchParams.append(e,`${o}fts${s}.${n}`),this}match(e){return Object.entries(e).forEach(([n,r])=>{this.url.searchParams.append(n,`eq.${r}`)}),this}not(e,n,r){return this.url.searchParams.append(e,`not.${n}.${r}`),this}or(e,{foreignTable:n,referencedTable:r=n}={}){const i=r?`${r}.or`:"or";return this.url.searchParams.append(i,`(${e})`),this}filter(e,n,r){return this.url.searchParams.append(e,`${n}.${r}`),this}};zu.default=wj;var bj=Vn&&Vn.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(zh,"__esModule",{value:!0});const sc=bj(zu);let Sj=class{constructor(e,{headers:n={},schema:r,fetch:i}){this.url=e,this.headers=n,this.schema=r,this.fetch=i}select(e,{head:n=!1,count:r}={}){const i=n?"HEAD":"GET";let o=!1;const s=(e??"*").split("").map(a=>/\s/.test(a)&&!o?"":(a==='"'&&(o=!o),a)).join("");return this.url.searchParams.set("select",s),r&&(this.headers.Prefer=`count=${r}`),new sc.default({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:n,defaultToNull:r=!0}={}){const i="POST",o=[];if(this.headers.Prefer&&o.push(this.headers.Prefer),n&&o.push(`count=${n}`),r||o.push("missing=default"),this.headers.Prefer=o.join(","),Array.isArray(e)){const s=e.reduce((a,l)=>a.concat(Object.keys(l)),[]);if(s.length>0){const a=[...new Set(s)].map(l=>`"${l}"`);this.url.searchParams.set("columns",a.join(","))}}return new sc.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:n,ignoreDuplicates:r=!1,count:i,defaultToNull:o=!0}={}){const s="POST",a=[`resolution=${r?"ignore":"merge"}-duplicates`];if(n!==void 0&&this.url.searchParams.set("on_conflict",n),this.headers.Prefer&&a.push(this.headers.Prefer),i&&a.push(`count=${i}`),o||a.push("missing=default"),this.headers.Prefer=a.join(","),Array.isArray(e)){const l=e.reduce((c,u)=>c.concat(Object.keys(u)),[]);if(l.length>0){const c=[...new Set(l)].map(u=>`"${u}"`);this.url.searchParams.set("columns",c.join(","))}}return new sc.default({method:s,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:n}={}){const r="PATCH",i=[];return this.headers.Prefer&&i.push(this.headers.Prefer),n&&i.push(`count=${n}`),this.headers.Prefer=i.join(","),new sc.default({method:r,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){const n="DELETE",r=[];return e&&r.push(`count=${e}`),this.headers.Prefer&&r.unshift(this.headers.Prefer),this.headers.Prefer=r.join(","),new sc.default({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};zh.default=Sj;var Wh={},Kh={};Object.defineProperty(Kh,"__esModule",{value:!0});Kh.version=void 0;Kh.version="0.0.0-automated";Object.defineProperty(Wh,"__esModule",{value:!0});Wh.DEFAULT_HEADERS=void 0;const Cj=Kh;Wh.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${Cj.version}`};var VE=Vn&&Vn.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(T0,"__esModule",{value:!0});const kj=VE(zh),Ej=VE(zu),Tj=Wh;let _j=class UE{constructor(e,{headers:n={},schema:r,fetch:i}={}){this.url=e,this.headers=Object.assign(Object.assign({},Tj.DEFAULT_HEADERS),n),this.schemaName=r,this.fetch=i}from(e){const n=new URL(`${this.url}/${e}`);return new kj.default(n,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new UE(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,n={},{head:r=!1,get:i=!1,count:o}={}){let s;const a=new URL(`${this.url}/rpc/${e}`);let l;r||i?(s=r?"HEAD":"GET",Object.entries(n).filter(([u,d])=>d!==void 0).map(([u,d])=>[u,Array.isArray(d)?`{${d.join(",")}}`:`${d}`]).forEach(([u,d])=>{a.searchParams.append(u,d)})):(s="POST",l=n);const c=Object.assign({},this.headers);return o&&(c.Prefer=`count=${o}`),new Ej.default({method:s,url:a,headers:c,schema:this.schemaName,body:l,fetch:this.fetch,allowEmpty:!1})}};T0.default=_j;var zl=Vn&&Vn.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(on,"__esModule",{value:!0});on.PostgrestError=on.PostgrestBuilder=on.PostgrestTransformBuilder=on.PostgrestFilterBuilder=on.PostgrestQueryBuilder=on.PostgrestClient=void 0;const HE=zl(T0);on.PostgrestClient=HE.default;const WE=zl(zh);on.PostgrestQueryBuilder=WE.default;const KE=zl(zu);on.PostgrestFilterBuilder=KE.default;const qE=zl(Vh);on.PostgrestTransformBuilder=qE.default;const GE=zl(Uh);on.PostgrestBuilder=GE.default;const JE=zl(Hh);on.PostgrestError=JE.default;var Rj=on.default={PostgrestClient:HE.default,PostgrestQueryBuilder:WE.default,PostgrestFilterBuilder:KE.default,PostgrestTransformBuilder:qE.default,PostgrestBuilder:GE.default,PostgrestError:JE.default};const{PostgrestClient:Oj,PostgrestQueryBuilder:zW,PostgrestFilterBuilder:VW,PostgrestTransformBuilder:UW,PostgrestBuilder:HW,PostgrestError:WW}=Rj,Pj="2.11.2",Mj={"X-Client-Info":`realtime-js/${Pj}`},Ij="1.0.0",YE=1e4,Aj=1e3;var za;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(za||(za={}));var yn;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(yn||(yn={}));var rr;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(rr||(rr={}));var my;(function(t){t.websocket="websocket"})(my||(my={}));var Qo;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(Qo||(Qo={}));class Nj{constructor(){this.HEADER_LENGTH=1}decode(e,n){return e.constructor===ArrayBuffer?n(this._binaryDecode(e)):n(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const n=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,n,r)}_decodeBroadcast(e,n,r){const i=n.getUint8(1),o=n.getUint8(2);let s=this.HEADER_LENGTH+2;const a=r.decode(e.slice(s,s+i));s=s+i;const l=r.decode(e.slice(s,s+o));s=s+o;const c=JSON.parse(r.decode(e.slice(s,e.byteLength)));return{ref:null,topic:a,event:l,payload:c}}}class QE{constructor(e,n){this.callback=e,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Ie;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(Ie||(Ie={}));const gb=(t,e,n={})=>{var r;const i=(r=n.skipTypes)!==null&&r!==void 0?r:[];return Object.keys(e).reduce((o,s)=>(o[s]=jj(s,t,e,i),o),{})},jj=(t,e,n,r)=>{const i=e.find(a=>a.name===t),o=i==null?void 0:i.type,s=n[t];return o&&!r.includes(o)?XE(o,s):gy(s)},XE=(t,e)=>{if(t.charAt(0)==="_"){const n=t.slice(1,t.length);return Fj(e,n)}switch(t){case Ie.bool:return Dj(e);case Ie.float4:case Ie.float8:case Ie.int2:case Ie.int4:case Ie.int8:case Ie.numeric:case Ie.oid:return Lj(e);case Ie.json:case Ie.jsonb:return $j(e);case Ie.timestamp:return Bj(e);case Ie.abstime:case Ie.date:case Ie.daterange:case Ie.int4range:case Ie.int8range:case Ie.money:case Ie.reltime:case Ie.text:case Ie.time:case Ie.timestamptz:case Ie.timetz:case Ie.tsrange:case Ie.tstzrange:return gy(e);default:return gy(e)}},gy=t=>t,Dj=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},Lj=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},$j=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(e){return console.log(`JSON parse error: ${e}`),t}return t},Fj=(t,e)=>{if(typeof t!="string")return t;const n=t.length-1,r=t[n];if(t[0]==="{"&&r==="}"){let o;const s=t.slice(1,n);try{o=JSON.parse("["+s+"]")}catch{o=s?s.split(","):[]}return o.map(a=>XE(e,a))}return t},Bj=t=>typeof t=="string"?t.replace(" ","T"):t,ZE=t=>{let e=t;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")};class um{constructor(e,n,r={},i=YE){this.channel=e,this.event=n,this.payload=r,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,n){var r;return this._hasReceived(e)&&n((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:e,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:n}){this.recHooks.filter(r=>r.status===e).forEach(r=>r.callback(n))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var yb;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(yb||(yb={}));class Pc{constructor(e,n){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(n==null?void 0:n.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},i=>{const{onJoin:o,onLeave:s,onSync:a}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Pc.syncState(this.state,i,o,s),this.pendingDiffs.forEach(l=>{this.state=Pc.syncDiff(this.state,l,o,s)}),this.pendingDiffs=[],a()}),this.channel._on(r.diff,{},i=>{const{onJoin:o,onLeave:s,onSync:a}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(i):(this.state=Pc.syncDiff(this.state,i,o,s),a())}),this.onJoin((i,o,s)=>{this.channel._trigger("presence",{event:"join",key:i,currentPresences:o,newPresences:s})}),this.onLeave((i,o,s)=>{this.channel._trigger("presence",{event:"leave",key:i,currentPresences:o,leftPresences:s})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,n,r,i){const o=this.cloneDeep(e),s=this.transformState(n),a={},l={};return this.map(o,(c,u)=>{s[c]||(l[c]=u)}),this.map(s,(c,u)=>{const d=o[c];if(d){const h=u.map(x=>x.presence_ref),p=d.map(x=>x.presence_ref),g=u.filter(x=>p.indexOf(x.presence_ref)<0),y=d.filter(x=>h.indexOf(x.presence_ref)<0);g.length>0&&(a[c]=g),y.length>0&&(l[c]=y)}else a[c]=u}),this.syncDiff(o,{joins:a,leaves:l},r,i)}static syncDiff(e,n,r,i){const{joins:o,leaves:s}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return r||(r=()=>{}),i||(i=()=>{}),this.map(o,(a,l)=>{var c;const u=(c=e[a])!==null&&c!==void 0?c:[];if(e[a]=this.cloneDeep(l),u.length>0){const d=e[a].map(p=>p.presence_ref),h=u.filter(p=>d.indexOf(p.presence_ref)<0);e[a].unshift(...h)}r(a,u,l)}),this.map(s,(a,l)=>{let c=e[a];if(!c)return;const u=l.map(d=>d.presence_ref);c=c.filter(d=>u.indexOf(d.presence_ref)<0),e[a]=c,i(a,c,l),c.length===0&&delete e[a]}),e}static map(e,n){return Object.getOwnPropertyNames(e).map(r=>n(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((n,r)=>{const i=e[r];return"metas"in i?n[r]=i.metas.map(o=>(o.presence_ref=o.phx_ref,delete o.phx_ref,delete o.phx_ref_prev,o)):n[r]=i,n},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var vo;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(vo||(vo={}));var vb;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(vb||(vb={}));var Qr;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(Qr||(Qr={}));class _0{constructor(e,n={config:{}},r){this.topic=e,this.params=n,this.socket=r,this.bindings={},this.state=yn.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},n.config),this.timeout=this.socket.timeout,this.joinPush=new um(this,rr.join,this.params,this.timeout),this.rejoinTimer=new QE(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=yn.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(i=>i.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=yn.closed,this.socket._remove(this)}),this._onError(i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=yn.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=yn.errored,this.rejoinTimer.scheduleTimeout())}),this._on(rr.reply,{},(i,o)=>{this._trigger(this._replyEventName(o),i)}),this.presence=new Pc(this),this.broadcastEndpointURL=ZE(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,n=this.timeout){var r,i;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:o,presence:s,private:a}}=this.params;this._onError(u=>e==null?void 0:e(Qr.CHANNEL_ERROR,u)),this._onClose(()=>e==null?void 0:e(Qr.CLOSED));const l={},c={broadcast:o,presence:s,postgres_changes:(i=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(u=>u.filter))!==null&&i!==void 0?i:[],private:a};this.socket.accessTokenValue&&(l.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:c},l)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",async({postgres_changes:u})=>{var d;if(this.socket.setAuth(),u===void 0){e==null||e(Qr.SUBSCRIBED);return}else{const h=this.bindings.postgres_changes,p=(d=h==null?void 0:h.length)!==null&&d!==void 0?d:0,g=[];for(let y=0;y<p;y++){const x=h[y],{filter:{event:v,schema:w,table:b,filter:S}}=x,C=u&&u[y];if(C&&C.event===v&&C.schema===w&&C.table===b&&C.filter===S)g.push(Object.assign(Object.assign({},x),{id:C.id}));else{this.unsubscribe(),e==null||e(Qr.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=g,e&&e(Qr.SUBSCRIBED);return}}).receive("error",u=>{e==null||e(Qr.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(u).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(Qr.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,n={}){return await this.send({type:"presence",event:"track",payload:e},n.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,n,r){return this._on(e,n,r)}async send(e,n={}){var r,i;if(!this._canPush()&&e.type==="broadcast"){const{event:o,payload:s}=e,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:o,payload:s,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(r=n.timeout)!==null&&r!==void 0?r:this.timeout);return await((i=c.body)===null||i===void 0?void 0:i.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(o=>{var s,a,l;const c=this._push(e.type,e,n.timeout||this.timeout);e.type==="broadcast"&&!(!((l=(a=(s=this.params)===null||s===void 0?void 0:s.config)===null||a===void 0?void 0:a.broadcast)===null||l===void 0)&&l.ack)&&o("ok"),c.receive("ok",()=>o("ok")),c.receive("error",()=>o("error")),c.receive("timeout",()=>o("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=yn.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(rr.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(r=>{const i=new um(this,rr.leave,{},e);i.receive("ok",()=>{n(),r("ok")}).receive("timeout",()=>{n(),r("timed out")}).receive("error",()=>{r("error")}),i.send(),this._canPush()||i.trigger("ok",{})})}async _fetchWithTimeout(e,n,r){const i=new AbortController,o=setTimeout(()=>i.abort(),r),s=await this.socket.fetch(e,Object.assign(Object.assign({},n),{signal:i.signal}));return clearTimeout(o),s}_push(e,n,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new um(this,e,n,r);return this._canPush()?i.send():(i.startTimeout(),this.pushBuffer.push(i)),i}_onMessage(e,n,r){return n}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,n,r){var i,o;const s=e.toLocaleLowerCase(),{close:a,error:l,leave:c,join:u}=rr;if(r&&[a,l,c,u].indexOf(s)>=0&&r!==this._joinRef())return;let h=this._onMessage(s,n,r);if(n&&!h)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(s)?(i=this.bindings.postgres_changes)===null||i===void 0||i.filter(p=>{var g,y,x;return((g=p.filter)===null||g===void 0?void 0:g.event)==="*"||((x=(y=p.filter)===null||y===void 0?void 0:y.event)===null||x===void 0?void 0:x.toLocaleLowerCase())===s}).map(p=>p.callback(h,r)):(o=this.bindings[s])===null||o===void 0||o.filter(p=>{var g,y,x,v,w,b;if(["broadcast","presence","postgres_changes"].includes(s))if("id"in p){const S=p.id,C=(g=p.filter)===null||g===void 0?void 0:g.event;return S&&((y=n.ids)===null||y===void 0?void 0:y.includes(S))&&(C==="*"||(C==null?void 0:C.toLocaleLowerCase())===((x=n.data)===null||x===void 0?void 0:x.type.toLocaleLowerCase()))}else{const S=(w=(v=p==null?void 0:p.filter)===null||v===void 0?void 0:v.event)===null||w===void 0?void 0:w.toLocaleLowerCase();return S==="*"||S===((b=n==null?void 0:n.event)===null||b===void 0?void 0:b.toLocaleLowerCase())}else return p.type.toLocaleLowerCase()===s}).map(p=>{if(typeof h=="object"&&"ids"in h){const g=h.data,{schema:y,table:x,commit_timestamp:v,type:w,errors:b}=g;h=Object.assign(Object.assign({},{schema:y,table:x,commit_timestamp:v,eventType:w,new:{},old:{},errors:b}),this._getPayloadRecords(g))}p.callback(h,r)})}_isClosed(){return this.state===yn.closed}_isJoined(){return this.state===yn.joined}_isJoining(){return this.state===yn.joining}_isLeaving(){return this.state===yn.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,n,r){const i=e.toLocaleLowerCase(),o={type:i,filter:n,callback:r};return this.bindings[i]?this.bindings[i].push(o):this.bindings[i]=[o],this}_off(e,n){const r=e.toLocaleLowerCase();return this.bindings[r]=this.bindings[r].filter(i=>{var o;return!(((o=i.type)===null||o===void 0?void 0:o.toLocaleLowerCase())===r&&_0.isEqual(i.filter,n))}),this}static isEqual(e,n){if(Object.keys(e).length!==Object.keys(n).length)return!1;for(const r in e)if(e[r]!==n[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(rr.close,{},e)}_onError(e){this._on(rr.error,{},n=>e(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=yn.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const n={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(n.new=gb(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(n.old=gb(e.columns,e.old_record)),n}}const zj=()=>{},Vj=typeof WebSocket<"u",Uj=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Hj{constructor(e,n){var r;this.accessTokenValue=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=Mj,this.params={},this.timeout=YE,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=zj,this.conn=null,this.sendBuffer=[],this.serializer=new Nj,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=o=>{let s;return o?s=o:typeof fetch>"u"?s=(...a)=>Ps(()=>Promise.resolve().then(()=>Bl),void 0).then(({default:l})=>l(...a)):s=fetch,(...a)=>s(...a)},this.endPoint=`${e}/${my.websocket}`,this.httpEndpoint=ZE(e),n!=null&&n.transport?this.transport=n.transport:this.transport=null,n!=null&&n.params&&(this.params=n.params),n!=null&&n.headers&&(this.headers=Object.assign(Object.assign({},this.headers),n.headers)),n!=null&&n.timeout&&(this.timeout=n.timeout),n!=null&&n.logger&&(this.logger=n.logger),n!=null&&n.heartbeatIntervalMs&&(this.heartbeatIntervalMs=n.heartbeatIntervalMs);const i=(r=n==null?void 0:n.params)===null||r===void 0?void 0:r.apikey;if(i&&(this.accessTokenValue=i,this.apiKey=i),this.reconnectAfterMs=n!=null&&n.reconnectAfterMs?n.reconnectAfterMs:o=>[1e3,2e3,5e3,1e4][o-1]||1e4,this.encode=n!=null&&n.encode?n.encode:(o,s)=>s(JSON.stringify(o)),this.decode=n!=null&&n.decode?n.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new QE(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(n==null?void 0:n.fetch),n!=null&&n.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(n==null?void 0:n.worker)||!1,this.workerUrl=n==null?void 0:n.workerUrl}this.accessToken=(n==null?void 0:n.accessToken)||null}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers});return}if(Vj){this.conn=new WebSocket(this.endpointURL()),this.setupConnection();return}this.conn=new Wj(this.endpointURL(),void 0,{close:()=>{this.conn=null}}),Ps(()=>import("./browser-3b34278c.js").then(e=>e.b),[]).then(({default:e})=>{this.conn=new e(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:Ij}))}disconnect(e,n){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,n??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(e){const n=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const e=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.disconnect(),e}log(e,n,r){this.logger(e,n,r)}connectionState(){switch(this.conn&&this.conn.readyState){case za.connecting:return Qo.Connecting;case za.open:return Qo.Open;case za.closing:return Qo.Closing;default:return Qo.Closed}}isConnected(){return this.connectionState()===Qo.Open}channel(e,n={config:{}}){const r=new _0(`realtime:${e}`,n,this);return this.channels.push(r),r}push(e){const{topic:n,event:r,payload:i,ref:o}=e,s=()=>{this.encode(e,a=>{var l;(l=this.conn)===null||l===void 0||l.send(a)})};this.log("push",`${n} ${r} (${o})`,i),this.isConnected()?s():this.sendBuffer.push(s)}async setAuth(e=null){let n=e||this.accessToken&&await this.accessToken()||this.accessTokenValue;if(n){let r=null;try{r=JSON.parse(atob(n.split(".")[1]))}catch{}if(r&&r.exp&&!(Math.floor(Date.now()/1e3)-r.exp<0))return this.log("auth",`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${r.exp}`),Promise.reject(`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${r.exp}`);this.accessTokenValue=n,this.channels.forEach(i=>{n&&i.updateJoinPayload({access_token:n}),i.joinedOnce&&i._isJoined()&&i._push(rr.access_token,{access_token:n})})}}async sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(e=this.conn)===null||e===void 0||e.close(Aj,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth()}}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let n=this.channels.find(r=>r.topic===e&&(r._isJoined()||r._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${e}"`),n.unsubscribe())}_remove(e){this.channels=this.channels.filter(n=>n._joinRef()!==e._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,n=>{let{topic:r,event:i,payload:o,ref:s}=n;s&&s===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${o.status||""} ${r} ${i} ${s&&"("+s+")"||""}`,o),this.channels.filter(a=>a._isMember(r)).forEach(a=>a._trigger(i,o,s)),this.stateChangeCallbacks.message.forEach(a=>a(n))})}async _onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),!this.worker)this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs);else{this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=n=>{this.log("worker","worker error",n.message),this.workerRef.terminate()},this.workerRef.onmessage=n=>{n.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}this.stateChangeCallbacks.open.forEach(e=>e())}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(n=>n(e))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(n=>n(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(rr.error))}_appendParams(e,n){if(Object.keys(n).length===0)return e;const r=e.match(/\?/)?"&":"?",i=new URLSearchParams(n);return`${e}${r}${i}`}_workerObjectUrl(e){let n;if(e)n=e;else{const r=new Blob([Uj],{type:"application/javascript"});n=URL.createObjectURL(r)}return n}}class Wj{constructor(e,n,r){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=za.connecting,this.send=()=>{},this.url=null,this.url=e,this.close=r.close}}class R0 extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function ot(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class Kj extends R0{constructor(e,n){super(e),this.name="StorageApiError",this.status=n}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class yy extends R0{constructor(e,n){super(e),this.name="StorageUnknownError",this.originalError=n}}var qj=globalThis&&globalThis.__awaiter||function(t,e,n,r){function i(o){return o instanceof n?o:new n(function(s){s(o)})}return new(n||(n=Promise))(function(o,s){function a(u){try{c(r.next(u))}catch(d){s(d)}}function l(u){try{c(r.throw(u))}catch(d){s(d)}}function c(u){u.done?o(u.value):i(u.value).then(a,l)}c((r=r.apply(t,e||[])).next())})};const eT=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>Ps(()=>Promise.resolve().then(()=>Bl),void 0).then(({default:r})=>r(...n)):e=fetch,(...n)=>e(...n)},Gj=()=>qj(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Ps(()=>Promise.resolve().then(()=>Bl),void 0)).Response:Response}),vy=t=>{if(Array.isArray(t))return t.map(n=>vy(n));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([n,r])=>{const i=n.replace(/([-_][a-z])/gi,o=>o.toUpperCase().replace(/[-_]/g,""));e[i]=vy(r)}),e};var Js=globalThis&&globalThis.__awaiter||function(t,e,n,r){function i(o){return o instanceof n?o:new n(function(s){s(o)})}return new(n||(n=Promise))(function(o,s){function a(u){try{c(r.next(u))}catch(d){s(d)}}function l(u){try{c(r.throw(u))}catch(d){s(d)}}function c(u){u.done?o(u.value):i(u.value).then(a,l)}c((r=r.apply(t,e||[])).next())})};const dm=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),Jj=(t,e,n)=>Js(void 0,void 0,void 0,function*(){const r=yield Gj();t instanceof r&&!(n!=null&&n.noResolveJson)?t.json().then(i=>{e(new Kj(dm(i),t.status||500))}).catch(i=>{e(new yy(dm(i),i))}):e(new yy(dm(t),t))}),Yj=(t,e,n,r)=>{const i={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),r&&(i.body=JSON.stringify(r)),Object.assign(Object.assign({},i),n))};function Vu(t,e,n,r,i,o){return Js(this,void 0,void 0,function*(){return new Promise((s,a)=>{t(n,Yj(e,r,i,o)).then(l=>{if(!l.ok)throw l;return r!=null&&r.noResolveJson?l:l.json()}).then(l=>s(l)).catch(l=>Jj(l,a,r))})})}function Jf(t,e,n,r){return Js(this,void 0,void 0,function*(){return Vu(t,"GET",e,n,r)})}function Ii(t,e,n,r,i){return Js(this,void 0,void 0,function*(){return Vu(t,"POST",e,r,i,n)})}function Qj(t,e,n,r,i){return Js(this,void 0,void 0,function*(){return Vu(t,"PUT",e,r,i,n)})}function Xj(t,e,n,r){return Js(this,void 0,void 0,function*(){return Vu(t,"HEAD",e,Object.assign(Object.assign({},n),{noResolveJson:!0}),r)})}function tT(t,e,n,r,i){return Js(this,void 0,void 0,function*(){return Vu(t,"DELETE",e,r,i,n)})}var Xt=globalThis&&globalThis.__awaiter||function(t,e,n,r){function i(o){return o instanceof n?o:new n(function(s){s(o)})}return new(n||(n=Promise))(function(o,s){function a(u){try{c(r.next(u))}catch(d){s(d)}}function l(u){try{c(r.throw(u))}catch(d){s(d)}}function c(u){u.done?o(u.value):i(u.value).then(a,l)}c((r=r.apply(t,e||[])).next())})};const Zj={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},xb={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class eD{constructor(e,n={},r,i){this.url=e,this.headers=n,this.bucketId=r,this.fetch=eT(i)}uploadOrUpdate(e,n,r,i){return Xt(this,void 0,void 0,function*(){try{let o;const s=Object.assign(Object.assign({},xb),i);let a=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(s.upsert)});const l=s.metadata;typeof Blob<"u"&&r instanceof Blob?(o=new FormData,o.append("cacheControl",s.cacheControl),l&&o.append("metadata",this.encodeMetadata(l)),o.append("",r)):typeof FormData<"u"&&r instanceof FormData?(o=r,o.append("cacheControl",s.cacheControl),l&&o.append("metadata",this.encodeMetadata(l))):(o=r,a["cache-control"]=`max-age=${s.cacheControl}`,a["content-type"]=s.contentType,l&&(a["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),i!=null&&i.headers&&(a=Object.assign(Object.assign({},a),i.headers));const c=this._removeEmptyFolders(n),u=this._getFinalPath(c),d=yield this.fetch(`${this.url}/object/${u}`,Object.assign({method:e,body:o,headers:a},s!=null&&s.duplex?{duplex:s.duplex}:{})),h=yield d.json();return d.ok?{data:{path:c,id:h.Id,fullPath:h.Key},error:null}:{data:null,error:h}}catch(o){if(ot(o))return{data:null,error:o};throw o}})}upload(e,n,r){return Xt(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,n,r)})}uploadToSignedUrl(e,n,r,i){return Xt(this,void 0,void 0,function*(){const o=this._removeEmptyFolders(e),s=this._getFinalPath(o),a=new URL(this.url+`/object/upload/sign/${s}`);a.searchParams.set("token",n);try{let l;const c=Object.assign({upsert:xb.upsert},i),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&r instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),l.append("",r)):typeof FormData<"u"&&r instanceof FormData?(l=r,l.append("cacheControl",c.cacheControl)):(l=r,u["cache-control"]=`max-age=${c.cacheControl}`,u["content-type"]=c.contentType);const d=yield this.fetch(a.toString(),{method:"PUT",body:l,headers:u}),h=yield d.json();return d.ok?{data:{path:o,fullPath:h.Key},error:null}:{data:null,error:h}}catch(l){if(ot(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(e,n){return Xt(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e);const i=Object.assign({},this.headers);n!=null&&n.upsert&&(i["x-upsert"]="true");const o=yield Ii(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:i}),s=new URL(this.url+o.url),a=s.searchParams.get("token");if(!a)throw new R0("No token returned by API");return{data:{signedUrl:s.toString(),path:e,token:a},error:null}}catch(r){if(ot(r))return{data:null,error:r};throw r}})}update(e,n,r){return Xt(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,n,r)})}move(e,n,r){return Xt(this,void 0,void 0,function*(){try{return{data:yield Ii(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers}),error:null}}catch(i){if(ot(i))return{data:null,error:i};throw i}})}copy(e,n,r){return Xt(this,void 0,void 0,function*(){try{return{data:{path:(yield Ii(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers})).Key},error:null}}catch(i){if(ot(i))return{data:null,error:i};throw i}})}createSignedUrl(e,n,r){return Xt(this,void 0,void 0,function*(){try{let i=this._getFinalPath(e),o=yield Ii(this.fetch,`${this.url}/object/sign/${i}`,Object.assign({expiresIn:n},r!=null&&r.transform?{transform:r.transform}:{}),{headers:this.headers});const s=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return o={signedUrl:encodeURI(`${this.url}${o.signedURL}${s}`)},{data:o,error:null}}catch(i){if(ot(i))return{data:null,error:i};throw i}})}createSignedUrls(e,n,r){return Xt(this,void 0,void 0,function*(){try{const i=yield Ii(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:n,paths:e},{headers:this.headers}),o=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:i.map(s=>Object.assign(Object.assign({},s),{signedUrl:s.signedURL?encodeURI(`${this.url}${s.signedURL}${o}`):null})),error:null}}catch(i){if(ot(i))return{data:null,error:i};throw i}})}download(e,n){return Xt(this,void 0,void 0,function*(){const i=typeof(n==null?void 0:n.transform)<"u"?"render/image/authenticated":"object",o=this.transformOptsToQueryString((n==null?void 0:n.transform)||{}),s=o?`?${o}`:"";try{const a=this._getFinalPath(e);return{data:yield(yield Jf(this.fetch,`${this.url}/${i}/${a}${s}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(a){if(ot(a))return{data:null,error:a};throw a}})}info(e){return Xt(this,void 0,void 0,function*(){const n=this._getFinalPath(e);try{const r=yield Jf(this.fetch,`${this.url}/object/info/${n}`,{headers:this.headers});return{data:vy(r),error:null}}catch(r){if(ot(r))return{data:null,error:r};throw r}})}exists(e){return Xt(this,void 0,void 0,function*(){const n=this._getFinalPath(e);try{return yield Xj(this.fetch,`${this.url}/object/${n}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(ot(r)&&r instanceof yy){const i=r.originalError;if([400,404].includes(i==null?void 0:i.status))return{data:!1,error:r}}throw r}})}getPublicUrl(e,n){const r=this._getFinalPath(e),i=[],o=n!=null&&n.download?`download=${n.download===!0?"":n.download}`:"";o!==""&&i.push(o);const a=typeof(n==null?void 0:n.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((n==null?void 0:n.transform)||{});l!==""&&i.push(l);let c=i.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${a}/public/${r}${c}`)}}}remove(e){return Xt(this,void 0,void 0,function*(){try{return{data:yield tT(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(n){if(ot(n))return{data:null,error:n};throw n}})}list(e,n,r){return Xt(this,void 0,void 0,function*(){try{const i=Object.assign(Object.assign(Object.assign({},Zj),n),{prefix:e||""});return{data:yield Ii(this.fetch,`${this.url}/object/list/${this.bucketId}`,i,{headers:this.headers},r),error:null}}catch(i){if(ot(i))return{data:null,error:i};throw i}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const n=[];return e.width&&n.push(`width=${e.width}`),e.height&&n.push(`height=${e.height}`),e.resize&&n.push(`resize=${e.resize}`),e.format&&n.push(`format=${e.format}`),e.quality&&n.push(`quality=${e.quality}`),n.join("&")}}const tD="2.7.1",nD={"X-Client-Info":`storage-js/${tD}`};var ia=globalThis&&globalThis.__awaiter||function(t,e,n,r){function i(o){return o instanceof n?o:new n(function(s){s(o)})}return new(n||(n=Promise))(function(o,s){function a(u){try{c(r.next(u))}catch(d){s(d)}}function l(u){try{c(r.throw(u))}catch(d){s(d)}}function c(u){u.done?o(u.value):i(u.value).then(a,l)}c((r=r.apply(t,e||[])).next())})};class rD{constructor(e,n={},r){this.url=e,this.headers=Object.assign(Object.assign({},nD),n),this.fetch=eT(r)}listBuckets(){return ia(this,void 0,void 0,function*(){try{return{data:yield Jf(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(ot(e))return{data:null,error:e};throw e}})}getBucket(e){return ia(this,void 0,void 0,function*(){try{return{data:yield Jf(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(n){if(ot(n))return{data:null,error:n};throw n}})}createBucket(e,n={public:!1}){return ia(this,void 0,void 0,function*(){try{return{data:yield Ii(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(ot(r))return{data:null,error:r};throw r}})}updateBucket(e,n){return ia(this,void 0,void 0,function*(){try{return{data:yield Qj(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(ot(r))return{data:null,error:r};throw r}})}emptyBucket(e){return ia(this,void 0,void 0,function*(){try{return{data:yield Ii(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(n){if(ot(n))return{data:null,error:n};throw n}})}deleteBucket(e){return ia(this,void 0,void 0,function*(){try{return{data:yield tT(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(n){if(ot(n))return{data:null,error:n};throw n}})}}class iD extends rD{constructor(e,n={},r){super(e,n,r)}from(e){return new eD(this.url,this.headers,e,this.fetch)}}const oD="2.49.1";let mc="";typeof Deno<"u"?mc="deno":typeof document<"u"?mc="web":typeof navigator<"u"&&navigator.product==="ReactNative"?mc="react-native":mc="node";const sD={"X-Client-Info":`supabase-js-${mc}/${oD}`},aD={headers:sD},lD={schema:"public"},cD={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},uD={};var dD=globalThis&&globalThis.__awaiter||function(t,e,n,r){function i(o){return o instanceof n?o:new n(function(s){s(o)})}return new(n||(n=Promise))(function(o,s){function a(u){try{c(r.next(u))}catch(d){s(d)}}function l(u){try{c(r.throw(u))}catch(d){s(d)}}function c(u){u.done?o(u.value):i(u.value).then(a,l)}c((r=r.apply(t,e||[])).next())})};const fD=t=>{let e;return t?e=t:typeof fetch>"u"?e=FE:e=fetch,(...n)=>e(...n)},hD=()=>typeof Headers>"u"?BE:Headers,pD=(t,e,n)=>{const r=fD(n),i=hD();return(o,s)=>dD(void 0,void 0,void 0,function*(){var a;const l=(a=yield e())!==null&&a!==void 0?a:t;let c=new i(s==null?void 0:s.headers);return c.has("apikey")||c.set("apikey",t),c.has("Authorization")||c.set("Authorization",`Bearer ${l}`),r(o,Object.assign(Object.assign({},s),{headers:c}))})};var mD=globalThis&&globalThis.__awaiter||function(t,e,n,r){function i(o){return o instanceof n?o:new n(function(s){s(o)})}return new(n||(n=Promise))(function(o,s){function a(u){try{c(r.next(u))}catch(d){s(d)}}function l(u){try{c(r.throw(u))}catch(d){s(d)}}function c(u){u.done?o(u.value):i(u.value).then(a,l)}c((r=r.apply(t,e||[])).next())})};function gD(t){return t.replace(/\/$/,"")}function yD(t,e){const{db:n,auth:r,realtime:i,global:o}=t,{db:s,auth:a,realtime:l,global:c}=e,u={db:Object.assign(Object.assign({},s),n),auth:Object.assign(Object.assign({},a),r),realtime:Object.assign(Object.assign({},l),i),global:Object.assign(Object.assign({},c),o),accessToken:()=>mD(this,void 0,void 0,function*(){return""})};return t.accessToken?u.accessToken=t.accessToken:delete u.accessToken,u}const nT="2.68.0",ma=30*1e3,xy=3,fm=xy*ma,vD="http://localhost:9999",xD="supabase.auth.token",wD={"X-Client-Info":`gotrue-js/${nT}`},wy="X-Supabase-Api-Version",rT={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}};function bD(t){return Math.round(Date.now()/1e3)+t}function SD(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const e=Math.random()*16|0;return(t=="x"?e:e&3|8).toString(16)})}const Cr=()=>typeof window<"u"&&typeof document<"u",Wo={tested:!1,writable:!1},Mc=()=>{if(!Cr())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Wo.tested)return Wo.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),Wo.tested=!0,Wo.writable=!0}catch{Wo.tested=!0,Wo.writable=!1}return Wo.writable};function CD(t){const e={},n=new URL(t);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((i,o)=>{e[o]=i})}catch{}return n.searchParams.forEach((r,i)=>{e[i]=r}),e}const iT=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>Ps(()=>Promise.resolve().then(()=>Bl),void 0).then(({default:r})=>r(...n)):e=fetch,(...n)=>e(...n)},kD=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",oT=async(t,e,n)=>{await t.setItem(e,JSON.stringify(n))},_d=async(t,e)=>{const n=await t.getItem(e);if(!n)return null;try{return JSON.parse(n)}catch{return n}},Rd=async(t,e)=>{await t.removeItem(e)};function ED(t){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let n="",r,i,o,s,a,l,c,u=0;for(t=t.replace("-","+").replace("_","/");u<t.length;)s=e.indexOf(t.charAt(u++)),a=e.indexOf(t.charAt(u++)),l=e.indexOf(t.charAt(u++)),c=e.indexOf(t.charAt(u++)),r=s<<2|a>>4,i=(a&15)<<4|l>>2,o=(l&3)<<6|c,n=n+String.fromCharCode(r),l!=64&&i!=0&&(n=n+String.fromCharCode(i)),c!=64&&o!=0&&(n=n+String.fromCharCode(o));return n}class qh{constructor(){this.promise=new qh.promiseConstructor((e,n)=>{this.resolve=e,this.reject=n})}}qh.promiseConstructor=Promise;function wb(t){const e=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}=?$|[a-z0-9_-]{2}(==)?$)$/i,n=t.split(".");if(n.length!==3)throw new Error("JWT is not valid: not a JWT structure");if(!e.test(n[1]))throw new Error("JWT is not valid: payload is not in base64url format");const r=n[1];return JSON.parse(ED(r))}async function TD(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function _D(t,e){return new Promise((r,i)=>{(async()=>{for(let o=0;o<1/0;o++)try{const s=await t(o);if(!e(o,null,s)){r(s);return}}catch(s){if(!e(o,s)){i(s);return}}})()})}function RD(t){return("0"+t.toString(16)).substr(-2)}function OD(){const e=new Uint32Array(56);if(typeof crypto>"u"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=n.length;let i="";for(let o=0;o<56;o++)i+=n.charAt(Math.floor(Math.random()*r));return i}return crypto.getRandomValues(e),Array.from(e,RD).join("")}async function PD(t){const n=new TextEncoder().encode(t),r=await crypto.subtle.digest("SHA-256",n),i=new Uint8Array(r);return Array.from(i).map(o=>String.fromCharCode(o)).join("")}function MD(t){return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function ID(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const n=await PD(t);return MD(n)}async function oa(t,e,n=!1){const r=OD();let i=r;n&&(i+="/PASSWORD_RECOVERY"),await oT(t,`${e}-code-verifier`,i);const o=await ID(r);return[o,r===o?"plain":"s256"]}const AD=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function ND(t){const e=t.headers.get(wy);if(!e||!e.match(AD))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}class O0 extends Error{constructor(e,n,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=n,this.code=r}}function ce(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class jD extends O0{constructor(e,n,r){super(e,n,r),this.name="AuthApiError",this.status=n,this.code=r}}function DD(t){return ce(t)&&t.name==="AuthApiError"}class sT extends O0{constructor(e,n){super(e),this.name="AuthUnknownError",this.originalError=n}}class Ys extends O0{constructor(e,n,r,i){super(e,r,i),this.name=n,this.status=r}}class Ti extends Ys{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function LD(t){return ce(t)&&t.name==="AuthSessionMissingError"}class hm extends Ys{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Od extends Ys{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Pd extends Ys{constructor(e,n=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function $D(t){return ce(t)&&t.name==="AuthImplicitGrantRedirectError"}class bb extends Ys{constructor(e,n=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class by extends Ys{constructor(e,n){super(e,"AuthRetryableFetchError",n,void 0)}}function pm(t){return ce(t)&&t.name==="AuthRetryableFetchError"}class Sb extends Ys{constructor(e,n,r){super(e,"AuthWeakPasswordError",n,"weak_password"),this.reasons=r}}var FD=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};const Jo=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),BD=[502,503,504];async function Cb(t){var e;if(!kD(t))throw new by(Jo(t),0);if(BD.includes(t.status))throw new by(Jo(t),t.status);let n;try{n=await t.json()}catch(o){throw new sT(Jo(o),o)}let r;const i=ND(t);if(i&&i.getTime()>=rT["2024-01-01"].timestamp&&typeof n=="object"&&n&&typeof n.code=="string"?r=n.code:typeof n=="object"&&n&&typeof n.error_code=="string"&&(r=n.error_code),r){if(r==="weak_password")throw new Sb(Jo(n),t.status,((e=n.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(r==="session_not_found")throw new Ti}else if(typeof n=="object"&&n&&typeof n.weak_password=="object"&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((o,s)=>o&&typeof s=="string",!0))throw new Sb(Jo(n),t.status,n.weak_password.reasons);throw new jD(Jo(n),t.status||500,r)}const zD=(t,e,n,r)=>{const i={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),i.body=JSON.stringify(r),Object.assign(Object.assign({},i),n))};async function ye(t,e,n,r){var i;const o=Object.assign({},r==null?void 0:r.headers);o[wy]||(o[wy]=rT["2024-01-01"].name),r!=null&&r.jwt&&(o.Authorization=`Bearer ${r.jwt}`);const s=(i=r==null?void 0:r.query)!==null&&i!==void 0?i:{};r!=null&&r.redirectTo&&(s.redirect_to=r.redirectTo);const a=Object.keys(s).length?"?"+new URLSearchParams(s).toString():"",l=await VD(t,e,n+a,{headers:o,noResolveJson:r==null?void 0:r.noResolveJson},{},r==null?void 0:r.body);return r!=null&&r.xform?r==null?void 0:r.xform(l):{data:Object.assign({},l),error:null}}async function VD(t,e,n,r,i,o){const s=zD(e,r,i,o);let a;try{a=await t(n,Object.assign({},s))}catch(l){throw console.error(l),new by(Jo(l),0)}if(a.ok||await Cb(a),r!=null&&r.noResolveJson)return a;try{return await a.json()}catch(l){await Cb(l)}}function _i(t){var e;let n=null;KD(t)&&(n=Object.assign({},t),t.expires_at||(n.expires_at=bD(t.expires_in)));const r=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:n,user:r},error:null}}function kb(t){const e=_i(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((n,r)=>n&&typeof r=="string",!0)&&(e.data.weak_password=t.weak_password),e}function qi(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function UD(t){return{data:t,error:null}}function HD(t){const{action_link:e,email_otp:n,hashed_token:r,redirect_to:i,verification_type:o}=t,s=FD(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),a={action_link:e,email_otp:n,hashed_token:r,redirect_to:i,verification_type:o},l=Object.assign({},s);return{data:{properties:a,user:l},error:null}}function WD(t){return t}function KD(t){return t.access_token&&t.refresh_token&&t.expires_in}var qD=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};class GD{constructor({url:e="",headers:n={},fetch:r}){this.url=e,this.headers=n,this.fetch=iT(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,n="global"){try{return await ye(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(ce(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,n={}){try{return await ye(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:qi})}catch(r){if(ce(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:n}=e,r=qD(e,["options"]),i=Object.assign(Object.assign({},r),n);return"newEmail"in r&&(i.new_email=r==null?void 0:r.newEmail,delete i.newEmail),await ye(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:HD,redirectTo:n==null?void 0:n.redirectTo})}catch(n){if(ce(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(e){try{return await ye(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:qi})}catch(n){if(ce(n))return{data:{user:null},error:n};throw n}}async listUsers(e){var n,r,i,o,s,a,l;try{const c={nextPage:null,lastPage:0,total:0},u=await ye(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(n=e==null?void 0:e.page)===null||n===void 0?void 0:n.toString())!==null&&r!==void 0?r:"",per_page:(o=(i=e==null?void 0:e.perPage)===null||i===void 0?void 0:i.toString())!==null&&o!==void 0?o:""},xform:WD});if(u.error)throw u.error;const d=await u.json(),h=(s=u.headers.get("x-total-count"))!==null&&s!==void 0?s:0,p=(l=(a=u.headers.get("link"))===null||a===void 0?void 0:a.split(","))!==null&&l!==void 0?l:[];return p.length>0&&(p.forEach(g=>{const y=parseInt(g.split(";")[0].split("=")[1].substring(0,1)),x=JSON.parse(g.split(";")[1].split("=")[1]);c[`${x}Page`]=y}),c.total=parseInt(h)),{data:Object.assign(Object.assign({},d),c),error:null}}catch(c){if(ce(c))return{data:{users:[]},error:c};throw c}}async getUserById(e){try{return await ye(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:qi})}catch(n){if(ce(n))return{data:{user:null},error:n};throw n}}async updateUserById(e,n){try{return await ye(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:n,headers:this.headers,xform:qi})}catch(r){if(ce(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,n=!1){try{return await ye(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:n},xform:qi})}catch(r){if(ce(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){try{const{data:n,error:r}=await ye(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:i=>({data:{factors:i},error:null})});return{data:n,error:r}}catch(n){if(ce(n))return{data:null,error:n};throw n}}async _deleteFactor(e){try{return{data:await ye(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(n){if(ce(n))return{data:null,error:n};throw n}}}const JD={getItem:t=>Mc()?globalThis.localStorage.getItem(t):null,setItem:(t,e)=>{Mc()&&globalThis.localStorage.setItem(t,e)},removeItem:t=>{Mc()&&globalThis.localStorage.removeItem(t)}};function Eb(t={}){return{getItem:e=>t[e]||null,setItem:(e,n)=>{t[e]=n},removeItem:e=>{delete t[e]}}}function YD(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const sa={debug:!!(globalThis&&Mc()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class aT extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class QD extends aT{}async function XD(t,e,n){sa.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const r=new globalThis.AbortController;return e>0&&setTimeout(()=>{r.abort(),sa.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async i=>{if(i){sa.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,i.name);try{return await n()}finally{sa.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,i.name)}}else{if(e===0)throw sa.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new QD(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(sa.debug)try{const o=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(o,null,"  "))}catch(o){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",o)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}}))}YD();const ZD={url:vD,storageKey:xD,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:wD,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Tb(t,e,n){return await n()}class ou{constructor(e){var n,r;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=ou.nextInstanceID,ou.nextInstanceID+=1,this.instanceID>0&&Cr()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const i=Object.assign(Object.assign({},ZD),e);if(this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.persistSession=i.persistSession,this.storageKey=i.storageKey,this.autoRefreshToken=i.autoRefreshToken,this.admin=new GD({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=iT(i.fetch),this.lock=i.lock||Tb,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,i.lock?this.lock=i.lock:Cr()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=XD:this.lock=Tb,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?i.storage?this.storage=i.storage:Mc()?this.storage=JD:(this.memoryStorage={},this.storage=Eb(this.memoryStorage)):(this.memoryStorage={},this.storage=Eb(this.memoryStorage)),Cr()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(o){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",o)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async o=>{this._debug("received broadcast notification from other tab or client",o),await this._notifyAllSubscribers(o.data.event,o.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${nT}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const n=CD(window.location.href);let r="none";if(this._isImplicitGrantCallback(n)?r="implicit":await this._isPKCECallback(n)&&(r="pkce"),Cr()&&this.detectSessionInUrl&&r!=="none"){const{data:i,error:o}=await this._getSessionFromURL(n,r);if(o){if(this._debug("#_initialize()","error detecting session from URL",o),$D(o)){const l=(e=o.details)===null||e===void 0?void 0:e.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:o}}return await this._removeSession(),{error:o}}const{session:s,redirectType:a}=i;return this._debug("#_initialize()","detected session in URL",s,"redirect type",a),await this._saveSession(s),setTimeout(async()=>{a==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",s):await this._notifyAllSubscribers("SIGNED_IN",s)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(n){return ce(n)?{error:n}:{error:new sT("Unexpected error during initialization",n)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var n,r,i;try{const o=await ye(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(n=e==null?void 0:e.options)===null||n===void 0?void 0:n.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(i=e==null?void 0:e.options)===null||i===void 0?void 0:i.captchaToken}},xform:_i}),{data:s,error:a}=o;if(a||!s)return{data:{user:null,session:null},error:a};const l=s.session,c=s.user;return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(o){if(ce(o))return{data:{user:null,session:null},error:o};throw o}}async signUp(e){var n,r,i;try{let o;if("email"in e){const{email:u,password:d,options:h}=e;let p=null,g=null;this.flowType==="pkce"&&([p,g]=await oa(this.storage,this.storageKey)),o=await ye(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:h==null?void 0:h.emailRedirectTo,body:{email:u,password:d,data:(n=h==null?void 0:h.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken},code_challenge:p,code_challenge_method:g},xform:_i})}else if("phone"in e){const{phone:u,password:d,options:h}=e;o=await ye(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:d,data:(r=h==null?void 0:h.data)!==null&&r!==void 0?r:{},channel:(i=h==null?void 0:h.channel)!==null&&i!==void 0?i:"sms",gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}},xform:_i})}else throw new Od("You must provide either an email or phone number and a password");const{data:s,error:a}=o;if(a||!s)return{data:{user:null,session:null},error:a};const l=s.session,c=s.user;return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(o){if(ce(o))return{data:{user:null,session:null},error:o};throw o}}async signInWithPassword(e){try{let n;if("email"in e){const{email:o,password:s,options:a}=e;n=await ye(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:o,password:s,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:kb})}else if("phone"in e){const{phone:o,password:s,options:a}=e;n=await ye(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:o,password:s,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:kb})}else throw new Od("You must provide either an email or phone number and a password");const{data:r,error:i}=n;return i?{data:{user:null,session:null},error:i}:!r||!r.session||!r.user?{data:{user:null,session:null},error:new hm}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:i})}catch(n){if(ce(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOAuth(e){var n,r,i,o;return await this._handleProviderSignIn(e.provider,{redirectTo:(n=e.options)===null||n===void 0?void 0:n.redirectTo,scopes:(r=e.options)===null||r===void 0?void 0:r.scopes,queryParams:(i=e.options)===null||i===void 0?void 0:i.queryParams,skipBrowserRedirect:(o=e.options)===null||o===void 0?void 0:o.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async _exchangeCodeForSession(e){const n=await _d(this.storage,`${this.storageKey}-code-verifier`),[r,i]=(n??"").split("/");try{const{data:o,error:s}=await ye(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:_i});if(await Rd(this.storage,`${this.storageKey}-code-verifier`),s)throw s;return!o||!o.session||!o.user?{data:{user:null,session:null,redirectType:null},error:new hm}:(o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",o.session)),{data:Object.assign(Object.assign({},o),{redirectType:i??null}),error:s})}catch(o){if(ce(o))return{data:{user:null,session:null,redirectType:null},error:o};throw o}}async signInWithIdToken(e){try{const{options:n,provider:r,token:i,access_token:o,nonce:s}=e,a=await ye(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:i,access_token:o,nonce:s,gotrue_meta_security:{captcha_token:n==null?void 0:n.captchaToken}},xform:_i}),{data:l,error:c}=a;return c?{data:{user:null,session:null},error:c}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new hm}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:c})}catch(n){if(ce(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOtp(e){var n,r,i,o,s;try{if("email"in e){const{email:a,options:l}=e;let c=null,u=null;this.flowType==="pkce"&&([c,u]=await oa(this.storage,this.storageKey));const{error:d}=await ye(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:a,data:(n=l==null?void 0:l.data)!==null&&n!==void 0?n:{},create_user:(r=l==null?void 0:l.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:c,code_challenge_method:u},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:d}}if("phone"in e){const{phone:a,options:l}=e,{data:c,error:u}=await ye(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:a,data:(i=l==null?void 0:l.data)!==null&&i!==void 0?i:{},create_user:(o=l==null?void 0:l.shouldCreateUser)!==null&&o!==void 0?o:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(s=l==null?void 0:l.channel)!==null&&s!==void 0?s:"sms"}});return{data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:u}}throw new Od("You must provide either an email or phone number.")}catch(a){if(ce(a))return{data:{user:null,session:null},error:a};throw a}}async verifyOtp(e){var n,r;try{let i,o;"options"in e&&(i=(n=e.options)===null||n===void 0?void 0:n.redirectTo,o=(r=e.options)===null||r===void 0?void 0:r.captchaToken);const{data:s,error:a}=await ye(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:o}}),redirectTo:i,xform:_i});if(a)throw a;if(!s)throw new Error("An error occurred on token verification.");const l=s.session,c=s.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(i){if(ce(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithSSO(e){var n,r,i;try{let o=null,s=null;return this.flowType==="pkce"&&([o,s]=await oa(this.storage,this.storageKey)),await ye(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(r=(n=e.options)===null||n===void 0?void 0:n.redirectTo)!==null&&r!==void 0?r:void 0}),!((i=e==null?void 0:e.options)===null||i===void 0)&&i.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:o,code_challenge_method:s}),headers:this.headers,xform:UD})}catch(o){if(ce(o))return{data:null,error:o};throw o}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:n},error:r}=e;if(r)throw r;if(!n)throw new Ti;const{error:i}=await ye(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return{data:{user:null,session:null},error:i}})}catch(e){if(ce(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const n=`${this.url}/resend`;if("email"in e){const{email:r,type:i,options:o}=e,{error:s}=await ye(this.fetch,"POST",n,{headers:this.headers,body:{email:r,type:i,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},redirectTo:o==null?void 0:o.emailRedirectTo});return{data:{user:null,session:null},error:s}}else if("phone"in e){const{phone:r,type:i,options:o}=e,{data:s,error:a}=await ye(this.fetch,"POST",n,{headers:this.headers,body:{phone:r,type:i,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}}});return{data:{user:null,session:null,messageId:s==null?void 0:s.message_id},error:a}}throw new Od("You must provide either an email or phone number and a type")}catch(n){if(ce(n))return{data:{user:null,session:null},error:n};throw n}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async n=>n))}async _acquireLock(e,n){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),i=(async()=>(await r,await n()))();return this.pendingInLock.push((async()=>{try{await i}catch{}})()),i}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=n();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const i=[...this.pendingInLock];await Promise.all(i),this.pendingInLock.splice(0,i.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await e(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const n=await _d(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?e=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=e.expires_at?e.expires_at*1e3-Date.now()<fm:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.storage.isServer){let s=this.suppressGetSessionWarning;e=new Proxy(e,{get:(l,c,u)=>(!s&&c==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),s=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,c,u))})}return{data:{session:e},error:null}}const{session:i,error:o}=await this._callRefreshToken(e.refresh_token);return o?{data:{session:null},error:o}:{data:{session:i},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await ye(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:qi}):await this._useSession(async n=>{var r,i,o;const{data:s,error:a}=n;if(a)throw a;return!(!((r=s.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Ti}:await ye(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(o=(i=s.session)===null||i===void 0?void 0:i.access_token)!==null&&o!==void 0?o:void 0,xform:qi})})}catch(n){if(ce(n))return LD(n)&&(await this._removeSession(),await Rd(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:n};throw n}}async updateUser(e,n={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,n))}async _updateUser(e,n={}){try{return await this._useSession(async r=>{const{data:i,error:o}=r;if(o)throw o;if(!i.session)throw new Ti;const s=i.session;let a=null,l=null;this.flowType==="pkce"&&e.email!=null&&([a,l]=await oa(this.storage,this.storageKey));const{data:c,error:u}=await ye(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n==null?void 0:n.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:a,code_challenge_method:l}),jwt:s.access_token,xform:qi});if(u)throw u;return s.user=c.user,await this._saveSession(s),await this._notifyAllSubscribers("USER_UPDATED",s),{data:{user:s.user},error:null}})}catch(r){if(ce(r))return{data:{user:null},error:r};throw r}}_decodeJWT(e){return wb(e)}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Ti;const n=Date.now()/1e3;let r=n,i=!0,o=null;const s=wb(e.access_token);if(s.exp&&(r=s.exp,i=r<=n),i){const{session:a,error:l}=await this._callRefreshToken(e.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!a)return{data:{user:null,session:null},error:null};o=a}else{const{data:a,error:l}=await this._getUser(e.access_token);if(l)throw l;o={access_token:e.access_token,refresh_token:e.refresh_token,user:a.user,token_type:"bearer",expires_in:r-n,expires_at:r},await this._saveSession(o),await this._notifyAllSubscribers("SIGNED_IN",o)}return{data:{user:o.user,session:o},error:null}}catch(n){if(ce(n))return{data:{session:null,user:null},error:n};throw n}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async n=>{var r;if(!e){const{data:s,error:a}=n;if(a)throw a;e=(r=s.session)!==null&&r!==void 0?r:void 0}if(!(e!=null&&e.refresh_token))throw new Ti;const{session:i,error:o}=await this._callRefreshToken(e.refresh_token);return o?{data:{user:null,session:null},error:o}:i?{data:{user:i.user,session:i},error:null}:{data:{user:null,session:null},error:null}})}catch(n){if(ce(n))return{data:{user:null,session:null},error:n};throw n}}async _getSessionFromURL(e,n){try{if(!Cr())throw new Pd("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Pd(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(n){case"implicit":if(this.flowType==="pkce")throw new bb("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Pd("Not a valid implicit grant flow url.");break;default:}if(n==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new bb("No code detected.");const{data:w,error:b}=await this._exchangeCodeForSession(e.code);if(b)throw b;const S=new URL(window.location.href);return S.searchParams.delete("code"),window.history.replaceState(window.history.state,"",S.toString()),{data:{session:w.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:i,access_token:o,refresh_token:s,expires_in:a,expires_at:l,token_type:c}=e;if(!o||!a||!s||!c)throw new Pd("No session defined in URL");const u=Math.round(Date.now()/1e3),d=parseInt(a);let h=u+d;l&&(h=parseInt(l));const p=h-u;p*1e3<=ma&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${p}s, should have been closer to ${d}s`);const g=h-d;u-g>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",g,h,u):u-g<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",g,h,u);const{data:y,error:x}=await this._getUser(o);if(x)throw x;const v={provider_token:r,provider_refresh_token:i,access_token:o,expires_in:d,expires_at:h,refresh_token:s,token_type:c,user:y.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:v,redirectType:e.type},error:null}}catch(r){if(ce(r))return{data:{session:null,redirectType:null},error:r};throw r}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const n=await _d(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&n)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async n=>{var r;const{data:i,error:o}=n;if(o)return{error:o};const s=(r=i.session)===null||r===void 0?void 0:r.access_token;if(s){const{error:a}=await this.admin.signOut(s,e);if(a&&!(DD(a)&&(a.status===404||a.status===401||a.status===403)))return{error:a}}return e!=="others"&&(await this._removeSession(),await Rd(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const n=SD(),r={id:n,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async n=>{var r,i;try{const{data:{session:o},error:s}=n;if(s)throw s;await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",o)),this._debug("INITIAL_SESSION","callback id",e,"session",o)}catch(o){await((i=this.stateChangeEmitters.get(e))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",o),console.error(o)}})}async resetPasswordForEmail(e,n={}){let r=null,i=null;this.flowType==="pkce"&&([r,i]=await oa(this.storage,this.storageKey,!0));try{return await ye(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:i,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(o){if(ce(o))return{data:null,error:o};throw o}}async getUserIdentities(){var e;try{const{data:n,error:r}=await this.getUser();if(r)throw r;return{data:{identities:(e=n.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(n){if(ce(n))return{data:null,error:n};throw n}}async linkIdentity(e){var n;try{const{data:r,error:i}=await this._useSession(async o=>{var s,a,l,c,u;const{data:d,error:h}=o;if(h)throw h;const p=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(s=e.options)===null||s===void 0?void 0:s.redirectTo,scopes:(a=e.options)===null||a===void 0?void 0:a.scopes,queryParams:(l=e.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await ye(this.fetch,"GET",p,{headers:this.headers,jwt:(u=(c=d.session)===null||c===void 0?void 0:c.access_token)!==null&&u!==void 0?u:void 0})});if(i)throw i;return Cr()&&!(!((n=e.options)===null||n===void 0)&&n.skipBrowserRedirect)&&window.location.assign(r==null?void 0:r.url),{data:{provider:e.provider,url:r==null?void 0:r.url},error:null}}catch(r){if(ce(r))return{data:{provider:e.provider,url:null},error:r};throw r}}async unlinkIdentity(e){try{return await this._useSession(async n=>{var r,i;const{data:o,error:s}=n;if(s)throw s;return await ye(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(i=(r=o.session)===null||r===void 0?void 0:r.access_token)!==null&&i!==void 0?i:void 0})})}catch(n){if(ce(n))return{data:null,error:n};throw n}}async _refreshAccessToken(e){const n=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{const r=Date.now();return await _D(async i=>(i>0&&await TD(200*Math.pow(2,i-1)),this._debug(n,"refreshing attempt",i),await ye(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:_i})),(i,o)=>{const s=200*Math.pow(2,i);return o&&pm(o)&&Date.now()+s-r<ma})}catch(r){if(this._debug(n,"error",r),ce(r))return{data:{session:null,user:null},error:r};throw r}finally{this._debug(n,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,n){const r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",n,"url",r),Cr()&&!n.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const r=await _d(this.storage,this.storageKey);if(this._debug(n,"session from storage",r),!this._isValidSession(r)){this._debug(n,"session is not valid"),r!==null&&await this._removeSession();return}const i=((e=r.expires_at)!==null&&e!==void 0?e:1/0)*1e3-Date.now()<fm;if(this._debug(n,`session has${i?"":" not"} expired with margin of ${fm}s`),i){if(this.autoRefreshToken&&r.refresh_token){const{error:o}=await this._callRefreshToken(r.refresh_token);o&&(console.error(o),pm(o)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",r)}catch(r){this._debug(n,"error",r),console.error(r);return}finally{this._debug(n,"end")}}async _callRefreshToken(e){var n,r;if(!e)throw new Ti;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const i=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(i,"begin");try{this.refreshingDeferred=new qh;const{data:o,error:s}=await this._refreshAccessToken(e);if(s)throw s;if(!o.session)throw new Ti;await this._saveSession(o.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",o.session);const a={session:o.session,error:null};return this.refreshingDeferred.resolve(a),a}catch(o){if(this._debug(i,"error",o),ce(o)){const s={session:null,error:o};return pm(o)||await this._removeSession(),(n=this.refreshingDeferred)===null||n===void 0||n.resolve(s),s}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(o),o}finally{this.refreshingDeferred=null,this._debug(i,"end")}}async _notifyAllSubscribers(e,n,r=!0){const i=`#_notifyAllSubscribers(${e})`;this._debug(i,"begin",n,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:n});const o=[],s=Array.from(this.stateChangeEmitters.values()).map(async a=>{try{await a.callback(e,n)}catch(l){o.push(l)}});if(await Promise.all(s),o.length>0){for(let a=0;a<o.length;a+=1)console.error(o[a]);throw o[0]}}finally{this._debug(i,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await oT(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await Rd(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Cr()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(n){console.error("removing visibilitychange callback failed",n)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),ma);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async n=>{const{data:{session:r}}=n;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const i=Math.floor((r.expires_at*1e3-e)/ma);this._debug("#_autoRefreshTokenTick()",`access token expires in ${i} ticks, a tick lasts ${ma}ms, refresh threshold is ${xy} ticks`),i<=xy&&await this._callRefreshToken(r.refresh_token)})}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof aT)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Cr()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const n=`#_onVisibilityChanged(${e})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,n,r){const i=[`provider=${encodeURIComponent(n)}`];if(r!=null&&r.redirectTo&&i.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r!=null&&r.scopes&&i.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[o,s]=await oa(this.storage,this.storageKey),a=new URLSearchParams({code_challenge:`${encodeURIComponent(o)}`,code_challenge_method:`${encodeURIComponent(s)}`});i.push(a.toString())}if(r!=null&&r.queryParams){const o=new URLSearchParams(r.queryParams);i.push(o.toString())}return r!=null&&r.skipBrowserRedirect&&i.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${i.join("&")}`}async _unenroll(e){try{return await this._useSession(async n=>{var r;const{data:i,error:o}=n;return o?{data:null,error:o}:await ye(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token})})}catch(n){if(ce(n))return{data:null,error:n};throw n}}async _enroll(e){try{return await this._useSession(async n=>{var r,i;const{data:o,error:s}=n;if(s)return{data:null,error:s};const a=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:l,error:c}=await ye(this.fetch,"POST",`${this.url}/factors`,{body:a,headers:this.headers,jwt:(r=o==null?void 0:o.session)===null||r===void 0?void 0:r.access_token});return c?{data:null,error:c}:(e.factorType==="totp"&&(!((i=l==null?void 0:l.totp)===null||i===void 0)&&i.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(n){if(ce(n))return{data:null,error:n};throw n}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var r;const{data:i,error:o}=n;if(o)return{data:null,error:o};const{data:s,error:a}=await ye(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token});return a?{data:null,error:a}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+s.expires_in},s)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",s),{data:s,error:a})})}catch(n){if(ce(n))return{data:null,error:n};throw n}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var r;const{data:i,error:o}=n;return o?{data:null,error:o}:await ye(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token})})}catch(n){if(ce(n))return{data:null,error:n};throw n}})}async _challengeAndVerify(e){const{data:n,error:r}=await this._challenge({factorId:e.factorId});return r?{data:null,error:r}:await this._verify({factorId:e.factorId,challengeId:n.id,code:e.code})}async _listFactors(){const{data:{user:e},error:n}=await this.getUser();if(n)return{data:null,error:n};const r=(e==null?void 0:e.factors)||[],i=r.filter(s=>s.factor_type==="totp"&&s.status==="verified"),o=r.filter(s=>s.factor_type==="phone"&&s.status==="verified");return{data:{all:r,totp:i,phone:o},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var n,r;const{data:{session:i},error:o}=e;if(o)return{data:null,error:o};if(!i)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const s=this._decodeJWT(i.access_token);let a=null;s.aal&&(a=s.aal);let l=a;((r=(n=i.user.factors)===null||n===void 0?void 0:n.filter(d=>d.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(l="aal2");const u=s.amr||[];return{data:{currentLevel:a,nextLevel:l,currentAuthenticationMethods:u},error:null}}))}}ou.nextInstanceID=0;const eL=ou;class tL extends eL{constructor(e){super(e)}}var nL=globalThis&&globalThis.__awaiter||function(t,e,n,r){function i(o){return o instanceof n?o:new n(function(s){s(o)})}return new(n||(n=Promise))(function(o,s){function a(u){try{c(r.next(u))}catch(d){s(d)}}function l(u){try{c(r.throw(u))}catch(d){s(d)}}function c(u){u.done?o(u.value):i(u.value).then(a,l)}c((r=r.apply(t,e||[])).next())})};class rL{constructor(e,n,r){var i,o,s;if(this.supabaseUrl=e,this.supabaseKey=n,!e)throw new Error("supabaseUrl is required.");if(!n)throw new Error("supabaseKey is required.");const a=gD(e);this.realtimeUrl=`${a}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${a}/auth/v1`,this.storageUrl=`${a}/storage/v1`,this.functionsUrl=`${a}/functions/v1`;const l=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,c={db:lD,realtime:uD,auth:Object.assign(Object.assign({},cD),{storageKey:l}),global:aD},u=yD(r??{},c);this.storageKey=(i=u.auth.storageKey)!==null&&i!==void 0?i:"",this.headers=(o=u.global.headers)!==null&&o!==void 0?o:{},u.accessToken?(this.accessToken=u.accessToken,this.auth=new Proxy({},{get:(d,h)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(h)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((s=u.auth)!==null&&s!==void 0?s:{},this.headers,u.global.fetch),this.fetch=pD(n,this._getAccessToken.bind(this),u.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},u.realtime)),this.rest=new Oj(`${a}/rest/v1`,{headers:this.headers,schema:u.db.schema,fetch:this.fetch}),u.accessToken||this._listenForAuthEvents()}get functions(){return new oj(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new iD(this.storageUrl,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,n={},r={}){return this.rest.rpc(e,n,r)}channel(e,n={config:{}}){return this.realtime.channel(e,n)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,n;return nL(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:r}=yield this.auth.getSession();return(n=(e=r.session)===null||e===void 0?void 0:e.access_token)!==null&&n!==void 0?n:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:n,detectSessionInUrl:r,storage:i,storageKey:o,flowType:s,lock:a,debug:l},c,u){const d={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new tL({url:this.authUrl,headers:Object.assign(Object.assign({},d),c),storageKey:o,autoRefreshToken:e,persistSession:n,detectSessionInUrl:r,storage:i,flowType:s,lock:a,debug:l,fetch:u,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new Hj(this.realtimeUrl,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((n,r)=>{this._handleTokenChanged(n,"CLIENT",r==null?void 0:r.access_token)})}_handleTokenChanged(e,n,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?this.changedAccessToken=r:e==="SIGNED_OUT"&&(this.realtime.setAuth(),n=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const iL=(t,e,n)=>new rL(t,e,n);function oL(){const t="production";return{apiUrl:"https://api.eastmedical.ai",wsUrl:{}.VITE_WS_URL||"ws://localhost:3000",supabaseUrl:"https://apnxgktdaiqoesqyseiz.supabase.co",supabaseAnonKey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFwbnhna3RkYWlxb2VzcXlzZWl6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDExMzQxNjEsImV4cCI6MjA1NjcxMDE2MX0.XhGhD7ESMUFhZso3wY_ee_WHGWde5v748qFDAhgSQ04",environment:t}}const Fr=oL(),Ut=iL(Fr.supabaseUrl,Fr.supabaseAnonKey,{realtime:{params:{eventsPerSecond:10}},auth:{persistSession:!0,autoRefreshToken:!0}});function Qe(){return Ut}const lT=m.createContext(void 0);function sL({children:t}){const e=Qe(),[n,r]=m.useState(void 0),[i,o]=m.useState(!0),s=Hr();m.useEffect(()=>{e.auth.getSession().then(({data:{session:d}})=>{r((d==null?void 0:d.user)??void 0),o(!1)});const{data:{subscription:u}}=e.auth.onAuthStateChange((d,h)=>{r((h==null?void 0:h.user)??void 0),d==="SIGNED_OUT"&&s.clear()});return()=>{u.unsubscribe()}},[e,s]);const c={user:n,loading:i,signIn:async(u,d)=>{const{data:h,error:p}=await e.auth.signInWithPassword({email:u,password:d});if(p)throw p;return h},signOut:async()=>{const{error:u}=await e.auth.signOut();if(u)throw u;s.clear()}};return f.jsx(lT.Provider,{value:c,children:t})}const bi={container:{display:"flex",gap:"24px",height:"100%"},transcriptPanel:{flex:1,display:"flex",flexDirection:"column",backgroundColor:"white",borderRadius:"6px",border:"1px solid #e5e7eb",padding:"16px",overflow:"auto"},contextPanel:{flex:1,display:"flex",flexDirection:"column",backgroundColor:"white",borderRadius:"6px",border:"1px solid #e5e7eb",padding:"16px",overflow:"auto"},text:{fontSize:"16px",color:"#374151",lineHeight:"1.5",whiteSpace:"pre-wrap",margin:0},contentContainer:{display:"flex",flexDirection:"column",height:"100%"},contextTitle:{fontSize:"18px",fontWeight:600,color:"#111827",marginBottom:"12px"},contextContent:{fontSize:"16px",lineHeight:"1.5",color:"#374151",whiteSpace:"pre-wrap",flex:1}};function aL({transcription:t="",placeholder:e="Your transcription will appear here as you speak...",isTranscribing:n,visit:r,aiContextNote:i}){const[o,s]=m.useState(""),a=m.useRef([]),l=m.useRef(null),c=m.useRef(0),u=m.useRef(t),d=m.useCallback(()=>{l.current&&(window.clearTimeout(l.current),l.current=null)},[]);m.useEffect(()=>{s(""),a.current=[],c.current=0,u.current="",d()},[r==null?void 0:r.id,d]);const h=m.useCallback((y,x)=>{const v=100+Math.random()*100,w=Math.min(y.length*10,100),b=/[,.!?]$/.test(y)?200:0,S=Math.max(.7,1-x/200);return(v+w+b)*S},[]),p=m.useCallback(()=>{const y=a.current;if(y.length>0){const x=y[0];if(a.current=y.slice(1),c.current+=1,s(v=>{const w=v.length>0&&!/[\s\u4e00-\u9fff]$/.test(v)&&!/^[\u4e00-\u9fff]/.test(x);return v+(w?" ":"")+x}),a.current.length>0){const v=h(x,c.current);d(),l.current=window.setTimeout(p,v)}else d()}},[h,d]),g=m.useCallback(y=>{if(!y)return[];const v=y.replace(/([\u4e00-\u9fff])/g," $1 ").split(/\s+/).filter(Boolean),w=[];for(const b of v)if(/[\u4e00-\u9fff]/.test(b)){const S=b.split("");w.push(...S)}else w.push(b);return w},[]);return m.useEffect(()=>{if(!n){s(t),d();return}if(t===u.current)return;if(u.current=t,!t){console.log("[LiveTranscriptionDisplay] Resetting display - no transcription"),s(""),a.current=[],c.current=0,d();return}const y=g(t);if(y.length<c.current){console.log("[LiveTranscriptionDisplay] Reset detected"),d(),s(t),a.current=[],c.current=y.length;return}if(y.length>c.current){console.log("[LiveTranscriptionDisplay] New words detected:",{newWordsCount:y.length-c.current});const x=y.slice(c.current);a.current=x,l.current||p()}},[t,n,d,g,p]),m.useEffect(()=>()=>{d()},[d]),f.jsxs("div",{style:bi.container,children:[f.jsxs("div",{style:bi.transcriptPanel,children:[f.jsx("div",{style:bi.contextTitle,children:"Transcript"}),f.jsx("div",{style:bi.contentContainer,children:f.jsx("p",{style:bi.text,children:o||t||e})})]}),f.jsxs("div",{style:bi.contextPanel,children:[f.jsx("div",{style:bi.contextTitle,children:"Context"}),f.jsx("div",{style:bi.contextContent,children:(i==null?void 0:i.content)||"No context available yet..."})]})]})}function K(t,e,{checkForDefaultPrevented:n=!0}={}){return function(i){if(t==null||t(i),n===!1||!i.defaultPrevented)return e==null?void 0:e(i)}}function _b(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function Gh(...t){return e=>{let n=!1;const r=t.map(i=>{const o=_b(i,e);return!n&&typeof o=="function"&&(n=!0),o});if(n)return()=>{for(let i=0;i<r.length;i++){const o=r[i];typeof o=="function"?o():_b(t[i],null)}}}}function Se(...t){return m.useCallback(Gh(...t),t)}function lL(t,e){const n=m.createContext(e),r=o=>{const{children:s,...a}=o,l=m.useMemo(()=>a,Object.values(a));return f.jsx(n.Provider,{value:l,children:s})};r.displayName=t+"Provider";function i(o){const s=m.useContext(n);if(s)return s;if(e!==void 0)return e;throw new Error(`\`${o}\` must be used within \`${t}\``)}return[r,i]}function yi(t,e=[]){let n=[];function r(o,s){const a=m.createContext(s),l=n.length;n=[...n,s];const c=d=>{var v;const{scope:h,children:p,...g}=d,y=((v=h==null?void 0:h[t])==null?void 0:v[l])||a,x=m.useMemo(()=>g,Object.values(g));return f.jsx(y.Provider,{value:x,children:p})};c.displayName=o+"Provider";function u(d,h){var y;const p=((y=h==null?void 0:h[t])==null?void 0:y[l])||a,g=m.useContext(p);if(g)return g;if(s!==void 0)return s;throw new Error(`\`${d}\` must be used within \`${o}\``)}return[c,u]}const i=()=>{const o=n.map(s=>m.createContext(s));return function(a){const l=(a==null?void 0:a[t])||o;return m.useMemo(()=>({[`__scope${t}`]:{...a,[t]:l}}),[a,l])}};return i.scopeName=t,[r,cL(i,...e)]}function cL(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const r=t.map(i=>({useScope:i(),scopeName:i.scopeName}));return function(o){const s=r.reduce((a,{useScope:l,scopeName:c})=>{const d=l(o)[`__scope${c}`];return{...a,...d}},{});return m.useMemo(()=>({[`__scope${e.scopeName}`]:s}),[s])}};return n.scopeName=e.scopeName,n}var Mt=globalThis!=null&&globalThis.document?m.useLayoutEffect:()=>{},uL=PM["useId".toString()]||(()=>{}),dL=0;function Dr(t){const[e,n]=m.useState(uL());return Mt(()=>{t||n(r=>r??String(dL++))},[t]),t||(e?`radix-${e}`:"")}function It(t){const e=m.useRef(t);return m.useEffect(()=>{e.current=t}),m.useMemo(()=>(...n)=>{var r;return(r=e.current)==null?void 0:r.call(e,...n)},[])}function As({prop:t,defaultProp:e,onChange:n=()=>{}}){const[r,i]=fL({defaultProp:e,onChange:n}),o=t!==void 0,s=o?t:r,a=It(n),l=m.useCallback(c=>{if(o){const d=typeof c=="function"?c(t):c;d!==t&&a(d)}else i(c)},[o,t,i,a]);return[s,l]}function fL({defaultProp:t,onChange:e}){const n=m.useState(t),[r]=n,i=m.useRef(r),o=It(e);return m.useEffect(()=>{i.current!==r&&(o(r),i.current=r)},[r,i,o]),n}var _o=m.forwardRef((t,e)=>{const{children:n,...r}=t,i=m.Children.toArray(n),o=i.find(pL);if(o){const s=o.props.children,a=i.map(l=>l===o?m.Children.count(s)>1?m.Children.only(null):m.isValidElement(s)?s.props.children:null:l);return f.jsx(Sy,{...r,ref:e,children:m.isValidElement(s)?m.cloneElement(s,void 0,a):null})}return f.jsx(Sy,{...r,ref:e,children:n})});_o.displayName="Slot";var Sy=m.forwardRef((t,e)=>{const{children:n,...r}=t;if(m.isValidElement(n)){const i=gL(n),o=mL(r,n.props);return n.type!==m.Fragment&&(o.ref=e?Gh(e,i):i),m.cloneElement(n,o)}return m.Children.count(n)>1?m.Children.only(null):null});Sy.displayName="SlotClone";var hL=({children:t})=>f.jsx(f.Fragment,{children:t});function pL(t){return m.isValidElement(t)&&t.type===hL}function mL(t,e){const n={...e};for(const r in e){const i=t[r],o=e[r];/^on[A-Z]/.test(r)?i&&o?n[r]=(...a)=>{o(...a),i(...a)}:i&&(n[r]=i):r==="style"?n[r]={...i,...o}:r==="className"&&(n[r]=[i,o].filter(Boolean).join(" "))}return{...t,...n}}function gL(t){var r,i;let e=(r=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(i=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:i.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}var yL=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],se=yL.reduce((t,e)=>{const n=m.forwardRef((r,i)=>{const{asChild:o,...s}=r,a=o?_o:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),f.jsx(a,{...s,ref:i})});return n.displayName=`Primitive.${e}`,{...t,[e]:n}},{});function P0(t,e){t&&Gs.flushSync(()=>t.dispatchEvent(e))}function vL(t,e=globalThis==null?void 0:globalThis.document){const n=It(t);m.useEffect(()=>{const r=i=>{i.key==="Escape"&&n(i)};return e.addEventListener("keydown",r,{capture:!0}),()=>e.removeEventListener("keydown",r,{capture:!0})},[n,e])}var xL="DismissableLayer",Cy="dismissableLayer.update",wL="dismissableLayer.pointerDownOutside",bL="dismissableLayer.focusOutside",Rb,cT=m.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Vl=m.forwardRef((t,e)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:i,onFocusOutside:o,onInteractOutside:s,onDismiss:a,...l}=t,c=m.useContext(cT),[u,d]=m.useState(null),h=(u==null?void 0:u.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,p]=m.useState({}),g=Se(e,E=>d(E)),y=Array.from(c.layers),[x]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),v=y.indexOf(x),w=u?y.indexOf(u):-1,b=c.layersWithOutsidePointerEventsDisabled.size>0,S=w>=v,C=CL(E=>{const T=E.target,R=[...c.branches].some(_=>_.contains(T));!S||R||(i==null||i(E),s==null||s(E),E.defaultPrevented||a==null||a())},h),k=kL(E=>{const T=E.target;[...c.branches].some(_=>_.contains(T))||(o==null||o(E),s==null||s(E),E.defaultPrevented||a==null||a())},h);return vL(E=>{w===c.layers.size-1&&(r==null||r(E),!E.defaultPrevented&&a&&(E.preventDefault(),a()))},h),m.useEffect(()=>{if(u)return n&&(c.layersWithOutsidePointerEventsDisabled.size===0&&(Rb=h.body.style.pointerEvents,h.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(u)),c.layers.add(u),Ob(),()=>{n&&c.layersWithOutsidePointerEventsDisabled.size===1&&(h.body.style.pointerEvents=Rb)}},[u,h,n,c]),m.useEffect(()=>()=>{u&&(c.layers.delete(u),c.layersWithOutsidePointerEventsDisabled.delete(u),Ob())},[u,c]),m.useEffect(()=>{const E=()=>p({});return document.addEventListener(Cy,E),()=>document.removeEventListener(Cy,E)},[]),f.jsx(se.div,{...l,ref:g,style:{pointerEvents:b?S?"auto":"none":void 0,...t.style},onFocusCapture:K(t.onFocusCapture,k.onFocusCapture),onBlurCapture:K(t.onBlurCapture,k.onBlurCapture),onPointerDownCapture:K(t.onPointerDownCapture,C.onPointerDownCapture)})});Vl.displayName=xL;var SL="DismissableLayerBranch",uT=m.forwardRef((t,e)=>{const n=m.useContext(cT),r=m.useRef(null),i=Se(e,r);return m.useEffect(()=>{const o=r.current;if(o)return n.branches.add(o),()=>{n.branches.delete(o)}},[n.branches]),f.jsx(se.div,{...t,ref:i})});uT.displayName=SL;function CL(t,e=globalThis==null?void 0:globalThis.document){const n=It(t),r=m.useRef(!1),i=m.useRef(()=>{});return m.useEffect(()=>{const o=a=>{if(a.target&&!r.current){let l=function(){dT(wL,n,c,{discrete:!0})};const c={originalEvent:a};a.pointerType==="touch"?(e.removeEventListener("click",i.current),i.current=l,e.addEventListener("click",i.current,{once:!0})):l()}else e.removeEventListener("click",i.current);r.current=!1},s=window.setTimeout(()=>{e.addEventListener("pointerdown",o)},0);return()=>{window.clearTimeout(s),e.removeEventListener("pointerdown",o),e.removeEventListener("click",i.current)}},[e,n]),{onPointerDownCapture:()=>r.current=!0}}function kL(t,e=globalThis==null?void 0:globalThis.document){const n=It(t),r=m.useRef(!1);return m.useEffect(()=>{const i=o=>{o.target&&!r.current&&dT(bL,n,{originalEvent:o},{discrete:!1})};return e.addEventListener("focusin",i),()=>e.removeEventListener("focusin",i)},[e,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function Ob(){const t=new CustomEvent(Cy);document.dispatchEvent(t)}function dT(t,e,n,{discrete:r}){const i=n.originalEvent.target,o=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:n});e&&i.addEventListener(t,e,{once:!0}),r?P0(i,o):i.dispatchEvent(o)}var EL=Vl,TL=uT,mm="focusScope.autoFocusOnMount",gm="focusScope.autoFocusOnUnmount",Pb={bubbles:!1,cancelable:!0},_L="FocusScope",Uu=m.forwardRef((t,e)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:i,onUnmountAutoFocus:o,...s}=t,[a,l]=m.useState(null),c=It(i),u=It(o),d=m.useRef(null),h=Se(e,y=>l(y)),p=m.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;m.useEffect(()=>{if(r){let y=function(b){if(p.paused||!a)return;const S=b.target;a.contains(S)?d.current=S:Ri(d.current,{select:!0})},x=function(b){if(p.paused||!a)return;const S=b.relatedTarget;S!==null&&(a.contains(S)||Ri(d.current,{select:!0}))},v=function(b){if(document.activeElement===document.body)for(const C of b)C.removedNodes.length>0&&Ri(a)};document.addEventListener("focusin",y),document.addEventListener("focusout",x);const w=new MutationObserver(v);return a&&w.observe(a,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",y),document.removeEventListener("focusout",x),w.disconnect()}}},[r,a,p.paused]),m.useEffect(()=>{if(a){Ib.add(p);const y=document.activeElement;if(!a.contains(y)){const v=new CustomEvent(mm,Pb);a.addEventListener(mm,c),a.dispatchEvent(v),v.defaultPrevented||(RL(AL(fT(a)),{select:!0}),document.activeElement===y&&Ri(a))}return()=>{a.removeEventListener(mm,c),setTimeout(()=>{const v=new CustomEvent(gm,Pb);a.addEventListener(gm,u),a.dispatchEvent(v),v.defaultPrevented||Ri(y??document.body,{select:!0}),a.removeEventListener(gm,u),Ib.remove(p)},0)}}},[a,c,u,p]);const g=m.useCallback(y=>{if(!n&&!r||p.paused)return;const x=y.key==="Tab"&&!y.altKey&&!y.ctrlKey&&!y.metaKey,v=document.activeElement;if(x&&v){const w=y.currentTarget,[b,S]=OL(w);b&&S?!y.shiftKey&&v===S?(y.preventDefault(),n&&Ri(b,{select:!0})):y.shiftKey&&v===b&&(y.preventDefault(),n&&Ri(S,{select:!0})):v===w&&y.preventDefault()}},[n,r,p.paused]);return f.jsx(se.div,{tabIndex:-1,...s,ref:h,onKeyDown:g})});Uu.displayName=_L;function RL(t,{select:e=!1}={}){const n=document.activeElement;for(const r of t)if(Ri(r,{select:e}),document.activeElement!==n)return}function OL(t){const e=fT(t),n=Mb(e,t),r=Mb(e.reverse(),t);return[n,r]}function fT(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const i=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||i?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function Mb(t,e){for(const n of t)if(!PL(n,{upTo:e}))return n}function PL(t,{upTo:e}){if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(e!==void 0&&t===e)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1}function ML(t){return t instanceof HTMLInputElement&&"select"in t}function Ri(t,{select:e=!1}={}){if(t&&t.focus){const n=document.activeElement;t.focus({preventScroll:!0}),t!==n&&ML(t)&&e&&t.select()}}var Ib=IL();function IL(){let t=[];return{add(e){const n=t[0];e!==n&&(n==null||n.pause()),t=Ab(t,e),t.unshift(e)},remove(e){var n;t=Ab(t,e),(n=t[0])==null||n.resume()}}}function Ab(t,e){const n=[...t],r=n.indexOf(e);return r!==-1&&n.splice(r,1),n}function AL(t){return t.filter(e=>e.tagName!=="A")}var NL="Portal",Ul=m.forwardRef((t,e)=>{var a;const{container:n,...r}=t,[i,o]=m.useState(!1);Mt(()=>o(!0),[]);const s=n||i&&((a=globalThis==null?void 0:globalThis.document)==null?void 0:a.body);return s?uE.createPortal(f.jsx(se.div,{...r,ref:e}),s):null});Ul.displayName=NL;function jL(t,e){return m.useReducer((n,r)=>e[n][r]??n,t)}var yr=t=>{const{present:e,children:n}=t,r=DL(e),i=typeof n=="function"?n({present:r.isPresent}):m.Children.only(n),o=Se(r.ref,LL(i));return typeof n=="function"||r.isPresent?m.cloneElement(i,{ref:o}):null};yr.displayName="Presence";function DL(t){const[e,n]=m.useState(),r=m.useRef({}),i=m.useRef(t),o=m.useRef("none"),s=t?"mounted":"unmounted",[a,l]=jL(s,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return m.useEffect(()=>{const c=Md(r.current);o.current=a==="mounted"?c:"none"},[a]),Mt(()=>{const c=r.current,u=i.current;if(u!==t){const h=o.current,p=Md(c);t?l("MOUNT"):p==="none"||(c==null?void 0:c.display)==="none"?l("UNMOUNT"):l(u&&h!==p?"ANIMATION_OUT":"UNMOUNT"),i.current=t}},[t,l]),Mt(()=>{if(e){let c;const u=e.ownerDocument.defaultView??window,d=p=>{const y=Md(r.current).includes(p.animationName);if(p.target===e&&y&&(l("ANIMATION_END"),!i.current)){const x=e.style.animationFillMode;e.style.animationFillMode="forwards",c=u.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=x)})}},h=p=>{p.target===e&&(o.current=Md(r.current))};return e.addEventListener("animationstart",h),e.addEventListener("animationcancel",d),e.addEventListener("animationend",d),()=>{u.clearTimeout(c),e.removeEventListener("animationstart",h),e.removeEventListener("animationcancel",d),e.removeEventListener("animationend",d)}}else l("ANIMATION_END")},[e,l]),{isPresent:["mounted","unmountSuspended"].includes(a),ref:m.useCallback(c=>{c&&(r.current=getComputedStyle(c)),n(c)},[])}}function Md(t){return(t==null?void 0:t.animationName)||"none"}function LL(t){var r,i;let e=(r=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(i=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:i.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}var ym=0;function Jh(){m.useEffect(()=>{const t=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",t[0]??Nb()),document.body.insertAdjacentElement("beforeend",t[1]??Nb()),ym++,()=>{ym===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),ym--}},[])}function Nb(){const t=document.createElement("span");return t.setAttribute("data-radix-focus-guard",""),t.tabIndex=0,t.style.outline="none",t.style.opacity="0",t.style.position="fixed",t.style.pointerEvents="none",t}var Ir=function(){return Ir=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},Ir.apply(this,arguments)};function hT(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n}function $L(t,e,n){if(n||arguments.length===2)for(var r=0,i=e.length,o;r<i;r++)(o||!(r in e))&&(o||(o=Array.prototype.slice.call(e,0,r)),o[r]=e[r]);return t.concat(o||Array.prototype.slice.call(e))}var hf="right-scroll-bar-position",pf="width-before-scroll-bar",FL="with-scroll-bars-hidden",BL="--removed-body-scroll-bar-size";function vm(t,e){return typeof t=="function"?t(e):t&&(t.current=e),t}function zL(t,e){var n=m.useState(function(){return{value:t,callback:e,facade:{get current(){return n.value},set current(r){var i=n.value;i!==r&&(n.value=r,n.callback(r,i))}}}})[0];return n.callback=e,n.facade}var VL=typeof window<"u"?m.useLayoutEffect:m.useEffect,jb=new WeakMap;function UL(t,e){var n=zL(e||null,function(r){return t.forEach(function(i){return vm(i,r)})});return VL(function(){var r=jb.get(n);if(r){var i=new Set(r),o=new Set(t),s=n.current;i.forEach(function(a){o.has(a)||vm(a,null)}),o.forEach(function(a){i.has(a)||vm(a,s)})}jb.set(n,t)},[t]),n}function HL(t){return t}function WL(t,e){e===void 0&&(e=HL);var n=[],r=!1,i={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:t},useMedium:function(o){var s=e(o,r);return n.push(s),function(){n=n.filter(function(a){return a!==s})}},assignSyncMedium:function(o){for(r=!0;n.length;){var s=n;n=[],s.forEach(o)}n={push:function(a){return o(a)},filter:function(){return n}}},assignMedium:function(o){r=!0;var s=[];if(n.length){var a=n;n=[],a.forEach(o),s=n}var l=function(){var u=s;s=[],u.forEach(o)},c=function(){return Promise.resolve().then(l)};c(),n={push:function(u){s.push(u),c()},filter:function(u){return s=s.filter(u),n}}}};return i}function KL(t){t===void 0&&(t={});var e=WL(null);return e.options=Ir({async:!0,ssr:!1},t),e}var pT=function(t){var e=t.sideCar,n=hT(t,["sideCar"]);if(!e)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=e.read();if(!r)throw new Error("Sidecar medium not found");return m.createElement(r,Ir({},n))};pT.isSideCarExport=!0;function qL(t,e){return t.useMedium(e),pT}var mT=KL(),xm=function(){},Yh=m.forwardRef(function(t,e){var n=m.useRef(null),r=m.useState({onScrollCapture:xm,onWheelCapture:xm,onTouchMoveCapture:xm}),i=r[0],o=r[1],s=t.forwardProps,a=t.children,l=t.className,c=t.removeScrollBar,u=t.enabled,d=t.shards,h=t.sideCar,p=t.noIsolation,g=t.inert,y=t.allowPinchZoom,x=t.as,v=x===void 0?"div":x,w=t.gapMode,b=hT(t,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),S=h,C=UL([n,e]),k=Ir(Ir({},b),i);return m.createElement(m.Fragment,null,u&&m.createElement(S,{sideCar:mT,removeScrollBar:c,shards:d,noIsolation:p,inert:g,setCallbacks:o,allowPinchZoom:!!y,lockRef:n,gapMode:w}),s?m.cloneElement(m.Children.only(a),Ir(Ir({},k),{ref:C})):m.createElement(v,Ir({},k,{className:l,ref:C}),a))});Yh.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};Yh.classNames={fullWidth:pf,zeroRight:hf};var Db,GL=function(){if(Db)return Db;if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function JL(){if(!document)return null;var t=document.createElement("style");t.type="text/css";var e=GL();return e&&t.setAttribute("nonce",e),t}function YL(t,e){t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e))}function QL(t){var e=document.head||document.getElementsByTagName("head")[0];e.appendChild(t)}var XL=function(){var t=0,e=null;return{add:function(n){t==0&&(e=JL())&&(YL(e,n),QL(e)),t++},remove:function(){t--,!t&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},ZL=function(){var t=XL();return function(e,n){m.useEffect(function(){return t.add(e),function(){t.remove()}},[e&&n])}},gT=function(){var t=ZL(),e=function(n){var r=n.styles,i=n.dynamic;return t(r,i),null};return e},e3={left:0,top:0,right:0,gap:0},wm=function(t){return parseInt(t||"",10)||0},t3=function(t){var e=window.getComputedStyle(document.body),n=e[t==="padding"?"paddingLeft":"marginLeft"],r=e[t==="padding"?"paddingTop":"marginTop"],i=e[t==="padding"?"paddingRight":"marginRight"];return[wm(n),wm(r),wm(i)]},n3=function(t){if(t===void 0&&(t="margin"),typeof window>"u")return e3;var e=t3(t),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,r-n+e[2]-e[0])}},r3=gT(),Va="data-scroll-locked",i3=function(t,e,n,r){var i=t.left,o=t.top,s=t.right,a=t.gap;return n===void 0&&(n="margin"),`
  .`.concat(FL,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(a,"px ").concat(r,`;
  }
  body[`).concat(Va,`] {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([e&&"position: relative ".concat(r,";"),n==="margin"&&`
    padding-left: `.concat(i,`px;
    padding-top: `).concat(o,`px;
    padding-right: `).concat(s,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(a,"px ").concat(r,`;
    `),n==="padding"&&"padding-right: ".concat(a,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(hf,` {
    right: `).concat(a,"px ").concat(r,`;
  }
  
  .`).concat(pf,` {
    margin-right: `).concat(a,"px ").concat(r,`;
  }
  
  .`).concat(hf," .").concat(hf,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(pf," .").concat(pf,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body[`).concat(Va,`] {
    `).concat(BL,": ").concat(a,`px;
  }
`)},Lb=function(){var t=parseInt(document.body.getAttribute(Va)||"0",10);return isFinite(t)?t:0},o3=function(){m.useEffect(function(){return document.body.setAttribute(Va,(Lb()+1).toString()),function(){var t=Lb()-1;t<=0?document.body.removeAttribute(Va):document.body.setAttribute(Va,t.toString())}},[])},s3=function(t){var e=t.noRelative,n=t.noImportant,r=t.gapMode,i=r===void 0?"margin":r;o3();var o=m.useMemo(function(){return n3(i)},[i]);return m.createElement(r3,{styles:i3(o,!e,i,n?"":"!important")})},ky=!1;if(typeof window<"u")try{var Id=Object.defineProperty({},"passive",{get:function(){return ky=!0,!0}});window.addEventListener("test",Id,Id),window.removeEventListener("test",Id,Id)}catch{ky=!1}var aa=ky?{passive:!1}:!1,a3=function(t){return t.tagName==="TEXTAREA"},yT=function(t,e){if(!(t instanceof Element))return!1;var n=window.getComputedStyle(t);return n[e]!=="hidden"&&!(n.overflowY===n.overflowX&&!a3(t)&&n[e]==="visible")},l3=function(t){return yT(t,"overflowY")},c3=function(t){return yT(t,"overflowX")},$b=function(t,e){var n=e.ownerDocument,r=e;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var i=vT(t,r);if(i){var o=xT(t,r),s=o[1],a=o[2];if(s>a)return!0}r=r.parentNode}while(r&&r!==n.body);return!1},u3=function(t){var e=t.scrollTop,n=t.scrollHeight,r=t.clientHeight;return[e,n,r]},d3=function(t){var e=t.scrollLeft,n=t.scrollWidth,r=t.clientWidth;return[e,n,r]},vT=function(t,e){return t==="v"?l3(e):c3(e)},xT=function(t,e){return t==="v"?u3(e):d3(e)},f3=function(t,e){return t==="h"&&e==="rtl"?-1:1},h3=function(t,e,n,r,i){var o=f3(t,window.getComputedStyle(e).direction),s=o*r,a=n.target,l=e.contains(a),c=!1,u=s>0,d=0,h=0;do{var p=xT(t,a),g=p[0],y=p[1],x=p[2],v=y-x-o*g;(g||v)&&vT(t,a)&&(d+=v,h+=g),a instanceof ShadowRoot?a=a.host:a=a.parentNode}while(!l&&a!==document.body||l&&(e.contains(a)||e===a));return(u&&(i&&Math.abs(d)<1||!i&&s>d)||!u&&(i&&Math.abs(h)<1||!i&&-s>h))&&(c=!0),c},Ad=function(t){return"changedTouches"in t?[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:[0,0]},Fb=function(t){return[t.deltaX,t.deltaY]},Bb=function(t){return t&&"current"in t?t.current:t},p3=function(t,e){return t[0]===e[0]&&t[1]===e[1]},m3=function(t){return`
  .block-interactivity-`.concat(t,` {pointer-events: none;}
  .allow-interactivity-`).concat(t,` {pointer-events: all;}
`)},g3=0,la=[];function y3(t){var e=m.useRef([]),n=m.useRef([0,0]),r=m.useRef(),i=m.useState(g3++)[0],o=m.useState(gT)[0],s=m.useRef(t);m.useEffect(function(){s.current=t},[t]),m.useEffect(function(){if(t.inert){document.body.classList.add("block-interactivity-".concat(i));var y=$L([t.lockRef.current],(t.shards||[]).map(Bb),!0).filter(Boolean);return y.forEach(function(x){return x.classList.add("allow-interactivity-".concat(i))}),function(){document.body.classList.remove("block-interactivity-".concat(i)),y.forEach(function(x){return x.classList.remove("allow-interactivity-".concat(i))})}}},[t.inert,t.lockRef.current,t.shards]);var a=m.useCallback(function(y,x){if("touches"in y&&y.touches.length===2||y.type==="wheel"&&y.ctrlKey)return!s.current.allowPinchZoom;var v=Ad(y),w=n.current,b="deltaX"in y?y.deltaX:w[0]-v[0],S="deltaY"in y?y.deltaY:w[1]-v[1],C,k=y.target,E=Math.abs(b)>Math.abs(S)?"h":"v";if("touches"in y&&E==="h"&&k.type==="range")return!1;var T=$b(E,k);if(!T)return!0;if(T?C=E:(C=E==="v"?"h":"v",T=$b(E,k)),!T)return!1;if(!r.current&&"changedTouches"in y&&(b||S)&&(r.current=C),!C)return!0;var R=r.current||C;return h3(R,x,y,R==="h"?b:S,!0)},[]),l=m.useCallback(function(y){var x=y;if(!(!la.length||la[la.length-1]!==o)){var v="deltaY"in x?Fb(x):Ad(x),w=e.current.filter(function(C){return C.name===x.type&&(C.target===x.target||x.target===C.shadowParent)&&p3(C.delta,v)})[0];if(w&&w.should){x.cancelable&&x.preventDefault();return}if(!w){var b=(s.current.shards||[]).map(Bb).filter(Boolean).filter(function(C){return C.contains(x.target)}),S=b.length>0?a(x,b[0]):!s.current.noIsolation;S&&x.cancelable&&x.preventDefault()}}},[]),c=m.useCallback(function(y,x,v,w){var b={name:y,delta:x,target:v,should:w,shadowParent:v3(v)};e.current.push(b),setTimeout(function(){e.current=e.current.filter(function(S){return S!==b})},1)},[]),u=m.useCallback(function(y){n.current=Ad(y),r.current=void 0},[]),d=m.useCallback(function(y){c(y.type,Fb(y),y.target,a(y,t.lockRef.current))},[]),h=m.useCallback(function(y){c(y.type,Ad(y),y.target,a(y,t.lockRef.current))},[]);m.useEffect(function(){return la.push(o),t.setCallbacks({onScrollCapture:d,onWheelCapture:d,onTouchMoveCapture:h}),document.addEventListener("wheel",l,aa),document.addEventListener("touchmove",l,aa),document.addEventListener("touchstart",u,aa),function(){la=la.filter(function(y){return y!==o}),document.removeEventListener("wheel",l,aa),document.removeEventListener("touchmove",l,aa),document.removeEventListener("touchstart",u,aa)}},[]);var p=t.removeScrollBar,g=t.inert;return m.createElement(m.Fragment,null,g?m.createElement(o,{styles:m3(i)}):null,p?m.createElement(s3,{gapMode:t.gapMode}):null)}function v3(t){for(var e=null;t!==null;)t instanceof ShadowRoot&&(e=t.host,t=t.host),t=t.parentNode;return e}const x3=qL(mT,y3);var wT=m.forwardRef(function(t,e){return m.createElement(Yh,Ir({},t,{ref:e,sideCar:x3}))});wT.classNames=Yh.classNames;const Qh=wT;var w3=function(t){if(typeof document>"u")return null;var e=Array.isArray(t)?t[0]:t;return e.ownerDocument.body},ca=new WeakMap,Nd=new WeakMap,jd={},bm=0,bT=function(t){return t&&(t.host||bT(t.parentNode))},b3=function(t,e){return e.map(function(n){if(t.contains(n))return n;var r=bT(n);return r&&t.contains(r)?r:(console.error("aria-hidden",n,"in not contained inside",t,". Doing nothing"),null)}).filter(function(n){return!!n})},S3=function(t,e,n,r){var i=b3(e,Array.isArray(t)?t:[t]);jd[n]||(jd[n]=new WeakMap);var o=jd[n],s=[],a=new Set,l=new Set(i),c=function(d){!d||a.has(d)||(a.add(d),c(d.parentNode))};i.forEach(c);var u=function(d){!d||l.has(d)||Array.prototype.forEach.call(d.children,function(h){if(a.has(h))u(h);else try{var p=h.getAttribute(r),g=p!==null&&p!=="false",y=(ca.get(h)||0)+1,x=(o.get(h)||0)+1;ca.set(h,y),o.set(h,x),s.push(h),y===1&&g&&Nd.set(h,!0),x===1&&h.setAttribute(n,"true"),g||h.setAttribute(r,"true")}catch(v){console.error("aria-hidden: cannot operate on ",h,v)}})};return u(e),a.clear(),bm++,function(){s.forEach(function(d){var h=ca.get(d)-1,p=o.get(d)-1;ca.set(d,h),o.set(d,p),h||(Nd.has(d)||d.removeAttribute(r),Nd.delete(d)),p||d.removeAttribute(n)}),bm--,bm||(ca=new WeakMap,ca=new WeakMap,Nd=new WeakMap,jd={})}},Xh=function(t,e,n){n===void 0&&(n="data-aria-hidden");var r=Array.from(Array.isArray(t)?t:[t]),i=e||w3(t);return i?(r.push.apply(r,Array.from(i.querySelectorAll("[aria-live]"))),S3(r,i,n,"aria-hidden")):function(){return null}},M0="Dialog",[ST,KW]=yi(M0),[C3,vr]=ST(M0),CT=t=>{const{__scopeDialog:e,children:n,open:r,defaultOpen:i,onOpenChange:o,modal:s=!0}=t,a=m.useRef(null),l=m.useRef(null),[c=!1,u]=As({prop:r,defaultProp:i,onChange:o});return f.jsx(C3,{scope:e,triggerRef:a,contentRef:l,contentId:Dr(),titleId:Dr(),descriptionId:Dr(),open:c,onOpenChange:u,onOpenToggle:m.useCallback(()=>u(d=>!d),[u]),modal:s,children:n})};CT.displayName=M0;var kT="DialogTrigger",k3=m.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,i=vr(kT,n),o=Se(e,i.triggerRef);return f.jsx(se.button,{type:"button","aria-haspopup":"dialog","aria-expanded":i.open,"aria-controls":i.contentId,"data-state":N0(i.open),...r,ref:o,onClick:K(t.onClick,i.onOpenToggle)})});k3.displayName=kT;var I0="DialogPortal",[E3,ET]=ST(I0,{forceMount:void 0}),TT=t=>{const{__scopeDialog:e,forceMount:n,children:r,container:i}=t,o=vr(I0,e);return f.jsx(E3,{scope:e,forceMount:n,children:m.Children.map(r,s=>f.jsx(yr,{present:n||o.open,children:f.jsx(Ul,{asChild:!0,container:i,children:s})}))})};TT.displayName=I0;var Yf="DialogOverlay",_T=m.forwardRef((t,e)=>{const n=ET(Yf,t.__scopeDialog),{forceMount:r=n.forceMount,...i}=t,o=vr(Yf,t.__scopeDialog);return o.modal?f.jsx(yr,{present:r||o.open,children:f.jsx(T3,{...i,ref:e})}):null});_T.displayName=Yf;var T3=m.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,i=vr(Yf,n);return f.jsx(Qh,{as:_o,allowPinchZoom:!0,shards:[i.contentRef],children:f.jsx(se.div,{"data-state":N0(i.open),...r,ref:e,style:{pointerEvents:"auto",...r.style}})})}),Ns="DialogContent",RT=m.forwardRef((t,e)=>{const n=ET(Ns,t.__scopeDialog),{forceMount:r=n.forceMount,...i}=t,o=vr(Ns,t.__scopeDialog);return f.jsx(yr,{present:r||o.open,children:o.modal?f.jsx(_3,{...i,ref:e}):f.jsx(R3,{...i,ref:e})})});RT.displayName=Ns;var _3=m.forwardRef((t,e)=>{const n=vr(Ns,t.__scopeDialog),r=m.useRef(null),i=Se(e,n.contentRef,r);return m.useEffect(()=>{const o=r.current;if(o)return Xh(o)},[]),f.jsx(OT,{...t,ref:i,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:K(t.onCloseAutoFocus,o=>{var s;o.preventDefault(),(s=n.triggerRef.current)==null||s.focus()}),onPointerDownOutside:K(t.onPointerDownOutside,o=>{const s=o.detail.originalEvent,a=s.button===0&&s.ctrlKey===!0;(s.button===2||a)&&o.preventDefault()}),onFocusOutside:K(t.onFocusOutside,o=>o.preventDefault())})}),R3=m.forwardRef((t,e)=>{const n=vr(Ns,t.__scopeDialog),r=m.useRef(!1),i=m.useRef(!1);return f.jsx(OT,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:o=>{var s,a;(s=t.onCloseAutoFocus)==null||s.call(t,o),o.defaultPrevented||(r.current||(a=n.triggerRef.current)==null||a.focus(),o.preventDefault()),r.current=!1,i.current=!1},onInteractOutside:o=>{var l,c;(l=t.onInteractOutside)==null||l.call(t,o),o.defaultPrevented||(r.current=!0,o.detail.originalEvent.type==="pointerdown"&&(i.current=!0));const s=o.target;((c=n.triggerRef.current)==null?void 0:c.contains(s))&&o.preventDefault(),o.detail.originalEvent.type==="focusin"&&i.current&&o.preventDefault()}})}),OT=m.forwardRef((t,e)=>{const{__scopeDialog:n,trapFocus:r,onOpenAutoFocus:i,onCloseAutoFocus:o,...s}=t,a=vr(Ns,n),l=m.useRef(null),c=Se(e,l);return Jh(),f.jsxs(f.Fragment,{children:[f.jsx(Uu,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:i,onUnmountAutoFocus:o,children:f.jsx(Vl,{role:"dialog",id:a.contentId,"aria-describedby":a.descriptionId,"aria-labelledby":a.titleId,"data-state":N0(a.open),...s,ref:c,onDismiss:()=>a.onOpenChange(!1)})}),f.jsxs(f.Fragment,{children:[f.jsx(O3,{titleId:a.titleId}),f.jsx(M3,{contentRef:l,descriptionId:a.descriptionId})]})]})}),A0="DialogTitle",PT=m.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,i=vr(A0,n);return f.jsx(se.h2,{id:i.titleId,...r,ref:e})});PT.displayName=A0;var MT="DialogDescription",IT=m.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,i=vr(MT,n);return f.jsx(se.p,{id:i.descriptionId,...r,ref:e})});IT.displayName=MT;var AT="DialogClose",NT=m.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,i=vr(AT,n);return f.jsx(se.button,{type:"button",...r,ref:e,onClick:K(t.onClick,()=>i.onOpenChange(!1))})});NT.displayName=AT;function N0(t){return t?"open":"closed"}var jT="DialogTitleWarning",[qW,DT]=lL(jT,{contentName:Ns,titleName:A0,docsSlug:"dialog"}),O3=({titleId:t})=>{const e=DT(jT),n=`\`${e.contentName}\` requires a \`${e.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${e.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${e.docsSlug}`;return m.useEffect(()=>{t&&(document.getElementById(t)||console.error(n))},[n,t]),null},P3="DialogDescriptionWarning",M3=({contentRef:t,descriptionId:e})=>{const r=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${DT(P3).contentName}}.`;return m.useEffect(()=>{var o;const i=(o=t.current)==null?void 0:o.getAttribute("aria-describedby");e&&i&&(document.getElementById(e)||console.warn(r))},[r,t,e]),null},ml=CT,gl=TT,yl=_T,vl=RT,xl=PT,LT=IT,Qf=NT;function Zh(t){const e=t+"CollectionProvider",[n,r]=yi(e),[i,o]=n(e,{collectionRef:{current:null},itemMap:new Map}),s=p=>{const{scope:g,children:y}=p,x=Te.useRef(null),v=Te.useRef(new Map).current;return f.jsx(i,{scope:g,itemMap:v,collectionRef:x,children:y})};s.displayName=e;const a=t+"CollectionSlot",l=Te.forwardRef((p,g)=>{const{scope:y,children:x}=p,v=o(a,y),w=Se(g,v.collectionRef);return f.jsx(_o,{ref:w,children:x})});l.displayName=a;const c=t+"CollectionItemSlot",u="data-radix-collection-item",d=Te.forwardRef((p,g)=>{const{scope:y,children:x,...v}=p,w=Te.useRef(null),b=Se(g,w),S=o(c,y);return Te.useEffect(()=>(S.itemMap.set(w,{ref:w,...v}),()=>void S.itemMap.delete(w))),f.jsx(_o,{[u]:"",ref:b,children:x})});d.displayName=c;function h(p){const g=o(t+"CollectionConsumer",p);return Te.useCallback(()=>{const x=g.collectionRef.current;if(!x)return[];const v=Array.from(x.querySelectorAll(`[${u}]`));return Array.from(g.itemMap.values()).sort((S,C)=>v.indexOf(S.ref.current)-v.indexOf(C.ref.current))},[g.collectionRef,g.itemMap])}return[{Provider:s,Slot:l,ItemSlot:d},h,r]}var I3=m.createContext(void 0);function j0(t){const e=m.useContext(I3);return t||e||"ltr"}const A3=["top","right","bottom","left"],Ro=Math.min,xn=Math.max,Xf=Math.round,Dd=Math.floor,Lr=t=>({x:t,y:t}),N3={left:"right",right:"left",bottom:"top",top:"bottom"},j3={start:"end",end:"start"};function Ey(t,e,n){return xn(t,Ro(e,n))}function hi(t,e){return typeof t=="function"?t(e):t}function pi(t){return t.split("-")[0]}function Hl(t){return t.split("-")[1]}function D0(t){return t==="x"?"y":"x"}function L0(t){return t==="y"?"height":"width"}function Oo(t){return["top","bottom"].includes(pi(t))?"y":"x"}function $0(t){return D0(Oo(t))}function D3(t,e,n){n===void 0&&(n=!1);const r=Hl(t),i=$0(t),o=L0(i);let s=i==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return e.reference[o]>e.floating[o]&&(s=Zf(s)),[s,Zf(s)]}function L3(t){const e=Zf(t);return[Ty(t),e,Ty(e)]}function Ty(t){return t.replace(/start|end/g,e=>j3[e])}function $3(t,e,n){const r=["left","right"],i=["right","left"],o=["top","bottom"],s=["bottom","top"];switch(t){case"top":case"bottom":return n?e?i:r:e?r:i;case"left":case"right":return e?o:s;default:return[]}}function F3(t,e,n,r){const i=Hl(t);let o=$3(pi(t),n==="start",r);return i&&(o=o.map(s=>s+"-"+i),e&&(o=o.concat(o.map(Ty)))),o}function Zf(t){return t.replace(/left|right|bottom|top/g,e=>N3[e])}function B3(t){return{top:0,right:0,bottom:0,left:0,...t}}function $T(t){return typeof t!="number"?B3(t):{top:t,right:t,bottom:t,left:t}}function eh(t){const{x:e,y:n,width:r,height:i}=t;return{width:r,height:i,top:n,left:e,right:e+r,bottom:n+i,x:e,y:n}}function zb(t,e,n){let{reference:r,floating:i}=t;const o=Oo(e),s=$0(e),a=L0(s),l=pi(e),c=o==="y",u=r.x+r.width/2-i.width/2,d=r.y+r.height/2-i.height/2,h=r[a]/2-i[a]/2;let p;switch(l){case"top":p={x:u,y:r.y-i.height};break;case"bottom":p={x:u,y:r.y+r.height};break;case"right":p={x:r.x+r.width,y:d};break;case"left":p={x:r.x-i.width,y:d};break;default:p={x:r.x,y:r.y}}switch(Hl(e)){case"start":p[s]-=h*(n&&c?-1:1);break;case"end":p[s]+=h*(n&&c?-1:1);break}return p}const z3=async(t,e,n)=>{const{placement:r="bottom",strategy:i="absolute",middleware:o=[],platform:s}=n,a=o.filter(Boolean),l=await(s.isRTL==null?void 0:s.isRTL(e));let c=await s.getElementRects({reference:t,floating:e,strategy:i}),{x:u,y:d}=zb(c,r,l),h=r,p={},g=0;for(let y=0;y<a.length;y++){const{name:x,fn:v}=a[y],{x:w,y:b,data:S,reset:C}=await v({x:u,y:d,initialPlacement:r,placement:h,strategy:i,middlewareData:p,rects:c,platform:s,elements:{reference:t,floating:e}});u=w??u,d=b??d,p={...p,[x]:{...p[x],...S}},C&&g<=50&&(g++,typeof C=="object"&&(C.placement&&(h=C.placement),C.rects&&(c=C.rects===!0?await s.getElementRects({reference:t,floating:e,strategy:i}):C.rects),{x:u,y:d}=zb(c,h,l)),y=-1)}return{x:u,y:d,placement:h,strategy:i,middlewareData:p}};async function su(t,e){var n;e===void 0&&(e={});const{x:r,y:i,platform:o,rects:s,elements:a,strategy:l}=t,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:d="floating",altBoundary:h=!1,padding:p=0}=hi(e,t),g=$T(p),x=a[h?d==="floating"?"reference":"floating":d],v=eh(await o.getClippingRect({element:(n=await(o.isElement==null?void 0:o.isElement(x)))==null||n?x:x.contextElement||await(o.getDocumentElement==null?void 0:o.getDocumentElement(a.floating)),boundary:c,rootBoundary:u,strategy:l})),w=d==="floating"?{x:r,y:i,width:s.floating.width,height:s.floating.height}:s.reference,b=await(o.getOffsetParent==null?void 0:o.getOffsetParent(a.floating)),S=await(o.isElement==null?void 0:o.isElement(b))?await(o.getScale==null?void 0:o.getScale(b))||{x:1,y:1}:{x:1,y:1},C=eh(o.convertOffsetParentRelativeRectToViewportRelativeRect?await o.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:w,offsetParent:b,strategy:l}):w);return{top:(v.top-C.top+g.top)/S.y,bottom:(C.bottom-v.bottom+g.bottom)/S.y,left:(v.left-C.left+g.left)/S.x,right:(C.right-v.right+g.right)/S.x}}const V3=t=>({name:"arrow",options:t,async fn(e){const{x:n,y:r,placement:i,rects:o,platform:s,elements:a,middlewareData:l}=e,{element:c,padding:u=0}=hi(t,e)||{};if(c==null)return{};const d=$T(u),h={x:n,y:r},p=$0(i),g=L0(p),y=await s.getDimensions(c),x=p==="y",v=x?"top":"left",w=x?"bottom":"right",b=x?"clientHeight":"clientWidth",S=o.reference[g]+o.reference[p]-h[p]-o.floating[g],C=h[p]-o.reference[p],k=await(s.getOffsetParent==null?void 0:s.getOffsetParent(c));let E=k?k[b]:0;(!E||!await(s.isElement==null?void 0:s.isElement(k)))&&(E=a.floating[b]||o.floating[g]);const T=S/2-C/2,R=E/2-y[g]/2-1,_=Ro(d[v],R),A=Ro(d[w],R),L=_,N=E-y[g]-A,M=E/2-y[g]/2+T,z=Ey(L,M,N),$=!l.arrow&&Hl(i)!=null&&M!==z&&o.reference[g]/2-(M<L?_:A)-y[g]/2<0,V=$?M<L?M-L:M-N:0;return{[p]:h[p]+V,data:{[p]:z,centerOffset:M-z-V,...$&&{alignmentOffset:V}},reset:$}}}),U3=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var n,r;const{placement:i,middlewareData:o,rects:s,initialPlacement:a,platform:l,elements:c}=e,{mainAxis:u=!0,crossAxis:d=!0,fallbackPlacements:h,fallbackStrategy:p="bestFit",fallbackAxisSideDirection:g="none",flipAlignment:y=!0,...x}=hi(t,e);if((n=o.arrow)!=null&&n.alignmentOffset)return{};const v=pi(i),w=Oo(a),b=pi(a)===a,S=await(l.isRTL==null?void 0:l.isRTL(c.floating)),C=h||(b||!y?[Zf(a)]:L3(a)),k=g!=="none";!h&&k&&C.push(...F3(a,y,g,S));const E=[a,...C],T=await su(e,x),R=[];let _=((r=o.flip)==null?void 0:r.overflows)||[];if(u&&R.push(T[v]),d){const M=D3(i,s,S);R.push(T[M[0]],T[M[1]])}if(_=[..._,{placement:i,overflows:R}],!R.every(M=>M<=0)){var A,L;const M=(((A=o.flip)==null?void 0:A.index)||0)+1,z=E[M];if(z)return{data:{index:M,overflows:_},reset:{placement:z}};let $=(L=_.filter(V=>V.overflows[0]<=0).sort((V,I)=>V.overflows[1]-I.overflows[1])[0])==null?void 0:L.placement;if(!$)switch(p){case"bestFit":{var N;const V=(N=_.filter(I=>{if(k){const P=Oo(I.placement);return P===w||P==="y"}return!0}).map(I=>[I.placement,I.overflows.filter(P=>P>0).reduce((P,D)=>P+D,0)]).sort((I,P)=>I[1]-P[1])[0])==null?void 0:N[0];V&&($=V);break}case"initialPlacement":$=a;break}if(i!==$)return{reset:{placement:$}}}return{}}}};function Vb(t,e){return{top:t.top-e.height,right:t.right-e.width,bottom:t.bottom-e.height,left:t.left-e.width}}function Ub(t){return A3.some(e=>t[e]>=0)}const H3=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(e){const{rects:n}=e,{strategy:r="referenceHidden",...i}=hi(t,e);switch(r){case"referenceHidden":{const o=await su(e,{...i,elementContext:"reference"}),s=Vb(o,n.reference);return{data:{referenceHiddenOffsets:s,referenceHidden:Ub(s)}}}case"escaped":{const o=await su(e,{...i,altBoundary:!0}),s=Vb(o,n.floating);return{data:{escapedOffsets:s,escaped:Ub(s)}}}default:return{}}}}};async function W3(t,e){const{placement:n,platform:r,elements:i}=t,o=await(r.isRTL==null?void 0:r.isRTL(i.floating)),s=pi(n),a=Hl(n),l=Oo(n)==="y",c=["left","top"].includes(s)?-1:1,u=o&&l?-1:1,d=hi(e,t);let{mainAxis:h,crossAxis:p,alignmentAxis:g}=typeof d=="number"?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:d.mainAxis||0,crossAxis:d.crossAxis||0,alignmentAxis:d.alignmentAxis};return a&&typeof g=="number"&&(p=a==="end"?g*-1:g),l?{x:p*u,y:h*c}:{x:h*c,y:p*u}}const K3=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var n,r;const{x:i,y:o,placement:s,middlewareData:a}=e,l=await W3(e,t);return s===((n=a.offset)==null?void 0:n.placement)&&(r=a.arrow)!=null&&r.alignmentOffset?{}:{x:i+l.x,y:o+l.y,data:{...l,placement:s}}}}},q3=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:n,y:r,placement:i}=e,{mainAxis:o=!0,crossAxis:s=!1,limiter:a={fn:x=>{let{x:v,y:w}=x;return{x:v,y:w}}},...l}=hi(t,e),c={x:n,y:r},u=await su(e,l),d=Oo(pi(i)),h=D0(d);let p=c[h],g=c[d];if(o){const x=h==="y"?"top":"left",v=h==="y"?"bottom":"right",w=p+u[x],b=p-u[v];p=Ey(w,p,b)}if(s){const x=d==="y"?"top":"left",v=d==="y"?"bottom":"right",w=g+u[x],b=g-u[v];g=Ey(w,g,b)}const y=a.fn({...e,[h]:p,[d]:g});return{...y,data:{x:y.x-n,y:y.y-r,enabled:{[h]:o,[d]:s}}}}}},G3=function(t){return t===void 0&&(t={}),{options:t,fn(e){const{x:n,y:r,placement:i,rects:o,middlewareData:s}=e,{offset:a=0,mainAxis:l=!0,crossAxis:c=!0}=hi(t,e),u={x:n,y:r},d=Oo(i),h=D0(d);let p=u[h],g=u[d];const y=hi(a,e),x=typeof y=="number"?{mainAxis:y,crossAxis:0}:{mainAxis:0,crossAxis:0,...y};if(l){const b=h==="y"?"height":"width",S=o.reference[h]-o.floating[b]+x.mainAxis,C=o.reference[h]+o.reference[b]-x.mainAxis;p<S?p=S:p>C&&(p=C)}if(c){var v,w;const b=h==="y"?"width":"height",S=["top","left"].includes(pi(i)),C=o.reference[d]-o.floating[b]+(S&&((v=s.offset)==null?void 0:v[d])||0)+(S?0:x.crossAxis),k=o.reference[d]+o.reference[b]+(S?0:((w=s.offset)==null?void 0:w[d])||0)-(S?x.crossAxis:0);g<C?g=C:g>k&&(g=k)}return{[h]:p,[d]:g}}}},J3=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(e){var n,r;const{placement:i,rects:o,platform:s,elements:a}=e,{apply:l=()=>{},...c}=hi(t,e),u=await su(e,c),d=pi(i),h=Hl(i),p=Oo(i)==="y",{width:g,height:y}=o.floating;let x,v;d==="top"||d==="bottom"?(x=d,v=h===(await(s.isRTL==null?void 0:s.isRTL(a.floating))?"start":"end")?"left":"right"):(v=d,x=h==="end"?"top":"bottom");const w=y-u.top-u.bottom,b=g-u.left-u.right,S=Ro(y-u[x],w),C=Ro(g-u[v],b),k=!e.middlewareData.shift;let E=S,T=C;if((n=e.middlewareData.shift)!=null&&n.enabled.x&&(T=b),(r=e.middlewareData.shift)!=null&&r.enabled.y&&(E=w),k&&!h){const _=xn(u.left,0),A=xn(u.right,0),L=xn(u.top,0),N=xn(u.bottom,0);p?T=g-2*(_!==0||A!==0?_+A:xn(u.left,u.right)):E=y-2*(L!==0||N!==0?L+N:xn(u.top,u.bottom))}await l({...e,availableWidth:T,availableHeight:E});const R=await s.getDimensions(a.floating);return g!==R.width||y!==R.height?{reset:{rects:!0}}:{}}}};function ep(){return typeof window<"u"}function Wl(t){return FT(t)?(t.nodeName||"").toLowerCase():"#document"}function Cn(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function Wr(t){var e;return(e=(FT(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function FT(t){return ep()?t instanceof Node||t instanceof Cn(t).Node:!1}function dr(t){return ep()?t instanceof Element||t instanceof Cn(t).Element:!1}function Br(t){return ep()?t instanceof HTMLElement||t instanceof Cn(t).HTMLElement:!1}function Hb(t){return!ep()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof Cn(t).ShadowRoot}function Hu(t){const{overflow:e,overflowX:n,overflowY:r,display:i}=fr(t);return/auto|scroll|overlay|hidden|clip/.test(e+r+n)&&!["inline","contents"].includes(i)}function Y3(t){return["table","td","th"].includes(Wl(t))}function tp(t){return[":popover-open",":modal"].some(e=>{try{return t.matches(e)}catch{return!1}})}function F0(t){const e=B0(),n=dr(t)?fr(t):t;return["transform","translate","scale","rotate","perspective"].some(r=>n[r]?n[r]!=="none":!1)||(n.containerType?n.containerType!=="normal":!1)||!e&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!e&&(n.filter?n.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(r=>(n.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(n.contain||"").includes(r))}function Q3(t){let e=Po(t);for(;Br(e)&&!wl(e);){if(F0(e))return e;if(tp(e))return null;e=Po(e)}return null}function B0(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function wl(t){return["html","body","#document"].includes(Wl(t))}function fr(t){return Cn(t).getComputedStyle(t)}function np(t){return dr(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function Po(t){if(Wl(t)==="html")return t;const e=t.assignedSlot||t.parentNode||Hb(t)&&t.host||Wr(t);return Hb(e)?e.host:e}function BT(t){const e=Po(t);return wl(e)?t.ownerDocument?t.ownerDocument.body:t.body:Br(e)&&Hu(e)?e:BT(e)}function au(t,e,n){var r;e===void 0&&(e=[]),n===void 0&&(n=!0);const i=BT(t),o=i===((r=t.ownerDocument)==null?void 0:r.body),s=Cn(i);if(o){const a=_y(s);return e.concat(s,s.visualViewport||[],Hu(i)?i:[],a&&n?au(a):[])}return e.concat(i,au(i,[],n))}function _y(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function zT(t){const e=fr(t);let n=parseFloat(e.width)||0,r=parseFloat(e.height)||0;const i=Br(t),o=i?t.offsetWidth:n,s=i?t.offsetHeight:r,a=Xf(n)!==o||Xf(r)!==s;return a&&(n=o,r=s),{width:n,height:r,$:a}}function z0(t){return dr(t)?t:t.contextElement}function Ua(t){const e=z0(t);if(!Br(e))return Lr(1);const n=e.getBoundingClientRect(),{width:r,height:i,$:o}=zT(e);let s=(o?Xf(n.width):n.width)/r,a=(o?Xf(n.height):n.height)/i;return(!s||!Number.isFinite(s))&&(s=1),(!a||!Number.isFinite(a))&&(a=1),{x:s,y:a}}const X3=Lr(0);function VT(t){const e=Cn(t);return!B0()||!e.visualViewport?X3:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function Z3(t,e,n){return e===void 0&&(e=!1),!n||e&&n!==Cn(t)?!1:e}function js(t,e,n,r){e===void 0&&(e=!1),n===void 0&&(n=!1);const i=t.getBoundingClientRect(),o=z0(t);let s=Lr(1);e&&(r?dr(r)&&(s=Ua(r)):s=Ua(t));const a=Z3(o,n,r)?VT(o):Lr(0);let l=(i.left+a.x)/s.x,c=(i.top+a.y)/s.y,u=i.width/s.x,d=i.height/s.y;if(o){const h=Cn(o),p=r&&dr(r)?Cn(r):r;let g=h,y=_y(g);for(;y&&r&&p!==g;){const x=Ua(y),v=y.getBoundingClientRect(),w=fr(y),b=v.left+(y.clientLeft+parseFloat(w.paddingLeft))*x.x,S=v.top+(y.clientTop+parseFloat(w.paddingTop))*x.y;l*=x.x,c*=x.y,u*=x.x,d*=x.y,l+=b,c+=S,g=Cn(y),y=_y(g)}}return eh({width:u,height:d,x:l,y:c})}function V0(t,e){const n=np(t).scrollLeft;return e?e.left+n:js(Wr(t)).left+n}function UT(t,e,n){n===void 0&&(n=!1);const r=t.getBoundingClientRect(),i=r.left+e.scrollLeft-(n?0:V0(t,r)),o=r.top+e.scrollTop;return{x:i,y:o}}function e$(t){let{elements:e,rect:n,offsetParent:r,strategy:i}=t;const o=i==="fixed",s=Wr(r),a=e?tp(e.floating):!1;if(r===s||a&&o)return n;let l={scrollLeft:0,scrollTop:0},c=Lr(1);const u=Lr(0),d=Br(r);if((d||!d&&!o)&&((Wl(r)!=="body"||Hu(s))&&(l=np(r)),Br(r))){const p=js(r);c=Ua(r),u.x=p.x+r.clientLeft,u.y=p.y+r.clientTop}const h=s&&!d&&!o?UT(s,l,!0):Lr(0);return{width:n.width*c.x,height:n.height*c.y,x:n.x*c.x-l.scrollLeft*c.x+u.x+h.x,y:n.y*c.y-l.scrollTop*c.y+u.y+h.y}}function t$(t){return Array.from(t.getClientRects())}function n$(t){const e=Wr(t),n=np(t),r=t.ownerDocument.body,i=xn(e.scrollWidth,e.clientWidth,r.scrollWidth,r.clientWidth),o=xn(e.scrollHeight,e.clientHeight,r.scrollHeight,r.clientHeight);let s=-n.scrollLeft+V0(t);const a=-n.scrollTop;return fr(r).direction==="rtl"&&(s+=xn(e.clientWidth,r.clientWidth)-i),{width:i,height:o,x:s,y:a}}function r$(t,e){const n=Cn(t),r=Wr(t),i=n.visualViewport;let o=r.clientWidth,s=r.clientHeight,a=0,l=0;if(i){o=i.width,s=i.height;const c=B0();(!c||c&&e==="fixed")&&(a=i.offsetLeft,l=i.offsetTop)}return{width:o,height:s,x:a,y:l}}function i$(t,e){const n=js(t,!0,e==="fixed"),r=n.top+t.clientTop,i=n.left+t.clientLeft,o=Br(t)?Ua(t):Lr(1),s=t.clientWidth*o.x,a=t.clientHeight*o.y,l=i*o.x,c=r*o.y;return{width:s,height:a,x:l,y:c}}function Wb(t,e,n){let r;if(e==="viewport")r=r$(t,n);else if(e==="document")r=n$(Wr(t));else if(dr(e))r=i$(e,n);else{const i=VT(t);r={x:e.x-i.x,y:e.y-i.y,width:e.width,height:e.height}}return eh(r)}function HT(t,e){const n=Po(t);return n===e||!dr(n)||wl(n)?!1:fr(n).position==="fixed"||HT(n,e)}function o$(t,e){const n=e.get(t);if(n)return n;let r=au(t,[],!1).filter(a=>dr(a)&&Wl(a)!=="body"),i=null;const o=fr(t).position==="fixed";let s=o?Po(t):t;for(;dr(s)&&!wl(s);){const a=fr(s),l=F0(s);!l&&a.position==="fixed"&&(i=null),(o?!l&&!i:!l&&a.position==="static"&&!!i&&["absolute","fixed"].includes(i.position)||Hu(s)&&!l&&HT(t,s))?r=r.filter(u=>u!==s):i=a,s=Po(s)}return e.set(t,r),r}function s$(t){let{element:e,boundary:n,rootBoundary:r,strategy:i}=t;const s=[...n==="clippingAncestors"?tp(e)?[]:o$(e,this._c):[].concat(n),r],a=s[0],l=s.reduce((c,u)=>{const d=Wb(e,u,i);return c.top=xn(d.top,c.top),c.right=Ro(d.right,c.right),c.bottom=Ro(d.bottom,c.bottom),c.left=xn(d.left,c.left),c},Wb(e,a,i));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function a$(t){const{width:e,height:n}=zT(t);return{width:e,height:n}}function l$(t,e,n){const r=Br(e),i=Wr(e),o=n==="fixed",s=js(t,!0,o,e);let a={scrollLeft:0,scrollTop:0};const l=Lr(0);if(r||!r&&!o)if((Wl(e)!=="body"||Hu(i))&&(a=np(e)),r){const h=js(e,!0,o,e);l.x=h.x+e.clientLeft,l.y=h.y+e.clientTop}else i&&(l.x=V0(i));const c=i&&!r&&!o?UT(i,a):Lr(0),u=s.left+a.scrollLeft-l.x-c.x,d=s.top+a.scrollTop-l.y-c.y;return{x:u,y:d,width:s.width,height:s.height}}function Sm(t){return fr(t).position==="static"}function Kb(t,e){if(!Br(t)||fr(t).position==="fixed")return null;if(e)return e(t);let n=t.offsetParent;return Wr(t)===n&&(n=n.ownerDocument.body),n}function WT(t,e){const n=Cn(t);if(tp(t))return n;if(!Br(t)){let i=Po(t);for(;i&&!wl(i);){if(dr(i)&&!Sm(i))return i;i=Po(i)}return n}let r=Kb(t,e);for(;r&&Y3(r)&&Sm(r);)r=Kb(r,e);return r&&wl(r)&&Sm(r)&&!F0(r)?n:r||Q3(t)||n}const c$=async function(t){const e=this.getOffsetParent||WT,n=this.getDimensions,r=await n(t.floating);return{reference:l$(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function u$(t){return fr(t).direction==="rtl"}const d$={convertOffsetParentRelativeRectToViewportRelativeRect:e$,getDocumentElement:Wr,getClippingRect:s$,getOffsetParent:WT,getElementRects:c$,getClientRects:t$,getDimensions:a$,getScale:Ua,isElement:dr,isRTL:u$};function KT(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height}function f$(t,e){let n=null,r;const i=Wr(t);function o(){var a;clearTimeout(r),(a=n)==null||a.disconnect(),n=null}function s(a,l){a===void 0&&(a=!1),l===void 0&&(l=1),o();const c=t.getBoundingClientRect(),{left:u,top:d,width:h,height:p}=c;if(a||e(),!h||!p)return;const g=Dd(d),y=Dd(i.clientWidth-(u+h)),x=Dd(i.clientHeight-(d+p)),v=Dd(u),b={rootMargin:-g+"px "+-y+"px "+-x+"px "+-v+"px",threshold:xn(0,Ro(1,l))||1};let S=!0;function C(k){const E=k[0].intersectionRatio;if(E!==l){if(!S)return s();E?s(!1,E):r=setTimeout(()=>{s(!1,1e-7)},1e3)}E===1&&!KT(c,t.getBoundingClientRect())&&s(),S=!1}try{n=new IntersectionObserver(C,{...b,root:i.ownerDocument})}catch{n=new IntersectionObserver(C,b)}n.observe(t)}return s(!0),o}function h$(t,e,n,r){r===void 0&&(r={});const{ancestorScroll:i=!0,ancestorResize:o=!0,elementResize:s=typeof ResizeObserver=="function",layoutShift:a=typeof IntersectionObserver=="function",animationFrame:l=!1}=r,c=z0(t),u=i||o?[...c?au(c):[],...au(e)]:[];u.forEach(v=>{i&&v.addEventListener("scroll",n,{passive:!0}),o&&v.addEventListener("resize",n)});const d=c&&a?f$(c,n):null;let h=-1,p=null;s&&(p=new ResizeObserver(v=>{let[w]=v;w&&w.target===c&&p&&(p.unobserve(e),cancelAnimationFrame(h),h=requestAnimationFrame(()=>{var b;(b=p)==null||b.observe(e)})),n()}),c&&!l&&p.observe(c),p.observe(e));let g,y=l?js(t):null;l&&x();function x(){const v=js(t);y&&!KT(y,v)&&n(),y=v,g=requestAnimationFrame(x)}return n(),()=>{var v;u.forEach(w=>{i&&w.removeEventListener("scroll",n),o&&w.removeEventListener("resize",n)}),d==null||d(),(v=p)==null||v.disconnect(),p=null,l&&cancelAnimationFrame(g)}}const p$=K3,m$=q3,g$=U3,y$=J3,v$=H3,qb=V3,x$=G3,w$=(t,e,n)=>{const r=new Map,i={platform:d$,...n},o={...i.platform,_c:r};return z3(t,e,{...i,platform:o})};var mf=typeof document<"u"?m.useLayoutEffect:m.useEffect;function th(t,e){if(t===e)return!0;if(typeof t!=typeof e)return!1;if(typeof t=="function"&&t.toString()===e.toString())return!0;let n,r,i;if(t&&e&&typeof t=="object"){if(Array.isArray(t)){if(n=t.length,n!==e.length)return!1;for(r=n;r--!==0;)if(!th(t[r],e[r]))return!1;return!0}if(i=Object.keys(t),n=i.length,n!==Object.keys(e).length)return!1;for(r=n;r--!==0;)if(!{}.hasOwnProperty.call(e,i[r]))return!1;for(r=n;r--!==0;){const o=i[r];if(!(o==="_owner"&&t.$$typeof)&&!th(t[o],e[o]))return!1}return!0}return t!==t&&e!==e}function qT(t){return typeof window>"u"?1:(t.ownerDocument.defaultView||window).devicePixelRatio||1}function Gb(t,e){const n=qT(t);return Math.round(e*n)/n}function Cm(t){const e=m.useRef(t);return mf(()=>{e.current=t}),e}function b$(t){t===void 0&&(t={});const{placement:e="bottom",strategy:n="absolute",middleware:r=[],platform:i,elements:{reference:o,floating:s}={},transform:a=!0,whileElementsMounted:l,open:c}=t,[u,d]=m.useState({x:0,y:0,strategy:n,placement:e,middlewareData:{},isPositioned:!1}),[h,p]=m.useState(r);th(h,r)||p(r);const[g,y]=m.useState(null),[x,v]=m.useState(null),w=m.useCallback(I=>{I!==k.current&&(k.current=I,y(I))},[]),b=m.useCallback(I=>{I!==E.current&&(E.current=I,v(I))},[]),S=o||g,C=s||x,k=m.useRef(null),E=m.useRef(null),T=m.useRef(u),R=l!=null,_=Cm(l),A=Cm(i),L=Cm(c),N=m.useCallback(()=>{if(!k.current||!E.current)return;const I={placement:e,strategy:n,middleware:h};A.current&&(I.platform=A.current),w$(k.current,E.current,I).then(P=>{const D={...P,isPositioned:L.current!==!1};M.current&&!th(T.current,D)&&(T.current=D,Gs.flushSync(()=>{d(D)}))})},[h,e,n,A,L]);mf(()=>{c===!1&&T.current.isPositioned&&(T.current.isPositioned=!1,d(I=>({...I,isPositioned:!1})))},[c]);const M=m.useRef(!1);mf(()=>(M.current=!0,()=>{M.current=!1}),[]),mf(()=>{if(S&&(k.current=S),C&&(E.current=C),S&&C){if(_.current)return _.current(S,C,N);N()}},[S,C,N,_,R]);const z=m.useMemo(()=>({reference:k,floating:E,setReference:w,setFloating:b}),[w,b]),$=m.useMemo(()=>({reference:S,floating:C}),[S,C]),V=m.useMemo(()=>{const I={position:n,left:0,top:0};if(!$.floating)return I;const P=Gb($.floating,u.x),D=Gb($.floating,u.y);return a?{...I,transform:"translate("+P+"px, "+D+"px)",...qT($.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:P,top:D}},[n,a,$.floating,u.x,u.y]);return m.useMemo(()=>({...u,update:N,refs:z,elements:$,floatingStyles:V}),[u,N,z,$,V])}const S$=t=>{function e(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:t,fn(n){const{element:r,padding:i}=typeof t=="function"?t(n):t;return r&&e(r)?r.current!=null?qb({element:r.current,padding:i}).fn(n):{}:r?qb({element:r,padding:i}).fn(n):{}}}},C$=(t,e)=>({...p$(t),options:[t,e]}),k$=(t,e)=>({...m$(t),options:[t,e]}),E$=(t,e)=>({...x$(t),options:[t,e]}),T$=(t,e)=>({...g$(t),options:[t,e]}),_$=(t,e)=>({...y$(t),options:[t,e]}),R$=(t,e)=>({...v$(t),options:[t,e]}),O$=(t,e)=>({...S$(t),options:[t,e]});var P$="Arrow",GT=m.forwardRef((t,e)=>{const{children:n,width:r=10,height:i=5,...o}=t;return f.jsx(se.svg,{...o,ref:e,width:r,height:i,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:t.asChild?n:f.jsx("polygon",{points:"0,0 30,0 15,10"})})});GT.displayName=P$;var M$=GT;function I$(t){const[e,n]=m.useState(void 0);return Mt(()=>{if(t){n({width:t.offsetWidth,height:t.offsetHeight});const r=new ResizeObserver(i=>{if(!Array.isArray(i)||!i.length)return;const o=i[0];let s,a;if("borderBoxSize"in o){const l=o.borderBoxSize,c=Array.isArray(l)?l[0]:l;s=c.inlineSize,a=c.blockSize}else s=t.offsetWidth,a=t.offsetHeight;n({width:s,height:a})});return r.observe(t,{box:"border-box"}),()=>r.unobserve(t)}else n(void 0)},[t]),e}var U0="Popper",[JT,Kl]=yi(U0),[A$,YT]=JT(U0),QT=t=>{const{__scopePopper:e,children:n}=t,[r,i]=m.useState(null);return f.jsx(A$,{scope:e,anchor:r,onAnchorChange:i,children:n})};QT.displayName=U0;var XT="PopperAnchor",ZT=m.forwardRef((t,e)=>{const{__scopePopper:n,virtualRef:r,...i}=t,o=YT(XT,n),s=m.useRef(null),a=Se(e,s);return m.useEffect(()=>{o.onAnchorChange((r==null?void 0:r.current)||s.current)}),r?null:f.jsx(se.div,{...i,ref:a})});ZT.displayName=XT;var H0="PopperContent",[N$,j$]=JT(H0),e_=m.forwardRef((t,e)=>{var U,ae,ve,de,me,xe;const{__scopePopper:n,side:r="bottom",sideOffset:i=0,align:o="center",alignOffset:s=0,arrowPadding:a=0,avoidCollisions:l=!0,collisionBoundary:c=[],collisionPadding:u=0,sticky:d="partial",hideWhenDetached:h=!1,updatePositionStrategy:p="optimized",onPlaced:g,...y}=t,x=YT(H0,n),[v,w]=m.useState(null),b=Se(e,tt=>w(tt)),[S,C]=m.useState(null),k=I$(S),E=(k==null?void 0:k.width)??0,T=(k==null?void 0:k.height)??0,R=r+(o!=="center"?"-"+o:""),_=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},A=Array.isArray(c)?c:[c],L=A.length>0,N={padding:_,boundary:A.filter(L$),altBoundary:L},{refs:M,floatingStyles:z,placement:$,isPositioned:V,middlewareData:I}=b$({strategy:"fixed",placement:R,whileElementsMounted:(...tt)=>h$(...tt,{animationFrame:p==="always"}),elements:{reference:x.anchor},middleware:[C$({mainAxis:i+T,alignmentAxis:s}),l&&k$({mainAxis:!0,crossAxis:!1,limiter:d==="partial"?E$():void 0,...N}),l&&T$({...N}),_$({...N,apply:({elements:tt,rects:jt,availableWidth:wr,availableHeight:Jn})=>{const{width:Yn,height:ea}=jt.reference,Kr=tt.floating.style;Kr.setProperty("--radix-popper-available-width",`${wr}px`),Kr.setProperty("--radix-popper-available-height",`${Jn}px`),Kr.setProperty("--radix-popper-anchor-width",`${Yn}px`),Kr.setProperty("--radix-popper-anchor-height",`${ea}px`)}}),S&&O$({element:S,padding:a}),$$({arrowWidth:E,arrowHeight:T}),h&&R$({strategy:"referenceHidden",...N})]}),[P,D]=r_($),H=It(g);Mt(()=>{V&&(H==null||H())},[V,H]);const Z=(U=I.arrow)==null?void 0:U.x,he=(ae=I.arrow)==null?void 0:ae.y,pe=((ve=I.arrow)==null?void 0:ve.centerOffset)!==0,[ee,Q]=m.useState();return Mt(()=>{v&&Q(window.getComputedStyle(v).zIndex)},[v]),f.jsx("div",{ref:M.setFloating,"data-radix-popper-content-wrapper":"",style:{...z,transform:V?z.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:ee,"--radix-popper-transform-origin":[(de=I.transformOrigin)==null?void 0:de.x,(me=I.transformOrigin)==null?void 0:me.y].join(" "),...((xe=I.hide)==null?void 0:xe.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:t.dir,children:f.jsx(N$,{scope:n,placedSide:P,onArrowChange:C,arrowX:Z,arrowY:he,shouldHideArrow:pe,children:f.jsx(se.div,{"data-side":P,"data-align":D,...y,ref:b,style:{...y.style,animation:V?void 0:"none"}})})})});e_.displayName=H0;var t_="PopperArrow",D$={top:"bottom",right:"left",bottom:"top",left:"right"},n_=m.forwardRef(function(e,n){const{__scopePopper:r,...i}=e,o=j$(t_,r),s=D$[o.placedSide];return f.jsx("span",{ref:o.onArrowChange,style:{position:"absolute",left:o.arrowX,top:o.arrowY,[s]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[o.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[o.placedSide],visibility:o.shouldHideArrow?"hidden":void 0},children:f.jsx(M$,{...i,ref:n,style:{...i.style,display:"block"}})})});n_.displayName=t_;function L$(t){return t!==null}var $$=t=>({name:"transformOrigin",options:t,fn(e){var x,v,w;const{placement:n,rects:r,middlewareData:i}=e,s=((x=i.arrow)==null?void 0:x.centerOffset)!==0,a=s?0:t.arrowWidth,l=s?0:t.arrowHeight,[c,u]=r_(n),d={start:"0%",center:"50%",end:"100%"}[u],h=(((v=i.arrow)==null?void 0:v.x)??0)+a/2,p=(((w=i.arrow)==null?void 0:w.y)??0)+l/2;let g="",y="";return c==="bottom"?(g=s?d:`${h}px`,y=`${-l}px`):c==="top"?(g=s?d:`${h}px`,y=`${r.floating.height+l}px`):c==="right"?(g=`${-l}px`,y=s?d:`${p}px`):c==="left"&&(g=`${r.floating.width+l}px`,y=s?d:`${p}px`),{data:{x:g,y}}}});function r_(t){const[e,n="center"]=t.split("-");return[e,n]}var W0=QT,rp=ZT,K0=e_,q0=n_,km="rovingFocusGroup.onEntryFocus",F$={bubbles:!1,cancelable:!0},ip="RovingFocusGroup",[Ry,i_,B$]=Zh(ip),[z$,o_]=yi(ip,[B$]),[V$,U$]=z$(ip),s_=m.forwardRef((t,e)=>f.jsx(Ry.Provider,{scope:t.__scopeRovingFocusGroup,children:f.jsx(Ry.Slot,{scope:t.__scopeRovingFocusGroup,children:f.jsx(H$,{...t,ref:e})})}));s_.displayName=ip;var H$=m.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:n,orientation:r,loop:i=!1,dir:o,currentTabStopId:s,defaultCurrentTabStopId:a,onCurrentTabStopIdChange:l,onEntryFocus:c,preventScrollOnEntryFocus:u=!1,...d}=t,h=m.useRef(null),p=Se(e,h),g=j0(o),[y=null,x]=As({prop:s,defaultProp:a,onChange:l}),[v,w]=m.useState(!1),b=It(c),S=i_(n),C=m.useRef(!1),[k,E]=m.useState(0);return m.useEffect(()=>{const T=h.current;if(T)return T.addEventListener(km,b),()=>T.removeEventListener(km,b)},[b]),f.jsx(V$,{scope:n,orientation:r,dir:g,loop:i,currentTabStopId:y,onItemFocus:m.useCallback(T=>x(T),[x]),onItemShiftTab:m.useCallback(()=>w(!0),[]),onFocusableItemAdd:m.useCallback(()=>E(T=>T+1),[]),onFocusableItemRemove:m.useCallback(()=>E(T=>T-1),[]),children:f.jsx(se.div,{tabIndex:v||k===0?-1:0,"data-orientation":r,...d,ref:p,style:{outline:"none",...t.style},onMouseDown:K(t.onMouseDown,()=>{C.current=!0}),onFocus:K(t.onFocus,T=>{const R=!C.current;if(T.target===T.currentTarget&&R&&!v){const _=new CustomEvent(km,F$);if(T.currentTarget.dispatchEvent(_),!_.defaultPrevented){const A=S().filter($=>$.focusable),L=A.find($=>$.active),N=A.find($=>$.id===y),z=[L,N,...A].filter(Boolean).map($=>$.ref.current);c_(z,u)}}C.current=!1}),onBlur:K(t.onBlur,()=>w(!1))})})}),a_="RovingFocusGroupItem",l_=m.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:n,focusable:r=!0,active:i=!1,tabStopId:o,...s}=t,a=Dr(),l=o||a,c=U$(a_,n),u=c.currentTabStopId===l,d=i_(n),{onFocusableItemAdd:h,onFocusableItemRemove:p}=c;return m.useEffect(()=>{if(r)return h(),()=>p()},[r,h,p]),f.jsx(Ry.ItemSlot,{scope:n,id:l,focusable:r,active:i,children:f.jsx(se.span,{tabIndex:u?0:-1,"data-orientation":c.orientation,...s,ref:e,onMouseDown:K(t.onMouseDown,g=>{r?c.onItemFocus(l):g.preventDefault()}),onFocus:K(t.onFocus,()=>c.onItemFocus(l)),onKeyDown:K(t.onKeyDown,g=>{if(g.key==="Tab"&&g.shiftKey){c.onItemShiftTab();return}if(g.target!==g.currentTarget)return;const y=q$(g,c.orientation,c.dir);if(y!==void 0){if(g.metaKey||g.ctrlKey||g.altKey||g.shiftKey)return;g.preventDefault();let v=d().filter(w=>w.focusable).map(w=>w.ref.current);if(y==="last")v.reverse();else if(y==="prev"||y==="next"){y==="prev"&&v.reverse();const w=v.indexOf(g.currentTarget);v=c.loop?G$(v,w+1):v.slice(w+1)}setTimeout(()=>c_(v))}})})})});l_.displayName=a_;var W$={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function K$(t,e){return e!=="rtl"?t:t==="ArrowLeft"?"ArrowRight":t==="ArrowRight"?"ArrowLeft":t}function q$(t,e,n){const r=K$(t.key,n);if(!(e==="vertical"&&["ArrowLeft","ArrowRight"].includes(r))&&!(e==="horizontal"&&["ArrowUp","ArrowDown"].includes(r)))return W$[r]}function c_(t,e=!1){const n=document.activeElement;for(const r of t)if(r===n||(r.focus({preventScroll:e}),document.activeElement!==n))return}function G$(t,e){return t.map((n,r)=>t[(e+r)%t.length])}var J$=s_,Y$=l_,Oy=["Enter"," "],Q$=["ArrowDown","PageUp","Home"],u_=["ArrowUp","PageDown","End"],X$=[...Q$,...u_],Z$={ltr:[...Oy,"ArrowRight"],rtl:[...Oy,"ArrowLeft"]},e4={ltr:["ArrowLeft"],rtl:["ArrowRight"]},Wu="Menu",[lu,t4,n4]=Zh(Wu),[Qs,d_]=yi(Wu,[n4,Kl,o_]),op=Kl(),f_=o_(),[r4,Xs]=Qs(Wu),[i4,Ku]=Qs(Wu),h_=t=>{const{__scopeMenu:e,open:n=!1,children:r,dir:i,onOpenChange:o,modal:s=!0}=t,a=op(e),[l,c]=m.useState(null),u=m.useRef(!1),d=It(o),h=j0(i);return m.useEffect(()=>{const p=()=>{u.current=!0,document.addEventListener("pointerdown",g,{capture:!0,once:!0}),document.addEventListener("pointermove",g,{capture:!0,once:!0})},g=()=>u.current=!1;return document.addEventListener("keydown",p,{capture:!0}),()=>{document.removeEventListener("keydown",p,{capture:!0}),document.removeEventListener("pointerdown",g,{capture:!0}),document.removeEventListener("pointermove",g,{capture:!0})}},[]),f.jsx(W0,{...a,children:f.jsx(r4,{scope:e,open:n,onOpenChange:d,content:l,onContentChange:c,children:f.jsx(i4,{scope:e,onClose:m.useCallback(()=>d(!1),[d]),isUsingKeyboardRef:u,dir:h,modal:s,children:r})})})};h_.displayName=Wu;var o4="MenuAnchor",G0=m.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t,i=op(n);return f.jsx(rp,{...i,...r,ref:e})});G0.displayName=o4;var J0="MenuPortal",[s4,p_]=Qs(J0,{forceMount:void 0}),m_=t=>{const{__scopeMenu:e,forceMount:n,children:r,container:i}=t,o=Xs(J0,e);return f.jsx(s4,{scope:e,forceMount:n,children:f.jsx(yr,{present:n||o.open,children:f.jsx(Ul,{asChild:!0,container:i,children:r})})})};m_.displayName=J0;var $n="MenuContent",[a4,Y0]=Qs($n),g_=m.forwardRef((t,e)=>{const n=p_($n,t.__scopeMenu),{forceMount:r=n.forceMount,...i}=t,o=Xs($n,t.__scopeMenu),s=Ku($n,t.__scopeMenu);return f.jsx(lu.Provider,{scope:t.__scopeMenu,children:f.jsx(yr,{present:r||o.open,children:f.jsx(lu.Slot,{scope:t.__scopeMenu,children:s.modal?f.jsx(l4,{...i,ref:e}):f.jsx(c4,{...i,ref:e})})})})}),l4=m.forwardRef((t,e)=>{const n=Xs($n,t.__scopeMenu),r=m.useRef(null),i=Se(e,r);return m.useEffect(()=>{const o=r.current;if(o)return Xh(o)},[]),f.jsx(Q0,{...t,ref:i,trapFocus:n.open,disableOutsidePointerEvents:n.open,disableOutsideScroll:!0,onFocusOutside:K(t.onFocusOutside,o=>o.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>n.onOpenChange(!1)})}),c4=m.forwardRef((t,e)=>{const n=Xs($n,t.__scopeMenu);return f.jsx(Q0,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>n.onOpenChange(!1)})}),Q0=m.forwardRef((t,e)=>{const{__scopeMenu:n,loop:r=!1,trapFocus:i,onOpenAutoFocus:o,onCloseAutoFocus:s,disableOutsidePointerEvents:a,onEntryFocus:l,onEscapeKeyDown:c,onPointerDownOutside:u,onFocusOutside:d,onInteractOutside:h,onDismiss:p,disableOutsideScroll:g,...y}=t,x=Xs($n,n),v=Ku($n,n),w=op(n),b=f_(n),S=t4(n),[C,k]=m.useState(null),E=m.useRef(null),T=Se(e,E,x.onContentChange),R=m.useRef(0),_=m.useRef(""),A=m.useRef(0),L=m.useRef(null),N=m.useRef("right"),M=m.useRef(0),z=g?Qh:m.Fragment,$=g?{as:_o,allowPinchZoom:!0}:void 0,V=P=>{var U,ae;const D=_.current+P,H=S().filter(ve=>!ve.disabled),Z=document.activeElement,he=(U=H.find(ve=>ve.ref.current===Z))==null?void 0:U.textValue,pe=H.map(ve=>ve.textValue),ee=b4(pe,D,he),Q=(ae=H.find(ve=>ve.textValue===ee))==null?void 0:ae.ref.current;(function ve(de){_.current=de,window.clearTimeout(R.current),de!==""&&(R.current=window.setTimeout(()=>ve(""),1e3))})(D),Q&&setTimeout(()=>Q.focus())};m.useEffect(()=>()=>window.clearTimeout(R.current),[]),Jh();const I=m.useCallback(P=>{var H,Z;return N.current===((H=L.current)==null?void 0:H.side)&&C4(P,(Z=L.current)==null?void 0:Z.area)},[]);return f.jsx(a4,{scope:n,searchRef:_,onItemEnter:m.useCallback(P=>{I(P)&&P.preventDefault()},[I]),onItemLeave:m.useCallback(P=>{var D;I(P)||((D=E.current)==null||D.focus(),k(null))},[I]),onTriggerLeave:m.useCallback(P=>{I(P)&&P.preventDefault()},[I]),pointerGraceTimerRef:A,onPointerGraceIntentChange:m.useCallback(P=>{L.current=P},[]),children:f.jsx(z,{...$,children:f.jsx(Uu,{asChild:!0,trapped:i,onMountAutoFocus:K(o,P=>{var D;P.preventDefault(),(D=E.current)==null||D.focus({preventScroll:!0})}),onUnmountAutoFocus:s,children:f.jsx(Vl,{asChild:!0,disableOutsidePointerEvents:a,onEscapeKeyDown:c,onPointerDownOutside:u,onFocusOutside:d,onInteractOutside:h,onDismiss:p,children:f.jsx(J$,{asChild:!0,...b,dir:v.dir,orientation:"vertical",loop:r,currentTabStopId:C,onCurrentTabStopIdChange:k,onEntryFocus:K(l,P=>{v.isUsingKeyboardRef.current||P.preventDefault()}),preventScrollOnEntryFocus:!0,children:f.jsx(K0,{role:"menu","aria-orientation":"vertical","data-state":I_(x.open),"data-radix-menu-content":"",dir:v.dir,...w,...y,ref:T,style:{outline:"none",...y.style},onKeyDown:K(y.onKeyDown,P=>{const H=P.target.closest("[data-radix-menu-content]")===P.currentTarget,Z=P.ctrlKey||P.altKey||P.metaKey,he=P.key.length===1;H&&(P.key==="Tab"&&P.preventDefault(),!Z&&he&&V(P.key));const pe=E.current;if(P.target!==pe||!X$.includes(P.key))return;P.preventDefault();const Q=S().filter(U=>!U.disabled).map(U=>U.ref.current);u_.includes(P.key)&&Q.reverse(),x4(Q)}),onBlur:K(t.onBlur,P=>{P.currentTarget.contains(P.target)||(window.clearTimeout(R.current),_.current="")}),onPointerMove:K(t.onPointerMove,cu(P=>{const D=P.target,H=M.current!==P.clientX;if(P.currentTarget.contains(D)&&H){const Z=P.clientX>M.current?"right":"left";N.current=Z,M.current=P.clientX}}))})})})})})})});g_.displayName=$n;var u4="MenuGroup",X0=m.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t;return f.jsx(se.div,{role:"group",...r,ref:e})});X0.displayName=u4;var d4="MenuLabel",y_=m.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t;return f.jsx(se.div,{...r,ref:e})});y_.displayName=d4;var nh="MenuItem",Jb="menu.itemSelect",sp=m.forwardRef((t,e)=>{const{disabled:n=!1,onSelect:r,...i}=t,o=m.useRef(null),s=Ku(nh,t.__scopeMenu),a=Y0(nh,t.__scopeMenu),l=Se(e,o),c=m.useRef(!1),u=()=>{const d=o.current;if(!n&&d){const h=new CustomEvent(Jb,{bubbles:!0,cancelable:!0});d.addEventListener(Jb,p=>r==null?void 0:r(p),{once:!0}),P0(d,h),h.defaultPrevented?c.current=!1:s.onClose()}};return f.jsx(v_,{...i,ref:l,disabled:n,onClick:K(t.onClick,u),onPointerDown:d=>{var h;(h=t.onPointerDown)==null||h.call(t,d),c.current=!0},onPointerUp:K(t.onPointerUp,d=>{var h;c.current||(h=d.currentTarget)==null||h.click()}),onKeyDown:K(t.onKeyDown,d=>{const h=a.searchRef.current!=="";n||h&&d.key===" "||Oy.includes(d.key)&&(d.currentTarget.click(),d.preventDefault())})})});sp.displayName=nh;var v_=m.forwardRef((t,e)=>{const{__scopeMenu:n,disabled:r=!1,textValue:i,...o}=t,s=Y0(nh,n),a=f_(n),l=m.useRef(null),c=Se(e,l),[u,d]=m.useState(!1),[h,p]=m.useState("");return m.useEffect(()=>{const g=l.current;g&&p((g.textContent??"").trim())},[o.children]),f.jsx(lu.ItemSlot,{scope:n,disabled:r,textValue:i??h,children:f.jsx(Y$,{asChild:!0,...a,focusable:!r,children:f.jsx(se.div,{role:"menuitem","data-highlighted":u?"":void 0,"aria-disabled":r||void 0,"data-disabled":r?"":void 0,...o,ref:c,onPointerMove:K(t.onPointerMove,cu(g=>{r?s.onItemLeave(g):(s.onItemEnter(g),g.defaultPrevented||g.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:K(t.onPointerLeave,cu(g=>s.onItemLeave(g))),onFocus:K(t.onFocus,()=>d(!0)),onBlur:K(t.onBlur,()=>d(!1))})})})}),f4="MenuCheckboxItem",x_=m.forwardRef((t,e)=>{const{checked:n=!1,onCheckedChange:r,...i}=t;return f.jsx(k_,{scope:t.__scopeMenu,checked:n,children:f.jsx(sp,{role:"menuitemcheckbox","aria-checked":rh(n)?"mixed":n,...i,ref:e,"data-state":ex(n),onSelect:K(i.onSelect,()=>r==null?void 0:r(rh(n)?!0:!n),{checkForDefaultPrevented:!1})})})});x_.displayName=f4;var w_="MenuRadioGroup",[h4,p4]=Qs(w_,{value:void 0,onValueChange:()=>{}}),b_=m.forwardRef((t,e)=>{const{value:n,onValueChange:r,...i}=t,o=It(r);return f.jsx(h4,{scope:t.__scopeMenu,value:n,onValueChange:o,children:f.jsx(X0,{...i,ref:e})})});b_.displayName=w_;var S_="MenuRadioItem",C_=m.forwardRef((t,e)=>{const{value:n,...r}=t,i=p4(S_,t.__scopeMenu),o=n===i.value;return f.jsx(k_,{scope:t.__scopeMenu,checked:o,children:f.jsx(sp,{role:"menuitemradio","aria-checked":o,...r,ref:e,"data-state":ex(o),onSelect:K(r.onSelect,()=>{var s;return(s=i.onValueChange)==null?void 0:s.call(i,n)},{checkForDefaultPrevented:!1})})})});C_.displayName=S_;var Z0="MenuItemIndicator",[k_,m4]=Qs(Z0,{checked:!1}),E_=m.forwardRef((t,e)=>{const{__scopeMenu:n,forceMount:r,...i}=t,o=m4(Z0,n);return f.jsx(yr,{present:r||rh(o.checked)||o.checked===!0,children:f.jsx(se.span,{...i,ref:e,"data-state":ex(o.checked)})})});E_.displayName=Z0;var g4="MenuSeparator",T_=m.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t;return f.jsx(se.div,{role:"separator","aria-orientation":"horizontal",...r,ref:e})});T_.displayName=g4;var y4="MenuArrow",__=m.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t,i=op(n);return f.jsx(q0,{...i,...r,ref:e})});__.displayName=y4;var v4="MenuSub",[GW,R_]=Qs(v4),gc="MenuSubTrigger",O_=m.forwardRef((t,e)=>{const n=Xs(gc,t.__scopeMenu),r=Ku(gc,t.__scopeMenu),i=R_(gc,t.__scopeMenu),o=Y0(gc,t.__scopeMenu),s=m.useRef(null),{pointerGraceTimerRef:a,onPointerGraceIntentChange:l}=o,c={__scopeMenu:t.__scopeMenu},u=m.useCallback(()=>{s.current&&window.clearTimeout(s.current),s.current=null},[]);return m.useEffect(()=>u,[u]),m.useEffect(()=>{const d=a.current;return()=>{window.clearTimeout(d),l(null)}},[a,l]),f.jsx(G0,{asChild:!0,...c,children:f.jsx(v_,{id:i.triggerId,"aria-haspopup":"menu","aria-expanded":n.open,"aria-controls":i.contentId,"data-state":I_(n.open),...t,ref:Gh(e,i.onTriggerChange),onClick:d=>{var h;(h=t.onClick)==null||h.call(t,d),!(t.disabled||d.defaultPrevented)&&(d.currentTarget.focus(),n.open||n.onOpenChange(!0))},onPointerMove:K(t.onPointerMove,cu(d=>{o.onItemEnter(d),!d.defaultPrevented&&!t.disabled&&!n.open&&!s.current&&(o.onPointerGraceIntentChange(null),s.current=window.setTimeout(()=>{n.onOpenChange(!0),u()},100))})),onPointerLeave:K(t.onPointerLeave,cu(d=>{var p,g;u();const h=(p=n.content)==null?void 0:p.getBoundingClientRect();if(h){const y=(g=n.content)==null?void 0:g.dataset.side,x=y==="right",v=x?-5:5,w=h[x?"left":"right"],b=h[x?"right":"left"];o.onPointerGraceIntentChange({area:[{x:d.clientX+v,y:d.clientY},{x:w,y:h.top},{x:b,y:h.top},{x:b,y:h.bottom},{x:w,y:h.bottom}],side:y}),window.clearTimeout(a.current),a.current=window.setTimeout(()=>o.onPointerGraceIntentChange(null),300)}else{if(o.onTriggerLeave(d),d.defaultPrevented)return;o.onPointerGraceIntentChange(null)}})),onKeyDown:K(t.onKeyDown,d=>{var p;const h=o.searchRef.current!=="";t.disabled||h&&d.key===" "||Z$[r.dir].includes(d.key)&&(n.onOpenChange(!0),(p=n.content)==null||p.focus(),d.preventDefault())})})})});O_.displayName=gc;var P_="MenuSubContent",M_=m.forwardRef((t,e)=>{const n=p_($n,t.__scopeMenu),{forceMount:r=n.forceMount,...i}=t,o=Xs($n,t.__scopeMenu),s=Ku($n,t.__scopeMenu),a=R_(P_,t.__scopeMenu),l=m.useRef(null),c=Se(e,l);return f.jsx(lu.Provider,{scope:t.__scopeMenu,children:f.jsx(yr,{present:r||o.open,children:f.jsx(lu.Slot,{scope:t.__scopeMenu,children:f.jsx(Q0,{id:a.contentId,"aria-labelledby":a.triggerId,...i,ref:c,align:"start",side:s.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:u=>{var d;s.isUsingKeyboardRef.current&&((d=l.current)==null||d.focus()),u.preventDefault()},onCloseAutoFocus:u=>u.preventDefault(),onFocusOutside:K(t.onFocusOutside,u=>{u.target!==a.trigger&&o.onOpenChange(!1)}),onEscapeKeyDown:K(t.onEscapeKeyDown,u=>{s.onClose(),u.preventDefault()}),onKeyDown:K(t.onKeyDown,u=>{var p;const d=u.currentTarget.contains(u.target),h=e4[s.dir].includes(u.key);d&&h&&(o.onOpenChange(!1),(p=a.trigger)==null||p.focus(),u.preventDefault())})})})})})});M_.displayName=P_;function I_(t){return t?"open":"closed"}function rh(t){return t==="indeterminate"}function ex(t){return rh(t)?"indeterminate":t?"checked":"unchecked"}function x4(t){const e=document.activeElement;for(const n of t)if(n===e||(n.focus(),document.activeElement!==e))return}function w4(t,e){return t.map((n,r)=>t[(e+r)%t.length])}function b4(t,e,n){const i=e.length>1&&Array.from(e).every(c=>c===e[0])?e[0]:e,o=n?t.indexOf(n):-1;let s=w4(t,Math.max(o,0));i.length===1&&(s=s.filter(c=>c!==n));const l=s.find(c=>c.toLowerCase().startsWith(i.toLowerCase()));return l!==n?l:void 0}function S4(t,e){const{x:n,y:r}=t;let i=!1;for(let o=0,s=e.length-1;o<e.length;s=o++){const a=e[o].x,l=e[o].y,c=e[s].x,u=e[s].y;l>r!=u>r&&n<(c-a)*(r-l)/(u-l)+a&&(i=!i)}return i}function C4(t,e){if(!e)return!1;const n={x:t.clientX,y:t.clientY};return S4(n,e)}function cu(t){return e=>e.pointerType==="mouse"?t(e):void 0}var k4=h_,E4=G0,T4=m_,_4=g_,R4=X0,O4=y_,P4=sp,M4=x_,I4=b_,A4=C_,N4=E_,j4=T_,D4=__,L4=O_,$4=M_,tx="DropdownMenu",[F4,JW]=yi(tx,[d_]),Qt=d_(),[B4,A_]=F4(tx),N_=t=>{const{__scopeDropdownMenu:e,children:n,dir:r,open:i,defaultOpen:o,onOpenChange:s,modal:a=!0}=t,l=Qt(e),c=m.useRef(null),[u=!1,d]=As({prop:i,defaultProp:o,onChange:s});return f.jsx(B4,{scope:e,triggerId:Dr(),triggerRef:c,contentId:Dr(),open:u,onOpenChange:d,onOpenToggle:m.useCallback(()=>d(h=>!h),[d]),modal:a,children:f.jsx(k4,{...l,open:u,onOpenChange:d,dir:r,modal:a,children:n})})};N_.displayName=tx;var j_="DropdownMenuTrigger",D_=m.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,disabled:r=!1,...i}=t,o=A_(j_,n),s=Qt(n);return f.jsx(E4,{asChild:!0,...s,children:f.jsx(se.button,{type:"button",id:o.triggerId,"aria-haspopup":"menu","aria-expanded":o.open,"aria-controls":o.open?o.contentId:void 0,"data-state":o.open?"open":"closed","data-disabled":r?"":void 0,disabled:r,...i,ref:Gh(e,o.triggerRef),onPointerDown:K(t.onPointerDown,a=>{!r&&a.button===0&&a.ctrlKey===!1&&(o.onOpenToggle(),o.open||a.preventDefault())}),onKeyDown:K(t.onKeyDown,a=>{r||(["Enter"," "].includes(a.key)&&o.onOpenToggle(),a.key==="ArrowDown"&&o.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(a.key)&&a.preventDefault())})})})});D_.displayName=j_;var z4="DropdownMenuPortal",L_=t=>{const{__scopeDropdownMenu:e,...n}=t,r=Qt(e);return f.jsx(T4,{...r,...n})};L_.displayName=z4;var $_="DropdownMenuContent",F_=m.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,i=A_($_,n),o=Qt(n),s=m.useRef(!1);return f.jsx(_4,{id:i.contentId,"aria-labelledby":i.triggerId,...o,...r,ref:e,onCloseAutoFocus:K(t.onCloseAutoFocus,a=>{var l;s.current||(l=i.triggerRef.current)==null||l.focus(),s.current=!1,a.preventDefault()}),onInteractOutside:K(t.onInteractOutside,a=>{const l=a.detail.originalEvent,c=l.button===0&&l.ctrlKey===!0,u=l.button===2||c;(!i.modal||u)&&(s.current=!0)}),style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});F_.displayName=$_;var V4="DropdownMenuGroup",U4=m.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,i=Qt(n);return f.jsx(R4,{...i,...r,ref:e})});U4.displayName=V4;var H4="DropdownMenuLabel",W4=m.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,i=Qt(n);return f.jsx(O4,{...i,...r,ref:e})});W4.displayName=H4;var K4="DropdownMenuItem",B_=m.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,i=Qt(n);return f.jsx(P4,{...i,...r,ref:e})});B_.displayName=K4;var q4="DropdownMenuCheckboxItem",G4=m.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,i=Qt(n);return f.jsx(M4,{...i,...r,ref:e})});G4.displayName=q4;var J4="DropdownMenuRadioGroup",Y4=m.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,i=Qt(n);return f.jsx(I4,{...i,...r,ref:e})});Y4.displayName=J4;var Q4="DropdownMenuRadioItem",X4=m.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,i=Qt(n);return f.jsx(A4,{...i,...r,ref:e})});X4.displayName=Q4;var Z4="DropdownMenuItemIndicator",eF=m.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,i=Qt(n);return f.jsx(N4,{...i,...r,ref:e})});eF.displayName=Z4;var tF="DropdownMenuSeparator",z_=m.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,i=Qt(n);return f.jsx(j4,{...i,...r,ref:e})});z_.displayName=tF;var nF="DropdownMenuArrow",rF=m.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,i=Qt(n);return f.jsx(D4,{...i,...r,ref:e})});rF.displayName=nF;var iF="DropdownMenuSubTrigger",oF=m.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,i=Qt(n);return f.jsx(L4,{...i,...r,ref:e})});oF.displayName=iF;var sF="DropdownMenuSubContent",aF=m.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,i=Qt(n);return f.jsx($4,{...i,...r,ref:e,style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});aF.displayName=sF;var Ds=N_,Ls=D_,$s=L_,Fs=F_,gt=B_,Yb=z_;function vi(t,e){if(t==null)return{};var n={},r=Object.keys(t),i,o;for(o=0;o<r.length;o++)i=r[o],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}var lF=["color"],Xe=m.forwardRef(function(t,e){var n=t.color,r=n===void 0?"currentColor":n,i=vi(t,lF);return m.createElement("svg",Object.assign({width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},i,{ref:e}),m.createElement("path",{d:"M3.13523 6.15803C3.3241 5.95657 3.64052 5.94637 3.84197 6.13523L7.5 9.56464L11.158 6.13523C11.3595 5.94637 11.6759 5.95657 11.8648 6.15803C12.0536 6.35949 12.0434 6.67591 11.842 6.86477L7.84197 10.6148C7.64964 10.7951 7.35036 10.7951 7.15803 10.6148L3.15803 6.86477C2.95657 6.67591 2.94637 6.35949 3.13523 6.15803Z",fill:r,fillRule:"evenodd",clipRule:"evenodd"}))}),cF=["color"],Ai=m.forwardRef(function(t,e){var n=t.color,r=n===void 0?"currentColor":n,i=vi(t,cF);return m.createElement("svg",Object.assign({width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},i,{ref:e}),m.createElement("path",{d:"M3.13523 8.84197C3.3241 9.04343 3.64052 9.05363 3.84197 8.86477L7.5 5.43536L11.158 8.86477C11.3595 9.05363 11.6759 9.04343 11.8648 8.84197C12.0536 8.64051 12.0434 8.32409 11.842 8.13523L7.84197 4.38523C7.64964 4.20492 7.35036 4.20492 7.15803 4.38523L3.15803 8.13523C2.95657 8.32409 2.94637 8.64051 3.13523 8.84197Z",fill:r,fillRule:"evenodd",clipRule:"evenodd"}))}),uF=["color"],Bs=m.forwardRef(function(t,e){var n=t.color,r=n===void 0?"currentColor":n,i=vi(t,uF);return m.createElement("svg",Object.assign({width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},i,{ref:e}),m.createElement("path",{d:"M11.7816 4.03157C12.0062 3.80702 12.0062 3.44295 11.7816 3.2184C11.5571 2.99385 11.193 2.99385 10.9685 3.2184L7.50005 6.68682L4.03164 3.2184C3.80708 2.99385 3.44301 2.99385 3.21846 3.2184C2.99391 3.44295 2.99391 3.80702 3.21846 4.03157L6.68688 7.49999L3.21846 10.9684C2.99391 11.193 2.99391 11.557 3.21846 11.7816C3.44301 12.0061 3.80708 12.0061 4.03164 11.7816L7.50005 8.31316L10.9685 11.7816C11.193 12.0061 11.5571 12.0061 11.7816 11.7816C12.0062 11.557 12.0062 11.193 11.7816 10.9684L8.31322 7.49999L11.7816 4.03157Z",fill:r,fillRule:"evenodd",clipRule:"evenodd"}))}),dF=["color"],V_=m.forwardRef(function(t,e){var n=t.color,r=n===void 0?"currentColor":n,i=vi(t,dF);return m.createElement("svg",Object.assign({width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},i,{ref:e}),m.createElement("path",{d:"M8.625 2.5C8.625 3.12132 8.12132 3.625 7.5 3.625C6.87868 3.625 6.375 3.12132 6.375 2.5C6.375 1.87868 6.87868 1.375 7.5 1.375C8.12132 1.375 8.625 1.87868 8.625 2.5ZM8.625 7.5C8.625 8.12132 8.12132 8.625 7.5 8.625C6.87868 8.625 6.375 8.12132 6.375 7.5C6.375 6.87868 6.87868 6.375 7.5 6.375C8.12132 6.375 8.625 6.87868 8.625 7.5ZM7.5 13.625C8.12132 13.625 8.625 13.1213 8.625 12.5C8.625 11.8787 8.12132 11.375 7.5 11.375C6.87868 11.375 6.375 11.8787 6.375 12.5C6.375 13.1213 6.87868 13.625 7.5 13.625Z",fill:r,fillRule:"evenodd",clipRule:"evenodd"}))}),fF=["color"],U_=m.forwardRef(function(t,e){var n=t.color,r=n===void 0?"currentColor":n,i=vi(t,fF);return m.createElement("svg",Object.assign({width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},i,{ref:e}),m.createElement("path",{d:"M10 6.5C10 8.433 8.433 10 6.5 10C4.567 10 3 8.433 3 6.5C3 4.567 4.567 3 6.5 3C8.433 3 10 4.567 10 6.5ZM9.30884 10.0159C8.53901 10.6318 7.56251 11 6.5 11C4.01472 11 2 8.98528 2 6.5C2 4.01472 4.01472 2 6.5 2C8.98528 2 11 4.01472 11 6.5C11 7.56251 10.6318 8.53901 10.0159 9.30884L12.8536 12.1464C13.0488 12.3417 13.0488 12.6583 12.8536 12.8536C12.6583 13.0488 12.3417 13.0488 12.1464 12.8536L9.30884 10.0159Z",fill:r,fillRule:"evenodd",clipRule:"evenodd"}))}),hF=["color"],pF=m.forwardRef(function(t,e){var n=t.color,r=n===void 0?"currentColor":n,i=vi(t,hF);return m.createElement("svg",Object.assign({width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},i,{ref:e}),m.createElement("path",{d:"M11.8536 1.14645C11.6583 0.951184 11.3417 0.951184 11.1465 1.14645L3.71455 8.57836C3.62459 8.66832 3.55263 8.77461 3.50251 8.89155L2.04044 12.303C1.9599 12.491 2.00189 12.709 2.14646 12.8536C2.29103 12.9981 2.50905 13.0401 2.69697 12.9596L6.10847 11.4975C6.2254 11.4474 6.3317 11.3754 6.42166 11.2855L13.8536 3.85355C14.0488 3.65829 14.0488 3.34171 13.8536 3.14645L11.8536 1.14645ZM4.42166 9.28547L11.5 2.20711L12.7929 3.5L5.71455 10.5784L4.21924 11.2192L3.78081 10.7808L4.42166 9.28547Z",fill:r,fillRule:"evenodd",clipRule:"evenodd"}))}),mF=["color"],uu=m.forwardRef(function(t,e){var n=t.color,r=n===void 0?"currentColor":n,i=vi(t,mF);return m.createElement("svg",Object.assign({width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},i,{ref:e}),m.createElement("path",{d:"M8 2.75C8 2.47386 7.77614 2.25 7.5 2.25C7.22386 2.25 7 2.47386 7 2.75V7H2.75C2.47386 7 2.25 7.22386 2.25 7.5C2.25 7.77614 2.47386 8 2.75 8H7V12.25C7 12.5261 7.22386 12.75 7.5 12.75C7.77614 12.75 8 12.5261 8 12.25V8H12.25C12.5261 8 12.75 7.77614 12.75 7.5C12.75 7.22386 12.5261 7 12.25 7H8V2.75Z",fill:r,fillRule:"evenodd",clipRule:"evenodd"}))}),gF=["color"],yF=m.forwardRef(function(t,e){var n=t.color,r=n===void 0?"currentColor":n,i=vi(t,gF);return m.createElement("svg",Object.assign({width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},i,{ref:e}),m.createElement("path",{d:"M7.49998 0.849976C7.22383 0.849976 6.99998 1.07383 6.99998 1.34998V3.52234C6.99998 3.79848 7.22383 4.02234 7.49998 4.02234C7.77612 4.02234 7.99998 3.79848 7.99998 3.52234V1.8718C10.8862 2.12488 13.15 4.54806 13.15 7.49998C13.15 10.6204 10.6204 13.15 7.49998 13.15C4.37957 13.15 1.84998 10.6204 1.84998 7.49998C1.84998 6.10612 2.35407 4.83128 3.19049 3.8459C3.36919 3.63538 3.34339 3.31985 3.13286 3.14115C2.92234 2.96245 2.60681 2.98825 2.42811 3.19877C1.44405 4.35808 0.849976 5.86029 0.849976 7.49998C0.849976 11.1727 3.82728 14.15 7.49998 14.15C11.1727 14.15 14.15 11.1727 14.15 7.49998C14.15 3.82728 11.1727 0.849976 7.49998 0.849976ZM6.74049 8.08072L4.22363 4.57237C4.15231 4.47295 4.16346 4.33652 4.24998 4.25C4.33649 4.16348 4.47293 4.15233 4.57234 4.22365L8.08069 6.74051C8.56227 7.08599 8.61906 7.78091 8.19998 8.2C7.78089 8.61909 7.08597 8.56229 6.74049 8.08072Z",fill:r,fillRule:"evenodd",clipRule:"evenodd"}))}),vF=["color"],Py=m.forwardRef(function(t,e){var n=t.color,r=n===void 0?"currentColor":n,i=vi(t,vF);return m.createElement("svg",Object.assign({width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},i,{ref:e}),m.createElement("path",{d:"M5.5 1C5.22386 1 5 1.22386 5 1.5C5 1.77614 5.22386 2 5.5 2H9.5C9.77614 2 10 1.77614 10 1.5C10 1.22386 9.77614 1 9.5 1H5.5ZM3 3.5C3 3.22386 3.22386 3 3.5 3H5H10H11.5C11.7761 3 12 3.22386 12 3.5C12 3.77614 11.7761 4 11.5 4H11V12C11 12.5523 10.5523 13 10 13H5C4.44772 13 4 12.5523 4 12V4L3.5 4C3.22386 4 3 3.77614 3 3.5ZM5 4H10V12H5V4Z",fill:r,fillRule:"evenodd",clipRule:"evenodd"}))});/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xF=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),H_=(...t)=>t.filter((e,n,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===n).join(" ").trim();/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var wF={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bF=m.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:i="",children:o,iconNode:s,...a},l)=>m.createElement("svg",{ref:l,...wF,width:e,height:e,stroke:t,strokeWidth:r?Number(n)*24/Number(e):n,className:H_("lucide",i),...a},[...s.map(([c,u])=>m.createElement(c,u)),...Array.isArray(o)?o:[o]]));/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qe=(t,e)=>{const n=m.forwardRef(({className:r,...i},o)=>m.createElement(bF,{ref:o,iconNode:e,className:H_(`lucide-${xF(t)}`,r),...i}));return n.displayName=`${t}`,n};/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SF=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],W_=qe("ChevronDown",SF);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CF=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],kF=qe("ChevronRight",CF);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EF=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],TF=qe("CircleAlert",EF);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _F=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],RF=qe("CircleCheck",_F);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OF=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]],PF=qe("ClipboardCheck",OF);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MF=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],IF=qe("Copy",MF);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AF=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]],NF=qe("Ellipsis",AF);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jF=[["path",{d:"M10 12.5 8 15l2 2.5",key:"1tg20x"}],["path",{d:"m14 12.5 2 2.5-2 2.5",key:"yinavb"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7z",key:"1mlx9k"}]],K_=qe("FileCode",jF);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DF=[["path",{d:"M12.5 22H18a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v9.5",key:"1couwa"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M13.378 15.626a1 1 0 1 0-3.004-3.004l-5.01 5.012a2 2 0 0 0-.506.854l-.837 2.87a.5.5 0 0 0 .62.62l2.87-.837a2 2 0 0 0 .854-.506z",key:"1y4qbx"}]],nx=qe("FilePen",DF);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LF=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],rx=qe("FileText",LF);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $F=[["path",{d:"m5 8 6 6",key:"1wu5hv"}],["path",{d:"m4 14 6-6 2-3",key:"1k1g8d"}],["path",{d:"M2 5h12",key:"or177f"}],["path",{d:"M7 2h1",key:"1t2jsx"}],["path",{d:"m22 22-5-10-5 10",key:"don7ne"}],["path",{d:"M14 18h6",key:"1m8k6r"}]],FF=qe("Languages",$F);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BF=[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]],ih=qe("Mic",BF);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zF=[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]],VF=qe("Pause",zF);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UF=[["path",{d:"M21 7v6h-6",key:"3ptur4"}],["path",{d:"M3 17a9 9 0 0 1 9-9 9 9 0 0 1 6 2.3l3 2.7",key:"1kgawr"}]],HF=qe("Redo",UF);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WF=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],q_=qe("RefreshCw",WF);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KF=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],qF=qe("Save",KF);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GF=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],JF=qe("Square",GF);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YF=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],QF=qe("Trash2",YF);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XF=[["path",{d:"M3 7v6h6",key:"1v2h90"}],["path",{d:"M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13",key:"1r6uu6"}]],ZF=qe("Undo",XF);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e5=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]],t5=qe("Upload",e5);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n5=[["circle",{cx:"10",cy:"8",r:"5",key:"o932ke"}],["path",{d:"M2 21a8 8 0 0 1 10.434-7.62",key:"1yezr2"}],["circle",{cx:"18",cy:"18",r:"3",key:"1xkwt0"}],["path",{d:"m22 22-1.9-1.9",key:"1e5ubv"}]],r5=qe("UserRoundSearch",n5);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i5=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],o5=qe("X",i5),s5=t=>{switch(t){case"document":return f.jsx(rx,{size:16});case"translated_note":return f.jsx(nx,{size:16});default:return f.jsx(K_,{size:16})}};function G_({isOpen:t,onClose:e,template:n}){return n?f.jsx(ml,{open:t,onOpenChange:e,children:f.jsxs(gl,{children:[f.jsx(yl,{style:{position:"fixed",inset:0,backgroundColor:"rgba(0, 0, 0, 0.5)",animation:"overlayShow 150ms cubic-bezier(0.16, 1, 0.3, 1)",zIndex:50}}),f.jsxs(vl,{style:{maxWidth:"1200px",width:"90vw",height:"90vh",maxHeight:"90vh",padding:"20px",display:"flex",flexDirection:"column",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"auto",position:"fixed",backgroundColor:"white",borderRadius:"8px",boxShadow:"0px 10px 38px -10px rgba(22, 23, 24, 0.35)",zIndex:51},children:[f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px",paddingRight:"32px"},children:[f.jsx(xl,{style:{fontSize:"18px",fontWeight:"600",color:"#111827",margin:0},children:n.name}),f.jsx("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[s5(n.type),f.jsx("span",{style:{fontSize:"13px",color:"#6b7280"},children:"Document Template"})]})})]}),f.jsx("div",{style:{flex:1,backgroundColor:"#f9fafb",fontSize:"13px",lineHeight:"1.5",color:"#374151",fontFamily:"ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace",whiteSpace:"pre-wrap",overflowY:"auto",padding:"16px",borderRadius:"6px",border:"1px solid #e5e7eb"},children:n.prompt}),f.jsx("div",{style:{display:"flex",justifyContent:"flex-end",paddingTop:"16px"},children:f.jsx("button",{onClick:e,style:{padding:"6px 12px",fontSize:"13px",color:"#374151",backgroundColor:"transparent",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Close"})}),f.jsx("button",{style:{position:"absolute",top:"20px",right:"20px",padding:"4px",background:"none",border:"none",cursor:"pointer",color:"#9CA3AF",display:"flex",alignItems:"center",justifyContent:"center"},onClick:e,children:f.jsx(Bs,{})})]})]})}):null}const Ne={overlay:{position:"fixed",inset:0,backgroundColor:"rgba(0, 0, 0, 0.5)",animation:"overlayShow 150ms cubic-bezier(0.16, 1, 0.3, 1)",zIndex:50},content:{backgroundColor:"white",borderRadius:"12px",boxShadow:"0px 10px 38px -10px rgba(22, 23, 24, 0.35), 0px 10px 20px -15px rgba(22, 23, 24, 0.2)",position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"90vw",maxWidth:"480px",maxHeight:"85vh",padding:"20px",zIndex:51},searchContainer:{position:"relative",marginBottom:"16px"},searchIcon:{position:"absolute",left:"12px",top:"50%",transform:"translateY(-50%)",color:"#6b7280"},searchInput:{width:"100%",padding:"8px 12px 8px 36px",fontSize:"14px",border:"none",borderRadius:"6px",backgroundColor:"#f3f4f6",color:"#111827",outline:"none","&::placeholder":{color:"#9ca3af"}},title:{fontSize:"16px",fontWeight:"600",color:"#111827",marginBottom:"16px"},templateList:{overflowY:"auto",maxHeight:"calc(85vh - 180px)"},templateGroup:{marginBottom:"16px"},groupTitle:{fontSize:"13px",fontWeight:"500",color:"#6b7280",textTransform:"capitalize",padding:"0 4px 8px 4px"},templateItem:{padding:"8px 4px",cursor:"pointer",transition:"all 0.2s ease",display:"flex",alignItems:"center",justifyContent:"space-between",gap:"12px",borderBottom:"1px solid #f3f4f6","&:hover":{backgroundColor:"#f9fafb"}},templateInfo:{display:"flex",alignItems:"center",gap:"12px",flex:1},templateIcon:{display:"flex",alignItems:"center",justifyContent:"center",width:"32px",height:"32px",color:"#6b7280"},templateText:{flex:1},templateName:{fontSize:"14px",fontWeight:"500",color:"#111827"},templateDescription:{fontSize:"12px",color:"#6b7280"},footer:{display:"flex",justifyContent:"flex-end",gap:"8px",marginTop:"16px",paddingTop:"16px",borderTop:"1px solid #e5e7eb"},button:{padding:"8px 16px",borderRadius:"6px",border:"none",cursor:"pointer",fontSize:"14px",fontWeight:"500",transition:"all 0.2s ease"},cancelButton:{backgroundColor:"#f3f4f6",color:"#374151","&:hover":{backgroundColor:"#e5e7eb"}},generateButton:{backgroundColor:"#3b82f6",color:"white","&:hover":{backgroundColor:"#2563eb"}},disabledButton:{opacity:.5,cursor:"not-allowed","&:hover":{backgroundColor:"#3b82f6"}},closeButton:{position:"absolute",top:"16px",right:"16px",padding:"4px",border:"none",borderRadius:"4px",backgroundColor:"transparent",color:"#9CA3AF",cursor:"pointer","&:hover":{backgroundColor:"#F3F4F6",color:"#6B7280"}},dropdownContent:{minWidth:"180px",backgroundColor:"white",borderRadius:"6px",padding:"5px",boxShadow:"0px 10px 38px -10px rgba(22, 23, 24, 0.35), 0px 10px 20px -15px rgba(22, 23, 24, 0.2)",zIndex:52},dropdownItem:{fontSize:"13px",lineHeight:"1",color:"#374151",borderRadius:"3px",display:"flex",alignItems:"center",height:"32px",padding:"0 8px",position:"relative",userSelect:"none",outline:"none",gap:"8px",cursor:"pointer","&:hover":{backgroundColor:"#f3f4f6"}}},a5=t=>{switch(t){case"document":return f.jsx(rx,{size:16});case"translated_note":return f.jsx(nx,{size:16});default:return f.jsx(K_,{size:16})}},l5=t=>t.reduce((e,n)=>{const r=n.type;return e[r]||(e[r]=[]),e[r].push(n),e},{});function c5({isOpen:t,onClose:e,onGenerate:n,existingTemplateIds:r=[]}){const[i,o]=m.useState([]),[s,a]=m.useState(void 0),[l,c]=m.useState(!0),[u,d]=m.useState(""),[h,p]=m.useState(null),g=Qe();m.useEffect(()=>{t&&(async()=>{try{const{data:w,error:b}=await g.from("template_library").select("*").order("name");if(b)throw b;const S=(w==null?void 0:w.filter(C=>!r.includes(C.id)))||[];o(S)}catch(w){console.error("Error fetching templates:",w)}finally{c(!1)}})()},[t,g,r]);const y=m.useMemo(()=>u?i.filter(v=>v.name.toLowerCase().includes(u.toLowerCase())):i,[i,u]),x=m.useMemo(()=>l5(y),[y]);return f.jsxs(f.Fragment,{children:[f.jsx(ml,{open:t,onOpenChange:e,children:f.jsxs(gl,{children:[f.jsx(yl,{style:Ne.overlay}),f.jsxs(vl,{style:Ne.content,children:[f.jsx(xl,{style:Ne.title,children:"Select Template"}),f.jsxs("div",{style:Ne.searchContainer,children:[f.jsx(U_,{style:Ne.searchIcon}),f.jsx("input",{type:"text",placeholder:"Search templates...",value:u,onChange:v=>d(v.target.value),style:Ne.searchInput})]}),f.jsx("button",{style:Ne.closeButton,onClick:e,children:f.jsx(Bs,{})}),f.jsx("div",{style:Ne.templateList,children:l?f.jsx("div",{children:"Loading templates..."}):Object.keys(x).length===0?f.jsx("div",{children:"No templates available"}):Object.entries(x).map(([v,w])=>f.jsxs("div",{style:Ne.templateGroup,children:[f.jsxs("div",{style:Ne.groupTitle,children:[v.replace("_"," ")," templates"]}),w.map(b=>f.jsxs("div",{style:{...Ne.templateItem,...(s==null?void 0:s.id)===b.id?{backgroundColor:"#eef2ff",borderLeft:"2px solid #3b82f6"}:{}},onClick:()=>a(b),children:[f.jsxs("div",{style:Ne.templateInfo,children:[f.jsx("div",{style:Ne.templateIcon,children:a5(b.type)}),f.jsxs("div",{style:Ne.templateText,children:[f.jsx("div",{style:Ne.templateName,children:b.name}),b.specialty&&f.jsx("div",{style:Ne.templateDescription,children:b.specialty})]})]}),f.jsxs(Ds,{children:[f.jsx(Ls,{asChild:!0,children:f.jsx("button",{style:{background:"none",border:"none",cursor:"pointer",padding:"4px"},children:f.jsx(V_,{})})}),f.jsx($s,{children:f.jsxs(Fs,{style:Ne.dropdownContent,align:"end",children:[f.jsxs(gt,{style:Ne.dropdownItem,onClick:()=>p(b),children:[f.jsx(rx,{size:14}),"View template"]}),f.jsxs(gt,{style:Ne.dropdownItem,children:[f.jsx(nx,{size:14}),"Copy and edit template"]})]})})]})]},b.id))]},v))}),f.jsxs("div",{style:Ne.footer,children:[f.jsx(Qf,{asChild:!0,children:f.jsx("button",{style:{...Ne.button,...Ne.cancelButton},children:"Cancel"})}),f.jsx("button",{style:{...Ne.button,...Ne.generateButton,...!s||l?Ne.disabledButton:{}},onClick:()=>s&&n(s),disabled:!s||l,children:"Generate Note"})]})]})]})}),f.jsx(G_,{isOpen:h!==null,onClose:()=>p(null),template:h})]})}function mt(t){this.content=t}mt.prototype={constructor:mt,find:function(t){for(var e=0;e<this.content.length;e+=2)if(this.content[e]===t)return e;return-1},get:function(t){var e=this.find(t);return e==-1?void 0:this.content[e+1]},update:function(t,e,n){var r=n&&n!=t?this.remove(n):this,i=r.find(t),o=r.content.slice();return i==-1?o.push(n||t,e):(o[i+1]=e,n&&(o[i]=n)),new mt(o)},remove:function(t){var e=this.find(t);if(e==-1)return this;var n=this.content.slice();return n.splice(e,2),new mt(n)},addToStart:function(t,e){return new mt([t,e].concat(this.remove(t).content))},addToEnd:function(t,e){var n=this.remove(t).content.slice();return n.push(t,e),new mt(n)},addBefore:function(t,e,n){var r=this.remove(e),i=r.content.slice(),o=r.find(t);return i.splice(o==-1?i.length:o,0,e,n),new mt(i)},forEach:function(t){for(var e=0;e<this.content.length;e+=2)t(this.content[e],this.content[e+1])},prepend:function(t){return t=mt.from(t),t.size?new mt(t.content.concat(this.subtract(t).content)):this},append:function(t){return t=mt.from(t),t.size?new mt(this.subtract(t).content.concat(t.content)):this},subtract:function(t){var e=this;t=mt.from(t);for(var n=0;n<t.content.length;n+=2)e=e.remove(t.content[n]);return e},toObject:function(){var t={};return this.forEach(function(e,n){t[e]=n}),t},get size(){return this.content.length>>1}};mt.from=function(t){if(t instanceof mt)return t;var e=[];if(t)for(var n in t)e.push(n,t[n]);return new mt(e)};function J_(t,e,n){for(let r=0;;r++){if(r==t.childCount||r==e.childCount)return t.childCount==e.childCount?null:n;let i=t.child(r),o=e.child(r);if(i==o){n+=i.nodeSize;continue}if(!i.sameMarkup(o))return n;if(i.isText&&i.text!=o.text){for(let s=0;i.text[s]==o.text[s];s++)n++;return n}if(i.content.size||o.content.size){let s=J_(i.content,o.content,n+1);if(s!=null)return s}n+=i.nodeSize}}function Y_(t,e,n,r){for(let i=t.childCount,o=e.childCount;;){if(i==0||o==0)return i==o?null:{a:n,b:r};let s=t.child(--i),a=e.child(--o),l=s.nodeSize;if(s==a){n-=l,r-=l;continue}if(!s.sameMarkup(a))return{a:n,b:r};if(s.isText&&s.text!=a.text){let c=0,u=Math.min(s.text.length,a.text.length);for(;c<u&&s.text[s.text.length-c-1]==a.text[a.text.length-c-1];)c++,n--,r--;return{a:n,b:r}}if(s.content.size||a.content.size){let c=Y_(s.content,a.content,n-1,r-1);if(c)return c}n-=l,r-=l}}class F{constructor(e,n){if(this.content=e,this.size=n||0,n==null)for(let r=0;r<e.length;r++)this.size+=e[r].nodeSize}nodesBetween(e,n,r,i=0,o){for(let s=0,a=0;a<n;s++){let l=this.content[s],c=a+l.nodeSize;if(c>e&&r(l,i+a,o||null,s)!==!1&&l.content.size){let u=a+1;l.nodesBetween(Math.max(0,e-u),Math.min(l.content.size,n-u),r,i+u)}a=c}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,n,r,i){let o="",s=!0;return this.nodesBetween(e,n,(a,l)=>{let c=a.isText?a.text.slice(Math.max(e,l)-l,n-l):a.isLeaf?i?typeof i=="function"?i(a):i:a.type.spec.leafText?a.type.spec.leafText(a):"":"";a.isBlock&&(a.isLeaf&&c||a.isTextblock)&&r&&(s?s=!1:o+=r),o+=c},0),o}append(e){if(!e.size)return this;if(!this.size)return e;let n=this.lastChild,r=e.firstChild,i=this.content.slice(),o=0;for(n.isText&&n.sameMarkup(r)&&(i[i.length-1]=n.withText(n.text+r.text),o=1);o<e.content.length;o++)i.push(e.content[o]);return new F(i,this.size+e.size)}cut(e,n=this.size){if(e==0&&n==this.size)return this;let r=[],i=0;if(n>e)for(let o=0,s=0;s<n;o++){let a=this.content[o],l=s+a.nodeSize;l>e&&((s<e||l>n)&&(a.isText?a=a.cut(Math.max(0,e-s),Math.min(a.text.length,n-s)):a=a.cut(Math.max(0,e-s-1),Math.min(a.content.size,n-s-1))),r.push(a),i+=a.nodeSize),s=l}return new F(r,i)}cutByIndex(e,n){return e==n?F.empty:e==0&&n==this.content.length?this:new F(this.content.slice(e,n))}replaceChild(e,n){let r=this.content[e];if(r==n)return this;let i=this.content.slice(),o=this.size+n.nodeSize-r.nodeSize;return i[e]=n,new F(i,o)}addToStart(e){return new F([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new F(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let n=0;n<this.content.length;n++)if(!this.content[n].eq(e.content[n]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let n=this.content[e];if(!n)throw new RangeError("Index "+e+" out of range for "+this);return n}maybeChild(e){return this.content[e]||null}forEach(e){for(let n=0,r=0;n<this.content.length;n++){let i=this.content[n];e(i,r,n),r+=i.nodeSize}}findDiffStart(e,n=0){return J_(this,e,n)}findDiffEnd(e,n=this.size,r=e.size){return Y_(this,e,n,r)}findIndex(e,n=-1){if(e==0)return Ld(0,e);if(e==this.size)return Ld(this.content.length,e);if(e>this.size||e<0)throw new RangeError(`Position ${e} outside of fragment (${this})`);for(let r=0,i=0;;r++){let o=this.child(r),s=i+o.nodeSize;if(s>=e)return s==e||n>0?Ld(r+1,s):Ld(r,i);i=s}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,n){if(!n)return F.empty;if(!Array.isArray(n))throw new RangeError("Invalid input for Fragment.fromJSON");return new F(n.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return F.empty;let n,r=0;for(let i=0;i<e.length;i++){let o=e[i];r+=o.nodeSize,i&&o.isText&&e[i-1].sameMarkup(o)?(n||(n=e.slice(0,i)),n[n.length-1]=o.withText(n[n.length-1].text+o.text)):n&&n.push(o)}return new F(n||e,r)}static from(e){if(!e)return F.empty;if(e instanceof F)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new F([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}F.empty=new F([],0);const Em={index:0,offset:0};function Ld(t,e){return Em.index=t,Em.offset=e,Em}function oh(t,e){if(t===e)return!0;if(!(t&&typeof t=="object")||!(e&&typeof e=="object"))return!1;let n=Array.isArray(t);if(Array.isArray(e)!=n)return!1;if(n){if(t.length!=e.length)return!1;for(let r=0;r<t.length;r++)if(!oh(t[r],e[r]))return!1}else{for(let r in t)if(!(r in e)||!oh(t[r],e[r]))return!1;for(let r in e)if(!(r in t))return!1}return!0}let Re=class My{constructor(e,n){this.type=e,this.attrs=n}addToSet(e){let n,r=!1;for(let i=0;i<e.length;i++){let o=e[i];if(this.eq(o))return e;if(this.type.excludes(o.type))n||(n=e.slice(0,i));else{if(o.type.excludes(this.type))return e;!r&&o.type.rank>this.type.rank&&(n||(n=e.slice(0,i)),n.push(this),r=!0),n&&n.push(o)}}return n||(n=e.slice()),r||n.push(this),n}removeFromSet(e){for(let n=0;n<e.length;n++)if(this.eq(e[n]))return e.slice(0,n).concat(e.slice(n+1));return e}isInSet(e){for(let n=0;n<e.length;n++)if(this.eq(e[n]))return!0;return!1}eq(e){return this==e||this.type==e.type&&oh(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let n in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,n){if(!n)throw new RangeError("Invalid input for Mark.fromJSON");let r=e.marks[n.type];if(!r)throw new RangeError(`There is no mark type ${n.type} in this schema`);let i=r.create(n.attrs);return r.checkAttrs(i.attrs),i}static sameSet(e,n){if(e==n)return!0;if(e.length!=n.length)return!1;for(let r=0;r<e.length;r++)if(!e[r].eq(n[r]))return!1;return!0}static setFrom(e){if(!e||Array.isArray(e)&&e.length==0)return My.none;if(e instanceof My)return[e];let n=e.slice();return n.sort((r,i)=>r.type.rank-i.type.rank),n}};Re.none=[];class sh extends Error{}class q{constructor(e,n,r){this.content=e,this.openStart=n,this.openEnd=r}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,n){let r=X_(this.content,e+this.openStart,n);return r&&new q(r,this.openStart,this.openEnd)}removeBetween(e,n){return new q(Q_(this.content,e+this.openStart,n+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,n){if(!n)return q.empty;let r=n.openStart||0,i=n.openEnd||0;if(typeof r!="number"||typeof i!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new q(F.fromJSON(e,n.content),r,i)}static maxOpen(e,n=!0){let r=0,i=0;for(let o=e.firstChild;o&&!o.isLeaf&&(n||!o.type.spec.isolating);o=o.firstChild)r++;for(let o=e.lastChild;o&&!o.isLeaf&&(n||!o.type.spec.isolating);o=o.lastChild)i++;return new q(e,r,i)}}q.empty=new q(F.empty,0,0);function Q_(t,e,n){let{index:r,offset:i}=t.findIndex(e),o=t.maybeChild(r),{index:s,offset:a}=t.findIndex(n);if(i==e||o.isText){if(a!=n&&!t.child(s).isText)throw new RangeError("Removing non-flat range");return t.cut(0,e).append(t.cut(n))}if(r!=s)throw new RangeError("Removing non-flat range");return t.replaceChild(r,o.copy(Q_(o.content,e-i-1,n-i-1)))}function X_(t,e,n,r){let{index:i,offset:o}=t.findIndex(e),s=t.maybeChild(i);if(o==e||s.isText)return r&&!r.canReplace(i,i,n)?null:t.cut(0,e).append(n).append(t.cut(e));let a=X_(s.content,e-o-1,n);return a&&t.replaceChild(i,s.copy(a))}function u5(t,e,n){if(n.openStart>t.depth)throw new sh("Inserted content deeper than insertion position");if(t.depth-n.openStart!=e.depth-n.openEnd)throw new sh("Inconsistent open depths");return Z_(t,e,n,0)}function Z_(t,e,n,r){let i=t.index(r),o=t.node(r);if(i==e.index(r)&&r<t.depth-n.openStart){let s=Z_(t,e,n,r+1);return o.copy(o.content.replaceChild(i,s))}else if(n.content.size)if(!n.openStart&&!n.openEnd&&t.depth==r&&e.depth==r){let s=t.parent,a=s.content;return xs(s,a.cut(0,t.parentOffset).append(n.content).append(a.cut(e.parentOffset)))}else{let{start:s,end:a}=d5(n,t);return xs(o,tR(t,s,a,e,r))}else return xs(o,ah(t,e,r))}function eR(t,e){if(!e.type.compatibleContent(t.type))throw new sh("Cannot join "+e.type.name+" onto "+t.type.name)}function Iy(t,e,n){let r=t.node(n);return eR(r,e.node(n)),r}function vs(t,e){let n=e.length-1;n>=0&&t.isText&&t.sameMarkup(e[n])?e[n]=t.withText(e[n].text+t.text):e.push(t)}function Ic(t,e,n,r){let i=(e||t).node(n),o=0,s=e?e.index(n):i.childCount;t&&(o=t.index(n),t.depth>n?o++:t.textOffset&&(vs(t.nodeAfter,r),o++));for(let a=o;a<s;a++)vs(i.child(a),r);e&&e.depth==n&&e.textOffset&&vs(e.nodeBefore,r)}function xs(t,e){return t.type.checkContent(e),t.copy(e)}function tR(t,e,n,r,i){let o=t.depth>i&&Iy(t,e,i+1),s=r.depth>i&&Iy(n,r,i+1),a=[];return Ic(null,t,i,a),o&&s&&e.index(i)==n.index(i)?(eR(o,s),vs(xs(o,tR(t,e,n,r,i+1)),a)):(o&&vs(xs(o,ah(t,e,i+1)),a),Ic(e,n,i,a),s&&vs(xs(s,ah(n,r,i+1)),a)),Ic(r,null,i,a),new F(a)}function ah(t,e,n){let r=[];if(Ic(null,t,n,r),t.depth>n){let i=Iy(t,e,n+1);vs(xs(i,ah(t,e,n+1)),r)}return Ic(e,null,n,r),new F(r)}function d5(t,e){let n=e.depth-t.openStart,i=e.node(n).copy(t.content);for(let o=n-1;o>=0;o--)i=e.node(o).copy(F.from(i));return{start:i.resolveNoCache(t.openStart+n),end:i.resolveNoCache(i.content.size-t.openEnd-n)}}class du{constructor(e,n,r){this.pos=e,this.path=n,this.parentOffset=r,this.depth=n.length/3-1}resolveDepth(e){return e==null?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[this.resolveDepth(e)*3]}index(e){return this.path[this.resolveDepth(e)*3+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e==this.depth&&!this.textOffset?0:1)}start(e){return e=this.resolveDepth(e),e==0?0:this.path[e*3-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]}after(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]+this.path[e*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,n=this.index(this.depth);if(n==e.childCount)return null;let r=this.pos-this.path[this.path.length-1],i=e.child(n);return r?e.child(n).cut(r):i}get nodeBefore(){let e=this.index(this.depth),n=this.pos-this.path[this.path.length-1];return n?this.parent.child(e).cut(0,n):e==0?null:this.parent.child(e-1)}posAtIndex(e,n){n=this.resolveDepth(n);let r=this.path[n*3],i=n==0?0:this.path[n*3-1]+1;for(let o=0;o<e;o++)i+=r.child(o).nodeSize;return i}marks(){let e=this.parent,n=this.index();if(e.content.size==0)return Re.none;if(this.textOffset)return e.child(n).marks;let r=e.maybeChild(n-1),i=e.maybeChild(n);if(!r){let a=r;r=i,i=a}let o=r.marks;for(var s=0;s<o.length;s++)o[s].type.spec.inclusive===!1&&(!i||!o[s].isInSet(i.marks))&&(o=o[s--].removeFromSet(o));return o}marksAcross(e){let n=this.parent.maybeChild(this.index());if(!n||!n.isInline)return null;let r=n.marks,i=e.parent.maybeChild(e.index());for(var o=0;o<r.length;o++)r[o].type.spec.inclusive===!1&&(!i||!r[o].isInSet(i.marks))&&(r=r[o--].removeFromSet(r));return r}sharedDepth(e){for(let n=this.depth;n>0;n--)if(this.start(n)<=e&&this.end(n)>=e)return n;return 0}blockRange(e=this,n){if(e.pos<this.pos)return e.blockRange(this);for(let r=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);r>=0;r--)if(e.pos<=this.end(r)&&(!n||n(this.node(r))))return new lh(this,e,r);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let n=1;n<=this.depth;n++)e+=(e?"/":"")+this.node(n).type.name+"_"+this.index(n-1);return e+":"+this.parentOffset}static resolve(e,n){if(!(n>=0&&n<=e.content.size))throw new RangeError("Position "+n+" out of range");let r=[],i=0,o=n;for(let s=e;;){let{index:a,offset:l}=s.content.findIndex(o),c=o-l;if(r.push(s,a,i+l),!c||(s=s.child(a),s.isText))break;o=c-1,i+=l+1}return new du(n,r,o)}static resolveCached(e,n){let r=Qb.get(e);if(r)for(let o=0;o<r.elts.length;o++){let s=r.elts[o];if(s.pos==n)return s}else Qb.set(e,r=new f5);let i=r.elts[r.i]=du.resolve(e,n);return r.i=(r.i+1)%h5,i}}class f5{constructor(){this.elts=[],this.i=0}}const h5=12,Qb=new WeakMap;class lh{constructor(e,n,r){this.$from=e,this.$to=n,this.depth=r}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const p5=Object.create(null);let xo=class Ay{constructor(e,n,r,i=Re.none){this.type=e,this.attrs=n,this.marks=i,this.content=r||F.empty}get children(){return this.content.content}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,n,r,i=0){this.content.nodesBetween(e,n,r,i,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,n,r,i){return this.content.textBetween(e,n,r,i)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,n,r){return this.type==e&&oh(this.attrs,n||e.defaultAttrs||p5)&&Re.sameSet(this.marks,r||Re.none)}copy(e=null){return e==this.content?this:new Ay(this.type,this.attrs,e,this.marks)}mark(e){return e==this.marks?this:new Ay(this.type,this.attrs,this.content,e)}cut(e,n=this.content.size){return e==0&&n==this.content.size?this:this.copy(this.content.cut(e,n))}slice(e,n=this.content.size,r=!1){if(e==n)return q.empty;let i=this.resolve(e),o=this.resolve(n),s=r?0:i.sharedDepth(n),a=i.start(s),c=i.node(s).content.cut(i.pos-a,o.pos-a);return new q(c,i.depth-s,o.depth-s)}replace(e,n,r){return u5(this.resolve(e),this.resolve(n),r)}nodeAt(e){for(let n=this;;){let{index:r,offset:i}=n.content.findIndex(e);if(n=n.maybeChild(r),!n)return null;if(i==e||n.isText)return n;e-=i+1}}childAfter(e){let{index:n,offset:r}=this.content.findIndex(e);return{node:this.content.maybeChild(n),index:n,offset:r}}childBefore(e){if(e==0)return{node:null,index:0,offset:0};let{index:n,offset:r}=this.content.findIndex(e);if(r<e)return{node:this.content.child(n),index:n,offset:r};let i=this.content.child(n-1);return{node:i,index:n-1,offset:r-i.nodeSize}}resolve(e){return du.resolveCached(this,e)}resolveNoCache(e){return du.resolve(this,e)}rangeHasMark(e,n,r){let i=!1;return n>e&&this.nodesBetween(e,n,o=>(r.isInSet(o.marks)&&(i=!0),!i)),i}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),nR(this.marks,e)}contentMatchAt(e){let n=this.type.contentMatch.matchFragment(this.content,0,e);if(!n)throw new Error("Called contentMatchAt on a node with invalid content");return n}canReplace(e,n,r=F.empty,i=0,o=r.childCount){let s=this.contentMatchAt(e).matchFragment(r,i,o),a=s&&s.matchFragment(this.content,n);if(!a||!a.validEnd)return!1;for(let l=i;l<o;l++)if(!this.type.allowsMarks(r.child(l).marks))return!1;return!0}canReplaceWith(e,n,r,i){if(i&&!this.type.allowsMarks(i))return!1;let o=this.contentMatchAt(e).matchType(r),s=o&&o.matchFragment(this.content,n);return s?s.validEnd:!1}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let e=Re.none;for(let n=0;n<this.marks.length;n++){let r=this.marks[n];r.type.checkAttrs(r.attrs),e=r.addToSet(e)}if(!Re.sameSet(e,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(n=>n.type.name)}`);this.content.forEach(n=>n.check())}toJSON(){let e={type:this.type.name};for(let n in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map(n=>n.toJSON())),e}static fromJSON(e,n){if(!n)throw new RangeError("Invalid input for Node.fromJSON");let r;if(n.marks){if(!Array.isArray(n.marks))throw new RangeError("Invalid mark data for Node.fromJSON");r=n.marks.map(e.markFromJSON)}if(n.type=="text"){if(typeof n.text!="string")throw new RangeError("Invalid text node in JSON");return e.text(n.text,r)}let i=F.fromJSON(e,n.content),o=e.nodeType(n.type).create(n.attrs,i,r);return o.type.checkAttrs(o.attrs),o}};xo.prototype.text=void 0;class ch extends xo{constructor(e,n,r,i){if(super(e,n,null,i),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):nR(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(e,n){return this.text.slice(e,n)}get nodeSize(){return this.text.length}mark(e){return e==this.marks?this:new ch(this.type,this.attrs,this.text,e)}withText(e){return e==this.text?this:new ch(this.type,this.attrs,e,this.marks)}cut(e=0,n=this.text.length){return e==0&&n==this.text.length?this:this.withText(this.text.slice(e,n))}eq(e){return this.sameMarkup(e)&&this.text==e.text}toJSON(){let e=super.toJSON();return e.text=this.text,e}}function nR(t,e){for(let n=t.length-1;n>=0;n--)e=t[n].type.name+"("+e+")";return e}class zs{constructor(e){this.validEnd=e,this.next=[],this.wrapCache=[]}static parse(e,n){let r=new m5(e,n);if(r.next==null)return zs.empty;let i=rR(r);r.next&&r.err("Unexpected trailing text");let o=S5(b5(i));return C5(o,r),o}matchType(e){for(let n=0;n<this.next.length;n++)if(this.next[n].type==e)return this.next[n].next;return null}matchFragment(e,n=0,r=e.childCount){let i=this;for(let o=n;i&&o<r;o++)i=i.matchType(e.child(o).type);return i}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let e=0;e<this.next.length;e++){let{type:n}=this.next[e];if(!(n.isText||n.hasRequiredAttrs()))return n}return null}compatible(e){for(let n=0;n<this.next.length;n++)for(let r=0;r<e.next.length;r++)if(this.next[n].type==e.next[r].type)return!0;return!1}fillBefore(e,n=!1,r=0){let i=[this];function o(s,a){let l=s.matchFragment(e,r);if(l&&(!n||l.validEnd))return F.from(a.map(c=>c.createAndFill()));for(let c=0;c<s.next.length;c++){let{type:u,next:d}=s.next[c];if(!(u.isText||u.hasRequiredAttrs())&&i.indexOf(d)==-1){i.push(d);let h=o(d,a.concat(u));if(h)return h}}return null}return o(this,[])}findWrapping(e){for(let r=0;r<this.wrapCache.length;r+=2)if(this.wrapCache[r]==e)return this.wrapCache[r+1];let n=this.computeWrapping(e);return this.wrapCache.push(e,n),n}computeWrapping(e){let n=Object.create(null),r=[{match:this,type:null,via:null}];for(;r.length;){let i=r.shift(),o=i.match;if(o.matchType(e)){let s=[];for(let a=i;a.type;a=a.via)s.push(a.type);return s.reverse()}for(let s=0;s<o.next.length;s++){let{type:a,next:l}=o.next[s];!a.isLeaf&&!a.hasRequiredAttrs()&&!(a.name in n)&&(!i.type||l.validEnd)&&(r.push({match:a.contentMatch,type:a,via:i}),n[a.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(e){if(e>=this.next.length)throw new RangeError(`There's no ${e}th edge in this content match`);return this.next[e]}toString(){let e=[];function n(r){e.push(r);for(let i=0;i<r.next.length;i++)e.indexOf(r.next[i].next)==-1&&n(r.next[i].next)}return n(this),e.map((r,i)=>{let o=i+(r.validEnd?"*":" ")+" ";for(let s=0;s<r.next.length;s++)o+=(s?", ":"")+r.next[s].type.name+"->"+e.indexOf(r.next[s].next);return o}).join(`
`)}}zs.empty=new zs(!0);class m5{constructor(e,n){this.string=e,this.nodeTypes=n,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")}}function rR(t){let e=[];do e.push(g5(t));while(t.eat("|"));return e.length==1?e[0]:{type:"choice",exprs:e}}function g5(t){let e=[];do e.push(y5(t));while(t.next&&t.next!=")"&&t.next!="|");return e.length==1?e[0]:{type:"seq",exprs:e}}function y5(t){let e=w5(t);for(;;)if(t.eat("+"))e={type:"plus",expr:e};else if(t.eat("*"))e={type:"star",expr:e};else if(t.eat("?"))e={type:"opt",expr:e};else if(t.eat("{"))e=v5(t,e);else break;return e}function Xb(t){/\D/.test(t.next)&&t.err("Expected number, got '"+t.next+"'");let e=Number(t.next);return t.pos++,e}function v5(t,e){let n=Xb(t),r=n;return t.eat(",")&&(t.next!="}"?r=Xb(t):r=-1),t.eat("}")||t.err("Unclosed braced range"),{type:"range",min:n,max:r,expr:e}}function x5(t,e){let n=t.nodeTypes,r=n[e];if(r)return[r];let i=[];for(let o in n){let s=n[o];s.isInGroup(e)&&i.push(s)}return i.length==0&&t.err("No node type or group '"+e+"' found"),i}function w5(t){if(t.eat("(")){let e=rR(t);return t.eat(")")||t.err("Missing closing paren"),e}else if(/\W/.test(t.next))t.err("Unexpected token '"+t.next+"'");else{let e=x5(t,t.next).map(n=>(t.inline==null?t.inline=n.isInline:t.inline!=n.isInline&&t.err("Mixing inline and block content"),{type:"name",value:n}));return t.pos++,e.length==1?e[0]:{type:"choice",exprs:e}}}function b5(t){let e=[[]];return i(o(t,0),n()),e;function n(){return e.push([])-1}function r(s,a,l){let c={term:l,to:a};return e[s].push(c),c}function i(s,a){s.forEach(l=>l.to=a)}function o(s,a){if(s.type=="choice")return s.exprs.reduce((l,c)=>l.concat(o(c,a)),[]);if(s.type=="seq")for(let l=0;;l++){let c=o(s.exprs[l],a);if(l==s.exprs.length-1)return c;i(c,a=n())}else if(s.type=="star"){let l=n();return r(a,l),i(o(s.expr,l),l),[r(l)]}else if(s.type=="plus"){let l=n();return i(o(s.expr,a),l),i(o(s.expr,l),l),[r(l)]}else{if(s.type=="opt")return[r(a)].concat(o(s.expr,a));if(s.type=="range"){let l=a;for(let c=0;c<s.min;c++){let u=n();i(o(s.expr,l),u),l=u}if(s.max==-1)i(o(s.expr,l),l);else for(let c=s.min;c<s.max;c++){let u=n();r(l,u),i(o(s.expr,l),u),l=u}return[r(l)]}else{if(s.type=="name")return[r(a,void 0,s.value)];throw new Error("Unknown expr type")}}}}function iR(t,e){return e-t}function Zb(t,e){let n=[];return r(e),n.sort(iR);function r(i){let o=t[i];if(o.length==1&&!o[0].term)return r(o[0].to);n.push(i);for(let s=0;s<o.length;s++){let{term:a,to:l}=o[s];!a&&n.indexOf(l)==-1&&r(l)}}}function S5(t){let e=Object.create(null);return n(Zb(t,0));function n(r){let i=[];r.forEach(s=>{t[s].forEach(({term:a,to:l})=>{if(!a)return;let c;for(let u=0;u<i.length;u++)i[u][0]==a&&(c=i[u][1]);Zb(t,l).forEach(u=>{c||i.push([a,c=[]]),c.indexOf(u)==-1&&c.push(u)})})});let o=e[r.join(",")]=new zs(r.indexOf(t.length-1)>-1);for(let s=0;s<i.length;s++){let a=i[s][1].sort(iR);o.next.push({type:i[s][0],next:e[a.join(",")]||n(a)})}return o}}function C5(t,e){for(let n=0,r=[t];n<r.length;n++){let i=r[n],o=!i.validEnd,s=[];for(let a=0;a<i.next.length;a++){let{type:l,next:c}=i.next[a];s.push(l.name),o&&!(l.isText||l.hasRequiredAttrs())&&(o=!1),r.indexOf(c)==-1&&r.push(c)}o&&e.err("Only non-generatable nodes ("+s.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function oR(t){let e=Object.create(null);for(let n in t){let r=t[n];if(!r.hasDefault)return null;e[n]=r.default}return e}function sR(t,e){let n=Object.create(null);for(let r in t){let i=e&&e[r];if(i===void 0){let o=t[r];if(o.hasDefault)i=o.default;else throw new RangeError("No value supplied for attribute "+r)}n[r]=i}return n}function aR(t,e,n,r){for(let i in e)if(!(i in t))throw new RangeError(`Unsupported attribute ${i} for ${n} of type ${i}`);for(let i in t){let o=t[i];o.validate&&o.validate(e[i])}}function lR(t,e){let n=Object.create(null);if(e)for(let r in e)n[r]=new E5(t,r,e[r]);return n}let e1=class cR{constructor(e,n,r){this.name=e,this.schema=n,this.spec=r,this.markSet=null,this.groups=r.group?r.group.split(" "):[],this.attrs=lR(e,r.attrs),this.defaultAttrs=oR(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(r.inline||e=="text"),this.isText=e=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==zs.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(e){return this.groups.indexOf(e)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}compatibleContent(e){return this==e||this.contentMatch.compatible(e.contentMatch)}computeAttrs(e){return!e&&this.defaultAttrs?this.defaultAttrs:sR(this.attrs,e)}create(e=null,n,r){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new xo(this,this.computeAttrs(e),F.from(n),Re.setFrom(r))}createChecked(e=null,n,r){return n=F.from(n),this.checkContent(n),new xo(this,this.computeAttrs(e),n,Re.setFrom(r))}createAndFill(e=null,n,r){if(e=this.computeAttrs(e),n=F.from(n),n.size){let s=this.contentMatch.fillBefore(n);if(!s)return null;n=s.append(n)}let i=this.contentMatch.matchFragment(n),o=i&&i.fillBefore(F.empty,!0);return o?new xo(this,e,n.append(o),Re.setFrom(r)):null}validContent(e){let n=this.contentMatch.matchFragment(e);if(!n||!n.validEnd)return!1;for(let r=0;r<e.childCount;r++)if(!this.allowsMarks(e.child(r).marks))return!1;return!0}checkContent(e){if(!this.validContent(e))throw new RangeError(`Invalid content for node ${this.name}: ${e.toString().slice(0,50)}`)}checkAttrs(e){aR(this.attrs,e,"node",this.name)}allowsMarkType(e){return this.markSet==null||this.markSet.indexOf(e)>-1}allowsMarks(e){if(this.markSet==null)return!0;for(let n=0;n<e.length;n++)if(!this.allowsMarkType(e[n].type))return!1;return!0}allowedMarks(e){if(this.markSet==null)return e;let n;for(let r=0;r<e.length;r++)this.allowsMarkType(e[r].type)?n&&n.push(e[r]):n||(n=e.slice(0,r));return n?n.length?n:Re.none:e}static compile(e,n){let r=Object.create(null);e.forEach((o,s)=>r[o]=new cR(o,n,s));let i=n.spec.topNode||"doc";if(!r[i])throw new RangeError("Schema is missing its top node type ('"+i+"')");if(!r.text)throw new RangeError("Every schema needs a 'text' type");for(let o in r.text.attrs)throw new RangeError("The text node type should not have attributes");return r}};function k5(t,e,n){let r=n.split("|");return i=>{let o=i===null?"null":typeof i;if(r.indexOf(o)<0)throw new RangeError(`Expected value of type ${r} for attribute ${e} on type ${t}, got ${o}`)}}class E5{constructor(e,n,r){this.hasDefault=Object.prototype.hasOwnProperty.call(r,"default"),this.default=r.default,this.validate=typeof r.validate=="string"?k5(e,n,r.validate):r.validate}get isRequired(){return!this.hasDefault}}class ap{constructor(e,n,r,i){this.name=e,this.rank=n,this.schema=r,this.spec=i,this.attrs=lR(e,i.attrs),this.excluded=null;let o=oR(this.attrs);this.instance=o?new Re(this,o):null}create(e=null){return!e&&this.instance?this.instance:new Re(this,sR(this.attrs,e))}static compile(e,n){let r=Object.create(null),i=0;return e.forEach((o,s)=>r[o]=new ap(o,i++,n,s)),r}removeFromSet(e){for(var n=0;n<e.length;n++)e[n].type==this&&(e=e.slice(0,n).concat(e.slice(n+1)),n--);return e}isInSet(e){for(let n=0;n<e.length;n++)if(e[n].type==this)return e[n]}checkAttrs(e){aR(this.attrs,e,"mark",this.name)}excludes(e){return this.excluded.indexOf(e)>-1}}class uR{constructor(e){this.linebreakReplacement=null,this.cached=Object.create(null);let n=this.spec={};for(let i in e)n[i]=e[i];n.nodes=mt.from(e.nodes),n.marks=mt.from(e.marks||{}),this.nodes=e1.compile(this.spec.nodes,this),this.marks=ap.compile(this.spec.marks,this);let r=Object.create(null);for(let i in this.nodes){if(i in this.marks)throw new RangeError(i+" can not be both a node and a mark");let o=this.nodes[i],s=o.spec.content||"",a=o.spec.marks;if(o.contentMatch=r[s]||(r[s]=zs.parse(s,this.nodes)),o.inlineContent=o.contentMatch.inlineContent,o.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!o.isInline||!o.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=o}o.markSet=a=="_"?null:a?t1(this,a.split(" ")):a==""||!o.inlineContent?[]:null}for(let i in this.marks){let o=this.marks[i],s=o.spec.excludes;o.excluded=s==null?[o]:s==""?[]:t1(this,s.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(e,n=null,r,i){if(typeof e=="string")e=this.nodeType(e);else if(e instanceof e1){if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}else throw new RangeError("Invalid node type: "+e);return e.createChecked(n,r,i)}text(e,n){let r=this.nodes.text;return new ch(r,r.defaultAttrs,e,Re.setFrom(n))}mark(e,n){return typeof e=="string"&&(e=this.marks[e]),e.create(n)}nodeFromJSON(e){return xo.fromJSON(this,e)}markFromJSON(e){return Re.fromJSON(this,e)}nodeType(e){let n=this.nodes[e];if(!n)throw new RangeError("Unknown node type: "+e);return n}}function t1(t,e){let n=[];for(let r=0;r<e.length;r++){let i=e[r],o=t.marks[i],s=o;if(o)n.push(o);else for(let a in t.marks){let l=t.marks[a];(i=="_"||l.spec.group&&l.spec.group.split(" ").indexOf(i)>-1)&&n.push(s=l)}if(!s)throw new SyntaxError("Unknown mark type: '"+e[r]+"'")}return n}function T5(t){return t.tag!=null}function _5(t){return t.style!=null}class wo{constructor(e,n){this.schema=e,this.rules=n,this.tags=[],this.styles=[];let r=this.matchedStyles=[];n.forEach(i=>{if(T5(i))this.tags.push(i);else if(_5(i)){let o=/[^=]*/.exec(i.style)[0];r.indexOf(o)<0&&r.push(o),this.styles.push(i)}}),this.normalizeLists=!this.tags.some(i=>{if(!/^(ul|ol)\b/.test(i.tag)||!i.node)return!1;let o=e.nodes[i.node];return o.contentMatch.matchType(o)})}parse(e,n={}){let r=new r1(this,n,!1);return r.addAll(e,Re.none,n.from,n.to),r.finish()}parseSlice(e,n={}){let r=new r1(this,n,!0);return r.addAll(e,Re.none,n.from,n.to),q.maxOpen(r.finish())}matchTag(e,n,r){for(let i=r?this.tags.indexOf(r)+1:0;i<this.tags.length;i++){let o=this.tags[i];if(P5(e,o.tag)&&(o.namespace===void 0||e.namespaceURI==o.namespace)&&(!o.context||n.matchesContext(o.context))){if(o.getAttrs){let s=o.getAttrs(e);if(s===!1)continue;o.attrs=s||void 0}return o}}}matchStyle(e,n,r,i){for(let o=i?this.styles.indexOf(i)+1:0;o<this.styles.length;o++){let s=this.styles[o],a=s.style;if(!(a.indexOf(e)!=0||s.context&&!r.matchesContext(s.context)||a.length>e.length&&(a.charCodeAt(e.length)!=61||a.slice(e.length+1)!=n))){if(s.getAttrs){let l=s.getAttrs(n);if(l===!1)continue;s.attrs=l||void 0}return s}}}static schemaRules(e){let n=[];function r(i){let o=i.priority==null?50:i.priority,s=0;for(;s<n.length;s++){let a=n[s];if((a.priority==null?50:a.priority)<o)break}n.splice(s,0,i)}for(let i in e.marks){let o=e.marks[i].spec.parseDOM;o&&o.forEach(s=>{r(s=i1(s)),s.mark||s.ignore||s.clearMark||(s.mark=i)})}for(let i in e.nodes){let o=e.nodes[i].spec.parseDOM;o&&o.forEach(s=>{r(s=i1(s)),s.node||s.ignore||s.mark||(s.node=i)})}return n}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new wo(e,wo.schemaRules(e)))}}const dR={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},R5={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},fR={ol:!0,ul:!0},fu=1,Ny=2,Ac=4;function n1(t,e,n){return e!=null?(e?fu:0)|(e==="full"?Ny:0):t&&t.whitespace=="pre"?fu|Ny:n&~Ac}class $d{constructor(e,n,r,i,o,s){this.type=e,this.attrs=n,this.marks=r,this.solid=i,this.options=s,this.content=[],this.activeMarks=Re.none,this.match=o||(s&Ac?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let n=this.type.contentMatch.fillBefore(F.from(e));if(n)this.match=this.type.contentMatch.matchFragment(n);else{let r=this.type.contentMatch,i;return(i=r.findWrapping(e.type))?(this.match=r,i):null}}return this.match.findWrapping(e.type)}finish(e){if(!(this.options&fu)){let r=this.content[this.content.length-1],i;if(r&&r.isText&&(i=/[ \t\r\n\u000c]+$/.exec(r.text))){let o=r;r.text.length==i[0].length?this.content.pop():this.content[this.content.length-1]=o.withText(o.text.slice(0,o.text.length-i[0].length))}}let n=F.from(this.content);return!e&&this.match&&(n=n.append(this.match.fillBefore(F.empty,!0))),this.type?this.type.create(this.attrs,n,this.marks):n}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!dR.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}class r1{constructor(e,n,r){this.parser=e,this.options=n,this.isOpen=r,this.open=0,this.localPreserveWS=!1;let i=n.topNode,o,s=n1(null,n.preserveWhitespace,0)|(r?Ac:0);i?o=new $d(i.type,i.attrs,Re.none,!0,n.topMatch||i.type.contentMatch,s):r?o=new $d(null,null,Re.none,!0,null,s):o=new $d(e.schema.topNodeType,null,Re.none,!0,null,s),this.nodes=[o],this.find=n.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e,n){e.nodeType==3?this.addTextNode(e,n):e.nodeType==1&&this.addElement(e,n)}addTextNode(e,n){let r=e.nodeValue,i=this.top,o=i.options&Ny?"full":this.localPreserveWS||(i.options&fu)>0;if(o==="full"||i.inlineContext(e)||/[^ \t\r\n\u000c]/.test(r)){if(o)o!=="full"?r=r.replace(/\r?\n|\r/g," "):r=r.replace(/\r\n?/g,`
`);else if(r=r.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(r)&&this.open==this.nodes.length-1){let s=i.content[i.content.length-1],a=e.previousSibling;(!s||a&&a.nodeName=="BR"||s.isText&&/[ \t\r\n\u000c]$/.test(s.text))&&(r=r.slice(1))}r&&this.insertNode(this.parser.schema.text(r),n),this.findInText(e)}else this.findInside(e)}addElement(e,n,r){let i=this.localPreserveWS,o=this.top;(e.tagName=="PRE"||/pre/.test(e.style&&e.style.whiteSpace))&&(this.localPreserveWS=!0);let s=e.nodeName.toLowerCase(),a;fR.hasOwnProperty(s)&&this.parser.normalizeLists&&O5(e);let l=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(a=this.parser.matchTag(e,this,r));e:if(l?l.ignore:R5.hasOwnProperty(s))this.findInside(e),this.ignoreFallback(e,n);else if(!l||l.skip||l.closeParent){l&&l.closeParent?this.open=Math.max(0,this.open-1):l&&l.skip.nodeType&&(e=l.skip);let c,u=this.needsBlock;if(dR.hasOwnProperty(s))o.content.length&&o.content[0].isInline&&this.open&&(this.open--,o=this.top),c=!0,o.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e,n);break e}let d=l&&l.skip?n:this.readStyles(e,n);d&&this.addAll(e,d),c&&this.sync(o),this.needsBlock=u}else{let c=this.readStyles(e,n);c&&this.addElementByRule(e,l,c,l.consuming===!1?a:void 0)}this.localPreserveWS=i}leafFallback(e,n){e.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode(`
`),n)}ignoreFallback(e,n){e.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"),n)}readStyles(e,n){let r=e.style;if(r&&r.length)for(let i=0;i<this.parser.matchedStyles.length;i++){let o=this.parser.matchedStyles[i],s=r.getPropertyValue(o);if(s)for(let a=void 0;;){let l=this.parser.matchStyle(o,s,this,a);if(!l)break;if(l.ignore)return null;if(l.clearMark?n=n.filter(c=>!l.clearMark(c)):n=n.concat(this.parser.schema.marks[l.mark].create(l.attrs)),l.consuming===!1)a=l;else break}}return n}addElementByRule(e,n,r,i){let o,s;if(n.node)if(s=this.parser.schema.nodes[n.node],s.isLeaf)this.insertNode(s.create(n.attrs),r)||this.leafFallback(e,r);else{let l=this.enter(s,n.attrs||null,r,n.preserveWhitespace);l&&(o=!0,r=l)}else{let l=this.parser.schema.marks[n.mark];r=r.concat(l.create(n.attrs))}let a=this.top;if(s&&s.isLeaf)this.findInside(e);else if(i)this.addElement(e,r,i);else if(n.getContent)this.findInside(e),n.getContent(e,this.parser.schema).forEach(l=>this.insertNode(l,r));else{let l=e;typeof n.contentElement=="string"?l=e.querySelector(n.contentElement):typeof n.contentElement=="function"?l=n.contentElement(e):n.contentElement&&(l=n.contentElement),this.findAround(e,l,!0),this.addAll(l,r),this.findAround(e,l,!1)}o&&this.sync(a)&&this.open--}addAll(e,n,r,i){let o=r||0;for(let s=r?e.childNodes[r]:e.firstChild,a=i==null?null:e.childNodes[i];s!=a;s=s.nextSibling,++o)this.findAtPoint(e,o),this.addDOM(s,n);this.findAtPoint(e,o)}findPlace(e,n){let r,i;for(let o=this.open;o>=0;o--){let s=this.nodes[o],a=s.findWrapping(e);if(a&&(!r||r.length>a.length)&&(r=a,i=s,!a.length)||s.solid)break}if(!r)return null;this.sync(i);for(let o=0;o<r.length;o++)n=this.enterInner(r[o],null,n,!1);return n}insertNode(e,n){if(e.isInline&&this.needsBlock&&!this.top.type){let i=this.textblockFromContext();i&&(n=this.enterInner(i,null,n))}let r=this.findPlace(e,n);if(r){this.closeExtra();let i=this.top;i.match&&(i.match=i.match.matchType(e.type));let o=Re.none;for(let s of r.concat(e.marks))(i.type?i.type.allowsMarkType(s.type):o1(s.type,e.type))&&(o=s.addToSet(o));return i.content.push(e.mark(o)),!0}return!1}enter(e,n,r,i){let o=this.findPlace(e.create(n),r);return o&&(o=this.enterInner(e,n,r,!0,i)),o}enterInner(e,n,r,i=!1,o){this.closeExtra();let s=this.top;s.match=s.match&&s.match.matchType(e);let a=n1(e,o,s.options);s.options&Ac&&s.content.length==0&&(a|=Ac);let l=Re.none;return r=r.filter(c=>(s.type?s.type.allowsMarkType(c.type):o1(c.type,e))?(l=c.addToSet(l),!1):!0),this.nodes.push(new $d(e,n,l,i,null,a)),this.open++,r}closeExtra(e=!1){let n=this.nodes.length-1;if(n>this.open){for(;n>this.open;n--)this.nodes[n-1].content.push(this.nodes[n].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!!(this.isOpen||this.options.topOpen))}sync(e){for(let n=this.open;n>=0;n--){if(this.nodes[n]==e)return this.open=n,!0;this.localPreserveWS&&(this.nodes[n].options|=fu)}return!1}get currentPos(){this.closeExtra();let e=0;for(let n=this.open;n>=0;n--){let r=this.nodes[n].content;for(let i=r.length-1;i>=0;i--)e+=r[i].nodeSize;n&&e++}return e}findAtPoint(e,n){if(this.find)for(let r=0;r<this.find.length;r++)this.find[r].node==e&&this.find[r].offset==n&&(this.find[r].pos=this.currentPos)}findInside(e){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].pos==null&&e.nodeType==1&&e.contains(this.find[n].node)&&(this.find[n].pos=this.currentPos)}findAround(e,n,r){if(e!=n&&this.find)for(let i=0;i<this.find.length;i++)this.find[i].pos==null&&e.nodeType==1&&e.contains(this.find[i].node)&&n.compareDocumentPosition(this.find[i].node)&(r?2:4)&&(this.find[i].pos=this.currentPos)}findInText(e){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].node==e&&(this.find[n].pos=this.currentPos-(e.nodeValue.length-this.find[n].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let n=e.split("/"),r=this.options.context,i=!this.isOpen&&(!r||r.parent.type==this.nodes[0].type),o=-(r?r.depth+1:0)+(i?0:1),s=(a,l)=>{for(;a>=0;a--){let c=n[a];if(c==""){if(a==n.length-1||a==0)continue;for(;l>=o;l--)if(s(a-1,l))return!0;return!1}else{let u=l>0||l==0&&i?this.nodes[l].type:r&&l>=o?r.node(l-o).type:null;if(!u||u.name!=c&&!u.isInGroup(c))return!1;l--}}return!0};return s(n.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let n=e.depth;n>=0;n--){let r=e.node(n).contentMatchAt(e.indexAfter(n)).defaultType;if(r&&r.isTextblock&&r.defaultAttrs)return r}for(let n in this.parser.schema.nodes){let r=this.parser.schema.nodes[n];if(r.isTextblock&&r.defaultAttrs)return r}}}function O5(t){for(let e=t.firstChild,n=null;e;e=e.nextSibling){let r=e.nodeType==1?e.nodeName.toLowerCase():null;r&&fR.hasOwnProperty(r)&&n?(n.appendChild(e),e=n):r=="li"?n=e:r&&(n=null)}}function P5(t,e){return(t.matches||t.msMatchesSelector||t.webkitMatchesSelector||t.mozMatchesSelector).call(t,e)}function i1(t){let e={};for(let n in t)e[n]=t[n];return e}function o1(t,e){let n=e.schema.nodes;for(let r in n){let i=n[r];if(!i.allowsMarkType(t))continue;let o=[],s=a=>{o.push(a);for(let l=0;l<a.edgeCount;l++){let{type:c,next:u}=a.edge(l);if(c==e||o.indexOf(u)<0&&s(u))return!0}};if(s(i.contentMatch))return!0}}class Zs{constructor(e,n){this.nodes=e,this.marks=n}serializeFragment(e,n={},r){r||(r=Tm(n).createDocumentFragment());let i=r,o=[];return e.forEach(s=>{if(o.length||s.marks.length){let a=0,l=0;for(;a<o.length&&l<s.marks.length;){let c=s.marks[l];if(!this.marks[c.type.name]){l++;continue}if(!c.eq(o[a][0])||c.type.spec.spanning===!1)break;a++,l++}for(;a<o.length;)i=o.pop()[1];for(;l<s.marks.length;){let c=s.marks[l++],u=this.serializeMark(c,s.isInline,n);u&&(o.push([c,i]),i.appendChild(u.dom),i=u.contentDOM||u.dom)}}i.appendChild(this.serializeNodeInner(s,n))}),r}serializeNodeInner(e,n){let{dom:r,contentDOM:i}=gf(Tm(n),this.nodes[e.type.name](e),null,e.attrs);if(i){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(e.content,n,i)}return r}serializeNode(e,n={}){let r=this.serializeNodeInner(e,n);for(let i=e.marks.length-1;i>=0;i--){let o=this.serializeMark(e.marks[i],e.isInline,n);o&&((o.contentDOM||o.dom).appendChild(r),r=o.dom)}return r}serializeMark(e,n,r={}){let i=this.marks[e.type.name];return i&&gf(Tm(r),i(e,n),null,e.attrs)}static renderSpec(e,n,r=null,i){return gf(e,n,r,i)}static fromSchema(e){return e.cached.domSerializer||(e.cached.domSerializer=new Zs(this.nodesFromSchema(e),this.marksFromSchema(e)))}static nodesFromSchema(e){let n=s1(e.nodes);return n.text||(n.text=r=>r.text),n}static marksFromSchema(e){return s1(e.marks)}}function s1(t){let e={};for(let n in t){let r=t[n].spec.toDOM;r&&(e[n]=r)}return e}function Tm(t){return t.document||window.document}const a1=new WeakMap;function M5(t){let e=a1.get(t);return e===void 0&&a1.set(t,e=I5(t)),e}function I5(t){let e=null;function n(r){if(r&&typeof r=="object")if(Array.isArray(r))if(typeof r[0]=="string")e||(e=[]),e.push(r);else for(let i=0;i<r.length;i++)n(r[i]);else for(let i in r)n(r[i])}return n(t),e}function gf(t,e,n,r){if(typeof e=="string")return{dom:t.createTextNode(e)};if(e.nodeType!=null)return{dom:e};if(e.dom&&e.dom.nodeType!=null)return e;let i=e[0],o;if(typeof i!="string")throw new RangeError("Invalid array passed to renderSpec");if(r&&(o=M5(r))&&o.indexOf(e)>-1)throw new RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let s=i.indexOf(" ");s>0&&(n=i.slice(0,s),i=i.slice(s+1));let a,l=n?t.createElementNS(n,i):t.createElement(i),c=e[1],u=1;if(c&&typeof c=="object"&&c.nodeType==null&&!Array.isArray(c)){u=2;for(let d in c)if(c[d]!=null){let h=d.indexOf(" ");h>0?l.setAttributeNS(d.slice(0,h),d.slice(h+1),c[d]):l.setAttribute(d,c[d])}}for(let d=u;d<e.length;d++){let h=e[d];if(h===0){if(d<e.length-1||d>u)throw new RangeError("Content hole must be the only child of its parent node");return{dom:l,contentDOM:l}}else{let{dom:p,contentDOM:g}=gf(t,h,n,r);if(l.appendChild(p),g){if(a)throw new RangeError("Multiple content holes");a=g}}}return{dom:l,contentDOM:a}}const hR=65535,pR=Math.pow(2,16);function A5(t,e){return t+e*pR}function l1(t){return t&hR}function N5(t){return(t-(t&hR))/pR}const mR=1,gR=2,yf=4,yR=8;class jy{constructor(e,n,r){this.pos=e,this.delInfo=n,this.recover=r}get deleted(){return(this.delInfo&yR)>0}get deletedBefore(){return(this.delInfo&(mR|yf))>0}get deletedAfter(){return(this.delInfo&(gR|yf))>0}get deletedAcross(){return(this.delInfo&yf)>0}}class wn{constructor(e,n=!1){if(this.ranges=e,this.inverted=n,!e.length&&wn.empty)return wn.empty}recover(e){let n=0,r=l1(e);if(!this.inverted)for(let i=0;i<r;i++)n+=this.ranges[i*3+2]-this.ranges[i*3+1];return this.ranges[r*3]+n+N5(e)}mapResult(e,n=1){return this._map(e,n,!1)}map(e,n=1){return this._map(e,n,!0)}_map(e,n,r){let i=0,o=this.inverted?2:1,s=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let l=this.ranges[a]-(this.inverted?i:0);if(l>e)break;let c=this.ranges[a+o],u=this.ranges[a+s],d=l+c;if(e<=d){let h=c?e==l?-1:e==d?1:n:n,p=l+i+(h<0?0:u);if(r)return p;let g=e==(n<0?l:d)?null:A5(a/3,e-l),y=e==l?gR:e==d?mR:yf;return(n<0?e!=l:e!=d)&&(y|=yR),new jy(p,y,g)}i+=u-c}return r?e+i:new jy(e+i,0,null)}touches(e,n){let r=0,i=l1(n),o=this.inverted?2:1,s=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let l=this.ranges[a]-(this.inverted?r:0);if(l>e)break;let c=this.ranges[a+o],u=l+c;if(e<=u&&a==i*3)return!0;r+=this.ranges[a+s]-c}return!1}forEach(e){let n=this.inverted?2:1,r=this.inverted?1:2;for(let i=0,o=0;i<this.ranges.length;i+=3){let s=this.ranges[i],a=s-(this.inverted?o:0),l=s+(this.inverted?0:o),c=this.ranges[i+n],u=this.ranges[i+r];e(a,a+c,l,l+u),o+=u-c}}invert(){return new wn(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?wn.empty:new wn(e<0?[0,-e,0]:[0,0,e])}}wn.empty=new wn([]);class hu{constructor(e,n,r=0,i=e?e.length:0){this.mirror=n,this.from=r,this.to=i,this._maps=e||[],this.ownData=!(e||n)}get maps(){return this._maps}slice(e=0,n=this.maps.length){return new hu(this._maps,this.mirror,e,n)}appendMap(e,n){this.ownData||(this._maps=this._maps.slice(),this.mirror=this.mirror&&this.mirror.slice(),this.ownData=!0),this.to=this._maps.push(e),n!=null&&this.setMirror(this._maps.length-1,n)}appendMapping(e){for(let n=0,r=this._maps.length;n<e._maps.length;n++){let i=e.getMirror(n);this.appendMap(e._maps[n],i!=null&&i<n?r+i:void 0)}}getMirror(e){if(this.mirror){for(let n=0;n<this.mirror.length;n++)if(this.mirror[n]==e)return this.mirror[n+(n%2?-1:1)]}}setMirror(e,n){this.mirror||(this.mirror=[]),this.mirror.push(e,n)}appendMappingInverted(e){for(let n=e.maps.length-1,r=this._maps.length+e._maps.length;n>=0;n--){let i=e.getMirror(n);this.appendMap(e._maps[n].invert(),i!=null&&i>n?r-i-1:void 0)}}invert(){let e=new hu;return e.appendMappingInverted(this),e}map(e,n=1){if(this.mirror)return this._map(e,n,!0);for(let r=this.from;r<this.to;r++)e=this._maps[r].map(e,n);return e}mapResult(e,n=1){return this._map(e,n,!1)}_map(e,n,r){let i=0;for(let o=this.from;o<this.to;o++){let s=this._maps[o],a=s.mapResult(e,n);if(a.recover!=null){let l=this.getMirror(o);if(l!=null&&l>o&&l<this.to){o=l,e=this._maps[l].recover(a.recover);continue}}i|=a.delInfo,e=a.pos}return r?e:new jy(e,i,null)}}const _m=Object.create(null);class At{getMap(){return wn.empty}merge(e){return null}static fromJSON(e,n){if(!n||!n.stepType)throw new RangeError("Invalid input for Step.fromJSON");let r=_m[n.stepType];if(!r)throw new RangeError(`No step type ${n.stepType} defined`);return r.fromJSON(e,n)}static jsonID(e,n){if(e in _m)throw new RangeError("Duplicate use of step JSON ID "+e);return _m[e]=n,n.prototype.jsonID=e,n}}class et{constructor(e,n){this.doc=e,this.failed=n}static ok(e){return new et(e,null)}static fail(e){return new et(null,e)}static fromReplace(e,n,r,i){try{return et.ok(e.replace(n,r,i))}catch(o){if(o instanceof sh)return et.fail(o.message);throw o}}}function ix(t,e,n){let r=[];for(let i=0;i<t.childCount;i++){let o=t.child(i);o.content.size&&(o=o.copy(ix(o.content,e,o))),o.isInline&&(o=e(o,n,i)),r.push(o)}return F.fromArray(r)}class so extends At{constructor(e,n,r){super(),this.from=e,this.to=n,this.mark=r}apply(e){let n=e.slice(this.from,this.to),r=e.resolve(this.from),i=r.node(r.sharedDepth(this.to)),o=new q(ix(n.content,(s,a)=>!s.isAtom||!a.type.allowsMarkType(this.mark.type)?s:s.mark(this.mark.addToSet(s.marks)),i),n.openStart,n.openEnd);return et.fromReplace(e,this.from,this.to,o)}invert(){return new Ar(this.from,this.to,this.mark)}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deleted&&r.deleted||n.pos>=r.pos?null:new so(n.pos,r.pos,this.mark)}merge(e){return e instanceof so&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new so(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new so(n.from,n.to,e.markFromJSON(n.mark))}}At.jsonID("addMark",so);class Ar extends At{constructor(e,n,r){super(),this.from=e,this.to=n,this.mark=r}apply(e){let n=e.slice(this.from,this.to),r=new q(ix(n.content,i=>i.mark(this.mark.removeFromSet(i.marks)),e),n.openStart,n.openEnd);return et.fromReplace(e,this.from,this.to,r)}invert(){return new so(this.from,this.to,this.mark)}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deleted&&r.deleted||n.pos>=r.pos?null:new Ar(n.pos,r.pos,this.mark)}merge(e){return e instanceof Ar&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Ar(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new Ar(n.from,n.to,e.markFromJSON(n.mark))}}At.jsonID("removeMark",Ar);class ao extends At{constructor(e,n){super(),this.pos=e,this.mark=n}apply(e){let n=e.nodeAt(this.pos);if(!n)return et.fail("No node at mark step's position");let r=n.type.create(n.attrs,null,this.mark.addToSet(n.marks));return et.fromReplace(e,this.pos,this.pos+1,new q(F.from(r),0,n.isLeaf?0:1))}invert(e){let n=e.nodeAt(this.pos);if(n){let r=this.mark.addToSet(n.marks);if(r.length==n.marks.length){for(let i=0;i<n.marks.length;i++)if(!n.marks[i].isInSet(r))return new ao(this.pos,n.marks[i]);return new ao(this.pos,this.mark)}}return new bl(this.pos,this.mark)}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new ao(n.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new ao(n.pos,e.markFromJSON(n.mark))}}At.jsonID("addNodeMark",ao);class bl extends At{constructor(e,n){super(),this.pos=e,this.mark=n}apply(e){let n=e.nodeAt(this.pos);if(!n)return et.fail("No node at mark step's position");let r=n.type.create(n.attrs,null,this.mark.removeFromSet(n.marks));return et.fromReplace(e,this.pos,this.pos+1,new q(F.from(r),0,n.isLeaf?0:1))}invert(e){let n=e.nodeAt(this.pos);return!n||!this.mark.isInSet(n.marks)?this:new ao(this.pos,this.mark)}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new bl(n.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new bl(n.pos,e.markFromJSON(n.mark))}}At.jsonID("removeNodeMark",bl);class at extends At{constructor(e,n,r,i=!1){super(),this.from=e,this.to=n,this.slice=r,this.structure=i}apply(e){return this.structure&&Dy(e,this.from,this.to)?et.fail("Structure replace would overwrite content"):et.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new wn([this.from,this.to-this.from,this.slice.size])}invert(e){return new at(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deletedAcross&&r.deletedAcross?null:new at(n.pos,Math.max(n.pos,r.pos),this.slice)}merge(e){if(!(e instanceof at)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let n=this.slice.size+e.slice.size==0?q.empty:new q(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new at(this.from,this.to+(e.to-e.from),n,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let n=this.slice.size+e.slice.size==0?q.empty:new q(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new at(e.from,this.to,n,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new at(n.from,n.to,q.fromJSON(e,n.slice),!!n.structure)}}At.jsonID("replace",at);class ct extends At{constructor(e,n,r,i,o,s,a=!1){super(),this.from=e,this.to=n,this.gapFrom=r,this.gapTo=i,this.slice=o,this.insert=s,this.structure=a}apply(e){if(this.structure&&(Dy(e,this.from,this.gapFrom)||Dy(e,this.gapTo,this.to)))return et.fail("Structure gap-replace would overwrite content");let n=e.slice(this.gapFrom,this.gapTo);if(n.openStart||n.openEnd)return et.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,n.content);return r?et.fromReplace(e,this.from,this.to,r):et.fail("Content does not fit in gap")}getMap(){return new wn([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let n=this.gapTo-this.gapFrom;return new ct(this.from,this.from+this.slice.size+n,this.from+this.insert,this.from+this.insert+n,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1),i=this.from==this.gapFrom?n.pos:e.map(this.gapFrom,-1),o=this.to==this.gapTo?r.pos:e.map(this.gapTo,1);return n.deletedAcross&&r.deletedAcross||i<n.pos||o>r.pos?null:new ct(n.pos,r.pos,i,o,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number"||typeof n.gapFrom!="number"||typeof n.gapTo!="number"||typeof n.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new ct(n.from,n.to,n.gapFrom,n.gapTo,q.fromJSON(e,n.slice),n.insert,!!n.structure)}}At.jsonID("replaceAround",ct);function Dy(t,e,n){let r=t.resolve(e),i=n-e,o=r.depth;for(;i>0&&o>0&&r.indexAfter(o)==r.node(o).childCount;)o--,i--;if(i>0){let s=r.node(o).maybeChild(r.indexAfter(o));for(;i>0;){if(!s||s.isLeaf)return!0;s=s.firstChild,i--}}return!1}function j5(t,e,n,r){let i=[],o=[],s,a;t.doc.nodesBetween(e,n,(l,c,u)=>{if(!l.isInline)return;let d=l.marks;if(!r.isInSet(d)&&u.type.allowsMarkType(r.type)){let h=Math.max(c,e),p=Math.min(c+l.nodeSize,n),g=r.addToSet(d);for(let y=0;y<d.length;y++)d[y].isInSet(g)||(s&&s.to==h&&s.mark.eq(d[y])?s.to=p:i.push(s=new Ar(h,p,d[y])));a&&a.to==h?a.to=p:o.push(a=new so(h,p,r))}}),i.forEach(l=>t.step(l)),o.forEach(l=>t.step(l))}function D5(t,e,n,r){let i=[],o=0;t.doc.nodesBetween(e,n,(s,a)=>{if(!s.isInline)return;o++;let l=null;if(r instanceof ap){let c=s.marks,u;for(;u=r.isInSet(c);)(l||(l=[])).push(u),c=u.removeFromSet(c)}else r?r.isInSet(s.marks)&&(l=[r]):l=s.marks;if(l&&l.length){let c=Math.min(a+s.nodeSize,n);for(let u=0;u<l.length;u++){let d=l[u],h;for(let p=0;p<i.length;p++){let g=i[p];g.step==o-1&&d.eq(i[p].style)&&(h=g)}h?(h.to=c,h.step=o):i.push({style:d,from:Math.max(a,e),to:c,step:o})}}}),i.forEach(s=>t.step(new Ar(s.from,s.to,s.style)))}function ox(t,e,n,r=n.contentMatch,i=!0){let o=t.doc.nodeAt(e),s=[],a=e+1;for(let l=0;l<o.childCount;l++){let c=o.child(l),u=a+c.nodeSize,d=r.matchType(c.type);if(!d)s.push(new at(a,u,q.empty));else{r=d;for(let h=0;h<c.marks.length;h++)n.allowsMarkType(c.marks[h].type)||t.step(new Ar(a,u,c.marks[h]));if(i&&c.isText&&n.whitespace!="pre"){let h,p=/\r?\n|\r/g,g;for(;h=p.exec(c.text);)g||(g=new q(F.from(n.schema.text(" ",n.allowedMarks(c.marks))),0,0)),s.push(new at(a+h.index,a+h.index+h[0].length,g))}}a=u}if(!r.validEnd){let l=r.fillBefore(F.empty,!0);t.replace(a,a,new q(l,0,0))}for(let l=s.length-1;l>=0;l--)t.step(s[l])}function L5(t,e,n){return(e==0||t.canReplace(e,t.childCount))&&(n==t.childCount||t.canReplace(0,n))}function ql(t){let n=t.parent.content.cutByIndex(t.startIndex,t.endIndex);for(let r=t.depth;;--r){let i=t.$from.node(r),o=t.$from.index(r),s=t.$to.indexAfter(r);if(r<t.depth&&i.canReplace(o,s,n))return r;if(r==0||i.type.spec.isolating||!L5(i,o,s))break}return null}function $5(t,e,n){let{$from:r,$to:i,depth:o}=e,s=r.before(o+1),a=i.after(o+1),l=s,c=a,u=F.empty,d=0;for(let g=o,y=!1;g>n;g--)y||r.index(g)>0?(y=!0,u=F.from(r.node(g).copy(u)),d++):l--;let h=F.empty,p=0;for(let g=o,y=!1;g>n;g--)y||i.after(g+1)<i.end(g)?(y=!0,h=F.from(i.node(g).copy(h)),p++):c++;t.step(new ct(l,c,s,a,new q(u.append(h),d,p),u.size-d,!0))}function sx(t,e,n=null,r=t){let i=F5(t,e),o=i&&B5(r,e);return o?i.map(c1).concat({type:e,attrs:n}).concat(o.map(c1)):null}function c1(t){return{type:t,attrs:null}}function F5(t,e){let{parent:n,startIndex:r,endIndex:i}=t,o=n.contentMatchAt(r).findWrapping(e);if(!o)return null;let s=o.length?o[0]:e;return n.canReplaceWith(r,i,s)?o:null}function B5(t,e){let{parent:n,startIndex:r,endIndex:i}=t,o=n.child(r),s=e.contentMatch.findWrapping(o.type);if(!s)return null;let l=(s.length?s[s.length-1]:e).contentMatch;for(let c=r;l&&c<i;c++)l=l.matchType(n.child(c).type);return!l||!l.validEnd?null:s}function z5(t,e,n){let r=F.empty;for(let s=n.length-1;s>=0;s--){if(r.size){let a=n[s].type.contentMatch.matchFragment(r);if(!a||!a.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}r=F.from(n[s].type.create(n[s].attrs,r))}let i=e.start,o=e.end;t.step(new ct(i,o,i,o,new q(r,0,0),n.length,!0))}function V5(t,e,n,r,i){if(!r.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let o=t.steps.length;t.doc.nodesBetween(e,n,(s,a)=>{let l=typeof i=="function"?i(s):i;if(s.isTextblock&&!s.hasMarkup(r,l)&&U5(t.doc,t.mapping.slice(o).map(a),r)){let c=null;if(r.schema.linebreakReplacement){let p=r.whitespace=="pre",g=!!r.contentMatch.matchType(r.schema.linebreakReplacement);p&&!g?c=!1:!p&&g&&(c=!0)}c===!1&&xR(t,s,a,o),ox(t,t.mapping.slice(o).map(a,1),r,void 0,c===null);let u=t.mapping.slice(o),d=u.map(a,1),h=u.map(a+s.nodeSize,1);return t.step(new ct(d,h,d+1,h-1,new q(F.from(r.create(l,null,s.marks)),0,0),1,!0)),c===!0&&vR(t,s,a,o),!1}})}function vR(t,e,n,r){e.forEach((i,o)=>{if(i.isText){let s,a=/\r?\n|\r/g;for(;s=a.exec(i.text);){let l=t.mapping.slice(r).map(n+1+o+s.index);t.replaceWith(l,l+1,e.type.schema.linebreakReplacement.create())}}})}function xR(t,e,n,r){e.forEach((i,o)=>{if(i.type==i.type.schema.linebreakReplacement){let s=t.mapping.slice(r).map(n+1+o);t.replaceWith(s,s+1,e.type.schema.text(`
`))}})}function U5(t,e,n){let r=t.resolve(e),i=r.index();return r.parent.canReplaceWith(i,i+1,n)}function H5(t,e,n,r,i){let o=t.doc.nodeAt(e);if(!o)throw new RangeError("No node at given position");n||(n=o.type);let s=n.create(r,null,i||o.marks);if(o.isLeaf)return t.replaceWith(e,e+o.nodeSize,s);if(!n.validContent(o.content))throw new RangeError("Invalid content for node type "+n.name);t.step(new ct(e,e+o.nodeSize,e+1,e+o.nodeSize-1,new q(F.from(s),0,0),1,!0))}function Ha(t,e,n=1,r){let i=t.resolve(e),o=i.depth-n,s=r&&r[r.length-1]||i.parent;if(o<0||i.parent.type.spec.isolating||!i.parent.canReplace(i.index(),i.parent.childCount)||!s.type.validContent(i.parent.content.cutByIndex(i.index(),i.parent.childCount)))return!1;for(let c=i.depth-1,u=n-2;c>o;c--,u--){let d=i.node(c),h=i.index(c);if(d.type.spec.isolating)return!1;let p=d.content.cutByIndex(h,d.childCount),g=r&&r[u+1];g&&(p=p.replaceChild(0,g.type.create(g.attrs)));let y=r&&r[u]||d;if(!d.canReplace(h+1,d.childCount)||!y.type.validContent(p))return!1}let a=i.indexAfter(o),l=r&&r[0];return i.node(o).canReplaceWith(a,a,l?l.type:i.node(o+1).type)}function W5(t,e,n=1,r){let i=t.doc.resolve(e),o=F.empty,s=F.empty;for(let a=i.depth,l=i.depth-n,c=n-1;a>l;a--,c--){o=F.from(i.node(a).copy(o));let u=r&&r[c];s=F.from(u?u.type.create(u.attrs,s):i.node(a).copy(s))}t.step(new at(e,e,new q(o.append(s),n,n),!0))}function Do(t,e){let n=t.resolve(e),r=n.index();return wR(n.nodeBefore,n.nodeAfter)&&n.parent.canReplace(r,r+1)}function K5(t,e){e.content.size||t.type.compatibleContent(e.type);let n=t.contentMatchAt(t.childCount),{linebreakReplacement:r}=t.type.schema;for(let i=0;i<e.childCount;i++){let o=e.child(i),s=o.type==r?t.type.schema.nodes.text:o.type;if(n=n.matchType(s),!n||!t.type.allowsMarks(o.marks))return!1}return n.validEnd}function wR(t,e){return!!(t&&e&&!t.isLeaf&&K5(t,e))}function lp(t,e,n=-1){let r=t.resolve(e);for(let i=r.depth;;i--){let o,s,a=r.index(i);if(i==r.depth?(o=r.nodeBefore,s=r.nodeAfter):n>0?(o=r.node(i+1),a++,s=r.node(i).maybeChild(a)):(o=r.node(i).maybeChild(a-1),s=r.node(i+1)),o&&!o.isTextblock&&wR(o,s)&&r.node(i).canReplace(a,a+1))return e;if(i==0)break;e=n<0?r.before(i):r.after(i)}}function q5(t,e,n){let r=null,{linebreakReplacement:i}=t.doc.type.schema,o=t.doc.resolve(e-n),s=o.node().type;if(i&&s.inlineContent){let u=s.whitespace=="pre",d=!!s.contentMatch.matchType(i);u&&!d?r=!1:!u&&d&&(r=!0)}let a=t.steps.length;if(r===!1){let u=t.doc.resolve(e+n);xR(t,u.node(),u.before(),a)}s.inlineContent&&ox(t,e+n-1,s,o.node().contentMatchAt(o.index()),r==null);let l=t.mapping.slice(a),c=l.map(e-n);if(t.step(new at(c,l.map(e+n,-1),q.empty,!0)),r===!0){let u=t.doc.resolve(c);vR(t,u.node(),u.before(),t.steps.length)}return t}function G5(t,e,n){let r=t.resolve(e);if(r.parent.canReplaceWith(r.index(),r.index(),n))return e;if(r.parentOffset==0)for(let i=r.depth-1;i>=0;i--){let o=r.index(i);if(r.node(i).canReplaceWith(o,o,n))return r.before(i+1);if(o>0)return null}if(r.parentOffset==r.parent.content.size)for(let i=r.depth-1;i>=0;i--){let o=r.indexAfter(i);if(r.node(i).canReplaceWith(o,o,n))return r.after(i+1);if(o<r.node(i).childCount)return null}return null}function bR(t,e,n){let r=t.resolve(e);if(!n.content.size)return e;let i=n.content;for(let o=0;o<n.openStart;o++)i=i.firstChild.content;for(let o=1;o<=(n.openStart==0&&n.size?2:1);o++)for(let s=r.depth;s>=0;s--){let a=s==r.depth?0:r.pos<=(r.start(s+1)+r.end(s+1))/2?-1:1,l=r.index(s)+(a>0?1:0),c=r.node(s),u=!1;if(o==1)u=c.canReplace(l,l,i);else{let d=c.contentMatchAt(l).findWrapping(i.firstChild.type);u=d&&c.canReplaceWith(l,l,d[0])}if(u)return a==0?r.pos:a<0?r.before(s+1):r.after(s+1)}return null}function cp(t,e,n=e,r=q.empty){if(e==n&&!r.size)return null;let i=t.resolve(e),o=t.resolve(n);return SR(i,o,r)?new at(e,n,r):new J5(i,o,r).fit()}function SR(t,e,n){return!n.openStart&&!n.openEnd&&t.start()==e.start()&&t.parent.canReplace(t.index(),e.index(),n.content)}class J5{constructor(e,n,r){this.$from=e,this.$to=n,this.unplaced=r,this.frontier=[],this.placed=F.empty;for(let i=0;i<=e.depth;i++){let o=e.node(i);this.frontier.push({type:o.type,match:o.contentMatchAt(e.indexAfter(i))})}for(let i=e.depth;i>0;i--)this.placed=F.from(e.node(i).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let c=this.findFittable();c?this.placeNodes(c):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),n=this.placed.size-this.depth-this.$from.depth,r=this.$from,i=this.close(e<0?this.$to:r.doc.resolve(e));if(!i)return null;let o=this.placed,s=r.depth,a=i.depth;for(;s&&a&&o.childCount==1;)o=o.firstChild.content,s--,a--;let l=new q(o,s,a);return e>-1?new ct(r.pos,e,this.$to.pos,this.$to.end(),l,n):l.size||r.pos!=this.$to.pos?new at(r.pos,i.pos,l):null}findFittable(){let e=this.unplaced.openStart;for(let n=this.unplaced.content,r=0,i=this.unplaced.openEnd;r<e;r++){let o=n.firstChild;if(n.childCount>1&&(i=0),o.type.spec.isolating&&i<=r){e=r;break}n=o.content}for(let n=1;n<=2;n++)for(let r=n==1?e:this.unplaced.openStart;r>=0;r--){let i,o=null;r?(o=Rm(this.unplaced.content,r-1).firstChild,i=o.content):i=this.unplaced.content;let s=i.firstChild;for(let a=this.depth;a>=0;a--){let{type:l,match:c}=this.frontier[a],u,d=null;if(n==1&&(s?c.matchType(s.type)||(d=c.fillBefore(F.from(s),!1)):o&&l.compatibleContent(o.type)))return{sliceDepth:r,frontierDepth:a,parent:o,inject:d};if(n==2&&s&&(u=c.findWrapping(s.type)))return{sliceDepth:r,frontierDepth:a,parent:o,wrap:u};if(o&&c.matchType(o.type))break}}}openMore(){let{content:e,openStart:n,openEnd:r}=this.unplaced,i=Rm(e,n);return!i.childCount||i.firstChild.isLeaf?!1:(this.unplaced=new q(e,n+1,Math.max(r,i.size+n>=e.size-r?n+1:0)),!0)}dropNode(){let{content:e,openStart:n,openEnd:r}=this.unplaced,i=Rm(e,n);if(i.childCount<=1&&n>0){let o=e.size-n<=n+i.size;this.unplaced=new q(yc(e,n-1,1),n-1,o?n-1:r)}else this.unplaced=new q(yc(e,n,1),n,r)}placeNodes({sliceDepth:e,frontierDepth:n,parent:r,inject:i,wrap:o}){for(;this.depth>n;)this.closeFrontierNode();if(o)for(let y=0;y<o.length;y++)this.openFrontierNode(o[y]);let s=this.unplaced,a=r?r.content:s.content,l=s.openStart-e,c=0,u=[],{match:d,type:h}=this.frontier[n];if(i){for(let y=0;y<i.childCount;y++)u.push(i.child(y));d=d.matchFragment(i)}let p=a.size+e-(s.content.size-s.openEnd);for(;c<a.childCount;){let y=a.child(c),x=d.matchType(y.type);if(!x)break;c++,(c>1||l==0||y.content.size)&&(d=x,u.push(CR(y.mark(h.allowedMarks(y.marks)),c==1?l:0,c==a.childCount?p:-1)))}let g=c==a.childCount;g||(p=-1),this.placed=vc(this.placed,n,F.from(u)),this.frontier[n].match=d,g&&p<0&&r&&r.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let y=0,x=a;y<p;y++){let v=x.lastChild;this.frontier.push({type:v.type,match:v.contentMatchAt(v.childCount)}),x=v.content}this.unplaced=g?e==0?q.empty:new q(yc(s.content,e-1,1),e-1,p<0?s.openEnd:e-1):new q(yc(s.content,e,c),s.openStart,s.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e=this.frontier[this.depth],n;if(!e.type.isTextblock||!Om(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(n=this.findCloseLevel(this.$to))&&n.depth==this.depth)return-1;let{depth:r}=this.$to,i=this.$to.after(r);for(;r>1&&i==this.$to.end(--r);)++i;return i}findCloseLevel(e){e:for(let n=Math.min(this.depth,e.depth);n>=0;n--){let{match:r,type:i}=this.frontier[n],o=n<e.depth&&e.end(n+1)==e.pos+(e.depth-(n+1)),s=Om(e,n,i,r,o);if(s){for(let a=n-1;a>=0;a--){let{match:l,type:c}=this.frontier[a],u=Om(e,a,c,l,!0);if(!u||u.childCount)continue e}return{depth:n,fit:s,move:o?e.doc.resolve(e.after(n+1)):e}}}}close(e){let n=this.findCloseLevel(e);if(!n)return null;for(;this.depth>n.depth;)this.closeFrontierNode();n.fit.childCount&&(this.placed=vc(this.placed,n.depth,n.fit)),e=n.move;for(let r=n.depth+1;r<=e.depth;r++){let i=e.node(r),o=i.type.contentMatch.fillBefore(i.content,!0,e.index(r));this.openFrontierNode(i.type,i.attrs,o)}return e}openFrontierNode(e,n=null,r){let i=this.frontier[this.depth];i.match=i.match.matchType(e),this.placed=vc(this.placed,this.depth,F.from(e.create(n,r))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let n=this.frontier.pop().match.fillBefore(F.empty,!0);n.childCount&&(this.placed=vc(this.placed,this.frontier.length,n))}}function yc(t,e,n){return e==0?t.cutByIndex(n,t.childCount):t.replaceChild(0,t.firstChild.copy(yc(t.firstChild.content,e-1,n)))}function vc(t,e,n){return e==0?t.append(n):t.replaceChild(t.childCount-1,t.lastChild.copy(vc(t.lastChild.content,e-1,n)))}function Rm(t,e){for(let n=0;n<e;n++)t=t.firstChild.content;return t}function CR(t,e,n){if(e<=0)return t;let r=t.content;return e>1&&(r=r.replaceChild(0,CR(r.firstChild,e-1,r.childCount==1?n-1:0))),e>0&&(r=t.type.contentMatch.fillBefore(r).append(r),n<=0&&(r=r.append(t.type.contentMatch.matchFragment(r).fillBefore(F.empty,!0)))),t.copy(r)}function Om(t,e,n,r,i){let o=t.node(e),s=i?t.indexAfter(e):t.index(e);if(s==o.childCount&&!n.compatibleContent(o.type))return null;let a=r.fillBefore(o.content,!0,s);return a&&!Y5(n,o.content,s)?a:null}function Y5(t,e,n){for(let r=n;r<e.childCount;r++)if(!t.allowsMarks(e.child(r).marks))return!0;return!1}function Q5(t){return t.spec.defining||t.spec.definingForContent}function X5(t,e,n,r){if(!r.size)return t.deleteRange(e,n);let i=t.doc.resolve(e),o=t.doc.resolve(n);if(SR(i,o,r))return t.step(new at(e,n,r));let s=ER(i,t.doc.resolve(n));s[s.length-1]==0&&s.pop();let a=-(i.depth+1);s.unshift(a);for(let h=i.depth,p=i.pos-1;h>0;h--,p--){let g=i.node(h).type.spec;if(g.defining||g.definingAsContext||g.isolating)break;s.indexOf(h)>-1?a=h:i.before(h)==p&&s.splice(1,0,-h)}let l=s.indexOf(a),c=[],u=r.openStart;for(let h=r.content,p=0;;p++){let g=h.firstChild;if(c.push(g),p==r.openStart)break;h=g.content}for(let h=u-1;h>=0;h--){let p=c[h],g=Q5(p.type);if(g&&!p.sameMarkup(i.node(Math.abs(a)-1)))u=h;else if(g||!p.type.isTextblock)break}for(let h=r.openStart;h>=0;h--){let p=(h+u+1)%(r.openStart+1),g=c[p];if(g)for(let y=0;y<s.length;y++){let x=s[(y+l)%s.length],v=!0;x<0&&(v=!1,x=-x);let w=i.node(x-1),b=i.index(x-1);if(w.canReplaceWith(b,b,g.type,g.marks))return t.replace(i.before(x),v?o.after(x):n,new q(kR(r.content,0,r.openStart,p),p,r.openEnd))}}let d=t.steps.length;for(let h=s.length-1;h>=0&&(t.replace(e,n,r),!(t.steps.length>d));h--){let p=s[h];p<0||(e=i.before(p),n=o.after(p))}}function kR(t,e,n,r,i){if(e<n){let o=t.firstChild;t=t.replaceChild(0,o.copy(kR(o.content,e+1,n,r,o)))}if(e>r){let o=i.contentMatchAt(0),s=o.fillBefore(t).append(t);t=s.append(o.matchFragment(s).fillBefore(F.empty,!0))}return t}function Z5(t,e,n,r){if(!r.isInline&&e==n&&t.doc.resolve(e).parent.content.size){let i=G5(t.doc,e,r.type);i!=null&&(e=n=i)}t.replaceRange(e,n,new q(F.from(r),0,0))}function eB(t,e,n){let r=t.doc.resolve(e),i=t.doc.resolve(n),o=ER(r,i);for(let s=0;s<o.length;s++){let a=o[s],l=s==o.length-1;if(l&&a==0||r.node(a).type.contentMatch.validEnd)return t.delete(r.start(a),i.end(a));if(a>0&&(l||r.node(a-1).canReplace(r.index(a-1),i.indexAfter(a-1))))return t.delete(r.before(a),i.after(a))}for(let s=1;s<=r.depth&&s<=i.depth;s++)if(e-r.start(s)==r.depth-s&&n>r.end(s)&&i.end(s)-n!=i.depth-s&&r.start(s-1)==i.start(s-1)&&r.node(s-1).canReplace(r.index(s-1),i.index(s-1)))return t.delete(r.before(s),n);t.delete(e,n)}function ER(t,e){let n=[],r=Math.min(t.depth,e.depth);for(let i=r;i>=0;i--){let o=t.start(i);if(o<t.pos-(t.depth-i)||e.end(i)>e.pos+(e.depth-i)||t.node(i).type.spec.isolating||e.node(i).type.spec.isolating)break;(o==e.start(i)||i==t.depth&&i==e.depth&&t.parent.inlineContent&&e.parent.inlineContent&&i&&e.start(i-1)==o-1)&&n.push(i)}return n}class Wa extends At{constructor(e,n,r){super(),this.pos=e,this.attr=n,this.value=r}apply(e){let n=e.nodeAt(this.pos);if(!n)return et.fail("No node at attribute step's position");let r=Object.create(null);for(let o in n.attrs)r[o]=n.attrs[o];r[this.attr]=this.value;let i=n.type.create(r,null,n.marks);return et.fromReplace(e,this.pos,this.pos+1,new q(F.from(i),0,n.isLeaf?0:1))}getMap(){return wn.empty}invert(e){return new Wa(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new Wa(n.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,n){if(typeof n.pos!="number"||typeof n.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new Wa(n.pos,n.attr,n.value)}}At.jsonID("attr",Wa);class pu extends At{constructor(e,n){super(),this.attr=e,this.value=n}apply(e){let n=Object.create(null);for(let i in e.attrs)n[i]=e.attrs[i];n[this.attr]=this.value;let r=e.type.create(n,e.content,e.marks);return et.ok(r)}getMap(){return wn.empty}invert(e){return new pu(this.attr,e.attrs[this.attr])}map(e){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(e,n){if(typeof n.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new pu(n.attr,n.value)}}At.jsonID("docAttr",pu);let Sl=class extends Error{};Sl=function t(e){let n=Error.call(this,e);return n.__proto__=t.prototype,n};Sl.prototype=Object.create(Error.prototype);Sl.prototype.constructor=Sl;Sl.prototype.name="TransformError";class tB{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new hu}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let n=this.maybeStep(e);if(n.failed)throw new Sl(n.failed);return this}maybeStep(e){let n=e.apply(this.doc);return n.failed||this.addStep(e,n.doc),n}get docChanged(){return this.steps.length>0}addStep(e,n){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=n}replace(e,n=e,r=q.empty){let i=cp(this.doc,e,n,r);return i&&this.step(i),this}replaceWith(e,n,r){return this.replace(e,n,new q(F.from(r),0,0))}delete(e,n){return this.replace(e,n,q.empty)}insert(e,n){return this.replaceWith(e,e,n)}replaceRange(e,n,r){return X5(this,e,n,r),this}replaceRangeWith(e,n,r){return Z5(this,e,n,r),this}deleteRange(e,n){return eB(this,e,n),this}lift(e,n){return $5(this,e,n),this}join(e,n=1){return q5(this,e,n),this}wrap(e,n){return z5(this,e,n),this}setBlockType(e,n=e,r,i=null){return V5(this,e,n,r,i),this}setNodeMarkup(e,n,r=null,i){return H5(this,e,n,r,i),this}setNodeAttribute(e,n,r){return this.step(new Wa(e,n,r)),this}setDocAttribute(e,n){return this.step(new pu(e,n)),this}addNodeMark(e,n){return this.step(new ao(e,n)),this}removeNodeMark(e,n){if(!(n instanceof Re)){let r=this.doc.nodeAt(e);if(!r)throw new RangeError("No node at position "+e);if(n=n.isInSet(r.marks),!n)return this}return this.step(new bl(e,n)),this}split(e,n=1,r){return W5(this,e,n,r),this}addMark(e,n,r){return j5(this,e,n,r),this}removeMark(e,n,r){return D5(this,e,n,r),this}clearIncompatible(e,n,r){return ox(this,e,n,r),this}}const Pm=Object.create(null);class oe{constructor(e,n,r){this.$anchor=e,this.$head=n,this.ranges=r||[new nB(e.min(n),e.max(n))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let n=0;n<e.length;n++)if(e[n].$from.pos!=e[n].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,n=q.empty){let r=n.content.lastChild,i=null;for(let a=0;a<n.openEnd;a++)i=r,r=r.lastChild;let o=e.steps.length,s=this.ranges;for(let a=0;a<s.length;a++){let{$from:l,$to:c}=s[a],u=e.mapping.slice(o);e.replaceRange(u.map(l.pos),u.map(c.pos),a?q.empty:n),a==0&&f1(e,o,(r?r.isInline:i&&i.isTextblock)?-1:1)}}replaceWith(e,n){let r=e.steps.length,i=this.ranges;for(let o=0;o<i.length;o++){let{$from:s,$to:a}=i[o],l=e.mapping.slice(r),c=l.map(s.pos),u=l.map(a.pos);o?e.deleteRange(c,u):(e.replaceRangeWith(c,u,n),f1(e,r,n.isInline?-1:1))}}static findFrom(e,n,r=!1){let i=e.parent.inlineContent?new ie(e):ga(e.node(0),e.parent,e.pos,e.index(),n,r);if(i)return i;for(let o=e.depth-1;o>=0;o--){let s=n<0?ga(e.node(0),e.node(o),e.before(o+1),e.index(o),n,r):ga(e.node(0),e.node(o),e.after(o+1),e.index(o)+1,n,r);if(s)return s}return null}static near(e,n=1){return this.findFrom(e,n)||this.findFrom(e,-n)||new Fn(e.node(0))}static atStart(e){return ga(e,e,0,0,1)||new Fn(e)}static atEnd(e){return ga(e,e,e.content.size,e.childCount,-1)||new Fn(e)}static fromJSON(e,n){if(!n||!n.type)throw new RangeError("Invalid input for Selection.fromJSON");let r=Pm[n.type];if(!r)throw new RangeError(`No selection type ${n.type} defined`);return r.fromJSON(e,n)}static jsonID(e,n){if(e in Pm)throw new RangeError("Duplicate use of selection JSON ID "+e);return Pm[e]=n,n.prototype.jsonID=e,n}getBookmark(){return ie.between(this.$anchor,this.$head).getBookmark()}}oe.prototype.visible=!0;class nB{constructor(e,n){this.$from=e,this.$to=n}}let u1=!1;function d1(t){!u1&&!t.parent.inlineContent&&(u1=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+t.parent.type.name+")"))}class ie extends oe{constructor(e,n=e){d1(e),d1(n),super(e,n)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,n){let r=e.resolve(n.map(this.head));if(!r.parent.inlineContent)return oe.near(r);let i=e.resolve(n.map(this.anchor));return new ie(i.parent.inlineContent?i:r,r)}replace(e,n=q.empty){if(super.replace(e,n),n==q.empty){let r=this.$from.marksAcross(this.$to);r&&e.ensureMarks(r)}}eq(e){return e instanceof ie&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new up(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,n){if(typeof n.anchor!="number"||typeof n.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new ie(e.resolve(n.anchor),e.resolve(n.head))}static create(e,n,r=n){let i=e.resolve(n);return new this(i,r==n?i:e.resolve(r))}static between(e,n,r){let i=e.pos-n.pos;if((!r||i)&&(r=i>=0?1:-1),!n.parent.inlineContent){let o=oe.findFrom(n,r,!0)||oe.findFrom(n,-r,!0);if(o)n=o.$head;else return oe.near(n,r)}return e.parent.inlineContent||(i==0?e=n:(e=(oe.findFrom(e,-r,!0)||oe.findFrom(e,r,!0)).$anchor,e.pos<n.pos!=i<0&&(e=n))),new ie(e,n)}}oe.jsonID("text",ie);class up{constructor(e,n){this.anchor=e,this.head=n}map(e){return new up(e.map(this.anchor),e.map(this.head))}resolve(e){return ie.between(e.resolve(this.anchor),e.resolve(this.head))}}class te extends oe{constructor(e){let n=e.nodeAfter,r=e.node(0).resolve(e.pos+n.nodeSize);super(e,r),this.node=n}map(e,n){let{deleted:r,pos:i}=n.mapResult(this.anchor),o=e.resolve(i);return r?oe.near(o):new te(o)}content(){return new q(F.from(this.node),0,0)}eq(e){return e instanceof te&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new ax(this.anchor)}static fromJSON(e,n){if(typeof n.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new te(e.resolve(n.anchor))}static create(e,n){return new te(e.resolve(n))}static isSelectable(e){return!e.isText&&e.type.spec.selectable!==!1}}te.prototype.visible=!1;oe.jsonID("node",te);class ax{constructor(e){this.anchor=e}map(e){let{deleted:n,pos:r}=e.mapResult(this.anchor);return n?new up(r,r):new ax(r)}resolve(e){let n=e.resolve(this.anchor),r=n.nodeAfter;return r&&te.isSelectable(r)?new te(n):oe.near(n)}}class Fn extends oe{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,n=q.empty){if(n==q.empty){e.delete(0,e.doc.content.size);let r=oe.atStart(e.doc);r.eq(e.selection)||e.setSelection(r)}else super.replace(e,n)}toJSON(){return{type:"all"}}static fromJSON(e){return new Fn(e)}map(e){return new Fn(e)}eq(e){return e instanceof Fn}getBookmark(){return rB}}oe.jsonID("all",Fn);const rB={map(){return this},resolve(t){return new Fn(t)}};function ga(t,e,n,r,i,o=!1){if(e.inlineContent)return ie.create(t,n);for(let s=r-(i>0?0:1);i>0?s<e.childCount:s>=0;s+=i){let a=e.child(s);if(a.isAtom){if(!o&&te.isSelectable(a))return te.create(t,n-(i<0?a.nodeSize:0))}else{let l=ga(t,a,n+i,i<0?a.childCount:0,i,o);if(l)return l}n+=a.nodeSize*i}return null}function f1(t,e,n){let r=t.steps.length-1;if(r<e)return;let i=t.steps[r];if(!(i instanceof at||i instanceof ct))return;let o=t.mapping.maps[r],s;o.forEach((a,l,c,u)=>{s==null&&(s=u)}),t.setSelection(oe.near(t.doc.resolve(s),n))}const h1=1,Fd=2,p1=4;class iB extends tB{constructor(e){super(e.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=e.selection,this.storedMarks=e.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(e){if(e.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=(this.updated|h1)&~Fd,this.storedMarks=null,this}get selectionSet(){return(this.updated&h1)>0}setStoredMarks(e){return this.storedMarks=e,this.updated|=Fd,this}ensureMarks(e){return Re.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this}addStoredMark(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(this.updated&Fd)>0}addStep(e,n){super.addStep(e,n),this.updated=this.updated&~Fd,this.storedMarks=null}setTime(e){return this.time=e,this}replaceSelection(e){return this.selection.replace(this,e),this}replaceSelectionWith(e,n=!0){let r=this.selection;return n&&(e=e.mark(this.storedMarks||(r.empty?r.$from.marks():r.$from.marksAcross(r.$to)||Re.none))),r.replaceWith(this,e),this}deleteSelection(){return this.selection.replace(this),this}insertText(e,n,r){let i=this.doc.type.schema;if(n==null)return e?this.replaceSelectionWith(i.text(e),!0):this.deleteSelection();{if(r==null&&(r=n),r=r??n,!e)return this.deleteRange(n,r);let o=this.storedMarks;if(!o){let s=this.doc.resolve(n);o=r==n?s.marks():s.marksAcross(this.doc.resolve(r))}return this.replaceRangeWith(n,r,i.text(e,o)),this.selection.empty||this.setSelection(oe.near(this.selection.$to)),this}}setMeta(e,n){return this.meta[typeof e=="string"?e:e.key]=n,this}getMeta(e){return this.meta[typeof e=="string"?e:e.key]}get isGeneric(){for(let e in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=p1,this}get scrolledIntoView(){return(this.updated&p1)>0}}function m1(t,e){return!e||!t?t:t.bind(e)}class xc{constructor(e,n,r){this.name=e,this.init=m1(n.init,r),this.apply=m1(n.apply,r)}}const oB=[new xc("doc",{init(t){return t.doc||t.schema.topNodeType.createAndFill()},apply(t){return t.doc}}),new xc("selection",{init(t,e){return t.selection||oe.atStart(e.doc)},apply(t){return t.selection}}),new xc("storedMarks",{init(t){return t.storedMarks||null},apply(t,e,n,r){return r.selection.$cursor?t.storedMarks:null}}),new xc("scrollToSelection",{init(){return 0},apply(t,e){return t.scrolledIntoView?e+1:e}})];class Mm{constructor(e,n){this.schema=e,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=oB.slice(),n&&n.forEach(r=>{if(this.pluginsByKey[r.key])throw new RangeError("Adding different instances of a keyed plugin ("+r.key+")");this.plugins.push(r),this.pluginsByKey[r.key]=r,r.spec.state&&this.fields.push(new xc(r.key,r.spec.state,r))})}}class Ma{constructor(e){this.config=e}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(e){return this.applyTransaction(e).state}filterTransaction(e,n=-1){for(let r=0;r<this.config.plugins.length;r++)if(r!=n){let i=this.config.plugins[r];if(i.spec.filterTransaction&&!i.spec.filterTransaction.call(i,e,this))return!1}return!0}applyTransaction(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};let n=[e],r=this.applyInner(e),i=null;for(;;){let o=!1;for(let s=0;s<this.config.plugins.length;s++){let a=this.config.plugins[s];if(a.spec.appendTransaction){let l=i?i[s].n:0,c=i?i[s].state:this,u=l<n.length&&a.spec.appendTransaction.call(a,l?n.slice(l):n,c,r);if(u&&r.filterTransaction(u,s)){if(u.setMeta("appendedTransaction",e),!i){i=[];for(let d=0;d<this.config.plugins.length;d++)i.push(d<s?{state:r,n:n.length}:{state:this,n:0})}n.push(u),r=r.applyInner(u),o=!0}i&&(i[s]={state:r,n:n.length})}}if(!o)return{state:r,transactions:n}}}applyInner(e){if(!e.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let n=new Ma(this.config),r=this.config.fields;for(let i=0;i<r.length;i++){let o=r[i];n[o.name]=o.apply(e,this[o.name],this,n)}return n}get tr(){return new iB(this)}static create(e){let n=new Mm(e.doc?e.doc.type.schema:e.schema,e.plugins),r=new Ma(n);for(let i=0;i<n.fields.length;i++)r[n.fields[i].name]=n.fields[i].init(e,r);return r}reconfigure(e){let n=new Mm(this.schema,e.plugins),r=n.fields,i=new Ma(n);for(let o=0;o<r.length;o++){let s=r[o].name;i[s]=this.hasOwnProperty(s)?this[s]:r[o].init(e,i)}return i}toJSON(e){let n={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(n.storedMarks=this.storedMarks.map(r=>r.toJSON())),e&&typeof e=="object")for(let r in e){if(r=="doc"||r=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");let i=e[r],o=i.spec.state;o&&o.toJSON&&(n[r]=o.toJSON.call(i,this[i.key]))}return n}static fromJSON(e,n,r){if(!n)throw new RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw new RangeError("Required config field 'schema' missing");let i=new Mm(e.schema,e.plugins),o=new Ma(i);return i.fields.forEach(s=>{if(s.name=="doc")o.doc=xo.fromJSON(e.schema,n.doc);else if(s.name=="selection")o.selection=oe.fromJSON(o.doc,n.selection);else if(s.name=="storedMarks")n.storedMarks&&(o.storedMarks=n.storedMarks.map(e.schema.markFromJSON));else{if(r)for(let a in r){let l=r[a],c=l.spec.state;if(l.key==s.name&&c&&c.fromJSON&&Object.prototype.hasOwnProperty.call(n,a)){o[s.name]=c.fromJSON.call(l,e,n[a],o);return}}o[s.name]=s.init(e,o)}}),o}}function TR(t,e,n){for(let r in t){let i=t[r];i instanceof Function?i=i.bind(e):r=="handleDOMEvents"&&(i=TR(i,e,{})),n[r]=i}return n}class bt{constructor(e){this.spec=e,this.props={},e.props&&TR(e.props,this,this.props),this.key=e.key?e.key.key:_R("plugin")}getState(e){return e[this.key]}}const Im=Object.create(null);function _R(t){return t in Im?t+"$"+ ++Im[t]:(Im[t]=0,t+"$")}class Rn{constructor(e="key"){this.key=_R(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}}const yt=function(t){for(var e=0;;e++)if(t=t.previousSibling,!t)return e},Cl=function(t){let e=t.assignedSlot||t.parentNode;return e&&e.nodeType==11?e.host:e};let Ly=null;const Xr=function(t,e,n){let r=Ly||(Ly=document.createRange());return r.setEnd(t,n??t.nodeValue.length),r.setStart(t,e||0),r},sB=function(){Ly=null},Vs=function(t,e,n,r){return n&&(g1(t,e,n,r,-1)||g1(t,e,n,r,1))},aB=/^(img|br|input|textarea|hr)$/i;function g1(t,e,n,r,i){for(;;){if(t==n&&e==r)return!0;if(e==(i<0?0:jn(t))){let o=t.parentNode;if(!o||o.nodeType!=1||qu(t)||aB.test(t.nodeName)||t.contentEditable=="false")return!1;e=yt(t)+(i<0?0:1),t=o}else if(t.nodeType==1){if(t=t.childNodes[e+(i<0?-1:0)],t.contentEditable=="false")return!1;e=i<0?jn(t):0}else return!1}}function jn(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function lB(t,e){for(;;){if(t.nodeType==3&&e)return t;if(t.nodeType==1&&e>0){if(t.contentEditable=="false")return null;t=t.childNodes[e-1],e=jn(t)}else if(t.parentNode&&!qu(t))e=yt(t),t=t.parentNode;else return null}}function cB(t,e){for(;;){if(t.nodeType==3&&e<t.nodeValue.length)return t;if(t.nodeType==1&&e<t.childNodes.length){if(t.contentEditable=="false")return null;t=t.childNodes[e],e=0}else if(t.parentNode&&!qu(t))e=yt(t)+1,t=t.parentNode;else return null}}function uB(t,e,n){for(let r=e==0,i=e==jn(t);r||i;){if(t==n)return!0;let o=yt(t);if(t=t.parentNode,!t)return!1;r=r&&o==0,i=i&&o==jn(t)}}function qu(t){let e;for(let n=t;n&&!(e=n.pmViewDesc);n=n.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==t||e.contentDOM==t)}const dp=function(t){return t.focusNode&&Vs(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset)};function Xo(t,e){let n=document.createEvent("Event");return n.initEvent("keydown",!0,!0),n.keyCode=t,n.key=n.code=e,n}function dB(t){let e=t.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}function fB(t,e,n){if(t.caretPositionFromPoint)try{let r=t.caretPositionFromPoint(e,n);if(r)return{node:r.offsetNode,offset:Math.min(jn(r.offsetNode),r.offset)}}catch{}if(t.caretRangeFromPoint){let r=t.caretRangeFromPoint(e,n);if(r)return{node:r.startContainer,offset:Math.min(jn(r.startContainer),r.startOffset)}}}const zr=typeof navigator<"u"?navigator:null,y1=typeof document<"u"?document:null,Lo=zr&&zr.userAgent||"",$y=/Edge\/(\d+)/.exec(Lo),RR=/MSIE \d/.exec(Lo),Fy=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Lo),dn=!!(RR||Fy||$y),bo=RR?document.documentMode:Fy?+Fy[1]:$y?+$y[1]:0,hr=!dn&&/gecko\/(\d+)/i.test(Lo);hr&&+(/Firefox\/(\d+)/.exec(Lo)||[0,0])[1];const By=!dn&&/Chrome\/(\d+)/.exec(Lo),Ot=!!By,OR=By?+By[1]:0,Wt=!dn&&!!zr&&/Apple Computer/.test(zr.vendor),kl=Wt&&(/Mobile\/\w+/.test(Lo)||!!zr&&zr.maxTouchPoints>2),In=kl||(zr?/Mac/.test(zr.platform):!1),hB=zr?/Win/.test(zr.platform):!1,ii=/Android \d/.test(Lo),Gu=!!y1&&"webkitFontSmoothing"in y1.documentElement.style,pB=Gu?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function mB(t){let e=t.defaultView&&t.defaultView.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:t.documentElement.clientWidth,top:0,bottom:t.documentElement.clientHeight}}function Gr(t,e){return typeof t=="number"?t:t[e]}function gB(t){let e=t.getBoundingClientRect(),n=e.width/t.offsetWidth||1,r=e.height/t.offsetHeight||1;return{left:e.left,right:e.left+t.clientWidth*n,top:e.top,bottom:e.top+t.clientHeight*r}}function v1(t,e,n){let r=t.someProp("scrollThreshold")||0,i=t.someProp("scrollMargin")||5,o=t.dom.ownerDocument;for(let s=n||t.dom;s;){if(s.nodeType!=1){s=Cl(s);continue}let a=s,l=a==o.body,c=l?mB(o):gB(a),u=0,d=0;if(e.top<c.top+Gr(r,"top")?d=-(c.top-e.top+Gr(i,"top")):e.bottom>c.bottom-Gr(r,"bottom")&&(d=e.bottom-e.top>c.bottom-c.top?e.top+Gr(i,"top")-c.top:e.bottom-c.bottom+Gr(i,"bottom")),e.left<c.left+Gr(r,"left")?u=-(c.left-e.left+Gr(i,"left")):e.right>c.right-Gr(r,"right")&&(u=e.right-c.right+Gr(i,"right")),u||d)if(l)o.defaultView.scrollBy(u,d);else{let p=a.scrollLeft,g=a.scrollTop;d&&(a.scrollTop+=d),u&&(a.scrollLeft+=u);let y=a.scrollLeft-p,x=a.scrollTop-g;e={left:e.left-y,top:e.top-x,right:e.right-y,bottom:e.bottom-x}}let h=l?"fixed":getComputedStyle(s).position;if(/^(fixed|sticky)$/.test(h))break;s=h=="absolute"?s.offsetParent:Cl(s)}}function yB(t){let e=t.dom.getBoundingClientRect(),n=Math.max(0,e.top),r,i;for(let o=(e.left+e.right)/2,s=n+1;s<Math.min(innerHeight,e.bottom);s+=5){let a=t.root.elementFromPoint(o,s);if(!a||a==t.dom||!t.dom.contains(a))continue;let l=a.getBoundingClientRect();if(l.top>=n-20){r=a,i=l.top;break}}return{refDOM:r,refTop:i,stack:PR(t.dom)}}function PR(t){let e=[],n=t.ownerDocument;for(let r=t;r&&(e.push({dom:r,top:r.scrollTop,left:r.scrollLeft}),t!=n);r=Cl(r));return e}function vB({refDOM:t,refTop:e,stack:n}){let r=t?t.getBoundingClientRect().top:0;MR(n,r==0?0:r-e)}function MR(t,e){for(let n=0;n<t.length;n++){let{dom:r,top:i,left:o}=t[n];r.scrollTop!=i+e&&(r.scrollTop=i+e),r.scrollLeft!=o&&(r.scrollLeft=o)}}let ua=null;function xB(t){if(t.setActive)return t.setActive();if(ua)return t.focus(ua);let e=PR(t);t.focus(ua==null?{get preventScroll(){return ua={preventScroll:!0},!0}}:void 0),ua||(ua=!1,MR(e,0))}function IR(t,e){let n,r=2e8,i,o=0,s=e.top,a=e.top,l,c;for(let u=t.firstChild,d=0;u;u=u.nextSibling,d++){let h;if(u.nodeType==1)h=u.getClientRects();else if(u.nodeType==3)h=Xr(u).getClientRects();else continue;for(let p=0;p<h.length;p++){let g=h[p];if(g.top<=s&&g.bottom>=a){s=Math.max(g.bottom,s),a=Math.min(g.top,a);let y=g.left>e.left?g.left-e.left:g.right<e.left?e.left-g.right:0;if(y<r){n=u,r=y,i=y&&n.nodeType==3?{left:g.right<e.left?g.right:g.left,top:e.top}:e,u.nodeType==1&&y&&(o=d+(e.left>=(g.left+g.right)/2?1:0));continue}}else g.top>e.top&&!l&&g.left<=e.left&&g.right>=e.left&&(l=u,c={left:Math.max(g.left,Math.min(g.right,e.left)),top:g.top});!n&&(e.left>=g.right&&e.top>=g.top||e.left>=g.left&&e.top>=g.bottom)&&(o=d+1)}}return!n&&l&&(n=l,i=c,r=0),n&&n.nodeType==3?wB(n,i):!n||r&&n.nodeType==1?{node:t,offset:o}:IR(n,i)}function wB(t,e){let n=t.nodeValue.length,r=document.createRange();for(let i=0;i<n;i++){r.setEnd(t,i+1),r.setStart(t,i);let o=Oi(r,1);if(o.top!=o.bottom&&lx(e,o))return{node:t,offset:i+(e.left>=(o.left+o.right)/2?1:0)}}return{node:t,offset:0}}function lx(t,e){return t.left>=e.left-1&&t.left<=e.right+1&&t.top>=e.top-1&&t.top<=e.bottom+1}function bB(t,e){let n=t.parentNode;return n&&/^li$/i.test(n.nodeName)&&e.left<t.getBoundingClientRect().left?n:t}function SB(t,e,n){let{node:r,offset:i}=IR(e,n),o=-1;if(r.nodeType==1&&!r.firstChild){let s=r.getBoundingClientRect();o=s.left!=s.right&&n.left>(s.left+s.right)/2?1:-1}return t.docView.posFromDOM(r,i,o)}function CB(t,e,n,r){let i=-1;for(let o=e,s=!1;o!=t.dom;){let a=t.docView.nearestDesc(o,!0),l;if(!a)return null;if(a.dom.nodeType==1&&(a.node.isBlock&&a.parent||!a.contentDOM)&&((l=a.dom.getBoundingClientRect()).width||l.height)&&(a.node.isBlock&&a.parent&&(!s&&l.left>r.left||l.top>r.top?i=a.posBefore:(!s&&l.right<r.left||l.bottom<r.top)&&(i=a.posAfter),s=!0),!a.contentDOM&&i<0&&!a.node.isText))return(a.node.isBlock?r.top<(l.top+l.bottom)/2:r.left<(l.left+l.right)/2)?a.posBefore:a.posAfter;o=a.dom.parentNode}return i>-1?i:t.docView.posFromDOM(e,n,-1)}function AR(t,e,n){let r=t.childNodes.length;if(r&&n.top<n.bottom)for(let i=Math.max(0,Math.min(r-1,Math.floor(r*(e.top-n.top)/(n.bottom-n.top))-2)),o=i;;){let s=t.childNodes[o];if(s.nodeType==1){let a=s.getClientRects();for(let l=0;l<a.length;l++){let c=a[l];if(lx(e,c))return AR(s,e,c)}}if((o=(o+1)%r)==i)break}return t}function kB(t,e){let n=t.dom.ownerDocument,r,i=0,o=fB(n,e.left,e.top);o&&({node:r,offset:i}=o);let s=(t.root.elementFromPoint?t.root:n).elementFromPoint(e.left,e.top),a;if(!s||!t.dom.contains(s.nodeType!=1?s.parentNode:s)){let c=t.dom.getBoundingClientRect();if(!lx(e,c)||(s=AR(t.dom,e,c),!s))return null}if(Wt)for(let c=s;r&&c;c=Cl(c))c.draggable&&(r=void 0);if(s=bB(s,e),r){if(hr&&r.nodeType==1&&(i=Math.min(i,r.childNodes.length),i<r.childNodes.length)){let u=r.childNodes[i],d;u.nodeName=="IMG"&&(d=u.getBoundingClientRect()).right<=e.left&&d.bottom>e.top&&i++}let c;Gu&&i&&r.nodeType==1&&(c=r.childNodes[i-1]).nodeType==1&&c.contentEditable=="false"&&c.getBoundingClientRect().top>=e.top&&i--,r==t.dom&&i==r.childNodes.length-1&&r.lastChild.nodeType==1&&e.top>r.lastChild.getBoundingClientRect().bottom?a=t.state.doc.content.size:(i==0||r.nodeType!=1||r.childNodes[i-1].nodeName!="BR")&&(a=CB(t,r,i,e))}a==null&&(a=SB(t,s,e));let l=t.docView.nearestDesc(s,!0);return{pos:a,inside:l?l.posAtStart-l.border:-1}}function x1(t){return t.top<t.bottom||t.left<t.right}function Oi(t,e){let n=t.getClientRects();if(n.length){let r=n[e<0?0:n.length-1];if(x1(r))return r}return Array.prototype.find.call(n,x1)||t.getBoundingClientRect()}const EB=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function NR(t,e,n){let{node:r,offset:i,atom:o}=t.docView.domFromPos(e,n<0?-1:1),s=Gu||hr;if(r.nodeType==3)if(s&&(EB.test(r.nodeValue)||(n<0?!i:i==r.nodeValue.length))){let l=Oi(Xr(r,i,i),n);if(hr&&i&&/\s/.test(r.nodeValue[i-1])&&i<r.nodeValue.length){let c=Oi(Xr(r,i-1,i-1),-1);if(c.top==l.top){let u=Oi(Xr(r,i,i+1),-1);if(u.top!=l.top)return ac(u,u.left<c.left)}}return l}else{let l=i,c=i,u=n<0?1:-1;return n<0&&!i?(c++,u=-1):n>=0&&i==r.nodeValue.length?(l--,u=1):n<0?l--:c++,ac(Oi(Xr(r,l,c),u),u<0)}if(!t.state.doc.resolve(e-(o||0)).parent.inlineContent){if(o==null&&i&&(n<0||i==jn(r))){let l=r.childNodes[i-1];if(l.nodeType==1)return Am(l.getBoundingClientRect(),!1)}if(o==null&&i<jn(r)){let l=r.childNodes[i];if(l.nodeType==1)return Am(l.getBoundingClientRect(),!0)}return Am(r.getBoundingClientRect(),n>=0)}if(o==null&&i&&(n<0||i==jn(r))){let l=r.childNodes[i-1],c=l.nodeType==3?Xr(l,jn(l)-(s?0:1)):l.nodeType==1&&(l.nodeName!="BR"||!l.nextSibling)?l:null;if(c)return ac(Oi(c,1),!1)}if(o==null&&i<jn(r)){let l=r.childNodes[i];for(;l.pmViewDesc&&l.pmViewDesc.ignoreForCoords;)l=l.nextSibling;let c=l?l.nodeType==3?Xr(l,0,s?0:1):l.nodeType==1?l:null:null;if(c)return ac(Oi(c,-1),!0)}return ac(Oi(r.nodeType==3?Xr(r):r,-n),n>=0)}function ac(t,e){if(t.width==0)return t;let n=e?t.left:t.right;return{top:t.top,bottom:t.bottom,left:n,right:n}}function Am(t,e){if(t.height==0)return t;let n=e?t.top:t.bottom;return{top:n,bottom:n,left:t.left,right:t.right}}function jR(t,e,n){let r=t.state,i=t.root.activeElement;r!=e&&t.updateState(e),i!=t.dom&&t.focus();try{return n()}finally{r!=e&&t.updateState(r),i!=t.dom&&i&&i.focus()}}function TB(t,e,n){let r=e.selection,i=n=="up"?r.$from:r.$to;return jR(t,e,()=>{let{node:o}=t.docView.domFromPos(i.pos,n=="up"?-1:1);for(;;){let a=t.docView.nearestDesc(o,!0);if(!a)break;if(a.node.isBlock){o=a.contentDOM||a.dom;break}o=a.dom.parentNode}let s=NR(t,i.pos,1);for(let a=o.firstChild;a;a=a.nextSibling){let l;if(a.nodeType==1)l=a.getClientRects();else if(a.nodeType==3)l=Xr(a,0,a.nodeValue.length).getClientRects();else continue;for(let c=0;c<l.length;c++){let u=l[c];if(u.bottom>u.top+1&&(n=="up"?s.top-u.top>(u.bottom-s.top)*2:u.bottom-s.bottom>(s.bottom-u.top)*2))return!1}}return!0})}const _B=/[\u0590-\u08ac]/;function RB(t,e,n){let{$head:r}=e.selection;if(!r.parent.isTextblock)return!1;let i=r.parentOffset,o=!i,s=i==r.parent.content.size,a=t.domSelection();return a?!_B.test(r.parent.textContent)||!a.modify?n=="left"||n=="backward"?o:s:jR(t,e,()=>{let{focusNode:l,focusOffset:c,anchorNode:u,anchorOffset:d}=t.domSelectionRange(),h=a.caretBidiLevel;a.modify("move",n,"character");let p=r.depth?t.docView.domAfterPos(r.before()):t.dom,{focusNode:g,focusOffset:y}=t.domSelectionRange(),x=g&&!p.contains(g.nodeType==1?g:g.parentNode)||l==g&&c==y;try{a.collapse(u,d),l&&(l!=u||c!=d)&&a.extend&&a.extend(l,c)}catch{}return h!=null&&(a.caretBidiLevel=h),x}):r.pos==r.start()||r.pos==r.end()}let w1=null,b1=null,S1=!1;function OB(t,e,n){return w1==e&&b1==n?S1:(w1=e,b1=n,S1=n=="up"||n=="down"?TB(t,e,n):RB(t,e,n))}const Bn=0,C1=1,is=2,Vr=3;class Ju{constructor(e,n,r,i){this.parent=e,this.children=n,this.dom=r,this.contentDOM=i,this.dirty=Bn,r.pmViewDesc=this}matchesWidget(e){return!1}matchesMark(e){return!1}matchesNode(e,n,r){return!1}matchesHack(e){return!1}parseRule(){return null}stopEvent(e){return!1}get size(){let e=0;for(let n=0;n<this.children.length;n++)e+=this.children[n].size;return e}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let e=0;e<this.children.length;e++)this.children[e].destroy()}posBeforeChild(e){for(let n=0,r=this.posAtStart;;n++){let i=this.children[n];if(i==e)return r;r+=i.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(e,n,r){if(this.contentDOM&&this.contentDOM.contains(e.nodeType==1?e:e.parentNode))if(r<0){let o,s;if(e==this.contentDOM)o=e.childNodes[n-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;o=e.previousSibling}for(;o&&!((s=o.pmViewDesc)&&s.parent==this);)o=o.previousSibling;return o?this.posBeforeChild(s)+s.size:this.posAtStart}else{let o,s;if(e==this.contentDOM)o=e.childNodes[n];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;o=e.nextSibling}for(;o&&!((s=o.pmViewDesc)&&s.parent==this);)o=o.nextSibling;return o?this.posBeforeChild(s):this.posAtEnd}let i;if(e==this.dom&&this.contentDOM)i=n>yt(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))i=e.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(n==0)for(let o=e;;o=o.parentNode){if(o==this.dom){i=!1;break}if(o.previousSibling)break}if(i==null&&n==e.childNodes.length)for(let o=e;;o=o.parentNode){if(o==this.dom){i=!0;break}if(o.nextSibling)break}}return i??r>0?this.posAtEnd:this.posAtStart}nearestDesc(e,n=!1){for(let r=!0,i=e;i;i=i.parentNode){let o=this.getDesc(i),s;if(o&&(!n||o.node))if(r&&(s=o.nodeDOM)&&!(s.nodeType==1?s.contains(e.nodeType==1?e:e.parentNode):s==e))r=!1;else return o}}getDesc(e){let n=e.pmViewDesc;for(let r=n;r;r=r.parent)if(r==this)return n}posFromDOM(e,n,r){for(let i=e;i;i=i.parentNode){let o=this.getDesc(i);if(o)return o.localPosFromDOM(e,n,r)}return-1}descAt(e){for(let n=0,r=0;n<this.children.length;n++){let i=this.children[n],o=r+i.size;if(r==e&&o!=r){for(;!i.border&&i.children.length;)for(let s=0;s<i.children.length;s++){let a=i.children[s];if(a.size){i=a;break}}return i}if(e<o)return i.descAt(e-r-i.border);r=o}}domFromPos(e,n){if(!this.contentDOM)return{node:this.dom,offset:0,atom:e+1};let r=0,i=0;for(let o=0;r<this.children.length;r++){let s=this.children[r],a=o+s.size;if(a>e||s instanceof LR){i=e-o;break}o=a}if(i)return this.children[r].domFromPos(i-this.children[r].border,n);for(let o;r&&!(o=this.children[r-1]).size&&o instanceof DR&&o.side>=0;r--);if(n<=0){let o,s=!0;for(;o=r?this.children[r-1]:null,!(!o||o.dom.parentNode==this.contentDOM);r--,s=!1);return o&&n&&s&&!o.border&&!o.domAtom?o.domFromPos(o.size,n):{node:this.contentDOM,offset:o?yt(o.dom)+1:0}}else{let o,s=!0;for(;o=r<this.children.length?this.children[r]:null,!(!o||o.dom.parentNode==this.contentDOM);r++,s=!1);return o&&s&&!o.border&&!o.domAtom?o.domFromPos(0,n):{node:this.contentDOM,offset:o?yt(o.dom):this.contentDOM.childNodes.length}}}parseRange(e,n,r=0){if(this.children.length==0)return{node:this.contentDOM,from:e,to:n,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let i=-1,o=-1;for(let s=r,a=0;;a++){let l=this.children[a],c=s+l.size;if(i==-1&&e<=c){let u=s+l.border;if(e>=u&&n<=c-l.border&&l.node&&l.contentDOM&&this.contentDOM.contains(l.contentDOM))return l.parseRange(e,n,u);e=s;for(let d=a;d>0;d--){let h=this.children[d-1];if(h.size&&h.dom.parentNode==this.contentDOM&&!h.emptyChildAt(1)){i=yt(h.dom)+1;break}e-=h.size}i==-1&&(i=0)}if(i>-1&&(c>n||a==this.children.length-1)){n=c;for(let u=a+1;u<this.children.length;u++){let d=this.children[u];if(d.size&&d.dom.parentNode==this.contentDOM&&!d.emptyChildAt(-1)){o=yt(d.dom);break}n+=d.size}o==-1&&(o=this.contentDOM.childNodes.length);break}s=c}return{node:this.contentDOM,from:e,to:n,fromOffset:i,toOffset:o}}emptyChildAt(e){if(this.border||!this.contentDOM||!this.children.length)return!1;let n=this.children[e<0?0:this.children.length-1];return n.size==0||n.emptyChildAt(e)}domAfterPos(e){let{node:n,offset:r}=this.domFromPos(e,0);if(n.nodeType!=1||r==n.childNodes.length)throw new RangeError("No node after pos "+e);return n.childNodes[r]}setSelection(e,n,r,i=!1){let o=Math.min(e,n),s=Math.max(e,n);for(let p=0,g=0;p<this.children.length;p++){let y=this.children[p],x=g+y.size;if(o>g&&s<x)return y.setSelection(e-g-y.border,n-g-y.border,r,i);g=x}let a=this.domFromPos(e,e?-1:1),l=n==e?a:this.domFromPos(n,n?-1:1),c=r.root.getSelection(),u=r.domSelectionRange(),d=!1;if((hr||Wt)&&e==n){let{node:p,offset:g}=a;if(p.nodeType==3){if(d=!!(g&&p.nodeValue[g-1]==`
`),d&&g==p.nodeValue.length)for(let y=p,x;y;y=y.parentNode){if(x=y.nextSibling){x.nodeName=="BR"&&(a=l={node:x.parentNode,offset:yt(x)+1});break}let v=y.pmViewDesc;if(v&&v.node&&v.node.isBlock)break}}else{let y=p.childNodes[g-1];d=y&&(y.nodeName=="BR"||y.contentEditable=="false")}}if(hr&&u.focusNode&&u.focusNode!=l.node&&u.focusNode.nodeType==1){let p=u.focusNode.childNodes[u.focusOffset];p&&p.contentEditable=="false"&&(i=!0)}if(!(i||d&&Wt)&&Vs(a.node,a.offset,u.anchorNode,u.anchorOffset)&&Vs(l.node,l.offset,u.focusNode,u.focusOffset))return;let h=!1;if((c.extend||e==n)&&!d){c.collapse(a.node,a.offset);try{e!=n&&c.extend(l.node,l.offset),h=!0}catch{}}if(!h){if(e>n){let g=a;a=l,l=g}let p=document.createRange();p.setEnd(l.node,l.offset),p.setStart(a.node,a.offset),c.removeAllRanges(),c.addRange(p)}}ignoreMutation(e){return!this.contentDOM&&e.type!="selection"}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(e,n){for(let r=0,i=0;i<this.children.length;i++){let o=this.children[i],s=r+o.size;if(r==s?e<=s&&n>=r:e<s&&n>r){let a=r+o.border,l=s-o.border;if(e>=a&&n<=l){this.dirty=e==r||n==s?is:C1,e==a&&n==l&&(o.contentLost||o.dom.parentNode!=this.contentDOM)?o.dirty=Vr:o.markDirty(e-a,n-a);return}else o.dirty=o.dom==o.contentDOM&&o.dom.parentNode==this.contentDOM&&!o.children.length?is:Vr}r=s}this.dirty=is}markParentsDirty(){let e=1;for(let n=this.parent;n;n=n.parent,e++){let r=e==1?is:C1;n.dirty<r&&(n.dirty=r)}}get domAtom(){return!1}get ignoreForCoords(){return!1}isText(e){return!1}}class DR extends Ju{constructor(e,n,r,i){let o,s=n.type.toDOM;if(typeof s=="function"&&(s=s(r,()=>{if(!o)return i;if(o.parent)return o.parent.posBeforeChild(o)})),!n.type.spec.raw){if(s.nodeType!=1){let a=document.createElement("span");a.appendChild(s),s=a}s.contentEditable="false",s.classList.add("ProseMirror-widget")}super(e,[],s,null),this.widget=n,this.widget=n,o=this}matchesWidget(e){return this.dirty==Bn&&e.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(e){let n=this.widget.spec.stopEvent;return n?n(e):!1}ignoreMutation(e){return e.type!="selection"||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get side(){return this.widget.type.side}}class PB extends Ju{constructor(e,n,r,i){super(e,[],n,null),this.textDOM=r,this.text=i}get size(){return this.text.length}localPosFromDOM(e,n){return e!=this.textDOM?this.posAtStart+(n?this.size:0):this.posAtStart+n}domFromPos(e){return{node:this.textDOM,offset:e}}ignoreMutation(e){return e.type==="characterData"&&e.target.nodeValue==e.oldValue}}class Us extends Ju{constructor(e,n,r,i,o){super(e,[],r,i),this.mark=n,this.spec=o}static create(e,n,r,i){let o=i.nodeViews[n.type.name],s=o&&o(n,i,r);return(!s||!s.dom)&&(s=Zs.renderSpec(document,n.type.spec.toDOM(n,r),null,n.attrs)),new Us(e,n,s.dom,s.contentDOM||s.dom,s)}parseRule(){return this.dirty&Vr||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(e){return this.dirty!=Vr&&this.mark.eq(e)}markDirty(e,n){if(super.markDirty(e,n),this.dirty!=Bn){let r=this.parent;for(;!r.node;)r=r.parent;r.dirty<this.dirty&&(r.dirty=this.dirty),this.dirty=Bn}}slice(e,n,r){let i=Us.create(this.parent,this.mark,!0,r),o=this.children,s=this.size;n<s&&(o=Vy(o,n,s,r)),e>0&&(o=Vy(o,0,e,r));for(let a=0;a<o.length;a++)o[a].parent=i;return i.children=o,i}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}}class So extends Ju{constructor(e,n,r,i,o,s,a,l,c){super(e,[],o,s),this.node=n,this.outerDeco=r,this.innerDeco=i,this.nodeDOM=a}static create(e,n,r,i,o,s){let a=o.nodeViews[n.type.name],l,c=a&&a(n,o,()=>{if(!l)return s;if(l.parent)return l.parent.posBeforeChild(l)},r,i),u=c&&c.dom,d=c&&c.contentDOM;if(n.isText){if(!u)u=document.createTextNode(n.text);else if(u.nodeType!=3)throw new RangeError("Text must be rendered as a DOM text node")}else u||({dom:u,contentDOM:d}=Zs.renderSpec(document,n.type.spec.toDOM(n),null,n.attrs));!d&&!n.isText&&u.nodeName!="BR"&&(u.hasAttribute("contenteditable")||(u.contentEditable="false"),n.type.spec.draggable&&(u.draggable=!0));let h=u;return u=BR(u,r,n),c?l=new MB(e,n,r,i,u,d||null,h,c,o,s+1):n.isText?new fp(e,n,r,i,u,h,o):new So(e,n,r,i,u,d||null,h,o,s+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let e={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre"&&(e.preserveWhitespace="full"),!this.contentDOM)e.getContent=()=>this.node.content;else if(!this.contentLost)e.contentElement=this.contentDOM;else{for(let n=this.children.length-1;n>=0;n--){let r=this.children[n];if(this.dom.contains(r.dom.parentNode)){e.contentElement=r.dom.parentNode;break}}e.contentElement||(e.getContent=()=>F.empty)}return e}matchesNode(e,n,r){return this.dirty==Bn&&e.eq(this.node)&&uh(n,this.outerDeco)&&r.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(e,n){let r=this.node.inlineContent,i=n,o=e.composing?this.localCompositionInfo(e,n):null,s=o&&o.pos>-1?o:null,a=o&&o.pos<0,l=new AB(this,s&&s.node,e);DB(this.node,this.innerDeco,(c,u,d)=>{c.spec.marks?l.syncToMarks(c.spec.marks,r,e):c.type.side>=0&&!d&&l.syncToMarks(u==this.node.childCount?Re.none:this.node.child(u).marks,r,e),l.placeWidget(c,e,i)},(c,u,d,h)=>{l.syncToMarks(c.marks,r,e);let p;l.findNodeMatch(c,u,d,h)||a&&e.state.selection.from>i&&e.state.selection.to<i+c.nodeSize&&(p=l.findIndexWithChild(o.node))>-1&&l.updateNodeAt(c,u,d,p,e)||l.updateNextNode(c,u,d,e,h,i)||l.addNode(c,u,d,e,i),i+=c.nodeSize}),l.syncToMarks([],r,e),this.node.isTextblock&&l.addTextblockHacks(),l.destroyRest(),(l.changed||this.dirty==is)&&(s&&this.protectLocalComposition(e,s),$R(this.contentDOM,this.children,e),kl&&LB(this.dom))}localCompositionInfo(e,n){let{from:r,to:i}=e.state.selection;if(!(e.state.selection instanceof ie)||r<n||i>n+this.node.content.size)return null;let o=e.input.compositionNode;if(!o||!this.dom.contains(o.parentNode))return null;if(this.node.inlineContent){let s=o.nodeValue,a=$B(this.node.content,s,r-n,i-n);return a<0?null:{node:o,pos:a,text:s}}else return{node:o,pos:-1,text:""}}protectLocalComposition(e,{node:n,pos:r,text:i}){if(this.getDesc(n))return;let o=n;for(;o.parentNode!=this.contentDOM;o=o.parentNode){for(;o.previousSibling;)o.parentNode.removeChild(o.previousSibling);for(;o.nextSibling;)o.parentNode.removeChild(o.nextSibling);o.pmViewDesc&&(o.pmViewDesc=void 0)}let s=new PB(this,o,n,i);e.input.compositionNodes.push(s),this.children=Vy(this.children,r,r+i.length,e,s)}update(e,n,r,i){return this.dirty==Vr||!e.sameMarkup(this.node)?!1:(this.updateInner(e,n,r,i),!0)}updateInner(e,n,r,i){this.updateOuterDeco(n),this.node=e,this.innerDeco=r,this.contentDOM&&this.updateChildren(i,this.posAtStart),this.dirty=Bn}updateOuterDeco(e){if(uh(e,this.outerDeco))return;let n=this.nodeDOM.nodeType!=1,r=this.dom;this.dom=FR(this.dom,this.nodeDOM,zy(this.outerDeco,this.node,n),zy(e,this.node,n)),this.dom!=r&&(r.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=e}selectNode(){this.nodeDOM.nodeType==1&&this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.dom.draggable=!0)}deselectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.dom.removeAttribute("draggable"))}get domAtom(){return this.node.isAtom}}function k1(t,e,n,r,i){BR(r,e,t);let o=new So(void 0,t,e,n,r,r,r,i,0);return o.contentDOM&&o.updateChildren(i,0),o}class fp extends So{constructor(e,n,r,i,o,s,a){super(e,n,r,i,o,null,s,a,0)}parseRule(){let e=this.nodeDOM.parentNode;for(;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}}update(e,n,r,i){return this.dirty==Vr||this.dirty!=Bn&&!this.inParent()||!e.sameMarkup(this.node)?!1:(this.updateOuterDeco(n),(this.dirty!=Bn||e.text!=this.node.text)&&e.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=e.text,i.trackWrites==this.nodeDOM&&(i.trackWrites=null)),this.node=e,this.dirty=Bn,!0)}inParent(){let e=this.parent.contentDOM;for(let n=this.nodeDOM;n;n=n.parentNode)if(n==e)return!0;return!1}domFromPos(e){return{node:this.nodeDOM,offset:e}}localPosFromDOM(e,n,r){return e==this.nodeDOM?this.posAtStart+Math.min(n,this.node.text.length):super.localPosFromDOM(e,n,r)}ignoreMutation(e){return e.type!="characterData"&&e.type!="selection"}slice(e,n,r){let i=this.node.cut(e,n),o=document.createTextNode(i.text);return new fp(this.parent,i,this.outerDeco,this.innerDeco,o,o,r)}markDirty(e,n){super.markDirty(e,n),this.dom!=this.nodeDOM&&(e==0||n==this.nodeDOM.nodeValue.length)&&(this.dirty=Vr)}get domAtom(){return!1}isText(e){return this.node.text==e}}class LR extends Ju{parseRule(){return{ignore:!0}}matchesHack(e){return this.dirty==Bn&&this.dom.nodeName==e}get domAtom(){return!0}get ignoreForCoords(){return this.dom.nodeName=="IMG"}}class MB extends So{constructor(e,n,r,i,o,s,a,l,c,u){super(e,n,r,i,o,s,a,c,u),this.spec=l}update(e,n,r,i){if(this.dirty==Vr)return!1;if(this.spec.update&&(this.node.type==e.type||this.spec.multiType)){let o=this.spec.update(e,n,r);return o&&this.updateInner(e,n,r,i),o}else return!this.contentDOM&&!e.isLeaf?!1:super.update(e,n,r,i)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(e,n,r,i){this.spec.setSelection?this.spec.setSelection(e,n,r.root):super.setSelection(e,n,r,i)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(e){return this.spec.stopEvent?this.spec.stopEvent(e):!1}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}}function $R(t,e,n){let r=t.firstChild,i=!1;for(let o=0;o<e.length;o++){let s=e[o],a=s.dom;if(a.parentNode==t){for(;a!=r;)r=E1(r),i=!0;r=r.nextSibling}else i=!0,t.insertBefore(a,r);if(s instanceof Us){let l=r?r.previousSibling:t.lastChild;$R(s.contentDOM,s.children,n),r=l?l.nextSibling:t.firstChild}}for(;r;)r=E1(r),i=!0;i&&n.trackWrites==t&&(n.trackWrites=null)}const Nc=function(t){t&&(this.nodeName=t)};Nc.prototype=Object.create(null);const ss=[new Nc];function zy(t,e,n){if(t.length==0)return ss;let r=n?ss[0]:new Nc,i=[r];for(let o=0;o<t.length;o++){let s=t[o].type.attrs;if(s){s.nodeName&&i.push(r=new Nc(s.nodeName));for(let a in s){let l=s[a];l!=null&&(n&&i.length==1&&i.push(r=new Nc(e.isInline?"span":"div")),a=="class"?r.class=(r.class?r.class+" ":"")+l:a=="style"?r.style=(r.style?r.style+";":"")+l:a!="nodeName"&&(r[a]=l))}}}return i}function FR(t,e,n,r){if(n==ss&&r==ss)return e;let i=e;for(let o=0;o<r.length;o++){let s=r[o],a=n[o];if(o){let l;a&&a.nodeName==s.nodeName&&i!=t&&(l=i.parentNode)&&l.nodeName.toLowerCase()==s.nodeName||(l=document.createElement(s.nodeName),l.pmIsDeco=!0,l.appendChild(i),a=ss[0]),i=l}IB(i,a||ss[0],s)}return i}function IB(t,e,n){for(let r in e)r!="class"&&r!="style"&&r!="nodeName"&&!(r in n)&&t.removeAttribute(r);for(let r in n)r!="class"&&r!="style"&&r!="nodeName"&&n[r]!=e[r]&&t.setAttribute(r,n[r]);if(e.class!=n.class){let r=e.class?e.class.split(" ").filter(Boolean):[],i=n.class?n.class.split(" ").filter(Boolean):[];for(let o=0;o<r.length;o++)i.indexOf(r[o])==-1&&t.classList.remove(r[o]);for(let o=0;o<i.length;o++)r.indexOf(i[o])==-1&&t.classList.add(i[o]);t.classList.length==0&&t.removeAttribute("class")}if(e.style!=n.style){if(e.style){let r=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,i;for(;i=r.exec(e.style);)t.style.removeProperty(i[1])}n.style&&(t.style.cssText+=n.style)}}function BR(t,e,n){return FR(t,t,ss,zy(e,n,t.nodeType!=1))}function uh(t,e){if(t.length!=e.length)return!1;for(let n=0;n<t.length;n++)if(!t[n].type.eq(e[n].type))return!1;return!0}function E1(t){let e=t.nextSibling;return t.parentNode.removeChild(t),e}class AB{constructor(e,n,r){this.lock=n,this.view=r,this.index=0,this.stack=[],this.changed=!1,this.top=e,this.preMatch=NB(e.node.content,e)}destroyBetween(e,n){if(e!=n){for(let r=e;r<n;r++)this.top.children[r].destroy();this.top.children.splice(e,n-e),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(e,n,r){let i=0,o=this.stack.length>>1,s=Math.min(o,e.length);for(;i<s&&(i==o-1?this.top:this.stack[i+1<<1]).matchesMark(e[i])&&e[i].type.spec.spanning!==!1;)i++;for(;i<o;)this.destroyRest(),this.top.dirty=Bn,this.index=this.stack.pop(),this.top=this.stack.pop(),o--;for(;o<e.length;){this.stack.push(this.top,this.index+1);let a=-1;for(let l=this.index;l<Math.min(this.index+3,this.top.children.length);l++){let c=this.top.children[l];if(c.matchesMark(e[o])&&!this.isLocked(c.dom)){a=l;break}}if(a>-1)a>this.index&&(this.changed=!0,this.destroyBetween(this.index,a)),this.top=this.top.children[this.index];else{let l=Us.create(this.top,e[o],n,r);this.top.children.splice(this.index,0,l),this.top=l,this.changed=!0}this.index=0,o++}}findNodeMatch(e,n,r,i){let o=-1,s;if(i>=this.preMatch.index&&(s=this.preMatch.matches[i-this.preMatch.index]).parent==this.top&&s.matchesNode(e,n,r))o=this.top.children.indexOf(s,this.index);else for(let a=this.index,l=Math.min(this.top.children.length,a+5);a<l;a++){let c=this.top.children[a];if(c.matchesNode(e,n,r)&&!this.preMatch.matched.has(c)){o=a;break}}return o<0?!1:(this.destroyBetween(this.index,o),this.index++,!0)}updateNodeAt(e,n,r,i,o){let s=this.top.children[i];return s.dirty==Vr&&s.dom==s.contentDOM&&(s.dirty=is),s.update(e,n,r,o)?(this.destroyBetween(this.index,i),this.index++,!0):!1}findIndexWithChild(e){for(;;){let n=e.parentNode;if(!n)return-1;if(n==this.top.contentDOM){let r=e.pmViewDesc;if(r){for(let i=this.index;i<this.top.children.length;i++)if(this.top.children[i]==r)return i}return-1}e=n}}updateNextNode(e,n,r,i,o,s){for(let a=this.index;a<this.top.children.length;a++){let l=this.top.children[a];if(l instanceof So){let c=this.preMatch.matched.get(l);if(c!=null&&c!=o)return!1;let u=l.dom,d,h=this.isLocked(u)&&!(e.isText&&l.node&&l.node.isText&&l.nodeDOM.nodeValue==e.text&&l.dirty!=Vr&&uh(n,l.outerDeco));if(!h&&l.update(e,n,r,i))return this.destroyBetween(this.index,a),l.dom!=u&&(this.changed=!0),this.index++,!0;if(!h&&(d=this.recreateWrapper(l,e,n,r,i,s)))return this.destroyBetween(this.index,a),this.top.children[this.index]=d,d.contentDOM&&(d.dirty=is,d.updateChildren(i,s+1),d.dirty=Bn),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(e,n,r,i,o,s){if(e.dirty||n.isAtom||!e.children.length||!e.node.content.eq(n.content)||!uh(r,e.outerDeco)||!i.eq(e.innerDeco))return null;let a=So.create(this.top,n,r,i,o,s);if(a.contentDOM){a.children=e.children,e.children=[];for(let l of a.children)l.parent=a}return e.destroy(),a}addNode(e,n,r,i,o){let s=So.create(this.top,e,n,r,i,o);s.contentDOM&&s.updateChildren(i,o+1),this.top.children.splice(this.index++,0,s),this.changed=!0}placeWidget(e,n,r){let i=this.index<this.top.children.length?this.top.children[this.index]:null;if(i&&i.matchesWidget(e)&&(e==i.widget||!i.widget.type.toDOM.parentNode))this.index++;else{let o=new DR(this.top,e,n,r);this.top.children.splice(this.index++,0,o),this.changed=!0}}addTextblockHacks(){let e=this.top.children[this.index-1],n=this.top;for(;e instanceof Us;)n=e,e=n.children[n.children.length-1];(!e||!(e instanceof fp)||/\n$/.test(e.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(e.node.text))&&((Wt||Ot)&&e&&e.dom.contentEditable=="false"&&this.addHackNode("IMG",n),this.addHackNode("BR",this.top))}addHackNode(e,n){if(n==this.top&&this.index<n.children.length&&n.children[this.index].matchesHack(e))this.index++;else{let r=document.createElement(e);e=="IMG"&&(r.className="ProseMirror-separator",r.alt=""),e=="BR"&&(r.className="ProseMirror-trailingBreak");let i=new LR(this.top,[],r,null);n!=this.top?n.children.push(i):n.children.splice(this.index++,0,i),this.changed=!0}}isLocked(e){return this.lock&&(e==this.lock||e.nodeType==1&&e.contains(this.lock.parentNode))}}function NB(t,e){let n=e,r=n.children.length,i=t.childCount,o=new Map,s=[];e:for(;i>0;){let a;for(;;)if(r){let c=n.children[r-1];if(c instanceof Us)n=c,r=c.children.length;else{a=c,r--;break}}else{if(n==e)break e;r=n.parent.children.indexOf(n),n=n.parent}let l=a.node;if(l){if(l!=t.child(i-1))break;--i,o.set(a,i),s.push(a)}}return{index:i,matched:o,matches:s.reverse()}}function jB(t,e){return t.type.side-e.type.side}function DB(t,e,n,r){let i=e.locals(t),o=0;if(i.length==0){for(let c=0;c<t.childCount;c++){let u=t.child(c);r(u,i,e.forChild(o,u),c),o+=u.nodeSize}return}let s=0,a=[],l=null;for(let c=0;;){let u,d;for(;s<i.length&&i[s].to==o;){let x=i[s++];x.widget&&(u?(d||(d=[u])).push(x):u=x)}if(u)if(d){d.sort(jB);for(let x=0;x<d.length;x++)n(d[x],c,!!l)}else n(u,c,!!l);let h,p;if(l)p=-1,h=l,l=null;else if(c<t.childCount)p=c,h=t.child(c++);else break;for(let x=0;x<a.length;x++)a[x].to<=o&&a.splice(x--,1);for(;s<i.length&&i[s].from<=o&&i[s].to>o;)a.push(i[s++]);let g=o+h.nodeSize;if(h.isText){let x=g;s<i.length&&i[s].from<x&&(x=i[s].from);for(let v=0;v<a.length;v++)a[v].to<x&&(x=a[v].to);x<g&&(l=h.cut(x-o),h=h.cut(0,x-o),g=x,p=-1)}else for(;s<i.length&&i[s].to<g;)s++;let y=h.isInline&&!h.isLeaf?a.filter(x=>!x.inline):a.slice();r(h,y,e.forChild(o,h),p),o=g}}function LB(t){if(t.nodeName=="UL"||t.nodeName=="OL"){let e=t.style.cssText;t.style.cssText=e+"; list-style: square !important",window.getComputedStyle(t).listStyle,t.style.cssText=e}}function $B(t,e,n,r){for(let i=0,o=0;i<t.childCount&&o<=r;){let s=t.child(i++),a=o;if(o+=s.nodeSize,!s.isText)continue;let l=s.text;for(;i<t.childCount;){let c=t.child(i++);if(o+=c.nodeSize,!c.isText)break;l+=c.text}if(o>=n){if(o>=r&&l.slice(r-e.length-a,r-a)==e)return r-e.length;let c=a<r?l.lastIndexOf(e,r-a-1):-1;if(c>=0&&c+e.length+a>=n)return a+c;if(n==r&&l.length>=r+e.length-a&&l.slice(r-a,r-a+e.length)==e)return r}}return-1}function Vy(t,e,n,r,i){let o=[];for(let s=0,a=0;s<t.length;s++){let l=t[s],c=a,u=a+=l.size;c>=n||u<=e?o.push(l):(c<e&&o.push(l.slice(0,e-c,r)),i&&(o.push(i),i=void 0),u>n&&o.push(l.slice(n-c,l.size,r)))}return o}function cx(t,e=null){let n=t.domSelectionRange(),r=t.state.doc;if(!n.focusNode)return null;let i=t.docView.nearestDesc(n.focusNode),o=i&&i.size==0,s=t.docView.posFromDOM(n.focusNode,n.focusOffset,1);if(s<0)return null;let a=r.resolve(s),l,c;if(dp(n)){for(l=s;i&&!i.node;)i=i.parent;let d=i.node;if(i&&d.isAtom&&te.isSelectable(d)&&i.parent&&!(d.isInline&&uB(n.focusNode,n.focusOffset,i.dom))){let h=i.posBefore;c=new te(s==h?a:r.resolve(h))}}else{if(n instanceof t.dom.ownerDocument.defaultView.Selection&&n.rangeCount>1){let d=s,h=s;for(let p=0;p<n.rangeCount;p++){let g=n.getRangeAt(p);d=Math.min(d,t.docView.posFromDOM(g.startContainer,g.startOffset,1)),h=Math.max(h,t.docView.posFromDOM(g.endContainer,g.endOffset,-1))}if(d<0)return null;[l,s]=h==t.state.selection.anchor?[h,d]:[d,h],a=r.resolve(s)}else l=t.docView.posFromDOM(n.anchorNode,n.anchorOffset,1);if(l<0)return null}let u=r.resolve(l);if(!c){let d=e=="pointer"||t.state.selection.head<a.pos&&!o?1:-1;c=ux(t,u,a,d)}return c}function zR(t){return t.editable?t.hasFocus():UR(t)&&document.activeElement&&document.activeElement.contains(t.dom)}function li(t,e=!1){let n=t.state.selection;if(VR(t,n),!!zR(t)){if(!e&&t.input.mouseDown&&t.input.mouseDown.allowDefault&&Ot){let r=t.domSelectionRange(),i=t.domObserver.currentSelection;if(r.anchorNode&&i.anchorNode&&Vs(r.anchorNode,r.anchorOffset,i.anchorNode,i.anchorOffset)){t.input.mouseDown.delayedSelectionSync=!0,t.domObserver.setCurSelection();return}}if(t.domObserver.disconnectSelection(),t.cursorWrapper)BB(t);else{let{anchor:r,head:i}=n,o,s;T1&&!(n instanceof ie)&&(n.$from.parent.inlineContent||(o=_1(t,n.from)),!n.empty&&!n.$from.parent.inlineContent&&(s=_1(t,n.to))),t.docView.setSelection(r,i,t,e),T1&&(o&&R1(o),s&&R1(s)),n.visible?t.dom.classList.remove("ProseMirror-hideselection"):(t.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&FB(t))}t.domObserver.setCurSelection(),t.domObserver.connectSelection()}}const T1=Wt||Ot&&OR<63;function _1(t,e){let{node:n,offset:r}=t.docView.domFromPos(e,0),i=r<n.childNodes.length?n.childNodes[r]:null,o=r?n.childNodes[r-1]:null;if(Wt&&i&&i.contentEditable=="false")return Nm(i);if((!i||i.contentEditable=="false")&&(!o||o.contentEditable=="false")){if(i)return Nm(i);if(o)return Nm(o)}}function Nm(t){return t.contentEditable="true",Wt&&t.draggable&&(t.draggable=!1,t.wasDraggable=!0),t}function R1(t){t.contentEditable="false",t.wasDraggable&&(t.draggable=!0,t.wasDraggable=null)}function FB(t){let e=t.dom.ownerDocument;e.removeEventListener("selectionchange",t.input.hideSelectionGuard);let n=t.domSelectionRange(),r=n.anchorNode,i=n.anchorOffset;e.addEventListener("selectionchange",t.input.hideSelectionGuard=()=>{(n.anchorNode!=r||n.anchorOffset!=i)&&(e.removeEventListener("selectionchange",t.input.hideSelectionGuard),setTimeout(()=>{(!zR(t)||t.state.selection.visible)&&t.dom.classList.remove("ProseMirror-hideselection")},20))})}function BB(t){let e=t.domSelection(),n=document.createRange();if(!e)return;let r=t.cursorWrapper.dom,i=r.nodeName=="IMG";i?n.setStart(r.parentNode,yt(r)+1):n.setStart(r,0),n.collapse(!0),e.removeAllRanges(),e.addRange(n),!i&&!t.state.selection.visible&&dn&&bo<=11&&(r.disabled=!0,r.disabled=!1)}function VR(t,e){if(e instanceof te){let n=t.docView.descAt(e.from);n!=t.lastSelectedViewDesc&&(O1(t),n&&n.selectNode(),t.lastSelectedViewDesc=n)}else O1(t)}function O1(t){t.lastSelectedViewDesc&&(t.lastSelectedViewDesc.parent&&t.lastSelectedViewDesc.deselectNode(),t.lastSelectedViewDesc=void 0)}function ux(t,e,n,r){return t.someProp("createSelectionBetween",i=>i(t,e,n))||ie.between(e,n,r)}function P1(t){return t.editable&&!t.hasFocus()?!1:UR(t)}function UR(t){let e=t.domSelectionRange();if(!e.anchorNode)return!1;try{return t.dom.contains(e.anchorNode.nodeType==3?e.anchorNode.parentNode:e.anchorNode)&&(t.editable||t.dom.contains(e.focusNode.nodeType==3?e.focusNode.parentNode:e.focusNode))}catch{return!1}}function zB(t){let e=t.docView.domFromPos(t.state.selection.anchor,0),n=t.domSelectionRange();return Vs(e.node,e.offset,n.anchorNode,n.anchorOffset)}function Uy(t,e){let{$anchor:n,$head:r}=t.selection,i=e>0?n.max(r):n.min(r),o=i.parent.inlineContent?i.depth?t.doc.resolve(e>0?i.after():i.before()):null:i;return o&&oe.findFrom(o,e)}function Ni(t,e){return t.dispatch(t.state.tr.setSelection(e).scrollIntoView()),!0}function M1(t,e,n){let r=t.state.selection;if(r instanceof ie)if(n.indexOf("s")>-1){let{$head:i}=r,o=i.textOffset?null:e<0?i.nodeBefore:i.nodeAfter;if(!o||o.isText||!o.isLeaf)return!1;let s=t.state.doc.resolve(i.pos+o.nodeSize*(e<0?-1:1));return Ni(t,new ie(r.$anchor,s))}else if(r.empty){if(t.endOfTextblock(e>0?"forward":"backward")){let i=Uy(t.state,e);return i&&i instanceof te?Ni(t,i):!1}else if(!(In&&n.indexOf("m")>-1)){let i=r.$head,o=i.textOffset?null:e<0?i.nodeBefore:i.nodeAfter,s;if(!o||o.isText)return!1;let a=e<0?i.pos-o.nodeSize:i.pos;return o.isAtom||(s=t.docView.descAt(a))&&!s.contentDOM?te.isSelectable(o)?Ni(t,new te(e<0?t.state.doc.resolve(i.pos-o.nodeSize):i)):Gu?Ni(t,new ie(t.state.doc.resolve(e<0?a:a+o.nodeSize))):!1:!1}}else return!1;else{if(r instanceof te&&r.node.isInline)return Ni(t,new ie(e>0?r.$to:r.$from));{let i=Uy(t.state,e);return i?Ni(t,i):!1}}}function dh(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function jc(t,e){let n=t.pmViewDesc;return n&&n.size==0&&(e<0||t.nextSibling||t.nodeName!="BR")}function da(t,e){return e<0?VB(t):UB(t)}function VB(t){let e=t.domSelectionRange(),n=e.focusNode,r=e.focusOffset;if(!n)return;let i,o,s=!1;for(hr&&n.nodeType==1&&r<dh(n)&&jc(n.childNodes[r],-1)&&(s=!0);;)if(r>0){if(n.nodeType!=1)break;{let a=n.childNodes[r-1];if(jc(a,-1))i=n,o=--r;else if(a.nodeType==3)n=a,r=n.nodeValue.length;else break}}else{if(HR(n))break;{let a=n.previousSibling;for(;a&&jc(a,-1);)i=n.parentNode,o=yt(a),a=a.previousSibling;if(a)n=a,r=dh(n);else{if(n=n.parentNode,n==t.dom)break;r=0}}}s?Hy(t,n,r):i&&Hy(t,i,o)}function UB(t){let e=t.domSelectionRange(),n=e.focusNode,r=e.focusOffset;if(!n)return;let i=dh(n),o,s;for(;;)if(r<i){if(n.nodeType!=1)break;let a=n.childNodes[r];if(jc(a,1))o=n,s=++r;else break}else{if(HR(n))break;{let a=n.nextSibling;for(;a&&jc(a,1);)o=a.parentNode,s=yt(a)+1,a=a.nextSibling;if(a)n=a,r=0,i=dh(n);else{if(n=n.parentNode,n==t.dom)break;r=i=0}}}o&&Hy(t,o,s)}function HR(t){let e=t.pmViewDesc;return e&&e.node&&e.node.isBlock}function HB(t,e){for(;t&&e==t.childNodes.length&&!qu(t);)e=yt(t)+1,t=t.parentNode;for(;t&&e<t.childNodes.length;){let n=t.childNodes[e];if(n.nodeType==3)return n;if(n.nodeType==1&&n.contentEditable=="false")break;t=n,e=0}}function WB(t,e){for(;t&&!e&&!qu(t);)e=yt(t),t=t.parentNode;for(;t&&e;){let n=t.childNodes[e-1];if(n.nodeType==3)return n;if(n.nodeType==1&&n.contentEditable=="false")break;t=n,e=t.childNodes.length}}function Hy(t,e,n){if(e.nodeType!=3){let o,s;(s=HB(e,n))?(e=s,n=0):(o=WB(e,n))&&(e=o,n=o.nodeValue.length)}let r=t.domSelection();if(!r)return;if(dp(r)){let o=document.createRange();o.setEnd(e,n),o.setStart(e,n),r.removeAllRanges(),r.addRange(o)}else r.extend&&r.extend(e,n);t.domObserver.setCurSelection();let{state:i}=t;setTimeout(()=>{t.state==i&&li(t)},50)}function I1(t,e){let n=t.state.doc.resolve(e);if(!(Ot||hB)&&n.parent.inlineContent){let i=t.coordsAtPos(e);if(e>n.start()){let o=t.coordsAtPos(e-1),s=(o.top+o.bottom)/2;if(s>i.top&&s<i.bottom&&Math.abs(o.left-i.left)>1)return o.left<i.left?"ltr":"rtl"}if(e<n.end()){let o=t.coordsAtPos(e+1),s=(o.top+o.bottom)/2;if(s>i.top&&s<i.bottom&&Math.abs(o.left-i.left)>1)return o.left>i.left?"ltr":"rtl"}}return getComputedStyle(t.dom).direction=="rtl"?"rtl":"ltr"}function A1(t,e,n){let r=t.state.selection;if(r instanceof ie&&!r.empty||n.indexOf("s")>-1||In&&n.indexOf("m")>-1)return!1;let{$from:i,$to:o}=r;if(!i.parent.inlineContent||t.endOfTextblock(e<0?"up":"down")){let s=Uy(t.state,e);if(s&&s instanceof te)return Ni(t,s)}if(!i.parent.inlineContent){let s=e<0?i:o,a=r instanceof Fn?oe.near(s,e):oe.findFrom(s,e);return a?Ni(t,a):!1}return!1}function N1(t,e){if(!(t.state.selection instanceof ie))return!0;let{$head:n,$anchor:r,empty:i}=t.state.selection;if(!n.sameParent(r))return!0;if(!i)return!1;if(t.endOfTextblock(e>0?"forward":"backward"))return!0;let o=!n.textOffset&&(e<0?n.nodeBefore:n.nodeAfter);if(o&&!o.isText){let s=t.state.tr;return e<0?s.delete(n.pos-o.nodeSize,n.pos):s.delete(n.pos,n.pos+o.nodeSize),t.dispatch(s),!0}return!1}function j1(t,e,n){t.domObserver.stop(),e.contentEditable=n,t.domObserver.start()}function KB(t){if(!Wt||t.state.selection.$head.parentOffset>0)return!1;let{focusNode:e,focusOffset:n}=t.domSelectionRange();if(e&&e.nodeType==1&&n==0&&e.firstChild&&e.firstChild.contentEditable=="false"){let r=e.firstChild;j1(t,r,"true"),setTimeout(()=>j1(t,r,"false"),20)}return!1}function qB(t){let e="";return t.ctrlKey&&(e+="c"),t.metaKey&&(e+="m"),t.altKey&&(e+="a"),t.shiftKey&&(e+="s"),e}function GB(t,e){let n=e.keyCode,r=qB(e);if(n==8||In&&n==72&&r=="c")return N1(t,-1)||da(t,-1);if(n==46&&!e.shiftKey||In&&n==68&&r=="c")return N1(t,1)||da(t,1);if(n==13||n==27)return!0;if(n==37||In&&n==66&&r=="c"){let i=n==37?I1(t,t.state.selection.from)=="ltr"?-1:1:-1;return M1(t,i,r)||da(t,i)}else if(n==39||In&&n==70&&r=="c"){let i=n==39?I1(t,t.state.selection.from)=="ltr"?1:-1:1;return M1(t,i,r)||da(t,i)}else{if(n==38||In&&n==80&&r=="c")return A1(t,-1,r)||da(t,-1);if(n==40||In&&n==78&&r=="c")return KB(t)||A1(t,1,r)||da(t,1);if(r==(In?"m":"c")&&(n==66||n==73||n==89||n==90))return!0}return!1}function dx(t,e){t.someProp("transformCopied",p=>{e=p(e,t)});let n=[],{content:r,openStart:i,openEnd:o}=e;for(;i>1&&o>1&&r.childCount==1&&r.firstChild.childCount==1;){i--,o--;let p=r.firstChild;n.push(p.type.name,p.attrs!=p.type.defaultAttrs?p.attrs:null),r=p.content}let s=t.someProp("clipboardSerializer")||Zs.fromSchema(t.state.schema),a=YR(),l=a.createElement("div");l.appendChild(s.serializeFragment(r,{document:a}));let c=l.firstChild,u,d=0;for(;c&&c.nodeType==1&&(u=JR[c.nodeName.toLowerCase()]);){for(let p=u.length-1;p>=0;p--){let g=a.createElement(u[p]);for(;l.firstChild;)g.appendChild(l.firstChild);l.appendChild(g),d++}c=l.firstChild}c&&c.nodeType==1&&c.setAttribute("data-pm-slice",`${i} ${o}${d?` -${d}`:""} ${JSON.stringify(n)}`);let h=t.someProp("clipboardTextSerializer",p=>p(e,t))||e.content.textBetween(0,e.content.size,`

`);return{dom:l,text:h,slice:e}}function WR(t,e,n,r,i){let o=i.parent.type.spec.code,s,a;if(!n&&!e)return null;let l=e&&(r||o||!n);if(l){if(t.someProp("transformPastedText",h=>{e=h(e,o||r,t)}),o)return e?new q(F.from(t.state.schema.text(e.replace(/\r\n?/g,`
`))),0,0):q.empty;let d=t.someProp("clipboardTextParser",h=>h(e,i,r,t));if(d)a=d;else{let h=i.marks(),{schema:p}=t.state,g=Zs.fromSchema(p);s=document.createElement("div"),e.split(/(?:\r\n?|\n)+/).forEach(y=>{let x=s.appendChild(document.createElement("p"));y&&x.appendChild(g.serializeNode(p.text(y,h)))})}}else t.someProp("transformPastedHTML",d=>{n=d(n,t)}),s=XB(n),Gu&&ZB(s);let c=s&&s.querySelector("[data-pm-slice]"),u=c&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(c.getAttribute("data-pm-slice")||"");if(u&&u[3])for(let d=+u[3];d>0;d--){let h=s.firstChild;for(;h&&h.nodeType!=1;)h=h.nextSibling;if(!h)break;s=h}if(a||(a=(t.someProp("clipboardParser")||t.someProp("domParser")||wo.fromSchema(t.state.schema)).parseSlice(s,{preserveWhitespace:!!(l||u),context:i,ruleFromNode(h){return h.nodeName=="BR"&&!h.nextSibling&&h.parentNode&&!JB.test(h.parentNode.nodeName)?{ignore:!0}:null}})),u)a=e6(D1(a,+u[1],+u[2]),u[4]);else if(a=q.maxOpen(YB(a.content,i),!0),a.openStart||a.openEnd){let d=0,h=0;for(let p=a.content.firstChild;d<a.openStart&&!p.type.spec.isolating;d++,p=p.firstChild);for(let p=a.content.lastChild;h<a.openEnd&&!p.type.spec.isolating;h++,p=p.lastChild);a=D1(a,d,h)}return t.someProp("transformPasted",d=>{a=d(a,t)}),a}const JB=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function YB(t,e){if(t.childCount<2)return t;for(let n=e.depth;n>=0;n--){let i=e.node(n).contentMatchAt(e.index(n)),o,s=[];if(t.forEach(a=>{if(!s)return;let l=i.findWrapping(a.type),c;if(!l)return s=null;if(c=s.length&&o.length&&qR(l,o,a,s[s.length-1],0))s[s.length-1]=c;else{s.length&&(s[s.length-1]=GR(s[s.length-1],o.length));let u=KR(a,l);s.push(u),i=i.matchType(u.type),o=l}}),s)return F.from(s)}return t}function KR(t,e,n=0){for(let r=e.length-1;r>=n;r--)t=e[r].create(null,F.from(t));return t}function qR(t,e,n,r,i){if(i<t.length&&i<e.length&&t[i]==e[i]){let o=qR(t,e,n,r.lastChild,i+1);if(o)return r.copy(r.content.replaceChild(r.childCount-1,o));if(r.contentMatchAt(r.childCount).matchType(i==t.length-1?n.type:t[i+1]))return r.copy(r.content.append(F.from(KR(n,t,i+1))))}}function GR(t,e){if(e==0)return t;let n=t.content.replaceChild(t.childCount-1,GR(t.lastChild,e-1)),r=t.contentMatchAt(t.childCount).fillBefore(F.empty,!0);return t.copy(n.append(r))}function Wy(t,e,n,r,i,o){let s=e<0?t.firstChild:t.lastChild,a=s.content;return t.childCount>1&&(o=0),i<r-1&&(a=Wy(a,e,n,r,i+1,o)),i>=n&&(a=e<0?s.contentMatchAt(0).fillBefore(a,o<=i).append(a):a.append(s.contentMatchAt(s.childCount).fillBefore(F.empty,!0))),t.replaceChild(e<0?0:t.childCount-1,s.copy(a))}function D1(t,e,n){return e<t.openStart&&(t=new q(Wy(t.content,-1,e,t.openStart,0,t.openEnd),e,t.openEnd)),n<t.openEnd&&(t=new q(Wy(t.content,1,n,t.openEnd,0,0),t.openStart,n)),t}const JR={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let L1=null;function YR(){return L1||(L1=document.implementation.createHTMLDocument("title"))}let jm=null;function QB(t){let e=window.trustedTypes;return e?(jm||(jm=e.createPolicy("ProseMirrorClipboard",{createHTML:n=>n})),jm.createHTML(t)):t}function XB(t){let e=/^(\s*<meta [^>]*>)*/.exec(t);e&&(t=t.slice(e[0].length));let n=YR().createElement("div"),r=/<([a-z][^>\s]+)/i.exec(t),i;if((i=r&&JR[r[1].toLowerCase()])&&(t=i.map(o=>"<"+o+">").join("")+t+i.map(o=>"</"+o+">").reverse().join("")),n.innerHTML=QB(t),i)for(let o=0;o<i.length;o++)n=n.querySelector(i[o])||n;return n}function ZB(t){let e=t.querySelectorAll(Ot?"span:not([class]):not([style])":"span.Apple-converted-space");for(let n=0;n<e.length;n++){let r=e[n];r.childNodes.length==1&&r.textContent==""&&r.parentNode&&r.parentNode.replaceChild(t.ownerDocument.createTextNode(" "),r)}}function e6(t,e){if(!t.size)return t;let n=t.content.firstChild.type.schema,r;try{r=JSON.parse(e)}catch{return t}let{content:i,openStart:o,openEnd:s}=t;for(let a=r.length-2;a>=0;a-=2){let l=n.nodes[r[a]];if(!l||l.hasRequiredAttrs())break;i=F.from(l.create(r[a+1],i)),o++,s++}return new q(i,o,s)}const Kt={},qt={},t6={touchstart:!0,touchmove:!0};class n6{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:""},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastChromeDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function r6(t){for(let e in Kt){let n=Kt[e];t.dom.addEventListener(e,t.input.eventHandlers[e]=r=>{o6(t,r)&&!fx(t,r)&&(t.editable||!(r.type in qt))&&n(t,r)},t6[e]?{passive:!0}:void 0)}Wt&&t.dom.addEventListener("input",()=>null),Ky(t)}function lo(t,e){t.input.lastSelectionOrigin=e,t.input.lastSelectionTime=Date.now()}function i6(t){t.domObserver.stop();for(let e in t.input.eventHandlers)t.dom.removeEventListener(e,t.input.eventHandlers[e]);clearTimeout(t.input.composingTimeout),clearTimeout(t.input.lastIOSEnterFallbackTimeout)}function Ky(t){t.someProp("handleDOMEvents",e=>{for(let n in e)t.input.eventHandlers[n]||t.dom.addEventListener(n,t.input.eventHandlers[n]=r=>fx(t,r))})}function fx(t,e){return t.someProp("handleDOMEvents",n=>{let r=n[e.type];return r?r(t,e)||e.defaultPrevented:!1})}function o6(t,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let n=e.target;n!=t.dom;n=n.parentNode)if(!n||n.nodeType==11||n.pmViewDesc&&n.pmViewDesc.stopEvent(e))return!1;return!0}function s6(t,e){!fx(t,e)&&Kt[e.type]&&(t.editable||!(e.type in qt))&&Kt[e.type](t,e)}qt.keydown=(t,e)=>{let n=e;if(t.input.shiftKey=n.keyCode==16||n.shiftKey,!XR(t,n)&&(t.input.lastKeyCode=n.keyCode,t.input.lastKeyCodeTime=Date.now(),!(ii&&Ot&&n.keyCode==13)))if(n.keyCode!=229&&t.domObserver.forceFlush(),kl&&n.keyCode==13&&!n.ctrlKey&&!n.altKey&&!n.metaKey){let r=Date.now();t.input.lastIOSEnter=r,t.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{t.input.lastIOSEnter==r&&(t.someProp("handleKeyDown",i=>i(t,Xo(13,"Enter"))),t.input.lastIOSEnter=0)},200)}else t.someProp("handleKeyDown",r=>r(t,n))||GB(t,n)?n.preventDefault():lo(t,"key")};qt.keyup=(t,e)=>{e.keyCode==16&&(t.input.shiftKey=!1)};qt.keypress=(t,e)=>{let n=e;if(XR(t,n)||!n.charCode||n.ctrlKey&&!n.altKey||In&&n.metaKey)return;if(t.someProp("handleKeyPress",i=>i(t,n))){n.preventDefault();return}let r=t.state.selection;if(!(r instanceof ie)||!r.$from.sameParent(r.$to)){let i=String.fromCharCode(n.charCode);!/[\r\n]/.test(i)&&!t.someProp("handleTextInput",o=>o(t,r.$from.pos,r.$to.pos,i))&&t.dispatch(t.state.tr.insertText(i).scrollIntoView()),n.preventDefault()}};function hp(t){return{left:t.clientX,top:t.clientY}}function a6(t,e){let n=e.x-t.clientX,r=e.y-t.clientY;return n*n+r*r<100}function hx(t,e,n,r,i){if(r==-1)return!1;let o=t.state.doc.resolve(r);for(let s=o.depth+1;s>0;s--)if(t.someProp(e,a=>s>o.depth?a(t,n,o.nodeAfter,o.before(s),i,!0):a(t,n,o.node(s),o.before(s),i,!1)))return!0;return!1}function Ka(t,e,n){if(t.focused||t.focus(),t.state.selection.eq(e))return;let r=t.state.tr.setSelection(e);n=="pointer"&&r.setMeta("pointer",!0),t.dispatch(r)}function l6(t,e){if(e==-1)return!1;let n=t.state.doc.resolve(e),r=n.nodeAfter;return r&&r.isAtom&&te.isSelectable(r)?(Ka(t,new te(n),"pointer"),!0):!1}function c6(t,e){if(e==-1)return!1;let n=t.state.selection,r,i;n instanceof te&&(r=n.node);let o=t.state.doc.resolve(e);for(let s=o.depth+1;s>0;s--){let a=s>o.depth?o.nodeAfter:o.node(s);if(te.isSelectable(a)){r&&n.$from.depth>0&&s>=n.$from.depth&&o.before(n.$from.depth+1)==n.$from.pos?i=o.before(n.$from.depth):i=o.before(s);break}}return i!=null?(Ka(t,te.create(t.state.doc,i),"pointer"),!0):!1}function u6(t,e,n,r,i){return hx(t,"handleClickOn",e,n,r)||t.someProp("handleClick",o=>o(t,e,r))||(i?c6(t,n):l6(t,n))}function d6(t,e,n,r){return hx(t,"handleDoubleClickOn",e,n,r)||t.someProp("handleDoubleClick",i=>i(t,e,r))}function f6(t,e,n,r){return hx(t,"handleTripleClickOn",e,n,r)||t.someProp("handleTripleClick",i=>i(t,e,r))||h6(t,n,r)}function h6(t,e,n){if(n.button!=0)return!1;let r=t.state.doc;if(e==-1)return r.inlineContent?(Ka(t,ie.create(r,0,r.content.size),"pointer"),!0):!1;let i=r.resolve(e);for(let o=i.depth+1;o>0;o--){let s=o>i.depth?i.nodeAfter:i.node(o),a=i.before(o);if(s.inlineContent)Ka(t,ie.create(r,a+1,a+1+s.content.size),"pointer");else if(te.isSelectable(s))Ka(t,te.create(r,a),"pointer");else continue;return!0}}function px(t){return fh(t)}const QR=In?"metaKey":"ctrlKey";Kt.mousedown=(t,e)=>{let n=e;t.input.shiftKey=n.shiftKey;let r=px(t),i=Date.now(),o="singleClick";i-t.input.lastClick.time<500&&a6(n,t.input.lastClick)&&!n[QR]&&(t.input.lastClick.type=="singleClick"?o="doubleClick":t.input.lastClick.type=="doubleClick"&&(o="tripleClick")),t.input.lastClick={time:i,x:n.clientX,y:n.clientY,type:o};let s=t.posAtCoords(hp(n));s&&(o=="singleClick"?(t.input.mouseDown&&t.input.mouseDown.done(),t.input.mouseDown=new p6(t,s,n,!!r)):(o=="doubleClick"?d6:f6)(t,s.pos,s.inside,n)?n.preventDefault():lo(t,"pointer"))};class p6{constructor(e,n,r,i){this.view=e,this.pos=n,this.event=r,this.flushed=i,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!r[QR],this.allowDefault=r.shiftKey;let o,s;if(n.inside>-1)o=e.state.doc.nodeAt(n.inside),s=n.inside;else{let u=e.state.doc.resolve(n.pos);o=u.parent,s=u.depth?u.before():0}const a=i?null:r.target,l=a?e.docView.nearestDesc(a,!0):null;this.target=l&&l.dom.nodeType==1?l.dom:null;let{selection:c}=e.state;(r.button==0&&o.type.spec.draggable&&o.type.spec.selectable!==!1||c instanceof te&&c.from<=s&&c.to>s)&&(this.mightDrag={node:o,pos:s,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&hr&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),lo(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>li(this.view)),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let n=this.pos;this.view.state.doc!=this.startDoc&&(n=this.view.posAtCoords(hp(e))),this.updateAllowDefault(e),this.allowDefault||!n?lo(this.view,"pointer"):u6(this.view,n.pos,n.inside,e,this.selectNode)?e.preventDefault():e.button==0&&(this.flushed||Wt&&this.mightDrag&&!this.mightDrag.node.isAtom||Ot&&!this.view.state.selection.visible&&Math.min(Math.abs(n.pos-this.view.state.selection.from),Math.abs(n.pos-this.view.state.selection.to))<=2)?(Ka(this.view,oe.near(this.view.state.doc.resolve(n.pos)),"pointer"),e.preventDefault()):lo(this.view,"pointer")}move(e){this.updateAllowDefault(e),lo(this.view,"pointer"),e.buttons==0&&this.done()}updateAllowDefault(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}}Kt.touchstart=t=>{t.input.lastTouch=Date.now(),px(t),lo(t,"pointer")};Kt.touchmove=t=>{t.input.lastTouch=Date.now(),lo(t,"pointer")};Kt.contextmenu=t=>px(t);function XR(t,e){return t.composing?!0:Wt&&Math.abs(e.timeStamp-t.input.compositionEndedAt)<500?(t.input.compositionEndedAt=-2e8,!0):!1}const m6=ii?5e3:-1;qt.compositionstart=qt.compositionupdate=t=>{if(!t.composing){t.domObserver.flush();let{state:e}=t,n=e.selection.$to;if(e.selection instanceof ie&&(e.storedMarks||!n.textOffset&&n.parentOffset&&n.nodeBefore.marks.some(r=>r.type.spec.inclusive===!1)))t.markCursor=t.state.storedMarks||n.marks(),fh(t,!0),t.markCursor=null;else if(fh(t,!e.selection.empty),hr&&e.selection.empty&&n.parentOffset&&!n.textOffset&&n.nodeBefore.marks.length){let r=t.domSelectionRange();for(let i=r.focusNode,o=r.focusOffset;i&&i.nodeType==1&&o!=0;){let s=o<0?i.lastChild:i.childNodes[o-1];if(!s)break;if(s.nodeType==3){let a=t.domSelection();a&&a.collapse(s,s.nodeValue.length);break}else i=s,o=-1}}t.input.composing=!0}ZR(t,m6)};qt.compositionend=(t,e)=>{t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=e.timeStamp,t.input.compositionPendingChanges=t.domObserver.pendingRecords().length?t.input.compositionID:0,t.input.compositionNode=null,t.input.compositionPendingChanges&&Promise.resolve().then(()=>t.domObserver.flush()),t.input.compositionID++,ZR(t,20))};function ZR(t,e){clearTimeout(t.input.composingTimeout),e>-1&&(t.input.composingTimeout=setTimeout(()=>fh(t),e))}function eO(t){for(t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=y6());t.input.compositionNodes.length>0;)t.input.compositionNodes.pop().markParentsDirty()}function g6(t){let e=t.domSelectionRange();if(!e.focusNode)return null;let n=lB(e.focusNode,e.focusOffset),r=cB(e.focusNode,e.focusOffset);if(n&&r&&n!=r){let i=r.pmViewDesc,o=t.domObserver.lastChangedTextNode;if(n==o||r==o)return o;if(!i||!i.isText(r.nodeValue))return r;if(t.input.compositionNode==r){let s=n.pmViewDesc;if(!(!s||!s.isText(n.nodeValue)))return r}}return n||r}function y6(){let t=document.createEvent("Event");return t.initEvent("event",!0,!0),t.timeStamp}function fh(t,e=!1){if(!(ii&&t.domObserver.flushingSoon>=0)){if(t.domObserver.forceFlush(),eO(t),e||t.docView&&t.docView.dirty){let n=cx(t);return n&&!n.eq(t.state.selection)?t.dispatch(t.state.tr.setSelection(n)):(t.markCursor||e)&&!t.state.selection.empty?t.dispatch(t.state.tr.deleteSelection()):t.updateState(t.state),!0}return!1}}function v6(t,e){if(!t.dom.parentNode)return;let n=t.dom.parentNode.appendChild(document.createElement("div"));n.appendChild(e),n.style.cssText="position: fixed; left: -10000px; top: 10px";let r=getSelection(),i=document.createRange();i.selectNodeContents(e),t.dom.blur(),r.removeAllRanges(),r.addRange(i),setTimeout(()=>{n.parentNode&&n.parentNode.removeChild(n),t.focus()},50)}const mu=dn&&bo<15||kl&&pB<604;Kt.copy=qt.cut=(t,e)=>{let n=e,r=t.state.selection,i=n.type=="cut";if(r.empty)return;let o=mu?null:n.clipboardData,s=r.content(),{dom:a,text:l}=dx(t,s);o?(n.preventDefault(),o.clearData(),o.setData("text/html",a.innerHTML),o.setData("text/plain",l)):v6(t,a),i&&t.dispatch(t.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function x6(t){return t.openStart==0&&t.openEnd==0&&t.content.childCount==1?t.content.firstChild:null}function w6(t,e){if(!t.dom.parentNode)return;let n=t.input.shiftKey||t.state.selection.$from.parent.type.spec.code,r=t.dom.parentNode.appendChild(document.createElement(n?"textarea":"div"));n||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus();let i=t.input.shiftKey&&t.input.lastKeyCode!=45;setTimeout(()=>{t.focus(),r.parentNode&&r.parentNode.removeChild(r),n?gu(t,r.value,null,i,e):gu(t,r.textContent,r.innerHTML,i,e)},50)}function gu(t,e,n,r,i){let o=WR(t,e,n,r,t.state.selection.$from);if(t.someProp("handlePaste",l=>l(t,i,o||q.empty)))return!0;if(!o)return!1;let s=x6(o),a=s?t.state.tr.replaceSelectionWith(s,r):t.state.tr.replaceSelection(o);return t.dispatch(a.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function tO(t){let e=t.getData("text/plain")||t.getData("Text");if(e)return e;let n=t.getData("text/uri-list");return n?n.replace(/\r?\n/g," "):""}qt.paste=(t,e)=>{let n=e;if(t.composing&&!ii)return;let r=mu?null:n.clipboardData,i=t.input.shiftKey&&t.input.lastKeyCode!=45;r&&gu(t,tO(r),r.getData("text/html"),i,n)?n.preventDefault():w6(t,n)};class nO{constructor(e,n,r){this.slice=e,this.move=n,this.node=r}}const rO=In?"altKey":"ctrlKey";Kt.dragstart=(t,e)=>{let n=e,r=t.input.mouseDown;if(r&&r.done(),!n.dataTransfer)return;let i=t.state.selection,o=i.empty?null:t.posAtCoords(hp(n)),s;if(!(o&&o.pos>=i.from&&o.pos<=(i instanceof te?i.to-1:i.to))){if(r&&r.mightDrag)s=te.create(t.state.doc,r.mightDrag.pos);else if(n.target&&n.target.nodeType==1){let d=t.docView.nearestDesc(n.target,!0);d&&d.node.type.spec.draggable&&d!=t.docView&&(s=te.create(t.state.doc,d.posBefore))}}let a=(s||t.state.selection).content(),{dom:l,text:c,slice:u}=dx(t,a);(!n.dataTransfer.files.length||!Ot||OR>120)&&n.dataTransfer.clearData(),n.dataTransfer.setData(mu?"Text":"text/html",l.innerHTML),n.dataTransfer.effectAllowed="copyMove",mu||n.dataTransfer.setData("text/plain",c),t.dragging=new nO(u,!n[rO],s)};Kt.dragend=t=>{let e=t.dragging;window.setTimeout(()=>{t.dragging==e&&(t.dragging=null)},50)};qt.dragover=qt.dragenter=(t,e)=>e.preventDefault();qt.drop=(t,e)=>{let n=e,r=t.dragging;if(t.dragging=null,!n.dataTransfer)return;let i=t.posAtCoords(hp(n));if(!i)return;let o=t.state.doc.resolve(i.pos),s=r&&r.slice;s?t.someProp("transformPasted",g=>{s=g(s,t)}):s=WR(t,tO(n.dataTransfer),mu?null:n.dataTransfer.getData("text/html"),!1,o);let a=!!(r&&!n[rO]);if(t.someProp("handleDrop",g=>g(t,n,s||q.empty,a))){n.preventDefault();return}if(!s)return;n.preventDefault();let l=s?bR(t.state.doc,o.pos,s):o.pos;l==null&&(l=o.pos);let c=t.state.tr;if(a){let{node:g}=r;g?g.replace(c):c.deleteSelection()}let u=c.mapping.map(l),d=s.openStart==0&&s.openEnd==0&&s.content.childCount==1,h=c.doc;if(d?c.replaceRangeWith(u,u,s.content.firstChild):c.replaceRange(u,u,s),c.doc.eq(h))return;let p=c.doc.resolve(u);if(d&&te.isSelectable(s.content.firstChild)&&p.nodeAfter&&p.nodeAfter.sameMarkup(s.content.firstChild))c.setSelection(new te(p));else{let g=c.mapping.map(l);c.mapping.maps[c.mapping.maps.length-1].forEach((y,x,v,w)=>g=w),c.setSelection(ux(t,p,c.doc.resolve(g)))}t.focus(),t.dispatch(c.setMeta("uiEvent","drop"))};Kt.focus=t=>{t.input.lastFocus=Date.now(),t.focused||(t.domObserver.stop(),t.dom.classList.add("ProseMirror-focused"),t.domObserver.start(),t.focused=!0,setTimeout(()=>{t.docView&&t.hasFocus()&&!t.domObserver.currentSelection.eq(t.domSelectionRange())&&li(t)},20))};Kt.blur=(t,e)=>{let n=e;t.focused&&(t.domObserver.stop(),t.dom.classList.remove("ProseMirror-focused"),t.domObserver.start(),n.relatedTarget&&t.dom.contains(n.relatedTarget)&&t.domObserver.currentSelection.clear(),t.focused=!1)};Kt.beforeinput=(t,e)=>{if(Ot&&ii&&e.inputType=="deleteContentBackward"){t.domObserver.flushSoon();let{domChangeCount:r}=t.input;setTimeout(()=>{if(t.input.domChangeCount!=r||(t.dom.blur(),t.focus(),t.someProp("handleKeyDown",o=>o(t,Xo(8,"Backspace")))))return;let{$cursor:i}=t.state.selection;i&&i.pos>0&&t.dispatch(t.state.tr.delete(i.pos-1,i.pos).scrollIntoView())},50)}};for(let t in qt)Kt[t]=qt[t];function yu(t,e){if(t==e)return!0;for(let n in t)if(t[n]!==e[n])return!1;for(let n in e)if(!(n in t))return!1;return!0}class hh{constructor(e,n){this.toDOM=e,this.spec=n||ws,this.side=this.spec.side||0}map(e,n,r,i){let{pos:o,deleted:s}=e.mapResult(n.from+i,this.side<0?-1:1);return s?null:new an(o-r,o-r,this)}valid(){return!0}eq(e){return this==e||e instanceof hh&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&yu(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}}class Co{constructor(e,n){this.attrs=e,this.spec=n||ws}map(e,n,r,i){let o=e.map(n.from+i,this.spec.inclusiveStart?-1:1)-r,s=e.map(n.to+i,this.spec.inclusiveEnd?1:-1)-r;return o>=s?null:new an(o,s,this)}valid(e,n){return n.from<n.to}eq(e){return this==e||e instanceof Co&&yu(this.attrs,e.attrs)&&yu(this.spec,e.spec)}static is(e){return e.type instanceof Co}destroy(){}}class mx{constructor(e,n){this.attrs=e,this.spec=n||ws}map(e,n,r,i){let o=e.mapResult(n.from+i,1);if(o.deleted)return null;let s=e.mapResult(n.to+i,-1);return s.deleted||s.pos<=o.pos?null:new an(o.pos-r,s.pos-r,this)}valid(e,n){let{index:r,offset:i}=e.content.findIndex(n.from),o;return i==n.from&&!(o=e.child(r)).isText&&i+o.nodeSize==n.to}eq(e){return this==e||e instanceof mx&&yu(this.attrs,e.attrs)&&yu(this.spec,e.spec)}destroy(){}}class an{constructor(e,n,r){this.from=e,this.to=n,this.type=r}copy(e,n){return new an(e,n,this.type)}eq(e,n=0){return this.type.eq(e.type)&&this.from+n==e.from&&this.to+n==e.to}map(e,n,r){return this.type.map(e,this,n,r)}static widget(e,n,r){return new an(e,e,new hh(n,r))}static inline(e,n,r,i){return new an(e,n,new Co(r,i))}static node(e,n,r,i){return new an(e,n,new mx(r,i))}get spec(){return this.type.spec}get inline(){return this.type instanceof Co}get widget(){return this.type instanceof hh}}const ya=[],ws={};class Je{constructor(e,n){this.local=e.length?e:ya,this.children=n.length?n:ya}static create(e,n){return n.length?ph(n,e,0,ws):_t}find(e,n,r){let i=[];return this.findInner(e??0,n??1e9,i,0,r),i}findInner(e,n,r,i,o){for(let s=0;s<this.local.length;s++){let a=this.local[s];a.from<=n&&a.to>=e&&(!o||o(a.spec))&&r.push(a.copy(a.from+i,a.to+i))}for(let s=0;s<this.children.length;s+=3)if(this.children[s]<n&&this.children[s+1]>e){let a=this.children[s]+1;this.children[s+2].findInner(e-a,n-a,r,i+a,o)}}map(e,n,r){return this==_t||e.maps.length==0?this:this.mapInner(e,n,0,0,r||ws)}mapInner(e,n,r,i,o){let s;for(let a=0;a<this.local.length;a++){let l=this.local[a].map(e,r,i);l&&l.type.valid(n,l)?(s||(s=[])).push(l):o.onRemove&&o.onRemove(this.local[a].spec)}return this.children.length?b6(this.children,s||[],e,n,r,i,o):s?new Je(s.sort(bs),ya):_t}add(e,n){return n.length?this==_t?Je.create(e,n):this.addInner(e,n,0):this}addInner(e,n,r){let i,o=0;e.forEach((a,l)=>{let c=l+r,u;if(u=oO(n,a,c)){for(i||(i=this.children.slice());o<i.length&&i[o]<l;)o+=3;i[o]==l?i[o+2]=i[o+2].addInner(a,u,c+1):i.splice(o,0,l,l+a.nodeSize,ph(u,a,c+1,ws)),o+=3}});let s=iO(o?sO(n):n,-r);for(let a=0;a<s.length;a++)s[a].type.valid(e,s[a])||s.splice(a--,1);return new Je(s.length?this.local.concat(s).sort(bs):this.local,i||this.children)}remove(e){return e.length==0||this==_t?this:this.removeInner(e,0)}removeInner(e,n){let r=this.children,i=this.local;for(let o=0;o<r.length;o+=3){let s,a=r[o]+n,l=r[o+1]+n;for(let u=0,d;u<e.length;u++)(d=e[u])&&d.from>a&&d.to<l&&(e[u]=null,(s||(s=[])).push(d));if(!s)continue;r==this.children&&(r=this.children.slice());let c=r[o+2].removeInner(s,a+1);c!=_t?r[o+2]=c:(r.splice(o,3),o-=3)}if(i.length){for(let o=0,s;o<e.length;o++)if(s=e[o])for(let a=0;a<i.length;a++)i[a].eq(s,n)&&(i==this.local&&(i=this.local.slice()),i.splice(a--,1))}return r==this.children&&i==this.local?this:i.length||r.length?new Je(i,r):_t}forChild(e,n){if(this==_t)return this;if(n.isLeaf)return Je.empty;let r,i;for(let a=0;a<this.children.length;a+=3)if(this.children[a]>=e){this.children[a]==e&&(r=this.children[a+2]);break}let o=e+1,s=o+n.content.size;for(let a=0;a<this.local.length;a++){let l=this.local[a];if(l.from<s&&l.to>o&&l.type instanceof Co){let c=Math.max(o,l.from)-o,u=Math.min(s,l.to)-o;c<u&&(i||(i=[])).push(l.copy(c,u))}}if(i){let a=new Je(i.sort(bs),ya);return r?new Gi([a,r]):a}return r||_t}eq(e){if(this==e)return!0;if(!(e instanceof Je)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let n=0;n<this.local.length;n++)if(!this.local[n].eq(e.local[n]))return!1;for(let n=0;n<this.children.length;n+=3)if(this.children[n]!=e.children[n]||this.children[n+1]!=e.children[n+1]||!this.children[n+2].eq(e.children[n+2]))return!1;return!0}locals(e){return gx(this.localsInner(e))}localsInner(e){if(this==_t)return ya;if(e.inlineContent||!this.local.some(Co.is))return this.local;let n=[];for(let r=0;r<this.local.length;r++)this.local[r].type instanceof Co||n.push(this.local[r]);return n}forEachSet(e){e(this)}}Je.empty=new Je([],[]);Je.removeOverlap=gx;const _t=Je.empty;class Gi{constructor(e){this.members=e}map(e,n){const r=this.members.map(i=>i.map(e,n,ws));return Gi.from(r)}forChild(e,n){if(n.isLeaf)return Je.empty;let r=[];for(let i=0;i<this.members.length;i++){let o=this.members[i].forChild(e,n);o!=_t&&(o instanceof Gi?r=r.concat(o.members):r.push(o))}return Gi.from(r)}eq(e){if(!(e instanceof Gi)||e.members.length!=this.members.length)return!1;for(let n=0;n<this.members.length;n++)if(!this.members[n].eq(e.members[n]))return!1;return!0}locals(e){let n,r=!0;for(let i=0;i<this.members.length;i++){let o=this.members[i].localsInner(e);if(o.length)if(!n)n=o;else{r&&(n=n.slice(),r=!1);for(let s=0;s<o.length;s++)n.push(o[s])}}return n?gx(r?n:n.sort(bs)):ya}static from(e){switch(e.length){case 0:return _t;case 1:return e[0];default:return new Gi(e.every(n=>n instanceof Je)?e:e.reduce((n,r)=>n.concat(r instanceof Je?r:r.members),[]))}}forEachSet(e){for(let n=0;n<this.members.length;n++)this.members[n].forEachSet(e)}}function b6(t,e,n,r,i,o,s){let a=t.slice();for(let c=0,u=o;c<n.maps.length;c++){let d=0;n.maps[c].forEach((h,p,g,y)=>{let x=y-g-(p-h);for(let v=0;v<a.length;v+=3){let w=a[v+1];if(w<0||h>w+u-d)continue;let b=a[v]+u-d;p>=b?a[v+1]=h<=b?-2:-1:h>=u&&x&&(a[v]+=x,a[v+1]+=x)}d+=x}),u=n.maps[c].map(u,-1)}let l=!1;for(let c=0;c<a.length;c+=3)if(a[c+1]<0){if(a[c+1]==-2){l=!0,a[c+1]=-1;continue}let u=n.map(t[c]+o),d=u-i;if(d<0||d>=r.content.size){l=!0;continue}let h=n.map(t[c+1]+o,-1),p=h-i,{index:g,offset:y}=r.content.findIndex(d),x=r.maybeChild(g);if(x&&y==d&&y+x.nodeSize==p){let v=a[c+2].mapInner(n,x,u+1,t[c]+o+1,s);v!=_t?(a[c]=d,a[c+1]=p,a[c+2]=v):(a[c+1]=-2,l=!0)}else l=!0}if(l){let c=S6(a,t,e,n,i,o,s),u=ph(c,r,0,s);e=u.local;for(let d=0;d<a.length;d+=3)a[d+1]<0&&(a.splice(d,3),d-=3);for(let d=0,h=0;d<u.children.length;d+=3){let p=u.children[d];for(;h<a.length&&a[h]<p;)h+=3;a.splice(h,0,u.children[d],u.children[d+1],u.children[d+2])}}return new Je(e.sort(bs),a)}function iO(t,e){if(!e||!t.length)return t;let n=[];for(let r=0;r<t.length;r++){let i=t[r];n.push(new an(i.from+e,i.to+e,i.type))}return n}function S6(t,e,n,r,i,o,s){function a(l,c){for(let u=0;u<l.local.length;u++){let d=l.local[u].map(r,i,c);d?n.push(d):s.onRemove&&s.onRemove(l.local[u].spec)}for(let u=0;u<l.children.length;u+=3)a(l.children[u+2],l.children[u]+c+1)}for(let l=0;l<t.length;l+=3)t[l+1]==-1&&a(t[l+2],e[l]+o+1);return n}function oO(t,e,n){if(e.isLeaf)return null;let r=n+e.nodeSize,i=null;for(let o=0,s;o<t.length;o++)(s=t[o])&&s.from>n&&s.to<r&&((i||(i=[])).push(s),t[o]=null);return i}function sO(t){let e=[];for(let n=0;n<t.length;n++)t[n]!=null&&e.push(t[n]);return e}function ph(t,e,n,r){let i=[],o=!1;e.forEach((a,l)=>{let c=oO(t,a,l+n);if(c){o=!0;let u=ph(c,a,n+l+1,r);u!=_t&&i.push(l,l+a.nodeSize,u)}});let s=iO(o?sO(t):t,-n).sort(bs);for(let a=0;a<s.length;a++)s[a].type.valid(e,s[a])||(r.onRemove&&r.onRemove(s[a].spec),s.splice(a--,1));return s.length||i.length?new Je(s,i):_t}function bs(t,e){return t.from-e.from||t.to-e.to}function gx(t){let e=t;for(let n=0;n<e.length-1;n++){let r=e[n];if(r.from!=r.to)for(let i=n+1;i<e.length;i++){let o=e[i];if(o.from==r.from){o.to!=r.to&&(e==t&&(e=t.slice()),e[i]=o.copy(o.from,r.to),$1(e,i+1,o.copy(r.to,o.to)));continue}else{o.from<r.to&&(e==t&&(e=t.slice()),e[n]=r.copy(r.from,o.from),$1(e,i,r.copy(o.from,r.to)));break}}}return e}function $1(t,e,n){for(;e<t.length&&bs(n,t[e])>0;)e++;t.splice(e,0,n)}function Dm(t){let e=[];return t.someProp("decorations",n=>{let r=n(t.state);r&&r!=_t&&e.push(r)}),t.cursorWrapper&&e.push(Je.create(t.state.doc,[t.cursorWrapper.deco])),Gi.from(e)}const C6={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},k6=dn&&bo<=11;class E6{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}}class T6{constructor(e,n){this.view=e,this.handleDOMChange=n,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new E6,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver(r=>{for(let i=0;i<r.length;i++)this.queue.push(r[i]);dn&&bo<=11&&r.some(i=>i.type=="childList"&&i.removedNodes.length||i.type=="characterData"&&i.oldValue.length>i.target.nodeValue.length)?this.flushSoon():this.flush()}),k6&&(this.onCharData=r=>{this.queue.push({target:r.target,type:"characterData",oldValue:r.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,C6)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let e=this.observer.takeRecords();if(e.length){for(let n=0;n<e.length;n++)this.queue.push(e[n]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(P1(this.view)){if(this.suppressingSelectionUpdates)return li(this.view);if(dn&&bo<=11&&!this.view.state.selection.empty){let e=this.view.domSelectionRange();if(e.focusNode&&Vs(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(e){if(!e.focusNode)return!0;let n=new Set,r;for(let o=e.focusNode;o;o=Cl(o))n.add(o);for(let o=e.anchorNode;o;o=Cl(o))if(n.has(o)){r=o;break}let i=r&&this.view.docView.nearestDesc(r);if(i&&i.ignoreMutation({type:"selection",target:r.nodeType==3?r.parentNode:r}))return this.setCurSelection(),!0}pendingRecords(){if(this.observer)for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}flush(){let{view:e}=this;if(!e.docView||this.flushingSoon>-1)return;let n=this.pendingRecords();n.length&&(this.queue=[]);let r=e.domSelectionRange(),i=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(r)&&P1(e)&&!this.ignoreSelectionChange(r),o=-1,s=-1,a=!1,l=[];if(e.editable)for(let u=0;u<n.length;u++){let d=this.registerMutation(n[u],l);d&&(o=o<0?d.from:Math.min(d.from,o),s=s<0?d.to:Math.max(d.to,s),d.typeOver&&(a=!0))}if(hr&&l.length){let u=l.filter(d=>d.nodeName=="BR");if(u.length==2){let[d,h]=u;d.parentNode&&d.parentNode.parentNode==h.parentNode?h.remove():d.remove()}else{let{focusNode:d}=this.currentSelection;for(let h of u){let p=h.parentNode;p&&p.nodeName=="LI"&&(!d||O6(e,d)!=p)&&h.remove()}}}let c=null;o<0&&i&&e.input.lastFocus>Date.now()-200&&Math.max(e.input.lastTouch,e.input.lastClick.time)<Date.now()-300&&dp(r)&&(c=cx(e))&&c.eq(oe.near(e.state.doc.resolve(0),1))?(e.input.lastFocus=0,li(e),this.currentSelection.set(r),e.scrollToSelection()):(o>-1||i)&&(o>-1&&(e.docView.markDirty(o,s),_6(e)),this.handleDOMChange(o,s,a,l),e.docView&&e.docView.dirty?e.updateState(e.state):this.currentSelection.eq(r)||li(e),this.currentSelection.set(r))}registerMutation(e,n){if(n.indexOf(e.target)>-1)return null;let r=this.view.docView.nearestDesc(e.target);if(e.type=="attributes"&&(r==this.view.docView||e.attributeName=="contenteditable"||e.attributeName=="style"&&!e.oldValue&&!e.target.getAttribute("style"))||!r||r.ignoreMutation(e))return null;if(e.type=="childList"){for(let u=0;u<e.addedNodes.length;u++){let d=e.addedNodes[u];n.push(d),d.nodeType==3&&(this.lastChangedTextNode=d)}if(r.contentDOM&&r.contentDOM!=r.dom&&!r.contentDOM.contains(e.target))return{from:r.posBefore,to:r.posAfter};let i=e.previousSibling,o=e.nextSibling;if(dn&&bo<=11&&e.addedNodes.length)for(let u=0;u<e.addedNodes.length;u++){let{previousSibling:d,nextSibling:h}=e.addedNodes[u];(!d||Array.prototype.indexOf.call(e.addedNodes,d)<0)&&(i=d),(!h||Array.prototype.indexOf.call(e.addedNodes,h)<0)&&(o=h)}let s=i&&i.parentNode==e.target?yt(i)+1:0,a=r.localPosFromDOM(e.target,s,-1),l=o&&o.parentNode==e.target?yt(o):e.target.childNodes.length,c=r.localPosFromDOM(e.target,l,1);return{from:a,to:c}}else return e.type=="attributes"?{from:r.posAtStart-r.border,to:r.posAtEnd+r.border}:(this.lastChangedTextNode=e.target,{from:r.posAtStart,to:r.posAtEnd,typeOver:e.target.nodeValue==e.oldValue})}}let F1=new WeakMap,B1=!1;function _6(t){if(!F1.has(t)&&(F1.set(t,null),["normal","nowrap","pre-line"].indexOf(getComputedStyle(t.dom).whiteSpace)!==-1)){if(t.requiresGeckoHackNode=hr,B1)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),B1=!0}}function z1(t,e){let n=e.startContainer,r=e.startOffset,i=e.endContainer,o=e.endOffset,s=t.domAtPos(t.state.selection.anchor);return Vs(s.node,s.offset,i,o)&&([n,r,i,o]=[i,o,n,r]),{anchorNode:n,anchorOffset:r,focusNode:i,focusOffset:o}}function R6(t,e){if(e.getComposedRanges){let i=e.getComposedRanges(t.root)[0];if(i)return z1(t,i)}let n;function r(i){i.preventDefault(),i.stopImmediatePropagation(),n=i.getTargetRanges()[0]}return t.dom.addEventListener("beforeinput",r,!0),document.execCommand("indent"),t.dom.removeEventListener("beforeinput",r,!0),n?z1(t,n):null}function O6(t,e){for(let n=e.parentNode;n&&n!=t.dom;n=n.parentNode){let r=t.docView.nearestDesc(n,!0);if(r&&r.node.isBlock)return n}return null}function P6(t,e,n){let{node:r,fromOffset:i,toOffset:o,from:s,to:a}=t.docView.parseRange(e,n),l=t.domSelectionRange(),c,u=l.anchorNode;if(u&&t.dom.contains(u.nodeType==1?u:u.parentNode)&&(c=[{node:u,offset:l.anchorOffset}],dp(l)||c.push({node:l.focusNode,offset:l.focusOffset})),Ot&&t.input.lastKeyCode===8)for(let x=o;x>i;x--){let v=r.childNodes[x-1],w=v.pmViewDesc;if(v.nodeName=="BR"&&!w){o=x;break}if(!w||w.size)break}let d=t.state.doc,h=t.someProp("domParser")||wo.fromSchema(t.state.schema),p=d.resolve(s),g=null,y=h.parse(r,{topNode:p.parent,topMatch:p.parent.contentMatchAt(p.index()),topOpen:!0,from:i,to:o,preserveWhitespace:p.parent.type.whitespace=="pre"?"full":!0,findPositions:c,ruleFromNode:M6,context:p});if(c&&c[0].pos!=null){let x=c[0].pos,v=c[1]&&c[1].pos;v==null&&(v=x),g={anchor:x+s,head:v+s}}return{doc:y,sel:g,from:s,to:a}}function M6(t){let e=t.pmViewDesc;if(e)return e.parseRule();if(t.nodeName=="BR"&&t.parentNode){if(Wt&&/^(ul|ol)$/i.test(t.parentNode.nodeName)){let n=document.createElement("div");return n.appendChild(document.createElement("li")),{skip:n}}else if(t.parentNode.lastChild==t||Wt&&/^(tr|table)$/i.test(t.parentNode.nodeName))return{ignore:!0}}else if(t.nodeName=="IMG"&&t.getAttribute("mark-placeholder"))return{ignore:!0};return null}const I6=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function A6(t,e,n,r,i){let o=t.input.compositionPendingChanges||(t.composing?t.input.compositionID:0);if(t.input.compositionPendingChanges=0,e<0){let R=t.input.lastSelectionTime>Date.now()-50?t.input.lastSelectionOrigin:null,_=cx(t,R);if(_&&!t.state.selection.eq(_)){if(Ot&&ii&&t.input.lastKeyCode===13&&Date.now()-100<t.input.lastKeyCodeTime&&t.someProp("handleKeyDown",L=>L(t,Xo(13,"Enter"))))return;let A=t.state.tr.setSelection(_);R=="pointer"?A.setMeta("pointer",!0):R=="key"&&A.scrollIntoView(),o&&A.setMeta("composition",o),t.dispatch(A)}return}let s=t.state.doc.resolve(e),a=s.sharedDepth(n);e=s.before(a+1),n=t.state.doc.resolve(n).after(a+1);let l=t.state.selection,c=P6(t,e,n),u=t.state.doc,d=u.slice(c.from,c.to),h,p;t.input.lastKeyCode===8&&Date.now()-100<t.input.lastKeyCodeTime?(h=t.state.selection.to,p="end"):(h=t.state.selection.from,p="start"),t.input.lastKeyCode=null;let g=D6(d.content,c.doc.content,c.from,h,p);if(g&&t.input.domChangeCount++,(kl&&t.input.lastIOSEnter>Date.now()-225||ii)&&i.some(R=>R.nodeType==1&&!I6.test(R.nodeName))&&(!g||g.endA>=g.endB)&&t.someProp("handleKeyDown",R=>R(t,Xo(13,"Enter")))){t.input.lastIOSEnter=0;return}if(!g)if(r&&l instanceof ie&&!l.empty&&l.$head.sameParent(l.$anchor)&&!t.composing&&!(c.sel&&c.sel.anchor!=c.sel.head))g={start:l.from,endA:l.to,endB:l.to};else{if(c.sel){let R=V1(t,t.state.doc,c.sel);if(R&&!R.eq(t.state.selection)){let _=t.state.tr.setSelection(R);o&&_.setMeta("composition",o),t.dispatch(_)}}return}t.state.selection.from<t.state.selection.to&&g.start==g.endB&&t.state.selection instanceof ie&&(g.start>t.state.selection.from&&g.start<=t.state.selection.from+2&&t.state.selection.from>=c.from?g.start=t.state.selection.from:g.endA<t.state.selection.to&&g.endA>=t.state.selection.to-2&&t.state.selection.to<=c.to&&(g.endB+=t.state.selection.to-g.endA,g.endA=t.state.selection.to)),dn&&bo<=11&&g.endB==g.start+1&&g.endA==g.start&&g.start>c.from&&c.doc.textBetween(g.start-c.from-1,g.start-c.from+1)==" "&&(g.start--,g.endA--,g.endB--);let y=c.doc.resolveNoCache(g.start-c.from),x=c.doc.resolveNoCache(g.endB-c.from),v=u.resolve(g.start),w=y.sameParent(x)&&y.parent.inlineContent&&v.end()>=g.endA,b;if((kl&&t.input.lastIOSEnter>Date.now()-225&&(!w||i.some(R=>R.nodeName=="DIV"||R.nodeName=="P"))||!w&&y.pos<c.doc.content.size&&!y.sameParent(x)&&(b=oe.findFrom(c.doc.resolve(y.pos+1),1,!0))&&b.head==x.pos)&&t.someProp("handleKeyDown",R=>R(t,Xo(13,"Enter")))){t.input.lastIOSEnter=0;return}if(t.state.selection.anchor>g.start&&j6(u,g.start,g.endA,y,x)&&t.someProp("handleKeyDown",R=>R(t,Xo(8,"Backspace")))){ii&&Ot&&t.domObserver.suppressSelectionUpdates();return}Ot&&g.endB==g.start&&(t.input.lastChromeDelete=Date.now()),ii&&!w&&y.start()!=x.start()&&x.parentOffset==0&&y.depth==x.depth&&c.sel&&c.sel.anchor==c.sel.head&&c.sel.head==g.endA&&(g.endB-=2,x=c.doc.resolveNoCache(g.endB-c.from),setTimeout(()=>{t.someProp("handleKeyDown",function(R){return R(t,Xo(13,"Enter"))})},20));let S=g.start,C=g.endA,k,E,T;if(w){if(y.pos==x.pos)dn&&bo<=11&&y.parentOffset==0&&(t.domObserver.suppressSelectionUpdates(),setTimeout(()=>li(t),20)),k=t.state.tr.delete(S,C),E=u.resolve(g.start).marksAcross(u.resolve(g.endA));else if(g.endA==g.endB&&(T=N6(y.parent.content.cut(y.parentOffset,x.parentOffset),v.parent.content.cut(v.parentOffset,g.endA-v.start()))))k=t.state.tr,T.type=="add"?k.addMark(S,C,T.mark):k.removeMark(S,C,T.mark);else if(y.parent.child(y.index()).isText&&y.index()==x.index()-(x.textOffset?0:1)){let R=y.parent.textBetween(y.parentOffset,x.parentOffset);if(t.someProp("handleTextInput",_=>_(t,S,C,R)))return;k=t.state.tr.insertText(R,S,C)}}if(k||(k=t.state.tr.replace(S,C,c.doc.slice(g.start-c.from,g.endB-c.from))),c.sel){let R=V1(t,k.doc,c.sel);R&&!(Ot&&t.composing&&R.empty&&(g.start!=g.endB||t.input.lastChromeDelete<Date.now()-100)&&(R.head==S||R.head==k.mapping.map(C)-1)||dn&&R.empty&&R.head==S)&&k.setSelection(R)}E&&k.ensureMarks(E),o&&k.setMeta("composition",o),t.dispatch(k.scrollIntoView())}function V1(t,e,n){return Math.max(n.anchor,n.head)>e.content.size?null:ux(t,e.resolve(n.anchor),e.resolve(n.head))}function N6(t,e){let n=t.firstChild.marks,r=e.firstChild.marks,i=n,o=r,s,a,l;for(let u=0;u<r.length;u++)i=r[u].removeFromSet(i);for(let u=0;u<n.length;u++)o=n[u].removeFromSet(o);if(i.length==1&&o.length==0)a=i[0],s="add",l=u=>u.mark(a.addToSet(u.marks));else if(i.length==0&&o.length==1)a=o[0],s="remove",l=u=>u.mark(a.removeFromSet(u.marks));else return null;let c=[];for(let u=0;u<e.childCount;u++)c.push(l(e.child(u)));if(F.from(c).eq(t))return{mark:a,type:s}}function j6(t,e,n,r,i){if(n-e<=i.pos-r.pos||Lm(r,!0,!1)<i.pos)return!1;let o=t.resolve(e);if(!r.parent.isTextblock){let a=o.nodeAfter;return a!=null&&n==e+a.nodeSize}if(o.parentOffset<o.parent.content.size||!o.parent.isTextblock)return!1;let s=t.resolve(Lm(o,!0,!0));return!s.parent.isTextblock||s.pos>n||Lm(s,!0,!1)<n?!1:r.parent.content.cut(r.parentOffset).eq(s.parent.content)}function Lm(t,e,n){let r=t.depth,i=e?t.end():t.pos;for(;r>0&&(e||t.indexAfter(r)==t.node(r).childCount);)r--,i++,e=!1;if(n){let o=t.node(r).maybeChild(t.indexAfter(r));for(;o&&!o.isLeaf;)o=o.firstChild,i++}return i}function D6(t,e,n,r,i){let o=t.findDiffStart(e,n);if(o==null)return null;let{a:s,b:a}=t.findDiffEnd(e,n+t.size,n+e.size);if(i=="end"){let l=Math.max(0,o-Math.min(s,a));r-=s+l-o}if(s<o&&t.size<e.size){let l=r<=o&&r>=s?o-r:0;o-=l,o&&o<e.size&&U1(e.textBetween(o-1,o+1))&&(o+=l?1:-1),a=o+(a-s),s=o}else if(a<o){let l=r<=o&&r>=a?o-r:0;o-=l,o&&o<t.size&&U1(t.textBetween(o-1,o+1))&&(o+=l?1:-1),s=o+(s-a),a=o}return{start:o,endA:s,endB:a}}function U1(t){if(t.length!=2)return!1;let e=t.charCodeAt(0),n=t.charCodeAt(1);return e>=56320&&e<=57343&&n>=55296&&n<=56319}class L6{constructor(e,n){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new n6,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=n,this.state=n.state,this.directPlugins=n.plugins||[],this.directPlugins.forEach(G1),this.dispatch=this.dispatch.bind(this),this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):typeof e=="function"?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=K1(this),W1(this),this.nodeViews=q1(this),this.docView=k1(this.state.doc,H1(this),Dm(this),this.dom,this),this.domObserver=new T6(this,(r,i,o,s)=>A6(this,r,i,o,s)),this.domObserver.start(),r6(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let e=this._props;this._props={};for(let n in e)this._props[n]=e[n];this._props.state=this.state}return this._props}update(e){e.handleDOMEvents!=this._props.handleDOMEvents&&Ky(this);let n=this._props;this._props=e,e.plugins&&(e.plugins.forEach(G1),this.directPlugins=e.plugins),this.updateStateInner(e.state,n)}setProps(e){let n={};for(let r in this._props)n[r]=this._props[r];n.state=this.state;for(let r in e)n[r]=e[r];this.update(n)}updateState(e){this.updateStateInner(e,this._props)}updateStateInner(e,n){var r;let i=this.state,o=!1,s=!1;e.storedMarks&&this.composing&&(eO(this),s=!0),this.state=e;let a=i.plugins!=e.plugins||this._props.plugins!=n.plugins;if(a||this._props.plugins!=n.plugins||this._props.nodeViews!=n.nodeViews){let p=q1(this);F6(p,this.nodeViews)&&(this.nodeViews=p,o=!0)}(a||n.handleDOMEvents!=this._props.handleDOMEvents)&&Ky(this),this.editable=K1(this),W1(this);let l=Dm(this),c=H1(this),u=i.plugins!=e.plugins&&!i.doc.eq(e.doc)?"reset":e.scrollToSelection>i.scrollToSelection?"to selection":"preserve",d=o||!this.docView.matchesNode(e.doc,c,l);(d||!e.selection.eq(i.selection))&&(s=!0);let h=u=="preserve"&&s&&this.dom.style.overflowAnchor==null&&yB(this);if(s){this.domObserver.stop();let p=d&&(dn||Ot)&&!this.composing&&!i.selection.empty&&!e.selection.empty&&$6(i.selection,e.selection);if(d){let g=Ot?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=g6(this)),(o||!this.docView.update(e.doc,c,l,this))&&(this.docView.updateOuterDeco(c),this.docView.destroy(),this.docView=k1(e.doc,c,l,this.dom,this)),g&&!this.trackWrites&&(p=!0)}p||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&zB(this))?li(this,p):(VR(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(i),!((r=this.dragging)===null||r===void 0)&&r.node&&!i.doc.eq(e.doc)&&this.updateDraggedNode(this.dragging,i),u=="reset"?this.dom.scrollTop=0:u=="to selection"?this.scrollToSelection():h&&vB(h)}scrollToSelection(){let e=this.domSelectionRange().focusNode;if(!(!e||!this.dom.contains(e.nodeType==1?e:e.parentNode))){if(!this.someProp("handleScrollToSelection",n=>n(this)))if(this.state.selection instanceof te){let n=this.docView.domAfterPos(this.state.selection.from);n.nodeType==1&&v1(this,n.getBoundingClientRect(),e)}else v1(this,this.coordsAtPos(this.state.selection.head,1),e)}}destroyPluginViews(){let e;for(;e=this.pluginViews.pop();)e.destroy&&e.destroy()}updatePluginViews(e){if(!e||e.plugins!=this.state.plugins||this.directPlugins!=this.prevDirectPlugins){this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let n=0;n<this.directPlugins.length;n++){let r=this.directPlugins[n];r.spec.view&&this.pluginViews.push(r.spec.view(this))}for(let n=0;n<this.state.plugins.length;n++){let r=this.state.plugins[n];r.spec.view&&this.pluginViews.push(r.spec.view(this))}}else for(let n=0;n<this.pluginViews.length;n++){let r=this.pluginViews[n];r.update&&r.update(this,e)}}updateDraggedNode(e,n){let r=e.node,i=-1;if(this.state.doc.nodeAt(r.from)==r.node)i=r.from;else{let o=r.from+(this.state.doc.content.size-n.doc.content.size);(o>0&&this.state.doc.nodeAt(o))==r.node&&(i=o)}this.dragging=new nO(e.slice,e.move,i<0?void 0:te.create(this.state.doc,i))}someProp(e,n){let r=this._props&&this._props[e],i;if(r!=null&&(i=n?n(r):r))return i;for(let s=0;s<this.directPlugins.length;s++){let a=this.directPlugins[s].props[e];if(a!=null&&(i=n?n(a):a))return i}let o=this.state.plugins;if(o)for(let s=0;s<o.length;s++){let a=o[s].props[e];if(a!=null&&(i=n?n(a):a))return i}}hasFocus(){if(dn){let e=this.root.activeElement;if(e==this.dom)return!0;if(!e||!this.dom.contains(e))return!1;for(;e&&this.dom!=e&&this.dom.contains(e);){if(e.contentEditable=="false")return!1;e=e.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&xB(this.dom),li(this),this.domObserver.start()}get root(){let e=this._root;if(e==null){for(let n=this.dom.parentNode;n;n=n.parentNode)if(n.nodeType==9||n.nodeType==11&&n.host)return n.getSelection||(Object.getPrototypeOf(n).getSelection=()=>n.ownerDocument.getSelection()),this._root=n}return e||document}updateRoot(){this._root=null}posAtCoords(e){return kB(this,e)}coordsAtPos(e,n=1){return NR(this,e,n)}domAtPos(e,n=0){return this.docView.domFromPos(e,n)}nodeDOM(e){let n=this.docView.descAt(e);return n?n.nodeDOM:null}posAtDOM(e,n,r=-1){let i=this.docView.posFromDOM(e,n,r);if(i==null)throw new RangeError("DOM position not inside the editor");return i}endOfTextblock(e,n){return OB(this,n||this.state,e)}pasteHTML(e,n){return gu(this,"",e,!1,n||new ClipboardEvent("paste"))}pasteText(e,n){return gu(this,e,null,!0,n||new ClipboardEvent("paste"))}serializeForClipboard(e){return dx(this,e)}destroy(){this.docView&&(i6(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],Dm(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,sB())}get isDestroyed(){return this.docView==null}dispatchEvent(e){return s6(this,e)}dispatch(e){let n=this._props.dispatchTransaction;n?n.call(this,e):this.updateState(this.state.apply(e))}domSelectionRange(){let e=this.domSelection();return e?Wt&&this.root.nodeType===11&&dB(this.dom.ownerDocument)==this.dom&&R6(this,e)||e:{focusNode:null,focusOffset:0,anchorNode:null,anchorOffset:0}}domSelection(){return this.root.getSelection()}}function H1(t){let e=Object.create(null);return e.class="ProseMirror",e.contenteditable=String(t.editable),t.someProp("attributes",n=>{if(typeof n=="function"&&(n=n(t.state)),n)for(let r in n)r=="class"?e.class+=" "+n[r]:r=="style"?e.style=(e.style?e.style+";":"")+n[r]:!e[r]&&r!="contenteditable"&&r!="nodeName"&&(e[r]=String(n[r]))}),e.translate||(e.translate="no"),[an.node(0,t.state.doc.content.size,e)]}function W1(t){if(t.markCursor){let e=document.createElement("img");e.className="ProseMirror-separator",e.setAttribute("mark-placeholder","true"),e.setAttribute("alt",""),t.cursorWrapper={dom:e,deco:an.widget(t.state.selection.from,e,{raw:!0,marks:t.markCursor})}}else t.cursorWrapper=null}function K1(t){return!t.someProp("editable",e=>e(t.state)===!1)}function $6(t,e){let n=Math.min(t.$anchor.sharedDepth(t.head),e.$anchor.sharedDepth(e.head));return t.$anchor.start(n)!=e.$anchor.start(n)}function q1(t){let e=Object.create(null);function n(r){for(let i in r)Object.prototype.hasOwnProperty.call(e,i)||(e[i]=r[i])}return t.someProp("nodeViews",n),t.someProp("markViews",n),e}function F6(t,e){let n=0,r=0;for(let i in t){if(t[i]!=e[i])return!0;n++}for(let i in e)r++;return n!=r}function G1(t){if(t.spec.state||t.spec.filterTransaction||t.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}var Mo={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},mh={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},B6=typeof navigator<"u"&&/Mac/.test(navigator.platform),z6=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var vt=0;vt<10;vt++)Mo[48+vt]=Mo[96+vt]=String(vt);for(var vt=1;vt<=24;vt++)Mo[vt+111]="F"+vt;for(var vt=65;vt<=90;vt++)Mo[vt]=String.fromCharCode(vt+32),mh[vt]=String.fromCharCode(vt);for(var $m in Mo)mh.hasOwnProperty($m)||(mh[$m]=Mo[$m]);function V6(t){var e=B6&&t.metaKey&&t.shiftKey&&!t.ctrlKey&&!t.altKey||z6&&t.shiftKey&&t.key&&t.key.length==1||t.key=="Unidentified",n=!e&&t.key||(t.shiftKey?mh:Mo)[t.keyCode]||t.key||"Unidentified";return n=="Esc"&&(n="Escape"),n=="Del"&&(n="Delete"),n=="Left"&&(n="ArrowLeft"),n=="Up"&&(n="ArrowUp"),n=="Right"&&(n="ArrowRight"),n=="Down"&&(n="ArrowDown"),n}const U6=typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):!1;function H6(t){let e=t.split(/-(?!$)/),n=e[e.length-1];n=="Space"&&(n=" ");let r,i,o,s;for(let a=0;a<e.length-1;a++){let l=e[a];if(/^(cmd|meta|m)$/i.test(l))s=!0;else if(/^a(lt)?$/i.test(l))r=!0;else if(/^(c|ctrl|control)$/i.test(l))i=!0;else if(/^s(hift)?$/i.test(l))o=!0;else if(/^mod$/i.test(l))U6?s=!0:i=!0;else throw new Error("Unrecognized modifier name: "+l)}return r&&(n="Alt-"+n),i&&(n="Ctrl-"+n),s&&(n="Meta-"+n),o&&(n="Shift-"+n),n}function W6(t){let e=Object.create(null);for(let n in t)e[H6(n)]=t[n];return e}function Fm(t,e,n=!0){return e.altKey&&(t="Alt-"+t),e.ctrlKey&&(t="Ctrl-"+t),e.metaKey&&(t="Meta-"+t),n&&e.shiftKey&&(t="Shift-"+t),t}function K6(t){return new bt({props:{handleKeyDown:aO(t)}})}function aO(t){let e=W6(t);return function(n,r){let i=V6(r),o,s=e[Fm(i,r)];if(s&&s(n.state,n.dispatch,n))return!0;if(i.length==1&&i!=" "){if(r.shiftKey){let a=e[Fm(i,r,!1)];if(a&&a(n.state,n.dispatch,n))return!0}if((r.shiftKey||r.altKey||r.metaKey||i.charCodeAt(0)>127)&&(o=Mo[r.keyCode])&&o!=i){let a=e[Fm(o,r)];if(a&&a(n.state,n.dispatch,n))return!0}}return!1}}const q6=(t,e)=>t.selection.empty?!1:(e&&e(t.tr.deleteSelection().scrollIntoView()),!0);function lO(t,e){let{$cursor:n}=t.selection;return!n||(e?!e.endOfTextblock("backward",t):n.parentOffset>0)?null:n}const G6=(t,e,n)=>{let r=lO(t,n);if(!r)return!1;let i=yx(r);if(!i){let s=r.blockRange(),a=s&&ql(s);return a==null?!1:(e&&e(t.tr.lift(s,a).scrollIntoView()),!0)}let o=i.nodeBefore;if(fO(t,i,e,-1))return!0;if(r.parent.content.size==0&&(El(o,"end")||te.isSelectable(o)))for(let s=r.depth;;s--){let a=cp(t.doc,r.before(s),r.after(s),q.empty);if(a&&a.slice.size<a.to-a.from){if(e){let l=t.tr.step(a);l.setSelection(El(o,"end")?oe.findFrom(l.doc.resolve(l.mapping.map(i.pos,-1)),-1):te.create(l.doc,i.pos-o.nodeSize)),e(l.scrollIntoView())}return!0}if(s==1||r.node(s-1).childCount>1)break}return o.isAtom&&i.depth==r.depth-1?(e&&e(t.tr.delete(i.pos-o.nodeSize,i.pos).scrollIntoView()),!0):!1},J6=(t,e,n)=>{let r=lO(t,n);if(!r)return!1;let i=yx(r);return i?cO(t,i,e):!1},Y6=(t,e,n)=>{let r=uO(t,n);if(!r)return!1;let i=vx(r);return i?cO(t,i,e):!1};function cO(t,e,n){let r=e.nodeBefore,i=r,o=e.pos-1;for(;!i.isTextblock;o--){if(i.type.spec.isolating)return!1;let u=i.lastChild;if(!u)return!1;i=u}let s=e.nodeAfter,a=s,l=e.pos+1;for(;!a.isTextblock;l++){if(a.type.spec.isolating)return!1;let u=a.firstChild;if(!u)return!1;a=u}let c=cp(t.doc,o,l,q.empty);if(!c||c.from!=o||c instanceof at&&c.slice.size>=l-o)return!1;if(n){let u=t.tr.step(c);u.setSelection(ie.create(u.doc,o)),n(u.scrollIntoView())}return!0}function El(t,e,n=!1){for(let r=t;r;r=e=="start"?r.firstChild:r.lastChild){if(r.isTextblock)return!0;if(n&&r.childCount!=1)return!1}return!1}const Q6=(t,e,n)=>{let{$head:r,empty:i}=t.selection,o=r;if(!i)return!1;if(r.parent.isTextblock){if(n?!n.endOfTextblock("backward",t):r.parentOffset>0)return!1;o=yx(r)}let s=o&&o.nodeBefore;return!s||!te.isSelectable(s)?!1:(e&&e(t.tr.setSelection(te.create(t.doc,o.pos-s.nodeSize)).scrollIntoView()),!0)};function yx(t){if(!t.parent.type.spec.isolating)for(let e=t.depth-1;e>=0;e--){if(t.index(e)>0)return t.doc.resolve(t.before(e+1));if(t.node(e).type.spec.isolating)break}return null}function uO(t,e){let{$cursor:n}=t.selection;return!n||(e?!e.endOfTextblock("forward",t):n.parentOffset<n.parent.content.size)?null:n}const X6=(t,e,n)=>{let r=uO(t,n);if(!r)return!1;let i=vx(r);if(!i)return!1;let o=i.nodeAfter;if(fO(t,i,e,1))return!0;if(r.parent.content.size==0&&(El(o,"start")||te.isSelectable(o))){let s=cp(t.doc,r.before(),r.after(),q.empty);if(s&&s.slice.size<s.to-s.from){if(e){let a=t.tr.step(s);a.setSelection(El(o,"start")?oe.findFrom(a.doc.resolve(a.mapping.map(i.pos)),1):te.create(a.doc,a.mapping.map(i.pos))),e(a.scrollIntoView())}return!0}}return o.isAtom&&i.depth==r.depth-1?(e&&e(t.tr.delete(i.pos,i.pos+o.nodeSize).scrollIntoView()),!0):!1},Z6=(t,e,n)=>{let{$head:r,empty:i}=t.selection,o=r;if(!i)return!1;if(r.parent.isTextblock){if(n?!n.endOfTextblock("forward",t):r.parentOffset<r.parent.content.size)return!1;o=vx(r)}let s=o&&o.nodeAfter;return!s||!te.isSelectable(s)?!1:(e&&e(t.tr.setSelection(te.create(t.doc,o.pos)).scrollIntoView()),!0)};function vx(t){if(!t.parent.type.spec.isolating)for(let e=t.depth-1;e>=0;e--){let n=t.node(e);if(t.index(e)+1<n.childCount)return t.doc.resolve(t.after(e+1));if(n.type.spec.isolating)break}return null}const ez=(t,e)=>{let n=t.selection,r=n instanceof te,i;if(r){if(n.node.isTextblock||!Do(t.doc,n.from))return!1;i=n.from}else if(i=lp(t.doc,n.from,-1),i==null)return!1;if(e){let o=t.tr.join(i);r&&o.setSelection(te.create(o.doc,i-t.doc.resolve(i).nodeBefore.nodeSize)),e(o.scrollIntoView())}return!0},tz=(t,e)=>{let n=t.selection,r;if(n instanceof te){if(n.node.isTextblock||!Do(t.doc,n.to))return!1;r=n.to}else if(r=lp(t.doc,n.to,1),r==null)return!1;return e&&e(t.tr.join(r).scrollIntoView()),!0},nz=(t,e)=>{let{$from:n,$to:r}=t.selection,i=n.blockRange(r),o=i&&ql(i);return o==null?!1:(e&&e(t.tr.lift(i,o).scrollIntoView()),!0)},rz=(t,e)=>{let{$head:n,$anchor:r}=t.selection;return!n.parent.type.spec.code||!n.sameParent(r)?!1:(e&&e(t.tr.insertText(`
`).scrollIntoView()),!0)};function dO(t){for(let e=0;e<t.edgeCount;e++){let{type:n}=t.edge(e);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}const iz=(t,e)=>{let{$head:n,$anchor:r}=t.selection;if(!n.parent.type.spec.code||!n.sameParent(r))return!1;let i=n.node(-1),o=n.indexAfter(-1),s=dO(i.contentMatchAt(o));if(!s||!i.canReplaceWith(o,o,s))return!1;if(e){let a=n.after(),l=t.tr.replaceWith(a,a,s.createAndFill());l.setSelection(oe.near(l.doc.resolve(a),1)),e(l.scrollIntoView())}return!0},oz=(t,e)=>{let n=t.selection,{$from:r,$to:i}=n;if(n instanceof Fn||r.parent.inlineContent||i.parent.inlineContent)return!1;let o=dO(i.parent.contentMatchAt(i.indexAfter()));if(!o||!o.isTextblock)return!1;if(e){let s=(!r.parentOffset&&i.index()<i.parent.childCount?r:i).pos,a=t.tr.insert(s,o.createAndFill());a.setSelection(ie.create(a.doc,s+1)),e(a.scrollIntoView())}return!0},sz=(t,e)=>{let{$cursor:n}=t.selection;if(!n||n.parent.content.size)return!1;if(n.depth>1&&n.after()!=n.end(-1)){let o=n.before();if(Ha(t.doc,o))return e&&e(t.tr.split(o).scrollIntoView()),!0}let r=n.blockRange(),i=r&&ql(r);return i==null?!1:(e&&e(t.tr.lift(r,i).scrollIntoView()),!0)},az=(t,e)=>{let{$from:n,to:r}=t.selection,i,o=n.sharedDepth(r);return o==0?!1:(i=n.before(o),e&&e(t.tr.setSelection(te.create(t.doc,i))),!0)};function lz(t,e,n){let r=e.nodeBefore,i=e.nodeAfter,o=e.index();return!r||!i||!r.type.compatibleContent(i.type)?!1:!r.content.size&&e.parent.canReplace(o-1,o)?(n&&n(t.tr.delete(e.pos-r.nodeSize,e.pos).scrollIntoView()),!0):!e.parent.canReplace(o,o+1)||!(i.isTextblock||Do(t.doc,e.pos))?!1:(n&&n(t.tr.join(e.pos).scrollIntoView()),!0)}function fO(t,e,n,r){let i=e.nodeBefore,o=e.nodeAfter,s,a,l=i.type.spec.isolating||o.type.spec.isolating;if(!l&&lz(t,e,n))return!0;let c=!l&&e.parent.canReplace(e.index(),e.index()+1);if(c&&(s=(a=i.contentMatchAt(i.childCount)).findWrapping(o.type))&&a.matchType(s[0]||o.type).validEnd){if(n){let p=e.pos+o.nodeSize,g=F.empty;for(let v=s.length-1;v>=0;v--)g=F.from(s[v].create(null,g));g=F.from(i.copy(g));let y=t.tr.step(new ct(e.pos-1,p,e.pos,p,new q(g,1,0),s.length,!0)),x=y.doc.resolve(p+2*s.length);x.nodeAfter&&x.nodeAfter.type==i.type&&Do(y.doc,x.pos)&&y.join(x.pos),n(y.scrollIntoView())}return!0}let u=o.type.spec.isolating||r>0&&l?null:oe.findFrom(e,1),d=u&&u.$from.blockRange(u.$to),h=d&&ql(d);if(h!=null&&h>=e.depth)return n&&n(t.tr.lift(d,h).scrollIntoView()),!0;if(c&&El(o,"start",!0)&&El(i,"end")){let p=i,g=[];for(;g.push(p),!p.isTextblock;)p=p.lastChild;let y=o,x=1;for(;!y.isTextblock;y=y.firstChild)x++;if(p.canReplace(p.childCount,p.childCount,y.content)){if(n){let v=F.empty;for(let b=g.length-1;b>=0;b--)v=F.from(g[b].copy(v));let w=t.tr.step(new ct(e.pos-g.length,e.pos+o.nodeSize,e.pos+x,e.pos+o.nodeSize-x,new q(v,g.length,0),0,!0));n(w.scrollIntoView())}return!0}}return!1}function hO(t){return function(e,n){let r=e.selection,i=t<0?r.$from:r.$to,o=i.depth;for(;i.node(o).isInline;){if(!o)return!1;o--}return i.node(o).isTextblock?(n&&n(e.tr.setSelection(ie.create(e.doc,t<0?i.start(o):i.end(o)))),!0):!1}}const cz=hO(-1),uz=hO(1);function dz(t,e=null){return function(n,r){let{$from:i,$to:o}=n.selection,s=i.blockRange(o),a=s&&sx(s,t,e);return a?(r&&r(n.tr.wrap(s,a).scrollIntoView()),!0):!1}}function J1(t,e=null){return function(n,r){let i=!1;for(let o=0;o<n.selection.ranges.length&&!i;o++){let{$from:{pos:s},$to:{pos:a}}=n.selection.ranges[o];n.doc.nodesBetween(s,a,(l,c)=>{if(i)return!1;if(!(!l.isTextblock||l.hasMarkup(t,e)))if(l.type==t)i=!0;else{let u=n.doc.resolve(c),d=u.index();i=u.parent.canReplaceWith(d,d+1,t)}})}if(!i)return!1;if(r){let o=n.tr;for(let s=0;s<n.selection.ranges.length;s++){let{$from:{pos:a},$to:{pos:l}}=n.selection.ranges[s];o.setBlockType(a,l,t,e)}r(o.scrollIntoView())}return!0}}typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform&&os.platform()=="darwin";function fz(t,e=null){return function(n,r){let{$from:i,$to:o}=n.selection,s=i.blockRange(o);if(!s)return!1;let a=r?n.tr:null;return hz(a,s,t,e)?(r&&r(a.scrollIntoView()),!0):!1}}function hz(t,e,n,r=null){let i=!1,o=e,s=e.$from.doc;if(e.depth>=2&&e.$from.node(e.depth-1).type.compatibleContent(n)&&e.startIndex==0){if(e.$from.index(e.depth-1)==0)return!1;let l=s.resolve(e.start-2);o=new lh(l,l,e.depth),e.endIndex<e.parent.childCount&&(e=new lh(e.$from,s.resolve(e.$to.end(e.depth)),e.depth)),i=!0}let a=sx(o,n,r,e);return a?(t&&pz(t,e,a,i,n),!0):!1}function pz(t,e,n,r,i){let o=F.empty;for(let u=n.length-1;u>=0;u--)o=F.from(n[u].type.create(n[u].attrs,o));t.step(new ct(e.start-(r?2:0),e.end,e.start,e.end,new q(o,0,0),n.length,!0));let s=0;for(let u=0;u<n.length;u++)n[u].type==i&&(s=u+1);let a=n.length-s,l=e.start+n.length-(r?2:0),c=e.parent;for(let u=e.startIndex,d=e.endIndex,h=!0;u<d;u++,h=!1)!h&&Ha(t.doc,l,a)&&(t.split(l,a),l+=2*a),l+=c.child(u).nodeSize;return t}function mz(t){return function(e,n){let{$from:r,$to:i}=e.selection,o=r.blockRange(i,s=>s.childCount>0&&s.firstChild.type==t);return o?n?r.node(o.depth-1).type==t?gz(e,n,t,o):yz(e,n,o):!0:!1}}function gz(t,e,n,r){let i=t.tr,o=r.end,s=r.$to.end(r.depth);o<s&&(i.step(new ct(o-1,s,o,s,new q(F.from(n.create(null,r.parent.copy())),1,0),1,!0)),r=new lh(i.doc.resolve(r.$from.pos),i.doc.resolve(s),r.depth));const a=ql(r);if(a==null)return!1;i.lift(r,a);let l=i.doc.resolve(i.mapping.map(o,-1)-1);return Do(i.doc,l.pos)&&l.nodeBefore.type==l.nodeAfter.type&&i.join(l.pos),e(i.scrollIntoView()),!0}function yz(t,e,n){let r=t.tr,i=n.parent;for(let p=n.end,g=n.endIndex-1,y=n.startIndex;g>y;g--)p-=i.child(g).nodeSize,r.delete(p-1,p+1);let o=r.doc.resolve(n.start),s=o.nodeAfter;if(r.mapping.map(n.end)!=n.start+o.nodeAfter.nodeSize)return!1;let a=n.startIndex==0,l=n.endIndex==i.childCount,c=o.node(-1),u=o.index(-1);if(!c.canReplace(u+(a?0:1),u+1,s.content.append(l?F.empty:F.from(i))))return!1;let d=o.pos,h=d+s.nodeSize;return r.step(new ct(d-(a?1:0),h+(l?1:0),d+1,h-1,new q((a?F.empty:F.from(i.copy(F.empty))).append(l?F.empty:F.from(i.copy(F.empty))),a?0:1,l?0:1),a?0:1)),e(r.scrollIntoView()),!0}function vz(t){return function(e,n){let{$from:r,$to:i}=e.selection,o=r.blockRange(i,c=>c.childCount>0&&c.firstChild.type==t);if(!o)return!1;let s=o.startIndex;if(s==0)return!1;let a=o.parent,l=a.child(s-1);if(l.type!=t)return!1;if(n){let c=l.lastChild&&l.lastChild.type==a.type,u=F.from(c?t.create():null),d=new q(F.from(t.create(null,F.from(a.type.create(null,u)))),c?3:1,0),h=o.start,p=o.end;n(e.tr.step(new ct(h-(c?3:1),p,h,p,d,1,!0)).scrollIntoView())}return!0}}function pp(t){const{state:e,transaction:n}=t;let{selection:r}=n,{doc:i}=n,{storedMarks:o}=n;return{...e,apply:e.apply.bind(e),applyTransaction:e.applyTransaction.bind(e),plugins:e.plugins,schema:e.schema,reconfigure:e.reconfigure.bind(e),toJSON:e.toJSON.bind(e),get storedMarks(){return o},get selection(){return r},get doc(){return i},get tr(){return r=n.selection,i=n.doc,o=n.storedMarks,n}}}class mp{constructor(e){this.editor=e.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=e.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:e,editor:n,state:r}=this,{view:i}=n,{tr:o}=r,s=this.buildProps(o);return Object.fromEntries(Object.entries(e).map(([a,l])=>[a,(...u)=>{const d=l(...u)(s);return!o.getMeta("preventDispatch")&&!this.hasCustomState&&i.dispatch(o),d}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(e,n=!0){const{rawCommands:r,editor:i,state:o}=this,{view:s}=i,a=[],l=!!e,c=e||o.tr,u=()=>(!l&&n&&!c.getMeta("preventDispatch")&&!this.hasCustomState&&s.dispatch(c),a.every(h=>h===!0)),d={...Object.fromEntries(Object.entries(r).map(([h,p])=>[h,(...y)=>{const x=this.buildProps(c,n),v=p(...y)(x);return a.push(v),d}])),run:u};return d}createCan(e){const{rawCommands:n,state:r}=this,i=!1,o=e||r.tr,s=this.buildProps(o,i);return{...Object.fromEntries(Object.entries(n).map(([l,c])=>[l,(...u)=>c(...u)({...s,dispatch:void 0})])),chain:()=>this.createChain(o,i)}}buildProps(e,n=!0){const{rawCommands:r,editor:i,state:o}=this,{view:s}=i,a={tr:e,editor:i,view:s,state:pp({state:o,transaction:e}),dispatch:n?()=>{}:void 0,chain:()=>this.createChain(e,n),can:()=>this.createCan(e),get commands(){return Object.fromEntries(Object.entries(r).map(([l,c])=>[l,(...u)=>c(...u)(a)]))}};return a}}class xz{constructor(){this.callbacks={}}on(e,n){return this.callbacks[e]||(this.callbacks[e]=[]),this.callbacks[e].push(n),this}emit(e,...n){const r=this.callbacks[e];return r&&r.forEach(i=>i.apply(this,n)),this}off(e,n){const r=this.callbacks[e];return r&&(n?this.callbacks[e]=r.filter(i=>i!==n):delete this.callbacks[e]),this}once(e,n){const r=(...i)=>{this.off(e,r),n.apply(this,i)};return this.on(e,r)}removeAllListeners(){this.callbacks={}}}function J(t,e,n){return t.config[e]===void 0&&t.parent?J(t.parent,e,n):typeof t.config[e]=="function"?t.config[e].bind({...n,parent:t.parent?J(t.parent,e,n):null}):t.config[e]}function gp(t){const e=t.filter(i=>i.type==="extension"),n=t.filter(i=>i.type==="node"),r=t.filter(i=>i.type==="mark");return{baseExtensions:e,nodeExtensions:n,markExtensions:r}}function pO(t){const e=[],{nodeExtensions:n,markExtensions:r}=gp(t),i=[...n,...r],o={default:null,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return t.forEach(s=>{const a={name:s.name,options:s.options,storage:s.storage,extensions:i},l=J(s,"addGlobalAttributes",a);if(!l)return;l().forEach(u=>{u.types.forEach(d=>{Object.entries(u.attributes).forEach(([h,p])=>{e.push({type:d,name:h,attribute:{...o,...p}})})})})}),i.forEach(s=>{const a={name:s.name,options:s.options,storage:s.storage},l=J(s,"addAttributes",a);if(!l)return;const c=l();Object.entries(c).forEach(([u,d])=>{const h={...o,...d};typeof(h==null?void 0:h.default)=="function"&&(h.default=h.default()),h!=null&&h.isRequired&&(h==null?void 0:h.default)===void 0&&delete h.default,e.push({type:s.name,name:u,attribute:h})})}),e}function dt(t,e){if(typeof t=="string"){if(!e.nodes[t])throw Error(`There is no node type named '${t}'. Maybe you forgot to add the extension?`);return e.nodes[t]}return t}function Gt(...t){return t.filter(e=>!!e).reduce((e,n)=>{const r={...e};return Object.entries(n).forEach(([i,o])=>{if(!r[i]){r[i]=o;return}if(i==="class"){const a=o?String(o).split(" "):[],l=r[i]?r[i].split(" "):[],c=a.filter(u=>!l.includes(u));r[i]=[...l,...c].join(" ")}else if(i==="style"){const a=o?o.split(";").map(u=>u.trim()).filter(Boolean):[],l=r[i]?r[i].split(";").map(u=>u.trim()).filter(Boolean):[],c=new Map;l.forEach(u=>{const[d,h]=u.split(":").map(p=>p.trim());c.set(d,h)}),a.forEach(u=>{const[d,h]=u.split(":").map(p=>p.trim());c.set(d,h)}),r[i]=Array.from(c.entries()).map(([u,d])=>`${u}: ${d}`).join("; ")}else r[i]=o}),r},{})}function qy(t,e){return e.filter(n=>n.type===t.type.name).filter(n=>n.attribute.rendered).map(n=>n.attribute.renderHTML?n.attribute.renderHTML(t.attrs)||{}:{[n.name]:t.attrs[n.name]}).reduce((n,r)=>Gt(n,r),{})}function mO(t){return typeof t=="function"}function ue(t,e=void 0,...n){return mO(t)?e?t.bind(e)(...n):t(...n):t}function wz(t={}){return Object.keys(t).length===0&&t.constructor===Object}function bz(t){return typeof t!="string"?t:t.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(t):t==="true"?!0:t==="false"?!1:t}function Y1(t,e){return"style"in t?t:{...t,getAttrs:n=>{const r=t.getAttrs?t.getAttrs(n):t.attrs;if(r===!1)return!1;const i=e.reduce((o,s)=>{const a=s.attribute.parseHTML?s.attribute.parseHTML(n):bz(n.getAttribute(s.name));return a==null?o:{...o,[s.name]:a}},{});return{...r,...i}}}}function Q1(t){return Object.fromEntries(Object.entries(t).filter(([e,n])=>e==="attrs"&&wz(n)?!1:n!=null))}function Sz(t,e){var n;const r=pO(t),{nodeExtensions:i,markExtensions:o}=gp(t),s=(n=i.find(c=>J(c,"topNode")))===null||n===void 0?void 0:n.name,a=Object.fromEntries(i.map(c=>{const u=r.filter(v=>v.type===c.name),d={name:c.name,options:c.options,storage:c.storage,editor:e},h=t.reduce((v,w)=>{const b=J(w,"extendNodeSchema",d);return{...v,...b?b(c):{}}},{}),p=Q1({...h,content:ue(J(c,"content",d)),marks:ue(J(c,"marks",d)),group:ue(J(c,"group",d)),inline:ue(J(c,"inline",d)),atom:ue(J(c,"atom",d)),selectable:ue(J(c,"selectable",d)),draggable:ue(J(c,"draggable",d)),code:ue(J(c,"code",d)),whitespace:ue(J(c,"whitespace",d)),linebreakReplacement:ue(J(c,"linebreakReplacement",d)),defining:ue(J(c,"defining",d)),isolating:ue(J(c,"isolating",d)),attrs:Object.fromEntries(u.map(v=>{var w;return[v.name,{default:(w=v==null?void 0:v.attribute)===null||w===void 0?void 0:w.default}]}))}),g=ue(J(c,"parseHTML",d));g&&(p.parseDOM=g.map(v=>Y1(v,u)));const y=J(c,"renderHTML",d);y&&(p.toDOM=v=>y({node:v,HTMLAttributes:qy(v,u)}));const x=J(c,"renderText",d);return x&&(p.toText=x),[c.name,p]})),l=Object.fromEntries(o.map(c=>{const u=r.filter(x=>x.type===c.name),d={name:c.name,options:c.options,storage:c.storage,editor:e},h=t.reduce((x,v)=>{const w=J(v,"extendMarkSchema",d);return{...x,...w?w(c):{}}},{}),p=Q1({...h,inclusive:ue(J(c,"inclusive",d)),excludes:ue(J(c,"excludes",d)),group:ue(J(c,"group",d)),spanning:ue(J(c,"spanning",d)),code:ue(J(c,"code",d)),attrs:Object.fromEntries(u.map(x=>{var v;return[x.name,{default:(v=x==null?void 0:x.attribute)===null||v===void 0?void 0:v.default}]}))}),g=ue(J(c,"parseHTML",d));g&&(p.parseDOM=g.map(x=>Y1(x,u)));const y=J(c,"renderHTML",d);return y&&(p.toDOM=x=>y({mark:x,HTMLAttributes:qy(x,u)})),[c.name,p]}));return new uR({topNode:s,nodes:a,marks:l})}function Bm(t,e){return e.nodes[t]||e.marks[t]||null}function X1(t,e){return Array.isArray(e)?e.some(n=>(typeof n=="string"?n:n.name)===t.name):e}function xx(t,e){const n=Zs.fromSchema(e).serializeFragment(t),i=document.implementation.createHTMLDocument().createElement("div");return i.appendChild(n),i.innerHTML}const Cz=(t,e=500)=>{let n="";const r=t.parentOffset;return t.parent.nodesBetween(Math.max(0,r-e),r,(i,o,s,a)=>{var l,c;const u=((c=(l=i.type.spec).toText)===null||c===void 0?void 0:c.call(l,{node:i,pos:o,parent:s,index:a}))||i.textContent||"%leaf%";n+=i.isAtom&&!i.isText?u:u.slice(0,Math.max(0,r-o))}),n};function wx(t){return Object.prototype.toString.call(t)==="[object RegExp]"}class yp{constructor(e){this.find=e.find,this.handler=e.handler}}const kz=(t,e)=>{if(wx(e))return e.exec(t);const n=e(t);if(!n)return null;const r=[n.text];return r.index=n.index,r.input=t,r.data=n.data,n.replaceWith&&(n.text.includes(n.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),r.push(n.replaceWith)),r};function Bd(t){var e;const{editor:n,from:r,to:i,text:o,rules:s,plugin:a}=t,{view:l}=n;if(l.composing)return!1;const c=l.state.doc.resolve(r);if(c.parent.type.spec.code||!((e=c.nodeBefore||c.nodeAfter)===null||e===void 0)&&e.marks.find(h=>h.type.spec.code))return!1;let u=!1;const d=Cz(c)+o;return s.forEach(h=>{if(u)return;const p=kz(d,h.find);if(!p)return;const g=l.state.tr,y=pp({state:l.state,transaction:g}),x={from:r-(p[0].length-o.length),to:i},{commands:v,chain:w,can:b}=new mp({editor:n,state:y});h.handler({state:y,range:x,match:p,commands:v,chain:w,can:b})===null||!g.steps.length||(g.setMeta(a,{transform:g,from:r,to:i,text:o}),l.dispatch(g),u=!0)}),u}function Ez(t){const{editor:e,rules:n}=t,r=new bt({state:{init(){return null},apply(i,o,s){const a=i.getMeta(r);if(a)return a;const l=i.getMeta("applyInputRules");return!!l&&setTimeout(()=>{let{text:u}=l;typeof u=="string"?u=u:u=xx(F.from(u),s.schema);const{from:d}=l,h=d+u.length;Bd({editor:e,from:d,to:h,text:u,rules:n,plugin:r})}),i.selectionSet||i.docChanged?null:o}},props:{handleTextInput(i,o,s,a){return Bd({editor:e,from:o,to:s,text:a,rules:n,plugin:r})},handleDOMEvents:{compositionend:i=>(setTimeout(()=>{const{$cursor:o}=i.state.selection;o&&Bd({editor:e,from:o.pos,to:o.pos,text:"",rules:n,plugin:r})}),!1)},handleKeyDown(i,o){if(o.key!=="Enter")return!1;const{$cursor:s}=i.state.selection;return s?Bd({editor:e,from:s.pos,to:s.pos,text:`
`,rules:n,plugin:r}):!1}},isInputRules:!0});return r}function Tz(t){return Object.prototype.toString.call(t).slice(8,-1)}function zd(t){return Tz(t)!=="Object"?!1:t.constructor===Object&&Object.getPrototypeOf(t)===Object.prototype}function vp(t,e){const n={...t};return zd(t)&&zd(e)&&Object.keys(e).forEach(r=>{zd(e[r])&&zd(t[r])?n[r]=vp(t[r],e[r]):n[r]=e[r]}),n}class Io{constructor(e={}){this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=ue(J(this,"addOptions",{name:this.name}))),this.storage=ue(J(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new Io(e)}configure(e={}){const n=this.extend({...this.config,addOptions:()=>vp(this.options,e)});return n.name=this.name,n.parent=this.parent,n}extend(e={}){const n=new Io(e);return n.parent=this,this.child=n,n.name=e.name?e.name:n.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=ue(J(n,"addOptions",{name:n.name})),n.storage=ue(J(n,"addStorage",{name:n.name,options:n.options})),n}static handleExit({editor:e,mark:n}){const{tr:r}=e.state,i=e.state.selection.$from;if(i.pos===i.end()){const s=i.marks();if(!!!s.find(c=>(c==null?void 0:c.type.name)===n.name))return!1;const l=s.find(c=>(c==null?void 0:c.type.name)===n.name);return l&&r.removeStoredMark(l),r.insertText(" ",i.pos),e.view.dispatch(r),!0}return!1}}function _z(t){return typeof t=="number"}class Rz{constructor(e){this.find=e.find,this.handler=e.handler}}const Oz=(t,e,n)=>{if(wx(e))return[...t.matchAll(e)];const r=e(t,n);return r?r.map(i=>{const o=[i.text];return o.index=i.index,o.input=t,o.data=i.data,i.replaceWith&&(i.text.includes(i.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),o.push(i.replaceWith)),o}):[]};function Pz(t){const{editor:e,state:n,from:r,to:i,rule:o,pasteEvent:s,dropEvent:a}=t,{commands:l,chain:c,can:u}=new mp({editor:e,state:n}),d=[];return n.doc.nodesBetween(r,i,(p,g)=>{if(!p.isTextblock||p.type.spec.code)return;const y=Math.max(r,g),x=Math.min(i,g+p.content.size),v=p.textBetween(y-g,x-g,void 0,"");Oz(v,o.find,s).forEach(b=>{if(b.index===void 0)return;const S=y+b.index+1,C=S+b[0].length,k={from:n.tr.mapping.map(S),to:n.tr.mapping.map(C)},E=o.handler({state:n,range:k,match:b,commands:l,chain:c,can:u,pasteEvent:s,dropEvent:a});d.push(E)})}),d.every(p=>p!==null)}let Vd=null;const Mz=t=>{var e;const n=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return(e=n.clipboardData)===null||e===void 0||e.setData("text/html",t),n};function Iz(t){const{editor:e,rules:n}=t;let r=null,i=!1,o=!1,s=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,a;try{a=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{a=null}const l=({state:u,from:d,to:h,rule:p,pasteEvt:g})=>{const y=u.tr,x=pp({state:u,transaction:y});if(!(!Pz({editor:e,state:x,from:Math.max(d-1,0),to:h.b-1,rule:p,pasteEvent:g,dropEvent:a})||!y.steps.length)){try{a=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{a=null}return s=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,y}};return n.map(u=>new bt({view(d){const h=g=>{var y;r=!((y=d.dom.parentElement)===null||y===void 0)&&y.contains(g.target)?d.dom.parentElement:null,r&&(Vd=e)},p=()=>{Vd&&(Vd=null)};return window.addEventListener("dragstart",h),window.addEventListener("dragend",p),{destroy(){window.removeEventListener("dragstart",h),window.removeEventListener("dragend",p)}}},props:{handleDOMEvents:{drop:(d,h)=>{if(o=r===d.dom.parentElement,a=h,!o){const p=Vd;p&&setTimeout(()=>{const g=p.state.selection;g&&p.commands.deleteRange({from:g.from,to:g.to})},10)}return!1},paste:(d,h)=>{var p;const g=(p=h.clipboardData)===null||p===void 0?void 0:p.getData("text/html");return s=h,i=!!(g!=null&&g.includes("data-pm-slice")),!1}}},appendTransaction:(d,h,p)=>{const g=d[0],y=g.getMeta("uiEvent")==="paste"&&!i,x=g.getMeta("uiEvent")==="drop"&&!o,v=g.getMeta("applyPasteRules"),w=!!v;if(!y&&!x&&!w)return;if(w){let{text:C}=v;typeof C=="string"?C=C:C=xx(F.from(C),p.schema);const{from:k}=v,E=k+C.length,T=Mz(C);return l({rule:u,state:p,from:k,to:{b:E},pasteEvt:T})}const b=h.doc.content.findDiffStart(p.doc.content),S=h.doc.content.findDiffEnd(p.doc.content);if(!(!_z(b)||!S||b===S.b))return l({rule:u,state:p,from:b,to:S,pasteEvt:s})}}))}function Az(t){const e=t.filter((n,r)=>t.indexOf(n)!==r);return Array.from(new Set(e))}class Ia{constructor(e,n){this.splittableMarks=[],this.editor=n,this.extensions=Ia.resolve(e),this.schema=Sz(this.extensions,n),this.setupExtensions()}static resolve(e){const n=Ia.sort(Ia.flatten(e)),r=Az(n.map(i=>i.name));return r.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${r.map(i=>`'${i}'`).join(", ")}]. This can lead to issues.`),n}static flatten(e){return e.map(n=>{const r={name:n.name,options:n.options,storage:n.storage},i=J(n,"addExtensions",r);return i?[n,...this.flatten(i())]:n}).flat(10)}static sort(e){return e.sort((r,i)=>{const o=J(r,"priority")||100,s=J(i,"priority")||100;return o>s?-1:o<s?1:0})}get commands(){return this.extensions.reduce((e,n)=>{const r={name:n.name,options:n.options,storage:n.storage,editor:this.editor,type:Bm(n.name,this.schema)},i=J(n,"addCommands",r);return i?{...e,...i()}:e},{})}get plugins(){const{editor:e}=this,n=Ia.sort([...this.extensions].reverse()),r=[],i=[],o=n.map(s=>{const a={name:s.name,options:s.options,storage:s.storage,editor:e,type:Bm(s.name,this.schema)},l=[],c=J(s,"addKeyboardShortcuts",a);let u={};if(s.type==="mark"&&J(s,"exitable",a)&&(u.ArrowRight=()=>Io.handleExit({editor:e,mark:s})),c){const y=Object.fromEntries(Object.entries(c()).map(([x,v])=>[x,()=>v({editor:e})]));u={...u,...y}}const d=K6(u);l.push(d);const h=J(s,"addInputRules",a);X1(s,e.options.enableInputRules)&&h&&r.push(...h());const p=J(s,"addPasteRules",a);X1(s,e.options.enablePasteRules)&&p&&i.push(...p());const g=J(s,"addProseMirrorPlugins",a);if(g){const y=g();l.push(...y)}return l}).flat();return[Ez({editor:e,rules:r}),...Iz({editor:e,rules:i}),...o]}get attributes(){return pO(this.extensions)}get nodeViews(){const{editor:e}=this,{nodeExtensions:n}=gp(this.extensions);return Object.fromEntries(n.filter(r=>!!J(r,"addNodeView")).map(r=>{const i=this.attributes.filter(l=>l.type===r.name),o={name:r.name,options:r.options,storage:r.storage,editor:e,type:dt(r.name,this.schema)},s=J(r,"addNodeView",o);if(!s)return[];const a=(l,c,u,d,h)=>{const p=qy(l,i);return s()({node:l,view:c,getPos:u,decorations:d,innerDecorations:h,editor:e,extension:r,HTMLAttributes:p})};return[r.name,a]}))}setupExtensions(){this.extensions.forEach(e=>{var n;this.editor.extensionStorage[e.name]=e.storage;const r={name:e.name,options:e.options,storage:e.storage,editor:this.editor,type:Bm(e.name,this.schema)};e.type==="mark"&&(!((n=ue(J(e,"keepOnSplit",r)))!==null&&n!==void 0)||n)&&this.splittableMarks.push(e.name);const i=J(e,"onBeforeCreate",r),o=J(e,"onCreate",r),s=J(e,"onUpdate",r),a=J(e,"onSelectionUpdate",r),l=J(e,"onTransaction",r),c=J(e,"onFocus",r),u=J(e,"onBlur",r),d=J(e,"onDestroy",r);i&&this.editor.on("beforeCreate",i),o&&this.editor.on("create",o),s&&this.editor.on("update",s),a&&this.editor.on("selectionUpdate",a),l&&this.editor.on("transaction",l),c&&this.editor.on("focus",c),u&&this.editor.on("blur",u),d&&this.editor.on("destroy",d)})}}class ft{constructor(e={}){this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=ue(J(this,"addOptions",{name:this.name}))),this.storage=ue(J(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new ft(e)}configure(e={}){const n=this.extend({...this.config,addOptions:()=>vp(this.options,e)});return n.name=this.name,n.parent=this.parent,n}extend(e={}){const n=new ft({...this.config,...e});return n.parent=this,this.child=n,n.name=e.name?e.name:n.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=ue(J(n,"addOptions",{name:n.name})),n.storage=ue(J(n,"addStorage",{name:n.name,options:n.options})),n}}function gO(t,e,n){const{from:r,to:i}=e,{blockSeparator:o=`

`,textSerializers:s={}}=n||{};let a="";return t.nodesBetween(r,i,(l,c,u,d)=>{var h;l.isBlock&&c>r&&(a+=o);const p=s==null?void 0:s[l.type.name];if(p)return u&&(a+=p({node:l,pos:c,parent:u,index:d,range:e})),!1;l.isText&&(a+=(h=l==null?void 0:l.text)===null||h===void 0?void 0:h.slice(Math.max(r,c)-c,i-c))}),a}function yO(t){return Object.fromEntries(Object.entries(t.nodes).filter(([,e])=>e.spec.toText).map(([e,n])=>[e,n.spec.toText]))}const Nz=ft.create({name:"clipboardTextSerializer",addOptions(){return{blockSeparator:void 0}},addProseMirrorPlugins(){return[new bt({key:new Rn("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:t}=this,{state:e,schema:n}=t,{doc:r,selection:i}=e,{ranges:o}=i,s=Math.min(...o.map(u=>u.$from.pos)),a=Math.max(...o.map(u=>u.$to.pos)),l=yO(n);return gO(r,{from:s,to:a},{...this.options.blockSeparator!==void 0?{blockSeparator:this.options.blockSeparator}:{},textSerializers:l})}}})]}}),jz=()=>({editor:t,view:e})=>(requestAnimationFrame(()=>{var n;t.isDestroyed||(e.dom.blur(),(n=window==null?void 0:window.getSelection())===null||n===void 0||n.removeAllRanges())}),!0),Dz=(t=!1)=>({commands:e})=>e.setContent("",t),Lz=()=>({state:t,tr:e,dispatch:n})=>{const{selection:r}=e,{ranges:i}=r;return n&&i.forEach(({$from:o,$to:s})=>{t.doc.nodesBetween(o.pos,s.pos,(a,l)=>{if(a.type.isText)return;const{doc:c,mapping:u}=e,d=c.resolve(u.map(l)),h=c.resolve(u.map(l+a.nodeSize)),p=d.blockRange(h);if(!p)return;const g=ql(p);if(a.type.isTextblock){const{defaultType:y}=d.parent.contentMatchAt(d.index());e.setNodeMarkup(p.start,y)}(g||g===0)&&e.lift(p,g)})}),!0},$z=t=>e=>t(e),Fz=()=>({state:t,dispatch:e})=>oz(t,e),Bz=(t,e)=>({editor:n,tr:r})=>{const{state:i}=n,o=i.doc.slice(t.from,t.to);r.deleteRange(t.from,t.to);const s=r.mapping.map(e);return r.insert(s,o.content),r.setSelection(new ie(r.doc.resolve(s-1))),!0},zz=()=>({tr:t,dispatch:e})=>{const{selection:n}=t,r=n.$anchor.node();if(r.content.size>0)return!1;const i=t.selection.$anchor;for(let o=i.depth;o>0;o-=1)if(i.node(o).type===r.type){if(e){const a=i.before(o),l=i.after(o);t.delete(a,l).scrollIntoView()}return!0}return!1},Vz=t=>({tr:e,state:n,dispatch:r})=>{const i=dt(t,n.schema),o=e.selection.$anchor;for(let s=o.depth;s>0;s-=1)if(o.node(s).type===i){if(r){const l=o.before(s),c=o.after(s);e.delete(l,c).scrollIntoView()}return!0}return!1},Uz=t=>({tr:e,dispatch:n})=>{const{from:r,to:i}=t;return n&&e.delete(r,i),!0},Hz=()=>({state:t,dispatch:e})=>q6(t,e),Wz=()=>({commands:t})=>t.keyboardShortcut("Enter"),Kz=()=>({state:t,dispatch:e})=>iz(t,e);function gh(t,e,n={strict:!0}){const r=Object.keys(e);return r.length?r.every(i=>n.strict?e[i]===t[i]:wx(e[i])?e[i].test(t[i]):e[i]===t[i]):!0}function vO(t,e,n={}){return t.find(r=>r.type===e&&gh(Object.fromEntries(Object.keys(n).map(i=>[i,r.attrs[i]])),n))}function Z1(t,e,n={}){return!!vO(t,e,n)}function bx(t,e,n){var r;if(!t||!e)return;let i=t.parent.childAfter(t.parentOffset);if((!i.node||!i.node.marks.some(u=>u.type===e))&&(i=t.parent.childBefore(t.parentOffset)),!i.node||!i.node.marks.some(u=>u.type===e)||(n=n||((r=i.node.marks[0])===null||r===void 0?void 0:r.attrs),!vO([...i.node.marks],e,n)))return;let s=i.index,a=t.start()+i.offset,l=s+1,c=a+i.node.nodeSize;for(;s>0&&Z1([...t.parent.child(s-1).marks],e,n);)s-=1,a-=t.parent.child(s).nodeSize;for(;l<t.parent.childCount&&Z1([...t.parent.child(l).marks],e,n);)c+=t.parent.child(l).nodeSize,l+=1;return{from:a,to:c}}function $o(t,e){if(typeof t=="string"){if(!e.marks[t])throw Error(`There is no mark type named '${t}'. Maybe you forgot to add the extension?`);return e.marks[t]}return t}const qz=(t,e={})=>({tr:n,state:r,dispatch:i})=>{const o=$o(t,r.schema),{doc:s,selection:a}=n,{$from:l,from:c,to:u}=a;if(i){const d=bx(l,o,e);if(d&&d.from<=c&&d.to>=u){const h=ie.create(s,d.from,d.to);n.setSelection(h)}}return!0},Gz=t=>e=>{const n=typeof t=="function"?t(e):t;for(let r=0;r<n.length;r+=1)if(n[r](e))return!0;return!1};function Sx(t){return t instanceof ie}function oi(t=0,e=0,n=0){return Math.min(Math.max(t,e),n)}function xO(t,e=null){if(!e)return null;const n=oe.atStart(t),r=oe.atEnd(t);if(e==="start"||e===!0)return n;if(e==="end")return r;const i=n.from,o=r.to;return e==="all"?ie.create(t,oi(0,i,o),oi(t.content.size,i,o)):ie.create(t,oi(e,i,o),oi(e,i,o))}function Jz(){return navigator.platform==="Android"||/android/i.test(navigator.userAgent)}function Cx(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}const Yz=(t=null,e={})=>({editor:n,view:r,tr:i,dispatch:o})=>{e={scrollIntoView:!0,...e};const s=()=>{(Cx()||Jz())&&r.dom.focus(),requestAnimationFrame(()=>{n.isDestroyed||(r.focus(),e!=null&&e.scrollIntoView&&n.commands.scrollIntoView())})};if(r.hasFocus()&&t===null||t===!1)return!0;if(o&&t===null&&!Sx(n.state.selection))return s(),!0;const a=xO(i.doc,t)||n.state.selection,l=n.state.selection.eq(a);return o&&(l||i.setSelection(a),l&&i.storedMarks&&i.setStoredMarks(i.storedMarks),s()),!0},Qz=(t,e)=>n=>t.every((r,i)=>e(r,{...n,index:i})),Xz=(t,e)=>({tr:n,commands:r})=>r.insertContentAt({from:n.selection.from,to:n.selection.to},t,e),wO=t=>{const e=t.childNodes;for(let n=e.length-1;n>=0;n-=1){const r=e[n];r.nodeType===3&&r.nodeValue&&/^(\n\s\s|\n)$/.test(r.nodeValue)?t.removeChild(r):r.nodeType===1&&wO(r)}return t};function Ud(t){const e=`<body>${t}</body>`,n=new window.DOMParser().parseFromString(e,"text/html").body;return wO(n)}function yh(t,e,n){if(t instanceof xo||t instanceof F)return t;n={slice:!0,parseOptions:{},...n};const r=typeof t=="object"&&t!==null,i=typeof t=="string";if(r)try{if(Array.isArray(t)&&t.length>0)return F.fromArray(t.map(a=>e.nodeFromJSON(a)));const s=e.nodeFromJSON(t);return n.errorOnInvalidContent&&s.check(),s}catch(o){if(n.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:o});return console.warn("[tiptap warn]: Invalid content.","Passed value:",t,"Error:",o),yh("",e,n)}if(i){if(n.errorOnInvalidContent){let s=!1,a="";const l=new uR({topNode:e.spec.topNode,marks:e.spec.marks,nodes:e.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:c=>(s=!0,a=typeof c=="string"?c:c.outerHTML,null)}]}})});if(n.slice?wo.fromSchema(l).parseSlice(Ud(t),n.parseOptions):wo.fromSchema(l).parse(Ud(t),n.parseOptions),n.errorOnInvalidContent&&s)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${a}`)})}const o=wo.fromSchema(e);return n.slice?o.parseSlice(Ud(t),n.parseOptions).content:o.parse(Ud(t),n.parseOptions)}return yh("",e,n)}function Zz(t,e,n){const r=t.steps.length-1;if(r<e)return;const i=t.steps[r];if(!(i instanceof at||i instanceof ct))return;const o=t.mapping.maps[r];let s=0;o.forEach((a,l,c,u)=>{s===0&&(s=u)}),t.setSelection(oe.near(t.doc.resolve(s),n))}const e8=t=>!("type"in t),t8=(t,e,n)=>({tr:r,dispatch:i,editor:o})=>{var s;if(i){n={parseOptions:o.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...n};let a;try{a=yh(e,o.schema,{parseOptions:{preserveWhitespace:"full",...n.parseOptions},errorOnInvalidContent:(s=n.errorOnInvalidContent)!==null&&s!==void 0?s:o.options.enableContentCheck})}catch(g){return o.emit("contentError",{editor:o,error:g,disableCollaboration:()=>{o.storage.collaboration&&(o.storage.collaboration.isDisabled=!0)}}),!1}let{from:l,to:c}=typeof t=="number"?{from:t,to:t}:{from:t.from,to:t.to},u=!0,d=!0;if((e8(a)?a:[a]).forEach(g=>{g.check(),u=u?g.isText&&g.marks.length===0:!1,d=d?g.isBlock:!1}),l===c&&d){const{parent:g}=r.doc.resolve(l);g.isTextblock&&!g.type.spec.code&&!g.childCount&&(l-=1,c+=1)}let p;if(u){if(Array.isArray(e))p=e.map(g=>g.text||"").join("");else if(e instanceof F){let g="";e.forEach(y=>{y.text&&(g+=y.text)}),p=g}else typeof e=="object"&&e&&e.text?p=e.text:p=e;r.insertText(p,l,c)}else p=a,r.replaceWith(l,c,p);n.updateSelection&&Zz(r,r.steps.length-1,-1),n.applyInputRules&&r.setMeta("applyInputRules",{from:l,text:p}),n.applyPasteRules&&r.setMeta("applyPasteRules",{from:l,text:p})}return!0},n8=()=>({state:t,dispatch:e})=>ez(t,e),r8=()=>({state:t,dispatch:e})=>tz(t,e),i8=()=>({state:t,dispatch:e})=>G6(t,e),o8=()=>({state:t,dispatch:e})=>X6(t,e),s8=()=>({state:t,dispatch:e,tr:n})=>{try{const r=lp(t.doc,t.selection.$from.pos,-1);return r==null?!1:(n.join(r,2),e&&e(n),!0)}catch{return!1}},a8=()=>({state:t,dispatch:e,tr:n})=>{try{const r=lp(t.doc,t.selection.$from.pos,1);return r==null?!1:(n.join(r,2),e&&e(n),!0)}catch{return!1}},l8=()=>({state:t,dispatch:e})=>J6(t,e),c8=()=>({state:t,dispatch:e})=>Y6(t,e);function bO(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function u8(t){const e=t.split(/-(?!$)/);let n=e[e.length-1];n==="Space"&&(n=" ");let r,i,o,s;for(let a=0;a<e.length-1;a+=1){const l=e[a];if(/^(cmd|meta|m)$/i.test(l))s=!0;else if(/^a(lt)?$/i.test(l))r=!0;else if(/^(c|ctrl|control)$/i.test(l))i=!0;else if(/^s(hift)?$/i.test(l))o=!0;else if(/^mod$/i.test(l))Cx()||bO()?s=!0:i=!0;else throw new Error(`Unrecognized modifier name: ${l}`)}return r&&(n=`Alt-${n}`),i&&(n=`Ctrl-${n}`),s&&(n=`Meta-${n}`),o&&(n=`Shift-${n}`),n}const d8=t=>({editor:e,view:n,tr:r,dispatch:i})=>{const o=u8(t).split(/-(?!$)/),s=o.find(c=>!["Alt","Ctrl","Meta","Shift"].includes(c)),a=new KeyboardEvent("keydown",{key:s==="Space"?" ":s,altKey:o.includes("Alt"),ctrlKey:o.includes("Ctrl"),metaKey:o.includes("Meta"),shiftKey:o.includes("Shift"),bubbles:!0,cancelable:!0}),l=e.captureTransaction(()=>{n.someProp("handleKeyDown",c=>c(n,a))});return l==null||l.steps.forEach(c=>{const u=c.map(r.mapping);u&&i&&r.maybeStep(u)}),!0};function vu(t,e,n={}){const{from:r,to:i,empty:o}=t.selection,s=e?dt(e,t.schema):null,a=[];t.doc.nodesBetween(r,i,(d,h)=>{if(d.isText)return;const p=Math.max(r,h),g=Math.min(i,h+d.nodeSize);a.push({node:d,from:p,to:g})});const l=i-r,c=a.filter(d=>s?s.name===d.node.type.name:!0).filter(d=>gh(d.node.attrs,n,{strict:!1}));return o?!!c.length:c.reduce((d,h)=>d+h.to-h.from,0)>=l}const f8=(t,e={})=>({state:n,dispatch:r})=>{const i=dt(t,n.schema);return vu(n,i,e)?nz(n,r):!1},h8=()=>({state:t,dispatch:e})=>sz(t,e),p8=t=>({state:e,dispatch:n})=>{const r=dt(t,e.schema);return mz(r)(e,n)},m8=()=>({state:t,dispatch:e})=>rz(t,e);function xp(t,e){return e.nodes[t]?"node":e.marks[t]?"mark":null}function eS(t,e){const n=typeof e=="string"?[e]:e;return Object.keys(t).reduce((r,i)=>(n.includes(i)||(r[i]=t[i]),r),{})}const g8=(t,e)=>({tr:n,state:r,dispatch:i})=>{let o=null,s=null;const a=xp(typeof t=="string"?t:t.name,r.schema);return a?(a==="node"&&(o=dt(t,r.schema)),a==="mark"&&(s=$o(t,r.schema)),i&&n.selection.ranges.forEach(l=>{r.doc.nodesBetween(l.$from.pos,l.$to.pos,(c,u)=>{o&&o===c.type&&n.setNodeMarkup(u,void 0,eS(c.attrs,e)),s&&c.marks.length&&c.marks.forEach(d=>{s===d.type&&n.addMark(u,u+c.nodeSize,s.create(eS(d.attrs,e)))})})}),!0):!1},y8=()=>({tr:t,dispatch:e})=>(e&&t.scrollIntoView(),!0),v8=()=>({tr:t,dispatch:e})=>{if(e){const n=new Fn(t.doc);t.setSelection(n)}return!0},x8=()=>({state:t,dispatch:e})=>Q6(t,e),w8=()=>({state:t,dispatch:e})=>Z6(t,e),b8=()=>({state:t,dispatch:e})=>az(t,e),S8=()=>({state:t,dispatch:e})=>uz(t,e),C8=()=>({state:t,dispatch:e})=>cz(t,e);function Gy(t,e,n={},r={}){return yh(t,e,{slice:!1,parseOptions:n,errorOnInvalidContent:r.errorOnInvalidContent})}const k8=(t,e=!1,n={},r={})=>({editor:i,tr:o,dispatch:s,commands:a})=>{var l,c;const{doc:u}=o;if(n.preserveWhitespace!=="full"){const d=Gy(t,i.schema,n,{errorOnInvalidContent:(l=r.errorOnInvalidContent)!==null&&l!==void 0?l:i.options.enableContentCheck});return s&&o.replaceWith(0,u.content.size,d).setMeta("preventUpdate",!e),!0}return s&&o.setMeta("preventUpdate",!e),a.insertContentAt({from:0,to:u.content.size},t,{parseOptions:n,errorOnInvalidContent:(c=r.errorOnInvalidContent)!==null&&c!==void 0?c:i.options.enableContentCheck})};function SO(t,e){const n=$o(e,t.schema),{from:r,to:i,empty:o}=t.selection,s=[];o?(t.storedMarks&&s.push(...t.storedMarks),s.push(...t.selection.$head.marks())):t.doc.nodesBetween(r,i,l=>{s.push(...l.marks)});const a=s.find(l=>l.type.name===n.name);return a?{...a.attrs}:{}}function E8(t){for(let e=0;e<t.edgeCount;e+=1){const{type:n}=t.edge(e);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}function T8(t,e){for(let n=t.depth;n>0;n-=1){const r=t.node(n);if(e(r))return{pos:n>0?t.before(n):0,start:t.start(n),depth:n,node:r}}}function kx(t){return e=>T8(e.$from,t)}function _8(t,e){const n={from:0,to:t.content.size};return gO(t,n,e)}function R8(t,e){const n=dt(e,t.schema),{from:r,to:i}=t.selection,o=[];t.doc.nodesBetween(r,i,a=>{o.push(a)});const s=o.reverse().find(a=>a.type.name===n.name);return s?{...s.attrs}:{}}function O8(t,e){const n=xp(typeof e=="string"?e:e.name,t.schema);return n==="node"?R8(t,e):n==="mark"?SO(t,e):{}}function CO(t,e,n){const r=[];return t===e?n.resolve(t).marks().forEach(i=>{const o=n.resolve(t),s=bx(o,i.type);s&&r.push({mark:i,...s})}):n.nodesBetween(t,e,(i,o)=>{!i||(i==null?void 0:i.nodeSize)===void 0||r.push(...i.marks.map(s=>({from:o,to:o+i.nodeSize,mark:s})))}),r}function vf(t,e,n){return Object.fromEntries(Object.entries(n).filter(([r])=>{const i=t.find(o=>o.type===e&&o.name===r);return i?i.attribute.keepOnSplit:!1}))}function Jy(t,e,n={}){const{empty:r,ranges:i}=t.selection,o=e?$o(e,t.schema):null;if(r)return!!(t.storedMarks||t.selection.$from.marks()).filter(d=>o?o.name===d.type.name:!0).find(d=>gh(d.attrs,n,{strict:!1}));let s=0;const a=[];if(i.forEach(({$from:d,$to:h})=>{const p=d.pos,g=h.pos;t.doc.nodesBetween(p,g,(y,x)=>{if(!y.isText&&!y.marks.length)return;const v=Math.max(p,x),w=Math.min(g,x+y.nodeSize),b=w-v;s+=b,a.push(...y.marks.map(S=>({mark:S,from:v,to:w})))})}),s===0)return!1;const l=a.filter(d=>o?o.name===d.mark.type.name:!0).filter(d=>gh(d.mark.attrs,n,{strict:!1})).reduce((d,h)=>d+h.to-h.from,0),c=a.filter(d=>o?d.mark.type!==o&&d.mark.type.excludes(o):!0).reduce((d,h)=>d+h.to-h.from,0);return(l>0?l+c:l)>=s}function P8(t,e,n={}){if(!e)return vu(t,null,n)||Jy(t,null,n);const r=xp(e,t.schema);return r==="node"?vu(t,e,n):r==="mark"?Jy(t,e,n):!1}function tS(t,e){const{nodeExtensions:n}=gp(e),r=n.find(s=>s.name===t);if(!r)return!1;const i={name:r.name,options:r.options,storage:r.storage},o=ue(J(r,"group",i));return typeof o!="string"?!1:o.split(" ").includes("list")}function wp(t,{checkChildren:e=!0,ignoreWhitespace:n=!1}={}){var r;if(n){if(t.type.name==="hardBreak")return!0;if(t.isText)return/^\s*$/m.test((r=t.text)!==null&&r!==void 0?r:"")}if(t.isText)return!t.text;if(t.isAtom||t.isLeaf)return!1;if(t.content.childCount===0)return!0;if(e){let i=!0;return t.content.forEach(o=>{i!==!1&&(wp(o,{ignoreWhitespace:n,checkChildren:e})||(i=!1))}),i}return!1}function kO(t){return t instanceof te}function M8(t,e,n){const i=t.state.doc.content.size,o=oi(e,0,i),s=oi(n,0,i),a=t.coordsAtPos(o),l=t.coordsAtPos(s,-1),c=Math.min(a.top,l.top),u=Math.max(a.bottom,l.bottom),d=Math.min(a.left,l.left),h=Math.max(a.right,l.right),p=h-d,g=u-c,v={top:c,bottom:u,left:d,right:h,width:p,height:g,x:d,y:c};return{...v,toJSON:()=>v}}function I8(t,e,n){var r;const{selection:i}=e;let o=null;if(Sx(i)&&(o=i.$cursor),o){const a=(r=t.storedMarks)!==null&&r!==void 0?r:o.marks();return!!n.isInSet(a)||!a.some(l=>l.type.excludes(n))}const{ranges:s}=i;return s.some(({$from:a,$to:l})=>{let c=a.depth===0?t.doc.inlineContent&&t.doc.type.allowsMarkType(n):!1;return t.doc.nodesBetween(a.pos,l.pos,(u,d,h)=>{if(c)return!1;if(u.isInline){const p=!h||h.type.allowsMarkType(n),g=!!n.isInSet(u.marks)||!u.marks.some(y=>y.type.excludes(n));c=p&&g}return!c}),c})}const A8=(t,e={})=>({tr:n,state:r,dispatch:i})=>{const{selection:o}=n,{empty:s,ranges:a}=o,l=$o(t,r.schema);if(i)if(s){const c=SO(r,l);n.addStoredMark(l.create({...c,...e}))}else a.forEach(c=>{const u=c.$from.pos,d=c.$to.pos;r.doc.nodesBetween(u,d,(h,p)=>{const g=Math.max(p,u),y=Math.min(p+h.nodeSize,d);h.marks.find(v=>v.type===l)?h.marks.forEach(v=>{l===v.type&&n.addMark(g,y,l.create({...v.attrs,...e}))}):n.addMark(g,y,l.create(e))})});return I8(r,n,l)},N8=(t,e)=>({tr:n})=>(n.setMeta(t,e),!0),j8=(t,e={})=>({state:n,dispatch:r,chain:i})=>{const o=dt(t,n.schema);let s;return n.selection.$anchor.sameParent(n.selection.$head)&&(s=n.selection.$anchor.parent.attrs),o.isTextblock?i().command(({commands:a})=>J1(o,{...s,...e})(n)?!0:a.clearNodes()).command(({state:a})=>J1(o,{...s,...e})(a,r)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},D8=t=>({tr:e,dispatch:n})=>{if(n){const{doc:r}=e,i=oi(t,0,r.content.size),o=te.create(r,i);e.setSelection(o)}return!0},L8=t=>({tr:e,dispatch:n})=>{if(n){const{doc:r}=e,{from:i,to:o}=typeof t=="number"?{from:t,to:t}:t,s=ie.atStart(r).from,a=ie.atEnd(r).to,l=oi(i,s,a),c=oi(o,s,a),u=ie.create(r,l,c);e.setSelection(u)}return!0},$8=t=>({state:e,dispatch:n})=>{const r=dt(t,e.schema);return vz(r)(e,n)};function nS(t,e){const n=t.storedMarks||t.selection.$to.parentOffset&&t.selection.$from.marks();if(n){const r=n.filter(i=>e==null?void 0:e.includes(i.type.name));t.tr.ensureMarks(r)}}const F8=({keepMarks:t=!0}={})=>({tr:e,state:n,dispatch:r,editor:i})=>{const{selection:o,doc:s}=e,{$from:a,$to:l}=o,c=i.extensionManager.attributes,u=vf(c,a.node().type.name,a.node().attrs);if(o instanceof te&&o.node.isBlock)return!a.parentOffset||!Ha(s,a.pos)?!1:(r&&(t&&nS(n,i.extensionManager.splittableMarks),e.split(a.pos).scrollIntoView()),!0);if(!a.parent.isBlock)return!1;const d=l.parentOffset===l.parent.content.size,h=a.depth===0?void 0:E8(a.node(-1).contentMatchAt(a.indexAfter(-1)));let p=d&&h?[{type:h,attrs:u}]:void 0,g=Ha(e.doc,e.mapping.map(a.pos),1,p);if(!p&&!g&&Ha(e.doc,e.mapping.map(a.pos),1,h?[{type:h}]:void 0)&&(g=!0,p=h?[{type:h,attrs:u}]:void 0),r){if(g&&(o instanceof ie&&e.deleteSelection(),e.split(e.mapping.map(a.pos),1,p),h&&!d&&!a.parentOffset&&a.parent.type!==h)){const y=e.mapping.map(a.before()),x=e.doc.resolve(y);a.node(-1).canReplaceWith(x.index(),x.index()+1,h)&&e.setNodeMarkup(e.mapping.map(a.before()),h)}t&&nS(n,i.extensionManager.splittableMarks),e.scrollIntoView()}return g},B8=(t,e={})=>({tr:n,state:r,dispatch:i,editor:o})=>{var s;const a=dt(t,r.schema),{$from:l,$to:c}=r.selection,u=r.selection.node;if(u&&u.isBlock||l.depth<2||!l.sameParent(c))return!1;const d=l.node(-1);if(d.type!==a)return!1;const h=o.extensionManager.attributes;if(l.parent.content.size===0&&l.node(-1).childCount===l.indexAfter(-1)){if(l.depth===2||l.node(-3).type!==a||l.index(-2)!==l.node(-2).childCount-1)return!1;if(i){let v=F.empty;const w=l.index(-1)?1:l.index(-2)?2:3;for(let T=l.depth-w;T>=l.depth-3;T-=1)v=F.from(l.node(T).copy(v));const b=l.indexAfter(-1)<l.node(-2).childCount?1:l.indexAfter(-2)<l.node(-3).childCount?2:3,S={...vf(h,l.node().type.name,l.node().attrs),...e},C=((s=a.contentMatch.defaultType)===null||s===void 0?void 0:s.createAndFill(S))||void 0;v=v.append(F.from(a.createAndFill(null,C)||void 0));const k=l.before(l.depth-(w-1));n.replace(k,l.after(-b),new q(v,4-w,0));let E=-1;n.doc.nodesBetween(k,n.doc.content.size,(T,R)=>{if(E>-1)return!1;T.isTextblock&&T.content.size===0&&(E=R+1)}),E>-1&&n.setSelection(ie.near(n.doc.resolve(E))),n.scrollIntoView()}return!0}const p=c.pos===l.end()?d.contentMatchAt(0).defaultType:null,g={...vf(h,d.type.name,d.attrs),...e},y={...vf(h,l.node().type.name,l.node().attrs),...e};n.delete(l.pos,c.pos);const x=p?[{type:a,attrs:g},{type:p,attrs:y}]:[{type:a,attrs:g}];if(!Ha(n.doc,l.pos,2))return!1;if(i){const{selection:v,storedMarks:w}=r,{splittableMarks:b}=o.extensionManager,S=w||v.$to.parentOffset&&v.$from.marks();if(n.split(l.pos,2,x).scrollIntoView(),!S||!i)return!0;const C=S.filter(k=>b.includes(k.type.name));n.ensureMarks(C)}return!0},zm=(t,e)=>{const n=kx(s=>s.type===e)(t.selection);if(!n)return!0;const r=t.doc.resolve(Math.max(0,n.pos-1)).before(n.depth);if(r===void 0)return!0;const i=t.doc.nodeAt(r);return n.node.type===(i==null?void 0:i.type)&&Do(t.doc,n.pos)&&t.join(n.pos),!0},Vm=(t,e)=>{const n=kx(s=>s.type===e)(t.selection);if(!n)return!0;const r=t.doc.resolve(n.start).after(n.depth);if(r===void 0)return!0;const i=t.doc.nodeAt(r);return n.node.type===(i==null?void 0:i.type)&&Do(t.doc,r)&&t.join(r),!0},z8=(t,e,n,r={})=>({editor:i,tr:o,state:s,dispatch:a,chain:l,commands:c,can:u})=>{const{extensions:d,splittableMarks:h}=i.extensionManager,p=dt(t,s.schema),g=dt(e,s.schema),{selection:y,storedMarks:x}=s,{$from:v,$to:w}=y,b=v.blockRange(w),S=x||y.$to.parentOffset&&y.$from.marks();if(!b)return!1;const C=kx(k=>tS(k.type.name,d))(y);if(b.depth>=1&&C&&b.depth-C.depth<=1){if(C.node.type===p)return c.liftListItem(g);if(tS(C.node.type.name,d)&&p.validContent(C.node.content)&&a)return l().command(()=>(o.setNodeMarkup(C.pos,p),!0)).command(()=>zm(o,p)).command(()=>Vm(o,p)).run()}return!n||!S||!a?l().command(()=>u().wrapInList(p,r)?!0:c.clearNodes()).wrapInList(p,r).command(()=>zm(o,p)).command(()=>Vm(o,p)).run():l().command(()=>{const k=u().wrapInList(p,r),E=S.filter(T=>h.includes(T.type.name));return o.ensureMarks(E),k?!0:c.clearNodes()}).wrapInList(p,r).command(()=>zm(o,p)).command(()=>Vm(o,p)).run()},V8=(t,e={},n={})=>({state:r,commands:i})=>{const{extendEmptyMarkRange:o=!1}=n,s=$o(t,r.schema);return Jy(r,s,e)?i.unsetMark(s,{extendEmptyMarkRange:o}):i.setMark(s,e)},U8=(t,e,n={})=>({state:r,commands:i})=>{const o=dt(t,r.schema),s=dt(e,r.schema),a=vu(r,o,n);let l;return r.selection.$anchor.sameParent(r.selection.$head)&&(l=r.selection.$anchor.parent.attrs),a?i.setNode(s,l):i.setNode(o,{...l,...n})},H8=(t,e={})=>({state:n,commands:r})=>{const i=dt(t,n.schema);return vu(n,i,e)?r.lift(i):r.wrapIn(i,e)},W8=()=>({state:t,dispatch:e})=>{const n=t.plugins;for(let r=0;r<n.length;r+=1){const i=n[r];let o;if(i.spec.isInputRules&&(o=i.getState(t))){if(e){const s=t.tr,a=o.transform;for(let l=a.steps.length-1;l>=0;l-=1)s.step(a.steps[l].invert(a.docs[l]));if(o.text){const l=s.doc.resolve(o.from).marks();s.replaceWith(o.from,o.to,t.schema.text(o.text,l))}else s.delete(o.from,o.to)}return!0}}return!1},K8=()=>({tr:t,dispatch:e})=>{const{selection:n}=t,{empty:r,ranges:i}=n;return r||e&&i.forEach(o=>{t.removeMark(o.$from.pos,o.$to.pos)}),!0},q8=(t,e={})=>({tr:n,state:r,dispatch:i})=>{var o;const{extendEmptyMarkRange:s=!1}=e,{selection:a}=n,l=$o(t,r.schema),{$from:c,empty:u,ranges:d}=a;if(!i)return!0;if(u&&s){let{from:h,to:p}=a;const g=(o=c.marks().find(x=>x.type===l))===null||o===void 0?void 0:o.attrs,y=bx(c,l,g);y&&(h=y.from,p=y.to),n.removeMark(h,p,l)}else d.forEach(h=>{n.removeMark(h.$from.pos,h.$to.pos,l)});return n.removeStoredMark(l),!0},G8=(t,e={})=>({tr:n,state:r,dispatch:i})=>{let o=null,s=null;const a=xp(typeof t=="string"?t:t.name,r.schema);return a?(a==="node"&&(o=dt(t,r.schema)),a==="mark"&&(s=$o(t,r.schema)),i&&n.selection.ranges.forEach(l=>{const c=l.$from.pos,u=l.$to.pos;let d,h,p,g;n.selection.empty?r.doc.nodesBetween(c,u,(y,x)=>{o&&o===y.type&&(p=Math.max(x,c),g=Math.min(x+y.nodeSize,u),d=x,h=y)}):r.doc.nodesBetween(c,u,(y,x)=>{x<c&&o&&o===y.type&&(p=Math.max(x,c),g=Math.min(x+y.nodeSize,u),d=x,h=y),x>=c&&x<=u&&(o&&o===y.type&&n.setNodeMarkup(x,void 0,{...y.attrs,...e}),s&&y.marks.length&&y.marks.forEach(v=>{if(s===v.type){const w=Math.max(x,c),b=Math.min(x+y.nodeSize,u);n.addMark(w,b,s.create({...v.attrs,...e}))}}))}),h&&(d!==void 0&&n.setNodeMarkup(d,void 0,{...h.attrs,...e}),s&&h.marks.length&&h.marks.forEach(y=>{s===y.type&&n.addMark(p,g,s.create({...y.attrs,...e}))}))}),!0):!1},J8=(t,e={})=>({state:n,dispatch:r})=>{const i=dt(t,n.schema);return dz(i,e)(n,r)},Y8=(t,e={})=>({state:n,dispatch:r})=>{const i=dt(t,n.schema);return fz(i,e)(n,r)};var Q8=Object.freeze({__proto__:null,blur:jz,clearContent:Dz,clearNodes:Lz,command:$z,createParagraphNear:Fz,cut:Bz,deleteCurrentNode:zz,deleteNode:Vz,deleteRange:Uz,deleteSelection:Hz,enter:Wz,exitCode:Kz,extendMarkRange:qz,first:Gz,focus:Yz,forEach:Qz,insertContent:Xz,insertContentAt:t8,joinBackward:i8,joinDown:r8,joinForward:o8,joinItemBackward:s8,joinItemForward:a8,joinTextblockBackward:l8,joinTextblockForward:c8,joinUp:n8,keyboardShortcut:d8,lift:f8,liftEmptyBlock:h8,liftListItem:p8,newlineInCode:m8,resetAttributes:g8,scrollIntoView:y8,selectAll:v8,selectNodeBackward:x8,selectNodeForward:w8,selectParentNode:b8,selectTextblockEnd:S8,selectTextblockStart:C8,setContent:k8,setMark:A8,setMeta:N8,setNode:j8,setNodeSelection:D8,setTextSelection:L8,sinkListItem:$8,splitBlock:F8,splitListItem:B8,toggleList:z8,toggleMark:V8,toggleNode:U8,toggleWrap:H8,undoInputRule:W8,unsetAllMarks:K8,unsetMark:q8,updateAttributes:G8,wrapIn:J8,wrapInList:Y8});const X8=ft.create({name:"commands",addCommands(){return{...Q8}}}),Z8=ft.create({name:"drop",addProseMirrorPlugins(){return[new bt({key:new Rn("tiptapDrop"),props:{handleDrop:(t,e,n,r)=>{this.editor.emit("drop",{editor:this.editor,event:e,slice:n,moved:r})}}})]}}),eV=ft.create({name:"editable",addProseMirrorPlugins(){return[new bt({key:new Rn("editable"),props:{editable:()=>this.editor.options.editable}})]}}),tV=ft.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:t}=this;return[new bt({key:new Rn("focusEvents"),props:{handleDOMEvents:{focus:(e,n)=>{t.isFocused=!0;const r=t.state.tr.setMeta("focus",{event:n}).setMeta("addToHistory",!1);return e.dispatch(r),!1},blur:(e,n)=>{t.isFocused=!1;const r=t.state.tr.setMeta("blur",{event:n}).setMeta("addToHistory",!1);return e.dispatch(r),!1}}}})]}}),nV=ft.create({name:"keymap",addKeyboardShortcuts(){const t=()=>this.editor.commands.first(({commands:s})=>[()=>s.undoInputRule(),()=>s.command(({tr:a})=>{const{selection:l,doc:c}=a,{empty:u,$anchor:d}=l,{pos:h,parent:p}=d,g=d.parent.isTextblock&&h>0?a.doc.resolve(h-1):d,y=g.parent.type.spec.isolating,x=d.pos-d.parentOffset,v=y&&g.parent.childCount===1?x===d.pos:oe.atStart(c).from===h;return!u||!p.type.isTextblock||p.textContent.length||!v||v&&d.parent.type.name==="paragraph"?!1:s.clearNodes()}),()=>s.deleteSelection(),()=>s.joinBackward(),()=>s.selectNodeBackward()]),e=()=>this.editor.commands.first(({commands:s})=>[()=>s.deleteSelection(),()=>s.deleteCurrentNode(),()=>s.joinForward(),()=>s.selectNodeForward()]),r={Enter:()=>this.editor.commands.first(({commands:s})=>[()=>s.newlineInCode(),()=>s.createParagraphNear(),()=>s.liftEmptyBlock(),()=>s.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:t,"Mod-Backspace":t,"Shift-Backspace":t,Delete:e,"Mod-Delete":e,"Mod-a":()=>this.editor.commands.selectAll()},i={...r},o={...r,"Ctrl-h":t,"Alt-Backspace":t,"Ctrl-d":e,"Ctrl-Alt-Backspace":e,"Alt-Delete":e,"Alt-d":e,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return Cx()||bO()?o:i},addProseMirrorPlugins(){return[new bt({key:new Rn("clearDocument"),appendTransaction:(t,e,n)=>{if(t.some(y=>y.getMeta("composition")))return;const r=t.some(y=>y.docChanged)&&!e.doc.eq(n.doc),i=t.some(y=>y.getMeta("preventClearDocument"));if(!r||i)return;const{empty:o,from:s,to:a}=e.selection,l=oe.atStart(e.doc).from,c=oe.atEnd(e.doc).to;if(o||!(s===l&&a===c)||!wp(n.doc))return;const h=n.tr,p=pp({state:n,transaction:h}),{commands:g}=new mp({editor:this.editor,state:p});if(g.clearNodes(),!!h.steps.length)return h}})]}}),rV=ft.create({name:"paste",addProseMirrorPlugins(){return[new bt({key:new Rn("tiptapPaste"),props:{handlePaste:(t,e,n)=>{this.editor.emit("paste",{editor:this.editor,event:e,slice:n})}}})]}}),iV=ft.create({name:"tabindex",addProseMirrorPlugins(){return[new bt({key:new Rn("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}});class Zo{get name(){return this.node.type.name}constructor(e,n,r=!1,i=null){this.currentNode=null,this.actualDepth=null,this.isBlock=r,this.resolvedPos=e,this.editor=n,this.currentNode=i}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var e;return(e=this.actualDepth)!==null&&e!==void 0?e:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(e){let n=this.from,r=this.to;if(this.isBlock){if(this.content.size===0){console.error(`You cant set content on a block node. Tried to set content on ${this.name} at ${this.pos}`);return}n=this.from+1,r=this.to-1}this.editor.commands.insertContentAt({from:n,to:r},e)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(this.depth===0)return null;const e=this.resolvedPos.start(this.resolvedPos.depth-1),n=this.resolvedPos.doc.resolve(e);return new Zo(n,this.editor)}get before(){let e=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.from-3)),new Zo(e,this.editor)}get after(){let e=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.to+3)),new Zo(e,this.editor)}get children(){const e=[];return this.node.content.forEach((n,r)=>{const i=n.isBlock&&!n.isTextblock,o=n.isAtom&&!n.isText,s=this.pos+r+(o?0:1),a=this.resolvedPos.doc.resolve(s);if(!i&&a.depth<=this.depth)return;const l=new Zo(a,this.editor,i,i?n:null);i&&(l.actualDepth=this.depth+1),e.push(new Zo(a,this.editor,i,i?n:null))}),e}get firstChild(){return this.children[0]||null}get lastChild(){const e=this.children;return e[e.length-1]||null}closest(e,n={}){let r=null,i=this.parent;for(;i&&!r;){if(i.node.type.name===e)if(Object.keys(n).length>0){const o=i.node.attrs,s=Object.keys(n);for(let a=0;a<s.length;a+=1){const l=s[a];if(o[l]!==n[l])break}}else r=i;i=i.parent}return r}querySelector(e,n={}){return this.querySelectorAll(e,n,!0)[0]||null}querySelectorAll(e,n={},r=!1){let i=[];if(!this.children||this.children.length===0)return i;const o=Object.keys(n);return this.children.forEach(s=>{r&&i.length>0||(s.node.type.name===e&&o.every(l=>n[l]===s.node.attrs[l])&&i.push(s),!(r&&i.length>0)&&(i=i.concat(s.querySelectorAll(e,n,r))))}),i}setAttribute(e){const{tr:n}=this.editor.state;n.setNodeMarkup(this.from,void 0,{...this.node.attrs,...e}),this.editor.view.dispatch(n)}}const oV=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 0 !important;
  height: 0 !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}

.tippy-box[data-animation=fade][data-state=hidden] {
  opacity: 0
}`;function sV(t,e,n){const r=document.querySelector(`style[data-tiptap-style${n?`-${n}`:""}]`);if(r!==null)return r;const i=document.createElement("style");return e&&i.setAttribute("nonce",e),i.setAttribute(`data-tiptap-style${n?`-${n}`:""}`,""),i.innerHTML=t,document.getElementsByTagName("head")[0].appendChild(i),i}class aV extends xz{constructor(e={}){super(),this.isFocused=!1,this.isInitialized=!1,this.extensionStorage={},this.options={element:document.createElement("div"),content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,enableContentCheck:!1,onBeforeCreate:()=>null,onCreate:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null,onContentError:({error:n})=>{throw n},onPaste:()=>null,onDrop:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(e),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.on("contentError",this.options.onContentError),this.createView(),this.injectCSS(),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),this.on("drop",({event:n,slice:r,moved:i})=>this.options.onDrop(n,r,i)),this.on("paste",({event:n,slice:r})=>this.options.onPaste(n,r)),window.setTimeout(()=>{this.isDestroyed||(this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}),this.isInitialized=!0)},0)}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&document&&(this.css=sV(oV,this.options.injectNonce))}setOptions(e={}){this.options={...this.options,...e},!(!this.view||!this.state||this.isDestroyed)&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(e,n=!0){this.setOptions({editable:e}),n&&this.emit("update",{editor:this,transaction:this.state.tr})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get state(){return this.view.state}registerPlugin(e,n){const r=mO(n)?n(e,[...this.state.plugins]):[...this.state.plugins,e],i=this.state.reconfigure({plugins:r});return this.view.updateState(i),i}unregisterPlugin(e){if(this.isDestroyed)return;const n=this.state.plugins;let r=n;if([].concat(e).forEach(o=>{const s=typeof o=="string"?`${o}$`:o.key;r=n.filter(a=>!a.key.startsWith(s))}),n.length===r.length)return;const i=this.state.reconfigure({plugins:r});return this.view.updateState(i),i}createExtensionManager(){var e,n;const i=[...this.options.enableCoreExtensions?[eV,Nz.configure({blockSeparator:(n=(e=this.options.coreExtensionOptions)===null||e===void 0?void 0:e.clipboardTextSerializer)===null||n===void 0?void 0:n.blockSeparator}),X8,tV,nV,iV,Z8,rV].filter(o=>typeof this.options.enableCoreExtensions=="object"?this.options.enableCoreExtensions[o.name]!==!1:!0):[],...this.options.extensions].filter(o=>["extension","node","mark"].includes(o==null?void 0:o.type));this.extensionManager=new Ia(i,this)}createCommandManager(){this.commandManager=new mp({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createView(){var e;let n;try{n=Gy(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:this.options.enableContentCheck})}catch(s){if(!(s instanceof Error)||!["[tiptap error]: Invalid JSON content","[tiptap error]: Invalid HTML content"].includes(s.message))throw s;this.emit("contentError",{editor:this,error:s,disableCollaboration:()=>{this.storage.collaboration&&(this.storage.collaboration.isDisabled=!0),this.options.extensions=this.options.extensions.filter(a=>a.name!=="collaboration"),this.createExtensionManager()}}),n=Gy(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:!1})}const r=xO(n,this.options.autofocus);this.view=new L6(this.options.element,{...this.options.editorProps,attributes:{role:"textbox",...(e=this.options.editorProps)===null||e===void 0?void 0:e.attributes},dispatchTransaction:this.dispatchTransaction.bind(this),state:Ma.create({doc:n,selection:r||void 0})});const i=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(i),this.createNodeViews(),this.prependClass();const o=this.view.dom;o.editor=this}createNodeViews(){this.view.isDestroyed||this.view.setProps({nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`tiptap ${this.view.dom.className}`}captureTransaction(e){this.isCapturingTransaction=!0,e(),this.isCapturingTransaction=!1;const n=this.capturedTransaction;return this.capturedTransaction=null,n}dispatchTransaction(e){if(this.view.isDestroyed)return;if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=e;return}e.steps.forEach(s=>{var a;return(a=this.capturedTransaction)===null||a===void 0?void 0:a.step(s)});return}const n=this.state.apply(e),r=!this.state.selection.eq(n.selection);this.emit("beforeTransaction",{editor:this,transaction:e,nextState:n}),this.view.updateState(n),this.emit("transaction",{editor:this,transaction:e}),r&&this.emit("selectionUpdate",{editor:this,transaction:e});const i=e.getMeta("focus"),o=e.getMeta("blur");i&&this.emit("focus",{editor:this,event:i.event,transaction:e}),o&&this.emit("blur",{editor:this,event:o.event,transaction:e}),!(!e.docChanged||e.getMeta("preventUpdate"))&&this.emit("update",{editor:this,transaction:e})}getAttributes(e){return O8(this.state,e)}isActive(e,n){const r=typeof e=="string"?e:null,i=typeof e=="string"?n:e;return P8(this.state,r,i)}getJSON(){return this.state.doc.toJSON()}getHTML(){return xx(this.state.doc.content,this.schema)}getText(e){const{blockSeparator:n=`

`,textSerializers:r={}}=e||{};return _8(this.state.doc,{blockSeparator:n,textSerializers:{...yO(this.schema),...r}})}get isEmpty(){return wp(this.state.doc)}getCharacterCount(){return console.warn('[tiptap warn]: "editor.getCharacterCount()" is deprecated. Please use "editor.storage.characterCount.characters()" instead.'),this.state.doc.content.size-2}destroy(){if(this.emit("destroy"),this.view){const e=this.view.dom;e&&e.editor&&delete e.editor,this.view.destroy()}this.removeAllListeners()}get isDestroyed(){var e;return!(!((e=this.view)===null||e===void 0)&&e.docView)}$node(e,n){var r;return((r=this.$doc)===null||r===void 0?void 0:r.querySelector(e,n))||null}$nodes(e,n){var r;return((r=this.$doc)===null||r===void 0?void 0:r.querySelectorAll(e,n))||null}$pos(e){const n=this.state.doc.resolve(e);return new Zo(n,this)}get $doc(){return this.$pos(0)}}function Tl(t){return new yp({find:t.find,handler:({state:e,range:n,match:r})=>{const i=ue(t.getAttributes,void 0,r);if(i===!1||i===null)return null;const{tr:o}=e,s=r[r.length-1],a=r[0];if(s){const l=a.search(/\S/),c=n.from+a.indexOf(s),u=c+s.length;if(CO(n.from,n.to,e.doc).filter(p=>p.mark.type.excluded.find(y=>y===t.type&&y!==p.mark.type)).filter(p=>p.to>c).length)return null;u<n.to&&o.delete(u,n.to),c>n.from&&o.delete(n.from+l,c);const h=n.from+l+s.length;o.addMark(n.from+l,h,t.type.create(i||{})),o.removeStoredMark(t.type)}}})}function lV(t){return new yp({find:t.find,handler:({state:e,range:n,match:r})=>{const i=ue(t.getAttributes,void 0,r)||{},{tr:o}=e,s=n.from;let a=n.to;const l=t.type.create(i);if(r[1]){const c=r[0].lastIndexOf(r[1]);let u=s+c;u>a?u=a:a=u+r[1].length;const d=r[0][r[0].length-1];o.insertText(d,s+r[0].length-1),o.replaceWith(u,a,l)}else if(r[0]){const c=t.type.isInline?s:s-1;o.insert(c,t.type.create(i)).delete(o.mapping.map(s),o.mapping.map(a))}o.scrollIntoView()}})}function Yy(t){return new yp({find:t.find,handler:({state:e,range:n,match:r})=>{const i=e.doc.resolve(n.from),o=ue(t.getAttributes,void 0,r)||{};if(!i.node(-1).canReplaceWith(i.index(-1),i.indexAfter(-1),t.type))return null;e.tr.delete(n.from,n.to).setBlockType(n.from,n.from,t.type,o)}})}function xu(t){return new yp({find:t.find,handler:({state:e,range:n,match:r,chain:i})=>{const o=ue(t.getAttributes,void 0,r)||{},s=e.tr.delete(n.from,n.to),l=s.doc.resolve(n.from).blockRange(),c=l&&sx(l,t.type,o);if(!c)return null;if(s.wrap(l,c),t.keepMarks&&t.editor){const{selection:d,storedMarks:h}=e,{splittableMarks:p}=t.editor.extensionManager,g=h||d.$to.parentOffset&&d.$from.marks();if(g){const y=g.filter(x=>p.includes(x.type.name));s.ensureMarks(y)}}if(t.keepAttributes){const d=t.type.name==="bulletList"||t.type.name==="orderedList"?"listItem":"taskList";i().updateAttributes(d,o).run()}const u=s.doc.resolve(n.from-1).nodeBefore;u&&u.type===t.type&&Do(s.doc,n.from-1)&&(!t.joinPredicate||t.joinPredicate(r,u))&&s.join(n.from-1)}})}let xr=class Qy{constructor(e={}){this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=ue(J(this,"addOptions",{name:this.name}))),this.storage=ue(J(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new Qy(e)}configure(e={}){const n=this.extend({...this.config,addOptions:()=>vp(this.options,e)});return n.name=this.name,n.parent=this.parent,n}extend(e={}){const n=new Qy(e);return n.parent=this,this.child=n,n.name=e.name?e.name:n.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=ue(J(n,"addOptions",{name:n.name})),n.storage=ue(J(n,"addStorage",{name:n.name,options:n.options})),n}};function _l(t){return new Rz({find:t.find,handler:({state:e,range:n,match:r,pasteEvent:i})=>{const o=ue(t.getAttributes,void 0,r,i);if(o===!1||o===null)return null;const{tr:s}=e,a=r[r.length-1],l=r[0];let c=n.to;if(a){const u=l.search(/\S/),d=n.from+l.indexOf(a),h=d+a.length;if(CO(n.from,n.to,e.doc).filter(g=>g.mark.type.excluded.find(x=>x===t.type&&x!==g.mark.type)).filter(g=>g.to>d).length)return null;h<n.to&&s.delete(h,n.to),d>n.from&&s.delete(n.from+u,d),c=n.from+u+a.length,s.addMark(n.from+u,c,t.type.create(o||{})),s.removeStoredMark(t.type)}}})}function cV(t){return t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}var fn="top",Kn="bottom",qn="right",hn="left",Ex="auto",Yu=[fn,Kn,qn,hn],Rl="start",wu="end",uV="clippingParents",EO="viewport",lc="popper",dV="reference",rS=Yu.reduce(function(t,e){return t.concat([e+"-"+Rl,e+"-"+wu])},[]),TO=[].concat(Yu,[Ex]).reduce(function(t,e){return t.concat([e,e+"-"+Rl,e+"-"+wu])},[]),fV="beforeRead",hV="read",pV="afterRead",mV="beforeMain",gV="main",yV="afterMain",vV="beforeWrite",xV="write",wV="afterWrite",bV=[fV,hV,pV,mV,gV,yV,vV,xV,wV];function Ur(t){return t?(t.nodeName||"").toLowerCase():null}function En(t){if(t==null)return window;if(t.toString()!=="[object Window]"){var e=t.ownerDocument;return e&&e.defaultView||window}return t}function Hs(t){var e=En(t).Element;return t instanceof e||t instanceof Element}function zn(t){var e=En(t).HTMLElement;return t instanceof e||t instanceof HTMLElement}function Tx(t){if(typeof ShadowRoot>"u")return!1;var e=En(t).ShadowRoot;return t instanceof e||t instanceof ShadowRoot}function SV(t){var e=t.state;Object.keys(e.elements).forEach(function(n){var r=e.styles[n]||{},i=e.attributes[n]||{},o=e.elements[n];!zn(o)||!Ur(o)||(Object.assign(o.style,r),Object.keys(i).forEach(function(s){var a=i[s];a===!1?o.removeAttribute(s):o.setAttribute(s,a===!0?"":a)}))})}function CV(t){var e=t.state,n={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,n.popper),e.styles=n,e.elements.arrow&&Object.assign(e.elements.arrow.style,n.arrow),function(){Object.keys(e.elements).forEach(function(r){var i=e.elements[r],o=e.attributes[r]||{},s=Object.keys(e.styles.hasOwnProperty(r)?e.styles[r]:n[r]),a=s.reduce(function(l,c){return l[c]="",l},{});!zn(i)||!Ur(i)||(Object.assign(i.style,a),Object.keys(o).forEach(function(l){i.removeAttribute(l)}))})}}const _O={name:"applyStyles",enabled:!0,phase:"write",fn:SV,effect:CV,requires:["computeStyles"]};function $r(t){return t.split("-")[0]}var Ss=Math.max,vh=Math.min,Ol=Math.round;function Xy(){var t=navigator.userAgentData;return t!=null&&t.brands&&Array.isArray(t.brands)?t.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function RO(){return!/^((?!chrome|android).)*safari/i.test(Xy())}function Pl(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!1);var r=t.getBoundingClientRect(),i=1,o=1;e&&zn(t)&&(i=t.offsetWidth>0&&Ol(r.width)/t.offsetWidth||1,o=t.offsetHeight>0&&Ol(r.height)/t.offsetHeight||1);var s=Hs(t)?En(t):window,a=s.visualViewport,l=!RO()&&n,c=(r.left+(l&&a?a.offsetLeft:0))/i,u=(r.top+(l&&a?a.offsetTop:0))/o,d=r.width/i,h=r.height/o;return{width:d,height:h,top:u,right:c+d,bottom:u+h,left:c,x:c,y:u}}function _x(t){var e=Pl(t),n=t.offsetWidth,r=t.offsetHeight;return Math.abs(e.width-n)<=1&&(n=e.width),Math.abs(e.height-r)<=1&&(r=e.height),{x:t.offsetLeft,y:t.offsetTop,width:n,height:r}}function OO(t,e){var n=e.getRootNode&&e.getRootNode();if(t.contains(e))return!0;if(n&&Tx(n)){var r=e;do{if(r&&t.isSameNode(r))return!0;r=r.parentNode||r.host}while(r)}return!1}function mi(t){return En(t).getComputedStyle(t)}function kV(t){return["table","td","th"].indexOf(Ur(t))>=0}function Fo(t){return((Hs(t)?t.ownerDocument:t.document)||window.document).documentElement}function bp(t){return Ur(t)==="html"?t:t.assignedSlot||t.parentNode||(Tx(t)?t.host:null)||Fo(t)}function iS(t){return!zn(t)||mi(t).position==="fixed"?null:t.offsetParent}function EV(t){var e=/firefox/i.test(Xy()),n=/Trident/i.test(Xy());if(n&&zn(t)){var r=mi(t);if(r.position==="fixed")return null}var i=bp(t);for(Tx(i)&&(i=i.host);zn(i)&&["html","body"].indexOf(Ur(i))<0;){var o=mi(i);if(o.transform!=="none"||o.perspective!=="none"||o.contain==="paint"||["transform","perspective"].indexOf(o.willChange)!==-1||e&&o.willChange==="filter"||e&&o.filter&&o.filter!=="none")return i;i=i.parentNode}return null}function Qu(t){for(var e=En(t),n=iS(t);n&&kV(n)&&mi(n).position==="static";)n=iS(n);return n&&(Ur(n)==="html"||Ur(n)==="body"&&mi(n).position==="static")?e:n||EV(t)||e}function Rx(t){return["top","bottom"].indexOf(t)>=0?"x":"y"}function Dc(t,e,n){return Ss(t,vh(e,n))}function TV(t,e,n){var r=Dc(t,e,n);return r>n?n:r}function PO(){return{top:0,right:0,bottom:0,left:0}}function MO(t){return Object.assign({},PO(),t)}function IO(t,e){return e.reduce(function(n,r){return n[r]=t,n},{})}var _V=function(e,n){return e=typeof e=="function"?e(Object.assign({},n.rects,{placement:n.placement})):e,MO(typeof e!="number"?e:IO(e,Yu))};function RV(t){var e,n=t.state,r=t.name,i=t.options,o=n.elements.arrow,s=n.modifiersData.popperOffsets,a=$r(n.placement),l=Rx(a),c=[hn,qn].indexOf(a)>=0,u=c?"height":"width";if(!(!o||!s)){var d=_V(i.padding,n),h=_x(o),p=l==="y"?fn:hn,g=l==="y"?Kn:qn,y=n.rects.reference[u]+n.rects.reference[l]-s[l]-n.rects.popper[u],x=s[l]-n.rects.reference[l],v=Qu(o),w=v?l==="y"?v.clientHeight||0:v.clientWidth||0:0,b=y/2-x/2,S=d[p],C=w-h[u]-d[g],k=w/2-h[u]/2+b,E=Dc(S,k,C),T=l;n.modifiersData[r]=(e={},e[T]=E,e.centerOffset=E-k,e)}}function OV(t){var e=t.state,n=t.options,r=n.element,i=r===void 0?"[data-popper-arrow]":r;i!=null&&(typeof i=="string"&&(i=e.elements.popper.querySelector(i),!i)||OO(e.elements.popper,i)&&(e.elements.arrow=i))}const PV={name:"arrow",enabled:!0,phase:"main",fn:RV,effect:OV,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Ml(t){return t.split("-")[1]}var MV={top:"auto",right:"auto",bottom:"auto",left:"auto"};function IV(t,e){var n=t.x,r=t.y,i=e.devicePixelRatio||1;return{x:Ol(n*i)/i||0,y:Ol(r*i)/i||0}}function oS(t){var e,n=t.popper,r=t.popperRect,i=t.placement,o=t.variation,s=t.offsets,a=t.position,l=t.gpuAcceleration,c=t.adaptive,u=t.roundOffsets,d=t.isFixed,h=s.x,p=h===void 0?0:h,g=s.y,y=g===void 0?0:g,x=typeof u=="function"?u({x:p,y}):{x:p,y};p=x.x,y=x.y;var v=s.hasOwnProperty("x"),w=s.hasOwnProperty("y"),b=hn,S=fn,C=window;if(c){var k=Qu(n),E="clientHeight",T="clientWidth";if(k===En(n)&&(k=Fo(n),mi(k).position!=="static"&&a==="absolute"&&(E="scrollHeight",T="scrollWidth")),k=k,i===fn||(i===hn||i===qn)&&o===wu){S=Kn;var R=d&&k===C&&C.visualViewport?C.visualViewport.height:k[E];y-=R-r.height,y*=l?1:-1}if(i===hn||(i===fn||i===Kn)&&o===wu){b=qn;var _=d&&k===C&&C.visualViewport?C.visualViewport.width:k[T];p-=_-r.width,p*=l?1:-1}}var A=Object.assign({position:a},c&&MV),L=u===!0?IV({x:p,y},En(n)):{x:p,y};if(p=L.x,y=L.y,l){var N;return Object.assign({},A,(N={},N[S]=w?"0":"",N[b]=v?"0":"",N.transform=(C.devicePixelRatio||1)<=1?"translate("+p+"px, "+y+"px)":"translate3d("+p+"px, "+y+"px, 0)",N))}return Object.assign({},A,(e={},e[S]=w?y+"px":"",e[b]=v?p+"px":"",e.transform="",e))}function AV(t){var e=t.state,n=t.options,r=n.gpuAcceleration,i=r===void 0?!0:r,o=n.adaptive,s=o===void 0?!0:o,a=n.roundOffsets,l=a===void 0?!0:a,c={placement:$r(e.placement),variation:Ml(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:i,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,oS(Object.assign({},c,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:s,roundOffsets:l})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,oS(Object.assign({},c,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const NV={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:AV,data:{}};var Hd={passive:!0};function jV(t){var e=t.state,n=t.instance,r=t.options,i=r.scroll,o=i===void 0?!0:i,s=r.resize,a=s===void 0?!0:s,l=En(e.elements.popper),c=[].concat(e.scrollParents.reference,e.scrollParents.popper);return o&&c.forEach(function(u){u.addEventListener("scroll",n.update,Hd)}),a&&l.addEventListener("resize",n.update,Hd),function(){o&&c.forEach(function(u){u.removeEventListener("scroll",n.update,Hd)}),a&&l.removeEventListener("resize",n.update,Hd)}}const DV={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:jV,data:{}};var LV={left:"right",right:"left",bottom:"top",top:"bottom"};function xf(t){return t.replace(/left|right|bottom|top/g,function(e){return LV[e]})}var $V={start:"end",end:"start"};function sS(t){return t.replace(/start|end/g,function(e){return $V[e]})}function Ox(t){var e=En(t),n=e.pageXOffset,r=e.pageYOffset;return{scrollLeft:n,scrollTop:r}}function Px(t){return Pl(Fo(t)).left+Ox(t).scrollLeft}function FV(t,e){var n=En(t),r=Fo(t),i=n.visualViewport,o=r.clientWidth,s=r.clientHeight,a=0,l=0;if(i){o=i.width,s=i.height;var c=RO();(c||!c&&e==="fixed")&&(a=i.offsetLeft,l=i.offsetTop)}return{width:o,height:s,x:a+Px(t),y:l}}function BV(t){var e,n=Fo(t),r=Ox(t),i=(e=t.ownerDocument)==null?void 0:e.body,o=Ss(n.scrollWidth,n.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),s=Ss(n.scrollHeight,n.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),a=-r.scrollLeft+Px(t),l=-r.scrollTop;return mi(i||n).direction==="rtl"&&(a+=Ss(n.clientWidth,i?i.clientWidth:0)-o),{width:o,height:s,x:a,y:l}}function Mx(t){var e=mi(t),n=e.overflow,r=e.overflowX,i=e.overflowY;return/auto|scroll|overlay|hidden/.test(n+i+r)}function AO(t){return["html","body","#document"].indexOf(Ur(t))>=0?t.ownerDocument.body:zn(t)&&Mx(t)?t:AO(bp(t))}function Lc(t,e){var n;e===void 0&&(e=[]);var r=AO(t),i=r===((n=t.ownerDocument)==null?void 0:n.body),o=En(r),s=i?[o].concat(o.visualViewport||[],Mx(r)?r:[]):r,a=e.concat(s);return i?a:a.concat(Lc(bp(s)))}function Zy(t){return Object.assign({},t,{left:t.x,top:t.y,right:t.x+t.width,bottom:t.y+t.height})}function zV(t,e){var n=Pl(t,!1,e==="fixed");return n.top=n.top+t.clientTop,n.left=n.left+t.clientLeft,n.bottom=n.top+t.clientHeight,n.right=n.left+t.clientWidth,n.width=t.clientWidth,n.height=t.clientHeight,n.x=n.left,n.y=n.top,n}function aS(t,e,n){return e===EO?Zy(FV(t,n)):Hs(e)?zV(e,n):Zy(BV(Fo(t)))}function VV(t){var e=Lc(bp(t)),n=["absolute","fixed"].indexOf(mi(t).position)>=0,r=n&&zn(t)?Qu(t):t;return Hs(r)?e.filter(function(i){return Hs(i)&&OO(i,r)&&Ur(i)!=="body"}):[]}function UV(t,e,n,r){var i=e==="clippingParents"?VV(t):[].concat(e),o=[].concat(i,[n]),s=o[0],a=o.reduce(function(l,c){var u=aS(t,c,r);return l.top=Ss(u.top,l.top),l.right=vh(u.right,l.right),l.bottom=vh(u.bottom,l.bottom),l.left=Ss(u.left,l.left),l},aS(t,s,r));return a.width=a.right-a.left,a.height=a.bottom-a.top,a.x=a.left,a.y=a.top,a}function NO(t){var e=t.reference,n=t.element,r=t.placement,i=r?$r(r):null,o=r?Ml(r):null,s=e.x+e.width/2-n.width/2,a=e.y+e.height/2-n.height/2,l;switch(i){case fn:l={x:s,y:e.y-n.height};break;case Kn:l={x:s,y:e.y+e.height};break;case qn:l={x:e.x+e.width,y:a};break;case hn:l={x:e.x-n.width,y:a};break;default:l={x:e.x,y:e.y}}var c=i?Rx(i):null;if(c!=null){var u=c==="y"?"height":"width";switch(o){case Rl:l[c]=l[c]-(e[u]/2-n[u]/2);break;case wu:l[c]=l[c]+(e[u]/2-n[u]/2);break}}return l}function bu(t,e){e===void 0&&(e={});var n=e,r=n.placement,i=r===void 0?t.placement:r,o=n.strategy,s=o===void 0?t.strategy:o,a=n.boundary,l=a===void 0?uV:a,c=n.rootBoundary,u=c===void 0?EO:c,d=n.elementContext,h=d===void 0?lc:d,p=n.altBoundary,g=p===void 0?!1:p,y=n.padding,x=y===void 0?0:y,v=MO(typeof x!="number"?x:IO(x,Yu)),w=h===lc?dV:lc,b=t.rects.popper,S=t.elements[g?w:h],C=UV(Hs(S)?S:S.contextElement||Fo(t.elements.popper),l,u,s),k=Pl(t.elements.reference),E=NO({reference:k,element:b,strategy:"absolute",placement:i}),T=Zy(Object.assign({},b,E)),R=h===lc?T:k,_={top:C.top-R.top+v.top,bottom:R.bottom-C.bottom+v.bottom,left:C.left-R.left+v.left,right:R.right-C.right+v.right},A=t.modifiersData.offset;if(h===lc&&A){var L=A[i];Object.keys(_).forEach(function(N){var M=[qn,Kn].indexOf(N)>=0?1:-1,z=[fn,Kn].indexOf(N)>=0?"y":"x";_[N]+=L[z]*M})}return _}function HV(t,e){e===void 0&&(e={});var n=e,r=n.placement,i=n.boundary,o=n.rootBoundary,s=n.padding,a=n.flipVariations,l=n.allowedAutoPlacements,c=l===void 0?TO:l,u=Ml(r),d=u?a?rS:rS.filter(function(g){return Ml(g)===u}):Yu,h=d.filter(function(g){return c.indexOf(g)>=0});h.length===0&&(h=d);var p=h.reduce(function(g,y){return g[y]=bu(t,{placement:y,boundary:i,rootBoundary:o,padding:s})[$r(y)],g},{});return Object.keys(p).sort(function(g,y){return p[g]-p[y]})}function WV(t){if($r(t)===Ex)return[];var e=xf(t);return[sS(t),e,sS(e)]}function KV(t){var e=t.state,n=t.options,r=t.name;if(!e.modifiersData[r]._skip){for(var i=n.mainAxis,o=i===void 0?!0:i,s=n.altAxis,a=s===void 0?!0:s,l=n.fallbackPlacements,c=n.padding,u=n.boundary,d=n.rootBoundary,h=n.altBoundary,p=n.flipVariations,g=p===void 0?!0:p,y=n.allowedAutoPlacements,x=e.options.placement,v=$r(x),w=v===x,b=l||(w||!g?[xf(x)]:WV(x)),S=[x].concat(b).reduce(function(pe,ee){return pe.concat($r(ee)===Ex?HV(e,{placement:ee,boundary:u,rootBoundary:d,padding:c,flipVariations:g,allowedAutoPlacements:y}):ee)},[]),C=e.rects.reference,k=e.rects.popper,E=new Map,T=!0,R=S[0],_=0;_<S.length;_++){var A=S[_],L=$r(A),N=Ml(A)===Rl,M=[fn,Kn].indexOf(L)>=0,z=M?"width":"height",$=bu(e,{placement:A,boundary:u,rootBoundary:d,altBoundary:h,padding:c}),V=M?N?qn:hn:N?Kn:fn;C[z]>k[z]&&(V=xf(V));var I=xf(V),P=[];if(o&&P.push($[L]<=0),a&&P.push($[V]<=0,$[I]<=0),P.every(function(pe){return pe})){R=A,T=!1;break}E.set(A,P)}if(T)for(var D=g?3:1,H=function(ee){var Q=S.find(function(U){var ae=E.get(U);if(ae)return ae.slice(0,ee).every(function(ve){return ve})});if(Q)return R=Q,"break"},Z=D;Z>0;Z--){var he=H(Z);if(he==="break")break}e.placement!==R&&(e.modifiersData[r]._skip=!0,e.placement=R,e.reset=!0)}}const qV={name:"flip",enabled:!0,phase:"main",fn:KV,requiresIfExists:["offset"],data:{_skip:!1}};function lS(t,e,n){return n===void 0&&(n={x:0,y:0}),{top:t.top-e.height-n.y,right:t.right-e.width+n.x,bottom:t.bottom-e.height+n.y,left:t.left-e.width-n.x}}function cS(t){return[fn,qn,Kn,hn].some(function(e){return t[e]>=0})}function GV(t){var e=t.state,n=t.name,r=e.rects.reference,i=e.rects.popper,o=e.modifiersData.preventOverflow,s=bu(e,{elementContext:"reference"}),a=bu(e,{altBoundary:!0}),l=lS(s,r),c=lS(a,i,o),u=cS(l),d=cS(c);e.modifiersData[n]={referenceClippingOffsets:l,popperEscapeOffsets:c,isReferenceHidden:u,hasPopperEscaped:d},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":u,"data-popper-escaped":d})}const JV={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:GV};function YV(t,e,n){var r=$r(t),i=[hn,fn].indexOf(r)>=0?-1:1,o=typeof n=="function"?n(Object.assign({},e,{placement:t})):n,s=o[0],a=o[1];return s=s||0,a=(a||0)*i,[hn,qn].indexOf(r)>=0?{x:a,y:s}:{x:s,y:a}}function QV(t){var e=t.state,n=t.options,r=t.name,i=n.offset,o=i===void 0?[0,0]:i,s=TO.reduce(function(u,d){return u[d]=YV(d,e.rects,o),u},{}),a=s[e.placement],l=a.x,c=a.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=l,e.modifiersData.popperOffsets.y+=c),e.modifiersData[r]=s}const XV={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:QV};function ZV(t){var e=t.state,n=t.name;e.modifiersData[n]=NO({reference:e.rects.reference,element:e.rects.popper,strategy:"absolute",placement:e.placement})}const eU={name:"popperOffsets",enabled:!0,phase:"read",fn:ZV,data:{}};function tU(t){return t==="x"?"y":"x"}function nU(t){var e=t.state,n=t.options,r=t.name,i=n.mainAxis,o=i===void 0?!0:i,s=n.altAxis,a=s===void 0?!1:s,l=n.boundary,c=n.rootBoundary,u=n.altBoundary,d=n.padding,h=n.tether,p=h===void 0?!0:h,g=n.tetherOffset,y=g===void 0?0:g,x=bu(e,{boundary:l,rootBoundary:c,padding:d,altBoundary:u}),v=$r(e.placement),w=Ml(e.placement),b=!w,S=Rx(v),C=tU(S),k=e.modifiersData.popperOffsets,E=e.rects.reference,T=e.rects.popper,R=typeof y=="function"?y(Object.assign({},e.rects,{placement:e.placement})):y,_=typeof R=="number"?{mainAxis:R,altAxis:R}:Object.assign({mainAxis:0,altAxis:0},R),A=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,L={x:0,y:0};if(k){if(o){var N,M=S==="y"?fn:hn,z=S==="y"?Kn:qn,$=S==="y"?"height":"width",V=k[S],I=V+x[M],P=V-x[z],D=p?-T[$]/2:0,H=w===Rl?E[$]:T[$],Z=w===Rl?-T[$]:-E[$],he=e.elements.arrow,pe=p&&he?_x(he):{width:0,height:0},ee=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:PO(),Q=ee[M],U=ee[z],ae=Dc(0,E[$],pe[$]),ve=b?E[$]/2-D-ae-Q-_.mainAxis:H-ae-Q-_.mainAxis,de=b?-E[$]/2+D+ae+U+_.mainAxis:Z+ae+U+_.mainAxis,me=e.elements.arrow&&Qu(e.elements.arrow),xe=me?S==="y"?me.clientTop||0:me.clientLeft||0:0,tt=(N=A==null?void 0:A[S])!=null?N:0,jt=V+ve-tt-xe,wr=V+de-tt,Jn=Dc(p?vh(I,jt):I,V,p?Ss(P,wr):P);k[S]=Jn,L[S]=Jn-V}if(a){var Yn,ea=S==="x"?fn:hn,Kr=S==="x"?Kn:qn,qr=k[C],xi=C==="y"?"height":"width",Jl=qr+x[ea],Uo=qr-x[Kr],Yl=[fn,hn].indexOf(v)!==-1,td=(Yn=A==null?void 0:A[C])!=null?Yn:0,nd=Yl?Jl:qr-E[xi]-T[xi]-td+_.altAxis,rd=Yl?qr+E[xi]+T[xi]-td-_.altAxis:Uo,id=p&&Yl?TV(nd,qr,rd):Dc(p?nd:Jl,qr,p?rd:Uo);k[C]=id,L[C]=id-qr}e.modifiersData[r]=L}}const rU={name:"preventOverflow",enabled:!0,phase:"main",fn:nU,requiresIfExists:["offset"]};function iU(t){return{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}}function oU(t){return t===En(t)||!zn(t)?Ox(t):iU(t)}function sU(t){var e=t.getBoundingClientRect(),n=Ol(e.width)/t.offsetWidth||1,r=Ol(e.height)/t.offsetHeight||1;return n!==1||r!==1}function aU(t,e,n){n===void 0&&(n=!1);var r=zn(e),i=zn(e)&&sU(e),o=Fo(e),s=Pl(t,i,n),a={scrollLeft:0,scrollTop:0},l={x:0,y:0};return(r||!r&&!n)&&((Ur(e)!=="body"||Mx(o))&&(a=oU(e)),zn(e)?(l=Pl(e,!0),l.x+=e.clientLeft,l.y+=e.clientTop):o&&(l.x=Px(o))),{x:s.left+a.scrollLeft-l.x,y:s.top+a.scrollTop-l.y,width:s.width,height:s.height}}function lU(t){var e=new Map,n=new Set,r=[];t.forEach(function(o){e.set(o.name,o)});function i(o){n.add(o.name);var s=[].concat(o.requires||[],o.requiresIfExists||[]);s.forEach(function(a){if(!n.has(a)){var l=e.get(a);l&&i(l)}}),r.push(o)}return t.forEach(function(o){n.has(o.name)||i(o)}),r}function cU(t){var e=lU(t);return bV.reduce(function(n,r){return n.concat(e.filter(function(i){return i.phase===r}))},[])}function uU(t){var e;return function(){return e||(e=new Promise(function(n){Promise.resolve().then(function(){e=void 0,n(t())})})),e}}function dU(t){var e=t.reduce(function(n,r){var i=n[r.name];return n[r.name]=i?Object.assign({},i,r,{options:Object.assign({},i.options,r.options),data:Object.assign({},i.data,r.data)}):r,n},{});return Object.keys(e).map(function(n){return e[n]})}var uS={placement:"bottom",modifiers:[],strategy:"absolute"};function dS(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return!e.some(function(r){return!(r&&typeof r.getBoundingClientRect=="function")})}function fU(t){t===void 0&&(t={});var e=t,n=e.defaultModifiers,r=n===void 0?[]:n,i=e.defaultOptions,o=i===void 0?uS:i;return function(a,l,c){c===void 0&&(c=o);var u={placement:"bottom",orderedModifiers:[],options:Object.assign({},uS,o),modifiersData:{},elements:{reference:a,popper:l},attributes:{},styles:{}},d=[],h=!1,p={state:u,setOptions:function(v){var w=typeof v=="function"?v(u.options):v;y(),u.options=Object.assign({},o,u.options,w),u.scrollParents={reference:Hs(a)?Lc(a):a.contextElement?Lc(a.contextElement):[],popper:Lc(l)};var b=cU(dU([].concat(r,u.options.modifiers)));return u.orderedModifiers=b.filter(function(S){return S.enabled}),g(),p.update()},forceUpdate:function(){if(!h){var v=u.elements,w=v.reference,b=v.popper;if(dS(w,b)){u.rects={reference:aU(w,Qu(b),u.options.strategy==="fixed"),popper:_x(b)},u.reset=!1,u.placement=u.options.placement,u.orderedModifiers.forEach(function(_){return u.modifiersData[_.name]=Object.assign({},_.data)});for(var S=0;S<u.orderedModifiers.length;S++){if(u.reset===!0){u.reset=!1,S=-1;continue}var C=u.orderedModifiers[S],k=C.fn,E=C.options,T=E===void 0?{}:E,R=C.name;typeof k=="function"&&(u=k({state:u,options:T,name:R,instance:p})||u)}}}},update:uU(function(){return new Promise(function(x){p.forceUpdate(),x(u)})}),destroy:function(){y(),h=!0}};if(!dS(a,l))return p;p.setOptions(c).then(function(x){!h&&c.onFirstUpdate&&c.onFirstUpdate(x)});function g(){u.orderedModifiers.forEach(function(x){var v=x.name,w=x.options,b=w===void 0?{}:w,S=x.effect;if(typeof S=="function"){var C=S({state:u,name:v,instance:p,options:b}),k=function(){};d.push(C||k)}})}function y(){d.forEach(function(x){return x()}),d=[]}return p}}var hU=[DV,eU,NV,_O,XV,qV,rU,PV,JV],pU=fU({defaultModifiers:hU}),mU="tippy-box",jO="tippy-content",gU="tippy-backdrop",DO="tippy-arrow",LO="tippy-svg-arrow",Yo={passive:!0,capture:!0},$O=function(){return document.body};function Um(t,e,n){if(Array.isArray(t)){var r=t[e];return r??(Array.isArray(n)?n[e]:n)}return t}function Ix(t,e){var n={}.toString.call(t);return n.indexOf("[object")===0&&n.indexOf(e+"]")>-1}function FO(t,e){return typeof t=="function"?t.apply(void 0,e):t}function fS(t,e){if(e===0)return t;var n;return function(r){clearTimeout(n),n=setTimeout(function(){t(r)},e)}}function yU(t){return t.split(/\s+/).filter(Boolean)}function va(t){return[].concat(t)}function hS(t,e){t.indexOf(e)===-1&&t.push(e)}function vU(t){return t.filter(function(e,n){return t.indexOf(e)===n})}function xU(t){return t.split("-")[0]}function xh(t){return[].slice.call(t)}function pS(t){return Object.keys(t).reduce(function(e,n){return t[n]!==void 0&&(e[n]=t[n]),e},{})}function $c(){return document.createElement("div")}function Sp(t){return["Element","Fragment"].some(function(e){return Ix(t,e)})}function wU(t){return Ix(t,"NodeList")}function bU(t){return Ix(t,"MouseEvent")}function SU(t){return!!(t&&t._tippy&&t._tippy.reference===t)}function CU(t){return Sp(t)?[t]:wU(t)?xh(t):Array.isArray(t)?t:xh(document.querySelectorAll(t))}function Hm(t,e){t.forEach(function(n){n&&(n.style.transitionDuration=e+"ms")})}function mS(t,e){t.forEach(function(n){n&&n.setAttribute("data-state",e)})}function kU(t){var e,n=va(t),r=n[0];return r!=null&&(e=r.ownerDocument)!=null&&e.body?r.ownerDocument:document}function EU(t,e){var n=e.clientX,r=e.clientY;return t.every(function(i){var o=i.popperRect,s=i.popperState,a=i.props,l=a.interactiveBorder,c=xU(s.placement),u=s.modifiersData.offset;if(!u)return!0;var d=c==="bottom"?u.top.y:0,h=c==="top"?u.bottom.y:0,p=c==="right"?u.left.x:0,g=c==="left"?u.right.x:0,y=o.top-r+d>l,x=r-o.bottom-h>l,v=o.left-n+p>l,w=n-o.right-g>l;return y||x||v||w})}function Wm(t,e,n){var r=e+"EventListener";["transitionend","webkitTransitionEnd"].forEach(function(i){t[r](i,n)})}function gS(t,e){for(var n=e;n;){var r;if(t.contains(n))return!0;n=n.getRootNode==null||(r=n.getRootNode())==null?void 0:r.host}return!1}var Or={isTouch:!1},yS=0;function TU(){Or.isTouch||(Or.isTouch=!0,window.performance&&document.addEventListener("mousemove",BO))}function BO(){var t=performance.now();t-yS<20&&(Or.isTouch=!1,document.removeEventListener("mousemove",BO)),yS=t}function _U(){var t=document.activeElement;if(SU(t)){var e=t._tippy;t.blur&&!e.state.isVisible&&t.blur()}}function RU(){document.addEventListener("touchstart",TU,Yo),window.addEventListener("blur",_U)}var OU=typeof window<"u"&&typeof document<"u",PU=OU?!!window.msCrypto:!1,MU={animateFill:!1,followCursor:!1,inlinePositioning:!1,sticky:!1},IU={allowHTML:!1,animation:"fade",arrow:!0,content:"",inertia:!1,maxWidth:350,role:"tooltip",theme:"",zIndex:9999},ar=Object.assign({appendTo:$O,aria:{content:"auto",expanded:"auto"},delay:0,duration:[300,250],getReferenceClientRect:null,hideOnClick:!0,ignoreAttributes:!1,interactive:!1,interactiveBorder:2,interactiveDebounce:0,moveTransition:"",offset:[0,10],onAfterUpdate:function(){},onBeforeUpdate:function(){},onCreate:function(){},onDestroy:function(){},onHidden:function(){},onHide:function(){},onMount:function(){},onShow:function(){},onShown:function(){},onTrigger:function(){},onUntrigger:function(){},onClickOutside:function(){},placement:"top",plugins:[],popperOptions:{},render:null,showOnCreate:!1,touch:!0,trigger:"mouseenter focus",triggerTarget:null},MU,IU),AU=Object.keys(ar),NU=function(e){var n=Object.keys(e);n.forEach(function(r){ar[r]=e[r]})};function zO(t){var e=t.plugins||[],n=e.reduce(function(r,i){var o=i.name,s=i.defaultValue;if(o){var a;r[o]=t[o]!==void 0?t[o]:(a=ar[o])!=null?a:s}return r},{});return Object.assign({},t,n)}function jU(t,e){var n=e?Object.keys(zO(Object.assign({},ar,{plugins:e}))):AU,r=n.reduce(function(i,o){var s=(t.getAttribute("data-tippy-"+o)||"").trim();if(!s)return i;if(o==="content")i[o]=s;else try{i[o]=JSON.parse(s)}catch{i[o]=s}return i},{});return r}function vS(t,e){var n=Object.assign({},e,{content:FO(e.content,[t])},e.ignoreAttributes?{}:jU(t,e.plugins));return n.aria=Object.assign({},ar.aria,n.aria),n.aria={expanded:n.aria.expanded==="auto"?e.interactive:n.aria.expanded,content:n.aria.content==="auto"?e.interactive?null:"describedby":n.aria.content},n}var DU=function(){return"innerHTML"};function ev(t,e){t[DU()]=e}function xS(t){var e=$c();return t===!0?e.className=DO:(e.className=LO,Sp(t)?e.appendChild(t):ev(e,t)),e}function wS(t,e){Sp(e.content)?(ev(t,""),t.appendChild(e.content)):typeof e.content!="function"&&(e.allowHTML?ev(t,e.content):t.textContent=e.content)}function tv(t){var e=t.firstElementChild,n=xh(e.children);return{box:e,content:n.find(function(r){return r.classList.contains(jO)}),arrow:n.find(function(r){return r.classList.contains(DO)||r.classList.contains(LO)}),backdrop:n.find(function(r){return r.classList.contains(gU)})}}function VO(t){var e=$c(),n=$c();n.className=mU,n.setAttribute("data-state","hidden"),n.setAttribute("tabindex","-1");var r=$c();r.className=jO,r.setAttribute("data-state","hidden"),wS(r,t.props),e.appendChild(n),n.appendChild(r),i(t.props,t.props);function i(o,s){var a=tv(e),l=a.box,c=a.content,u=a.arrow;s.theme?l.setAttribute("data-theme",s.theme):l.removeAttribute("data-theme"),typeof s.animation=="string"?l.setAttribute("data-animation",s.animation):l.removeAttribute("data-animation"),s.inertia?l.setAttribute("data-inertia",""):l.removeAttribute("data-inertia"),l.style.maxWidth=typeof s.maxWidth=="number"?s.maxWidth+"px":s.maxWidth,s.role?l.setAttribute("role",s.role):l.removeAttribute("role"),(o.content!==s.content||o.allowHTML!==s.allowHTML)&&wS(c,t.props),s.arrow?u?o.arrow!==s.arrow&&(l.removeChild(u),l.appendChild(xS(s.arrow))):l.appendChild(xS(s.arrow)):u&&l.removeChild(u)}return{popper:e,onUpdate:i}}VO.$$tippy=!0;var LU=1,Wd=[],Km=[];function $U(t,e){var n=vS(t,Object.assign({},ar,zO(pS(e)))),r,i,o,s=!1,a=!1,l=!1,c=!1,u,d,h,p=[],g=fS(jt,n.interactiveDebounce),y,x=LU++,v=null,w=vU(n.plugins),b={isEnabled:!0,isVisible:!1,isDestroyed:!1,isMounted:!1,isShown:!1},S={id:x,reference:t,popper:$c(),popperInstance:v,props:n,state:b,plugins:w,clearDelayTimeouts:nd,setProps:rd,setContent:id,show:aM,hide:lM,hideWithInteractivity:cM,enable:Yl,disable:td,unmount:uM,destroy:dM};if(!n.render)return S;var C=n.render(S),k=C.popper,E=C.onUpdate;k.setAttribute("data-tippy-root",""),k.id="tippy-"+S.id,S.popper=k,t._tippy=S,k._tippy=S;var T=w.map(function(j){return j.fn(S)}),R=t.hasAttribute("aria-expanded");return me(),D(),V(),I("onCreate",[S]),n.showOnCreate&&Jl(),k.addEventListener("mouseenter",function(){S.props.interactive&&S.state.isVisible&&S.clearDelayTimeouts()}),k.addEventListener("mouseleave",function(){S.props.interactive&&S.props.trigger.indexOf("mouseenter")>=0&&M().addEventListener("mousemove",g)}),S;function _(){var j=S.props.touch;return Array.isArray(j)?j:[j,0]}function A(){return _()[0]==="hold"}function L(){var j;return!!((j=S.props.render)!=null&&j.$$tippy)}function N(){return y||t}function M(){var j=N().parentNode;return j?kU(j):document}function z(){return tv(k)}function $(j){return S.state.isMounted&&!S.state.isVisible||Or.isTouch||u&&u.type==="focus"?0:Um(S.props.delay,j?0:1,ar.delay)}function V(j){j===void 0&&(j=!1),k.style.pointerEvents=S.props.interactive&&!j?"":"none",k.style.zIndex=""+S.props.zIndex}function I(j,X,re){if(re===void 0&&(re=!0),T.forEach(function(we){we[j]&&we[j].apply(we,X)}),re){var Ce;(Ce=S.props)[j].apply(Ce,X)}}function P(){var j=S.props.aria;if(j.content){var X="aria-"+j.content,re=k.id,Ce=va(S.props.triggerTarget||t);Ce.forEach(function(we){var Dt=we.getAttribute(X);if(S.state.isVisible)we.setAttribute(X,Dt?Dt+" "+re:re);else{var On=Dt&&Dt.replace(re,"").trim();On?we.setAttribute(X,On):we.removeAttribute(X)}})}}function D(){if(!(R||!S.props.aria.expanded)){var j=va(S.props.triggerTarget||t);j.forEach(function(X){S.props.interactive?X.setAttribute("aria-expanded",S.state.isVisible&&X===N()?"true":"false"):X.removeAttribute("aria-expanded")})}}function H(){M().removeEventListener("mousemove",g),Wd=Wd.filter(function(j){return j!==g})}function Z(j){if(!(Or.isTouch&&(l||j.type==="mousedown"))){var X=j.composedPath&&j.composedPath()[0]||j.target;if(!(S.props.interactive&&gS(k,X))){if(va(S.props.triggerTarget||t).some(function(re){return gS(re,X)})){if(Or.isTouch||S.state.isVisible&&S.props.trigger.indexOf("click")>=0)return}else I("onClickOutside",[S,j]);S.props.hideOnClick===!0&&(S.clearDelayTimeouts(),S.hide(),a=!0,setTimeout(function(){a=!1}),S.state.isMounted||Q())}}}function he(){l=!0}function pe(){l=!1}function ee(){var j=M();j.addEventListener("mousedown",Z,!0),j.addEventListener("touchend",Z,Yo),j.addEventListener("touchstart",pe,Yo),j.addEventListener("touchmove",he,Yo)}function Q(){var j=M();j.removeEventListener("mousedown",Z,!0),j.removeEventListener("touchend",Z,Yo),j.removeEventListener("touchstart",pe,Yo),j.removeEventListener("touchmove",he,Yo)}function U(j,X){ve(j,function(){!S.state.isVisible&&k.parentNode&&k.parentNode.contains(k)&&X()})}function ae(j,X){ve(j,X)}function ve(j,X){var re=z().box;function Ce(we){we.target===re&&(Wm(re,"remove",Ce),X())}if(j===0)return X();Wm(re,"remove",d),Wm(re,"add",Ce),d=Ce}function de(j,X,re){re===void 0&&(re=!1);var Ce=va(S.props.triggerTarget||t);Ce.forEach(function(we){we.addEventListener(j,X,re),p.push({node:we,eventType:j,handler:X,options:re})})}function me(){A()&&(de("touchstart",tt,{passive:!0}),de("touchend",wr,{passive:!0})),yU(S.props.trigger).forEach(function(j){if(j!=="manual")switch(de(j,tt),j){case"mouseenter":de("mouseleave",wr);break;case"focus":de(PU?"focusout":"blur",Jn);break;case"focusin":de("focusout",Jn);break}})}function xe(){p.forEach(function(j){var X=j.node,re=j.eventType,Ce=j.handler,we=j.options;X.removeEventListener(re,Ce,we)}),p=[]}function tt(j){var X,re=!1;if(!(!S.state.isEnabled||Yn(j)||a)){var Ce=((X=u)==null?void 0:X.type)==="focus";u=j,y=j.currentTarget,D(),!S.state.isVisible&&bU(j)&&Wd.forEach(function(we){return we(j)}),j.type==="click"&&(S.props.trigger.indexOf("mouseenter")<0||s)&&S.props.hideOnClick!==!1&&S.state.isVisible?re=!0:Jl(j),j.type==="click"&&(s=!re),re&&!Ce&&Uo(j)}}function jt(j){var X=j.target,re=N().contains(X)||k.contains(X);if(!(j.type==="mousemove"&&re)){var Ce=xi().concat(k).map(function(we){var Dt,On=we._tippy,ta=(Dt=On.popperInstance)==null?void 0:Dt.state;return ta?{popperRect:we.getBoundingClientRect(),popperState:ta,props:n}:null}).filter(Boolean);EU(Ce,j)&&(H(),Uo(j))}}function wr(j){var X=Yn(j)||S.props.trigger.indexOf("click")>=0&&s;if(!X){if(S.props.interactive){S.hideWithInteractivity(j);return}Uo(j)}}function Jn(j){S.props.trigger.indexOf("focusin")<0&&j.target!==N()||S.props.interactive&&j.relatedTarget&&k.contains(j.relatedTarget)||Uo(j)}function Yn(j){return Or.isTouch?A()!==j.type.indexOf("touch")>=0:!1}function ea(){Kr();var j=S.props,X=j.popperOptions,re=j.placement,Ce=j.offset,we=j.getReferenceClientRect,Dt=j.moveTransition,On=L()?tv(k).arrow:null,ta=we?{getBoundingClientRect:we,contextElement:we.contextElement||N()}:t,Ux={name:"$$tippy",enabled:!0,phase:"beforeWrite",requires:["computeStyles"],fn:function(od){var na=od.state;if(L()){var fM=z(),Ap=fM.box;["placement","reference-hidden","escaped"].forEach(function(sd){sd==="placement"?Ap.setAttribute("data-placement",na.placement):na.attributes.popper["data-popper-"+sd]?Ap.setAttribute("data-"+sd,""):Ap.removeAttribute("data-"+sd)}),na.attributes.popper={}}}},Ho=[{name:"offset",options:{offset:Ce}},{name:"preventOverflow",options:{padding:{top:2,bottom:2,left:5,right:5}}},{name:"flip",options:{padding:5}},{name:"computeStyles",options:{adaptive:!Dt}},Ux];L()&&On&&Ho.push({name:"arrow",options:{element:On,padding:3}}),Ho.push.apply(Ho,(X==null?void 0:X.modifiers)||[]),S.popperInstance=pU(ta,k,Object.assign({},X,{placement:re,onFirstUpdate:h,modifiers:Ho}))}function Kr(){S.popperInstance&&(S.popperInstance.destroy(),S.popperInstance=null)}function qr(){var j=S.props.appendTo,X,re=N();S.props.interactive&&j===$O||j==="parent"?X=re.parentNode:X=FO(j,[re]),X.contains(k)||X.appendChild(k),S.state.isMounted=!0,ea()}function xi(){return xh(k.querySelectorAll("[data-tippy-root]"))}function Jl(j){S.clearDelayTimeouts(),j&&I("onTrigger",[S,j]),ee();var X=$(!0),re=_(),Ce=re[0],we=re[1];Or.isTouch&&Ce==="hold"&&we&&(X=we),X?r=setTimeout(function(){S.show()},X):S.show()}function Uo(j){if(S.clearDelayTimeouts(),I("onUntrigger",[S,j]),!S.state.isVisible){Q();return}if(!(S.props.trigger.indexOf("mouseenter")>=0&&S.props.trigger.indexOf("click")>=0&&["mouseleave","mousemove"].indexOf(j.type)>=0&&s)){var X=$(!1);X?i=setTimeout(function(){S.state.isVisible&&S.hide()},X):o=requestAnimationFrame(function(){S.hide()})}}function Yl(){S.state.isEnabled=!0}function td(){S.hide(),S.state.isEnabled=!1}function nd(){clearTimeout(r),clearTimeout(i),cancelAnimationFrame(o)}function rd(j){if(!S.state.isDestroyed){I("onBeforeUpdate",[S,j]),xe();var X=S.props,re=vS(t,Object.assign({},X,pS(j),{ignoreAttributes:!0}));S.props=re,me(),X.interactiveDebounce!==re.interactiveDebounce&&(H(),g=fS(jt,re.interactiveDebounce)),X.triggerTarget&&!re.triggerTarget?va(X.triggerTarget).forEach(function(Ce){Ce.removeAttribute("aria-expanded")}):re.triggerTarget&&t.removeAttribute("aria-expanded"),D(),V(),E&&E(X,re),S.popperInstance&&(ea(),xi().forEach(function(Ce){requestAnimationFrame(Ce._tippy.popperInstance.forceUpdate)})),I("onAfterUpdate",[S,j])}}function id(j){S.setProps({content:j})}function aM(){var j=S.state.isVisible,X=S.state.isDestroyed,re=!S.state.isEnabled,Ce=Or.isTouch&&!S.props.touch,we=Um(S.props.duration,0,ar.duration);if(!(j||X||re||Ce)&&!N().hasAttribute("disabled")&&(I("onShow",[S],!1),S.props.onShow(S)!==!1)){if(S.state.isVisible=!0,L()&&(k.style.visibility="visible"),V(),ee(),S.state.isMounted||(k.style.transition="none"),L()){var Dt=z(),On=Dt.box,ta=Dt.content;Hm([On,ta],0)}h=function(){var Ho;if(!(!S.state.isVisible||c)){if(c=!0,k.offsetHeight,k.style.transition=S.props.moveTransition,L()&&S.props.animation){var Ip=z(),od=Ip.box,na=Ip.content;Hm([od,na],we),mS([od,na],"visible")}P(),D(),hS(Km,S),(Ho=S.popperInstance)==null||Ho.forceUpdate(),I("onMount",[S]),S.props.animation&&L()&&ae(we,function(){S.state.isShown=!0,I("onShown",[S])})}},qr()}}function lM(){var j=!S.state.isVisible,X=S.state.isDestroyed,re=!S.state.isEnabled,Ce=Um(S.props.duration,1,ar.duration);if(!(j||X||re)&&(I("onHide",[S],!1),S.props.onHide(S)!==!1)){if(S.state.isVisible=!1,S.state.isShown=!1,c=!1,s=!1,L()&&(k.style.visibility="hidden"),H(),Q(),V(!0),L()){var we=z(),Dt=we.box,On=we.content;S.props.animation&&(Hm([Dt,On],Ce),mS([Dt,On],"hidden"))}P(),D(),S.props.animation?L()&&U(Ce,S.unmount):S.unmount()}}function cM(j){M().addEventListener("mousemove",g),hS(Wd,g),g(j)}function uM(){S.state.isVisible&&S.hide(),S.state.isMounted&&(Kr(),xi().forEach(function(j){j._tippy.unmount()}),k.parentNode&&k.parentNode.removeChild(k),Km=Km.filter(function(j){return j!==S}),S.state.isMounted=!1,I("onHidden",[S]))}function dM(){S.state.isDestroyed||(S.clearDelayTimeouts(),S.unmount(),xe(),delete t._tippy,S.state.isDestroyed=!0,I("onDestroy",[S]))}}function Xu(t,e){e===void 0&&(e={});var n=ar.plugins.concat(e.plugins||[]);RU();var r=Object.assign({},e,{plugins:n}),i=CU(t),o=i.reduce(function(s,a){var l=a&&$U(a,r);return l&&s.push(l),s},[]);return Sp(t)?o[0]:o}Xu.defaultProps=ar;Xu.setDefaultProps=NU;Xu.currentInput=Or;Object.assign({},_O,{effect:function(e){var n=e.state,r={popper:{position:n.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};Object.assign(n.elements.popper.style,r.popper),n.styles=r,n.elements.arrow&&Object.assign(n.elements.arrow.style,r.arrow)}});Xu.setDefaultProps({render:VO});class FU{constructor({editor:e,element:n,view:r,tippyOptions:i={},updateDelay:o=250,shouldShow:s}){this.preventHide=!1,this.shouldShow=({view:a,state:l,from:c,to:u})=>{const{doc:d,selection:h}=l,{empty:p}=h,g=!d.textBetween(c,u).length&&Sx(l.selection),y=this.element.contains(document.activeElement);return!(!(a.hasFocus()||y)||p||g||!this.editor.isEditable)},this.mousedownHandler=()=>{this.preventHide=!0},this.dragstartHandler=()=>{this.hide()},this.focusHandler=()=>{setTimeout(()=>this.update(this.editor.view))},this.blurHandler=({event:a})=>{var l;if(this.preventHide){this.preventHide=!1;return}a!=null&&a.relatedTarget&&(!((l=this.element.parentNode)===null||l===void 0)&&l.contains(a.relatedTarget))||(a==null?void 0:a.relatedTarget)!==this.editor.view.dom&&this.hide()},this.tippyBlurHandler=a=>{this.blurHandler({event:a})},this.handleDebouncedUpdate=(a,l)=>{const c=!(l!=null&&l.selection.eq(a.state.selection)),u=!(l!=null&&l.doc.eq(a.state.doc));!c&&!u||(this.updateDebounceTimer&&clearTimeout(this.updateDebounceTimer),this.updateDebounceTimer=window.setTimeout(()=>{this.updateHandler(a,c,u,l)},this.updateDelay))},this.updateHandler=(a,l,c,u)=>{var d,h,p;const{state:g,composing:y}=a,{selection:x}=g;if(y||!l&&!c)return;this.createTooltip();const{ranges:w}=x,b=Math.min(...w.map(k=>k.$from.pos)),S=Math.max(...w.map(k=>k.$to.pos));if(!((d=this.shouldShow)===null||d===void 0?void 0:d.call(this,{editor:this.editor,element:this.element,view:a,state:g,oldState:u,from:b,to:S}))){this.hide();return}(h=this.tippy)===null||h===void 0||h.setProps({getReferenceClientRect:((p=this.tippyOptions)===null||p===void 0?void 0:p.getReferenceClientRect)||(()=>{if(kO(g.selection)){let k=a.nodeDOM(b);if(k){const E=k.dataset.nodeViewWrapper?k:k.querySelector("[data-node-view-wrapper]");if(E&&(k=E.firstChild),k)return k.getBoundingClientRect()}}return M8(a,b,S)})}),this.show()},this.editor=e,this.element=n,this.view=r,this.updateDelay=o,s&&(this.shouldShow=s),this.element.addEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.view.dom.addEventListener("dragstart",this.dragstartHandler),this.editor.on("focus",this.focusHandler),this.editor.on("blur",this.blurHandler),this.tippyOptions=i,this.element.remove(),this.element.style.visibility="visible"}createTooltip(){const{element:e}=this.editor.options,n=!!e.parentElement;this.tippy||!n||(this.tippy=Xu(e,{duration:0,getReferenceClientRect:null,content:this.element,interactive:!0,trigger:"manual",placement:"top",hideOnClick:"toggle",...this.tippyOptions}),this.tippy.popper.firstChild&&this.tippy.popper.firstChild.addEventListener("blur",this.tippyBlurHandler))}update(e,n){const{state:r}=e,i=r.selection.from!==r.selection.to;if(this.updateDelay>0&&i){this.handleDebouncedUpdate(e,n);return}const o=!(n!=null&&n.selection.eq(e.state.selection)),s=!(n!=null&&n.doc.eq(e.state.doc));this.updateHandler(e,o,s,n)}show(){var e;(e=this.tippy)===null||e===void 0||e.show()}hide(){var e;(e=this.tippy)===null||e===void 0||e.hide()}destroy(){var e,n;!((e=this.tippy)===null||e===void 0)&&e.popper.firstChild&&this.tippy.popper.firstChild.removeEventListener("blur",this.tippyBlurHandler),(n=this.tippy)===null||n===void 0||n.destroy(),this.element.removeEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.view.dom.removeEventListener("dragstart",this.dragstartHandler),this.editor.off("focus",this.focusHandler),this.editor.off("blur",this.blurHandler)}}const UO=t=>new bt({key:typeof t.pluginKey=="string"?new Rn(t.pluginKey):t.pluginKey,view:e=>new FU({view:e,...t})});ft.create({name:"bubbleMenu",addOptions(){return{element:null,tippyOptions:{},pluginKey:"bubbleMenu",updateDelay:void 0,shouldShow:null}},addProseMirrorPlugins(){return this.options.element?[UO({pluginKey:this.options.pluginKey,editor:this.editor,element:this.options.element,tippyOptions:this.options.tippyOptions,updateDelay:this.options.updateDelay,shouldShow:this.options.shouldShow})]:[]}});function BU(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var HO={exports:{}},qm={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bS;function zU(){if(bS)return qm;bS=1;var t=Te;function e(d,h){return d===h&&(d!==0||1/d===1/h)||d!==d&&h!==h}var n=typeof Object.is=="function"?Object.is:e,r=t.useState,i=t.useEffect,o=t.useLayoutEffect,s=t.useDebugValue;function a(d,h){var p=h(),g=r({inst:{value:p,getSnapshot:h}}),y=g[0].inst,x=g[1];return o(function(){y.value=p,y.getSnapshot=h,l(y)&&x({inst:y})},[d,p,h]),i(function(){return l(y)&&x({inst:y}),d(function(){l(y)&&x({inst:y})})},[d]),s(p),p}function l(d){var h=d.getSnapshot;d=d.value;try{var p=h();return!n(d,p)}catch{return!0}}function c(d,h){return h()}var u=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?c:a;return qm.useSyncExternalStore=t.useSyncExternalStore!==void 0?t.useSyncExternalStore:u,qm}HO.exports=zU();var Ax=HO.exports;const VU=(...t)=>e=>{t.forEach(n=>{typeof n=="function"?n(e):n&&(n.current=e)})},UU=({contentComponent:t})=>{const e=Ax.useSyncExternalStore(t.subscribe,t.getSnapshot,t.getServerSnapshot);return Te.createElement(Te.Fragment,null,Object.values(e))};function HU(){const t=new Set;let e={};return{subscribe(n){return t.add(n),()=>{t.delete(n)}},getSnapshot(){return e},getServerSnapshot(){return e},setRenderer(n,r){e={...e,[n]:uE.createPortal(r.reactElement,r.element,n)},t.forEach(i=>i())},removeRenderer(n){const r={...e};delete r[n],e=r,t.forEach(i=>i())}}}class WU extends Te.Component{constructor(e){var n;super(e),this.editorContentRef=Te.createRef(),this.initialized=!1,this.state={hasContentComponentInitialized:!!(!((n=e.editor)===null||n===void 0)&&n.contentComponent)}}componentDidMount(){this.init()}componentDidUpdate(){this.init()}init(){const e=this.props.editor;if(e&&!e.isDestroyed&&e.options.element){if(e.contentComponent)return;const n=this.editorContentRef.current;n.append(...e.options.element.childNodes),e.setOptions({element:n}),e.contentComponent=HU(),this.state.hasContentComponentInitialized||(this.unsubscribeToContentComponent=e.contentComponent.subscribe(()=>{this.setState(r=>r.hasContentComponentInitialized?r:{hasContentComponentInitialized:!0}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent()})),e.createNodeViews(),this.initialized=!0}}componentWillUnmount(){const e=this.props.editor;if(!e||(this.initialized=!1,e.isDestroyed||e.view.setProps({nodeViews:{}}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent(),e.contentComponent=null,!e.options.element.firstChild))return;const n=document.createElement("div");n.append(...e.options.element.childNodes),e.setOptions({element:n})}render(){const{editor:e,innerRef:n,...r}=this.props;return Te.createElement(Te.Fragment,null,Te.createElement("div",{ref:VU(n,this.editorContentRef),...r}),(e==null?void 0:e.contentComponent)&&Te.createElement(UU,{contentComponent:e.contentComponent}))}}const KU=m.forwardRef((t,e)=>{const n=Te.useMemo(()=>Math.floor(Math.random()*4294967295).toString(),[t.editor]);return Te.createElement(WU,{key:n,innerRef:e,...t})}),qU=Te.memo(KU);var GU=function t(e,n){if(e===n)return!0;if(e&&n&&typeof e=="object"&&typeof n=="object"){if(e.constructor!==n.constructor)return!1;var r,i,o;if(Array.isArray(e)){if(r=e.length,r!=n.length)return!1;for(i=r;i--!==0;)if(!t(e[i],n[i]))return!1;return!0}if(e instanceof Map&&n instanceof Map){if(e.size!==n.size)return!1;for(i of e.entries())if(!n.has(i[0]))return!1;for(i of e.entries())if(!t(i[1],n.get(i[0])))return!1;return!0}if(e instanceof Set&&n instanceof Set){if(e.size!==n.size)return!1;for(i of e.entries())if(!n.has(i[0]))return!1;return!0}if(ArrayBuffer.isView(e)&&ArrayBuffer.isView(n)){if(r=e.length,r!=n.length)return!1;for(i=r;i--!==0;)if(e[i]!==n[i])return!1;return!0}if(e.constructor===RegExp)return e.source===n.source&&e.flags===n.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===n.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===n.toString();if(o=Object.keys(e),r=o.length,r!==Object.keys(n).length)return!1;for(i=r;i--!==0;)if(!Object.prototype.hasOwnProperty.call(n,o[i]))return!1;for(i=r;i--!==0;){var s=o[i];if(!(s==="_owner"&&e.$$typeof)&&!t(e[s],n[s]))return!1}return!0}return e!==e&&n!==n},JU=BU(GU),WO={exports:{}},Gm={};/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var SS;function YU(){if(SS)return Gm;SS=1;var t=Te,e=Ax;function n(c,u){return c===u&&(c!==0||1/c===1/u)||c!==c&&u!==u}var r=typeof Object.is=="function"?Object.is:n,i=e.useSyncExternalStore,o=t.useRef,s=t.useEffect,a=t.useMemo,l=t.useDebugValue;return Gm.useSyncExternalStoreWithSelector=function(c,u,d,h,p){var g=o(null);if(g.current===null){var y={hasValue:!1,value:null};g.current=y}else y=g.current;g=a(function(){function v(k){if(!w){if(w=!0,b=k,k=h(k),p!==void 0&&y.hasValue){var E=y.value;if(p(E,k))return S=E}return S=k}if(E=S,r(b,k))return E;var T=h(k);return p!==void 0&&p(E,T)?E:(b=k,S=T)}var w=!1,b,S,C=d===void 0?null:d;return[function(){return v(u())},C===null?void 0:function(){return v(C())}]},[u,d,h,p]);var x=i(c,g[0],g[1]);return s(function(){y.hasValue=!0,y.value=x},[x]),l(x),x},Gm}WO.exports=YU();var QU=WO.exports;const XU=typeof window<"u"?m.useLayoutEffect:m.useEffect;class ZU{constructor(e){this.transactionNumber=0,this.lastTransactionNumber=0,this.subscribers=new Set,this.editor=e,this.lastSnapshot={editor:e,transactionNumber:0},this.getSnapshot=this.getSnapshot.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.watch=this.watch.bind(this),this.subscribe=this.subscribe.bind(this)}getSnapshot(){return this.transactionNumber===this.lastTransactionNumber?this.lastSnapshot:(this.lastTransactionNumber=this.transactionNumber,this.lastSnapshot={editor:this.editor,transactionNumber:this.transactionNumber},this.lastSnapshot)}getServerSnapshot(){return{editor:null,transactionNumber:0}}subscribe(e){return this.subscribers.add(e),()=>{this.subscribers.delete(e)}}watch(e){if(this.editor=e,this.editor){const n=()=>{this.transactionNumber+=1,this.subscribers.forEach(i=>i())},r=this.editor;return r.on("transaction",n),()=>{r.off("transaction",n)}}}}function e7(t){var e;const[n]=m.useState(()=>new ZU(t.editor)),r=QU.useSyncExternalStoreWithSelector(n.subscribe,n.getSnapshot,n.getServerSnapshot,t.selector,(e=t.equalityFn)!==null&&e!==void 0?e:JU);return XU(()=>n.watch(t.editor),[t.editor,n]),m.useDebugValue(r),r}const t7=!1,nv=typeof window>"u",n7=nv||!!(typeof window<"u"&&window.next);class Nx{constructor(e){this.editor=null,this.subscriptions=new Set,this.isComponentMounted=!1,this.previousDeps=null,this.instanceId="",this.options=e,this.subscriptions=new Set,this.setEditor(this.getInitialEditor()),this.scheduleDestroy(),this.getEditor=this.getEditor.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.subscribe=this.subscribe.bind(this),this.refreshEditorInstance=this.refreshEditorInstance.bind(this),this.scheduleDestroy=this.scheduleDestroy.bind(this),this.onRender=this.onRender.bind(this),this.createEditor=this.createEditor.bind(this)}setEditor(e){this.editor=e,this.instanceId=Math.random().toString(36).slice(2,9),this.subscriptions.forEach(n=>n())}getInitialEditor(){if(this.options.current.immediatelyRender===void 0)return nv||n7?null:this.createEditor();if(this.options.current.immediatelyRender&&nv&&t7)throw new Error("Tiptap Error: SSR has been detected, and `immediatelyRender` has been set to `true` this is an unsupported configuration that may result in errors, explicitly set `immediatelyRender` to `false` to avoid hydration mismatches.");return this.options.current.immediatelyRender?this.createEditor():null}createEditor(){const e={...this.options.current,onBeforeCreate:(...r)=>{var i,o;return(o=(i=this.options.current).onBeforeCreate)===null||o===void 0?void 0:o.call(i,...r)},onBlur:(...r)=>{var i,o;return(o=(i=this.options.current).onBlur)===null||o===void 0?void 0:o.call(i,...r)},onCreate:(...r)=>{var i,o;return(o=(i=this.options.current).onCreate)===null||o===void 0?void 0:o.call(i,...r)},onDestroy:(...r)=>{var i,o;return(o=(i=this.options.current).onDestroy)===null||o===void 0?void 0:o.call(i,...r)},onFocus:(...r)=>{var i,o;return(o=(i=this.options.current).onFocus)===null||o===void 0?void 0:o.call(i,...r)},onSelectionUpdate:(...r)=>{var i,o;return(o=(i=this.options.current).onSelectionUpdate)===null||o===void 0?void 0:o.call(i,...r)},onTransaction:(...r)=>{var i,o;return(o=(i=this.options.current).onTransaction)===null||o===void 0?void 0:o.call(i,...r)},onUpdate:(...r)=>{var i,o;return(o=(i=this.options.current).onUpdate)===null||o===void 0?void 0:o.call(i,...r)},onContentError:(...r)=>{var i,o;return(o=(i=this.options.current).onContentError)===null||o===void 0?void 0:o.call(i,...r)},onDrop:(...r)=>{var i,o;return(o=(i=this.options.current).onDrop)===null||o===void 0?void 0:o.call(i,...r)},onPaste:(...r)=>{var i,o;return(o=(i=this.options.current).onPaste)===null||o===void 0?void 0:o.call(i,...r)}};return new aV(e)}getEditor(){return this.editor}getServerSnapshot(){return null}subscribe(e){return this.subscriptions.add(e),()=>{this.subscriptions.delete(e)}}static compareOptions(e,n){return Object.keys(e).every(r=>["onCreate","onBeforeCreate","onDestroy","onUpdate","onTransaction","onFocus","onBlur","onSelectionUpdate","onContentError","onDrop","onPaste"].includes(r)?!0:r==="extensions"&&e.extensions&&n.extensions?e.extensions.length!==n.extensions.length?!1:e.extensions.every((i,o)=>{var s;return i===((s=n.extensions)===null||s===void 0?void 0:s[o])}):e[r]===n[r])}onRender(e){return()=>(this.isComponentMounted=!0,clearTimeout(this.scheduledDestructionTimeout),this.editor&&!this.editor.isDestroyed&&e.length===0?Nx.compareOptions(this.options.current,this.editor.options)||this.editor.setOptions({...this.options.current,editable:this.editor.isEditable}):this.refreshEditorInstance(e),()=>{this.isComponentMounted=!1,this.scheduleDestroy()})}refreshEditorInstance(e){if(this.editor&&!this.editor.isDestroyed){if(this.previousDeps===null){this.previousDeps=e;return}if(this.previousDeps.length===e.length&&this.previousDeps.every((r,i)=>r===e[i]))return}this.editor&&!this.editor.isDestroyed&&this.editor.destroy(),this.setEditor(this.createEditor()),this.previousDeps=e}scheduleDestroy(){const e=this.instanceId,n=this.editor;this.scheduledDestructionTimeout=setTimeout(()=>{if(this.isComponentMounted&&this.instanceId===e){n&&n.setOptions(this.options.current);return}n&&!n.isDestroyed&&(n.destroy(),this.instanceId===e&&this.setEditor(null))},1)}}function r7(t={},e=[]){const n=m.useRef(t);n.current=t;const[r]=m.useState(()=>new Nx(n)),i=Ax.useSyncExternalStore(r.subscribe,r.getEditor,r.getServerSnapshot);return m.useDebugValue(i),m.useEffect(r.onRender(e)),e7({editor:i,selector:({transactionNumber:o})=>t.shouldRerenderOnTransaction===!1?null:t.immediatelyRender&&o===0?0:o+1}),i}const KO=m.createContext({editor:null});KO.Consumer;const i7=()=>m.useContext(KO),o7=t=>{const[e,n]=m.useState(null),{editor:r}=i7();return m.useEffect(()=>{var i;if(!e||!((i=t.editor)===null||i===void 0)&&i.isDestroyed||r!=null&&r.isDestroyed)return;const{pluginKey:o="bubbleMenu",editor:s,tippyOptions:a={},updateDelay:l,shouldShow:c=null}=t,u=s||r;if(!u){console.warn("BubbleMenu component is not rendered inside of an editor component or does not have editor prop.");return}const d=UO({updateDelay:l,editor:u,element:e,pluginKey:o,shouldShow:c,tippyOptions:a});return u.registerPlugin(d),()=>{u.unregisterPlugin(o)}},[t.editor,r,e]),Te.createElement("div",{ref:n,className:t.className,style:{visibility:"hidden"}},t.children)},s7=m.createContext({onDragStart:void 0}),a7=()=>m.useContext(s7);Te.forwardRef((t,e)=>{const{onDragStart:n}=a7(),r=t.as||"div";return Te.createElement(r,{...t,ref:e,"data-node-view-wrapper":"",onDragStart:n,style:{whiteSpace:"normal",...t.style}})});const l7=/^\s*>\s$/,c7=xr.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:t}){return["blockquote",Gt(this.options.HTMLAttributes,t),0]},addCommands(){return{setBlockquote:()=>({commands:t})=>t.wrapIn(this.name),toggleBlockquote:()=>({commands:t})=>t.toggleWrap(this.name),unsetBlockquote:()=>({commands:t})=>t.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[xu({find:l7,type:this.type})]}}),u7=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,d7=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,f7=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,h7=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,p7=Io.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:t=>t.style.fontWeight!=="normal"&&null},{style:"font-weight=400",clearMark:t=>t.type.name===this.name},{style:"font-weight",getAttrs:t=>/^(bold(er)?|[5-9]\d{2,})$/.test(t)&&null}]},renderHTML({HTMLAttributes:t}){return["strong",Gt(this.options.HTMLAttributes,t),0]},addCommands(){return{setBold:()=>({commands:t})=>t.setMark(this.name),toggleBold:()=>({commands:t})=>t.toggleMark(this.name),unsetBold:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[Tl({find:u7,type:this.type}),Tl({find:f7,type:this.type})]},addPasteRules(){return[_l({find:d7,type:this.type}),_l({find:h7,type:this.type})]}}),m7="listItem",CS="textStyle",kS=/^\s*([-+*])\s$/,g7=xr.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:t}){return["ul",Gt(this.options.HTMLAttributes,t),0]},addCommands(){return{toggleBulletList:()=>({commands:t,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(m7,this.editor.getAttributes(CS)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let t=xu({find:kS,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(t=xu({find:kS,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(CS),editor:this.editor})),[t]}}),y7=/(^|[^`])`([^`]+)`(?!`)/,v7=/(^|[^`])`([^`]+)`(?!`)/g,x7=Io.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:t}){return["code",Gt(this.options.HTMLAttributes,t),0]},addCommands(){return{setCode:()=>({commands:t})=>t.setMark(this.name),toggleCode:()=>({commands:t})=>t.toggleMark(this.name),unsetCode:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[Tl({find:y7,type:this.type})]},addPasteRules(){return[_l({find:v7,type:this.type})]}}),w7=/^```([a-z]+)?[\s\n]$/,b7=/^~~~([a-z]+)?[\s\n]$/,S7=xr.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:this.options.defaultLanguage,parseHTML:t=>{var e;const{languageClassPrefix:n}=this.options,o=[...((e=t.firstElementChild)===null||e===void 0?void 0:e.classList)||[]].filter(s=>s.startsWith(n)).map(s=>s.replace(n,""))[0];return o||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:t,HTMLAttributes:e}){return["pre",Gt(this.options.HTMLAttributes,e),["code",{class:t.attrs.language?this.options.languageClassPrefix+t.attrs.language:null},0]]},addCommands(){return{setCodeBlock:t=>({commands:e})=>e.setNode(this.name,t),toggleCodeBlock:t=>({commands:e})=>e.toggleNode(this.name,"paragraph",t)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:t,$anchor:e}=this.editor.state.selection,n=e.pos===1;return!t||e.parent.type.name!==this.name?!1:n||!e.parent.textContent.length?this.editor.commands.clearNodes():!1},Enter:({editor:t})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:e}=t,{selection:n}=e,{$from:r,empty:i}=n;if(!i||r.parent.type!==this.type)return!1;const o=r.parentOffset===r.parent.nodeSize-2,s=r.parent.textContent.endsWith(`

`);return!o||!s?!1:t.chain().command(({tr:a})=>(a.delete(r.pos-2,r.pos),!0)).exitCode().run()},ArrowDown:({editor:t})=>{if(!this.options.exitOnArrowDown)return!1;const{state:e}=t,{selection:n,doc:r}=e,{$from:i,empty:o}=n;if(!o||i.parent.type!==this.type||!(i.parentOffset===i.parent.nodeSize-2))return!1;const a=i.after();return a===void 0?!1:r.nodeAt(a)?t.commands.command(({tr:c})=>(c.setSelection(oe.near(r.resolve(a))),!0)):t.commands.exitCode()}}},addInputRules(){return[Yy({find:w7,type:this.type,getAttributes:t=>({language:t[1]})}),Yy({find:b7,type:this.type,getAttributes:t=>({language:t[1]})})]},addProseMirrorPlugins(){return[new bt({key:new Rn("codeBlockVSCodeHandler"),props:{handlePaste:(t,e)=>{if(!e.clipboardData||this.editor.isActive(this.type.name))return!1;const n=e.clipboardData.getData("text/plain"),r=e.clipboardData.getData("vscode-editor-data"),i=r?JSON.parse(r):void 0,o=i==null?void 0:i.mode;if(!n||!o)return!1;const{tr:s,schema:a}=t.state,l=a.text(n.replace(/\r\n?/g,`
`));return s.replaceSelectionWith(this.type.create({language:o},l)),s.selection.$from.parent.type!==this.type&&s.setSelection(ie.near(s.doc.resolve(Math.max(0,s.selection.from-2)))),s.setMeta("paste",!0),t.dispatch(s),!0}}})]}}),C7=xr.create({name:"doc",topNode:!0,content:"block+"});function k7(t={}){return new bt({view(e){return new E7(e,t)}})}class E7{constructor(e,n){var r;this.editorView=e,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=(r=n.width)!==null&&r!==void 0?r:1,this.color=n.color===!1?void 0:n.color||"black",this.class=n.class,this.handlers=["dragover","dragend","drop","dragleave"].map(i=>{let o=s=>{this[i](s)};return e.dom.addEventListener(i,o),{name:i,handler:o}})}destroy(){this.handlers.forEach(({name:e,handler:n})=>this.editorView.dom.removeEventListener(e,n))}update(e,n){this.cursorPos!=null&&n.doc!=e.state.doc&&(this.cursorPos>e.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(e){e!=this.cursorPos&&(this.cursorPos=e,e==null?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let e=this.editorView.state.doc.resolve(this.cursorPos),n=!e.parent.inlineContent,r;if(n){let a=e.nodeBefore,l=e.nodeAfter;if(a||l){let c=this.editorView.nodeDOM(this.cursorPos-(a?a.nodeSize:0));if(c){let u=c.getBoundingClientRect(),d=a?u.bottom:u.top;a&&l&&(d=(d+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2),r={left:u.left,right:u.right,top:d-this.width/2,bottom:d+this.width/2}}}}if(!r){let a=this.editorView.coordsAtPos(this.cursorPos);r={left:a.left-this.width/2,right:a.left+this.width/2,top:a.top,bottom:a.bottom}}let i=this.editorView.dom.offsetParent;this.element||(this.element=i.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",n),this.element.classList.toggle("prosemirror-dropcursor-inline",!n);let o,s;if(!i||i==document.body&&getComputedStyle(i).position=="static")o=-pageXOffset,s=-pageYOffset;else{let a=i.getBoundingClientRect();o=a.left-i.scrollLeft,s=a.top-i.scrollTop}this.element.style.left=r.left-o+"px",this.element.style.top=r.top-s+"px",this.element.style.width=r.right-r.left+"px",this.element.style.height=r.bottom-r.top+"px"}scheduleRemoval(e){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),e)}dragover(e){if(!this.editorView.editable)return;let n=this.editorView.posAtCoords({left:e.clientX,top:e.clientY}),r=n&&n.inside>=0&&this.editorView.state.doc.nodeAt(n.inside),i=r&&r.type.spec.disableDropCursor,o=typeof i=="function"?i(this.editorView,n,e):i;if(n&&!o){let s=n.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let a=bR(this.editorView.state.doc,s,this.editorView.dragging.slice);a!=null&&(s=a)}this.setCursor(s),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(e){(e.target==this.editorView.dom||!this.editorView.dom.contains(e.relatedTarget))&&this.setCursor(null)}}const T7=ft.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[k7(this.options)]}});class Ke extends oe{constructor(e){super(e,e)}map(e,n){let r=e.resolve(n.map(this.head));return Ke.valid(r)?new Ke(r):oe.near(r)}content(){return q.empty}eq(e){return e instanceof Ke&&e.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(e,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for GapCursor.fromJSON");return new Ke(e.resolve(n.pos))}getBookmark(){return new jx(this.anchor)}static valid(e){let n=e.parent;if(n.isTextblock||!_7(e)||!R7(e))return!1;let r=n.type.spec.allowGapCursor;if(r!=null)return r;let i=n.contentMatchAt(e.index()).defaultType;return i&&i.isTextblock}static findGapCursorFrom(e,n,r=!1){e:for(;;){if(!r&&Ke.valid(e))return e;let i=e.pos,o=null;for(let s=e.depth;;s--){let a=e.node(s);if(n>0?e.indexAfter(s)<a.childCount:e.index(s)>0){o=a.child(n>0?e.indexAfter(s):e.index(s)-1);break}else if(s==0)return null;i+=n;let l=e.doc.resolve(i);if(Ke.valid(l))return l}for(;;){let s=n>0?o.firstChild:o.lastChild;if(!s){if(o.isAtom&&!o.isText&&!te.isSelectable(o)){e=e.doc.resolve(i+o.nodeSize*n),r=!1;continue e}break}o=s,i+=n;let a=e.doc.resolve(i);if(Ke.valid(a))return a}return null}}}Ke.prototype.visible=!1;Ke.findFrom=Ke.findGapCursorFrom;oe.jsonID("gapcursor",Ke);class jx{constructor(e){this.pos=e}map(e){return new jx(e.map(this.pos))}resolve(e){let n=e.resolve(this.pos);return Ke.valid(n)?new Ke(n):oe.near(n)}}function _7(t){for(let e=t.depth;e>=0;e--){let n=t.index(e),r=t.node(e);if(n==0){if(r.type.spec.isolating)return!0;continue}for(let i=r.child(n-1);;i=i.lastChild){if(i.childCount==0&&!i.inlineContent||i.isAtom||i.type.spec.isolating)return!0;if(i.inlineContent)return!1}}return!0}function R7(t){for(let e=t.depth;e>=0;e--){let n=t.indexAfter(e),r=t.node(e);if(n==r.childCount){if(r.type.spec.isolating)return!0;continue}for(let i=r.child(n);;i=i.firstChild){if(i.childCount==0&&!i.inlineContent||i.isAtom||i.type.spec.isolating)return!0;if(i.inlineContent)return!1}}return!0}function O7(){return new bt({props:{decorations:A7,createSelectionBetween(t,e,n){return e.pos==n.pos&&Ke.valid(n)?new Ke(n):null},handleClick:M7,handleKeyDown:P7,handleDOMEvents:{beforeinput:I7}}})}const P7=aO({ArrowLeft:Kd("horiz",-1),ArrowRight:Kd("horiz",1),ArrowUp:Kd("vert",-1),ArrowDown:Kd("vert",1)});function Kd(t,e){const n=t=="vert"?e>0?"down":"up":e>0?"right":"left";return function(r,i,o){let s=r.selection,a=e>0?s.$to:s.$from,l=s.empty;if(s instanceof ie){if(!o.endOfTextblock(n)||a.depth==0)return!1;l=!1,a=r.doc.resolve(e>0?a.after():a.before())}let c=Ke.findGapCursorFrom(a,e,l);return c?(i&&i(r.tr.setSelection(new Ke(c))),!0):!1}}function M7(t,e,n){if(!t||!t.editable)return!1;let r=t.state.doc.resolve(e);if(!Ke.valid(r))return!1;let i=t.posAtCoords({left:n.clientX,top:n.clientY});return i&&i.inside>-1&&te.isSelectable(t.state.doc.nodeAt(i.inside))?!1:(t.dispatch(t.state.tr.setSelection(new Ke(r))),!0)}function I7(t,e){if(e.inputType!="insertCompositionText"||!(t.state.selection instanceof Ke))return!1;let{$from:n}=t.state.selection,r=n.parent.contentMatchAt(n.index()).findWrapping(t.state.schema.nodes.text);if(!r)return!1;let i=F.empty;for(let s=r.length-1;s>=0;s--)i=F.from(r[s].createAndFill(null,i));let o=t.state.tr.replace(n.pos,n.pos,new q(i,0,0));return o.setSelection(ie.near(o.doc.resolve(n.pos+1))),t.dispatch(o),!1}function A7(t){if(!(t.selection instanceof Ke))return null;let e=document.createElement("div");return e.className="ProseMirror-gapcursor",Je.create(t.doc,[an.widget(t.selection.head,e,{key:"gapcursor"})])}const N7=ft.create({name:"gapCursor",addProseMirrorPlugins(){return[O7()]},extendNodeSchema(t){var e;const n={name:t.name,options:t.options,storage:t.storage};return{allowGapCursor:(e=ue(J(t,"allowGapCursor",n)))!==null&&e!==void 0?e:null}}}),j7=xr.create({name:"hardBreak",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:t}){return["br",Gt(this.options.HTMLAttributes,t)]},renderText(){return`
`},addCommands(){return{setHardBreak:()=>({commands:t,chain:e,state:n,editor:r})=>t.first([()=>t.exitCode(),()=>t.command(()=>{const{selection:i,storedMarks:o}=n;if(i.$from.parent.type.spec.isolating)return!1;const{keepMarks:s}=this.options,{splittableMarks:a}=r.extensionManager,l=o||i.$to.parentOffset&&i.$from.marks();return e().insertContent({type:this.name}).command(({tr:c,dispatch:u})=>{if(u&&l&&s){const d=l.filter(h=>a.includes(h.type.name));c.ensureMarks(d)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),D7=xr.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(t=>({tag:`h${t}`,attrs:{level:t}}))},renderHTML({node:t,HTMLAttributes:e}){return[`h${this.options.levels.includes(t.attrs.level)?t.attrs.level:this.options.levels[0]}`,Gt(this.options.HTMLAttributes,e),0]},addCommands(){return{setHeading:t=>({commands:e})=>this.options.levels.includes(t.level)?e.setNode(this.name,t):!1,toggleHeading:t=>({commands:e})=>this.options.levels.includes(t.level)?e.toggleNode(this.name,"paragraph",t):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((t,e)=>({...t,[`Mod-Alt-${e}`]:()=>this.editor.commands.toggleHeading({level:e})}),{})},addInputRules(){return this.options.levels.map(t=>Yy({find:new RegExp(`^(#{${Math.min(...this.options.levels)},${t}})\\s$`),type:this.type,getAttributes:{level:t}}))}});var wh=200,ut=function(){};ut.prototype.append=function(e){return e.length?(e=ut.from(e),!this.length&&e||e.length<wh&&this.leafAppend(e)||this.length<wh&&e.leafPrepend(this)||this.appendInner(e)):this};ut.prototype.prepend=function(e){return e.length?ut.from(e).append(this):this};ut.prototype.appendInner=function(e){return new L7(this,e)};ut.prototype.slice=function(e,n){return e===void 0&&(e=0),n===void 0&&(n=this.length),e>=n?ut.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,n))};ut.prototype.get=function(e){if(!(e<0||e>=this.length))return this.getInner(e)};ut.prototype.forEach=function(e,n,r){n===void 0&&(n=0),r===void 0&&(r=this.length),n<=r?this.forEachInner(e,n,r,0):this.forEachInvertedInner(e,n,r,0)};ut.prototype.map=function(e,n,r){n===void 0&&(n=0),r===void 0&&(r=this.length);var i=[];return this.forEach(function(o,s){return i.push(e(o,s))},n,r),i};ut.from=function(e){return e instanceof ut?e:e&&e.length?new qO(e):ut.empty};var qO=function(t){function e(r){t.call(this),this.values=r}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={length:{configurable:!0},depth:{configurable:!0}};return e.prototype.flatten=function(){return this.values},e.prototype.sliceInner=function(i,o){return i==0&&o==this.length?this:new e(this.values.slice(i,o))},e.prototype.getInner=function(i){return this.values[i]},e.prototype.forEachInner=function(i,o,s,a){for(var l=o;l<s;l++)if(i(this.values[l],a+l)===!1)return!1},e.prototype.forEachInvertedInner=function(i,o,s,a){for(var l=o-1;l>=s;l--)if(i(this.values[l],a+l)===!1)return!1},e.prototype.leafAppend=function(i){if(this.length+i.length<=wh)return new e(this.values.concat(i.flatten()))},e.prototype.leafPrepend=function(i){if(this.length+i.length<=wh)return new e(i.flatten().concat(this.values))},n.length.get=function(){return this.values.length},n.depth.get=function(){return 0},Object.defineProperties(e.prototype,n),e}(ut);ut.empty=new qO([]);var L7=function(t){function e(n,r){t.call(this),this.left=n,this.right=r,this.length=n.length+r.length,this.depth=Math.max(n.depth,r.depth)+1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},e.prototype.getInner=function(r){return r<this.left.length?this.left.get(r):this.right.get(r-this.left.length)},e.prototype.forEachInner=function(r,i,o,s){var a=this.left.length;if(i<a&&this.left.forEachInner(r,i,Math.min(o,a),s)===!1||o>a&&this.right.forEachInner(r,Math.max(i-a,0),Math.min(this.length,o)-a,s+a)===!1)return!1},e.prototype.forEachInvertedInner=function(r,i,o,s){var a=this.left.length;if(i>a&&this.right.forEachInvertedInner(r,i-a,Math.max(o,a)-a,s+a)===!1||o<a&&this.left.forEachInvertedInner(r,Math.min(i,a),o,s)===!1)return!1},e.prototype.sliceInner=function(r,i){if(r==0&&i==this.length)return this;var o=this.left.length;return i<=o?this.left.slice(r,i):r>=o?this.right.slice(r-o,i-o):this.left.slice(r,o).append(this.right.slice(0,i-o))},e.prototype.leafAppend=function(r){var i=this.right.leafAppend(r);if(i)return new e(this.left,i)},e.prototype.leafPrepend=function(r){var i=this.left.leafPrepend(r);if(i)return new e(i,this.right)},e.prototype.appendInner=function(r){return this.left.depth>=Math.max(this.right.depth,r.depth)+1?new e(this.left,new e(this.right,r)):new e(this,r)},e}(ut);const $7=500;class sr{constructor(e,n){this.items=e,this.eventCount=n}popEvent(e,n){if(this.eventCount==0)return null;let r=this.items.length;for(;;r--)if(this.items.get(r-1).selection){--r;break}let i,o;n&&(i=this.remapping(r,this.items.length),o=i.maps.length);let s=e.tr,a,l,c=[],u=[];return this.items.forEach((d,h)=>{if(!d.step){i||(i=this.remapping(r,h+1),o=i.maps.length),o--,u.push(d);return}if(i){u.push(new Si(d.map));let p=d.step.map(i.slice(o)),g;p&&s.maybeStep(p).doc&&(g=s.mapping.maps[s.mapping.maps.length-1],c.push(new Si(g,void 0,void 0,c.length+u.length))),o--,g&&i.appendMap(g,o)}else s.maybeStep(d.step);if(d.selection)return a=i?d.selection.map(i.slice(o)):d.selection,l=new sr(this.items.slice(0,r).append(u.reverse().concat(c)),this.eventCount-1),!1},this.items.length,0),{remaining:l,transform:s,selection:a}}addTransform(e,n,r,i){let o=[],s=this.eventCount,a=this.items,l=!i&&a.length?a.get(a.length-1):null;for(let u=0;u<e.steps.length;u++){let d=e.steps[u].invert(e.docs[u]),h=new Si(e.mapping.maps[u],d,n),p;(p=l&&l.merge(h))&&(h=p,u?o.pop():a=a.slice(0,a.length-1)),o.push(h),n&&(s++,n=void 0),i||(l=h)}let c=s-r.depth;return c>B7&&(a=F7(a,c),s-=c),new sr(a.append(o),s)}remapping(e,n){let r=new hu;return this.items.forEach((i,o)=>{let s=i.mirrorOffset!=null&&o-i.mirrorOffset>=e?r.maps.length-i.mirrorOffset:void 0;r.appendMap(i.map,s)},e,n),r}addMaps(e){return this.eventCount==0?this:new sr(this.items.append(e.map(n=>new Si(n))),this.eventCount)}rebased(e,n){if(!this.eventCount)return this;let r=[],i=Math.max(0,this.items.length-n),o=e.mapping,s=e.steps.length,a=this.eventCount;this.items.forEach(h=>{h.selection&&a--},i);let l=n;this.items.forEach(h=>{let p=o.getMirror(--l);if(p==null)return;s=Math.min(s,p);let g=o.maps[p];if(h.step){let y=e.steps[p].invert(e.docs[p]),x=h.selection&&h.selection.map(o.slice(l+1,p));x&&a++,r.push(new Si(g,y,x))}else r.push(new Si(g))},i);let c=[];for(let h=n;h<s;h++)c.push(new Si(o.maps[h]));let u=this.items.slice(0,i).append(c).append(r),d=new sr(u,a);return d.emptyItemCount()>$7&&(d=d.compress(this.items.length-r.length)),d}emptyItemCount(){let e=0;return this.items.forEach(n=>{n.step||e++}),e}compress(e=this.items.length){let n=this.remapping(0,e),r=n.maps.length,i=[],o=0;return this.items.forEach((s,a)=>{if(a>=e)i.push(s),s.selection&&o++;else if(s.step){let l=s.step.map(n.slice(r)),c=l&&l.getMap();if(r--,c&&n.appendMap(c,r),l){let u=s.selection&&s.selection.map(n.slice(r));u&&o++;let d=new Si(c.invert(),l,u),h,p=i.length-1;(h=i.length&&i[p].merge(d))?i[p]=h:i.push(d)}}else s.map&&r--},this.items.length,0),new sr(ut.from(i.reverse()),o)}}sr.empty=new sr(ut.empty,0);function F7(t,e){let n;return t.forEach((r,i)=>{if(r.selection&&e--==0)return n=i,!1}),t.slice(n)}let Si=class GO{constructor(e,n,r,i){this.map=e,this.step=n,this.selection=r,this.mirrorOffset=i}merge(e){if(this.step&&e.step&&!e.selection){let n=e.step.merge(this.step);if(n)return new GO(n.getMap().invert(),n,this.selection)}}};class ji{constructor(e,n,r,i,o){this.done=e,this.undone=n,this.prevRanges=r,this.prevTime=i,this.prevComposition=o}}const B7=20;function z7(t,e,n,r){let i=n.getMeta(Cs),o;if(i)return i.historyState;n.getMeta(H7)&&(t=new ji(t.done,t.undone,null,0,-1));let s=n.getMeta("appendedTransaction");if(n.steps.length==0)return t;if(s&&s.getMeta(Cs))return s.getMeta(Cs).redo?new ji(t.done.addTransform(n,void 0,r,wf(e)),t.undone,ES(n.mapping.maps),t.prevTime,t.prevComposition):new ji(t.done,t.undone.addTransform(n,void 0,r,wf(e)),null,t.prevTime,t.prevComposition);if(n.getMeta("addToHistory")!==!1&&!(s&&s.getMeta("addToHistory")===!1)){let a=n.getMeta("composition"),l=t.prevTime==0||!s&&t.prevComposition!=a&&(t.prevTime<(n.time||0)-r.newGroupDelay||!V7(n,t.prevRanges)),c=s?Jm(t.prevRanges,n.mapping):ES(n.mapping.maps);return new ji(t.done.addTransform(n,l?e.selection.getBookmark():void 0,r,wf(e)),sr.empty,c,n.time,a??t.prevComposition)}else return(o=n.getMeta("rebased"))?new ji(t.done.rebased(n,o),t.undone.rebased(n,o),Jm(t.prevRanges,n.mapping),t.prevTime,t.prevComposition):new ji(t.done.addMaps(n.mapping.maps),t.undone.addMaps(n.mapping.maps),Jm(t.prevRanges,n.mapping),t.prevTime,t.prevComposition)}function V7(t,e){if(!e)return!1;if(!t.docChanged)return!0;let n=!1;return t.mapping.maps[0].forEach((r,i)=>{for(let o=0;o<e.length;o+=2)r<=e[o+1]&&i>=e[o]&&(n=!0)}),n}function ES(t){let e=[];for(let n=t.length-1;n>=0&&e.length==0;n--)t[n].forEach((r,i,o,s)=>e.push(o,s));return e}function Jm(t,e){if(!t)return null;let n=[];for(let r=0;r<t.length;r+=2){let i=e.map(t[r],1),o=e.map(t[r+1],-1);i<=o&&n.push(i,o)}return n}function U7(t,e,n){let r=wf(e),i=Cs.get(e).spec.config,o=(n?t.undone:t.done).popEvent(e,r);if(!o)return null;let s=o.selection.resolve(o.transform.doc),a=(n?t.done:t.undone).addTransform(o.transform,e.selection.getBookmark(),i,r),l=new ji(n?a:o.remaining,n?o.remaining:a,null,0,-1);return o.transform.setSelection(s).setMeta(Cs,{redo:n,historyState:l})}let Ym=!1,TS=null;function wf(t){let e=t.plugins;if(TS!=e){Ym=!1,TS=e;for(let n=0;n<e.length;n++)if(e[n].spec.historyPreserveItems){Ym=!0;break}}return Ym}const Cs=new Rn("history"),H7=new Rn("closeHistory");function W7(t={}){return t={depth:t.depth||100,newGroupDelay:t.newGroupDelay||500},new bt({key:Cs,state:{init(){return new ji(sr.empty,sr.empty,null,0,-1)},apply(e,n,r){return z7(n,r,e,t)}},config:t,props:{handleDOMEvents:{beforeinput(e,n){let r=n.inputType,i=r=="historyUndo"?YO:r=="historyRedo"?QO:null;return i?(n.preventDefault(),i(e.state,e.dispatch)):!1}}}})}function JO(t,e){return(n,r)=>{let i=Cs.getState(n);if(!i||(t?i.undone:i.done).eventCount==0)return!1;if(r){let o=U7(i,n,t);o&&r(e?o.scrollIntoView():o)}return!0}}const YO=JO(!1,!0),QO=JO(!0,!0),K7=ft.create({name:"history",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:t,dispatch:e})=>YO(t,e),redo:()=>({state:t,dispatch:e})=>QO(t,e)}},addProseMirrorPlugins(){return[W7(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-":()=>this.editor.commands.undo(),"Shift-Mod-":()=>this.editor.commands.redo()}}}),q7=xr.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{}}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:t}){return["hr",Gt(this.options.HTMLAttributes,t)]},addCommands(){return{setHorizontalRule:()=>({chain:t,state:e})=>{const{selection:n}=e,{$from:r,$to:i}=n,o=t();return r.parentOffset===0?o.insertContentAt({from:Math.max(r.pos-1,0),to:i.pos},{type:this.name}):kO(n)?o.insertContentAt(i.pos,{type:this.name}):o.insertContent({type:this.name}),o.command(({tr:s,dispatch:a})=>{var l;if(a){const{$to:c}=s.selection,u=c.end();if(c.nodeAfter)c.nodeAfter.isTextblock?s.setSelection(ie.create(s.doc,c.pos+1)):c.nodeAfter.isBlock?s.setSelection(te.create(s.doc,c.pos)):s.setSelection(ie.create(s.doc,c.pos));else{const d=(l=c.parent.type.contentMatch.defaultType)===null||l===void 0?void 0:l.create();d&&(s.insert(u,d),s.setSelection(ie.create(s.doc,u+1)))}s.scrollIntoView()}return!0}).run()}}},addInputRules(){return[lV({find:/^(?:---|-|___\s|\*\*\*\s)$/,type:this.type})]}}),G7=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,J7=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,Y7=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,Q7=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,X7=Io.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:t=>t.style.fontStyle!=="normal"&&null},{style:"font-style=normal",clearMark:t=>t.type.name===this.name},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:t}){return["em",Gt(this.options.HTMLAttributes,t),0]},addCommands(){return{setItalic:()=>({commands:t})=>t.setMark(this.name),toggleItalic:()=>({commands:t})=>t.toggleMark(this.name),unsetItalic:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[Tl({find:G7,type:this.type}),Tl({find:Y7,type:this.type})]},addPasteRules(){return[_l({find:J7,type:this.type}),_l({find:Q7,type:this.type})]}}),Z7=xr.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:t}){return["li",Gt(this.options.HTMLAttributes,t),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),eH="listItem",_S="textStyle",RS=/^(\d+)\.\s$/,tH=xr.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:t=>t.hasAttribute("start")?parseInt(t.getAttribute("start")||"",10):1},type:{default:void 0,parseHTML:t=>t.getAttribute("type")}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:t}){const{start:e,...n}=t;return e===1?["ol",Gt(this.options.HTMLAttributes,n),0]:["ol",Gt(this.options.HTMLAttributes,t),0]},addCommands(){return{toggleOrderedList:()=>({commands:t,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(eH,this.editor.getAttributes(_S)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let t=xu({find:RS,type:this.type,getAttributes:e=>({start:+e[1]}),joinPredicate:(e,n)=>n.childCount+n.attrs.start===+e[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(t=xu({find:RS,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:e=>({start:+e[1],...this.editor.getAttributes(_S)}),joinPredicate:(e,n)=>n.childCount+n.attrs.start===+e[1],editor:this.editor})),[t]}}),nH=xr.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:t}){return["p",Gt(this.options.HTMLAttributes,t),0]},addCommands(){return{setParagraph:()=>({commands:t})=>t.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),rH=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,iH=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,oH=Io.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:t=>t.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:t}){return["s",Gt(this.options.HTMLAttributes,t),0]},addCommands(){return{setStrike:()=>({commands:t})=>t.setMark(this.name),toggleStrike:()=>({commands:t})=>t.toggleMark(this.name),unsetStrike:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[Tl({find:rH,type:this.type})]},addPasteRules(){return[_l({find:iH,type:this.type})]}}),sH=xr.create({name:"text",group:"inline"}),aH=ft.create({name:"starterKit",addExtensions(){var t,e,n,r,i,o,s,a,l,c,u,d,h,p,g,y,x,v;const w=[];return this.options.bold!==!1&&w.push(p7.configure((t=this.options)===null||t===void 0?void 0:t.bold)),this.options.blockquote!==!1&&w.push(c7.configure((e=this.options)===null||e===void 0?void 0:e.blockquote)),this.options.bulletList!==!1&&w.push(g7.configure((n=this.options)===null||n===void 0?void 0:n.bulletList)),this.options.code!==!1&&w.push(x7.configure((r=this.options)===null||r===void 0?void 0:r.code)),this.options.codeBlock!==!1&&w.push(S7.configure((i=this.options)===null||i===void 0?void 0:i.codeBlock)),this.options.document!==!1&&w.push(C7.configure((o=this.options)===null||o===void 0?void 0:o.document)),this.options.dropcursor!==!1&&w.push(T7.configure((s=this.options)===null||s===void 0?void 0:s.dropcursor)),this.options.gapcursor!==!1&&w.push(N7.configure((a=this.options)===null||a===void 0?void 0:a.gapcursor)),this.options.hardBreak!==!1&&w.push(j7.configure((l=this.options)===null||l===void 0?void 0:l.hardBreak)),this.options.heading!==!1&&w.push(D7.configure((c=this.options)===null||c===void 0?void 0:c.heading)),this.options.history!==!1&&w.push(K7.configure((u=this.options)===null||u===void 0?void 0:u.history)),this.options.horizontalRule!==!1&&w.push(q7.configure((d=this.options)===null||d===void 0?void 0:d.horizontalRule)),this.options.italic!==!1&&w.push(X7.configure((h=this.options)===null||h===void 0?void 0:h.italic)),this.options.listItem!==!1&&w.push(Z7.configure((p=this.options)===null||p===void 0?void 0:p.listItem)),this.options.orderedList!==!1&&w.push(tH.configure((g=this.options)===null||g===void 0?void 0:g.orderedList)),this.options.paragraph!==!1&&w.push(nH.configure((y=this.options)===null||y===void 0?void 0:y.paragraph)),this.options.strike!==!1&&w.push(oH.configure((x=this.options)===null||x===void 0?void 0:x.strike)),this.options.text!==!1&&w.push(sH.configure((v=this.options)===null||v===void 0?void 0:v.text)),w}}),lH=ft.create({name:"placeholder",addOptions(){return{emptyEditorClass:"is-editor-empty",emptyNodeClass:"is-empty",placeholder:"Write something ",showOnlyWhenEditable:!0,showOnlyCurrent:!0,includeChildren:!1}},addProseMirrorPlugins(){return[new bt({key:new Rn("placeholder"),props:{decorations:({doc:t,selection:e})=>{const n=this.editor.isEditable||!this.options.showOnlyWhenEditable,{anchor:r}=e,i=[];if(!n)return null;const o=this.editor.isEmpty;return t.descendants((s,a)=>{const l=r>=a&&r<=a+s.nodeSize,c=!s.isLeaf&&wp(s);if((l||!this.options.showOnlyCurrent)&&c){const u=[this.options.emptyNodeClass];o&&u.push(this.options.emptyEditorClass);const d=an.node(a,a+s.nodeSize,{class:u.join(" "),"data-placeholder":typeof this.options.placeholder=="function"?this.options.placeholder({editor:this.editor,node:s,pos:a,hasAnchor:l}):this.options.placeholder});i.push(d)}return this.options.includeChildren}),Je.create(t,i)}}})]}});function XO(t,e){if(typeof t!="function"){const[n,r]=m.useState(t);return m.useEffect(()=>{const i=setTimeout(()=>{r(t)},e);return()=>{clearTimeout(i)}},[t,e]),n}return m.useCallback((...n)=>{const r=t,i=setTimeout(()=>{r(...n)},e);return()=>{clearTimeout(i)}},[t,e])}function cH(t){var e;const{char:n,allowSpaces:r,allowToIncludeChar:i,allowedPrefixes:o,startOfLine:s,$position:a}=t,l=r&&!i,c=cV(n),u=new RegExp(`\\s${c}$`),d=s?"^":"",h=i?"":c,p=l?new RegExp(`${d}${c}.*?(?=\\s${h}|$)`,"gm"):new RegExp(`${d}(?:^)?${c}[^\\s${h}]*`,"gm"),g=((e=a.nodeBefore)===null||e===void 0?void 0:e.isText)&&a.nodeBefore.text;if(!g)return null;const y=a.pos-g.length,x=Array.from(g.matchAll(p)).pop();if(!x||x.input===void 0||x.index===void 0)return null;const v=x.input.slice(Math.max(0,x.index-1),x.index),w=new RegExp(`^[${o==null?void 0:o.join("")}\0]?$`).test(v);if(o!==null&&!w)return null;const b=y+x.index;let S=b+x[0].length;return l&&u.test(g.slice(S-1,S+1))&&(x[0]+=" ",S+=1),b<a.pos&&S>=a.pos?{range:{from:b,to:S},query:x[0].slice(n.length),text:x[0]}:null}const uH=new Rn("suggestion");function dH({pluginKey:t=uH,editor:e,char:n="@",allowSpaces:r=!1,allowToIncludeChar:i=!1,allowedPrefixes:o=[" "],startOfLine:s=!1,decorationTag:a="span",decorationClass:l="suggestion",command:c=()=>null,items:u=()=>[],render:d=()=>({}),allow:h=()=>!0,findSuggestionMatch:p=cH}){let g;const y=d==null?void 0:d(),x=new bt({key:t,view(){return{update:async(v,w)=>{var b,S,C,k,E,T,R;const _=(b=this.key)===null||b===void 0?void 0:b.getState(w),A=(S=this.key)===null||S===void 0?void 0:S.getState(v.state),L=_.active&&A.active&&_.range.from!==A.range.from,N=!_.active&&A.active,M=_.active&&!A.active,z=!N&&!M&&_.query!==A.query,$=N||L&&z,V=z||L,I=M||L&&z;if(!$&&!V&&!I)return;const P=I&&!$?_:A,D=v.dom.querySelector(`[data-decoration-id="${P.decorationId}"]`);g={editor:e,range:P.range,query:P.query,text:P.text,items:[],command:H=>c({editor:e,range:P.range,props:H}),decorationNode:D,clientRect:D?()=>{var H;const{decorationId:Z}=(H=this.key)===null||H===void 0?void 0:H.getState(e.state),he=v.dom.querySelector(`[data-decoration-id="${Z}"]`);return(he==null?void 0:he.getBoundingClientRect())||null}:null},$&&((C=y==null?void 0:y.onBeforeStart)===null||C===void 0||C.call(y,g)),V&&((k=y==null?void 0:y.onBeforeUpdate)===null||k===void 0||k.call(y,g)),(V||$)&&(g.items=await u({editor:e,query:P.query})),I&&((E=y==null?void 0:y.onExit)===null||E===void 0||E.call(y,g)),V&&((T=y==null?void 0:y.onUpdate)===null||T===void 0||T.call(y,g)),$&&((R=y==null?void 0:y.onStart)===null||R===void 0||R.call(y,g))},destroy:()=>{var v;g&&((v=y==null?void 0:y.onExit)===null||v===void 0||v.call(y,g))}}},state:{init(){return{active:!1,range:{from:0,to:0},query:null,text:null,composing:!1}},apply(v,w,b,S){const{isEditable:C}=e,{composing:k}=e.view,{selection:E}=v,{empty:T,from:R}=E,_={...w};if(_.composing=k,C&&(T||e.view.composing)){(R<w.range.from||R>w.range.to)&&!k&&!w.composing&&(_.active=!1);const A=p({char:n,allowSpaces:r,allowToIncludeChar:i,allowedPrefixes:o,startOfLine:s,$position:E.$from}),L=`id_${Math.floor(Math.random()*4294967295)}`;A&&h({editor:e,state:S,range:A.range,isActive:w.active})?(_.active=!0,_.decorationId=w.decorationId?w.decorationId:L,_.range=A.range,_.query=A.query,_.text=A.text):_.active=!1}else _.active=!1;return _.active||(_.decorationId=null,_.range={from:0,to:0},_.query=null,_.text=null),_}},props:{handleKeyDown(v,w){var b;const{active:S,range:C}=x.getState(v.state);return S&&((b=y==null?void 0:y.onKeyDown)===null||b===void 0?void 0:b.call(y,{view:v,event:w,range:C}))||!1},decorations(v){const{active:w,range:b,decorationId:S}=x.getState(v);return w?Je.create(v.doc,[an.inline(b.from,b.to,{nodeName:a,class:l,"data-decoration-id":S})]):null}}});return x}const fH=ft.create({name:"slashCommand",addOptions(){return{snippets:[],suggestion:{char:"/",command:({editor:e,range:n,props:r})=>{r.command({editor:e,range:n})},items:({query:e,editor:n})=>{var o;const r=n.extensionManager.extensions.find(s=>s.name==="slashCommand");return(((o=r==null?void 0:r.options)==null?void 0:o.snippets)||[]).filter(s=>s.command.toLowerCase().includes(e.toLowerCase())).map(s=>({title:s.command,previewText:s.text,command:({editor:a,range:l})=>{a.chain().focus().deleteRange(l).insertContent(s.text).run()}}))},render:()=>{let e,n=0,r;return{onStart:i=>{var s;r=i,e=document.createElement("div"),e.style.cssText=`
            position: absolute;
            z-index: 100;
            background: white;
            border: 1px solid #e5e7eb;
            border-radius: 6px;
            padding: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            min-width: 300px;
            max-width: 400px;
          `,r.items.forEach((a,l)=>{var h;const c=document.createElement("button");c.style.cssText=`
              display: flex;
              width: 100%;
              align-items: center;
              gap: 8px;
              text-align: left;
              padding: 8px 12px;
              border: none;
              background: none;
              cursor: pointer;
              border-radius: 4px;
              ${l===n?"background-color: #f3f4f6;":""}
            `;const u=document.createElement("div");u.textContent=a.title,u.style.cssText=`
              font-weight: 500;
              color: #1f2937;
              flex-shrink: 0;
            `;const d=document.createElement("div");d.textContent=(h=a.previewText)!=null&&h.length&&a.previewText.length>100?a.previewText.substring(0,100)+"...":a.previewText||"",d.style.cssText=`
              font-size: 14px;
              color: #6b7280;
              white-space: nowrap;
              overflow: hidden;
              text-overflow: ellipsis;
            `,c.appendChild(u),c.appendChild(d),c.addEventListener("click",()=>{r.command(a),e.remove()}),e.appendChild(c)}),document.body.appendChild(e);const o=(s=r.clientRect)==null?void 0:s.call(r);o&&(e.style.top=`${o.top+window.scrollY-e.offsetHeight-10}px`,e.style.left=`${o.left+window.scrollX}px`)},onUpdate:i=>{var s;r=i;const o=(s=r.clientRect)==null?void 0:s.call(r);o&&(e.style.top=`${o.top+window.scrollY-e.offsetHeight-10}px`,e.style.left=`${o.left+window.scrollX}px`)},onKeyDown:({event:i})=>i.key==="ArrowDown"?(n=(n+1)%e.children.length,Array.from(e.children).forEach((o,s)=>{o.style.backgroundColor=s===n?"#f3f4f6":""}),!0):i.key==="ArrowUp"?(n=(n-1+e.children.length)%e.children.length,Array.from(e.children).forEach((o,s)=>{o.style.backgroundColor=s===n?"#f3f4f6":""}),!0):i.key==="Enter"&&e.children.length>0?(r.command(r.items[n]),e.remove(),!0):!1,onExit:()=>{e.remove()}}}}}},addProseMirrorPlugins(){return[dH({editor:this.editor,...this.options.suggestion})]}});function hH(t){return/<(.|\n)*?>/g.test(t.trim())}function pH(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function mH(t){return`<p>${pH(t).split(/\r?\n/).join("<br/>")}</p>`}function OS(t){return t.trim()?hH(t)?t:mH(t):""}const fa={editor:{flex:1,width:"100%",height:"100%",fontSize:"16px",lineHeight:"1.5",color:"#374151",outline:"none",cursor:"text",display:"flex",flexDirection:"column",position:"relative",overflow:"auto",backgroundColor:"#ffffff","& .ProseMirror":{outline:"none !important",border:"none !important",flex:1,padding:"12px",whiteSpace:"pre-wrap",overflowY:"auto",overflowX:"hidden",minHeight:"100%",height:"100%",display:"flex",flexDirection:"column",position:"relative","& > *:first-child":{marginTop:0},"& > *:last-child":{marginBottom:"auto"},"&::after":{content:'""',position:"absolute",top:0,left:0,right:0,bottom:0,pointerEvents:"none",zIndex:-1},"&.ProseMirror p.is-editor-empty:first-child::before":{content:"attr(dataPlaceholder)",float:"left",color:"#adb5bd",pointerEvents:"none",height:"0"},"& .preserve-whitespace":{whiteSpace:"pre-wrap"},"&:focus":{outline:"none !important",border:"none !important"},"&.ProseMirror-focused":{outline:"none !important",border:"none !important"},"& ul":{listStyleType:"disc",paddingLeft:"1.5em",marginTop:"0.5em",marginBottom:"0.5em"},"& ol":{listStyleType:"decimal",paddingLeft:"1.5em",marginTop:"0.5em",marginBottom:"0.5em"}}},bubbleMenu:{display:"flex",gap:"8px",backgroundColor:"white",padding:"8px",borderRadius:"6px",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)",border:"1px solid #e5e7eb"},menuButton:{padding:"4px 8px",backgroundColor:"transparent",border:"none",borderRadius:"4px",cursor:"pointer",color:"#6b7280","&:hover":{backgroundColor:"#f3f4f6"}},copyButton:{position:"absolute",right:"8px",top:"8px",padding:"4px 8px",backgroundColor:"#f3f4f6",borderRadius:"4px",cursor:"pointer",fontSize:"14px",color:"#6b7280","&:hover":{backgroundColor:"#e5e7eb"}},editorToolbar:{display:"flex",gap:"8px",alignItems:"center",marginBottom:"8px",height:"36px"},toolbarButton:{padding:"4px 8px",backgroundColor:"#f3f4f6",border:"1px solid #e5e7eb",borderRadius:"4px",cursor:"pointer",fontSize:"14px",color:"#6b7280",display:"flex",alignItems:"center",gap:"4px","&:hover":{backgroundColor:"#e5e7eb"},"&:disabled":{opacity:.5,cursor:"not-allowed"}}};function Qm({content:t,onChange:e,readOnly:n=!1,placeholder:r="Start typing...",snippets:i=[],onEditorReady:o}){const[s,a]=m.useState(""),l=m.useRef(!1),c=m.useRef(t),u=m.useMemo(()=>OS(t),[t]),d=r7({extensions:[aH.configure({bulletList:{keepMarks:!0,keepAttributes:!1},orderedList:{keepMarks:!0,keepAttributes:!1}}),lH.configure({placeholder:r}),fH.configure({snippets:i})],editorProps:{attributes:{class:"focus:outline-none w-full h-full prose prose-sm sm:prose lg:prose-lg"},handleClick(p,g,y){return g!==null?!1:(d&&d.commands.focus("end"),!0)}},content:u,onUpdate:({editor:p})=>{l.current||(l.current=!0);const g=p.getHTML();a(g)},editable:!n});m.useEffect(()=>{d&&o&&o(d)},[d,o]),m.useEffect(()=>{if(d&&t!==c.current&&!l.current){const p=OS(t);d.commands.setContent(p),c.current=t}},[t,d]);const h=XO(s,200);if(m.useEffect(()=>{h&&l.current&&e&&(e(h),l.current=!1,c.current=h)},[h,e]),!!d)return f.jsxs("div",{style:{height:"100%",display:"flex",flexDirection:"column",position:"relative"},children:[!n&&f.jsx(o7,{editor:d,tippyOptions:{duration:100},children:f.jsxs("div",{style:fa.bubbleMenu,children:[f.jsx("button",{onClick:()=>d.chain().focus().toggleBold().run(),className:d.isActive("bold")?"is-active":"",style:fa.menuButton,children:"Bold"}),f.jsx("button",{onClick:()=>d.chain().focus().toggleItalic().run(),className:d.isActive("italic")?"is-active":"",style:fa.menuButton,children:"Italic"}),f.jsx("button",{onClick:()=>d.chain().focus().toggleBulletList().run(),className:d.isActive("bulletList")?"is-active":"",style:fa.menuButton,children:"Bullet List"}),f.jsx("button",{onClick:()=>d.chain().focus().toggleOrderedList().run(),className:d.isActive("orderedList")?"is-active":"",style:fa.menuButton,children:"Numbered List"})]})}),f.jsx(qU,{editor:d,style:{...fa.editor,position:"relative",zIndex:1},onClick:p=>{(p.target===p.currentTarget||p.target.className.includes("ProseMirror"))&&d.commands.focus("end")}})]})}const zt={container:{padding:"32px 32px 0",width:"100%",height:"100%",backgroundColor:"#fff",overflow:"hidden",display:"flex",flexDirection:"column"},section:{maxWidth:"1200px",margin:"0 auto",width:"100%",height:"100%",display:"flex",flexDirection:"column"},header:{flex:"0 0 auto"},contentContainer:{flex:1,overflow:"auto",minHeight:0},title:{fontSize:"16px",fontWeight:"500",marginBottom:"8px",color:"#1f2937"},tabs:{display:"flex",gap:"24px",marginBottom:"16px",borderBottom:"1px solid #e5e7eb"},tab:{padding:"12px 0",fontSize:"14px",color:"#6b7280",cursor:"pointer",borderBottomWidth:"2px",borderBottomStyle:"solid",borderBottomColor:"transparent",marginBottom:"-1px"},activeTab:{color:"#2563eb",borderBottomColor:"#2563eb"},formGrid:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",columnGap:"24px",rowGap:"8px"},field:{marginBottom:"8px"},label:{display:"block",fontSize:"14px",color:"#4b5563",marginBottom:"8px"},sublabel:{display:"block",fontSize:"14px",color:"#6b7280",marginBottom:"8px"},select:{width:"100%",padding:"8px 12px",fontSize:"14px",border:"1px solid #d1d5db",borderRadius:"6px",color:"#1f2937",backgroundColor:"#fff",cursor:"pointer",appearance:"none",backgroundImage:'url("data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2224%22%20height%3D%2224%22%20viewBox%3D%220%200%2024%2024%22%20fill%3D%22none%22%20stroke%3D%22%236b7280%22%20stroke-width%3D%222%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%3E%3Cpolyline%20points%3D%226%209%2012%2015%2018%209%22%3E%3C%2Fpolyline%3E%3C%2Fsvg%3E")',backgroundRepeat:"no-repeat",backgroundPosition:"right 8px center",backgroundSize:"16px",paddingRight:"32px"},input:{width:"100%",padding:"8px 12px",fontSize:"14px",border:"1px solid #d1d5db",borderRadius:"6px",color:"#1f2937",backgroundColor:"#fff","&:focus":{outline:"none",borderColor:"#2563eb",boxShadow:"0 0 0 2px rgba(37, 99, 235, 0.2)"}},sectionTitle:{fontSize:"16px",fontWeight:"500",marginTop:"8px",color:"#1f2937"}},pn={overlay:{backgroundColor:"rgba(0, 0, 0, 0.4)",position:"fixed",inset:0,animation:"overlayShow 150ms cubic-bezier(0.16, 1, 0.3, 1)"},content:{backgroundColor:"white",borderRadius:"8px",boxShadow:"0 10px 25px rgba(0, 0, 0, 0.2)",position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"90vw",maxWidth:"600px",maxHeight:"85vh",padding:"24px"},title:{fontSize:"20px",fontWeight:"500",color:"#1f2937",marginBottom:"24px"},field:{marginBottom:"24px"},label:{display:"block",fontSize:"14px",color:"#4b5563",marginBottom:"8px"},input:{width:"100%",padding:"8px 12px",fontSize:"14px",border:"1px solid #d1d5db",borderRadius:"6px",color:"#1f2937"},textarea:{width:"100%",padding:"8px 12px",fontSize:"14px",border:"1px solid #d1d5db",borderRadius:"6px",color:"#1f2937",minHeight:"200px",resize:"vertical"},closeButton:{position:"absolute",top:"16px",right:"16px",padding:"4px",color:"#6b7280",cursor:"pointer",background:"none",border:"none","&:hover":{color:"#1f2937"}},footer:{display:"flex",justifyContent:"flex-end",gap:"12px",marginTop:"24px"},cancelButton:{padding:"8px 16px",fontSize:"14px",color:"#6b7280",backgroundColor:"#f3f4f6",border:"none",borderRadius:"6px",cursor:"pointer","&:hover":{backgroundColor:"#e5e7eb"}},saveButton:{padding:"8px 16px",fontSize:"14px",color:"white",backgroundColor:"#2563eb",border:"none",borderRadius:"6px",cursor:"pointer","&:hover":{backgroundColor:"#1d4ed8"}}};function gH({open:t,onClose:e,onSave:n}){const[r,i]=m.useState(""),[o,s]=m.useState(""),a=()=>{n(r,o),i(""),s(""),e()};return f.jsx(ml,{open:t,onOpenChange:e,children:f.jsxs(gl,{children:[f.jsx(yl,{style:pn.overlay}),f.jsxs(vl,{style:pn.content,children:[f.jsx(xl,{style:pn.title,children:"Create snippet"}),f.jsx("button",{style:pn.closeButton,onClick:e,children:f.jsx(Bs,{})}),f.jsxs("div",{style:pn.field,children:[f.jsx("label",{style:pn.label,children:"Shorthand"}),f.jsx("div",{style:{position:"relative"},children:f.jsx("input",{style:pn.input,type:"text",value:r,onChange:l=>i(l.target.value),placeholder:"Short, memorable trigger for your snippet"})})]}),f.jsxs("div",{style:pn.field,children:[f.jsx("label",{style:pn.label,children:"Content"}),f.jsx("textarea",{style:pn.textarea,value:o,onChange:l=>s(l.target.value),placeholder:"Type or paste your snippet content here..."})]}),f.jsxs("div",{style:pn.footer,children:[f.jsx("button",{style:pn.cancelButton,onClick:e,children:"Cancel"}),f.jsx("button",{style:pn.saveButton,onClick:a,disabled:!r.trim()||!o.trim(),children:"Create Snippet"})]})]})]})})}const kt={...zt,section:{marginBottom:"48px"},description:{fontSize:"14px",color:"#6b7280",marginBottom:"24px"},table:{width:"100%",backgroundColor:"#f3f6f9",borderRadius:"8px",padding:"16px"},tableHeader:{display:"grid",gridTemplateColumns:"1fr 1fr auto",gap:"16px",padding:"8px 16px",color:"#6b7280",fontSize:"14px",fontWeight:"500"},tableRow:{display:"grid",gridTemplateColumns:"1fr 1fr auto",gap:"16px",padding:"8px 16px",alignItems:"center"},addButton:{display:"flex",alignItems:"center",gap:"8px",color:"#6b7280",fontSize:"14px",padding:"8px 16px",cursor:"pointer",border:"none",background:"none","&:hover":{color:"#2563eb"}},iconButton:{padding:"4px",border:"none",background:"none",cursor:"pointer",color:"#6b7280","&:hover":{color:"#ef4444"}},snippetCard:{backgroundColor:"white",borderRadius:"8px",padding:"16px",marginBottom:"16px",border:"1px solid #e5e7eb"},snippetHeader:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},snippetCommand:{fontSize:"14px",fontWeight:"500",color:"#1f2937"},snippetText:{fontSize:"14px",color:"#6b7280"}};function ZO(){const[t,e]=m.useState([{command:"/test",text:"Tests are not covered under your insurance and may be subject..."}]);return{snippets:t,addSnippet:(i,o)=>{e([...t,{command:`/${i}`,text:o}])},deleteSnippet:i=>{e(t.filter((o,s)=>s!==i))}}}function yH(){const[t,e]=m.useState([{instead:"Chi",doThis:"Qi"}]),{snippets:n,addSnippet:r,deleteSnippet:i}=ZO(),[o,s]=m.useState(!1),a=()=>{e([...t,{instead:"",doThis:""}])},l=u=>{e(t.filter((d,h)=>h!==u))},c=(u,d)=>{r(u,d)};return f.jsxs("div",{style:{height:"100%",overflow:"auto",paddingRight:"16px"},children:[f.jsxs("div",{style:kt.section,children:[f.jsx("h2",{style:zt.sectionTitle,children:"Replace"}),f.jsx("p",{style:kt.description,children:"Specify any abbreviations or alternative spellings of words you use in your notes"}),f.jsxs("div",{style:kt.table,children:[f.jsxs("div",{style:kt.tableHeader,children:[f.jsx("div",{children:"Instead of"}),f.jsx("div",{children:"Do this"}),f.jsx("div",{})]}),t.map((u,d)=>f.jsxs("div",{style:kt.tableRow,children:[f.jsx("input",{style:zt.input,value:u.instead,placeholder:"Type word or phrase"}),f.jsx("input",{style:zt.input,value:u.doThis,placeholder:"Type replacement"}),f.jsx("button",{style:kt.iconButton,onClick:()=>l(d),children:f.jsx(Py,{width:20,height:20})})]},d))]}),f.jsxs("button",{style:kt.addButton,onClick:a,children:[f.jsx(uu,{width:20,height:20}),"New replacement"]})]}),f.jsxs("div",{style:kt.section,children:[f.jsx("h2",{style:zt.sectionTitle,children:"Snippets"}),f.jsx("p",{style:kt.description,children:"Type / to insert your pre-written text snippets"}),n.map((u,d)=>f.jsxs("div",{style:kt.snippetCard,children:[f.jsxs("div",{style:kt.snippetHeader,children:[f.jsx("div",{style:kt.snippetCommand,children:u.command}),f.jsxs("div",{style:{display:"flex",gap:"8px"},children:[f.jsx("button",{style:kt.iconButton,children:f.jsx(V_,{width:20,height:20})}),f.jsx("button",{style:kt.iconButton,onClick:()=>i(d),children:f.jsx(Py,{width:20,height:20})})]})]}),f.jsx("div",{style:kt.snippetText,children:u.text})]},d)),f.jsxs("button",{style:kt.addButton,onClick:()=>s(!0),children:[f.jsx(uu,{width:20,height:20}),"New snippet"]})]}),f.jsx(gH,{open:o,onClose:()=>s(!1),onSave:c})]})}const Sr={tabsContainer:{display:"flex",gap:"1px",alignItems:"flex-end",height:"44px",flexShrink:0,overflow:"auto hidden",WebkitOverflowScrolling:"touch",borderBottom:"1px solid #e5e7eb",position:"relative",zIndex:10},tab:{padding:"0 12px",backgroundColor:"#f3f4f6",borderTopLeftRadius:"6px",borderTopRightRadius:"6px",borderBottomLeftRadius:"0px",borderBottomRightRadius:"0px",cursor:"pointer",fontWeight:"500",color:"#6b7280",transition:"all 0.15s ease",height:"44px",display:"flex",alignItems:"center",fontSize:"13px",whiteSpace:"nowrap",position:"relative",marginBottom:"-1px","&:hover":{backgroundColor:"#f9fafb"}},activeTab:{backgroundColor:"#ffffff",color:"#111827",zIndex:1,borderLeft:"1px solid rgb(229, 231, 235)",borderRight:"1px solid rgb(229, 231, 235)",borderTop:"1px solid rgb(229, 231, 235)"},generateButton:{display:"flex",alignItems:"center",justifyContent:"center",minWidth:"32px",height:"32px",padding:0,backgroundColor:"#ffffff",border:"1px solid #e5e7eb",borderRadius:"6px",cursor:"pointer",transition:"all 0.15s ease",fontSize:"16px",lineHeight:"1",flexShrink:0,marginLeft:"4px",marginBottom:"4px",boxShadow:"0 1px 2px rgba(0, 0, 0, 0.05)","&:hover":{backgroundColor:"#f9fafb"}}};function vH({activeTab:t,setActiveTab:e,aiContextVersion:n,soapNoteVersion:r,templateNotes:i,onOpenTemplateModal:o}){const a=[...i].sort((l,c)=>{const u=new Date(l.created_at||0),d=new Date(c.created_at||0);return u.getTime()-d.getTime()}).reduce((l,c)=>{const u=l.find(d=>d.template_id===c.template_id);return!u||(u.version_id||0)<(c.version_id||0)?[...l.filter(h=>h.template_id!==c.template_id),c]:l},[]);return console.log("[TranscriptionTabs] Template notes:",a),f.jsxs("div",{style:Sr.tabsContainer,className:"tabs-container",children:[f.jsx("button",{style:{...Sr.tab,...t==="transcript"?Sr.activeTab:{}},onClick:()=>e("transcript"),children:"Transcript"}),n&&f.jsxs("button",{style:{...Sr.tab,...t==="ai_context"?Sr.activeTab:{}},onClick:()=>e("ai_context"),children:["Context ",n>1?` (v${n})`:""]}),r&&f.jsxs("button",{style:{...Sr.tab,...t==="soap"?Sr.activeTab:{}},onClick:()=>e("soap"),children:["SOAP Note ",r>1?` (v${r})`:""]}),a.map(l=>{const c=l.metadata;return f.jsxs("button",{style:{...Sr.tab,...t===l.template_id?Sr.activeTab:{}},onClick:()=>e(l.template_id||""),children:[(c==null?void 0:c.template_name)||"Template Note",l.version_id&&l.version_id>1?` (v${l.version_id})`:""]},l.template_id)}),r&&f.jsx("button",{style:Sr.generateButton,onClick:o,title:"Generate from template",children:"+"})]})}function Cp(){const t=Qe();return{getValidSessionToken:async()=>{const{data:{session:n},error:r}=await t.auth.getSession();if(r)throw new Error("Failed to get session: "+r.message);if(!(n!=null&&n.access_token)){const{data:{session:i},error:o}=await t.auth.refreshSession();if(o||!(i!=null&&i.access_token))throw new Error("No valid session available");return console.log("[Session] Using refreshed session token"),i.access_token}return console.log("[Session] Using existing session token"),n.access_token}}}function xH({visitId:t,onSuccess:e}){const[n,r]=m.useState(!1),i=Qe(),{getValidSessionToken:o}=Cp();return{generateFromTemplate:async a=>{if(!(!t||n)){r(!0);try{const{data:l,error:c}=await i.from("notes").insert({visit_id:t,content:"Generating note...",type:"template",template_id:a.id,metadata:{template_name:a.name,status:"processing"},user_facing:!0,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}).select("id").single();if(c){console.error("Error creating placeholder note:",c);return}const{data:u,error:d}=await i.from("notes").select("*").eq("visit_id",t).eq("type","template").order("created_at",{ascending:!1});!d&&u&&(e==null||e(a.id,u));const h=await o(),p=await fetch(`${Fr.apiUrl}/generate-from-template`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${h}`},body:JSON.stringify({visitId:t,templateId:a.id,noteId:l.id})});if(!p.ok){const g=await p.json();throw new Error(g.error||"Failed to generate note")}}catch(l){console.error("Error generating template note:",l);const{error:c}=await i.from("notes").upsert({visit_id:t,content:"Failed to generate note. Please try again.",type:"template",user_facing:!0,updated_at:new Date().toISOString(),metadata:{template_id:a.id,template_name:a.name,status:"error"}},{onConflict:"visit_id,type,metadata->template_id"});c&&console.error("Error updating note status:",c)}finally{r(!1)}}},isGenerating:n}}var wH="VisuallyHidden",kp=m.forwardRef((t,e)=>f.jsx(se.span,{...t,ref:e,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...t.style}}));kp.displayName=wH;var Dx="ToastProvider",[Lx,bH,SH]=Zh("Toast"),[eP,YW]=yi("Toast",[SH]),[CH,Ep]=eP(Dx),tP=t=>{const{__scopeToast:e,label:n="Notification",duration:r=5e3,swipeDirection:i="right",swipeThreshold:o=50,children:s}=t,[a,l]=m.useState(null),[c,u]=m.useState(0),d=m.useRef(!1),h=m.useRef(!1);return n.trim()||console.error(`Invalid prop \`label\` supplied to \`${Dx}\`. Expected non-empty \`string\`.`),f.jsx(Lx.Provider,{scope:e,children:f.jsx(CH,{scope:e,label:n,duration:r,swipeDirection:i,swipeThreshold:o,toastCount:c,viewport:a,onViewportChange:l,onToastAdd:m.useCallback(()=>u(p=>p+1),[]),onToastRemove:m.useCallback(()=>u(p=>p-1),[]),isFocusedToastEscapeKeyDownRef:d,isClosePausedRef:h,children:s})})};tP.displayName=Dx;var nP="ToastViewport",kH=["F8"],rv="toast.viewportPause",iv="toast.viewportResume",rP=m.forwardRef((t,e)=>{const{__scopeToast:n,hotkey:r=kH,label:i="Notifications ({hotkey})",...o}=t,s=Ep(nP,n),a=bH(n),l=m.useRef(null),c=m.useRef(null),u=m.useRef(null),d=m.useRef(null),h=Se(e,d,s.onViewportChange),p=r.join("+").replace(/Key/g,"").replace(/Digit/g,""),g=s.toastCount>0;m.useEffect(()=>{const x=v=>{var b;r.length!==0&&r.every(S=>v[S]||v.code===S)&&((b=d.current)==null||b.focus())};return document.addEventListener("keydown",x),()=>document.removeEventListener("keydown",x)},[r]),m.useEffect(()=>{const x=l.current,v=d.current;if(g&&x&&v){const w=()=>{if(!s.isClosePausedRef.current){const k=new CustomEvent(rv);v.dispatchEvent(k),s.isClosePausedRef.current=!0}},b=()=>{if(s.isClosePausedRef.current){const k=new CustomEvent(iv);v.dispatchEvent(k),s.isClosePausedRef.current=!1}},S=k=>{!x.contains(k.relatedTarget)&&b()},C=()=>{x.contains(document.activeElement)||b()};return x.addEventListener("focusin",w),x.addEventListener("focusout",S),x.addEventListener("pointermove",w),x.addEventListener("pointerleave",C),window.addEventListener("blur",w),window.addEventListener("focus",b),()=>{x.removeEventListener("focusin",w),x.removeEventListener("focusout",S),x.removeEventListener("pointermove",w),x.removeEventListener("pointerleave",C),window.removeEventListener("blur",w),window.removeEventListener("focus",b)}}},[g,s.isClosePausedRef]);const y=m.useCallback(({tabbingDirection:x})=>{const w=a().map(b=>{const S=b.ref.current,C=[S,...$H(S)];return x==="forwards"?C:C.reverse()});return(x==="forwards"?w.reverse():w).flat()},[a]);return m.useEffect(()=>{const x=d.current;if(x){const v=w=>{var C,k,E;const b=w.altKey||w.ctrlKey||w.metaKey;if(w.key==="Tab"&&!b){const T=document.activeElement,R=w.shiftKey;if(w.target===x&&R){(C=c.current)==null||C.focus();return}const L=y({tabbingDirection:R?"backwards":"forwards"}),N=L.findIndex(M=>M===T);Xm(L.slice(N+1))?w.preventDefault():R?(k=c.current)==null||k.focus():(E=u.current)==null||E.focus()}};return x.addEventListener("keydown",v),()=>x.removeEventListener("keydown",v)}},[a,y]),f.jsxs(TL,{ref:l,role:"region","aria-label":i.replace("{hotkey}",p),tabIndex:-1,style:{pointerEvents:g?void 0:"none"},children:[g&&f.jsx(ov,{ref:c,onFocusFromOutsideViewport:()=>{const x=y({tabbingDirection:"forwards"});Xm(x)}}),f.jsx(Lx.Slot,{scope:n,children:f.jsx(se.ol,{tabIndex:-1,...o,ref:h})}),g&&f.jsx(ov,{ref:u,onFocusFromOutsideViewport:()=>{const x=y({tabbingDirection:"backwards"});Xm(x)}})]})});rP.displayName=nP;var iP="ToastFocusProxy",ov=m.forwardRef((t,e)=>{const{__scopeToast:n,onFocusFromOutsideViewport:r,...i}=t,o=Ep(iP,n);return f.jsx(kp,{"aria-hidden":!0,tabIndex:0,...i,ref:e,style:{position:"fixed"},onFocus:s=>{var c;const a=s.relatedTarget;!((c=o.viewport)!=null&&c.contains(a))&&r()}})});ov.displayName=iP;var Tp="Toast",EH="toast.swipeStart",TH="toast.swipeMove",_H="toast.swipeCancel",RH="toast.swipeEnd",oP=m.forwardRef((t,e)=>{const{forceMount:n,open:r,defaultOpen:i,onOpenChange:o,...s}=t,[a=!0,l]=As({prop:r,defaultProp:i,onChange:o});return f.jsx(yr,{present:n||a,children:f.jsx(MH,{open:a,...s,ref:e,onClose:()=>l(!1),onPause:It(t.onPause),onResume:It(t.onResume),onSwipeStart:K(t.onSwipeStart,c=>{c.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:K(t.onSwipeMove,c=>{const{x:u,y:d}=c.detail.delta;c.currentTarget.setAttribute("data-swipe","move"),c.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${u}px`),c.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${d}px`)}),onSwipeCancel:K(t.onSwipeCancel,c=>{c.currentTarget.setAttribute("data-swipe","cancel"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),c.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),c.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:K(t.onSwipeEnd,c=>{const{x:u,y:d}=c.detail.delta;c.currentTarget.setAttribute("data-swipe","end"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),c.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${u}px`),c.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${d}px`),l(!1)})})})});oP.displayName=Tp;var[OH,PH]=eP(Tp,{onClose(){}}),MH=m.forwardRef((t,e)=>{const{__scopeToast:n,type:r="foreground",duration:i,open:o,onClose:s,onEscapeKeyDown:a,onPause:l,onResume:c,onSwipeStart:u,onSwipeMove:d,onSwipeCancel:h,onSwipeEnd:p,...g}=t,y=Ep(Tp,n),[x,v]=m.useState(null),w=Se(e,M=>v(M)),b=m.useRef(null),S=m.useRef(null),C=i||y.duration,k=m.useRef(0),E=m.useRef(C),T=m.useRef(0),{onToastAdd:R,onToastRemove:_}=y,A=It(()=>{var z;(x==null?void 0:x.contains(document.activeElement))&&((z=y.viewport)==null||z.focus()),s()}),L=m.useCallback(M=>{!M||M===1/0||(window.clearTimeout(T.current),k.current=new Date().getTime(),T.current=window.setTimeout(A,M))},[A]);m.useEffect(()=>{const M=y.viewport;if(M){const z=()=>{L(E.current),c==null||c()},$=()=>{const V=new Date().getTime()-k.current;E.current=E.current-V,window.clearTimeout(T.current),l==null||l()};return M.addEventListener(rv,$),M.addEventListener(iv,z),()=>{M.removeEventListener(rv,$),M.removeEventListener(iv,z)}}},[y.viewport,C,l,c,L]),m.useEffect(()=>{o&&!y.isClosePausedRef.current&&L(C)},[o,C,y.isClosePausedRef,L]),m.useEffect(()=>(R(),()=>_()),[R,_]);const N=m.useMemo(()=>x?dP(x):null,[x]);return y.viewport?f.jsxs(f.Fragment,{children:[N&&f.jsx(IH,{__scopeToast:n,role:"status","aria-live":r==="foreground"?"assertive":"polite","aria-atomic":!0,children:N}),f.jsx(OH,{scope:n,onClose:A,children:Gs.createPortal(f.jsx(Lx.ItemSlot,{scope:n,children:f.jsx(EL,{asChild:!0,onEscapeKeyDown:K(a,()=>{y.isFocusedToastEscapeKeyDownRef.current||A(),y.isFocusedToastEscapeKeyDownRef.current=!1}),children:f.jsx(se.li,{role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":o?"open":"closed","data-swipe-direction":y.swipeDirection,...g,ref:w,style:{userSelect:"none",touchAction:"none",...t.style},onKeyDown:K(t.onKeyDown,M=>{M.key==="Escape"&&(a==null||a(M.nativeEvent),M.nativeEvent.defaultPrevented||(y.isFocusedToastEscapeKeyDownRef.current=!0,A()))}),onPointerDown:K(t.onPointerDown,M=>{M.button===0&&(b.current={x:M.clientX,y:M.clientY})}),onPointerMove:K(t.onPointerMove,M=>{if(!b.current)return;const z=M.clientX-b.current.x,$=M.clientY-b.current.y,V=!!S.current,I=["left","right"].includes(y.swipeDirection),P=["left","up"].includes(y.swipeDirection)?Math.min:Math.max,D=I?P(0,z):0,H=I?0:P(0,$),Z=M.pointerType==="touch"?10:2,he={x:D,y:H},pe={originalEvent:M,delta:he};V?(S.current=he,qd(TH,d,pe,{discrete:!1})):PS(he,y.swipeDirection,Z)?(S.current=he,qd(EH,u,pe,{discrete:!1}),M.target.setPointerCapture(M.pointerId)):(Math.abs(z)>Z||Math.abs($)>Z)&&(b.current=null)}),onPointerUp:K(t.onPointerUp,M=>{const z=S.current,$=M.target;if($.hasPointerCapture(M.pointerId)&&$.releasePointerCapture(M.pointerId),S.current=null,b.current=null,z){const V=M.currentTarget,I={originalEvent:M,delta:z};PS(z,y.swipeDirection,y.swipeThreshold)?qd(RH,p,I,{discrete:!0}):qd(_H,h,I,{discrete:!0}),V.addEventListener("click",P=>P.preventDefault(),{once:!0})}})})})}),y.viewport)})]}):null}),IH=t=>{const{__scopeToast:e,children:n,...r}=t,i=Ep(Tp,e),[o,s]=m.useState(!1),[a,l]=m.useState(!1);return DH(()=>s(!0)),m.useEffect(()=>{const c=window.setTimeout(()=>l(!0),1e3);return()=>window.clearTimeout(c)},[]),a?null:f.jsx(Ul,{asChild:!0,children:f.jsx(kp,{...r,children:o&&f.jsxs(f.Fragment,{children:[i.label," ",n]})})})},AH="ToastTitle",sP=m.forwardRef((t,e)=>{const{__scopeToast:n,...r}=t;return f.jsx(se.div,{...r,ref:e})});sP.displayName=AH;var NH="ToastDescription",aP=m.forwardRef((t,e)=>{const{__scopeToast:n,...r}=t;return f.jsx(se.div,{...r,ref:e})});aP.displayName=NH;var lP="ToastAction",jH=m.forwardRef((t,e)=>{const{altText:n,...r}=t;return n.trim()?f.jsx(uP,{altText:n,asChild:!0,children:f.jsx($x,{...r,ref:e})}):(console.error(`Invalid prop \`altText\` supplied to \`${lP}\`. Expected non-empty \`string\`.`),null)});jH.displayName=lP;var cP="ToastClose",$x=m.forwardRef((t,e)=>{const{__scopeToast:n,...r}=t,i=PH(cP,n);return f.jsx(uP,{asChild:!0,children:f.jsx(se.button,{type:"button",...r,ref:e,onClick:K(t.onClick,i.onClose)})})});$x.displayName=cP;var uP=m.forwardRef((t,e)=>{const{__scopeToast:n,altText:r,...i}=t;return f.jsx(se.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":r||void 0,...i,ref:e})});function dP(t){const e=[];return Array.from(t.childNodes).forEach(r=>{if(r.nodeType===r.TEXT_NODE&&r.textContent&&e.push(r.textContent),LH(r)){const i=r.ariaHidden||r.hidden||r.style.display==="none",o=r.dataset.radixToastAnnounceExclude==="";if(!i)if(o){const s=r.dataset.radixToastAnnounceAlt;s&&e.push(s)}else e.push(...dP(r))}}),e}function qd(t,e,n,{discrete:r}){const i=n.originalEvent.currentTarget,o=new CustomEvent(t,{bubbles:!0,cancelable:!0,detail:n});e&&i.addEventListener(t,e,{once:!0}),r?P0(i,o):i.dispatchEvent(o)}var PS=(t,e,n=0)=>{const r=Math.abs(t.x),i=Math.abs(t.y),o=r>i;return e==="left"||e==="right"?o&&r>n:!o&&i>n};function DH(t=()=>{}){const e=It(t);Mt(()=>{let n=0,r=0;return n=window.requestAnimationFrame(()=>r=window.requestAnimationFrame(e)),()=>{window.cancelAnimationFrame(n),window.cancelAnimationFrame(r)}},[e])}function LH(t){return t.nodeType===t.ELEMENT_NODE}function $H(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const i=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||i?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function Xm(t){const e=document.activeElement;return t.some(n=>n===e?!0:(n.focus(),document.activeElement!==e))}var FH=tP,BH=rP,zH=oP,VH=sP,UH=aP,HH=$x;const WH=`
  .toast-close-button {
    all: unset;
    cursor: pointer;
    color: #9CA3AF;
    flex-shrink: 0;
    padding: 2px;
    border-radius: 4px;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s ease;
  }
  
  .toast-close-button:hover {
    background-color: #F3F4F6;
    color: #6B7280;
  }

  @keyframes slideIn {
    from {
      transform: translateY(100%);
      opacity: 0;
    }
    to {
      transform: translateY(0);
      opacity: 1;
    }
  }

  @keyframes slideOut {
    from {
      transform: translateY(0);
      opacity: 1;
    }
    to {
      transform: translateY(100%);
      opacity: 0;
    }
  }

  .toast-root[data-state='open'] {
    animation: slideIn 300ms cubic-bezier(0.16, 1, 0.3, 1);
  }

  .toast-root[data-state='closed'] {
    animation: slideOut 300ms cubic-bezier(0.16, 1, 0.3, 1);
  }
`,ha={viewport:{position:"fixed",bottom:"32px",left:"50%",transform:"translateX(-50%)",display:"flex",flexDirection:"column",padding:"25px",gap:"10px",width:"fit-content",minWidth:"300px",maxWidth:"480px",listStyle:"none",zIndex:2147483647,outline:"none"},toast:{backgroundColor:"white",borderRadius:"8px",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.15)",padding:"16px",display:"flex",alignItems:"flex-start",justifyContent:"space-between",gap:"12px",border:"1px solid #e5e7eb",width:"100%"},title:{color:"#111827",fontSize:"14px",fontWeight:600,marginBottom:"4px"},description:{color:"#6b7280",fontSize:"13px"},icon:{flexShrink:0,marginTop:"2px"}},fP=m.createContext(null);function KH({children:t}){const[e,n]=m.useState({open:!1,title:"",description:"",type:"success"}),r=(i,o,s="success")=>{n({open:!0,title:i,description:o,type:s})};return f.jsx(fP.Provider,{value:{showToast:r},children:f.jsxs(FH,{swipeDirection:"down",duration:2e3,children:[f.jsx("style",{children:WH}),t,f.jsxs(zH,{open:e.open,onOpenChange:i=>n(o=>({...o,open:i})),style:ha.toast,className:"toast-root",children:[f.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"12px",flex:1},children:[e.type==="success"?f.jsx(RF,{size:18,style:{...ha.icon,color:"#10b981"}}):f.jsx(TF,{size:18,style:{...ha.icon,color:"#ef4444"}}),f.jsxs("div",{style:{flex:1},children:[f.jsx(VH,{style:ha.title,children:e.title}),f.jsx(UH,{style:ha.description,children:e.description})]})]}),f.jsx(HH,{asChild:!0,children:f.jsx("button",{className:"toast-close-button",children:f.jsx(o5,{size:16})})})]}),f.jsx(BH,{style:ha.viewport})]})})}function hP(){const t=m.useContext(fP);if(!t)throw new Error("useToast must be used within a ToastProvider");return t}function Nt(){const t=Qe(),e=Hr(),{data:n,isLoading:r,error:i}=iu({queryKey:["user"],queryFn:async()=>{const o=e.getQueryData(["user"]);if(o)return o;const{data:{user:s},error:a}=await t.auth.getUser();if(a)throw a;if(!s)return null;try{const{data:l,error:c}=await t.from("user_profiles").select("*").eq("id",s.id).single();if(c){if(c.code==="PGRST116")return s;throw c}return{...s,...l}}catch{return s}},staleTime:1/0,gcTime:30*60*1e3,retry:!1,refetchOnMount:!1,refetchOnWindowFocus:!1});return m.useEffect(()=>{const{data:{subscription:o}}=t.auth.onAuthStateChange((s,a)=>{s==="SIGNED_OUT"?e.setQueryData(["user"],null):a!=null&&a.user&&e.invalidateQueries({queryKey:["user"]})});return()=>{o.unsubscribe()}},[t,e]),m.useEffect(()=>{if(!(n!=null&&n.id))return;const o=t.channel(`profile-changes-${n.id}`).on("postgres_changes",{event:"*",schema:"public",table:"user_profiles",filter:`id=eq.${n.id}`},s=>{s.new&&e.setQueryData(["user"],a=>a?{...a,name:s.new.name,specialty:s.new.specialty,note_preferences:s.new.note_preferences}:null)}).subscribe();return()=>{o.unsubscribe()}},[t,n==null?void 0:n.id,e]),{user:n,loading:r,error:(i==null?void 0:i.message)||null}}function MS(t){return typeof t=="object"&&t!==null&&"default_copy_mode"in t&&typeof t.default_copy_mode=="string"}function qH(t,e){switch(e){case"plain":return t.getText();case"rich_text":return t.getHTML();case"without_lists":return t.getText();default:return t.getText()}}const ke={toolbar:{display:"flex",gap:"4px",alignItems:"center"},button:{padding:"8px",backgroundColor:"#f3f4f6",border:"1px solid #e5e7eb",borderRadius:"4px",cursor:"pointer",color:"#6b7280",display:"flex",alignItems:"center",justifyContent:"center",height:"36px",width:"36px",transition:"all 0.2s ease","&:hover:not(:disabled)":{backgroundColor:"#e5e7eb"},"&:disabled":{opacity:.5,cursor:"not-allowed",backgroundColor:"#f3f4f6"}},divider:{width:"1px",height:"24px",backgroundColor:"#e5e7eb",margin:"0 4px"},buttonContainer:{position:"relative"},dropdown:{position:"absolute",top:"calc(100% + 4px)",right:"0",backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"6px",padding:"4px",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)",zIndex:1e3,minWidth:"180px"},dropdownButton:{width:"100%",padding:"8px 12px",border:"none",backgroundColor:"transparent",cursor:"pointer",textAlign:"left",fontSize:"14px",color:"#6b7280",borderRadius:"4px","&:hover":{backgroundColor:"#f3f4f6"}},modal:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",backgroundColor:"white",padding:"24px",borderRadius:"8px",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1)",zIndex:100,width:"400px"},modalOverlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",zIndex:99},modalTitle:{fontSize:"18px",fontWeight:"600",color:"#111827",marginBottom:"16px"},modalText:{fontSize:"14px",color:"#4b5563",marginBottom:"24px",lineHeight:"1.5"},modalButtons:{display:"flex",gap:"8px",justifyContent:"flex-end"},modalButton:{padding:"8px 16px",borderRadius:"6px",fontSize:"14px",fontWeight:"500",cursor:"pointer",border:"1px solid #e5e7eb"},modalButtonPrimary:{backgroundColor:"#ef4444",color:"white",border:"none","&:hover":{backgroundColor:"#dc2626"}},modalButtonSecondary:{backgroundColor:"white",color:"#6b7280","&:hover":{backgroundColor:"#f3f4f6"}},copyButtonGroup:{display:"flex",alignItems:"center",gap:"1px"},copyMainButton:{padding:"8px",backgroundColor:"#f3f4f6",border:"1px solid #e5e7eb",borderRadius:"4px 0 0 4px",cursor:"pointer",color:"#6b7280",display:"flex",alignItems:"center",justifyContent:"center",height:"36px",width:"36px",transition:"all 0.2s ease","&:hover":{backgroundColor:"#e5e7eb"}},copyDropdownButton:{padding:"8px 4px",backgroundColor:"#f3f4f6",border:"1px solid #e5e7eb",borderLeft:"none",borderRadius:"0 4px 4px 0",cursor:"pointer",color:"#6b7280",display:"flex",alignItems:"center",justifyContent:"center",height:"36px",width:"24px",transition:"all 0.2s ease","&:hover":{backgroundColor:"#e5e7eb"}},dropdownContent:{minWidth:"220px",backgroundColor:"white",borderRadius:"6px",padding:"5px",boxShadow:"0px 10px 38px -10px rgba(22, 23, 24, 0.35), 0px 10px 20px -15px rgba(22, 23, 24, 0.2)",zIndex:20},dropdownItem:{fontSize:"14px",lineHeight:"1",color:"#374151",borderRadius:"3px",display:"flex",alignItems:"center",justifyContent:"space-between",height:"32px",padding:"0 8px",userSelect:"none",outline:"none",cursor:"pointer","&:hover":{backgroundColor:"#f3f4f6"}},selectedDropdownItem:{backgroundColor:"#f0f9ff",color:"#2563eb","&:hover":{backgroundColor:"#e0f2fe"}},checkmark:{color:"#2563eb",marginLeft:"8px"},toastViewport:{position:"fixed",bottom:0,right:0,display:"flex",flexDirection:"column",padding:"25px",gap:"10px",width:"390px",listStyle:"none",zIndex:2147483647,outline:"none"},toast:{backgroundColor:"white",borderRadius:"6px",boxShadow:"0 2px 10px rgba(0, 0, 0, 0.1)",padding:"15px",display:"flex",alignItems:"center",justifyContent:"space-between",border:"1px solid #e5e7eb"},toastTitle:{color:"#111827",fontSize:"14px",fontWeight:500,marginBottom:"4px"},toastDescription:{color:"#6b7280",fontSize:"13px"},successIcon:{color:"#10b981",marginRight:"12px"}};function GH({editor:t,previousVersions:e=[],onRevertToPreviousVersion:n,hasUnsavedChanges:r=!1,onSave:i,tabType:o,onRegenerateSoapNote:s,onRegenerateCurrentNote:a,template:l=null}){const c=Qe(),{showToast:u}=hP(),{user:d}=Nt(),[h,p]=m.useState(!1),[g,y]=m.useState("plain"),[x,v]=m.useState(!1);m.useEffect(()=>{d!=null&&d.note_preferences&&MS(d.note_preferences)&&y(d.note_preferences.default_copy_mode)},[d==null?void 0:d.note_preferences]);const w=(t==null?void 0:t.can().undo())||e.length>0&&!!n,b=t==null?void 0:t.can().redo(),S=async(_=g)=>{if(t)try{const A=qH(t,_);await navigator.clipboard.writeText(A),u("Copied!",`Content copied as ${_.replace(/_/g," ").toLowerCase()}`,"success")}catch(A){console.error("Failed to copy text:",A),u("Copy Failed","Failed to copy content to clipboard","error")}},C=async _=>{try{if(!(d!=null&&d.id))return;const A=d.note_preferences&&MS(d.note_preferences)?d.note_preferences:{};await c.from("user_profiles").update({note_preferences:{...A,default_copy_mode:_}}).eq("user_id",d.id),y(_),await S(_)}catch(A){console.error("Failed to update default copy mode:",A),u("Error","Failed to update copy mode","error")}},k=()=>{if(!(!t||!w)){if(t.can().undo()){t.chain().focus().undo().run();return}e.length>0&&n&&p(!0)}},E=async()=>{if(!n||e.length===0)return;const _=e[0];await n(_),p(!1)},T=()=>{r&&i&&(i(),u("Saved!","Your changes have been saved","success"))},R=[{value:"plain",label:"Copy as Plain Text"},{value:"rich_text",label:"Copy as Rich Text"},{value:"without_lists",label:"Copy Without Lists"}];return t?f.jsxs("div",{style:ke.toolbar,children:[f.jsx("button",{onClick:k,disabled:!w,style:{...ke.button,opacity:w?1:.5},title:t!=null&&t.can().undo()?"Undo last change":e.length>0?"Revert to previous version":"Nothing to undo",children:f.jsx(ZF,{size:18})}),f.jsx("button",{onClick:()=>t.chain().focus().redo().run(),disabled:!b,style:{...ke.button,opacity:b?1:.5},title:b?"Redo":"Nothing to redo",children:f.jsx(HF,{size:18})}),f.jsx("div",{style:ke.divider}),f.jsx("button",{onClick:T,disabled:!r,style:{...ke.button,...r?{backgroundColor:"#10b981",color:"white",border:"none","&:hover":{backgroundColor:"#059669"}}:{}},title:r?"Save changes":"No unsaved changes",children:f.jsx(qF,{size:18})}),f.jsx("div",{style:ke.divider}),f.jsxs("div",{style:ke.copyButtonGroup,children:[f.jsx("button",{onClick:()=>S(),style:ke.copyMainButton,title:`Copy as ${g.replace(/_/g," ").toUpperCase()}`,children:f.jsx(IF,{size:18})}),f.jsxs(Ds,{children:[f.jsx(Ls,{asChild:!0,children:f.jsx("button",{style:ke.copyDropdownButton,title:"Copy Options",children:f.jsx(W_,{size:14})})}),f.jsx($s,{children:f.jsx(Fs,{style:ke.dropdownContent,sideOffset:5,children:R.map(_=>{const A=_.value===g;return f.jsxs(gt,{style:{...ke.dropdownItem,...A?ke.selectedDropdownItem:{}},onClick:()=>C(_.value),children:[_.label,A&&f.jsx("span",{style:ke.checkmark,children:""})]},_.value)})})})]})]}),f.jsx("div",{style:ke.divider}),f.jsxs(Ds,{children:[f.jsx(Ls,{asChild:!0,children:f.jsx("button",{style:ke.button,title:"More Options",children:f.jsx(NF,{size:18})})}),f.jsx($s,{children:f.jsxs(Fs,{style:ke.dropdownContent,sideOffset:5,children:[f.jsx(gt,{style:ke.dropdownItem,onClick:()=>S(),children:"Copy All"}),l&&f.jsx(gt,{style:ke.dropdownItem,onClick:()=>v(!0),children:"View Template"}),(o==="ai_context"||o==="soap")&&s&&f.jsx(gt,{style:ke.dropdownItem,onClick:()=>{u("Regenerating","Starting SOAP note regeneration...","success"),s()},children:"Regenerate SOAP Note"}),a&&f.jsx(gt,{style:ke.dropdownItem,onClick:()=>{u("Regenerating","Starting note regeneration...","success"),a()},children:"Regenerate Current Note"})]})})]}),h&&f.jsxs(f.Fragment,{children:[f.jsx("div",{style:ke.modalOverlay,onClick:()=>p(!1)}),f.jsxs("div",{style:ke.modal,children:[f.jsx("h3",{style:ke.modalTitle,children:"Revert to Previous Version?"}),f.jsx("p",{style:ke.modalText,children:"This will delete your current changes and restore the previous version of this note. This action cannot be undone."}),f.jsxs("div",{style:ke.modalButtons,children:[f.jsx("button",{onClick:()=>p(!1),style:{...ke.modalButton,...ke.modalButtonSecondary},children:"Cancel"}),f.jsx("button",{onClick:E,style:{...ke.modalButton,...ke.modalButtonPrimary},children:"Revert to Previous Version"})]})]})]}),f.jsx(G_,{isOpen:x,onClose:()=>v(!1),template:l})]}):null}function sv(t,e){const n=t.filter(r=>r.type===e);if(n.length)return n.reduce((r,i)=>(i.version_id||0)>(r.version_id||0)?i:r)}function IS(t,e){var n;return((n=sv(t,e))==null?void 0:n.content)||""}function JH(t){return[...t].sort((e,n)=>(n.version_id||0)-(e.version_id||0))}function YH(t){const e={soap:[],ai_context:[]};return t.forEach(n=>{n.type==="soap"||n.type==="ai_context"?(e[n.type]||(e[n.type]=[]),e[n.type].push(n)):n.type==="template"&&n.template_id&&(e[n.template_id]||(e[n.template_id]=[]),e[n.template_id].push(n))}),Object.keys(e).forEach(n=>{e[n]=JH(e[n])}),e}function QH({visit:t,notes:e,onRevert:n,handleNoteDeleted:r}){const i=Qe(),o=m.useRef(!1),{getValidSessionToken:s}=Cp(),[a,l]=m.useState({noteVersions:{soap:[],ai_context:[]},hasUnsavedChanges:!1,pendingContent:null}),{soapNote:c,aiContext:u,templateNotes:d}=m.useMemo(()=>({soapNote:IS(e,"soap"),aiContext:IS(e,"ai_context"),templateNotes:e.filter(C=>C.type==="template")}),[e]);m.useEffect(()=>{const C=YH(e);console.log("[useNoteManager] Versions:",C),l(k=>({...k,noteVersions:C}))},[e]),m.useEffect(()=>{console.log("[useNoteManager] Visit changed, resetting state:",t.id),l({noteVersions:{soap:[],ai_context:[]},hasUnsavedChanges:!1,pendingContent:null})},[t.id]);const h=m.useCallback(C=>{l(k=>({...k,templateNotes:C}))},[]),p=m.useCallback(()=>{l(C=>({...C,hasUnsavedChanges:!1,pendingContent:null}))},[]),g=m.useCallback((C,k,E)=>{var R;console.log("[handleContentChange] Content:",C,k,E);const T=k==="soap"?c:k==="ai_context"?u:(R=d.find(_=>_.id===E))==null?void 0:R.content;l(_=>({..._,pendingContent:C?{content:C,type:k,noteId:E}:null,hasUnsavedChanges:C!==T}))},[c,u,d,e]),y=m.useCallback((C,k)=>{var E,T;return C==="soap"||C==="ai_context"?((E=a.noteVersions[C])==null?void 0:E[0])||null:(console.log("[getCurrentNote] Template ID:",k,a.noteVersions),((T=a.noteVersions[k||""])==null?void 0:T[0])||null)},[a.noteVersions]),x=m.useCallback((C,k)=>{var E;return C==="soap"||C==="ai_context"?((E=a.noteVersions[C])==null?void 0:E.slice(1))||[]:a.noteVersions[k||""]||[]},[a.noteVersions]),v=m.useCallback(async()=>{if(!t.id||!a.pendingContent||o.current)return!1;o.current=!0;const{content:C,type:k,noteId:E}=a.pendingContent;try{if(k==="template"&&E){const T=e.find(_=>_.id===E),R=((T==null?void 0:T.version_id)||0)+1;await i.from("notes").insert({visit_id:t.id,content:C,type:k,template_id:T==null?void 0:T.template_id,metadata:{...T==null?void 0:T.metadata,status:"edited"},version_id:R,user_facing:!0})}else{const T=e.filter(A=>A.type===k),_=(T.length>0?Math.max(...T.map(A=>A.version_id||0)):0)+1;await i.from("notes").insert({visit_id:t.id,content:C,type:k,version_id:_,user_facing:!0})}return p(),!0}catch(T){throw console.error("Error saving note:",T),T}finally{o.current=!1}},[t.id,e,a.pendingContent,i,p]),w=m.useCallback(async C=>{if(!(!t.id||o.current)){o.current=!0;try{console.log("[revertToPreviousVersion] Deleting note:",C.type,C.template_id);const k=y(C.type,C.template_id||void 0);if(k){console.log("[useNoteManager] Deleting note:",k.id);const{error:E,data:T}=await i.from("notes").delete().eq("id",k.id).select();if(E)throw console.error("[useNoteManager] Error deleting note:",E),E;console.log("[useNoteManager] Delete operation successful, deleted data:",T),r&&k.id&&(console.log("[useNoteManager] Triggering manual note deletion for:",k.id),r(k.id))}else console.log("[useNoteManager] No current note found to delete");l(E=>({...E,hasUnsavedChanges:!1,pendingContent:null})),n==null||n()}catch(k){console.error("[useNoteManager] Error reverting to previous version:",k)}finally{o.current=!1}}},[t.id,i,y,n,r]),b=m.useCallback(async()=>{var C;try{const k=await s(),E=(C=y("soap",""))==null?void 0:C.id;console.log("[regenerateSoapNote] Attempting to regenerate SOAP note with ID:",E);const T=`${Fr.apiUrl}/notes/${E}/regenerate-soap`;console.log("[regenerateSoapNote] Calling endpoint:",T);const R=await fetch(T,{method:"POST",headers:{Authorization:`Bearer ${k}`,"Content-Type":"application/json"}});if(!R.ok){console.error("[regenerateSoapNote] Error response:",R.status,R.statusText);const A=await R.text();throw console.error("[regenerateSoapNote] Error details:",A),new Error(`Failed to regenerate SOAP note: ${R.status} ${R.statusText}`)}const _=await R.json();console.log("[regenerateSoapNote] Successfully regenerated note:",_.id),l(A=>({...A,hasUnsavedChanges:!1,pendingContent:{content:_.content,type:"soap"}})),n==null||n()}catch(k){console.error("Error regenerating SOAP note:",k)}},[y,n]),S=m.useCallback(async C=>{try{const k=await s(),E=`${Fr.apiUrl}/notes/${C}/regenerate-template`;console.log("[regenerateTemplateNote] Calling endpoint:",E);const T=await fetch(E,{method:"POST",headers:{Authorization:`Bearer ${k}`,"Content-Type":"application/json"}});if(!T.ok)throw new Error("Failed to regenerate template note");const R=await T.json();l(_=>({..._,hasUnsavedChanges:!1,pendingContent:{content:R.content,type:"template",noteId:C}})),n==null||n()}catch(k){console.error("Error regenerating template note:",k)}},[n]);return{hasUnsavedChanges:a.hasUnsavedChanges,handleContentChange:g,saveNote:v,revertToPreviousVersion:w,getCurrentNote:y,getPreviousVersions:x,updateTemplateNotes:h,resetState:p,regenerateSoapNote:b,regenerateTemplateNote:S}}const cc={container:{display:"flex",flexDirection:"column",gap:"0px",height:"100%",overflow:"hidden"},transcriptPanel:{flex:1,display:"flex",flexDirection:"column",backgroundColor:"white",border:"1px solid #e5e7eb",borderTop:"none",borderBottomLeftRadius:"6px",borderBottomRightRadius:"6px",padding:"16px",overflow:"hidden",minHeight:0},text:{fontSize:"16px",color:"#374151",lineHeight:"1.5",whiteSpace:"pre-wrap",margin:0,overflow:"auto",flex:1},contentContainer:{flex:1,display:"flex",flexDirection:"column",minHeight:0,height:"100%",overflow:"hidden",gap:"16px"},toolbarSection:{display:"flex",alignItems:"center",justifyContent:"flex-start",gap:"8px",flexShrink:0}};function XH({visit:t,notes:e,handleNoteDeleted:n}){console.log("[ReadyTranscriptionDisplay] Rendering with visit:",{id:t.id,state:t.state}),console.log("[ReadyTranscriptionDisplay] Received notes count:",e.length);const[r,i]=m.useState("transcript"),[o,s]=m.useState(!1),[a,l]=m.useState(null),[c,u]=m.useState(0),{snippets:d}=ZO(),[h,p]=m.useState(""),[g,y]=m.useState(null);m.useEffect(()=>{i("transcript"),u(ee=>ee+1)},[t.id]),m.useEffect(()=>{(async()=>{if(t.id)try{const{data:Q,error:U}=await Ut.from("transcripts").select("full_text").eq("visit_id",t.id).single();if(U){console.error("Error loading transcript:",U);return}p((Q==null?void 0:Q.full_text)||"")}catch(Q){console.error("Error loading transcript:",Q)}})()},[t.id]);const x=m.useCallback(()=>{u(ee=>ee+1)},[]),{hasUnsavedChanges:v,handleContentChange:w,saveNote:b,revertToPreviousVersion:S,getCurrentNote:C,getPreviousVersions:k,updateTemplateNotes:E,resetState:T,regenerateSoapNote:R,regenerateTemplateNote:_}=QH({visit:t,notes:e,onRevert:x,handleNoteDeleted:n}),A=m.useCallback((ee,Q)=>{E(Q),i(ee),s(!1)},[E]),{generateFromTemplate:L,isGenerating:N}=xH({visitId:t.id,onSuccess:A}),M=m.useCallback(ee=>{v&&!window.confirm("You have unsaved changes. Are you sure you want to switch tabs? Your changes will be lost.")||(i(ee),u(Q=>Q+1),T())},[v,T]),z=m.useCallback(async()=>{await b()&&u(Q=>Q+1)},[b]),$=m.useCallback(()=>{if(v){if(!window.confirm("You have unsaved changes. Are you sure you want to create a new template? Your changes will be lost."))return;T()}s(!0)},[v,T]),V=m.useCallback(()=>{s(!1)},[]),I=m.useMemo(()=>e.filter((ee,Q,U)=>Q===U.findIndex(ae=>ae.template_id===ee.template_id)).map(ee=>ee.template_id).filter(ee=>ee!==null),[e]),P=m.useCallback(async()=>{v&&await b(),await R()},[v,b,R]),D=m.useCallback(async()=>{v&&await b();const ee=C("template",r);ee&&await _(ee.id)},[v,b,_,C,r]),H=sv(e,"soap"),Z=sv(e,"ai_context"),he=e.filter(ee=>ee.type==="template"),pe=()=>{if(r==="transcript")return f.jsx("p",{style:cc.text,children:h});if(r==="soap")return f.jsx(Qm,{content:(H==null?void 0:H.content)||"",readOnly:!1,placeholder:"Start typing your SOAP note...",onChange:Q=>w(Q,"soap"),snippets:d,onEditorReady:l},`soap-editor-${c}`);if(r==="ai_context")return f.jsx(Qm,{content:(Z==null?void 0:Z.content)||"",readOnly:!1,placeholder:"Start typing your context note...",onChange:Q=>w(Q,"ai_context"),snippets:d,onEditorReady:l},`ai_context-${c}`);const ee=e.filter(Q=>Q.template_id===r).sort((Q,U)=>(U.version_id||0)-(Q.version_id||0))[0];return f.jsx(Qm,{content:(ee==null?void 0:ee.content)||"",readOnly:!1,placeholder:"Start typing your template note...",onChange:Q=>w(Q,"template",ee==null?void 0:ee.id),snippets:d,onEditorReady:l},`template-${ee==null?void 0:ee.id}-${c}`)};return m.useEffect(()=>{(async()=>{if(!r||r==="transcript"||r==="ai_context"||r==="soap"){y(null);return}try{const{data:Q,error:U}=await Ut.from("template_library").select("*").eq("id",r).limit(1).single();if(U){console.error("Error fetching template:",U),y(null);return}y(Q)}catch(Q){console.error("Error fetching template:",Q),y(null)}})()},[r]),f.jsxs("div",{style:cc.container,children:[f.jsx(vH,{activeTab:r,setActiveTab:M,aiContextVersion:Z==null?void 0:Z.version_id,soapNoteVersion:H==null?void 0:H.version_id,templateNotes:he,onOpenTemplateModal:$}),f.jsx("div",{style:cc.transcriptPanel,children:f.jsxs("div",{style:cc.contentContainer,children:[a&&r!=="transcript"&&f.jsx("div",{style:cc.toolbarSection,children:f.jsx(GH,{editor:a,previousVersions:k(r!=="soap"&&r!=="ai_context"?"template":r,r!=="soap"&&r!=="ai_context"?r:void 0),onRevertToPreviousVersion:S,hasUnsavedChanges:v,onSave:z,tabType:r,onRegenerateSoapNote:P,onRegenerateCurrentNote:r!=="soap"&&r!=="ai_context"&&r!=="transcript"?D:void 0,template:g})}),pe()]})}),f.jsx(c5,{isOpen:o,onClose:V,onGenerate:L,existingTemplateIds:I})]})}const Gd=(...t)=>{};function ZH({visitId:t,onMessage:e}){const[n,r]=m.useState([]),i=m.useRef(!1),o=m.useRef(null),s=m.useCallback(async()=>{if(!t||t==="")return;const{data:a,error:l}=await Ut.from("containers").select("*").eq("visit_id",t).order("chunk_id",{ascending:!0});l||a&&(Gd(`Fetched ${a.length} containers`),r(a),i.current=!0,a.forEach(c=>e==null?void 0:e(c)))},[t,e]);return m.useEffect(()=>{if(!t||t===""){r([]),i.current=!1;return}i.current||s(),o.current&&(o.current.unsubscribe(),o.current=null);const a=Ut.channel(`containers_list_${t}`).on("postgres_changes",{event:"*",schema:"public",table:"containers",filter:`visit_id=eq.${t}`},l=>{switch(Gd("Received realtime event:",l.eventType,l),l.eventType){case vo.INSERT:{const c=l.new;r(u=>{if(u.some(h=>h.id===c.id))return u;const d=[...u,c].sort((h,p)=>h.chunk_id-p.chunk_id);return e==null||e(c),d});break}case vo.UPDATE:{const c=l.new;r(u=>{const d=u.map(h=>h.id===c.id?c:h);return JSON.stringify(d)===JSON.stringify(u)?u:(e==null||e(c),d)});break}case vo.DELETE:{const c=l.old;r(u=>{const d=u.filter(h=>h.id!==c.id);return d.length,u.length,d});break}default:Gd("Unhandled event type:",l.eventType);break}}).subscribe(l=>{});return o.current=a,()=>{a.unsubscribe(),o.current=null}},[t,s,e]),m.useEffect(()=>{Gd("Containers state updated:",n.length,"containers")},[n]),n}const $e=(...t)=>{console.log("[useRealtimeNotes]",...t)};function e9({visitId:t,onMessage:e}){const[n,r]=m.useState([]),i=m.useRef(!1),o=m.useRef(null),s=m.useCallback(async()=>{if(!t||t==="")return;$e("Fetching notes for visit:",t);const{data:l,error:c}=await Ut.from("notes").select("*").eq("visit_id",t).order("created_at",{ascending:!0});if(c){$e("Error fetching notes:",c);return}l&&($e(`Fetched ${l.length} notes`),r(l),i.current=!0,l.forEach(u=>e==null?void 0:e(u)))},[t,e]),a=m.useCallback(l=>{$e("Manual note deletion triggered for ID:",l),r(c=>{const u=c.filter(d=>d.id!==l);return u.length===c.length?$e("No note found to delete with ID (manual):",l):$e("Successfully removed note with ID (manual):",l),u})},[]);return m.useEffect(()=>{if(!t||t===""){$e("No valid visitId provided, skipping subscription"),r([]),i.current=!1;return}$e("Visit ID changed to:",t),r([]),i.current=!1,i.current||($e("Setting up realtime subscription for visit:",t),s()),o.current&&($e("Cleaning up existing subscription"),o.current.unsubscribe(),o.current=null);const l=Ut.channel(`notes_list_${t}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"notes",filter:`visit_id=eq.${t}`},c=>{$e("Received INSERT event:",c);const u=c.new;$e("Inserting new note:",u),r(d=>{if(d.some(p=>p.id===u.id))return $e("Note already exists, skipping insert"),d;const h=[...d,u].sort((p,g)=>new Date(p.created_at).getTime()-new Date(g.created_at).getTime());return e==null||e(u),h})}).on("postgres_changes",{event:"UPDATE",schema:"public",table:"notes",filter:`visit_id=eq.${t}`},c=>{$e("Received UPDATE event:",c);const u=c.new;$e("Updating note:",u),r(d=>{const h=d.map(p=>p.id===u.id?u:p);return JSON.stringify(h)===JSON.stringify(d)?($e("No changes detected in update"),d):(e==null||e(u),h)})}).on("postgres_changes",{event:"DELETE",schema:"public",table:"notes",filter:`visit_id=eq.${t}`},c=>{$e("Received DELETE event:",c);const u=c.old;if($e("Deleting note with ID:",u==null?void 0:u.id),!u||!u.id){$e("Warning: Invalid delete payload, no note ID found",c);return}r(d=>{const h=d.filter(p=>p.id!==u.id);return h.length===d.length?$e("No note found to delete with ID:",u.id):$e("Successfully removed note with ID:",u.id),h})}).subscribe(c=>{$e("Subscription status:",c)});return o.current=l,()=>{$e("Cleaning up subscription"),l.unsubscribe(),o.current=null}},[t,s,e]),m.useEffect(()=>{$e("Notes state updated:",n.length,"notes")},[n]),{notes:n,handleNoteDeleted:a}}const t9=async(t,e,n)=>{try{if(n==="paused"||n==="processing"){const{data:o,error:s}=await t.from("containers").select("transcript_fragment").eq("visit_id",e).order("chunk_id",{ascending:!0});return s?(console.error("Error loading containers:",s),"Error loading partial transcription."):o.map(l=>l.transcript_fragment).filter(l=>l!==null).join(" ").trim()||""}else if(n==="recording")return"";const{data:r,error:i}=await t.from("transcripts").select("full_text").eq("visit_id",e).single();return i?i.code==="PGRST116"?"No transcript available for this visit.":(console.error("Error loading transcript:",i),"Error loading transcript. Please try again later."):(r==null?void 0:r.full_text)||"No transcript content available."}catch(r){return console.error("Error processing transcription:",r),"Error loading transcription data. Please try again later."}},Jd={container:{display:"flex",flexDirection:"column",height:"100%",width:"100%",backgroundColor:"#f9fafb"},content:{flex:1,backgroundColor:"#f9fafb",overflow:"hidden",width:"100%",height:"calc(100vh - 60px)",padding:"24px"},transcriptContainer:{height:"100%",overflow:"hidden"},transcriptContent:{lineHeight:"1.5",color:"#374151",height:"100%",display:"flex",flexDirection:"column"}};function n9({placeholder:t="Your transcription will appear here as you speak...",isTranscribing:e=!1,currentVisit:n}){const[r,i]=m.useState(""),[o,s]=m.useState({}),[a,l]=m.useState(null),c=Qe(),u=n==null?void 0:n.state,d=n==null?void 0:n.id,h=m.useCallback(b=>{const S=b.transcript_fragment,C=b.chunk_id;S&&typeof C=="number"&&s(k=>({...k,[C]:S}))},[]);ZH({visitId:d||"",onMessage:h});const p=m.useMemo(()=>e?Object.entries(o).sort(([b],[S])=>Number(b)-Number(S)).map(([b,S])=>S).join(" ").trim():"",[o,e]);m.useEffect(()=>{e&&p!==r&&i(p)},[p,r,e]),m.useEffect(()=>{if(!d||!u||!n){s({}),i(""),l(null);return}(async()=>{try{const S=await t9(c,d,u);l(S),e||i(S)}catch{i("Error loading transcription data.")}})()},[d,u,n,c,e]);const g=m.useMemo(()=>e?r:a||r||"",[e,r,a]),{notes:y,handleNoteDeleted:x}=e9({visitId:d||""}),v=y.filter(b=>b.type==="ai_context").sort((b,S)=>new Date(S.created_at).getTime()-new Date(b.created_at).getTime())[0],w=m.useMemo(()=>f.jsx("div",{style:Jd.content,children:f.jsx("div",{style:Jd.transcriptContainer,children:f.jsx("div",{style:Jd.transcriptContent,children:e||!d||!n||(n==null?void 0:n.state)==="processing"||(n==null?void 0:n.state)==="recording"||(n==null?void 0:n.state)==="paused"?f.jsx(aL,{transcription:g,placeholder:t,isTranscribing:e,visit:n??void 0,aiContextNote:v},`visit-${d}`):f.jsx(XH,{visit:n,notes:y,handleNoteDeleted:x},`visit-${d}`)})})}),[g,t,e,d,n,y,x]);return f.jsx("div",{style:Jd.container,children:w})}function r9(){const t=m.useContext(lT),e=Qe();if(t===void 0)throw new Error("useAuth must be used within an AuthProvider");return{...t,signIn:async(r,i)=>{try{const{data:o,error:s}=await e.auth.signInWithPassword({email:r,password:i});if(s)throw s;return await e.auth.getSession(),{data:o,error:null}}catch(o){return console.error("Sign in error:",o),{data:null,error:o}}}}}const Lt={container:{minHeight:"100vh",width:"100vw",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#f3f4f6",padding:"20px"},formContainer:{backgroundColor:"white",padding:"48px",borderRadius:"12px",boxShadow:"0 4px 6px rgba(0,0,0,0.1)",width:"100%",maxWidth:"480px"},title:{fontSize:"32px",fontWeight:"bold",color:"#1f2937",marginBottom:"32px",textAlign:"center"},form:{display:"flex",flexDirection:"column",gap:"24px"},inputGroup:{display:"flex",flexDirection:"column",gap:"8px"},label:{fontSize:"14px",color:"#4b5563",fontWeight:"500"},input:{padding:"12px 16px",borderRadius:"8px",border:"1px solid #e5e7eb",fontSize:"16px",backgroundColor:"white",transition:"all 0.2s ease","&:focus":{outline:"none",borderColor:"#3b82f6",boxShadow:"0 0 0 3px rgba(59, 130, 246, 0.1)"}},button:{backgroundColor:"#3b82f6",color:"white",padding:"14px",borderRadius:"8px",border:"none",fontSize:"16px",fontWeight:"500",cursor:"pointer",transition:"all 0.2s ease",marginTop:"8px","&:hover":{backgroundColor:"#2563eb"},"&:disabled":{backgroundColor:"#93c5fd",cursor:"not-allowed"}},error:{color:"#ef4444",fontSize:"14px",textAlign:"center",marginBottom:"16px"},signupText:{textAlign:"center",marginTop:"24px",fontSize:"14px",color:"#6b7280"},signupLink:{color:"#3b82f6",textDecoration:"none",fontWeight:"500","&:hover":{textDecoration:"underline"}}};function i9(){const t=gr(),{signIn:e,user:n}=r9(),[r,i]=m.useState(""),[o,s]=m.useState(""),[a,l]=m.useState(""),[c,u]=m.useState(!1),d=Hr(),h=Gn();m.useEffect(()=>{var g,y;if(n){console.log("User is logged in, redirecting to record",{user:n.id,email:n.email,location:window.location.pathname});const x=((y=(g=h.state)==null?void 0:g.from)==null?void 0:y.pathname)||"/record";t(x,{replace:!0})}},[n,t,h]);const p=async g=>{if(g.preventDefault(),!c){l(""),u(!0);try{const y=await e(r,o);if(y.error)throw y.error;d.clear()}catch(y){l(y instanceof Error?y.message:"Failed to sign in"),u(!1)}}};return n?f.jsx("div",{style:Lt.container,children:f.jsx("div",{style:Lt.formContainer,children:f.jsx("div",{style:{textAlign:"center",color:"#4b5563"},children:"Redirecting..."})})}):f.jsx("div",{style:Lt.container,children:f.jsxs("div",{style:Lt.formContainer,children:[f.jsx("h1",{style:Lt.title,children:"Welcome to East Medical AI Scribe"}),f.jsxs("form",{onSubmit:p,style:Lt.form,children:[a&&f.jsx("div",{style:Lt.error,children:a}),f.jsxs("div",{style:Lt.inputGroup,children:[f.jsx("label",{htmlFor:"email",style:Lt.label,children:"Email Address"}),f.jsx("input",{id:"email",type:"email",value:r,onChange:g=>i(g.target.value),required:!0,style:Lt.input,placeholder:"Enter your email"})]}),f.jsxs("div",{style:Lt.inputGroup,children:[f.jsx("label",{htmlFor:"password",style:Lt.label,children:"Password"}),f.jsx("input",{id:"password",type:"password",value:o,onChange:g=>s(g.target.value),required:!0,style:Lt.input,placeholder:"Enter your password"})]}),f.jsx("button",{type:"submit",disabled:c,style:Lt.button,children:c?"Signing in...":"Sign In"})]}),f.jsxs("div",{style:Lt.signupText,children:["Don't have an account?"," "]})]})})}const pP=m.createContext(void 0);function o9({children:t}){const[e,n]=m.useState(null),[r,i]=m.useState(!0),o=Qe();m.useEffect(()=>{(async()=>{const{data:{session:h},error:p}=await o.auth.getSession();p&&console.error("Error fetching session:",p),n((h==null?void 0:h.user)??null),i(!1)})();const{data:{subscription:d}}=o.auth.onAuthStateChange((h,p)=>{n((p==null?void 0:p.user)??null)});return()=>{d.unsubscribe()}},[o]);const c={user:e,loading:r,signIn:async(u,d)=>{const{error:h}=await o.auth.signInWithPassword({email:u,password:d});if(h)throw h},signUp:async(u,d)=>{const{error:h}=await o.auth.signUp({email:u,password:d});if(h)throw h},signOut:async()=>{const{error:u}=await o.auth.signOut();if(u)throw u}};return f.jsx(pP.Provider,{value:c,children:t})}function mP(){const t=m.useContext(pP);if(t===void 0)throw new Error("useAuth must be used within an AuthProvider");return t}const Zt={container:{minHeight:"100vh",width:"100vw",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#f3f4f6",padding:"20px"},formContainer:{backgroundColor:"white",padding:"48px",borderRadius:"12px",boxShadow:"0 4px 6px rgba(0,0,0,0.1)",width:"100%",maxWidth:"480px"},title:{fontSize:"32px",fontWeight:"bold",color:"#1f2937",marginBottom:"32px",textAlign:"center"},form:{display:"flex",flexDirection:"column",gap:"24px"},inputGroup:{display:"flex",flexDirection:"column",gap:"8px"},label:{fontSize:"14px",color:"#4b5563",fontWeight:"500"},input:{padding:"12px 16px",borderRadius:"8px",border:"1px solid #e5e7eb",fontSize:"16px",backgroundColor:"white",transition:"all 0.2s ease","&:focus":{outline:"none",borderColor:"#3b82f6",boxShadow:"0 0 0 3px rgba(59, 130, 246, 0.1)"}},button:{backgroundColor:"#3b82f6",color:"white",padding:"14px",borderRadius:"8px",border:"none",fontSize:"16px",fontWeight:"500",cursor:"pointer",transition:"all 0.2s ease",marginTop:"8px","&:hover":{backgroundColor:"#2563eb"},"&:disabled":{backgroundColor:"#93c5fd",cursor:"not-allowed"}},error:{color:"#ef4444",fontSize:"14px",textAlign:"center",marginBottom:"16px"},loginText:{textAlign:"center",marginTop:"24px",fontSize:"14px",color:"#6b7280"},loginLink:{color:"#3b82f6",textDecoration:"none",fontWeight:"500","&:hover":{textDecoration:"underline"}}};function s9(){const[t,e]=m.useState(""),[n,r]=m.useState(""),[i,o]=m.useState(""),[s,a]=m.useState(!1),{signUp:l}=mP(),c=gr(),u=async d=>{d.preventDefault();try{o(""),a(!0),await l(t,n),c("/")}catch(h){o("Failed to create account. Please try again."),console.error("Signup error:",h)}finally{a(!1)}};return f.jsx("div",{style:Zt.container,children:f.jsxs("div",{style:Zt.formContainer,children:[f.jsx("h1",{style:Zt.title,children:"Create an Account"}),f.jsxs("form",{onSubmit:u,style:Zt.form,children:[i&&f.jsx("div",{style:Zt.error,children:i}),f.jsxs("div",{style:Zt.inputGroup,children:[f.jsx("label",{htmlFor:"email",style:Zt.label,children:"Email Address"}),f.jsx("input",{id:"email",type:"email",value:t,onChange:d=>e(d.target.value),required:!0,style:Zt.input,placeholder:"Enter your email"})]}),f.jsxs("div",{style:Zt.inputGroup,children:[f.jsx("label",{htmlFor:"password",style:Zt.label,children:"Password"}),f.jsx("input",{id:"password",type:"password",value:n,onChange:d=>r(d.target.value),required:!0,style:Zt.input,placeholder:"Choose a password"})]}),f.jsx("button",{type:"submit",disabled:s,style:Zt.button,children:s?"Creating Account...":"Sign Up"})]}),f.jsxs("div",{style:Zt.loginText,children:["Already have an account?"," ",f.jsx(w0,{to:"/login",style:Zt.loginLink,children:"Sign in"})]})]})})}const a9=["Accident and Emergency Nurse","Acupuncturist","Addiction Counsellor","Addiction Medicine Specialist","Adolescent and young adult medicine Specialist","Adult Intensive Care Specialist","Aerospace Medicine Specialist","Allergy and Immunologist","Allied Health Professional","Alternative medicine practitioner","Anaesthetist","Anatomical Pathologist","Andrologist","Animal-Assisted Therapist","Aromatherapist","Arts Therapist","Audiologist","Audiology Technician","Audiometrist","Ayurveda","Behaviour Therapist","Bereavement Counselor","Biofeedback Therapist","Blood Transfusion Doctor","Breast Surgeon","Cardiologist","Cardiothoracic Surgeon","Chemical Pathologist","Chemotherapy Nurse","Child and Adolescent Psychiatrist","Chiropractor","Chronic Pain Specialist","Clinical Geneticist","Clinical Immunologist","Clinical Neurophysiologist","Clinical Pathologist","Clinical Pharmacologist","Clinical Physiologist","Clinical Social Worker","Cognitive Behavioral Therapist","Colorectal Surgeon","Community Child Health Specialist","Community Nurse","Coroner","Counselling Psychologist","Counselors","Critical Care Medicine Specialist","Dance Therapist","Dental Auxiliary","Dental Technician","Dental assistant","Dental nurse","Dentist","Dermatologist","Diabetes Dietitian","Diabetes Specialist","Diabetologist","Diagnostic Radiographer","Diagnostic Radiologist","Dietitian","Drama Therapist","ECG Technician","EEG Technician","EMT","Eating Disorder Specialist Dietitian","Eating Disorder Specialist Psychologist","Emergency Medicine Specialist","Endocrine Surgeon","Endocrinologist","Endodontist","Equine Therapist","Exercise Physiologists","Family Medicine Specialist","Family Planning Doctor","Fetal Medicine Specialist","Foot and Ankle Surgeon","Forensic Medicine Specialist","Forensic Psychiatrist","Functional Medicine Specialist","Gastroenterologist","Gastrointestinal Surgeon","General Dietitian","General Gastrointestinal Surgeon","General Practitioner","General Surgeon","Genetic Counselor","Geriatric Medicine Specialist","Geriatrician","Gerodontist","Geropsychologist","Grief Counsellor","Gynaecologist","Haematologist","Haemodialysis Nurse","Hand Surgeon","Health Coach","Health Psychologist","Healthcare Assistant","Healthcare Service Manager","Hepatobiliary Surgeon","Hepatologist","Herbal Medicine Specialist","Hip and Knee Surgeon","Holistic Health Practitioner","Homeopath","Horticultural Therapist","Hospital Administrator","Hydrotherapist","Hypnotherapist","Immunopathologist","Infection Control Nurse","Infectious Diseases Physician","Intensive Care Specialist","Internal Medicine Specialist","Interpreter","Interventional Radiologist","Invasive Cardiologist","Kinesiologist","Laboratory Haematologist","Laboratory Medicine Specialist","Lactation Consultant","Lifestyle medicine Specialist","Liver Dietitian","Lower Gastrointestinal Surgeon","Marriage Guidance Counsellor","Marriage and family therapist","Massage Therapist","Maternal-Fetal Medicine Specialist","Maxillofacial Surgeon","Medical Geneticist","Medical Microbiologist","Medical Oncologist","Medical Pathologist","Medical Record Administrator","Medical Secretary","Medical Technician","Medical X-ray Technician","Mental Health Counselor","Mental Health Nurse","Mental Health and Behavioural Specialist","Midwife","Music Therapist","Naturopath","Neonatal Nurse","Neonatologist","Nephrologist","Neuroendocrinologist","Neurologist","Neuropathologist","Neuropsychiatrist","Neuroradiologist","Neurosurgeon","Nuclear Medicine Physician","Nurse","Nurse Administrator","Nurse Anaesthetist","Nurse Practitioner","Nurse Psychotherapist","Nursing Aid","Nursing Auxiliary","Nutrition & diabetics Specialist","Nutrition Therapist","Obesity Medicine","Obesity Specialist","Obstetrician & Gynaecologist","Occupational Health Nurse","Occupational Medicine Specialist","Occupational Therapist","Oculoplastic Surgeon","Oncologist","Oncology Dietitian","Oncology Nurse","Ophthalmologist","Optician","Optometrist","Oral Pathologist","Oral/Dental Hygienist","Orthodontist","Orthopaedic Surgeon","Orthoptist","Orthotist","Osteopath","Otolaryngologist","Otorhinolaryngologist (ENT Specialist)","Paediatric Allergist","Paediatric Audiologist","Paediatric Cardiologist","Paediatric Dietitian","Paediatric Emergency Medicine Specialist","Paediatric Endocrinologist","Paediatric Gastroenterologist","Paediatric Intensive Care Specialist","Paediatric Nephrologist","Paediatric Neurologist","Paediatric Nurse","Paediatric Oncologist","Paediatric Orthopaedic Surgeon","Paediatric Respirologist","Paediatric Rheumatologist","Paediatric Surgeon","Paediatric haematologist","Paediatrician","Pain Management Specialist","Palantypist","Palliative Care Nurse","Palliative Care Physician","Pancreatic Surgeon","Paramedic","Pathologist","Pediatric Dentist","Pediatric Psychologist","Pediatric Pulmonologist","Pediatric Radiologist","Pediatric Surgeon","Periodontist","Perioperative Nurse","Pharmacist","Physical Medicine and Rehabilitation Specialist","Physician","Physician Assistant","Physiologist","Physiotherapist","Pituitary Surgeon","Plastic & Reconstructive Surgeon","Play Therapist","Podiatrist","Podiatrist Assistant","Practice Manager","Preventive medicine Specialist","Prosthetist","Prosthodontist","Psychiatric Nurse","Psychiatrist","Psychiatrist for Mental Handicap","Psychoanalyst","Psychogeriatrician","Psychologist","Psychotherapist","Public Health Medicine Specialist","Public Health Nurse","Pulmonologist","Radiation Oncologist","Radiation Oncology","Radiation Therapist","Radiologist","Radiology and Imaging Specialist","Radiotherapy Nurse","Recreational Therapist","Reflexologist","Registered Nurse"],Oe={container:{padding:"32px",width:"100%",height:"100%",backgroundColor:"#fff"},title:{fontSize:"16px",fontWeight:"500",marginBottom:"32px",color:"#1f2937"},section:{maxWidth:"1200px",margin:"0 auto"},formGrid:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"24px"},field:{marginBottom:"24px"},label:{display:"block",fontSize:"14px",color:"#4b5563",marginBottom:"8px"},input:{width:"100%",padding:"8px 12px",fontSize:"14px",border:"1px solid #d1d5db",borderRadius:"6px",color:"#1f2937",backgroundColor:"#fff","&:focus":{outline:"none",borderColor:"#2563eb",boxShadow:"0 0 0 2px rgba(37, 99, 235, 0.2)"}},select:{width:"100%",padding:"8px 12px",fontSize:"14px",border:"1px solid #d1d5db",borderRadius:"6px",color:"#1f2937",backgroundColor:"#fff",cursor:"pointer",appearance:"none",backgroundImage:'url("data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2224%22%20height%3D%2224%22%20viewBox%3D%220%200%2024%2024%22%20fill%3D%22none%22%20stroke%3D%22%236b7280%22%20stroke-width%3D%222%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%3E%3Cpolyline%20points%3D%226%209%2012%2015%2018%209%22%3E%3C%2Fpolyline%3E%3C%2Fsvg%3E")',backgroundRepeat:"no-repeat",backgroundPosition:"right 8px center",backgroundSize:"16px",paddingRight:"32px"},saveButton:{backgroundColor:"#2563eb",color:"white",padding:"10px 20px",borderRadius:"6px",border:"none",fontSize:"14px",fontWeight:"500",cursor:"pointer",transition:"background-color 0.2s","&:hover":{backgroundColor:"#1d4ed8"},"&:disabled":{backgroundColor:"#93c5fd",cursor:"not-allowed"}},disabledInput:{backgroundColor:"#f3f4f6",cursor:"not-allowed"}};function l9(){const{user:t,loading:e}=Nt(),n=Qe(),[r,i]=m.useState({firstName:"",lastName:"",specialty:"",title:"",organization:"",companySize:"Just me",position:"Individual clinician"}),[o,s]=m.useState(!1);if(Te.useEffect(()=>{if(t){const[c="",u=""]=(t.name||"").split(" ");i({firstName:c,lastName:u,specialty:t.specialty||"",title:t.title||"",organization:t.organization||"",companySize:"Just me",position:"Individual clinician"})}},[t]),e)return f.jsx("div",{children:"Loading..."});if(!t)return f.jsx("div",{children:"Not logged in"});const a=c=>{const{name:u,value:d}=c.target;i(h=>({...h,[u]:d}))},l=async()=>{if(t.id){s(!0);try{const{error:c}=await n.from("user_profiles").update({name:`${r.firstName} ${r.lastName}`.trim(),specialty:r.specialty,title:r.title,organization:r.organization,updated_at:new Date().toISOString()}).eq("id",t.id);if(c)throw c}catch(c){console.error("Error updating profile:",c)}finally{s(!1)}}};return f.jsx("div",{style:Oe.container,children:f.jsxs("div",{style:Oe.section,children:[f.jsx("h1",{style:Oe.title,children:"About you"}),f.jsxs("div",{style:Oe.formGrid,children:[f.jsxs("div",{style:Oe.field,children:[f.jsx("label",{style:Oe.label,children:"Title"}),f.jsx("input",{style:Oe.input,name:"title",value:r.title,onChange:a,type:"text",placeholder:"Enter your title"})]}),f.jsxs("div",{style:Oe.field,children:[f.jsx("label",{style:Oe.label,children:"First name"}),f.jsx("input",{style:Oe.input,type:"text",name:"firstName",value:r.firstName,onChange:a,placeholder:"Enter your first name"})]}),f.jsxs("div",{style:Oe.field,children:[f.jsx("label",{style:Oe.label,children:"Last name"}),f.jsx("input",{style:Oe.input,type:"text",name:"lastName",value:r.lastName,onChange:a,placeholder:"Enter your last name"})]}),f.jsxs("div",{style:Oe.field,children:[f.jsx("label",{style:Oe.label,children:"Specialty"}),f.jsxs("select",{style:Oe.select,name:"specialty",value:r.specialty,onChange:a,children:[f.jsx("option",{value:"",children:"Select a specialty"}),a9.map(c=>f.jsx("option",{value:c,children:c},c))]})]}),f.jsxs("div",{style:Oe.field,children:[f.jsx("label",{style:Oe.label,children:"Organization name"}),f.jsx("input",{style:Oe.input,type:"text",name:"organization",value:r.organization,onChange:a,placeholder:"Enter your organization"})]}),f.jsxs("div",{style:Oe.field,children:[f.jsx("label",{style:Oe.label,children:"Company size"}),f.jsxs("select",{style:Oe.select,name:"companySize",value:r.companySize,onChange:a,children:[f.jsx("option",{value:"Just me",children:"Just me"}),f.jsx("option",{value:"2-10",children:"2-10 employees"}),f.jsx("option",{value:"11-50",children:"11-50 employees"}),f.jsx("option",{value:"51+",children:"51+ employees"})]})]}),f.jsxs("div",{style:Oe.field,children:[f.jsx("label",{style:Oe.label,children:"Position"}),f.jsxs("select",{style:Oe.select,name:"position",value:r.position,onChange:a,children:[f.jsx("option",{value:"Individual clinician",children:"Individual clinician"}),f.jsx("option",{value:"Practice owner",children:"Practice owner"}),f.jsx("option",{value:"Administrator",children:"Administrator"})]})]})]}),f.jsx("div",{style:{marginTop:"24px",textAlign:"right"},children:f.jsx("button",{style:Oe.saveButton,onClick:l,disabled:o,children:o?"Saving...":"Save changes"})})]})})}const Aa={default_copy_mode:"plain",date_format:"MM/DD/YYYY",primary_language:"auto",preferred_note_language:"en",patient_instructions_language:"en",spelling:"en-us",patient_reference_format:"",clinician_reference_format:""},c9=[{value:"plain",label:"Plain Text"},{value:"rich_text",label:"Formatted Text"},{value:"without_lists",label:"Formatted Text (Without Lists)"}],av=[{value:"auto",label:"Multi-lingual"},{value:"en",label:"English"},{value:"zh",label:"Mandarin"},{value:"zh-HK",label:"Cantonese"},{value:"cs",label:"Czech"},{value:"da",label:"Danish"},{value:"nl",label:"Dutch"},{value:"nl-BE",label:"Flemish"},{value:"fr",label:"French"},{value:"de",label:"German"},{value:"el",label:"Greek"},{value:"hi",label:"Hindi"},{value:"id",label:"Indonesian"},{value:"it",label:"Italian"},{value:"ja",label:"Japanese"},{value:"ko",label:"Korean"},{value:"ms",label:"Malay"},{value:"no",label:"Norwegian"},{value:"pl",label:"Polish"},{value:"pt",label:"Portuguese"},{value:"ru",label:"Russian"},{value:"es",label:"Spanish"},{value:"sv",label:"Swedish"},{value:"th",label:"Thai"},{value:"tr",label:"Turkish"},{value:"uk",label:"Ukrainian"},{value:"vi",label:"Vietnamese"}],u9=[{value:"MM/DD/YYYY",label:"MM/DD/YYYY"},{value:"DD/MM/YYYY",label:"DD/MM/YYYY"},{value:"D MMM YYYY",label:"D MMM YYYY"},{value:"MMMM DD YYYY",label:"MMMM DD YYYY"},{value:"MMM DD YYYY",label:"MMM DD YYYY"},{value:"YYYY/MM/DD",label:"YYYY/MM/DD"}],gP=[{value:"match_spoken",label:"Match spoken language"},{value:"en",label:"English"},{value:"zh",label:"Mandarin"},{value:"zh-HK",label:"Cantonese"},{value:"cs",label:"Czech"},{value:"da",label:"Danish"},{value:"nl",label:"Dutch"},{value:"nl-BE",label:"Flemish"},{value:"fr",label:"French"},{value:"de",label:"German"},{value:"el",label:"Greek"},{value:"hi",label:"Hindi"},{value:"id",label:"Indonesian"},{value:"it",label:"Italian"},{value:"ja",label:"Japanese"},{value:"ko",label:"Korean"},{value:"ms",label:"Malay"},{value:"no",label:"Norwegian"},{value:"pl",label:"Polish"},{value:"pt",label:"Portuguese"},{value:"ru",label:"Russian"},{value:"es",label:"Spanish"},{value:"sv",label:"Swedish"},{value:"th",label:"Thai"},{value:"tr",label:"Turkish"},{value:"uk",label:"Ukrainian"},{value:"vi",label:"Vietnamese"}],d9=[{value:"en-us",label:"English (United States)"},{value:"en-gb",label:"English (United Kingdom)"},{value:"en-au",label:"English (Australia)"},{value:"en-ca",label:"English (Canada)"}];function AS(t,[e,n]){return Math.min(n,Math.max(e,t))}function f9(t){const e=m.useRef({value:t,previous:t});return m.useMemo(()=>(e.current.value!==t&&(e.current.previous=e.current.value,e.current.value=t),e.current.previous),[t])}var h9=[" ","Enter","ArrowUp","ArrowDown"],p9=[" ","Enter"],Zu="Select",[_p,Rp,m9]=Zh(Zu),[Gl,QW]=yi(Zu,[m9,Kl]),Op=Kl(),[g9,Bo]=Gl(Zu),[y9,v9]=Gl(Zu),yP=t=>{const{__scopeSelect:e,children:n,open:r,defaultOpen:i,onOpenChange:o,value:s,defaultValue:a,onValueChange:l,dir:c,name:u,autoComplete:d,disabled:h,required:p,form:g}=t,y=Op(e),[x,v]=m.useState(null),[w,b]=m.useState(null),[S,C]=m.useState(!1),k=j0(c),[E=!1,T]=As({prop:r,defaultProp:i,onChange:o}),[R,_]=As({prop:s,defaultProp:a,onChange:l}),A=m.useRef(null),L=x?g||!!x.closest("form"):!0,[N,M]=m.useState(new Set),z=Array.from(N).map($=>$.props.value).join(";");return f.jsx(W0,{...y,children:f.jsxs(g9,{required:p,scope:e,trigger:x,onTriggerChange:v,valueNode:w,onValueNodeChange:b,valueNodeHasChildren:S,onValueNodeHasChildrenChange:C,contentId:Dr(),value:R,onValueChange:_,open:E,onOpenChange:T,dir:k,triggerPointerDownPosRef:A,disabled:h,children:[f.jsx(_p.Provider,{scope:e,children:f.jsx(y9,{scope:t.__scopeSelect,onNativeOptionAdd:m.useCallback($=>{M(V=>new Set(V).add($))},[]),onNativeOptionRemove:m.useCallback($=>{M(V=>{const I=new Set(V);return I.delete($),I})},[]),children:n})}),L?f.jsxs(FP,{"aria-hidden":!0,required:p,tabIndex:-1,name:u,autoComplete:d,value:R,onChange:$=>_($.target.value),disabled:h,form:g,children:[R===void 0?f.jsx("option",{value:""}):null,Array.from(N)]},z):null]})})};yP.displayName=Zu;var vP="SelectTrigger",xP=m.forwardRef((t,e)=>{const{__scopeSelect:n,disabled:r=!1,...i}=t,o=Op(n),s=Bo(vP,n),a=s.disabled||r,l=Se(e,s.onTriggerChange),c=Rp(n),u=m.useRef("touch"),[d,h,p]=BP(y=>{const x=c().filter(b=>!b.disabled),v=x.find(b=>b.value===s.value),w=zP(x,y,v);w!==void 0&&s.onValueChange(w.value)}),g=y=>{a||(s.onOpenChange(!0),p()),y&&(s.triggerPointerDownPosRef.current={x:Math.round(y.pageX),y:Math.round(y.pageY)})};return f.jsx(rp,{asChild:!0,...o,children:f.jsx(se.button,{type:"button",role:"combobox","aria-controls":s.contentId,"aria-expanded":s.open,"aria-required":s.required,"aria-autocomplete":"none",dir:s.dir,"data-state":s.open?"open":"closed",disabled:a,"data-disabled":a?"":void 0,"data-placeholder":$P(s.value)?"":void 0,...i,ref:l,onClick:K(i.onClick,y=>{y.currentTarget.focus(),u.current!=="mouse"&&g(y)}),onPointerDown:K(i.onPointerDown,y=>{u.current=y.pointerType;const x=y.target;x.hasPointerCapture(y.pointerId)&&x.releasePointerCapture(y.pointerId),y.button===0&&y.ctrlKey===!1&&y.pointerType==="mouse"&&(g(y),y.preventDefault())}),onKeyDown:K(i.onKeyDown,y=>{const x=d.current!=="";!(y.ctrlKey||y.altKey||y.metaKey)&&y.key.length===1&&h(y.key),!(x&&y.key===" ")&&h9.includes(y.key)&&(g(),y.preventDefault())})})})});xP.displayName=vP;var wP="SelectValue",bP=m.forwardRef((t,e)=>{const{__scopeSelect:n,className:r,style:i,children:o,placeholder:s="",...a}=t,l=Bo(wP,n),{onValueNodeHasChildrenChange:c}=l,u=o!==void 0,d=Se(e,l.onValueNodeChange);return Mt(()=>{c(u)},[c,u]),f.jsx(se.span,{...a,ref:d,style:{pointerEvents:"none"},children:$P(l.value)?f.jsx(f.Fragment,{children:s}):o})});bP.displayName=wP;var x9="SelectIcon",SP=m.forwardRef((t,e)=>{const{__scopeSelect:n,children:r,...i}=t;return f.jsx(se.span,{"aria-hidden":!0,...i,ref:e,children:r||""})});SP.displayName=x9;var w9="SelectPortal",CP=t=>f.jsx(Ul,{asChild:!0,...t});CP.displayName=w9;var Ws="SelectContent",kP=m.forwardRef((t,e)=>{const n=Bo(Ws,t.__scopeSelect),[r,i]=m.useState();if(Mt(()=>{i(new DocumentFragment)},[]),!n.open){const o=r;return o?Gs.createPortal(f.jsx(EP,{scope:t.__scopeSelect,children:f.jsx(_p.Slot,{scope:t.__scopeSelect,children:f.jsx("div",{children:t.children})})}),o):null}return f.jsx(TP,{...t,ref:e})});kP.displayName=Ws;var Xn=10,[EP,zo]=Gl(Ws),b9="SelectContentImpl",TP=m.forwardRef((t,e)=>{const{__scopeSelect:n,position:r="item-aligned",onCloseAutoFocus:i,onEscapeKeyDown:o,onPointerDownOutside:s,side:a,sideOffset:l,align:c,alignOffset:u,arrowPadding:d,collisionBoundary:h,collisionPadding:p,sticky:g,hideWhenDetached:y,avoidCollisions:x,...v}=t,w=Bo(Ws,n),[b,S]=m.useState(null),[C,k]=m.useState(null),E=Se(e,U=>S(U)),[T,R]=m.useState(null),[_,A]=m.useState(null),L=Rp(n),[N,M]=m.useState(!1),z=m.useRef(!1);m.useEffect(()=>{if(b)return Xh(b)},[b]),Jh();const $=m.useCallback(U=>{const[ae,...ve]=L().map(xe=>xe.ref.current),[de]=ve.slice(-1),me=document.activeElement;for(const xe of U)if(xe===me||(xe==null||xe.scrollIntoView({block:"nearest"}),xe===ae&&C&&(C.scrollTop=0),xe===de&&C&&(C.scrollTop=C.scrollHeight),xe==null||xe.focus(),document.activeElement!==me))return},[L,C]),V=m.useCallback(()=>$([T,b]),[$,T,b]);m.useEffect(()=>{N&&V()},[N,V]);const{onOpenChange:I,triggerPointerDownPosRef:P}=w;m.useEffect(()=>{if(b){let U={x:0,y:0};const ae=de=>{var me,xe;U={x:Math.abs(Math.round(de.pageX)-(((me=P.current)==null?void 0:me.x)??0)),y:Math.abs(Math.round(de.pageY)-(((xe=P.current)==null?void 0:xe.y)??0))}},ve=de=>{U.x<=10&&U.y<=10?de.preventDefault():b.contains(de.target)||I(!1),document.removeEventListener("pointermove",ae),P.current=null};return P.current!==null&&(document.addEventListener("pointermove",ae),document.addEventListener("pointerup",ve,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",ae),document.removeEventListener("pointerup",ve,{capture:!0})}}},[b,I,P]),m.useEffect(()=>{const U=()=>I(!1);return window.addEventListener("blur",U),window.addEventListener("resize",U),()=>{window.removeEventListener("blur",U),window.removeEventListener("resize",U)}},[I]);const[D,H]=BP(U=>{const ae=L().filter(me=>!me.disabled),ve=ae.find(me=>me.ref.current===document.activeElement),de=zP(ae,U,ve);de&&setTimeout(()=>de.ref.current.focus())}),Z=m.useCallback((U,ae,ve)=>{const de=!z.current&&!ve;(w.value!==void 0&&w.value===ae||de)&&(R(U),de&&(z.current=!0))},[w.value]),he=m.useCallback(()=>b==null?void 0:b.focus(),[b]),pe=m.useCallback((U,ae,ve)=>{const de=!z.current&&!ve;(w.value!==void 0&&w.value===ae||de)&&A(U)},[w.value]),ee=r==="popper"?lv:_P,Q=ee===lv?{side:a,sideOffset:l,align:c,alignOffset:u,arrowPadding:d,collisionBoundary:h,collisionPadding:p,sticky:g,hideWhenDetached:y,avoidCollisions:x}:{};return f.jsx(EP,{scope:n,content:b,viewport:C,onViewportChange:k,itemRefCallback:Z,selectedItem:T,onItemLeave:he,itemTextRefCallback:pe,focusSelectedItem:V,selectedItemText:_,position:r,isPositioned:N,searchRef:D,children:f.jsx(Qh,{as:_o,allowPinchZoom:!0,children:f.jsx(Uu,{asChild:!0,trapped:w.open,onMountAutoFocus:U=>{U.preventDefault()},onUnmountAutoFocus:K(i,U=>{var ae;(ae=w.trigger)==null||ae.focus({preventScroll:!0}),U.preventDefault()}),children:f.jsx(Vl,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:o,onPointerDownOutside:s,onFocusOutside:U=>U.preventDefault(),onDismiss:()=>w.onOpenChange(!1),children:f.jsx(ee,{role:"listbox",id:w.contentId,"data-state":w.open?"open":"closed",dir:w.dir,onContextMenu:U=>U.preventDefault(),...v,...Q,onPlaced:()=>M(!0),ref:E,style:{display:"flex",flexDirection:"column",outline:"none",...v.style},onKeyDown:K(v.onKeyDown,U=>{const ae=U.ctrlKey||U.altKey||U.metaKey;if(U.key==="Tab"&&U.preventDefault(),!ae&&U.key.length===1&&H(U.key),["ArrowUp","ArrowDown","Home","End"].includes(U.key)){let de=L().filter(me=>!me.disabled).map(me=>me.ref.current);if(["ArrowUp","End"].includes(U.key)&&(de=de.slice().reverse()),["ArrowUp","ArrowDown"].includes(U.key)){const me=U.target,xe=de.indexOf(me);de=de.slice(xe+1)}setTimeout(()=>$(de)),U.preventDefault()}})})})})})})});TP.displayName=b9;var S9="SelectItemAlignedPosition",_P=m.forwardRef((t,e)=>{const{__scopeSelect:n,onPlaced:r,...i}=t,o=Bo(Ws,n),s=zo(Ws,n),[a,l]=m.useState(null),[c,u]=m.useState(null),d=Se(e,E=>u(E)),h=Rp(n),p=m.useRef(!1),g=m.useRef(!0),{viewport:y,selectedItem:x,selectedItemText:v,focusSelectedItem:w}=s,b=m.useCallback(()=>{if(o.trigger&&o.valueNode&&a&&c&&y&&x&&v){const E=o.trigger.getBoundingClientRect(),T=c.getBoundingClientRect(),R=o.valueNode.getBoundingClientRect(),_=v.getBoundingClientRect();if(o.dir!=="rtl"){const me=_.left-T.left,xe=R.left-me,tt=E.left-xe,jt=E.width+tt,wr=Math.max(jt,T.width),Jn=window.innerWidth-Xn,Yn=AS(xe,[Xn,Math.max(Xn,Jn-wr)]);a.style.minWidth=jt+"px",a.style.left=Yn+"px"}else{const me=T.right-_.right,xe=window.innerWidth-R.right-me,tt=window.innerWidth-E.right-xe,jt=E.width+tt,wr=Math.max(jt,T.width),Jn=window.innerWidth-Xn,Yn=AS(xe,[Xn,Math.max(Xn,Jn-wr)]);a.style.minWidth=jt+"px",a.style.right=Yn+"px"}const A=h(),L=window.innerHeight-Xn*2,N=y.scrollHeight,M=window.getComputedStyle(c),z=parseInt(M.borderTopWidth,10),$=parseInt(M.paddingTop,10),V=parseInt(M.borderBottomWidth,10),I=parseInt(M.paddingBottom,10),P=z+$+N+I+V,D=Math.min(x.offsetHeight*5,P),H=window.getComputedStyle(y),Z=parseInt(H.paddingTop,10),he=parseInt(H.paddingBottom,10),pe=E.top+E.height/2-Xn,ee=L-pe,Q=x.offsetHeight/2,U=x.offsetTop+Q,ae=z+$+U,ve=P-ae;if(ae<=pe){const me=A.length>0&&x===A[A.length-1].ref.current;a.style.bottom="0px";const xe=c.clientHeight-y.offsetTop-y.offsetHeight,tt=Math.max(ee,Q+(me?he:0)+xe+V),jt=ae+tt;a.style.height=jt+"px"}else{const me=A.length>0&&x===A[0].ref.current;a.style.top="0px";const tt=Math.max(pe,z+y.offsetTop+(me?Z:0)+Q)+ve;a.style.height=tt+"px",y.scrollTop=ae-pe+y.offsetTop}a.style.margin=`${Xn}px 0`,a.style.minHeight=D+"px",a.style.maxHeight=L+"px",r==null||r(),requestAnimationFrame(()=>p.current=!0)}},[h,o.trigger,o.valueNode,a,c,y,x,v,o.dir,r]);Mt(()=>b(),[b]);const[S,C]=m.useState();Mt(()=>{c&&C(window.getComputedStyle(c).zIndex)},[c]);const k=m.useCallback(E=>{E&&g.current===!0&&(b(),w==null||w(),g.current=!1)},[b,w]);return f.jsx(k9,{scope:n,contentWrapper:a,shouldExpandOnScrollRef:p,onScrollButtonChange:k,children:f.jsx("div",{ref:l,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:S},children:f.jsx(se.div,{...i,ref:d,style:{boxSizing:"border-box",maxHeight:"100%",...i.style}})})})});_P.displayName=S9;var C9="SelectPopperPosition",lv=m.forwardRef((t,e)=>{const{__scopeSelect:n,align:r="start",collisionPadding:i=Xn,...o}=t,s=Op(n);return f.jsx(K0,{...s,...o,ref:e,align:r,collisionPadding:i,style:{boxSizing:"border-box",...o.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});lv.displayName=C9;var[k9,Fx]=Gl(Ws,{}),cv="SelectViewport",RP=m.forwardRef((t,e)=>{const{__scopeSelect:n,nonce:r,...i}=t,o=zo(cv,n),s=Fx(cv,n),a=Se(e,o.onViewportChange),l=m.useRef(0);return f.jsxs(f.Fragment,{children:[f.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:r}),f.jsx(_p.Slot,{scope:n,children:f.jsx(se.div,{"data-radix-select-viewport":"",role:"presentation",...i,ref:a,style:{position:"relative",flex:1,overflow:"hidden auto",...i.style},onScroll:K(i.onScroll,c=>{const u=c.currentTarget,{contentWrapper:d,shouldExpandOnScrollRef:h}=s;if(h!=null&&h.current&&d){const p=Math.abs(l.current-u.scrollTop);if(p>0){const g=window.innerHeight-Xn*2,y=parseFloat(d.style.minHeight),x=parseFloat(d.style.height),v=Math.max(y,x);if(v<g){const w=v+p,b=Math.min(g,w),S=w-b;d.style.height=b+"px",d.style.bottom==="0px"&&(u.scrollTop=S>0?S:0,d.style.justifyContent="flex-end")}}}l.current=u.scrollTop})})})]})});RP.displayName=cv;var OP="SelectGroup",[E9,T9]=Gl(OP),_9=m.forwardRef((t,e)=>{const{__scopeSelect:n,...r}=t,i=Dr();return f.jsx(E9,{scope:n,id:i,children:f.jsx(se.div,{role:"group","aria-labelledby":i,...r,ref:e})})});_9.displayName=OP;var PP="SelectLabel",R9=m.forwardRef((t,e)=>{const{__scopeSelect:n,...r}=t,i=T9(PP,n);return f.jsx(se.div,{id:i.id,...r,ref:e})});R9.displayName=PP;var bh="SelectItem",[O9,MP]=Gl(bh),IP=m.forwardRef((t,e)=>{const{__scopeSelect:n,value:r,disabled:i=!1,textValue:o,...s}=t,a=Bo(bh,n),l=zo(bh,n),c=a.value===r,[u,d]=m.useState(o??""),[h,p]=m.useState(!1),g=Se(e,w=>{var b;return(b=l.itemRefCallback)==null?void 0:b.call(l,w,r,i)}),y=Dr(),x=m.useRef("touch"),v=()=>{i||(a.onValueChange(r),a.onOpenChange(!1))};if(r==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return f.jsx(O9,{scope:n,value:r,disabled:i,textId:y,isSelected:c,onItemTextChange:m.useCallback(w=>{d(b=>b||((w==null?void 0:w.textContent)??"").trim())},[]),children:f.jsx(_p.ItemSlot,{scope:n,value:r,disabled:i,textValue:u,children:f.jsx(se.div,{role:"option","aria-labelledby":y,"data-highlighted":h?"":void 0,"aria-selected":c&&h,"data-state":c?"checked":"unchecked","aria-disabled":i||void 0,"data-disabled":i?"":void 0,tabIndex:i?void 0:-1,...s,ref:g,onFocus:K(s.onFocus,()=>p(!0)),onBlur:K(s.onBlur,()=>p(!1)),onClick:K(s.onClick,()=>{x.current!=="mouse"&&v()}),onPointerUp:K(s.onPointerUp,()=>{x.current==="mouse"&&v()}),onPointerDown:K(s.onPointerDown,w=>{x.current=w.pointerType}),onPointerMove:K(s.onPointerMove,w=>{var b;x.current=w.pointerType,i?(b=l.onItemLeave)==null||b.call(l):x.current==="mouse"&&w.currentTarget.focus({preventScroll:!0})}),onPointerLeave:K(s.onPointerLeave,w=>{var b;w.currentTarget===document.activeElement&&((b=l.onItemLeave)==null||b.call(l))}),onKeyDown:K(s.onKeyDown,w=>{var S;((S=l.searchRef)==null?void 0:S.current)!==""&&w.key===" "||(p9.includes(w.key)&&v(),w.key===" "&&w.preventDefault())})})})})});IP.displayName=bh;var wc="SelectItemText",AP=m.forwardRef((t,e)=>{const{__scopeSelect:n,className:r,style:i,...o}=t,s=Bo(wc,n),a=zo(wc,n),l=MP(wc,n),c=v9(wc,n),[u,d]=m.useState(null),h=Se(e,v=>d(v),l.onItemTextChange,v=>{var w;return(w=a.itemTextRefCallback)==null?void 0:w.call(a,v,l.value,l.disabled)}),p=u==null?void 0:u.textContent,g=m.useMemo(()=>f.jsx("option",{value:l.value,disabled:l.disabled,children:p},l.value),[l.disabled,l.value,p]),{onNativeOptionAdd:y,onNativeOptionRemove:x}=c;return Mt(()=>(y(g),()=>x(g)),[y,x,g]),f.jsxs(f.Fragment,{children:[f.jsx(se.span,{id:l.textId,...o,ref:h}),l.isSelected&&s.valueNode&&!s.valueNodeHasChildren?Gs.createPortal(o.children,s.valueNode):null]})});AP.displayName=wc;var NP="SelectItemIndicator",P9=m.forwardRef((t,e)=>{const{__scopeSelect:n,...r}=t;return MP(NP,n).isSelected?f.jsx(se.span,{"aria-hidden":!0,...r,ref:e}):null});P9.displayName=NP;var uv="SelectScrollUpButton",jP=m.forwardRef((t,e)=>{const n=zo(uv,t.__scopeSelect),r=Fx(uv,t.__scopeSelect),[i,o]=m.useState(!1),s=Se(e,r.onScrollButtonChange);return Mt(()=>{if(n.viewport&&n.isPositioned){let a=function(){const c=l.scrollTop>0;o(c)};const l=n.viewport;return a(),l.addEventListener("scroll",a),()=>l.removeEventListener("scroll",a)}},[n.viewport,n.isPositioned]),i?f.jsx(LP,{...t,ref:s,onAutoScroll:()=>{const{viewport:a,selectedItem:l}=n;a&&l&&(a.scrollTop=a.scrollTop-l.offsetHeight)}}):null});jP.displayName=uv;var dv="SelectScrollDownButton",DP=m.forwardRef((t,e)=>{const n=zo(dv,t.__scopeSelect),r=Fx(dv,t.__scopeSelect),[i,o]=m.useState(!1),s=Se(e,r.onScrollButtonChange);return Mt(()=>{if(n.viewport&&n.isPositioned){let a=function(){const c=l.scrollHeight-l.clientHeight,u=Math.ceil(l.scrollTop)<c;o(u)};const l=n.viewport;return a(),l.addEventListener("scroll",a),()=>l.removeEventListener("scroll",a)}},[n.viewport,n.isPositioned]),i?f.jsx(LP,{...t,ref:s,onAutoScroll:()=>{const{viewport:a,selectedItem:l}=n;a&&l&&(a.scrollTop=a.scrollTop+l.offsetHeight)}}):null});DP.displayName=dv;var LP=m.forwardRef((t,e)=>{const{__scopeSelect:n,onAutoScroll:r,...i}=t,o=zo("SelectScrollButton",n),s=m.useRef(null),a=Rp(n),l=m.useCallback(()=>{s.current!==null&&(window.clearInterval(s.current),s.current=null)},[]);return m.useEffect(()=>()=>l(),[l]),Mt(()=>{var u;const c=a().find(d=>d.ref.current===document.activeElement);(u=c==null?void 0:c.ref.current)==null||u.scrollIntoView({block:"nearest"})},[a]),f.jsx(se.div,{"aria-hidden":!0,...i,ref:e,style:{flexShrink:0,...i.style},onPointerDown:K(i.onPointerDown,()=>{s.current===null&&(s.current=window.setInterval(r,50))}),onPointerMove:K(i.onPointerMove,()=>{var c;(c=o.onItemLeave)==null||c.call(o),s.current===null&&(s.current=window.setInterval(r,50))}),onPointerLeave:K(i.onPointerLeave,()=>{l()})})}),M9="SelectSeparator",I9=m.forwardRef((t,e)=>{const{__scopeSelect:n,...r}=t;return f.jsx(se.div,{"aria-hidden":!0,...r,ref:e})});I9.displayName=M9;var fv="SelectArrow",A9=m.forwardRef((t,e)=>{const{__scopeSelect:n,...r}=t,i=Op(n),o=Bo(fv,n),s=zo(fv,n);return o.open&&s.position==="popper"?f.jsx(q0,{...i,...r,ref:e}):null});A9.displayName=fv;function $P(t){return t===""||t===void 0}var FP=m.forwardRef((t,e)=>{const{value:n,...r}=t,i=m.useRef(null),o=Se(e,i),s=f9(n);return m.useEffect(()=>{const a=i.current,l=window.HTMLSelectElement.prototype,u=Object.getOwnPropertyDescriptor(l,"value").set;if(s!==n&&u){const d=new Event("change",{bubbles:!0});u.call(a,n),a.dispatchEvent(d)}},[s,n]),f.jsx(kp,{asChild:!0,children:f.jsx("select",{...r,ref:o,defaultValue:n})})});FP.displayName="BubbleSelect";function BP(t){const e=It(t),n=m.useRef(""),r=m.useRef(0),i=m.useCallback(s=>{const a=n.current+s;e(a),function l(c){n.current=c,window.clearTimeout(r.current),c!==""&&(r.current=window.setTimeout(()=>l(""),1e3))}(a)},[e]),o=m.useCallback(()=>{n.current="",window.clearTimeout(r.current)},[]);return m.useEffect(()=>()=>window.clearTimeout(r.current),[]),[n,i,o]}function zP(t,e,n){const i=e.length>1&&Array.from(e).every(c=>c===e[0])?e[0]:e,o=n?t.indexOf(n):-1;let s=N9(t,Math.max(o,0));i.length===1&&(s=s.filter(c=>c!==n));const l=s.find(c=>c.textValue.toLowerCase().startsWith(i.toLowerCase()));return l!==n?l:void 0}function N9(t,e){return t.map((n,r)=>t[(e+r)%t.length])}var Di=yP,Li=xP,$i=bP,Fi=SP,Bi=CP,zi=kP,Vi=RP,VP=IP,UP=AP,Ui=jP,Hi=DP;const pa=({children:t,className:e,...n})=>f.jsx(VP,{className:`text-[13px] leading-none text-gray-700 rounded-[3px] flex items-center h-[25px] pr-[35px] pl-[25px] relative select-none data-[disabled]:text-gray-400 data-[disabled]:pointer-events-none data-[highlighted]:outline-none data-[highlighted]:bg-blue-100 data-[highlighted]:text-blue-900 ${e}`,...n,children:f.jsx(UP,{children:t})});function j9(){const t=Qe(),{user:e}=Nt(),n=Hr(),[r,i]=m.useState(Aa);m.useEffect(()=>{e!=null&&e.note_preferences&&i(a=>({...a,...e.note_preferences}))},[e==null?void 0:e.note_preferences]);const{mutateAsync:o}=Mr({mutationFn:async a=>{if(!(e!=null&&e.id))throw new Error("No user found");const l=e.note_preferences||Aa,{error:c}=await t.from("user_profiles").update({note_preferences:{...l,...a}}).eq("id",e.id);if(c)throw c},onSuccess:()=>{n.invalidateQueries({queryKey:["user"]})}}),s=(a,l)=>{i(c=>({...c,[a]:l})),o({[a]:l}).catch(c=>{console.error("Failed to update preferences:",c)})};return f.jsxs("div",{className:"h-full overflow-auto pr-4 pb-12",children:[f.jsx("div",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Editor Settings"}),f.jsx("div",{className:"space-y-6",children:f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Default Copy Mode"}),f.jsxs(Di,{value:r.default_copy_mode,onValueChange:a=>s("default_copy_mode",a),children:[f.jsxs(Li,{className:"inline-flex items-center justify-between rounded-md px-3 py-2 text-sm leading-none gap-1 bg-white border border-gray-300 h-9 w-full max-w-md outline-none focus:border-blue-500 data-[placeholder]:text-gray-500",children:[f.jsx($i,{}),f.jsx(Fi,{children:f.jsx(Xe,{className:"h-4 w-4 text-gray-500"})})]}),f.jsx(Bi,{children:f.jsxs(zi,{className:"overflow-hidden bg-white rounded-md shadow-lg border border-gray-200",children:[f.jsx(Ui,{className:"flex items-center justify-center h-6 bg-white text-gray-500 cursor-default",children:f.jsx(Ai,{})}),f.jsx(Vi,{className:"p-1",children:c9.map(a=>f.jsx(pa,{value:a.value,children:a.label},a.value))}),f.jsx(Hi,{className:"flex items-center justify-center h-6 bg-white text-gray-500 cursor-default",children:f.jsx(Xe,{})})]})})]})]})}),f.jsx("div",{className:"text-lg font-semibold text-gray-900 mt-8 mb-4",children:"Date"}),f.jsx("div",{className:"space-y-6",children:f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date format"}),f.jsxs(Di,{value:r.date_format,onValueChange:a=>s("date_format",a),children:[f.jsxs(Li,{className:"inline-flex items-center justify-between rounded-md px-3 py-2 text-sm leading-none gap-1 bg-white border border-gray-300 h-9 w-full max-w-md outline-none focus:border-blue-500 data-[placeholder]:text-gray-500",children:[f.jsx($i,{}),f.jsx(Fi,{children:f.jsx(Xe,{className:"h-4 w-4 text-gray-500"})})]}),f.jsx(Bi,{children:f.jsxs(zi,{className:"overflow-hidden bg-white rounded-md shadow-lg border border-gray-200",children:[f.jsx(Ui,{className:"flex items-center justify-center h-6 bg-white text-gray-500 cursor-default",children:f.jsx(Ai,{})}),f.jsx(Vi,{className:"p-1",children:u9.map(a=>f.jsx(pa,{value:a.value,children:a.label},a.value))}),f.jsx(Hi,{className:"flex items-center justify-center h-6 bg-white text-gray-500 cursor-default",children:f.jsx(Xe,{})})]})})]})]})}),f.jsx("div",{className:"text-lg font-semibold text-gray-900 mt-8 mb-4",children:"Language & spelling"}),f.jsxs("div",{className:"grid grid-cols-2 gap-x-6 gap-y-6",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Primary Spoken Language"}),f.jsxs(Di,{value:r.primary_language,onValueChange:a=>s("primary_language",a),children:[f.jsxs(Li,{className:"inline-flex items-center justify-between rounded-md px-3 py-2 text-sm leading-none gap-1 bg-white border border-gray-300 h-9 w-full max-w-md outline-none focus:border-blue-500 data-[placeholder]:text-gray-500",children:[f.jsx($i,{}),f.jsx(Fi,{children:f.jsx(Xe,{className:"h-4 w-4 text-gray-500"})})]}),f.jsx(Bi,{children:f.jsxs(zi,{className:"overflow-hidden bg-white rounded-md shadow-lg border border-gray-200",children:[f.jsx(Ui,{className:"flex items-center justify-center h-6 bg-white text-gray-500 cursor-default",children:f.jsx(Ai,{})}),f.jsx(Vi,{className:"p-1",children:av.map(a=>f.jsx(pa,{value:a.value,children:a.label},a.value))}),f.jsx(Hi,{className:"flex items-center justify-center h-6 bg-white text-gray-500 cursor-default",children:f.jsx(Xe,{})})]})})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Default Note Language"}),f.jsxs(Di,{value:r.preferred_note_language,onValueChange:a=>s("preferred_note_language",a),children:[f.jsxs(Li,{className:"inline-flex items-center justify-between rounded-md px-3 py-2 text-sm leading-none gap-1 bg-white border border-gray-300 h-9 w-full max-w-md outline-none focus:border-blue-500 data-[placeholder]:text-gray-500",children:[f.jsx($i,{}),f.jsx(Fi,{children:f.jsx(Xe,{className:"h-4 w-4 text-gray-500"})})]}),f.jsx(Bi,{children:f.jsxs(zi,{className:"overflow-hidden bg-white rounded-md shadow-lg border border-gray-200",children:[f.jsx(Ui,{className:"flex items-center justify-center h-6 bg-white text-gray-500 cursor-default",children:f.jsx(Ai,{})}),f.jsx(Vi,{className:"p-1",children:av.filter(a=>a.value!=="auto").map(a=>f.jsx(pa,{value:a.value,children:a.label},a.value))}),f.jsx(Hi,{className:"flex items-center justify-center h-6 bg-white text-gray-500 cursor-default",children:f.jsx(Xe,{})})]})})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Patient Instructions Language"}),f.jsxs(Di,{value:r.patient_instructions_language,onValueChange:a=>s("patient_instructions_language",a),children:[f.jsxs(Li,{className:"inline-flex items-center justify-between rounded-md px-3 py-2 text-sm leading-none gap-1 bg-white border border-gray-300 h-9 w-full max-w-md outline-none focus:border-blue-500 data-[placeholder]:text-gray-500",children:[f.jsx($i,{}),f.jsx(Fi,{children:f.jsx(Xe,{className:"h-4 w-4 text-gray-500"})})]}),f.jsx(Bi,{children:f.jsxs(zi,{className:"overflow-hidden bg-white rounded-md shadow-lg border border-gray-200",children:[f.jsx(Ui,{className:"flex items-center justify-center h-6 bg-white text-gray-500 cursor-default",children:f.jsx(Ai,{})}),f.jsx(Vi,{className:"p-1",children:gP.map(a=>f.jsx(pa,{value:a.value,children:a.label},a.value))}),f.jsx(Hi,{className:"flex items-center justify-center h-6 bg-white text-gray-500 cursor-default",children:f.jsx(Xe,{})})]})})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Spelling"}),f.jsxs(Di,{value:r.spelling,onValueChange:a=>s("spelling",a),children:[f.jsxs(Li,{className:"inline-flex items-center justify-between rounded-md px-3 py-2 text-sm leading-none gap-1 bg-white border border-gray-300 h-9 w-full max-w-md outline-none focus:border-blue-500 data-[placeholder]:text-gray-500",children:[f.jsx($i,{}),f.jsx(Fi,{children:f.jsx(Xe,{className:"h-4 w-4 text-gray-500"})})]}),f.jsx(Bi,{children:f.jsxs(zi,{className:"overflow-hidden bg-white rounded-md shadow-lg border border-gray-200",children:[f.jsx(Ui,{className:"flex items-center justify-center h-6 bg-white text-gray-500 cursor-default",children:f.jsx(Ai,{})}),f.jsx(Vi,{className:"p-1",children:d9.map(a=>f.jsx(pa,{value:a.value,children:a.label},a.value))}),f.jsx(Hi,{className:"flex items-center justify-center h-6 bg-white text-gray-500 cursor-default",children:f.jsx(Xe,{})})]})})]})]})]}),f.jsx("div",{className:"text-lg font-semibold text-gray-900 mt-8 mb-4",children:"Reference format"}),f.jsxs("div",{className:"grid grid-cols-2 gap-x-6 gap-y-6",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Refer to patient"}),f.jsx("input",{className:"w-full max-w-md rounded-md border border-gray-300 px-3 py-2 text-sm outline-none focus:border-blue-500",type:"text",value:r.patient_reference_format,onChange:a=>s("patient_reference_format",a.target.value),placeholder:"e.g Title + Firstname + Lastname"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Refer to clinician"}),f.jsx("input",{className:"w-full max-w-md rounded-md border border-gray-300 px-3 py-2 text-sm outline-none focus:border-blue-500",type:"text",value:r.clinician_reference_format,onChange:a=>s("clinician_reference_format",a.target.value),placeholder:"e.g Dr Smith"})]})]})]})}function D9(){const[t,e]=m.useState("preferences");return f.jsx("div",{style:zt.container,children:f.jsxs("div",{style:zt.section,children:[f.jsxs("div",{style:zt.header,children:[f.jsx("h1",{style:zt.title,children:"Settings"}),f.jsxs("div",{style:zt.tabs,children:[f.jsx("div",{style:{...zt.tab,...t==="preferences"?zt.activeTab:{}},onClick:()=>e("preferences"),children:"Note Preferences"}),f.jsx("div",{style:{...zt.tab,...t==="memory"?zt.activeTab:{}},onClick:()=>e("memory"),children:"Memory"})]})]}),f.jsx("div",{style:zt.contentContainer,children:t==="preferences"?f.jsx(j9,{}):f.jsx(yH,{})})]})})}const je={container:{padding:"32px",width:"100%",height:"100%",backgroundColor:"#fff"},section:{maxWidth:"1200px",margin:"0 auto"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"32px"},title:{fontSize:"24px",fontWeight:"600",color:"#1f2937"},actions:{display:"flex",gap:"12px"},button:{display:"flex",alignItems:"center",gap:"8px",padding:"8px 16px",borderRadius:"6px",fontSize:"14px",fontWeight:"500"},primaryButton:{backgroundColor:"#1f2937",color:"white",border:"none"},secondaryButton:{backgroundColor:"transparent",color:"#1f2937",border:"1px solid #e5e7eb"},searchBar:{display:"flex",gap:"12px",marginBottom:"24px"},searchInput:{flex:"1",maxWidth:"320px",padding:"8px 12px",border:"1px solid #e5e7eb",borderRadius:"6px",fontSize:"14px"},table:{width:"100%",borderCollapse:"collapse"},tableHeader:{textAlign:"left",padding:"12px 16px",fontSize:"14px",fontWeight:"500",color:"#6b7280",borderBottom:"1px solid #e5e7eb"},tableCell:{padding:"12px 16px",fontSize:"14px",color:"#374151",borderBottom:"1px solid #e5e7eb"},templateType:{fontSize:"12px",padding:"4 px 6px",marginLeft:"8px",backgroundColor:"#f3f4f6",borderRadius:"12px",color:"#6b7280"},actionButton:{padding:"4px",border:"none",background:"none",cursor:"pointer",color:"#6b7280","&:hover":{color:"#374151"}}};function L9(){const[t,e]=m.useState([]),[n,r]=m.useState(!0),[i,o]=m.useState(""),s=Qe(),{user:a}=Nt();m.useEffect(()=>{(async()=>{try{if(!(a!=null&&a.id))return;const{data:u,error:d}=await s.from("template_library").select("*").or(`owner_id.eq.${a.id}`).order("name");if(d)throw d;e(u||[])}catch(u){console.error("Error fetching templates:",u)}finally{r(!1)}})()},[s,a==null?void 0:a.id]);const l=t.filter(c=>c.name.toLowerCase().includes(i.toLowerCase()));return n?f.jsx("div",{style:je.container,children:f.jsxs("div",{style:je.section,children:[f.jsx("h1",{style:je.title,children:"My Templates"}),f.jsx("div",{children:"Loading templates..."})]})}):f.jsx("div",{style:je.container,children:f.jsxs("div",{style:je.section,children:[f.jsxs("div",{style:je.header,children:[f.jsx("h1",{style:je.title,children:"My Templates"}),f.jsxs("div",{style:je.actions,children:[f.jsx("button",{style:{...je.button,...je.secondaryButton},children:"Browse community"}),f.jsx("button",{style:{...je.button,...je.primaryButton},children:"Create template"})]})]}),f.jsx("div",{style:je.searchBar,children:f.jsx("input",{type:"text",placeholder:"Search templates...",value:i,onChange:c=>o(c.target.value),style:je.searchInput})}),f.jsxs("table",{style:je.table,children:[f.jsx("thead",{children:f.jsxs("tr",{children:[f.jsx("th",{style:je.tableHeader,children:"Template name"}),f.jsx("th",{style:je.tableHeader,children:"Creator"}),f.jsx("th",{style:je.tableHeader,children:"Visibility"}),f.jsx("th",{style:je.tableHeader})]})}),f.jsx("tbody",{children:l.map(c=>f.jsxs("tr",{children:[f.jsxs("td",{style:je.tableCell,children:[c.name,f.jsx("span",{style:je.templateType,children:c.type})]}),f.jsx("td",{style:je.tableCell,children:c.owner_id===(a==null?void 0:a.id)?"Me":"Library"}),f.jsx("td",{style:je.tableCell,children:"Just me"}),f.jsx("td",{style:je.tableCell,children:f.jsx("button",{style:je.actionButton,children:""})})]},c.id))})]})]})})}const ht={container:{padding:"32px",width:"100%",height:"100%",backgroundColor:"#fff"},section:{maxWidth:"1200px",margin:"0 auto"},title:{fontSize:"16px",fontWeight:"500",marginBottom:"32px",color:"#1f2937"},searchContainer:{marginBottom:"24px"},searchInput:{width:"100%",maxWidth:"400px",padding:"8px 16px",fontSize:"14px",border:"1px solid #e5e7eb",borderRadius:"6px","&:focus":{outline:"none",borderColor:"#2563eb",boxShadow:"0 0 0 2px rgba(37, 99, 235, 0.2)"}},templateGrid:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:"16px",marginTop:"24px"},templateCard:{backgroundColor:"white",borderRadius:"8px",border:"1px solid #e5e7eb",padding:"16px",transition:"all 0.2s ease","&:hover":{transform:"translateY(-2px)",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)"}},templateName:{fontSize:"18px",fontWeight:"500",color:"#111827",marginBottom:"8px"},templateDescription:{fontSize:"14px",color:"#6b7280",marginBottom:"12px"},templateMeta:{display:"flex",justifyContent:"space-between",alignItems:"center",fontSize:"12px",color:"#6b7280"},templateType:{display:"inline-block",padding:"2px 8px",backgroundColor:"#f3f4f6",borderRadius:"12px",fontSize:"12px",color:"#374151"},noTemplates:{textAlign:"center",padding:"48px",color:"#6b7280",backgroundColor:"#f9fafb",borderRadius:"8px",border:"1px dashed #e5e7eb"},tagsContainer:{display:"flex",flexWrap:"wrap",gap:"8px",marginBottom:"12px"},tag:{display:"inline-block",padding:"2px 8px",backgroundColor:"#e5e7eb",borderRadius:"12px",fontSize:"12px",color:"#374151"}};function $9(){const[t,e]=m.useState([]),[n,r]=m.useState(!0),[i,o]=m.useState(""),s=Qe(),{user:a}=Nt();return m.useEffect(()=>{(async()=>{try{const c=s.from("template_library").select("*").neq("owner_id",(a==null?void 0:a.id)||"").order("name");i&&c.or(`name.ilike.%${i}%,description.ilike.%${i}%`);const{data:u,error:d}=await c;if(d)throw d;e(u||[])}catch(c){console.error("Error fetching templates:",c)}finally{r(!1)}})()},[s,i,a==null?void 0:a.id]),n?f.jsx("div",{style:ht.container,children:f.jsxs("div",{style:ht.section,children:[f.jsx("h1",{style:ht.title,children:"Community Templates"}),f.jsx("div",{children:"Loading templates..."})]})}):f.jsx("div",{style:ht.container,children:f.jsxs("div",{style:ht.section,children:[f.jsx("h1",{style:ht.title,children:"Community Templates"}),f.jsx("div",{style:ht.searchContainer,children:f.jsx("input",{type:"text",placeholder:"Search templates...",value:i,onChange:l=>o(l.target.value),style:ht.searchInput})}),t.length===0?f.jsx("div",{style:ht.noTemplates,children:i?"No templates found matching your search.":"No community templates available."}):f.jsx("div",{style:ht.templateGrid,children:t.map(l=>f.jsxs("div",{style:ht.templateCard,children:[f.jsx("div",{style:ht.templateName,children:l.name}),l.description&&f.jsx("div",{style:ht.templateDescription,children:l.description}),l.tags&&l.tags.length>0&&f.jsx("div",{style:ht.tagsContainer,children:l.tags.map((c,u)=>f.jsx("span",{style:ht.tag,children:c},u))}),f.jsxs("div",{style:ht.templateMeta,children:[f.jsx("div",{style:ht.templateType,children:l.type.charAt(0).toUpperCase()+l.type.slice(1)}),l.specialty&&f.jsx("div",{children:l.specialty})]})]},l.id))})]})})}function Ci({children:t}){const{user:e,loading:n,error:r}=Nt(),i=Gn(),[o,s]=m.useState(!0);return console.log("ProtectedRoute state:",{isAuthenticated:!!e,userId:e==null?void 0:e.id,isLoading:n,hasError:!!r,errorMessage:r,path:i.pathname,isInitialLoad:o}),m.useEffect(()=>{!n&&o&&s(!1)},[n]),n||o?f.jsxs("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,height:"100vh",width:"100vw",display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:"#f3f4f6",flexDirection:"column",gap:"12px",zIndex:9999},children:[f.jsx("div",{style:{width:"48px",height:"48px",border:"4px solid #e5e7eb",borderTopColor:"#3b82f6",borderRadius:"50%",animation:"spin 1s linear infinite"}}),f.jsx("div",{style:{fontSize:"16px",color:"#4b5563",marginTop:"16px"},children:"Loading..."}),f.jsx("style",{children:`
          @keyframes spin {
            to {
              transform: rotate(360deg);
            }
          }
        `})]}):(r&&console.error("ProtectedRoute error:",r),e?(console.log("ProtectedRoute: User authenticated, rendering protected content"),f.jsx(f.Fragment,{children:t})):(console.log("ProtectedRoute: No user found, redirecting to login"),f.jsx(Kf,{to:"/login",state:{from:i},replace:!0})))}const _e={container:{flex:1,overflowY:"auto",display:"flex",flexDirection:"column"},filtersContainer:{padding:"12px",backgroundColor:"white",borderBottom:"1px solid #e5e7eb",display:"flex",gap:"8px",position:"sticky",top:0,zIndex:10},searchContainer:{flex:1,position:"relative"},searchInput:{width:"100%",padding:"8px 12px 8px 36px",fontSize:"14px",borderRadius:"6px",border:"1px solid #e5e7eb",outline:"none"},searchIcon:{position:"absolute",left:"12px",top:"50%",transform:"translateY(-50%)",color:"#6b7280"},filterButton:{display:"flex",alignItems:"center",gap:"4px",padding:"8px 12px",fontSize:"14px",backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"6px",cursor:"pointer"},dropdownContent:{minWidth:"160px",backgroundColor:"white",borderRadius:"6px",padding:"5px",boxShadow:"0px 10px 38px -10px rgba(22, 23, 24, 0.35), 0px 10px 20px -15px rgba(22, 23, 24, 0.2)",zIndex:9999},dropdownItem:{fontSize:"14px",lineHeight:"1",color:"#374151",borderRadius:"3px",display:"flex",alignItems:"center",height:"32px",padding:"0 8px",userSelect:"none",outline:"none",cursor:"pointer"},selectedDropdownItem:{backgroundColor:"#f0f9ff",color:"#2563eb"},listContainer:{flex:1,overflowY:"auto"},dateGroup:{display:"flex",flexDirection:"column",gap:"1px",marginBottom:"16px"},dateHeader:{fontSize:"12px",fontWeight:"600",color:"#6b7280",padding:"4px 12px",backgroundColor:"#f9fafb",borderTop:"1px solid #e5e7eb",borderBottom:"1px solid #e5e7eb",textTransform:"uppercase",letterSpacing:"0.05em"},visitItem:{display:"flex",flexDirection:"column",padding:"8px 12px",backgroundColor:"white",cursor:"pointer",transition:"all 0.2s ease",position:"relative"},selectedVisit:{backgroundColor:"#f0f9ff"},visitHeader:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",gap:"8px"},visitName:{fontSize:"15px",fontWeight:"600",color:"#111827",flex:1},visitState:{fontSize:"12px",padding:"2px 6px",borderRadius:"4px",backgroundColor:"#f3f4f6",color:"#374151",textTransform:"capitalize",flexShrink:0},visitTime:{fontSize:"12px",color:"#6b7280",marginTop:"2px"},loadingContainer:{display:"flex",justifyContent:"center",alignItems:"center",height:"100px",color:"#6b7280"},actionIcons:{position:"absolute",bottom:"8px",right:"12px",display:"flex",gap:"6px",opacity:0,transition:"opacity 0.2s ease"},actionIconsVisible:{opacity:1},iconButton:{background:"none",backgroundColor:"transparent",border:"none",cursor:"pointer",padding:"2px",borderRadius:"4px",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s ease"},iconButtonHover:{backgroundColor:"#d1d5db"},trashIcon:{},letterIcon:{}},F9=m.memo(function({visit:e,isSelected:n,onSelect:r}){const[i,o]=m.useState(!1),[s,a]=m.useState(!1),[l,c]=m.useState(!1),{showToast:u}=hP(),{data:d}=iu({queryKey:["patient",e.patient_id],queryFn:async()=>{if(!e.patient_id)return null;const{data:b}=await Ut.from("patient_profiles").select("name").eq("id",e.patient_id).single();return b},enabled:!!e.patient_id}),h=(d==null?void 0:d.name)||e.name||"Untitled",p=new Date(e.started_at).toLocaleTimeString([],{hour:"numeric",minute:"2-digit"}),y=`${new Date(e.started_at).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})} at ${p}`,x=async b=>{b.stopPropagation();const{error:S}=await Ut.from("visits").update({state:"trash"}).eq("id",e.id);S?(console.error("Error updating visit state:",S),u("Error","Failed to move visit to trash","error")):u("Success",`"${h}" (${y}) moved to trash`,"success")},v=async b=>{b.stopPropagation();const{error:S}=await Ut.from("visits").update({state:"completed"}).eq("id",e.id);S?(console.error("Error updating visit state:",S),u("Error","Failed to mark visit as completed","error")):u("Success",`"${h}" (${y}) marked as completed`,"success")},w=async()=>{if(e.state==="ready"){const{error:b}=await Ut.from("visits").update({state:"seen"}).eq("id",e.id);b&&console.error("Error updating visit state:",b)}r(e)};return f.jsxs("div",{style:{..._e.visitItem,...n?_e.selectedVisit:{}},onClick:w,onMouseEnter:()=>o(!0),onMouseLeave:()=>o(!1),children:[f.jsxs("div",{style:_e.visitHeader,children:[f.jsx("div",{style:_e.visitName,children:h}),f.jsx("div",{style:_e.visitState,children:e.state})]}),f.jsx("div",{style:_e.visitTime,children:p}),f.jsxs("div",{style:{..._e.actionIcons,...i?_e.actionIconsVisible:{}},children:[["ready","seen","completed"].includes(e.state)&&f.jsx("button",{style:{..._e.iconButton,...s?_e.iconButtonHover:{}},onClick:x,title:"Move to trash",onMouseEnter:()=>a(!0),onMouseLeave:()=>a(!1),children:f.jsx(QF,{size:14})}),["ready","seen"].includes(e.state)&&f.jsx("button",{style:{..._e.iconButton,...l?_e.iconButtonHover:{}},onClick:v,title:"Mark as completed",onMouseEnter:()=>c(!0),onMouseLeave:()=>c(!1),children:f.jsx(PF,{size:14})})]})]})});function B9({visits:t,onVisitSelect:e,selectedVisitId:n,onContinueRecording:r}){const{user:i}=Nt(),[o,s]=m.useState(!0),[a,l]=m.useState(""),[c,u]=m.useState("todo"),[d,h]=m.useState({});m.useEffect(()=>{const w=[...new Set(t.filter(b=>b.patient_id).map(b=>b.patient_id))];w.length>0&&(async()=>{const{data:S,error:C}=await Ut.from("patient_profiles").select("id, name").in("id",w);if(!C&&S){const k=S.reduce((E,T)=>(E[T.id]=T.name,E),{});h(k)}})()},[t]);const p=m.useCallback(w=>{w.state==="paused"&&r?r(w):e==null||e(w)},[r,e]),g=m.useMemo(()=>t.filter(w=>{var k,E;if(c==="todo"){if(["trash","completed","deleted"].includes(w.state))return!1}else if(c==="all"){if(["trash","deleted"].includes(w.state))return!1}else if(c==="trash"&&w.state!=="trash")return!1;if(!a)return!0;const b=a.toLowerCase(),S=((k=w.name)==null?void 0:k.toLowerCase())||"",C=w.patient_id&&((E=d[w.patient_id])==null?void 0:E.toLowerCase())||"";return S.includes(b)||C.includes(b)}),[t,a,c,d]),y=m.useMemo(()=>g.reduce((w,b)=>{const S=new Date(b.started_at).toLocaleDateString("en-US",{month:"2-digit",day:"2-digit",year:"numeric"});return w[S]||(w[S]=[]),w[S].push(b),w},{}),[g]);m.useEffect(()=>{i!=null&&i.id&&s(t.length===0)},[i==null?void 0:i.id,t.length]);const x=w=>{switch(w){case"todo":return"To Do";case"all":return"All";case"trash":return"Trash";default:return"To Do"}};if(!(i!=null&&i.id)||o)return f.jsx("div",{style:_e.container,children:f.jsx("div",{style:_e.loadingContainer,children:o?"Your visits will appear here":"Loading..."})});const v=Object.keys(y).sort((w,b)=>new Date(b).getTime()-new Date(w).getTime());return f.jsxs("div",{style:_e.container,children:[f.jsxs("div",{style:_e.filtersContainer,children:[f.jsxs("div",{style:_e.searchContainer,children:[f.jsx("input",{type:"text",placeholder:"Search",value:a,onChange:w=>l(w.target.value),style:_e.searchInput}),f.jsx("span",{style:_e.searchIcon,children:f.jsx(U_,{width:16,height:16})})]}),f.jsxs(Ds,{children:[f.jsx(Ls,{asChild:!0,children:f.jsxs("button",{style:_e.filterButton,children:[x(c),f.jsx(Xe,{width:16,height:16})]})}),f.jsx($s,{children:f.jsx(Fs,{style:_e.dropdownContent,sideOffset:5,children:["todo","all","trash"].map(w=>{const b=w===c;return f.jsx(gt,{style:{..._e.dropdownItem,...b?_e.selectedDropdownItem:{}},onClick:()=>u(w),children:x(w)},w)})})})]})]}),f.jsx("div",{style:_e.listContainer,children:v.length>0?v.map(w=>f.jsxs("div",{style:_e.dateGroup,children:[f.jsx("div",{style:_e.dateHeader,children:w}),y[w].sort((b,S)=>new Date(S.started_at).getTime()-new Date(b.started_at).getTime()).map(b=>f.jsx(F9,{visit:b,isSelected:b.id===n,onSelect:p},b.id))]},w)):f.jsx("div",{style:_e.loadingContainer,children:a?"No matching visits found":`No visits in ${x(c).toLowerCase()}`})})]})}const z9=({user:t,onSignOut:e})=>{const n=gr();return f.jsx("div",{style:Et.userSection,children:f.jsxs(Ds,{children:[f.jsx(Ls,{asChild:!0,children:f.jsxs("button",{style:Et.userButton,children:[f.jsxs("div",{style:Et.userInfo,children:[f.jsxs("span",{style:Et.userName,children:[t!=null&&t.title?`${t.title} `:""," ",t!=null&&t.name?`${t.name}`:"User"]}),f.jsx("span",{style:Et.userSpecialty,children:(t==null?void 0:t.specialty)||"No specialty set"})]}),f.jsx(Xe,{style:Et.chevronIcon})]})}),f.jsx($s,{children:f.jsxs(Fs,{style:Et.dropdownContent,sideOffset:5,align:"start",children:[f.jsx(gt,{asChild:!0,children:f.jsx("button",{style:Et.dropdownItem,onClick:()=>n("/profile"),children:"Profile"})}),f.jsx(gt,{asChild:!0,children:f.jsx("button",{style:Et.dropdownItem,onClick:()=>n("/settings"),children:"Settings"})}),f.jsx(gt,{asChild:!0,children:f.jsx("button",{style:Et.dropdownItem,onClick:()=>n("/group"),children:"Group Settings"})}),f.jsx(gt,{asChild:!0,children:f.jsx("button",{style:Et.dropdownItem,onClick:()=>n("/patients"),children:"Patients"})}),f.jsx(Yb,{style:Et.dropdownSeparator}),f.jsx(gt,{asChild:!0,children:f.jsx("button",{style:Et.dropdownItem,onClick:()=>n("/my-templates"),children:"My Templates"})}),f.jsx(gt,{asChild:!0,children:f.jsx("button",{style:Et.dropdownItem,onClick:()=>n("/community-templates"),children:"Community Templates"})}),f.jsx(Yb,{style:Et.dropdownSeparator}),f.jsx(gt,{asChild:!0,children:f.jsx("button",{style:Et.dropdownItem,onClick:e,children:"Logout"})})]})})]})})},Et={userSection:{padding:"12px",borderBottom:"1px solid #e5e7eb"},userButton:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%",padding:"8px",border:"none",borderRadius:"6px",background:"transparent",cursor:"pointer",":hover":{backgroundColor:"#f5f5f5"}},userInfo:{display:"flex",flexDirection:"column",alignItems:"flex-start",gap:"2px"},userName:{fontSize:"14px",fontWeight:600,color:"#111827"},userSpecialty:{fontSize:"12px",color:"#6b7280",fontWeight:500},chevronIcon:{width:"16px",height:"16px",color:"#666"},dropdownContent:{maxWidth:"280px",backgroundColor:"white",borderRadius:"6px",padding:"4px",boxShadow:"0 2px 10px rgba(0, 0, 0, 0.1)",zIndex:100},dropdownItem:{width:"100%",border:"none",borderRadius:"4px",padding:"8px 12px",fontSize:"14px",textAlign:"left",backgroundColor:"transparent",cursor:"pointer",":hover":{backgroundColor:"#f5f5f5"}},dropdownSeparator:{height:"1px",backgroundColor:"#eaeaea",margin:"4px 0"}},Zm={sidebar:{width:"240px",backgroundColor:"#ffffff",display:"flex",flexDirection:"column",overflow:"hidden",borderRight:"1px solid #d1d5db",height:"100vh",position:"relative",zIndex:50},userSection:{padding:"16px 16px 12px 16px",borderBottom:"1px solid #d1d5db",backgroundColor:"#ffffff",marginBottom:"8px"},userButton:{width:"100%",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"12px",backgroundColor:"transparent",border:"none",cursor:"pointer",transition:"all 0.2s ease","&:hover":{backgroundColor:"#f3f4f6"}},userInfo:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1},userName:{fontSize:"14px",fontWeight:"500",color:"#111827"},userEmail:{fontSize:"12px",color:"#6b7280",marginTop:"2px"},chevronIcon:{color:"#9ca3af",width:"12px",height:"12px",marginLeft:"8px",flexShrink:0},dropdownContent:{minWidth:"200px",backgroundColor:"white",borderRadius:"8px",padding:"6px",boxShadow:"0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05)",border:"1px solid #e5e7eb"},dropdownItem:{fontSize:"14px",padding:"8px 12px",borderRadius:"6px",cursor:"pointer",color:"#374151",display:"block",width:"100%",textAlign:"left",border:"none",backgroundColor:"transparent",transition:"all 0.2s ease","&:hover":{backgroundColor:"#f3f4f6",color:"#111827"}},dropdownSeparator:{height:"1px",backgroundColor:"#e5e7eb",margin:"6px"},newSessionButton:{display:"flex",alignItems:"center",backgroundColor:"#FF8080",color:"#ffffff",border:"none",cursor:"pointer",fontSize:"14px",fontWeight:"600",margin:"16px 12px 16px 12px",width:"calc(100% - 24px)",justifyContent:"center",borderRadius:"8px",transition:"all 0.2s ease","&:hover":{backgroundColor:"#ff6666",transform:"translateY(-1px)"},"&:active":{transform:"translateY(0px)"}},visitsContainer:{flex:1,overflow:"auto",borderTop:"1px solid #e5e7eb"}};function V9({onNewSession:t,onVisitSelect:e,selectedVisitId:n,onContinueRecording:r,visits:i=[]}){const o=gr(),{user:s}=Nt(),{signOut:a}=mP();console.log("[Sidebar] Render with visits:",i.length);const l=async()=>{try{await a(),o("/login")}catch(c){console.error("Error signing out:",c)}};if(s)return f.jsxs("div",{style:Zm.sidebar,children:[f.jsx(z9,{user:s,onSignOut:l}),f.jsx("button",{style:Zm.newSessionButton,onClick:t,children:"New Session"}),f.jsx("div",{style:Zm.visitsContainer,children:f.jsx(B9,{visits:i,onVisitSelect:e,selectedVisitId:n,onContinueRecording:r})})]})}const Ge=(...t)=>{console.log("[useRealtimeVisits]",...t)};function U9(t){const[e,n]=m.useState([]),r=m.useRef(!1),i=m.useRef(null),o=m.useRef(null),s=m.useRef([]);m.useEffect(()=>{s.current=e,Ge("Updated visitsRef:",e.length,"visits")},[e]),m.useEffect(()=>{if(!t||r.current)return;(async()=>{Ge("Fetching initial visits for user:",t);const{data:c,error:u}=await Ut.from("visits").select("*").eq("user_id",t).order("started_at",{ascending:!1});if(u){Ge("Error fetching initial visits:",u);return}c&&(Ge(`Setting initial ${c.length} visits`),n(c),s.current=c,r.current=!0)})()},[t]);const a=m.useCallback(l=>{const c=[...l].sort((u,d)=>new Date(d.started_at).getTime()-new Date(u.started_at).getTime());n(c)},[]);return m.useEffect(()=>{if(!t){Ge("No userId, skipping subscription");return}Ge("Setting up realtime subscription for user:",t),i.current&&(Ge("Cleaning up existing subscription"),i.current.unsubscribe(),i.current=null);const l=Ut.channel(`visits_list_${t}`).on("postgres_changes",{event:"*",schema:"public",table:"visits",filter:`user_id=eq.${t}`},c=>{const u=new Date().toISOString(),d=o.current?new Date(u).getTime()-new Date(o.current).getTime():null;switch(Ge("Received realtime event:",c.eventType,{...c,timeSinceLastUpdate:d?`${d}ms`:"first update",currentVisitsCount:s.current.length}),o.current=u,c.eventType){case vo.INSERT:{const h=c.new;if(Ge("Processing insert for visit:",h.id),s.current.some(g=>g.id===h.id)){Ge("Visit already exists, skipping insert:",h.id);return}const p=[h,...s.current];Ge(`Updating visits after insert: ${p.length} visits`),a(p);break}case vo.UPDATE:{const h=c.new;Ge("Processing update for visit:",h.id);const p=s.current.map(g=>g.id===h.id?h:g);Ge(`Updating visits after update: ${p.length} visits`),a(p);break}case vo.DELETE:{const h=c.old;Ge("Processing delete for visit:",h.id);const p=s.current.filter(g=>g.id!==h.id);Ge(`Updating visits after delete: ${p.length} visits`),a(p);break}}}).subscribe(async c=>{if(Ge("Subscription status:",c),c==="SUBSCRIBED"){Ge("Requerying visits on subscription established");const{data:u,error:d}=await Ut.from("visits").select("*").eq("user_id",t).order("started_at",{ascending:!1});if(d){Ge("Error requerying visits:",d);return}u&&(Ge(`Setting ${u.length} visits from requery`),a(u))}});return i.current=l,()=>{Ge("Cleaning up subscription in effect cleanup"),l.unsubscribe(),i.current=null}},[t,a]),m.useEffect(()=>{Ge("Visits state updated:",e.length,"visits")},[e]),e}function eg({title:t,children:e}){const[n,r]=m.useState(!1);return f.jsxs("div",{className:"border border-gray-200 rounded-md mb-4",children:[f.jsxs("button",{onClick:()=>r(!n),className:"w-full px-4 py-3 flex items-center justify-between bg-gray-50 hover:bg-gray-100 transition-colors rounded-t-md",children:[f.jsx("h3",{className:"text-sm font-medium text-gray-700",children:t}),n?f.jsx(W_,{className:"h-4 w-4 text-gray-500"}):f.jsx(kF,{className:"h-4 w-4 text-gray-500"})]}),n&&f.jsx("div",{className:"p-4 bg-white rounded-b-md",children:e})]})}function H9({onClick:t,icon:e,label:n,loading:r=!1,disabled:i=!1}){return f.jsxs("button",{onClick:t,disabled:r||i,className:`
        flex items-center gap-2 px-3 py-2 text-sm 
        ${i?"bg-gray-100 text-gray-400":"bg-gray-50 text-gray-700 hover:bg-gray-100"} 
        rounded-md transition-colors
        ${r?"cursor-not-allowed":""}
      `,children:[r?f.jsx(q_,{className:"h-4 w-4 animate-spin"}):e,n]})}function W9(){const[t,e]=xN(),n=Qe(),[r,i]=m.useState(t.get("visitId")||""),[o,s]=m.useState(void 0),[a,l]=m.useState(void 0),[c,u]=m.useState([]),[d,h]=m.useState([]),[p,g]=m.useState([]),{getValidSessionToken:y}=Cp(),[x,v]=m.useState(!1);m.useEffect(()=>{const _=t.get("visitId");_&&(i(_),w(_))},[]);const w=async _=>{const A=_||r;if(A.trim()){l(void 0);try{const{data:L,error:N}=await n.from("visits").select("*").eq("id",A.trim()).single();if(N)throw N;s(L),e({visitId:A.trim()}),await b(A.trim())}catch(L){console.error("Error fetching visit:",L),l("Visit not found"),s(void 0),e({}),u([]),h([]),g([])}}},b=async _=>{try{const{data:A,error:L}=await n.from("transcripts").select("*").eq("visit_id",_).order("created_at",{ascending:!1});if(L)throw L;u(A||[]);const{data:N,error:M}=await n.from("containers").select("*").eq("visit_id",_).order("chunk_id",{ascending:!0});if(M)throw M;h(N||[]);const{data:z,error:$}=await n.from("notes").select("*").eq("visit_id",_).order("created_at",{ascending:!1});if($)throw $;g(z||[])}catch(A){console.error("Error loading visit data:",A),l("Failed to load visit data")}},S=async()=>{if(!(!(o!=null&&o.id)||x))try{v(!0);const _=await y(),A=await fetch(`${Fr.apiUrl}/admin/regenerate-visit`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json",Authorization:`Bearer ${_}`,Accept:"application/json"},body:JSON.stringify({visitId:o.id})});if(!A.ok){const L=await A.text();let N="Failed to regenerate visit";try{N=JSON.parse(L).error||N}catch{N=L||N}throw new Error(N)}await b(o.id)}catch(_){console.error("Error regenerating visit:",_),l(_ instanceof Error?_.message:"Failed to regenerate visit")}finally{v(!1)}},C=()=>{if(o)return f.jsx("div",{className:"bg-white rounded-lg shadow-sm mb-6",children:f.jsxs("div",{className:"p-6",children:[f.jsx("div",{className:"flex items-center justify-between mb-6",children:f.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"Visit Details"})}),f.jsxs("dl",{className:"grid grid-cols-2 gap-6",children:[f.jsxs("div",{children:[f.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"ID"}),f.jsx("dd",{className:"mt-1 text-sm text-gray-900",children:o.id})]}),f.jsxs("div",{children:[f.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Created At"}),f.jsx("dd",{className:"mt-1 text-sm text-gray-900",children:new Date(o.created_at).toLocaleString()})]}),f.jsxs("div",{children:[f.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Patient ID"}),f.jsx("dd",{className:"mt-1 text-sm text-gray-900",children:o.patient_id||"No patient assigned"})]}),f.jsxs("div",{children:[f.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"State"}),f.jsx("dd",{className:"mt-1 text-sm text-gray-900",children:o.state})]})]})]})})},k=()=>{if(o)return f.jsx("div",{className:"bg-white rounded-lg shadow-sm p-4 mb-6",children:f.jsx("div",{className:"flex items-center gap-4",children:f.jsx(H9,{onClick:S,icon:f.jsx(q_,{className:"h-4 w-4"}),label:"Regenerate SOAP Note",loading:x,disabled:!(o!=null&&o.id)})})})},E=()=>f.jsx(eg,{title:`Transcripts (${c.length})`,children:f.jsx("div",{className:"space-y-4",children:c.map(_=>f.jsxs("div",{className:"border border-gray-200 rounded p-3",children:[f.jsxs("div",{className:"flex justify-between mb-2",children:[f.jsx("span",{className:"text-xs text-gray-500",children:new Date(_.created_at).toLocaleString()}),f.jsxs("span",{className:"text-xs text-gray-500",children:["ID: ",_.id]})]}),f.jsx("p",{className:"text-sm text-gray-700 whitespace-pre-wrap",children:_.full_text})]},_.id))})}),T=()=>f.jsx(eg,{title:`Container Fragments (${d.length})`,children:f.jsx("div",{className:"space-y-4",children:d.map(_=>f.jsxs("div",{className:"border border-gray-200 rounded p-3",children:[f.jsxs("div",{className:"flex justify-between mb-2",children:[f.jsxs("span",{className:"text-xs text-gray-500",children:["Chunk ",_.chunk_id,"  ",_.state]}),f.jsx("span",{className:"text-xs text-gray-500",children:new Date(_.created_at).toLocaleString()})]}),f.jsx("p",{className:"text-sm text-gray-700 whitespace-pre-wrap",children:_.transcript_fragment||"No text available"})]},_.id))})}),R=()=>f.jsx(eg,{title:`Notes (${p.length})`,children:f.jsx("div",{className:"space-y-4",children:p.map(_=>f.jsxs("div",{className:"border border-gray-200 rounded p-3",children:[f.jsxs("div",{className:"flex justify-between mb-2",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("span",{className:"text-xs font-medium text-gray-700",children:_.type}),_.version_id&&f.jsxs("span",{className:"text-xs bg-gray-100 text-gray-600 px-2 py-0.5 rounded",children:["v",_.version_id]}),_.template_id&&f.jsx("span",{className:"text-xs text-gray-500",children:"Template"})]}),f.jsx("span",{className:"text-xs text-gray-500",children:new Date(_.created_at).toLocaleString()})]}),f.jsx("p",{className:"text-sm text-gray-700 whitespace-pre-wrap",children:_.content}),_.metadata&&Object.keys(_.metadata).length>0&&f.jsx("div",{className:"mt-2 pt-2 border-t border-gray-200",children:f.jsxs("details",{children:[f.jsx("summary",{className:"text-xs text-gray-500 cursor-pointer",children:"Metadata"}),f.jsx("pre",{className:"mt-2 text-xs text-gray-600 overflow-auto",children:JSON.stringify(_.metadata,null,2)})]})})]},_.id))})});return f.jsxs("div",{className:"h-screen bg-gray-50 flex",children:[f.jsxs("div",{className:"w-80 bg-white border-r border-gray-200 p-6 flex flex-col gap-6",children:[f.jsx("h1",{className:"text-xl font-semibold text-gray-900",children:"Admin Tools"}),f.jsxs("div",{className:"flex flex-col gap-2",children:[f.jsx("h2",{className:"text-sm font-medium text-gray-700",children:"Visit Search"}),f.jsx("input",{type:"text",value:r,onChange:_=>i(_.target.value),placeholder:"Enter Visit ID",className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),f.jsx("button",{onClick:()=>w(),className:"w-full px-3 py-2 text-sm bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors",children:"Search"})]}),f.jsxs("div",{className:"flex flex-col gap-2",children:[f.jsx("h2",{className:"text-sm font-medium text-gray-700",children:"Actions"}),f.jsx("button",{className:"w-full px-3 py-2 text-sm text-gray-700 bg-gray-50 hover:bg-gray-100 rounded-md text-left transition-colors",children:"Future Action 1"}),f.jsx("button",{className:"w-full px-3 py-2 text-sm text-gray-700 bg-gray-50 hover:bg-gray-100 rounded-md text-left transition-colors",children:"Future Action 2"})]})]}),f.jsxs("div",{className:"flex-1 p-6 overflow-auto",children:[a&&f.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-4 mb-6",children:f.jsx("p",{className:"text-sm text-red-600",children:a})}),o&&f.jsxs(f.Fragment,{children:[C(),k(),E(),T(),R()]})]})]})}const K9=["test@localhost"];function q9({children:t}){const{user:e,loading:n}=Nt();return n?f.jsx("div",{children:"Loading..."}):!e||!K9.includes(e.email||"")?f.jsx(Kf,{to:"/record",replace:!0}):f.jsx(f.Fragment,{children:t})}function NS({isOpen:t,onOpenChange:e,patient:n,mode:r,onSuccess:i}){const o=Qe(),{user:s}=Nt(),a=Hr(),l=Mr({mutationFn:async x=>{if(!(s!=null&&s.id))throw new Error("No user");const{data:v,error:w}=await o.from("patient_profiles").insert({...x,user_id:s.id,contact_information:{},ai_context:null}).select().single();if(w)throw w;return v},onSuccess:()=>{a.invalidateQueries({queryKey:["patients"]}),e(!1),i&&i()}}),c=Mr({mutationFn:async x=>{const{data:v,error:w}=await o.from("patient_profiles").update(x).eq("id",x.id).select().single();if(w)throw w;return v},onSuccess:()=>{a.invalidateQueries({queryKey:["patients"]}),e(!1),i&&i()}}),u=x=>{x.preventDefault();const v=new FormData(x.currentTarget),w=v.get("name");if(!w)return;const b={name:w,medical_record_number:v.get("medical_record_number")||null,phone:v.get("phone")||null,email:v.get("email")||null,pronoun:v.get("pronoun")||null,notes:v.get("notes")||null};l.mutate(b)},d=x=>{if(x.preventDefault(),!n)return;const v=new FormData(x.currentTarget),w={...n,name:v.get("name"),medical_record_number:v.get("medical_record_number")||null,phone:v.get("phone")||null,email:v.get("email")||null,pronoun:v.get("pronoun")||null,notes:v.get("notes")||null};c.mutate(w)},h=({patient:x,onSubmit:v})=>f.jsxs("form",{onSubmit:v,style:Pe.form,children:[f.jsxs("div",{style:Pe.formGroup,children:[f.jsx("label",{htmlFor:"name",style:Pe.label,children:"Name*"}),f.jsx("input",{id:"name",name:"name",type:"text",required:!0,defaultValue:(x==null?void 0:x.name)||"",style:Pe.input})]}),f.jsxs("div",{style:Pe.formGroup,children:[f.jsx("label",{htmlFor:"medical_record_number",style:Pe.label,children:"Medical Record Number"}),f.jsx("input",{id:"medical_record_number",name:"medical_record_number",type:"text",defaultValue:(x==null?void 0:x.medical_record_number)||"",style:Pe.input})]}),f.jsxs("div",{style:Pe.formGroup,children:[f.jsx("label",{htmlFor:"pronoun",style:Pe.label,children:"Pronoun"}),f.jsx("input",{id:"pronoun",name:"pronoun",type:"text",defaultValue:(x==null?void 0:x.pronoun)||"",style:Pe.input})]}),f.jsxs("div",{style:Pe.formGroup,children:[f.jsx("label",{htmlFor:"phone",style:Pe.label,children:"Phone"}),f.jsx("input",{id:"phone",name:"phone",type:"tel",defaultValue:(x==null?void 0:x.phone)||"",style:Pe.input})]}),f.jsxs("div",{style:Pe.formGroup,children:[f.jsx("label",{htmlFor:"email",style:Pe.label,children:"Email"}),f.jsx("input",{id:"email",name:"email",type:"email",defaultValue:(x==null?void 0:x.email)||"",style:Pe.input})]}),f.jsxs("div",{style:Pe.formGroup,children:[f.jsx("label",{htmlFor:"notes",style:Pe.label,children:"Notes"}),f.jsx("textarea",{id:"notes",name:"notes",defaultValue:(x==null?void 0:x.notes)||"",style:{...Pe.input,minHeight:"100px"}})]}),f.jsx("div",{style:Pe.formActions,children:f.jsx("button",{type:"submit",style:Pe.primaryButton,children:r==="edit"?"Update Patient":"Add Patient"})})]}),p=r==="add"?"Add New Patient":"Edit Patient",g=r==="add"?"Fill in the details to add a new patient.":"Update patient information.",y=r==="add"?u:d;return f.jsx(ml,{open:t,onOpenChange:e,children:f.jsxs(gl,{children:[f.jsx(yl,{style:Pe.overlay}),f.jsxs(vl,{style:Pe.dialogContent,children:[f.jsx(xl,{style:Pe.dialogTitle,children:p}),f.jsx(LT,{style:Pe.dialogDescription,children:g}),f.jsx(h,{patient:n,onSubmit:y}),f.jsx(Qf,{asChild:!0,children:f.jsx("button",{style:Pe.closeButton,children:f.jsx(Bs,{})})})]})]})})}const Pe={overlay:{backgroundColor:"rgba(0, 0, 0, 0.4)",position:"fixed",inset:0,animation:"overlayShow 150ms cubic-bezier(0.16, 1, 0.3, 1)"},dialogContent:{backgroundColor:"white",borderRadius:"6px",boxShadow:"0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)",position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"90vw",maxWidth:"500px",maxHeight:"85vh",padding:"24px",animation:"contentShow 150ms cubic-bezier(0.16, 1, 0.3, 1)",overflow:"auto"},dialogTitle:{margin:0,fontWeight:600,color:"#111827",fontSize:"18px"},dialogDescription:{marginTop:"8px",marginBottom:"20px",color:"#6b7280",fontSize:"14px"},closeButton:{position:"absolute",top:"16px",right:"16px",backgroundColor:"transparent",border:"none",borderRadius:"4px",cursor:"pointer",color:"#6b7280",display:"flex",padding:"4px"},form:{display:"flex",flexDirection:"column",gap:"16px"},formGroup:{display:"flex",flexDirection:"column",gap:"4px"},label:{fontSize:"14px",fontWeight:500,color:"#374151"},input:{padding:"8px 12px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"14px",color:"#1f2937"},formActions:{display:"flex",justifyContent:"flex-end",gap:"12px",marginTop:"12px"},primaryButton:{padding:"8px 16px",backgroundColor:"#3b82f6",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"14px",fontWeight:500},secondaryButton:{padding:"8px 16px",backgroundColor:"white",color:"#374151",border:"1px solid #d1d5db",borderRadius:"6px",cursor:"pointer",fontSize:"14px",fontWeight:500}};function G9(){const t=Qe(),{user:e}=Nt(),n=Hr(),r=gr(),[i,o]=m.useState(null),[s,a]=m.useState(!1),[l,c]=m.useState(!1),[u,d]=m.useState(!1),[h,p]=m.useState(!1),[g,y]=m.useState([]),[x,v]=m.useState({}),w=async N=>{const{data:M,error:z}=await t.from("visits").select("created_at").eq("patient_id",N).order("created_at",{ascending:!1}).limit(1);return z||!M||M.length===0?null:M[0].created_at},{data:b=[],isLoading:S}=iu({queryKey:["patients",e==null?void 0:e.id],queryFn:async()=>{if(!(e!=null&&e.id))return[];const{data:N,error:M}=await t.from("patient_profiles").select("*").eq("user_id",e.id).order("name",{ascending:!0});if(M)throw M;return(N||[]).sort((z,$)=>z.name.toLowerCase().localeCompare($.name.toLowerCase()))},enabled:!!(e!=null&&e.id)});m.useEffect(()=>{(async()=>{if(!b.length)return;const M={},z=b.map(async $=>{const V=await w($.id);M[$.id]=V});await Promise.all(z),v(M)})()},[b,t]);const C=N=>{if(!N)return"Never";const M=new Date(N);return isNaN(M.getTime())?"Invalid date":M.toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})},k=Mr({mutationFn:async N=>{const{error:M}=await t.from("patient_profiles").delete().eq("id",N);if(M)throw M;return N},onSuccess:()=>{n.invalidateQueries({queryKey:["patients"]}),d(!1)}}),E=async N=>{const{data:M,error:z}=await t.from("visits").select("*").eq("patient_id",N).order("created_at",{ascending:!1});if(z){console.error("Error loading patient visits:",z);return}y(M||[])},T=async N=>{o(N),await E(N.id),p(!0)},R=()=>{i&&k.mutate(i.id)},_=N=>({processing:"Processing",completed:"Completed",paused:"Paused",recording:"Recording",preparing:"Preparing",ready:"Ready",cancelled:"Cancelled",failed:"Failed",deleted:"Deleted"})[N]||N,A=N=>({processing:"#fbbf24",completed:"#34d399",paused:"#f59e0b",recording:"#60a5fa",preparing:"#a855f7",ready:"#10b981",cancelled:"#9ca3af",failed:"#ef4444",deleted:"#6b7280"})[N]||"#6b7280",L=N=>{r(`/visit/${N}`)};return f.jsxs("div",{style:ne.container,children:[f.jsxs("div",{style:ne.header,children:[f.jsx("h1",{style:ne.title,children:"Patients"}),f.jsxs("button",{onClick:()=>a(!0),style:ne.addButton,children:[f.jsx(uu,{}),f.jsx("span",{children:"Add Patient"})]})]}),S?f.jsx("div",{style:ne.loading,children:"Loading patients..."}):b.length===0?f.jsxs("div",{style:ne.emptyState,children:[f.jsx("p",{children:"No patients found. Add your first patient to get started."}),f.jsx("button",{onClick:()=>a(!0),style:ne.primaryButton,children:"Add Patient"})]}):f.jsx("div",{style:ne.tableContainer,children:f.jsxs("table",{style:ne.table,children:[f.jsx("thead",{children:f.jsxs("tr",{children:[f.jsx("th",{style:ne.th,children:"Name"}),f.jsx("th",{style:ne.th,children:"MRN"}),f.jsx("th",{style:ne.th,children:"Phone"}),f.jsx("th",{style:ne.th,children:"Email"}),f.jsx("th",{style:ne.th,children:"Last Visit"}),f.jsx("th",{style:ne.th,children:"Actions"})]})}),f.jsx("tbody",{children:b.map(N=>f.jsxs("tr",{style:ne.tr,children:[f.jsx("td",{style:ne.td,children:N.name}),f.jsx("td",{style:ne.td,children:N.medical_record_number||"-"}),f.jsx("td",{style:ne.td,children:N.phone||"-"}),f.jsx("td",{style:ne.td,children:N.email||"-"}),f.jsx("td",{style:ne.td,children:C(x[N.id])}),f.jsx("td",{style:ne.td,children:f.jsxs("div",{style:ne.actions,children:[f.jsx("button",{onClick:()=>{o(N),c(!0)},style:ne.iconButton,title:"Edit patient",children:f.jsx(pF,{})}),f.jsx("button",{onClick:()=>T(N),style:ne.iconButton,title:"View patient visits",children:"Visits"}),f.jsx("button",{onClick:()=>{o(N),d(!0)},style:ne.iconButton,title:"Delete patient",children:f.jsx(Py,{})})]})})]},N.id))})]})}),f.jsx(NS,{isOpen:s,onOpenChange:a,mode:"add"}),f.jsx(NS,{isOpen:l,onOpenChange:c,patient:i,mode:"edit"}),f.jsx(ml,{open:u,onOpenChange:d,children:f.jsxs(gl,{children:[f.jsx(yl,{style:ne.overlay}),f.jsxs(vl,{style:ne.dialogContent,children:[f.jsx(xl,{style:ne.dialogTitle,children:"Delete Patient"}),f.jsxs(LT,{style:ne.dialogDescription,children:["Are you sure you want to delete ",i==null?void 0:i.name,"? This action cannot be undone."]}),f.jsxs("div",{style:ne.formActions,children:[f.jsx("button",{onClick:()=>d(!1),style:ne.secondaryButton,children:"Cancel"}),f.jsx("button",{onClick:R,style:{...ne.primaryButton,backgroundColor:"#ef4444"},children:"Delete"})]}),f.jsx(Qf,{asChild:!0,children:f.jsx("button",{style:ne.closeButton,children:f.jsx(Bs,{})})})]})]})}),f.jsx(ml,{open:h,onOpenChange:p,children:f.jsxs(gl,{children:[f.jsx(yl,{style:ne.overlay}),f.jsxs(vl,{style:{...ne.dialogContent,maxWidth:"800px"},children:[f.jsxs(xl,{style:ne.dialogTitle,children:["Visits for ",i==null?void 0:i.name]}),g.length===0?f.jsx("p",{style:ne.emptyNotes,children:"No visits found for this patient."}):f.jsx("div",{style:ne.notesContainer,children:g.map(N=>f.jsxs("div",{style:ne.visitCard,onClick:()=>L(N.id),children:[f.jsxs("div",{style:ne.noteHeader,children:[f.jsx("h3",{style:ne.noteTitle,children:N.name||new Date(N.created_at).toLocaleDateString()}),f.jsx("span",{style:ne.noteDate,children:new Date(N.created_at).toLocaleString()})]}),f.jsxs("div",{style:ne.visitContent,children:[f.jsx("div",{style:ne.visitInfo,children:N.name||"No name available"}),f.jsx("div",{style:{...ne.visitStateBadge,backgroundColor:A(N.state)},children:_(N.state)})]})]},N.id))}),f.jsx(Qf,{asChild:!0,children:f.jsx("button",{style:ne.closeButton,children:f.jsx(Bs,{})})})]})]})})]})}const ne={container:{padding:"24px",height:"100%",width:"100%",overflow:"auto",backgroundColor:"#f9fafb",display:"flex",flexDirection:"column",flex:1},header:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"24px",width:"100%"},title:{fontSize:"24px",fontWeight:"bold",color:"#111827",margin:0},addButton:{display:"flex",alignItems:"center",gap:"8px",padding:"8px 16px",backgroundColor:"#3b82f6",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"14px",fontWeight:500},loading:{padding:"40px",textAlign:"center",color:"#6b7280"},emptyState:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"60px 20px",textAlign:"center",color:"#6b7280",gap:"16px"},tableContainer:{backgroundColor:"white",borderRadius:"8px",boxShadow:"0 1px 3px 0 rgba(0, 0, 0, 0.1)",overflow:"hidden",flex:1,width:"100%"},table:{width:"100%",borderCollapse:"collapse"},th:{textAlign:"left",padding:"12px 16px",backgroundColor:"#f9fafb",fontSize:"12px",fontWeight:600,color:"#4b5563",borderBottom:"1px solid #e5e7eb"},tr:{borderBottom:"1px solid #e5e7eb",":last-child":{borderBottom:"none"}},td:{padding:"12px 16px",fontSize:"14px",color:"#1f2937"},actions:{display:"flex",gap:"8px"},iconButton:{padding:"4px 8px",backgroundColor:"transparent",border:"none",borderRadius:"4px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",color:"#4b5563",":hover":{backgroundColor:"#f3f4f6",color:"#1f2937"}},overlay:{backgroundColor:"rgba(0, 0, 0, 0.4)",position:"fixed",inset:0,animation:"overlayShow 150ms cubic-bezier(0.16, 1, 0.3, 1)"},dialogContent:{backgroundColor:"white",borderRadius:"6px",boxShadow:"0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)",position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"90vw",maxWidth:"500px",maxHeight:"85vh",padding:"24px",animation:"contentShow 150ms cubic-bezier(0.16, 1, 0.3, 1)",overflow:"auto"},dialogTitle:{margin:0,fontWeight:600,color:"#111827",fontSize:"18px"},dialogDescription:{marginTop:"8px",marginBottom:"20px",color:"#6b7280",fontSize:"14px"},closeButton:{position:"absolute",top:"16px",right:"16px",backgroundColor:"transparent",border:"none",borderRadius:"4px",cursor:"pointer",color:"#6b7280",display:"flex",padding:"4px"},form:{display:"flex",flexDirection:"column",gap:"16px"},formGroup:{display:"flex",flexDirection:"column",gap:"4px"},label:{fontSize:"14px",fontWeight:500,color:"#374151"},input:{padding:"8px 12px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"14px",color:"#1f2937"},formActions:{display:"flex",justifyContent:"flex-end",gap:"12px",marginTop:"12px"},primaryButton:{padding:"8px 16px",backgroundColor:"#3b82f6",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"14px",fontWeight:500},secondaryButton:{padding:"8px 16px",backgroundColor:"white",color:"#374151",border:"1px solid #d1d5db",borderRadius:"6px",cursor:"pointer",fontSize:"14px",fontWeight:500},notesContainer:{display:"flex",flexDirection:"column",gap:"12px",maxHeight:"500px",overflow:"auto"},visitCard:{padding:"16px",backgroundColor:"#f9fafb",borderRadius:"6px",border:"1px solid #e5e7eb",cursor:"pointer",transition:"background-color 0.2s, transform 0.1s",":hover":{backgroundColor:"#f3f4f6",transform:"translateY(-2px)"}},visitContent:{display:"flex",justifyContent:"space-between",alignItems:"center",fontSize:"14px",color:"#1f2937",whiteSpace:"pre-wrap"},visitInfo:{flex:1},visitStateBadge:{padding:"4px 8px",borderRadius:"9999px",fontSize:"12px",fontWeight:500,color:"white",textAlign:"center",minWidth:"80px"},noteHeader:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},noteTitle:{margin:0,fontSize:"16px",fontWeight:600,color:"#111827"},noteDate:{fontSize:"12px",color:"#6b7280"},emptyNotes:{textAlign:"center",color:"#6b7280",padding:"20px"}};var Bx="Popover",[HP,XW]=yi(Bx,[Kl]),ed=Kl(),[J9,Vo]=HP(Bx),WP=t=>{const{__scopePopover:e,children:n,open:r,defaultOpen:i,onOpenChange:o,modal:s=!1}=t,a=ed(e),l=m.useRef(null),[c,u]=m.useState(!1),[d=!1,h]=As({prop:r,defaultProp:i,onChange:o});return f.jsx(W0,{...a,children:f.jsx(J9,{scope:e,contentId:Dr(),triggerRef:l,open:d,onOpenChange:h,onOpenToggle:m.useCallback(()=>h(p=>!p),[h]),hasCustomAnchor:c,onCustomAnchorAdd:m.useCallback(()=>u(!0),[]),onCustomAnchorRemove:m.useCallback(()=>u(!1),[]),modal:s,children:n})})};WP.displayName=Bx;var KP="PopoverAnchor",Y9=m.forwardRef((t,e)=>{const{__scopePopover:n,...r}=t,i=Vo(KP,n),o=ed(n),{onCustomAnchorAdd:s,onCustomAnchorRemove:a}=i;return m.useEffect(()=>(s(),()=>a()),[s,a]),f.jsx(rp,{...o,...r,ref:e})});Y9.displayName=KP;var qP="PopoverTrigger",GP=m.forwardRef((t,e)=>{const{__scopePopover:n,...r}=t,i=Vo(qP,n),o=ed(n),s=Se(e,i.triggerRef),a=f.jsx(se.button,{type:"button","aria-haspopup":"dialog","aria-expanded":i.open,"aria-controls":i.contentId,"data-state":ZP(i.open),...r,ref:s,onClick:K(t.onClick,i.onOpenToggle)});return i.hasCustomAnchor?a:f.jsx(rp,{asChild:!0,...o,children:a})});GP.displayName=qP;var zx="PopoverPortal",[Q9,X9]=HP(zx,{forceMount:void 0}),JP=t=>{const{__scopePopover:e,forceMount:n,children:r,container:i}=t,o=Vo(zx,e);return f.jsx(Q9,{scope:e,forceMount:n,children:f.jsx(yr,{present:n||o.open,children:f.jsx(Ul,{asChild:!0,container:i,children:r})})})};JP.displayName=zx;var Il="PopoverContent",YP=m.forwardRef((t,e)=>{const n=X9(Il,t.__scopePopover),{forceMount:r=n.forceMount,...i}=t,o=Vo(Il,t.__scopePopover);return f.jsx(yr,{present:r||o.open,children:o.modal?f.jsx(Z9,{...i,ref:e}):f.jsx(eW,{...i,ref:e})})});YP.displayName=Il;var Z9=m.forwardRef((t,e)=>{const n=Vo(Il,t.__scopePopover),r=m.useRef(null),i=Se(e,r),o=m.useRef(!1);return m.useEffect(()=>{const s=r.current;if(s)return Xh(s)},[]),f.jsx(Qh,{as:_o,allowPinchZoom:!0,children:f.jsx(QP,{...t,ref:i,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:K(t.onCloseAutoFocus,s=>{var a;s.preventDefault(),o.current||(a=n.triggerRef.current)==null||a.focus()}),onPointerDownOutside:K(t.onPointerDownOutside,s=>{const a=s.detail.originalEvent,l=a.button===0&&a.ctrlKey===!0,c=a.button===2||l;o.current=c},{checkForDefaultPrevented:!1}),onFocusOutside:K(t.onFocusOutside,s=>s.preventDefault(),{checkForDefaultPrevented:!1})})})}),eW=m.forwardRef((t,e)=>{const n=Vo(Il,t.__scopePopover),r=m.useRef(!1),i=m.useRef(!1);return f.jsx(QP,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:o=>{var s,a;(s=t.onCloseAutoFocus)==null||s.call(t,o),o.defaultPrevented||(r.current||(a=n.triggerRef.current)==null||a.focus(),o.preventDefault()),r.current=!1,i.current=!1},onInteractOutside:o=>{var l,c;(l=t.onInteractOutside)==null||l.call(t,o),o.defaultPrevented||(r.current=!0,o.detail.originalEvent.type==="pointerdown"&&(i.current=!0));const s=o.target;((c=n.triggerRef.current)==null?void 0:c.contains(s))&&o.preventDefault(),o.detail.originalEvent.type==="focusin"&&i.current&&o.preventDefault()}})}),QP=m.forwardRef((t,e)=>{const{__scopePopover:n,trapFocus:r,onOpenAutoFocus:i,onCloseAutoFocus:o,disableOutsidePointerEvents:s,onEscapeKeyDown:a,onPointerDownOutside:l,onFocusOutside:c,onInteractOutside:u,...d}=t,h=Vo(Il,n),p=ed(n);return Jh(),f.jsx(Uu,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:i,onUnmountAutoFocus:o,children:f.jsx(Vl,{asChild:!0,disableOutsidePointerEvents:s,onInteractOutside:u,onEscapeKeyDown:a,onPointerDownOutside:l,onFocusOutside:c,onDismiss:()=>h.onOpenChange(!1),children:f.jsx(K0,{"data-state":ZP(h.open),role:"dialog",id:h.contentId,...p,...d,ref:e,style:{...d.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),XP="PopoverClose",tW=m.forwardRef((t,e)=>{const{__scopePopover:n,...r}=t,i=Vo(XP,n);return f.jsx(se.button,{type:"button",...r,ref:e,onClick:K(t.onClick,()=>i.onOpenChange(!1))})});tW.displayName=XP;var nW="PopoverArrow",rW=m.forwardRef((t,e)=>{const{__scopePopover:n,...r}=t,i=ed(n);return f.jsx(q0,{...i,...r,ref:e})});rW.displayName=nW;function ZP(t){return t?"open":"closed"}var eM=WP,tM=GP,nM=JP,rM=YP;async function iW(t,e){const{data:n,error:r}=await t.from("visits").insert([{id:e.id,state:"recording",user_id:e.userId,name:e.name,patient_id:e.patientId,audio_language:e.audioLanguage,patient_instructions_language:e.patientInstructionsLanguage,started_at:new Date().toISOString(),ended_at:null,updated_at:new Date().toISOString()}]).select().single();if(r)throw r;return n}async function oW(t,e,n,r){const i={state:n,updated_at:new Date().toISOString()};r&&(i.ended_at=new Date().toISOString());const{error:o}=await t.from("visits").update(i).eq("id",e);if(o)throw o}async function sW(t,e,n){console.log("Updating visit name:",e,n);const{error:r}=await t.from("visits").update({name:n,updated_at:new Date().toISOString()}).eq("id",e);if(r)throw r}function Vx(){const t=Qe(),e=Hr(),n=Mr({mutationFn:a=>iW(t,a),onSuccess:a=>{e.invalidateQueries({queryKey:["visits"]}),a!=null&&a.id&&e.invalidateQueries({queryKey:["visit",a.id]})}}),r=Mr({mutationFn:({visitId:a,state:l,endVisit:c})=>oW(t,a,l,c),onSuccess:(a,l)=>{e.invalidateQueries({queryKey:["visits"]}),e.invalidateQueries({queryKey:["visit",l.visitId]})}}),i=Mr({mutationFn:({visitId:a,name:l})=>sW(t,a,l),onSuccess:(a,l)=>{e.invalidateQueries({queryKey:["visits"]}),e.invalidateQueries({queryKey:["visit",l.visitId]})}}),o=Mr({mutationFn:async({visitId:a,patientId:l})=>{const{error:c}=await t.from("visits").update({patient_id:l}).eq("id",a);if(c)throw c},onSuccess:(a,l)=>{e.invalidateQueries({queryKey:["visits"]}),e.invalidateQueries({queryKey:["visit",l.visitId]})}}),s=Mr({mutationFn:async({visitId:a,audioLanguage:l,patientInstructionsLanguage:c})=>{const{error:u}=await t.from("visits").update({audio_language:l,patient_instructions_language:c}).eq("id",a);if(u)throw u},onSuccess:(a,l)=>{e.invalidateQueries({queryKey:["visits"]}),e.invalidateQueries({queryKey:["visit",l.visitId]})}});return{createVisit:n.mutate,createVisitAsync:n.mutateAsync,isCreatingVisit:n.isPending,createVisitError:n.error,updateVisitState:r.mutate,updateVisitStateAsync:r.mutateAsync,isUpdatingVisitState:r.isPending,updateVisitStateError:r.error,updateVisitName:i.mutate,updateVisitNameAsync:i.mutateAsync,isUpdatingVisitName:i.isPending,updateVisitNameError:i.error,updateVisitPatient:o.mutate,updateVisitPatientAsync:o.mutateAsync,isUpdatingVisitPatient:o.isPending,updateVisitPatientError:o.error,updateVisitLanguages:s.mutate,updateVisitLanguagesAsync:s.mutateAsync,isUpdatingVisitLanguages:s.isPending,updateVisitLanguagesError:s.error}}const Me={container:{position:"relative",width:"100%",maxWidth:"400px"},inputContainer:{display:"flex",alignItems:"center",gap:"8px",width:"100%",position:"relative"},searchIcon:{position:"absolute",left:"12px",color:"#6b7280",width:"16px",height:"16px"},selectedContainer:{display:"flex",alignItems:"center",gap:"8px",width:"100%",padding:"8px 12px",fontSize:"16px",border:"1px solid #e5e7eb",borderRadius:"6px",backgroundColor:"#f9fafb"},selectedName:{flex:1,fontWeight:"500",color:"#1f2937"},unlinkButton:{display:"flex",alignItems:"center",padding:"4px",border:"none",borderRadius:"4px",backgroundColor:"transparent",color:"#6b7280",cursor:"pointer","&:hover":{backgroundColor:"#f3f4f6",color:"#dc2626"}},input:{width:"100%",padding:"8px 12px 8px 36px",fontSize:"16px",border:"1px solid #e5e7eb",borderRadius:"6px",outline:"none","&:focus":{borderColor:"#3b82f6",boxShadow:"0 0 0 2px rgba(59, 130, 246, 0.1)"}},popoverContent:{backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"6px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)",marginTop:"4px",width:"300px",minHeight:"100px",maxHeight:"300px",overflow:"auto",zIndex:50,padding:"8px 0"},section:{padding:"0"},sectionTitle:{padding:"4px 16px",fontSize:"12px",fontWeight:"500",color:"#6b7280",textTransform:"uppercase"},item:{padding:"8px 16px",cursor:"pointer",outline:"none",width:"100%",border:"none",backgroundColor:"transparent",textAlign:"left","&:hover":{backgroundColor:"#f3f4f6"},"&:focus":{backgroundColor:"#f3f4f6"}},createButton:{display:"flex",alignItems:"center",gap:"8px",width:"100%",padding:"8px 16px",backgroundColor:"#f9fafb",border:"none",borderRadius:"0",cursor:"pointer",fontSize:"14px",color:"#1f2937","&:hover":{backgroundColor:"#f3f4f6"}},patientName:{fontSize:"14px",fontWeight:"500",color:"#1f2937"},patientMrn:{fontSize:"12px",color:"#6b7280"},separator:{height:"1px",backgroundColor:"#e5e7eb",margin:"4px 0"},loadingItem:{padding:"8px 16px",height:"38px",backgroundColor:"#f9fafb",borderRadius:"4px",margin:"4px 0",animation:"pulse 1.5s ease-in-out infinite"},placeholderContainer:{padding:"4px 0"}};function aW({onPatientSelect:t,onVisitNameChange:e,visitId:n,selectedPatientId:r}){const[i,o]=m.useState(""),[s,a]=m.useState(!1),l=XO(i,300),{user:c}=Nt(),u=Qe(),d=m.useRef(null),h=Hr(),[p,g]=m.useState(!1),{updateVisitName:y}=Vx(),[x,v]=m.useState(!1),w=m.useRef(n),b=m.useRef(r),{data:S=[],isLoading:C}=iu({queryKey:["patients",c==null?void 0:c.id,l],queryFn:async()=>{if(!(c!=null&&c.id))return[];const{data:P,error:D}=await u.rpc("search_patients",{search_term:l||"",user_id_param:c.id});if(D)throw D;return P||[]},enabled:!!(c!=null&&c.id)}),{data:k}=iu({queryKey:["patient",r],queryFn:async()=>{if(!r)return null;const{data:P,error:D}=await u.from("patient_profiles").select("id, name, medical_record_number").eq("id",r).single();if(D)throw D;return P},enabled:!!r}),E=Mr({mutationFn:async P=>{if(!(c!=null&&c.id))throw new Error("No user");const{data:D,error:H}=await u.from("patient_profiles").insert([{name:P.trim(),user_id:c.id}]).select().single();if(H)throw H;return D},onSuccess:P=>{h.invalidateQueries({queryKey:["patients"]}),_(P)}}),T=l?S:S.slice(0,3),R=m.useRef(!1),_=P=>{R.current=!0,o(P.name),a(!1),v(!0),t(P),setTimeout(()=>{v(!1),R.current=!1},500)},A=async()=>{!i.trim()||!(c!=null&&c.id)||E.mutate(i)},L=P=>{const D=P.target.value;o(D)},N=()=>{if(!(x||R.current)&&i.trim()){const P=i.trim();t(null),e==null||e(P),o(P),g(!0),a(!1),n&&y({visitId:n,name:P})}},M=P=>{P.key==="Enter"&&i.trim()&&(P.preventDefault(),N())},z=()=>{o(""),g(!1),t(null),e==null||e(null),n&&y({visitId:n,name:null})};Te.useEffect(()=>{(async()=>{if((n!==w.current||r!==b.current)&&(o(""),g(!1),a(!1)),w.current=n,b.current=r,r){const{data:D}=await u.from("patient_profiles").select("name").eq("id",r).single();D&&o(D.name)}else if(n){const{data:D}=await u.from("visits").select("name").eq("id",n).single();D!=null&&D.name&&(o(D.name),g(!0))}})()},[r,n,u]);const $=k||p||n&&i&&!s,V=(P,D)=>f.jsxs("button",{style:Me.item,onClick:D,children:[f.jsx("div",{style:Me.patientName,children:P.name}),P.medical_record_number&&f.jsxs("div",{style:Me.patientMrn,children:["MRN: ",P.medical_record_number]})]},P.id),I=()=>f.jsxs("div",{style:Me.placeholderContainer,children:[f.jsx("div",{style:{...Me.loadingItem,marginLeft:"16px",marginRight:"16px"}}),f.jsx("div",{style:{...Me.loadingItem,marginLeft:"16px",marginRight:"16px"}}),f.jsx("div",{style:{...Me.loadingItem,marginLeft:"16px",marginRight:"16px"}})]});return $?f.jsx("div",{style:Me.container,children:f.jsxs("div",{style:Me.selectedContainer,onClick:()=>{a(!0),g(!1),setTimeout(()=>{var P;return(P=d.current)==null?void 0:P.focus()},0)},children:[f.jsx("div",{style:Me.selectedName,children:(k==null?void 0:k.name)||i}),f.jsx("button",{style:Me.unlinkButton,onClick:P=>{P.stopPropagation(),z()},title:"Unlink patient",children:f.jsx(Bs,{})})]})}):f.jsx("div",{style:Me.container,children:f.jsxs(eM,{modal:!1,open:s,onOpenChange:P=>{!P&&!R.current&&!x&&N(),a(P)},children:[f.jsx(tM,{asChild:!0,children:f.jsxs("div",{style:Me.inputContainer,children:[f.jsx(r5,{style:Me.searchIcon}),f.jsx("input",{ref:d,type:"text",value:i,onChange:L,onKeyDown:M,onFocus:()=>a(!0),onClick:P=>{P.stopPropagation(),a(!0),P.currentTarget.focus()},placeholder:"Add patient details",style:Me.input})]})}),f.jsx(nM,{children:f.jsx(rM,{style:Me.popoverContent,align:"start",sideOffset:4,onEscapeKeyDown:()=>a(!1),children:C?f.jsxs(f.Fragment,{children:[f.jsxs("div",{style:Me.section,children:[f.jsx("div",{style:Me.sectionTitle,children:"Suggested"}),I()]}),f.jsx("div",{style:Me.separator}),f.jsxs("button",{style:{...Me.createButton,opacity:.5},disabled:!0,children:[f.jsx(uu,{}),"Create new patient"]})]}):f.jsxs(f.Fragment,{children:[f.jsxs("div",{style:Me.section,children:[f.jsx("div",{style:Me.sectionTitle,children:"Suggested"}),f.jsx("div",{style:Me.placeholderContainer,children:T.length>0?T.map(P=>V(P,()=>_(P))):f.jsx("div",{style:Me.item,children:"No matches found"})})]}),f.jsx("div",{style:Me.separator}),f.jsxs("button",{style:Me.createButton,onClick:A,disabled:E.isPending||!i.trim(),children:[f.jsx(uu,{}),E.isPending?"Creating...":i.trim()?`Create new patient "${i}"`:"Create new patient"]})]})})})]})})}const hv=(t,e)=>e.some(n=>t instanceof n);let jS,DS;function lW(){return jS||(jS=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function cW(){return DS||(DS=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const pv=new WeakMap,tg=new WeakMap,Pp=new WeakMap;function uW(t){const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("success",o),t.removeEventListener("error",s)},o=()=>{n(ks(t.result)),i()},s=()=>{r(t.error),i()};t.addEventListener("success",o),t.addEventListener("error",s)});return Pp.set(e,t),e}function dW(t){if(pv.has(t))return;const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("complete",o),t.removeEventListener("error",s),t.removeEventListener("abort",s)},o=()=>{n(),i()},s=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",o),t.addEventListener("error",s),t.addEventListener("abort",s)});pv.set(t,e)}let mv={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return pv.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return ks(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function iM(t){mv=t(mv)}function fW(t){return cW().includes(t)?function(...e){return t.apply(gv(this),e),ks(this.request)}:function(...e){return ks(t.apply(gv(this),e))}}function hW(t){return typeof t=="function"?fW(t):(t instanceof IDBTransaction&&dW(t),hv(t,lW())?new Proxy(t,mv):t)}function ks(t){if(t instanceof IDBRequest)return uW(t);if(tg.has(t))return tg.get(t);const e=hW(t);return e!==t&&(tg.set(t,e),Pp.set(e,t)),e}const gv=t=>Pp.get(t);function pW(t,e,{blocked:n,upgrade:r,blocking:i,terminated:o}={}){const s=indexedDB.open(t,e),a=ks(s);return r&&s.addEventListener("upgradeneeded",l=>{r(ks(s.result),l.oldVersion,l.newVersion,ks(s.transaction),l)}),n&&s.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),a.then(l=>{o&&l.addEventListener("close",()=>o()),i&&l.addEventListener("versionchange",c=>i(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}const mW=["get","getKey","getAll","getAllKeys","count"],gW=["put","add","delete","clear"],ng=new Map;function LS(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(ng.get(e))return ng.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=gW.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||mW.includes(n)))return;const o=async function(s,...a){const l=this.transaction(s,i?"readwrite":"readonly");let c=l.store;return r&&(c=c.index(a.shift())),(await Promise.all([c[n](...a),i&&l.done]))[0]};return ng.set(e,o),o}iM(t=>({...t,get:(e,n,r)=>LS(e,n)||t.get(e,n,r),has:(e,n)=>!!LS(e,n)||t.has(e,n)}));const yW=["continue","continuePrimaryKey","advance"],$S={},yv=new WeakMap,oM=new WeakMap,vW={get(t,e){if(!yW.includes(e))return t[e];let n=$S[e];return n||(n=$S[e]=function(...r){yv.set(this,oM.get(this)[e](...r))}),n}};async function*xW(...t){let e=this;if(e instanceof IDBCursor||(e=await e.openCursor(...t)),!e)return;e=e;const n=new Proxy(e,vW);for(oM.set(n,e),Pp.set(n,gv(e));e;)yield n,e=await(yv.get(n)||e.continue()),yv.delete(n)}function FS(t,e){return e===Symbol.asyncIterator&&hv(t,[IDBIndex,IDBObjectStore,IDBCursor])||e==="iterate"&&hv(t,[IDBIndex,IDBObjectStore])}iM(t=>({...t,get(e,n,r){return FS(e,n)?xW:t.get(e,n,r)},has(e,n){return FS(e,n)||t.has(e,n)}}));class wW{constructor(){this.db=null,this.DB_NAME="audio-recorder-db",this.STORE_NAME="audio-chunks",this.SYNC_STORE="chunk-sync-metadata",this.DB_VERSION=1}async initialize(){this.db||(this.db=await pW(this.DB_NAME,this.DB_VERSION,{upgrade(e){e.objectStoreNames.contains("audio-chunks")||e.createObjectStore("audio-chunks",{keyPath:["visitId","containerIndex","chunkId"]}).createIndex("by-visit","visitId"),e.objectStoreNames.contains("chunk-sync-metadata")||e.createObjectStore("chunk-sync-metadata",{keyPath:"key"}).createIndex("by-visit","visitId")}}))}async getDb(){return this.db||await this.initialize(),this.db}async storeChunk(e){this.db||await this.initialize(),console.log(` Storing chunk ${e.containerIndex}:${e.chunkId} (${(e.blob.size/1024).toFixed(1)}KB)`),await this.db.put(this.STORE_NAME,e)}async getChunk(e,n,r){return this.db||await this.initialize(),this.db.get(this.STORE_NAME,[e,n,r])}async getChunksByVisit(e){return this.db||await this.initialize(),this.db.getAllFromIndex(this.STORE_NAME,"by-visit",e)}async deleteChunksByVisit(e){this.db||await this.initialize();const n=await this.getChunksByVisit(e),r=this.db.transaction(this.STORE_NAME,"readwrite");await Promise.all(n.map(i=>r.store.delete([i.visitId,i.containerIndex,i.chunkId]))),await r.done}async deleteChunk(e,n,r){this.db||await this.initialize();const i=this.db.transaction(this.STORE_NAME,"readwrite");if(r!==void 0)await i.store.delete([e,n,r]);else{const o=await this.getChunksByVisit(e);await Promise.all(o.filter(s=>s.containerIndex===n).map(s=>i.store.delete([s.visitId,s.containerIndex,s.chunkId])))}await i.done}async getDatabaseStats(){try{this.db||await this.initialize();const r=await this.db.transaction(this.STORE_NAME).objectStore(this.STORE_NAME).getAll(),i={};r.forEach(s=>{i[s.visitId]||(i[s.visitId]={chunks:0,size:0,containers:new Set}),i[s.visitId].chunks++,i[s.visitId].size+=s.blob.size,i[s.visitId].containers.add(s.containerIndex)});const o={totalChunks:r.length,totalVisits:Object.keys(i).length,totalSize:r.reduce((s,a)=>s+a.blob.size,0),visitStats:Object.entries(i).reduce((s,[a,l])=>({...s,[a]:{chunks:l.chunks,size:l.size,containers:l.containers.size}}),{})};return console.log("[AudioStorage] Database stats:",o),o}catch(e){throw console.error("[AudioStorage] Failed to get database stats:",e),e}}}const es=new wW,Mp=class gn{constructor(){this.isSyncing=!1,this.syncPromise=null}async getUnuploadedChunks(){return(await es.getDb()).transaction(gn.SYNC_STORE).objectStore(gn.SYNC_STORE).getAll()}async markChunkForUpload(e){await(await es.getDb()).transaction(gn.SYNC_STORE,"readwrite").objectStore(gn.SYNC_STORE).put({...e,uploadAttempts:0,lastAttempt:Date.now()})}async markChunkAsUploaded(e){await(await es.getDb()).transaction(gn.SYNC_STORE,"readwrite").objectStore(gn.SYNC_STORE).delete(e)}async updateUploadAttempt(e){await(await es.getDb()).transaction(gn.SYNC_STORE,"readwrite").objectStore(gn.SYNC_STORE).put({...e,uploadAttempts:e.uploadAttempts+1,lastAttempt:Date.now()})}async uploadChunk(e,n){console.log(` Uploading container ${e.containerIndex} (${(e.blob.size/1024).toFixed(1)}KB)`);try{const r=e.blob.type.includes("mp4")?"mp4":"webm",i={key:`audio-chunks/${e.visitId}/${e.containerIndex}-${e.chunkId}-${e.timestamp}.${r}`,contentType:e.blob.type,visitId:e.visitId,chunkId:e.chunkId,isFinal:e.isFinal,containerIndex:e.containerIndex},o=await fetch(`${Fr.apiUrl}/get-upload-url`,{method:"POST",headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json"},body:JSON.stringify(i)});if(!o.ok)throw new Error(`Failed to get upload URL: ${o.status}`);const{uploadUrl:s,fields:a}=await o.json(),l=new FormData;if(Object.entries(a).forEach(([h,p])=>{l.append(h,p)}),l.append("file",e.blob),!(await fetch(s,{method:"POST",body:l})).ok)throw new Error("Failed to upload to S3");const u=await fetch(`${Fr.apiUrl}/process-audio`,{method:"POST",headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json"},body:JSON.stringify({key:i.key,visitId:e.visitId,chunkId:e.chunkId,isFinal:e.isFinal,contentType:e.blob.type,containerIndex:e.containerIndex})});if(!u.ok)throw new Error(`Failed to process audio: ${u.status}`);if(!(await u.json()).success)throw new Error("Processing failed");return console.log(` Uploaded container ${e.containerIndex}`),!0}catch(r){return console.error(` Failed to upload container ${e.containerIndex}:`,r),!1}}async syncChunks(e){return this.isSyncing?this.syncPromise||Promise.resolve():(this.isSyncing=!0,this.syncPromise=(async()=>{try{const n=await this.getUnuploadedChunks();for(const r of n){if(r.uploadAttempts>=gn.MAX_RETRIES){console.log(` Skipping container ${r.containerIndex} (max retries reached)`);continue}const i=await es.getChunk(r.visitId,r.containerIndex,r.chunkId);if(!i){console.warn(` Container ${r.containerIndex} not found in storage`);continue}await this.uploadChunk(i,e)?await this.markChunkAsUploaded(r.key):(await this.updateUploadAttempt(r),console.log(` Will retry container ${r.containerIndex} later (attempt ${r.uploadAttempts+1}/${gn.MAX_RETRIES})`)),await new Promise(s=>setTimeout(s,gn.RETRY_DELAY))}}finally{this.isSyncing=!1,this.syncPromise=null}})(),this.syncPromise)}async markForUpload(e){const n=e.blob.type.includes("mp4")?"mp4":"webm",r={key:`audio-chunks/${e.visitId}/${e.containerIndex}-${e.chunkId}-${e.timestamp}.${n}`,visitId:e.visitId,chunkId:e.chunkId,containerIndex:e.containerIndex,isFinal:e.isFinal,contentType:e.blob.type};await this.markChunkForUpload(r)}async getSyncStats(){const n=(await this.getUnuploadedChunks()).reduce((r,i)=>{if(r.visitStats[i.visitId]||(r.visitStats[i.visitId]={pending:0,failed:0,lastAttempt:null}),i.uploadAttempts>=gn.MAX_RETRIES?(r.failedUploads++,r.visitStats[i.visitId].failed++):(r.pendingUploads++,r.visitStats[i.visitId].pending++),i.lastAttempt){const o=new Date(i.lastAttempt).toISOString();(!r.visitStats[i.visitId].lastAttempt||o>r.visitStats[i.visitId].lastAttempt)&&(r.visitStats[i.visitId].lastAttempt=o)}return r},{pendingUploads:0,failedUploads:0,visitStats:{}});return console.log("[ChunkSyncManager] Sync stats:",n),n}};Mp.SYNC_STORE="chunk-sync-metadata";Mp.MAX_RETRIES=3;Mp.RETRY_DELAY=5e3;let bW=Mp;function sM(){const t=["audio/webm;codecs=opus","audio/webm","audio/mp4;codecs=mp4a","audio/mp4","audio/mpeg"];for(const e of t)if(MediaRecorder.isTypeSupported(e))return console.log(`[MediaRecorder] Using MIME type: ${e}`),e;throw new Error("No supported MIME type found for MediaRecorder")}class SW{constructor(e){this.mediaRecorder=null,this.stream=null,this.isRecording=!1,this.isPaused=!1,this.currentChunkId=0,this.currentContainerIndex=0,this.chunkBatch=[],this.containerChunks=[],this.CHUNK_DURATION=2e3,this.BATCH_SIZE=5,this.CONTAINER_DURATION=2e4,this.containerStartTime=null,this.containerTimer=null,this.visitId=null,this.config={saveLocally:!0,...e},this.syncManager=new bW,this.visitId=e.visitId||null}async saveChunkLocally(e,n,r,i=!1){if(!this.config.saveLocally)return;const o=URL.createObjectURL(e),s=document.createElement("a");s.href=o;const a=i?"container":"chunk",l=e.type.includes("mp4")?"mp4":"webm";s.download=`${a}_${this.config.visitId||"debug"}_${this.currentContainerIndex}_${n}${r?"_final":""}.${l}`,s.click(),URL.revokeObjectURL(o),console.log(`[RecorderV3] Saved ${a} locally: ${s.download}, size: ${e.size} bytes`)}async initialize(e){try{this.stream&&this.cleanup();const n={sampleRate:16e3,channelCount:1,autoGainControl:!0,deviceId:e||void 0};this.stream=await navigator.mediaDevices.getUserMedia({audio:n}),console.log("[RecorderV3] Initialized with device:",e||"default")}catch(n){throw console.error("[RecorderV3] Initialization failed:",n),this.cleanup(),n}}async flushChunks(e=!1){if(this.chunkBatch.length===0)return;const n=new Blob(this.chunkBatch,{type:"audio/webm;codecs=opus"}),r=Date.now();console.log("[RecorderV3] Flushing chunks:",{batchSize:this.chunkBatch.length,totalSize:n.size,containerIndex:this.currentContainerIndex,isFinal:e});try{this.containerChunks.push(n);const i={blob:n,timestamp:r,chunkId:this.currentChunkId,visitId:this.visitId,isFinal:e,containerIndex:this.currentContainerIndex};await es.storeChunk(i),console.log(`[RecorderV3] Stored chunk in IndexedDB: ${this.currentChunkId}`),this.currentChunkId++,this.chunkBatch=[]}catch(i){throw console.error("[RecorderV3] Error in flushChunks:",i),i}}async flushContainer(e=!1){if(this.containerChunks.length===0)return;this.chunkBatch.length>0&&await this.flushChunks(!1);const n=new Blob(this.containerChunks,{type:"audio/webm;codecs=opus"}),r=Date.now(),i=`audio-chunks/${this.visitId}/${this.currentContainerIndex}-${r}.webm`;console.log(`[RecorderV3] Flushing container ${this.currentContainerIndex}:`,{chunks:this.containerChunks.length,totalSize:n.size,timestamp:r,isFinal:e});try{await this.config.onChunkReady({blob:n,chunkId:this.currentContainerIndex,isFinal:e,key:i,isCompleteContainer:!0,visitId:this.visitId}),console.log(`[RecorderV3] Container ${this.currentContainerIndex} uploaded successfully`)}catch(o){console.error("[RecorderV3] Failed to upload container, storing in IndexedDB for retry:",o);const s={blob:n,timestamp:r,chunkId:this.currentContainerIndex,visitId:this.visitId,isFinal:e,containerIndex:this.currentContainerIndex};await es.storeChunk(s),await this.syncManager.markForUpload(s)}this.containerChunks=[]}async switchContainer(){var e;if(((e=this.mediaRecorder)==null?void 0:e.state)==="recording"){console.log("[RecorderV3] Switching container:",{currentIndex:this.currentContainerIndex,batchSize:this.chunkBatch.length,containerSize:this.containerChunks.length});try{const n=this.mediaRecorder;await new Promise(r=>{const i=()=>{n.removeEventListener("dataavailable",i),r()};n.addEventListener("dataavailable",i),n.stop()}),this.mediaRecorder=null,this.chunkBatch.length>0&&await this.flushChunks(!1),await this.flushContainer(!1),this.currentContainerIndex++,this.containerStartTime=Date.now(),this.mediaRecorder=this.createRecorder(),this.mediaRecorder.start(this.CHUNK_DURATION),console.log("[RecorderV3] Switched to new container:",{newIndex:this.currentContainerIndex,timestamp:this.containerStartTime})}catch(n){console.error("[RecorderV3] Failed to switch container:",n)}}}createRecorder(){if(!this.stream)throw new Error("No audio stream available");const e=sM(),n=new MediaRecorder(this.stream,{mimeType:e,audioBitsPerSecond:48e3});return n.addEventListener("dataavailable",async r=>{var i;if(!(!(r instanceof BlobEvent)||!((i=r.data)!=null&&i.size))&&(console.log("[RecorderV3] Data available:",{size:r.data.size,batchSize:this.chunkBatch.length,containerIndex:this.currentContainerIndex,isActiveRecorder:this.mediaRecorder===n}),this.chunkBatch.push(r.data),this.chunkBatch.length>=this.BATCH_SIZE))try{await this.flushChunks(!1)}catch(o){console.error("[RecorderV3] Error flushing chunks:",o)}}),n}async startRecording(e){if(!this.isRecording)try{if(this.visitId=e||this.visitId,!this.visitId)throw new Error("No visit ID provided for recording");this.stream||await this.initialize(),this.isRecording=!0,this.currentChunkId=0,this.currentContainerIndex=0,this.chunkBatch=[],this.containerChunks=[],this.containerStartTime=Date.now(),this.mediaRecorder=this.createRecorder(),this.mediaRecorder.start(this.CHUNK_DURATION),this.containerTimer=setInterval(()=>{Date.now()-this.containerStartTime>=this.CONTAINER_DURATION&&this.switchContainer()},1e3),console.log("[RecorderV3] Started recording with visit ID:",this.visitId)}catch(n){throw console.error("[RecorderV3] Failed to start recording:",n),this.cleanup(),n}}async stopRecording(){if(this.isRecording){console.log("[RecorderV3] Stopping recording:",{currentIndex:this.currentContainerIndex,batchSize:this.chunkBatch.length,containerSize:this.containerChunks.length});try{this.containerTimer&&(clearInterval(this.containerTimer),this.containerTimer=null);const e=this.mediaRecorder;this.mediaRecorder=null,this.isRecording=!1;let n=!1;((e==null?void 0:e.state)==="recording"||(e==null?void 0:e.state)==="paused")&&await new Promise((r,i)=>{const o=async s=>{var a;try{e.removeEventListener("dataavailable",o),(a=s.data)!=null&&a.size&&!n&&(console.log("[RecorderV3] Adding final chunk:",{size:s.data.size,existingBatchSize:this.chunkBatch.length}),this.chunkBatch.push(s.data),n=!0),this.chunkBatch.length>0&&await this.flushChunks(!0),await this.flushContainer(!0),r()}catch(l){i(l)}};e.addEventListener("dataavailable",o),e.stop()}),console.log("[RecorderV3] Recording stopped and final data flushed:",{finalContainerIndex:this.currentContainerIndex,finalBatchSize:this.chunkBatch.length,finalContainerSize:this.containerChunks.length}),this.isRecording=!1,this.stream&&(this.stream.getTracks().forEach(r=>r.stop()),this.stream=null),this.chunkBatch=[],this.containerChunks=[]}catch(e){throw console.error("[RecorderV3] Error stopping recording:",e),e}}}async pauseRecording(){if(!(!this.isRecording||this.isPaused))try{this.containerTimer&&(clearInterval(this.containerTimer),this.containerTimer=null);const e=this.mediaRecorder;(e==null?void 0:e.state)==="recording"&&await new Promise(n=>{const r=async()=>{try{e.removeEventListener("dataavailable",r),this.chunkBatch.length>0&&await this.flushChunks(!1),n()}catch(i){console.error("[RecorderV3] Error flushing chunks during pause:",i),n()}};e.addEventListener("dataavailable",r),e.pause()}),this.isPaused=!0,console.log("[RecorderV3] Recording paused")}catch(e){throw console.error("[RecorderV3] Failed to pause recording:",e),e}}async resumeRecording(){var e;if(!(!this.isRecording||!this.isPaused))try{this.stream||await this.initialize(),((e=this.mediaRecorder)==null?void 0:e.state)==="paused"&&this.mediaRecorder.resume(),this.containerStartTime=Date.now(),this.containerTimer=setInterval(()=>{Date.now()-this.containerStartTime>=this.CONTAINER_DURATION&&this.switchContainer()},1e3),this.isPaused=!1,console.log("[RecorderV3] Recording resumed")}catch(n){throw console.error("[RecorderV3] Failed to resume recording:",n),this.isPaused=!0,this.mediaRecorder&&this.mediaRecorder.pause(),n}}cleanup(){var e;this.containerTimer&&(clearInterval(this.containerTimer),this.containerTimer=null),((e=this.mediaRecorder)==null?void 0:e.state)==="recording"&&this.mediaRecorder.stop(),this.mediaRecorder=null,this.stream&&(this.stream.getTracks().forEach(n=>n.stop()),this.stream=null),this.isRecording=!1,this.isPaused=!1,this.chunkBatch=[],this.containerChunks=[],console.log("[RecorderV3] Cleanup complete")}getState(){return{isRecording:this.isRecording,isPaused:this.isPaused,currentChunkId:this.currentChunkId,currentContainerIndex:this.currentContainerIndex,batchSize:this.chunkBatch.length,containerSize:this.containerChunks.length}}}const CW=t=>{const e=Math.floor(t/60),n=t%60;return`${e}:${n.toString().padStart(2,"0")}`};function kW(t={}){const[e,n]=m.useState(!1),[r,i]=m.useState(!1),[o,s]=m.useState(0),[a,l]=m.useState(t.initialVisitId||null),c=m.useRef(null),u=m.useRef(null),d=m.useRef(null),{user:h}=Nt(),{getValidSessionToken:p}=Cp(),g=Qe(),y=gr();m.useEffect(()=>h!=null&&h.id?((async()=>{try{if(!await p())throw new Error("No session token available");c.current=new SW({saveLocally:!0,async onChunkReady({blob:k,chunkId:E,isFinal:T,key:R,visitId:_}){const A=await p(),L={key:R,contentType:k.type,visitId:_,chunkId:E,isFinal:T,userId:h==null?void 0:h.id};if(console.log("[Debug] Request payload:",L),!L.key||!L.contentType||!L.visitId)throw new Error("Missing required fields in payload");const N=await fetch(`${Fr.apiUrl}/get-upload-url`,{method:"POST",headers:{Authorization:`Bearer ${A}`,"Content-Type":"application/json"},body:JSON.stringify(L)});if(!N.ok){const D=await N.text();throw console.error("[Debug] Upload URL error response:",{status:N.status,statusText:N.statusText,body:D}),new Error(`Failed to get upload URL: ${N.status} ${N.statusText} - ${D}`)}const{uploadUrl:M,fields:z}=await N.json(),$=new FormData;Object.entries(z).forEach(([D,H])=>{$.append(D,H)}),$.append("file",k),console.log("[Debug] Uploading to S3:",{uploadUrl:M,fields:z,formDataKeys:Array.from($.keys())});const V=await fetch(M,{method:"POST",body:$});if(!V.ok){const D=await V.text();throw console.error("[Debug] S3 upload error:",{status:V.status,statusText:V.statusText,response:D}),new Error(`Failed to upload to S3: ${V.status} ${V.statusText} - ${D}`)}console.log("[Debug] S3 upload successful");const I={key:R,visitId:_,chunkId:Number(E),isFinal:!!T,contentType:k.type},P=await fetch(`${Fr.apiUrl}/process-audio`,{method:"POST",headers:{Authorization:`Bearer ${A}`,"Content-Type":"application/json"},body:JSON.stringify(I)});if(!P.ok){const D=await P.text();throw new Error(`Failed to process audio: ${P.status} ${P.statusText} - ${D}`)}}}),await c.current.initialize()}catch(C){console.error("Failed to initialize recorder:",C)}})(),()=>{var C;return(C=c.current)==null?void 0:C.cleanup()}):void 0,[h==null?void 0:h.id]),m.useEffect(()=>(e&&!r&&u.current&&(d.current=setInterval(()=>{const S=Date.now()-u.current;s(Math.floor(S/1e3))},1e3)),()=>{d.current&&(clearInterval(d.current),d.current=null)}),[e,r]),m.useEffect(()=>{t.initialVisitId&&t.initialState==="recording"?(n(!0),i(!1)):t.initialVisitId&&t.initialState==="paused"&&(n(!0),i(!0))},[t.initialVisitId,t.initialState]);const x=m.useCallback(async(S,C)=>{var k;try{if(!c.current)throw new Error("Recorder not initialized");if(!(h!=null&&h.id))throw new Error("Must be logged in to record");if(!C)throw new Error("Visit ID is required");const E=C;l(E),S&&await c.current.initialize(S),u.current=Date.now(),await c.current.startRecording(E),n(!0),i(!1),(k=t.onRecordingStateChange)==null||k.call(t,!0,!1)}catch(E){console.error("Failed to start recording:",E)}},[h==null?void 0:h.id,g,a,y]),v=m.useCallback(async()=>{var S;try{c.current&&(await c.current.stopRecording(),a&&await g.from("visits").update({state:"processing"}).eq("id",a),n(!1),i(!1),s(0),(S=t.onRecordingStateChange)==null||S.call(t,!1,!1))}catch(C){console.error("Failed to stop recording:",C)}},[a,g]),w=m.useCallback(async()=>{var S;try{c.current&&(await c.current.pauseRecording(),i(!0),(S=t.onRecordingStateChange)==null||S.call(t,!0,!0))}catch(C){console.error("Failed to pause recording:",C)}},[]),b=m.useCallback(async()=>{var S;try{c.current&&(await c.current.resumeRecording(),i(!1),(S=t.onRecordingStateChange)==null||S.call(t,!0,!1))}catch(C){console.error("Failed to resume recording:",C)}},[]);return{isRecording:e,isPaused:r,startRecording:x,stopRecording:v,pauseRecording:w,resumeRecording:b,formattedTime:CW(o),currentVisitId:a}}class EW{constructor(e={}){this.stream=null,this.monitorRecorder=null,this.audioContext=null,this.analyser=null,this.mediaStreamSource=null,this.reconnectInterval=null,this.isReconnecting=!1,this.onStreamAvailable=e.onStreamAvailable}startStreamMonitoring(){this.reconnectInterval&&clearInterval(this.reconnectInterval),this.reconnectInterval=window.setInterval(async()=>{if(!this.stream)return;if(!this.stream.getAudioTracks().some(r=>r.readyState==="live")&&!this.isReconnecting){console.log("[AudioMonitor] Stream inactive, attempting to reconnect..."),this.isReconnecting=!0;try{await this.initialize(this.lastDeviceId),console.log("[AudioMonitor] Successfully reconnected stream")}catch(r){console.error("[AudioMonitor] Failed to reconnect stream:",r)}finally{this.isReconnecting=!1}}},5e3)}async initialize(e){try{this.lastDeviceId=e,this.cleanup(),this.stream=await navigator.mediaDevices.getUserMedia({audio:{deviceId:e?{exact:e}:void 0,channelCount:1,sampleRate:48e3}}),this.audioContext=new AudioContext,this.analyser=this.audioContext.createAnalyser(),this.analyser.minDecibels=-85,this.analyser.maxDecibels=-10,this.analyser.smoothingTimeConstant=.85,this.analyser.fftSize=1024,this.mediaStreamSource=this.audioContext.createMediaStreamSource(this.stream),this.mediaStreamSource.connect(this.analyser);const n=sM();this.monitorRecorder=new MediaRecorder(this.stream,{mimeType:n,audioBitsPerSecond:48e3}),this.monitorRecorder.start(100),this.startStreamMonitoring(),this.onStreamAvailable&&this.onStreamAvailable(this.stream)}catch(n){throw console.error("[AudioMonitor] Failed to initialize:",n),this.cleanup(),n}}getStream(){return this.stream}getAnalyser(){return this.analyser}getAudioContext(){return this.audioContext}isMonitoring(){return this.monitorRecorder!==null&&this.monitorRecorder.state==="recording"}async resumeContext(){var e;((e=this.audioContext)==null?void 0:e.state)==="suspended"&&await this.audioContext.resume()}cleanup(){if(console.log("[AudioMonitor] Cleaning up..."),this.reconnectInterval&&(clearInterval(this.reconnectInterval),this.reconnectInterval=null),this.monitorRecorder){try{this.monitorRecorder.state==="recording"&&this.monitorRecorder.stop()}catch(e){console.warn("[AudioMonitor] Error stopping monitor recorder:",e)}this.monitorRecorder=null}this.mediaStreamSource&&(this.mediaStreamSource.disconnect(),this.mediaStreamSource=null),this.analyser&&(this.analyser.disconnect(),this.analyser=null),this.audioContext&&(this.audioContext.close(),this.audioContext=null),this.stream&&(this.stream.getTracks().forEach(e=>e.stop()),this.stream=null),console.log("[AudioMonitor] Cleanup complete.")}}const TW=t=>{const e=m.useRef(null),n=m.useRef(null),r=m.useRef(null),i=m.useRef(null),o=async()=>{const a=t.current;if(!a){console.error("AudioMonitor not provided");return}const l=document.getElementById("visualizer");if(!l){console.error("Canvas element not found");return}i.current=l;const c=l.getContext("2d");if(!c){console.error("Unable to get canvas context");return}if(l.width===0||l.height===0){console.error("Canvas has zero dimensions:",l.width,l.height);return}let u=a.getAnalyser(),d=0;const h=5;for(;!u&&d<h;)console.log(`Waiting for analyzer (attempt ${d+1}/${h})...`),await new Promise(R=>{r.current=window.setTimeout(R,500)}),u=a.getAnalyser(),d++;if(!u){console.error("Analyzer not available after retries");return}await a.resumeContext();const p=u.frequencyBinCount,g=new Uint8Array(p),y=8,x=new Float32Array(y).fill(0),v=.85,w=a.getAudioContext();if(!w){console.error("AudioContext not available");return}const S=w.sampleRate/u.fftSize,C=Math.floor(50/S),k=Math.floor(1e3/S),E=k-C;e.current&&(cancelAnimationFrame(e.current),e.current=null);const T=()=>{if(!i.current){console.log("Canvas no longer exists, stopping visualization"),e.current&&(cancelAnimationFrame(e.current),e.current=null);return}e.current=requestAnimationFrame(T),u.getByteFrequencyData(g);const R=g.slice(C,k).every($=>$===0),_=Date.now();R?n.current||(n.current=_):n.current&&(n.current=null);const A=n.current&&_-n.current>3e4;c.clearRect(0,0,l.width,l.height);const L=1,N=(y-1)*L,M=Math.floor((l.width-N)/y);let z=0;for(let $=0;$<y;$++){const V=C+Math.floor($/y*E),I=C+Math.floor(($+1)/y*E);if(I<=V)continue;const P=g.slice(V,I).reduce((Z,he)=>Z+he,0)/(I-V);x[$]=x[$]*v+P*(1-v);const D=Math.max(x[$]/255*l.height*1.2,l.height*.2),H=(l.height-D)/2;c.fillStyle=A?"rgba(239, 68, 68, 0.8)":`rgba(59, 130, 246, ${Math.max(.3,x[$]/255)})`,c.fillRect(z,H,M,D),z+=M+L}};T()},s=()=>{r.current&&(window.clearTimeout(r.current),r.current=null),e.current&&(cancelAnimationFrame(e.current),e.current=null),i.current=null};return m.useEffect(()=>()=>{s()},[]),{startVisualizer:o,stopVisualizer:s}},ki={micSelectorContainer:{display:"flex",alignItems:"center"},visualizerButton:{display:"flex",alignItems:"center",padding:"0",backgroundColor:"transparent",border:"none",cursor:"pointer",outline:"none",WebkitTapHighlightColor:"transparent","&:hover":{backgroundColor:"transparent"},"&:active":{backgroundColor:"transparent"},"&:focus":{backgroundColor:"transparent",outline:"none"}},visualizerGroup:{display:"flex",alignItems:"center",gap:"4px",backgroundColor:"white",padding:"0 12px",borderRadius:"6px",border:"1px solid #e5e7eb",justifyContent:"space-between",height:"36px"},visualizer:{maxWidth:"60px",height:"36px",backgroundColor:"transparent"},dropdownContent:{minWidth:"220px",backgroundColor:"white",borderRadius:"6px",padding:"5px",boxShadow:"0px 10px 38px -10px rgba(22, 23, 24, 0.35), 0px 10px 20px -15px rgba(22, 23, 24, 0.2)"},dropdownItem:{fontSize:"14px",lineHeight:"1",color:"#374151",borderRadius:"3px",display:"flex",alignItems:"center",height:"32px",padding:"0 8px",userSelect:"none",outline:"none",cursor:"pointer","&:hover":{backgroundColor:"#f3f4f6"}},selectedDropdownItem:{backgroundColor:"#f0f9ff",color:"#2563eb","&:hover":{backgroundColor:"#e0f2fe"}},dropdownLabel:{fontSize:"12px",lineHeight:"1",color:"#6b7280",padding:"0 8px",marginBottom:"4px"}};function _W({onDeviceSelect:t,selectedDevice:e}){const[n,r]=m.useState([]),[i,o]=m.useState(null),s=m.useRef(null),a=m.useRef(!1),{startVisualizer:l}=TW(s),c=m.useRef(!0);m.useEffect(()=>(s.current=new EW,c.current=!0,()=>{c.current=!1}),[]);const u=m.useCallback(async()=>{if(c.current)try{await navigator.mediaDevices.getUserMedia({audio:!0});const g=(await navigator.mediaDevices.enumerateDevices()).filter(x=>x.kind==="audioinput");if(r(g),e&&g.some(x=>x.deviceId===e.deviceId)){if(g.length>0&&!e){const x=g.find(v=>v.deviceId!=="default"&&v.deviceId!=="communications")||g[0];t(x)}}else{const x=g.find(v=>v.deviceId!=="default"&&v.deviceId!=="communications")||g[0];x&&(console.log("Previously selected device no longer available. Switching to:",x.label),t(x))}}catch(p){console.error("Failed to load audio devices:",p)}},[e,t]);m.useEffect(()=>(u(),navigator.mediaDevices.addEventListener("devicechange",u),()=>{navigator.mediaDevices.removeEventListener("devicechange",u)}),[u]);const d=m.useCallback(async()=>{if(!(!c.current||!s.current||!e||a.current))try{a.current=!0,s.current.cleanup(),await s.current.initialize(e.deviceId),c.current&&(await new Promise(p=>setTimeout(p,100)),await l())}catch(p){console.error("Failed to initialize audio monitor:",p),c.current&&s.current&&s.current.cleanup()}finally{c.current&&(a.current=!1)}},[e==null?void 0:e.deviceId,l]);m.useEffect(()=>{(i==null?void 0:i.deviceId)!==(e==null?void 0:e.deviceId)&&(o(e),e&&d())},[i==null?void 0:i.deviceId,e==null?void 0:e.deviceId,d]);const h=m.useCallback(p=>{if(!c.current)return;const g=n.find(y=>y.deviceId===p);g&&t(g)},[n,t]);return f.jsx("div",{style:ki.micSelectorContainer,children:f.jsxs(Ds,{children:[f.jsx(Ls,{asChild:!0,children:f.jsx("button",{style:ki.visualizerButton,children:f.jsxs("div",{style:ki.visualizerGroup,children:[f.jsx(ih,{size:16,color:"#6b7280"}),f.jsx("canvas",{id:"visualizer",style:ki.visualizer,width:"120",height:"36"}),f.jsx(Xe,{width:16,height:16,color:"#6b7280"})]})})}),f.jsx($s,{children:f.jsxs(Fs,{style:ki.dropdownContent,sideOffset:5,children:[f.jsx("div",{style:ki.dropdownLabel,children:"Select Microphone"}),n.filter(p=>p.deviceId!=="default").map(p=>{const g=p.deviceId===(e==null?void 0:e.deviceId);return f.jsxs(gt,{style:{...ki.dropdownItem,...g?ki.selectedDropdownItem:{}},onClick:()=>h(p.deviceId),children:[f.jsx(ih,{size:16,style:{marginRight:"8px",color:g?"#2563eb":"#6b7280"}}),p.label||`Microphone ${p.deviceId.slice(0,4)}`]},p.deviceId)})]})})]})})}const en={container:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:"8px"},buttonsContainer:{width:"200px",height:"36px"},buttonGroup:{display:"flex",alignItems:"stretch",height:"100%",width:"100%",minWidth:"200px"},dropdownTrigger:{display:"flex",alignItems:"center",padding:"0 8px",backgroundColor:"#3b82f6",color:"white",border:"none",borderLeft:"1px solid rgba(255,255,255,0.2)",borderRadius:"0 6px 6px 0",cursor:"pointer",transition:"all 0.2s ease",outline:"none",width:"32px","&:hover":{backgroundColor:"#2563eb"},"&:focus":{outline:"none"},"&:active":{outline:"none"},WebkitTapHighlightColor:"transparent"},controlsRow:{display:"flex",alignItems:"center",gap:"16px",userSelect:"none",height:"36px"},timerContainer:{display:"flex",alignItems:"center",pointerEvents:"none",height:"36px"},timer:{display:"flex",alignItems:"center",gap:"4px",fontSize:"14px",color:"#374151",height:"36px",padding:"0 8px"},timerIcon:{width:"16px",height:"16px",color:"#6b7280"},dropdownContent:{minWidth:"220px",backgroundColor:"white",borderRadius:"6px",padding:"5px",boxShadow:"0px 10px 38px -10px rgba(22, 23, 24, 0.35), 0px 10px 20px -15px rgba(22, 23, 24, 0.2)"},dropdownItem:{fontSize:"14px",lineHeight:"1",color:"#374151",borderRadius:"3px",display:"flex",alignItems:"center",height:"32px",padding:"0 8px",userSelect:"none",outline:"none",cursor:"pointer","&:hover":{backgroundColor:"#f3f4f6"}},pauseButton:{display:"flex",alignItems:"center",justifyContent:"center",gap:"6px",padding:"8px 16px",color:"white",border:"none",cursor:"pointer",fontSize:"14px",fontWeight:"500",transition:"all 0.2s ease",outline:"none",borderRadius:"6px 0 0 6px",backgroundColor:"#9ca3af",width:"100px","&:hover":{backgroundColor:"#6b7280"}},resumeButton:{display:"flex",alignItems:"center",justifyContent:"center",gap:"6px",padding:"8px 16px",color:"white",border:"none",cursor:"pointer",fontSize:"14px",fontWeight:"500",transition:"all 0.2s ease",outline:"none",borderRadius:"6px 0 0 6px",backgroundColor:"#3b82f6",flex:"1","&:hover":{backgroundColor:"#2563eb"}},stopButton:{display:"flex",alignItems:"center",justifyContent:"center",gap:"6px",padding:"8px 16px",color:"white",border:"none",cursor:"pointer",fontSize:"14px",fontWeight:"500",transition:"all 0.2s ease",outline:"none",borderRadius:"0 6px 6px 0",backgroundColor:"#dc2626",width:"100px","&:hover":{backgroundColor:"#b91c1c"}},startButton:{display:"flex",alignItems:"center",justifyContent:"center",gap:"6px",padding:"8px 16px",color:"white",border:"none",cursor:"pointer",fontSize:"14px",fontWeight:"500",transition:"all 0.2s ease",outline:"none",borderRadius:"6px 0 0 6px",backgroundColor:"#3b82f6",minWidth:"168px",flex:1,"&:hover":{backgroundColor:"#2563eb"}}};function RW({disabled:t=!1,onRecordingStateChange:e,visitId:n,initialChunkId:r,onStartRecording:i}){const[o,s]=m.useState(null),[a,l]=m.useState("new"),[c,u]=m.useState(n||null),{user:d}=Nt(),{updateVisitState:h}=Vx(),{isRecording:p,isPaused:g,formattedTime:y,startRecording:x,stopRecording:v,pauseRecording:w,resumeRecording:b}=kW({onRecordingStateChange:e,initialVisitId:c||void 0,initialChunkId:r});m.useEffect(()=>{console.log("[AudioRecorder] State update:",{isRecording:p,isPaused:g,recordingState:a,visitId:c,disabled:t})},[p,g,a,c,t]),m.useEffect(()=>{c===null&&l("new")},[c]);const S=m.useCallback(async()=>{try{if(!(d!=null&&d.id))throw new Error("User not authenticated");if(c&&a==="paused"){await b(),l("recording"),await h({visitId:c,state:"recording"});return}if(i){const R=await i();if(!R)return;u(R),console.log("[AudioRecorder] Setting internal visit ID:",R),l("recording"),await x(o==null?void 0:o.deviceId,R)}else{console.error("No visit ID available and no onStartRecording provided");return}}catch(R){console.error("Failed to start recording:",R)}},[d==null?void 0:d.id,c,a,i,b,h]),C=m.useCallback(async()=>{if(c)try{await w(),l("paused"),await h({visitId:c,state:"paused"})}catch(R){console.error("Failed to pause recording:",R)}},[c,w,h]),k=m.useCallback(async()=>{if(c)try{await b(),l("recording"),await h({visitId:c,state:"recording"})}catch(R){console.error("Failed to resume recording:",R)}},[c,b,h]),E=m.useCallback(async()=>{if(console.log("[AudioRecorder] Stopping recording",c),!!c)try{await v(),l("processing"),await h({visitId:c,state:"processing",endVisit:!0})}catch(R){console.error("Failed to stop recording:",R)}},[c,v,h]);m.useEffect(()=>{e==null||e(p,g)},[p,g,e]);const T=m.useMemo(()=>({startButton:{...en.startButton,...t?{opacity:.5,cursor:"not-allowed",backgroundColor:"#9ca3af"}:{}},dropdownTrigger:{...en.dropdownTrigger,...t?{opacity:.5,cursor:"not-allowed",backgroundColor:"#9ca3af"}:{}}}),[t]);return f.jsxs("div",{style:en.container,children:[f.jsxs("div",{style:en.controlsRow,children:[f.jsx("div",{style:en.timerContainer,children:f.jsxs("div",{style:en.timer,children:[f.jsx(yF,{style:en.timerIcon}),y]})}),f.jsx(_W,{selectedDevice:o,onDeviceSelect:s})]}),f.jsx("div",{style:en.buttonsContainer,children:f.jsx("div",{style:en.buttonGroup,children:p?f.jsxs(f.Fragment,{children:[f.jsxs("button",{onClick:a==="paused"?k:C,style:a==="paused"?en.resumeButton:en.pauseButton,disabled:t,children:[a==="paused"?f.jsx(ih,{size:16}):f.jsx(VF,{size:16}),a==="paused"?"Resume":"Pause"]}),f.jsxs("button",{onClick:E,style:en.stopButton,disabled:t,children:[f.jsx(JF,{size:16}),"Stop"]})]}):f.jsxs(f.Fragment,{children:[f.jsxs("button",{onClick:S,style:T.startButton,disabled:t,children:[f.jsx(ih,{size:16}),"Start Recording"]}),f.jsxs(Ds,{children:[f.jsx(Ls,{asChild:!0,children:f.jsx("button",{style:T.dropdownTrigger,disabled:t,children:f.jsx(Xe,{width:16,height:16})})}),f.jsx($s,{children:f.jsx(Fs,{style:en.dropdownContent,sideOffset:5,children:f.jsxs(gt,{style:en.dropdownItem,children:[f.jsx(t5,{size:16,style:{marginRight:"8px"}}),"Upload Audio"]})})})]})]})})})]})}const $t={container:{position:"relative"},trigger:{display:"flex",alignItems:"center",padding:"8px",border:"none",borderRadius:"6px",backgroundColor:"transparent",color:"#6b7280",cursor:"pointer",outline:"none","&:hover":{backgroundColor:"#f3f4f6"}},popoverContent:{backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"8px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)",width:"400px",zIndex:50,padding:"24px"},title:{fontSize:"20px",fontWeight:"600",color:"#111827",marginBottom:"24px"},section:{marginBottom:"24px"},label:{fontSize:"16px",fontWeight:"500",color:"#111827",marginBottom:"4px"},description:{fontSize:"14px",color:"#6b7280",marginBottom:"12px"},selectTrigger:{display:"inline-flex",alignItems:"center",justifyContent:"space-between",borderRadius:"6px",padding:"0 15px",fontSize:"14px",lineHeight:"1",height:"35px",gap:"5px",backgroundColor:"white",color:"#111827",border:"1px solid #e5e7eb",width:"100%","&:hover":{backgroundColor:"#f9fafb"},"&:focus":{boxShadow:"0 0 0 2px #e5e7eb"},"&[dataPlaceholder]":{color:"#6b7280"}},footer:{display:"flex",justifyContent:"flex-end",gap:"12px",marginTop:"24px"},button:{padding:"8px 16px",borderRadius:"6px",fontSize:"14px",fontWeight:"500",cursor:"pointer"},cancelButton:{border:"none",backgroundColor:"transparent",color:"#6b7280","&:hover":{backgroundColor:"#f3f4f6"}},saveButton:{border:"none",backgroundColor:"#6b7280",color:"white","&:hover":{backgroundColor:"#4b5563"}}},BS=Te.forwardRef(({children:t,...e},n)=>f.jsx(VP,{...e,ref:n,className:"text-[13px] leading-none text-gray-700 rounded-[3px] flex items-center h-[25px] pr-[35px] pl-[25px] relative select-none data-[disabled]:text-gray-400 data-[disabled]:pointer-events-none data-[highlighted]:outline-none data-[highlighted]:bg-blue-100 data-[highlighted]:text-blue-900",children:f.jsx(UP,{children:t})}));function OW({spokenLanguage:t,patientInstructionsLanguage:e,setSpokenLanguage:n,setPatientInstructionsLanguage:r}){const[i,o]=m.useState(!1);return f.jsx("div",{style:$t.container,children:f.jsxs(eM,{open:i,onOpenChange:o,children:[f.jsx(tM,{asChild:!0,children:f.jsx("button",{style:$t.trigger,children:f.jsx(FF,{size:20})})}),f.jsx(nM,{children:f.jsxs(rM,{style:{...$t.popoverContent,zIndex:40},side:"bottom",align:"start",sideOffset:4,children:[f.jsx("div",{style:$t.title,children:"Language settings"}),f.jsxs("div",{style:$t.section,children:[f.jsx("div",{style:$t.label,children:"Speech language"}),f.jsx("div",{style:$t.description,children:"Choosing a specific language will improve transcription accuracy."}),f.jsxs(Di,{value:t,onValueChange:n,children:[f.jsxs(Li,{style:$t.selectTrigger,className:"inline-flex items-center justify-between rounded-md px-3 py-2 text-sm leading-none gap-1 bg-white border border-gray-300 h-9 w-full max-w-md outline-none focus:border-blue-500 data-[placeholder]:text-gray-500",onClick:s=>s.stopPropagation(),children:[f.jsx($i,{}),f.jsx(Fi,{children:f.jsx(Xe,{})})]}),f.jsx(Bi,{children:f.jsxs(zi,{sideOffset:5,position:"popper",className:"bg-white rounded-md shadow-lg border border-gray-200 w-[var(--radix-select-trigger-width)]",style:{zIndex:9999},onClick:s=>s.stopPropagation(),children:[f.jsx(Ui,{className:"flex items-center justify-center h-6 bg-white text-gray-700 cursor-default",children:f.jsx(Ai,{})}),f.jsx(Vi,{className:"p-1",style:{maxHeight:"250px",overflowY:"auto"},children:av.map(s=>f.jsx(BS,{value:s.value,children:s.label},s.value))}),f.jsx(Hi,{className:"flex items-center justify-center h-6 bg-white text-gray-700 cursor-default",children:f.jsx(Xe,{})})]})})]})]}),f.jsxs("div",{style:$t.section,children:[f.jsx("div",{style:$t.label,children:"Patient instructions language"}),f.jsx("div",{style:$t.description,children:"Your patient instructions will be generated in this language."}),f.jsxs(Di,{value:e,onValueChange:r,children:[f.jsxs(Li,{style:$t.selectTrigger,className:"inline-flex items-center justify-between rounded-md px-3 py-2 text-sm leading-none gap-1 bg-white border border-gray-300 h-9 w-full max-w-md outline-none focus:border-blue-500 data-[placeholder]:text-gray-500",onClick:s=>s.stopPropagation(),children:[f.jsx($i,{}),f.jsx(Fi,{children:f.jsx(Xe,{})})]}),f.jsx(Bi,{children:f.jsxs(zi,{sideOffset:5,position:"popper",className:"bg-white rounded-md shadow-lg border border-gray-200 w-[var(--radix-select-trigger-width)]",style:{zIndex:9999},onClick:s=>s.stopPropagation(),children:[f.jsx(Ui,{className:"flex items-center justify-center h-6 bg-white text-gray-700 cursor-default",children:f.jsx(Ai,{})}),f.jsx(Vi,{className:"p-1",style:{maxHeight:"250px",overflowY:"auto"},children:gP.map(s=>f.jsx(BS,{value:s.value,children:s.label},s.value))}),f.jsx(Hi,{className:"flex items-center justify-center h-6 bg-white text-gray-700 cursor-default",children:f.jsx(Xe,{})})]})})]})]}),f.jsx("div",{style:$t.footer,children:f.jsx("button",{style:{...$t.button,...$t.cancelButton},onClick:()=>o(!1),children:"Close"})})]})})]})})}const Yd={header:{height:"60px",width:"100%",backgroundColor:"#f9fafb",padding:"0 24px 0",display:"flex",alignItems:"flex-end",justifyContent:"space-between",gap:"32px"},headerLeft:{flex:"1 1 auto",minWidth:0,display:"flex",alignItems:"center",gap:"8px"},patientSearchWrapper:{maxWidth:"300px",flex:"1 1 auto"},headerRight:{flex:"0 0 auto",display:"flex",alignItems:"center",gap:"16px"}};function PW({onRecordingStateChange:t,currentVisitId:e,currentVisitSelectedPatientId:n,currentVisitSelectedSpokenLanguage:r,currentVisitSelectedPatientInstructionsLanguage:i}){const[o,s]=m.useState(void 0),[a,l]=m.useState(null),[c,u]=m.useState("en"),[d,h]=m.useState("en"),[p,g]=m.useState(!1),{user:y}=Nt(),x=gr(),{createVisit:v,updateVisitState:w,updateVisitName:b,updateVisitPatient:S,updateVisitLanguages:C}=Vx();m.useEffect(()=>{const M=y==null?void 0:y.note_preferences;e?(u(r??Aa.audio_language),h(i??Aa.patient_instructions_language)):(u(M.primary_language||Aa.audio_language),h(M.patient_instructions_language||Aa.patient_instructions_language))},[y==null?void 0:y.note_preferences,e,r,i]);const k=M=>{u(M),e&&C({visitId:e,audioLanguage:M,patientInstructionsLanguage:d})},E=M=>{h(M),e&&C({visitId:e,audioLanguage:c,patientInstructionsLanguage:M})},T=M=>{l((M==null?void 0:M.id)||null),e&&S({visitId:e,patientId:(M==null?void 0:M.id)||null})},R=M=>{s(M||void 0),e&&b({visitId:e,name:M||null})},_=m.useCallback(async()=>{try{if(!(y!=null&&y.id))throw new Error("User not authenticated");if(e)await w({visitId:e,state:"recording"});else{const M=crypto.randomUUID();return await v({id:M,userId:y.id,name:o,patientId:a||void 0,audioLanguage:c,patientInstructionsLanguage:d}),x(`/visit/${M}`),M}}catch(M){console.error("Failed to create/resume visit:",M);return}},[y==null?void 0:y.id,e,v,w,o,a,c,d,x]),A=m.useCallback((M,z)=>{g(M&&!z),t(M,z)},[t]),L=m.useMemo(()=>({disabled:!1,onRecordingStateChange:A,onStartRecording:_,visitId:p?void 0:e}),[A,_,e,p]),N=m.useMemo(()=>f.jsx(RW,{...L}),[L]);return f.jsxs("div",{style:Yd.header,children:[f.jsxs("div",{style:Yd.headerLeft,children:[f.jsx("div",{style:Yd.patientSearchWrapper,children:f.jsx(aW,{onPatientSelect:T,onVisitNameChange:R,visitId:e,selectedPatientId:n??a??void 0})}),f.jsx(OW,{spokenLanguage:c,patientInstructionsLanguage:d,setSpokenLanguage:k,setPatientInstructionsLanguage:E})]}),f.jsx("div",{style:Yd.headerRight,children:N})]})}const rg={container:{height:"100vh",width:"100vw",display:"flex",flexDirection:"column",backgroundColor:"#f3f4f6"},mainContent:{flex:1,display:"flex",flexDirection:"row",overflow:"hidden"},content:{flex:1,display:"flex",flexDirection:"column",alignItems:"flex-start",overflow:"hidden"}};function Ko(){var w;const t=gr(),{visitId:e}=_A(),n=Gn(),[r,i]=m.useState(!1),[o,s]=m.useState(!1),{user:a,loading:l,error:c}=Nt(),u=Qe(),d=(w=n.state)==null?void 0:w.pendingRecordingVisitId;console.log("MainContent rendering:",{path:n.pathname,userId:a==null?void 0:a.id,isLoading:l,hasError:!!c,visitId:e,pendingRecordingVisitId:d});let h=[];try{h=U9((a==null?void 0:a.id)||""),console.log("Visits loaded:",h.length)}catch(b){console.error("Error loading visits:",b)}console.log("VISIT ID",e);const p=h.find(b=>b.id===e);console.log("SELECTED VISIT",p,h,e);const g=m.useCallback((b,S=!1)=>{i(b),s(S)},[]),y=b=>{t(`/visit/${b.id}`,{state:{pendingRecordingVisitId:b.id}})},x=()=>{console.log("NEW SESSION"),t("/record")},v=b=>{if(b.state!=="paused")return;(async()=>{var C;try{const{data:k,error:E}=await u.from("containers").select("chunk_id").eq("visit_id",b.id).order("chunk_id",{ascending:!1}).limit(1);if(E)throw E;return((C=k==null?void 0:k[0])==null?void 0:C.chunk_id)??-1}catch(k){return console.error("Error getting last chunk ID:",k),-1}})().then(C=>{t(`/visit/${b.id}`,{state:{visitId:b.id,lastChunkId:C,state:"paused",isRecordingEnabled:!0}})})};return l?f.jsx("div",{style:{height:"100vh",width:"100vw",display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:"#f3f4f6"},children:f.jsx("div",{children:"Loading..."})}):c?f.jsxs("div",{children:["Error loading user profile: ",c]}):f.jsx("div",{style:rg.container,children:f.jsxs("div",{style:rg.mainContent,children:[f.jsx(V9,{onNewSession:x,onVisitSelect:y,selectedVisitId:p==null?void 0:p.id,onContinueRecording:v,visits:h}),f.jsx("div",{style:rg.content,children:n.pathname==="/profile"?f.jsx(l9,{}):n.pathname==="/settings"?f.jsx(D9,{}):n.pathname==="/my-templates"?f.jsx(L9,{}):n.pathname==="/community-templates"?f.jsx($9,{}):n.pathname==="/patients"?f.jsx(G9,{}):f.jsxs(f.Fragment,{children:[f.jsx(PW,{onRecordingStateChange:g,currentVisitId:p==null?void 0:p.id,currentVisitSelectedPatientId:(p==null?void 0:p.patient_id)??void 0,currentVisitSelectedSpokenLanguage:(p==null?void 0:p.audio_language)??void 0,currentVisitSelectedPatientInstructionsLanguage:(p==null?void 0:p.patient_instructions_language)??void 0}),f.jsx(n9,{isTranscribing:r||o,placeholder:r?o||(p==null?void 0:p.state)==="paused"?"Recording paused...":"Your transcription will appear here as you speak...":p?"Loading visit transcription...":"Select a visit or start a new recording session",currentVisit:p},"TranscriptionDisplay-"+(p==null?void 0:p.id))]})})]})})}const MW=new AE({defaultOptions:{queries:{retry:1,refetchOnWindowFocus:!1}}});function IW(){return f.jsx(DE,{client:MW,children:f.jsx(o9,{children:f.jsx(KH,{children:f.jsxs(VA,{children:[f.jsx(mn,{path:"/login",element:f.jsx(i9,{})}),f.jsx(mn,{path:"/signup",element:f.jsx(s9,{})}),f.jsx(mn,{path:"/",element:f.jsx(Kf,{to:"/record",replace:!0})}),f.jsx(mn,{path:"*",element:f.jsx(Kf,{to:"/record",replace:!0})}),f.jsx(mn,{path:"/record",element:f.jsx(Ci,{children:f.jsx(Ko,{})})}),f.jsx(mn,{path:"/visit/:visitId",element:f.jsx(Ci,{children:f.jsx(Ko,{})})}),f.jsx(mn,{path:"/profile",element:f.jsx(Ci,{children:f.jsx(Ko,{})})}),f.jsx(mn,{path:"/settings",element:f.jsx(Ci,{children:f.jsx(Ko,{})})}),f.jsx(mn,{path:"/my-templates",element:f.jsx(Ci,{children:f.jsx(Ko,{})})}),f.jsx(mn,{path:"/community-templates",element:f.jsx(Ci,{children:f.jsx(Ko,{})})}),f.jsx(mn,{path:"/patients",element:f.jsx(Ci,{children:f.jsx(Ko,{})})}),f.jsx(mn,{path:"/admin",element:f.jsx(Ci,{children:f.jsx(q9,{children:f.jsx(W9,{})})})})]})})})})}const AW=new AE({defaultOptions:{queries:{retry:1,refetchOnWindowFocus:!1}}});ig.createRoot(document.getElementById("root")).render(f.jsx(Te.StrictMode,{children:f.jsx(DE,{client:AW,children:f.jsx(sL,{children:f.jsx(pN,{children:f.jsx(IW,{})})})})}));export{QS as g};
