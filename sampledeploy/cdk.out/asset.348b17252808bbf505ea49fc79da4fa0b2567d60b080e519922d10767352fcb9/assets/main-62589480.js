var Np=(t,e,n)=>{if(!e.has(t))throw TypeError("Cannot "+n)};var R=(t,e,n)=>(Np(t,e,"read from private field"),n?n.call(t):e.get(t)),Q=(t,e,n)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,n)},U=(t,e,n,r)=>(Np(t,e,"write to private field"),r?r.call(t,n):e.set(t,n),n);var rd=(t,e,n,r)=>({set _(i){U(t,e,i,n)},get _(){return R(t,e,r)}}),ae=(t,e,n)=>(Np(t,e,"access private method"),n);function lM(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in t)){const o=Object.getOwnPropertyDescriptor(r,i);o&&Object.defineProperty(t,i,o.get?o:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();var Vn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function YS(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function cM(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var i=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,i.get?i:{enumerable:!0,get:function(){return t[r]}})}),n}var QS={exports:{}},Ch={},XS={exports:{}},fe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Pu=Symbol.for("react.element"),uM=Symbol.for("react.portal"),dM=Symbol.for("react.fragment"),fM=Symbol.for("react.strict_mode"),hM=Symbol.for("react.profiler"),pM=Symbol.for("react.provider"),mM=Symbol.for("react.context"),gM=Symbol.for("react.forward_ref"),yM=Symbol.for("react.suspense"),vM=Symbol.for("react.memo"),xM=Symbol.for("react.lazy"),Ux=Symbol.iterator;function wM(t){return t===null||typeof t!="object"?null:(t=Ux&&t[Ux]||t["@@iterator"],typeof t=="function"?t:null)}var ZS={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},eC=Object.assign,tC={};function _l(t,e,n){this.props=t,this.context=e,this.refs=tC,this.updater=n||ZS}_l.prototype.isReactComponent={};_l.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};_l.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function nC(){}nC.prototype=_l.prototype;function xv(t,e,n){this.props=t,this.context=e,this.refs=tC,this.updater=n||ZS}var wv=xv.prototype=new nC;wv.constructor=xv;eC(wv,_l.prototype);wv.isPureReactComponent=!0;var Hx=Array.isArray,rC=Object.prototype.hasOwnProperty,bv={current:null},iC={key:!0,ref:!0,__self:!0,__source:!0};function oC(t,e,n){var r,i={},o=null,s=null;if(e!=null)for(r in e.ref!==void 0&&(s=e.ref),e.key!==void 0&&(o=""+e.key),e)rC.call(e,r)&&!iC.hasOwnProperty(r)&&(i[r]=e[r]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];i.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:Pu,type:t,key:o,ref:s,props:i,_owner:bv.current}}function bM(t,e){return{$$typeof:Pu,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Sv(t){return typeof t=="object"&&t!==null&&t.$$typeof===Pu}function SM(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Wx=/\/+/g;function Dp(t,e){return typeof t=="object"&&t!==null&&t.key!=null?SM(""+t.key):e.toString(36)}function qd(t,e,n,r,i){var o=typeof t;(o==="undefined"||o==="boolean")&&(t=null);var s=!1;if(t===null)s=!0;else switch(o){case"string":case"number":s=!0;break;case"object":switch(t.$$typeof){case Pu:case uM:s=!0}}if(s)return s=t,i=i(s),t=r===""?"."+Dp(s,0):r,Hx(i)?(n="",t!=null&&(n=t.replace(Wx,"$&/")+"/"),qd(i,e,n,"",function(c){return c})):i!=null&&(Sv(i)&&(i=bM(i,n+(!i.key||s&&s.key===i.key?"":(""+i.key).replace(Wx,"$&/")+"/")+t)),e.push(i)),1;if(s=0,r=r===""?".":r+":",Hx(t))for(var a=0;a<t.length;a++){o=t[a];var l=r+Dp(o,a);s+=qd(o,e,n,l,i)}else if(l=wM(t),typeof l=="function")for(t=l.call(t),a=0;!(o=t.next()).done;)o=o.value,l=r+Dp(o,a++),s+=qd(o,e,n,l,i);else if(o==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return s}function id(t,e,n){if(t==null)return t;var r=[],i=0;return qd(t,r,"","",function(o){return e.call(n,o,i++)}),r}function CM(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var qt={current:null},Gd={transition:null},kM={ReactCurrentDispatcher:qt,ReactCurrentBatchConfig:Gd,ReactCurrentOwner:bv};function sC(){throw Error("act(...) is not supported in production builds of React.")}fe.Children={map:id,forEach:function(t,e,n){id(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return id(t,function(){e++}),e},toArray:function(t){return id(t,function(e){return e})||[]},only:function(t){if(!Sv(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};fe.Component=_l;fe.Fragment=dM;fe.Profiler=hM;fe.PureComponent=xv;fe.StrictMode=fM;fe.Suspense=yM;fe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=kM;fe.act=sC;fe.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=eC({},t.props),i=t.key,o=t.ref,s=t._owner;if(e!=null){if(e.ref!==void 0&&(o=e.ref,s=bv.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)rC.call(e,l)&&!iC.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var c=0;c<l;c++)a[c]=arguments[c+2];r.children=a}return{$$typeof:Pu,type:t.type,key:i,ref:o,props:r,_owner:s}};fe.createContext=function(t){return t={$$typeof:mM,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:pM,_context:t},t.Consumer=t};fe.createElement=oC;fe.createFactory=function(t){var e=oC.bind(null,t);return e.type=t,e};fe.createRef=function(){return{current:null}};fe.forwardRef=function(t){return{$$typeof:gM,render:t}};fe.isValidElement=Sv;fe.lazy=function(t){return{$$typeof:xM,_payload:{_status:-1,_result:t},_init:CM}};fe.memo=function(t,e){return{$$typeof:vM,type:t,compare:e===void 0?null:e}};fe.startTransition=function(t){var e=Gd.transition;Gd.transition={};try{t()}finally{Gd.transition=e}};fe.unstable_act=sC;fe.useCallback=function(t,e){return qt.current.useCallback(t,e)};fe.useContext=function(t){return qt.current.useContext(t)};fe.useDebugValue=function(){};fe.useDeferredValue=function(t){return qt.current.useDeferredValue(t)};fe.useEffect=function(t,e){return qt.current.useEffect(t,e)};fe.useId=function(){return qt.current.useId()};fe.useImperativeHandle=function(t,e,n){return qt.current.useImperativeHandle(t,e,n)};fe.useInsertionEffect=function(t,e){return qt.current.useInsertionEffect(t,e)};fe.useLayoutEffect=function(t,e){return qt.current.useLayoutEffect(t,e)};fe.useMemo=function(t,e){return qt.current.useMemo(t,e)};fe.useReducer=function(t,e,n){return qt.current.useReducer(t,e,n)};fe.useRef=function(t){return qt.current.useRef(t)};fe.useState=function(t){return qt.current.useState(t)};fe.useSyncExternalStore=function(t,e,n){return qt.current.useSyncExternalStore(t,e,n)};fe.useTransition=function(){return qt.current.useTransition()};fe.version="18.3.1";XS.exports=fe;var g=XS.exports;const Te=YS(g),EM=lM({__proto__:null,default:Te},[g]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var TM=g,_M=Symbol.for("react.element"),RM=Symbol.for("react.fragment"),OM=Object.prototype.hasOwnProperty,PM=TM.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,MM={key:!0,ref:!0,__self:!0,__source:!0};function aC(t,e,n){var r,i={},o=null,s=null;n!==void 0&&(o=""+n),e.key!==void 0&&(o=""+e.key),e.ref!==void 0&&(s=e.ref);for(r in e)OM.call(e,r)&&!MM.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:_M,type:t,key:o,ref:s,props:i,_owner:PM.current}}Ch.Fragment=RM;Ch.jsx=aC;Ch.jsxs=aC;QS.exports=Ch;var f=QS.exports;window.global=window;var ig={},lC={exports:{}},Tn={},cC={exports:{}},uC={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(M,A){var $=M.length;M.push(A);e:for(;0<$;){var G=$-1>>>1,ee=M[G];if(0<i(ee,A))M[G]=A,M[$]=ee,$=G;else break e}}function n(M){return M.length===0?null:M[0]}function r(M){if(M.length===0)return null;var A=M[0],$=M.pop();if($!==A){M[0]=$;e:for(var G=0,ee=M.length,q=ee>>>1;G<q;){var Z=2*(G+1)-1,be=M[Z],ge=Z+1,J=M[ge];if(0>i(be,$))ge<ee&&0>i(J,be)?(M[G]=J,M[ge]=$,G=ge):(M[G]=be,M[Z]=$,G=Z);else if(ge<ee&&0>i(J,$))M[G]=J,M[ge]=$,G=ge;else break e}}return A}function i(M,A){var $=M.sortIndex-A.sortIndex;return $!==0?$:M.id-A.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var s=Date,a=s.now();t.unstable_now=function(){return s.now()-a}}var l=[],c=[],u=1,d=null,h=3,p=!1,m=!1,y=!1,v=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(M){for(var A=n(c);A!==null;){if(A.callback===null)r(c);else if(A.startTime<=M)r(c),A.sortIndex=A.expirationTime,e(l,A);else break;A=n(c)}}function S(M){if(y=!1,b(M),!m)if(n(l)!==null)m=!0,I(C);else{var A=n(c);A!==null&&F(S,A.startTime-M)}}function C(M,A){m=!1,y&&(y=!1,x(T),T=-1),p=!0;var $=h;try{for(b(A),d=n(l);d!==null&&(!(d.expirationTime>A)||M&&!D());){var G=d.callback;if(typeof G=="function"){d.callback=null,h=d.priorityLevel;var ee=G(d.expirationTime<=A);A=t.unstable_now(),typeof ee=="function"?d.callback=ee:d===n(l)&&r(l),b(A)}else r(l);d=n(l)}if(d!==null)var q=!0;else{var Z=n(c);Z!==null&&F(S,Z.startTime-A),q=!1}return q}finally{d=null,h=$,p=!1}}var k=!1,E=null,T=-1,O=5,_=-1;function D(){return!(t.unstable_now()-_<O)}function L(){if(E!==null){var M=t.unstable_now();_=M;var A=!0;try{A=E(!0,M)}finally{A?N():(k=!1,E=null)}}else k=!1}var N;if(typeof w=="function")N=function(){w(L)};else if(typeof MessageChannel<"u"){var P=new MessageChannel,V=P.port2;P.port1.onmessage=L,N=function(){V.postMessage(null)}}else N=function(){v(L,0)};function I(M){E=M,k||(k=!0,N())}function F(M,A){T=v(function(){M(t.unstable_now())},A)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(M){M.callback=null},t.unstable_continueExecution=function(){m||p||(m=!0,I(C))},t.unstable_forceFrameRate=function(M){0>M||125<M?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):O=0<M?Math.floor(1e3/M):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(M){switch(h){case 1:case 2:case 3:var A=3;break;default:A=h}var $=h;h=A;try{return M()}finally{h=$}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(M,A){switch(M){case 1:case 2:case 3:case 4:case 5:break;default:M=3}var $=h;h=M;try{return A()}finally{h=$}},t.unstable_scheduleCallback=function(M,A,$){var G=t.unstable_now();switch(typeof $=="object"&&$!==null?($=$.delay,$=typeof $=="number"&&0<$?G+$:G):$=G,M){case 1:var ee=-1;break;case 2:ee=250;break;case 5:ee=1073741823;break;case 4:ee=1e4;break;default:ee=5e3}return ee=$+ee,M={id:u++,callback:A,priorityLevel:M,startTime:$,expirationTime:ee,sortIndex:-1},$>G?(M.sortIndex=$,e(c,M),n(l)===null&&M===n(c)&&(y?(x(T),T=-1):y=!0,F(S,$-G))):(M.sortIndex=ee,e(l,M),m||p||(m=!0,I(C))),M},t.unstable_shouldYield=D,t.unstable_wrapCallback=function(M){var A=h;return function(){var $=h;h=A;try{return M.apply(this,arguments)}finally{h=$}}}})(uC);cC.exports=uC;var IM=cC.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var AM=g,kn=IM;function z(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var dC=new Set,Ac={};function Bs(t,e){nl(t,e),nl(t+"Capture",e)}function nl(t,e){for(Ac[t]=e,t=0;t<e.length;t++)dC.add(e[t])}var li=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),og=Object.prototype.hasOwnProperty,NM=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Kx={},qx={};function DM(t){return og.call(qx,t)?!0:og.call(Kx,t)?!1:NM.test(t)?qx[t]=!0:(Kx[t]=!0,!1)}function jM(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function LM(t,e,n,r){if(e===null||typeof e>"u"||jM(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Gt(t,e,n,r,i,o,s){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=o,this.removeEmptyString=s}var vt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){vt[t]=new Gt(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];vt[e]=new Gt(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){vt[t]=new Gt(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){vt[t]=new Gt(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){vt[t]=new Gt(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){vt[t]=new Gt(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){vt[t]=new Gt(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){vt[t]=new Gt(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){vt[t]=new Gt(t,5,!1,t.toLowerCase(),null,!1,!1)});var Cv=/[\-:]([a-z])/g;function kv(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Cv,kv);vt[e]=new Gt(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Cv,kv);vt[e]=new Gt(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Cv,kv);vt[e]=new Gt(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){vt[t]=new Gt(t,1,!1,t.toLowerCase(),null,!1,!1)});vt.xlinkHref=new Gt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){vt[t]=new Gt(t,1,!1,t.toLowerCase(),null,!0,!0)});function Ev(t,e,n,r){var i=vt.hasOwnProperty(e)?vt[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(LM(e,n,i,r)&&(n=null),r||i===null?DM(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var mi=AM.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,od=Symbol.for("react.element"),pa=Symbol.for("react.portal"),ma=Symbol.for("react.fragment"),Tv=Symbol.for("react.strict_mode"),sg=Symbol.for("react.profiler"),fC=Symbol.for("react.provider"),hC=Symbol.for("react.context"),_v=Symbol.for("react.forward_ref"),ag=Symbol.for("react.suspense"),lg=Symbol.for("react.suspense_list"),Rv=Symbol.for("react.memo"),Oi=Symbol.for("react.lazy"),pC=Symbol.for("react.offscreen"),Gx=Symbol.iterator;function Wl(t){return t===null||typeof t!="object"?null:(t=Gx&&t[Gx]||t["@@iterator"],typeof t=="function"?t:null)}var Ve=Object.assign,jp;function ic(t){if(jp===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);jp=e&&e[1]||""}return`
`+jp+t}var Lp=!1;function $p(t,e){if(!t||Lp)return"";Lp=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var r=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){r=c}t.call(e.prototype)}else{try{throw Error()}catch(c){r=c}t()}}catch(c){if(c&&r&&typeof c.stack=="string"){for(var i=c.stack.split(`
`),o=r.stack.split(`
`),s=i.length-1,a=o.length-1;1<=s&&0<=a&&i[s]!==o[a];)a--;for(;1<=s&&0<=a;s--,a--)if(i[s]!==o[a]){if(s!==1||a!==1)do if(s--,a--,0>a||i[s]!==o[a]){var l=`
`+i[s].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=s&&0<=a);break}}}finally{Lp=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?ic(t):""}function $M(t){switch(t.tag){case 5:return ic(t.type);case 16:return ic("Lazy");case 13:return ic("Suspense");case 19:return ic("SuspenseList");case 0:case 2:case 15:return t=$p(t.type,!1),t;case 11:return t=$p(t.type.render,!1),t;case 1:return t=$p(t.type,!0),t;default:return""}}function cg(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case ma:return"Fragment";case pa:return"Portal";case sg:return"Profiler";case Tv:return"StrictMode";case ag:return"Suspense";case lg:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case hC:return(t.displayName||"Context")+".Consumer";case fC:return(t._context.displayName||"Context")+".Provider";case _v:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Rv:return e=t.displayName||null,e!==null?e:cg(t.type)||"Memo";case Oi:e=t._payload,t=t._init;try{return cg(t(e))}catch{}}return null}function FM(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return cg(e);case 8:return e===Tv?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Co(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function mC(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function BM(t){var e=mC(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,o=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(s){r=""+s,o.call(this,s)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(s){r=""+s},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function sd(t){t._valueTracker||(t._valueTracker=BM(t))}function gC(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=mC(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function yf(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function ug(t,e){var n=e.checked;return Ve({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Jx(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Co(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function yC(t,e){e=e.checked,e!=null&&Ev(t,"checked",e,!1)}function dg(t,e){yC(t,e);var n=Co(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?fg(t,e.type,n):e.hasOwnProperty("defaultValue")&&fg(t,e.type,Co(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Yx(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function fg(t,e,n){(e!=="number"||yf(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var oc=Array.isArray;function Oa(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Co(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function hg(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(z(91));return Ve({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Qx(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(z(92));if(oc(n)){if(1<n.length)throw Error(z(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Co(n)}}function vC(t,e){var n=Co(e.value),r=Co(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Xx(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function xC(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function pg(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?xC(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var ad,wC=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(ad=ad||document.createElement("div"),ad.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=ad.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Nc(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var mc={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},zM=["Webkit","ms","Moz","O"];Object.keys(mc).forEach(function(t){zM.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),mc[e]=mc[t]})});function bC(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||mc.hasOwnProperty(t)&&mc[t]?(""+e).trim():e+"px"}function SC(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=bC(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var VM=Ve({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function mg(t,e){if(e){if(VM[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(z(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(z(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(z(61))}if(e.style!=null&&typeof e.style!="object")throw Error(z(62))}}function gg(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var yg=null;function Ov(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var vg=null,Pa=null,Ma=null;function Zx(t){if(t=Au(t)){if(typeof vg!="function")throw Error(z(280));var e=t.stateNode;e&&(e=Rh(e),vg(t.stateNode,t.type,e))}}function CC(t){Pa?Ma?Ma.push(t):Ma=[t]:Pa=t}function kC(){if(Pa){var t=Pa,e=Ma;if(Ma=Pa=null,Zx(t),e)for(t=0;t<e.length;t++)Zx(e[t])}}function EC(t,e){return t(e)}function TC(){}var Fp=!1;function _C(t,e,n){if(Fp)return t(e,n);Fp=!0;try{return EC(t,e,n)}finally{Fp=!1,(Pa!==null||Ma!==null)&&(TC(),kC())}}function Dc(t,e){var n=t.stateNode;if(n===null)return null;var r=Rh(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(z(231,e,typeof n));return n}var xg=!1;if(li)try{var Kl={};Object.defineProperty(Kl,"passive",{get:function(){xg=!0}}),window.addEventListener("test",Kl,Kl),window.removeEventListener("test",Kl,Kl)}catch{xg=!1}function UM(t,e,n,r,i,o,s,a,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(n,c)}catch(u){this.onError(u)}}var gc=!1,vf=null,xf=!1,wg=null,HM={onError:function(t){gc=!0,vf=t}};function WM(t,e,n,r,i,o,s,a,l){gc=!1,vf=null,UM.apply(HM,arguments)}function KM(t,e,n,r,i,o,s,a,l){if(WM.apply(this,arguments),gc){if(gc){var c=vf;gc=!1,vf=null}else throw Error(z(198));xf||(xf=!0,wg=c)}}function zs(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function RC(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function ew(t){if(zs(t)!==t)throw Error(z(188))}function qM(t){var e=t.alternate;if(!e){if(e=zs(t),e===null)throw Error(z(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var o=i.alternate;if(o===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===n)return ew(i),t;if(o===r)return ew(i),e;o=o.sibling}throw Error(z(188))}if(n.return!==r.return)n=i,r=o;else{for(var s=!1,a=i.child;a;){if(a===n){s=!0,n=i,r=o;break}if(a===r){s=!0,r=i,n=o;break}a=a.sibling}if(!s){for(a=o.child;a;){if(a===n){s=!0,n=o,r=i;break}if(a===r){s=!0,r=o,n=i;break}a=a.sibling}if(!s)throw Error(z(189))}}if(n.alternate!==r)throw Error(z(190))}if(n.tag!==3)throw Error(z(188));return n.stateNode.current===n?t:e}function OC(t){return t=qM(t),t!==null?PC(t):null}function PC(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=PC(t);if(e!==null)return e;t=t.sibling}return null}var MC=kn.unstable_scheduleCallback,tw=kn.unstable_cancelCallback,GM=kn.unstable_shouldYield,JM=kn.unstable_requestPaint,Ge=kn.unstable_now,YM=kn.unstable_getCurrentPriorityLevel,Pv=kn.unstable_ImmediatePriority,IC=kn.unstable_UserBlockingPriority,wf=kn.unstable_NormalPriority,QM=kn.unstable_LowPriority,AC=kn.unstable_IdlePriority,kh=null,Ar=null;function XM(t){if(Ar&&typeof Ar.onCommitFiberRoot=="function")try{Ar.onCommitFiberRoot(kh,t,void 0,(t.current.flags&128)===128)}catch{}}var ar=Math.clz32?Math.clz32:tI,ZM=Math.log,eI=Math.LN2;function tI(t){return t>>>=0,t===0?32:31-(ZM(t)/eI|0)|0}var ld=64,cd=4194304;function sc(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function bf(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,o=t.pingedLanes,s=n&268435455;if(s!==0){var a=s&~i;a!==0?r=sc(a):(o&=s,o!==0&&(r=sc(o)))}else s=n&~i,s!==0?r=sc(s):o!==0&&(r=sc(o));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,o=e&-e,i>=o||i===16&&(o&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-ar(e),i=1<<n,r|=t[n],e&=~i;return r}function nI(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function rI(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,o=t.pendingLanes;0<o;){var s=31-ar(o),a=1<<s,l=i[s];l===-1?(!(a&n)||a&r)&&(i[s]=nI(a,e)):l<=e&&(t.expiredLanes|=a),o&=~a}}function bg(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function NC(){var t=ld;return ld<<=1,!(ld&4194240)&&(ld=64),t}function Bp(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Mu(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-ar(e),t[e]=n}function iI(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-ar(n),o=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~o}}function Mv(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-ar(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var ke=0;function DC(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var jC,Iv,LC,$C,FC,Sg=!1,ud=[],lo=null,co=null,uo=null,jc=new Map,Lc=new Map,Hi=[],oI="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function nw(t,e){switch(t){case"focusin":case"focusout":lo=null;break;case"dragenter":case"dragleave":co=null;break;case"mouseover":case"mouseout":uo=null;break;case"pointerover":case"pointerout":jc.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Lc.delete(e.pointerId)}}function ql(t,e,n,r,i,o){return t===null||t.nativeEvent!==o?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[i]},e!==null&&(e=Au(e),e!==null&&Iv(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function sI(t,e,n,r,i){switch(e){case"focusin":return lo=ql(lo,t,e,n,r,i),!0;case"dragenter":return co=ql(co,t,e,n,r,i),!0;case"mouseover":return uo=ql(uo,t,e,n,r,i),!0;case"pointerover":var o=i.pointerId;return jc.set(o,ql(jc.get(o)||null,t,e,n,r,i)),!0;case"gotpointercapture":return o=i.pointerId,Lc.set(o,ql(Lc.get(o)||null,t,e,n,r,i)),!0}return!1}function BC(t){var e=es(t.target);if(e!==null){var n=zs(e);if(n!==null){if(e=n.tag,e===13){if(e=RC(n),e!==null){t.blockedOn=e,FC(t.priority,function(){LC(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Jd(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Cg(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);yg=r,n.target.dispatchEvent(r),yg=null}else return e=Au(n),e!==null&&Iv(e),t.blockedOn=n,!1;e.shift()}return!0}function rw(t,e,n){Jd(t)&&n.delete(e)}function aI(){Sg=!1,lo!==null&&Jd(lo)&&(lo=null),co!==null&&Jd(co)&&(co=null),uo!==null&&Jd(uo)&&(uo=null),jc.forEach(rw),Lc.forEach(rw)}function Gl(t,e){t.blockedOn===e&&(t.blockedOn=null,Sg||(Sg=!0,kn.unstable_scheduleCallback(kn.unstable_NormalPriority,aI)))}function $c(t){function e(i){return Gl(i,t)}if(0<ud.length){Gl(ud[0],t);for(var n=1;n<ud.length;n++){var r=ud[n];r.blockedOn===t&&(r.blockedOn=null)}}for(lo!==null&&Gl(lo,t),co!==null&&Gl(co,t),uo!==null&&Gl(uo,t),jc.forEach(e),Lc.forEach(e),n=0;n<Hi.length;n++)r=Hi[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Hi.length&&(n=Hi[0],n.blockedOn===null);)BC(n),n.blockedOn===null&&Hi.shift()}var Ia=mi.ReactCurrentBatchConfig,Sf=!0;function lI(t,e,n,r){var i=ke,o=Ia.transition;Ia.transition=null;try{ke=1,Av(t,e,n,r)}finally{ke=i,Ia.transition=o}}function cI(t,e,n,r){var i=ke,o=Ia.transition;Ia.transition=null;try{ke=4,Av(t,e,n,r)}finally{ke=i,Ia.transition=o}}function Av(t,e,n,r){if(Sf){var i=Cg(t,e,n,r);if(i===null)Yp(t,e,r,Cf,n),nw(t,r);else if(sI(i,t,e,n,r))r.stopPropagation();else if(nw(t,r),e&4&&-1<oI.indexOf(t)){for(;i!==null;){var o=Au(i);if(o!==null&&jC(o),o=Cg(t,e,n,r),o===null&&Yp(t,e,r,Cf,n),o===i)break;i=o}i!==null&&r.stopPropagation()}else Yp(t,e,r,null,n)}}var Cf=null;function Cg(t,e,n,r){if(Cf=null,t=Ov(r),t=es(t),t!==null)if(e=zs(t),e===null)t=null;else if(n=e.tag,n===13){if(t=RC(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Cf=t,null}function zC(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(YM()){case Pv:return 1;case IC:return 4;case wf:case QM:return 16;case AC:return 536870912;default:return 16}default:return 16}}var ro=null,Nv=null,Yd=null;function VC(){if(Yd)return Yd;var t,e=Nv,n=e.length,r,i="value"in ro?ro.value:ro.textContent,o=i.length;for(t=0;t<n&&e[t]===i[t];t++);var s=n-t;for(r=1;r<=s&&e[n-r]===i[o-r];r++);return Yd=i.slice(t,1<r?1-r:void 0)}function Qd(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function dd(){return!0}function iw(){return!1}function _n(t){function e(n,r,i,o,s){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=o,this.target=s,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(o):o[a]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?dd:iw,this.isPropagationStopped=iw,this}return Ve(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=dd)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=dd)},persist:function(){},isPersistent:dd}),e}var Rl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Dv=_n(Rl),Iu=Ve({},Rl,{view:0,detail:0}),uI=_n(Iu),zp,Vp,Jl,Eh=Ve({},Iu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:jv,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Jl&&(Jl&&t.type==="mousemove"?(zp=t.screenX-Jl.screenX,Vp=t.screenY-Jl.screenY):Vp=zp=0,Jl=t),zp)},movementY:function(t){return"movementY"in t?t.movementY:Vp}}),ow=_n(Eh),dI=Ve({},Eh,{dataTransfer:0}),fI=_n(dI),hI=Ve({},Iu,{relatedTarget:0}),Up=_n(hI),pI=Ve({},Rl,{animationName:0,elapsedTime:0,pseudoElement:0}),mI=_n(pI),gI=Ve({},Rl,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),yI=_n(gI),vI=Ve({},Rl,{data:0}),sw=_n(vI),xI={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},wI={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},bI={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function SI(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=bI[t])?!!e[t]:!1}function jv(){return SI}var CI=Ve({},Iu,{key:function(t){if(t.key){var e=xI[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Qd(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?wI[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:jv,charCode:function(t){return t.type==="keypress"?Qd(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Qd(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),kI=_n(CI),EI=Ve({},Eh,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),aw=_n(EI),TI=Ve({},Iu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:jv}),_I=_n(TI),RI=Ve({},Rl,{propertyName:0,elapsedTime:0,pseudoElement:0}),OI=_n(RI),PI=Ve({},Eh,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),MI=_n(PI),II=[9,13,27,32],Lv=li&&"CompositionEvent"in window,yc=null;li&&"documentMode"in document&&(yc=document.documentMode);var AI=li&&"TextEvent"in window&&!yc,UC=li&&(!Lv||yc&&8<yc&&11>=yc),lw=String.fromCharCode(32),cw=!1;function HC(t,e){switch(t){case"keyup":return II.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function WC(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var ga=!1;function NI(t,e){switch(t){case"compositionend":return WC(e);case"keypress":return e.which!==32?null:(cw=!0,lw);case"textInput":return t=e.data,t===lw&&cw?null:t;default:return null}}function DI(t,e){if(ga)return t==="compositionend"||!Lv&&HC(t,e)?(t=VC(),Yd=Nv=ro=null,ga=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return UC&&e.locale!=="ko"?null:e.data;default:return null}}var jI={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function uw(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!jI[t.type]:e==="textarea"}function KC(t,e,n,r){CC(r),e=kf(e,"onChange"),0<e.length&&(n=new Dv("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var vc=null,Fc=null;function LI(t){rk(t,0)}function Th(t){var e=xa(t);if(gC(e))return t}function $I(t,e){if(t==="change")return e}var qC=!1;if(li){var Hp;if(li){var Wp="oninput"in document;if(!Wp){var dw=document.createElement("div");dw.setAttribute("oninput","return;"),Wp=typeof dw.oninput=="function"}Hp=Wp}else Hp=!1;qC=Hp&&(!document.documentMode||9<document.documentMode)}function fw(){vc&&(vc.detachEvent("onpropertychange",GC),Fc=vc=null)}function GC(t){if(t.propertyName==="value"&&Th(Fc)){var e=[];KC(e,Fc,t,Ov(t)),_C(LI,e)}}function FI(t,e,n){t==="focusin"?(fw(),vc=e,Fc=n,vc.attachEvent("onpropertychange",GC)):t==="focusout"&&fw()}function BI(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Th(Fc)}function zI(t,e){if(t==="click")return Th(e)}function VI(t,e){if(t==="input"||t==="change")return Th(e)}function UI(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var cr=typeof Object.is=="function"?Object.is:UI;function Bc(t,e){if(cr(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!og.call(e,i)||!cr(t[i],e[i]))return!1}return!0}function hw(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function pw(t,e){var n=hw(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=hw(n)}}function JC(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?JC(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function YC(){for(var t=window,e=yf();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=yf(t.document)}return e}function $v(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function HI(t){var e=YC(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&JC(n.ownerDocument.documentElement,n)){if(r!==null&&$v(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,o=Math.min(r.start,i);r=r.end===void 0?o:Math.min(r.end,i),!t.extend&&o>r&&(i=r,r=o,o=i),i=pw(n,o);var s=pw(n,r);i&&s&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==s.node||t.focusOffset!==s.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),o>r?(t.addRange(e),t.extend(s.node,s.offset)):(e.setEnd(s.node,s.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var WI=li&&"documentMode"in document&&11>=document.documentMode,ya=null,kg=null,xc=null,Eg=!1;function mw(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Eg||ya==null||ya!==yf(r)||(r=ya,"selectionStart"in r&&$v(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),xc&&Bc(xc,r)||(xc=r,r=kf(kg,"onSelect"),0<r.length&&(e=new Dv("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=ya)))}function fd(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var va={animationend:fd("Animation","AnimationEnd"),animationiteration:fd("Animation","AnimationIteration"),animationstart:fd("Animation","AnimationStart"),transitionend:fd("Transition","TransitionEnd")},Kp={},QC={};li&&(QC=document.createElement("div").style,"AnimationEvent"in window||(delete va.animationend.animation,delete va.animationiteration.animation,delete va.animationstart.animation),"TransitionEvent"in window||delete va.transitionend.transition);function _h(t){if(Kp[t])return Kp[t];if(!va[t])return t;var e=va[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in QC)return Kp[t]=e[n];return t}var XC=_h("animationend"),ZC=_h("animationiteration"),ek=_h("animationstart"),tk=_h("transitionend"),nk=new Map,gw="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Io(t,e){nk.set(t,e),Bs(e,[t])}for(var qp=0;qp<gw.length;qp++){var Gp=gw[qp],KI=Gp.toLowerCase(),qI=Gp[0].toUpperCase()+Gp.slice(1);Io(KI,"on"+qI)}Io(XC,"onAnimationEnd");Io(ZC,"onAnimationIteration");Io(ek,"onAnimationStart");Io("dblclick","onDoubleClick");Io("focusin","onFocus");Io("focusout","onBlur");Io(tk,"onTransitionEnd");nl("onMouseEnter",["mouseout","mouseover"]);nl("onMouseLeave",["mouseout","mouseover"]);nl("onPointerEnter",["pointerout","pointerover"]);nl("onPointerLeave",["pointerout","pointerover"]);Bs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Bs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Bs("onBeforeInput",["compositionend","keypress","textInput","paste"]);Bs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Bs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Bs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ac="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),GI=new Set("cancel close invalid load scroll toggle".split(" ").concat(ac));function yw(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,KM(r,e,void 0,t),t.currentTarget=null}function rk(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var o=void 0;if(e)for(var s=r.length-1;0<=s;s--){var a=r[s],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==o&&i.isPropagationStopped())break e;yw(i,a,c),o=l}else for(s=0;s<r.length;s++){if(a=r[s],l=a.instance,c=a.currentTarget,a=a.listener,l!==o&&i.isPropagationStopped())break e;yw(i,a,c),o=l}}}if(xf)throw t=wg,xf=!1,wg=null,t}function De(t,e){var n=e[Pg];n===void 0&&(n=e[Pg]=new Set);var r=t+"__bubble";n.has(r)||(ik(e,t,2,!1),n.add(r))}function Jp(t,e,n){var r=0;e&&(r|=4),ik(n,t,r,e)}var hd="_reactListening"+Math.random().toString(36).slice(2);function zc(t){if(!t[hd]){t[hd]=!0,dC.forEach(function(n){n!=="selectionchange"&&(GI.has(n)||Jp(n,!1,t),Jp(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[hd]||(e[hd]=!0,Jp("selectionchange",!1,e))}}function ik(t,e,n,r){switch(zC(e)){case 1:var i=lI;break;case 4:i=cI;break;default:i=Av}n=i.bind(null,e,n,t),i=void 0,!xg||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function Yp(t,e,n,r,i){var o=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var s=r.tag;if(s===3||s===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(s===4)for(s=r.return;s!==null;){var l=s.tag;if((l===3||l===4)&&(l=s.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;s=s.return}for(;a!==null;){if(s=es(a),s===null)return;if(l=s.tag,l===5||l===6){r=o=s;continue e}a=a.parentNode}}r=r.return}_C(function(){var c=o,u=Ov(n),d=[];e:{var h=nk.get(t);if(h!==void 0){var p=Dv,m=t;switch(t){case"keypress":if(Qd(n)===0)break e;case"keydown":case"keyup":p=kI;break;case"focusin":m="focus",p=Up;break;case"focusout":m="blur",p=Up;break;case"beforeblur":case"afterblur":p=Up;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=ow;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=fI;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=_I;break;case XC:case ZC:case ek:p=mI;break;case tk:p=OI;break;case"scroll":p=uI;break;case"wheel":p=MI;break;case"copy":case"cut":case"paste":p=yI;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=aw}var y=(e&4)!==0,v=!y&&t==="scroll",x=y?h!==null?h+"Capture":null:h;y=[];for(var w=c,b;w!==null;){b=w;var S=b.stateNode;if(b.tag===5&&S!==null&&(b=S,x!==null&&(S=Dc(w,x),S!=null&&y.push(Vc(w,S,b)))),v)break;w=w.return}0<y.length&&(h=new p(h,m,null,n,u),d.push({event:h,listeners:y}))}}if(!(e&7)){e:{if(h=t==="mouseover"||t==="pointerover",p=t==="mouseout"||t==="pointerout",h&&n!==yg&&(m=n.relatedTarget||n.fromElement)&&(es(m)||m[ci]))break e;if((p||h)&&(h=u.window===u?u:(h=u.ownerDocument)?h.defaultView||h.parentWindow:window,p?(m=n.relatedTarget||n.toElement,p=c,m=m?es(m):null,m!==null&&(v=zs(m),m!==v||m.tag!==5&&m.tag!==6)&&(m=null)):(p=null,m=c),p!==m)){if(y=ow,S="onMouseLeave",x="onMouseEnter",w="mouse",(t==="pointerout"||t==="pointerover")&&(y=aw,S="onPointerLeave",x="onPointerEnter",w="pointer"),v=p==null?h:xa(p),b=m==null?h:xa(m),h=new y(S,w+"leave",p,n,u),h.target=v,h.relatedTarget=b,S=null,es(u)===c&&(y=new y(x,w+"enter",m,n,u),y.target=b,y.relatedTarget=v,S=y),v=S,p&&m)t:{for(y=p,x=m,w=0,b=y;b;b=Qs(b))w++;for(b=0,S=x;S;S=Qs(S))b++;for(;0<w-b;)y=Qs(y),w--;for(;0<b-w;)x=Qs(x),b--;for(;w--;){if(y===x||x!==null&&y===x.alternate)break t;y=Qs(y),x=Qs(x)}y=null}else y=null;p!==null&&vw(d,h,p,y,!1),m!==null&&v!==null&&vw(d,v,m,y,!0)}}e:{if(h=c?xa(c):window,p=h.nodeName&&h.nodeName.toLowerCase(),p==="select"||p==="input"&&h.type==="file")var C=$I;else if(uw(h))if(qC)C=VI;else{C=BI;var k=FI}else(p=h.nodeName)&&p.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(C=zI);if(C&&(C=C(t,c))){KC(d,C,n,u);break e}k&&k(t,h,c),t==="focusout"&&(k=h._wrapperState)&&k.controlled&&h.type==="number"&&fg(h,"number",h.value)}switch(k=c?xa(c):window,t){case"focusin":(uw(k)||k.contentEditable==="true")&&(ya=k,kg=c,xc=null);break;case"focusout":xc=kg=ya=null;break;case"mousedown":Eg=!0;break;case"contextmenu":case"mouseup":case"dragend":Eg=!1,mw(d,n,u);break;case"selectionchange":if(WI)break;case"keydown":case"keyup":mw(d,n,u)}var E;if(Lv)e:{switch(t){case"compositionstart":var T="onCompositionStart";break e;case"compositionend":T="onCompositionEnd";break e;case"compositionupdate":T="onCompositionUpdate";break e}T=void 0}else ga?HC(t,n)&&(T="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(T="onCompositionStart");T&&(UC&&n.locale!=="ko"&&(ga||T!=="onCompositionStart"?T==="onCompositionEnd"&&ga&&(E=VC()):(ro=u,Nv="value"in ro?ro.value:ro.textContent,ga=!0)),k=kf(c,T),0<k.length&&(T=new sw(T,t,null,n,u),d.push({event:T,listeners:k}),E?T.data=E:(E=WC(n),E!==null&&(T.data=E)))),(E=AI?NI(t,n):DI(t,n))&&(c=kf(c,"onBeforeInput"),0<c.length&&(u=new sw("onBeforeInput","beforeinput",null,n,u),d.push({event:u,listeners:c}),u.data=E))}rk(d,e)})}function Vc(t,e,n){return{instance:t,listener:e,currentTarget:n}}function kf(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,o=i.stateNode;i.tag===5&&o!==null&&(i=o,o=Dc(t,n),o!=null&&r.unshift(Vc(t,o,i)),o=Dc(t,e),o!=null&&r.push(Vc(t,o,i))),t=t.return}return r}function Qs(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function vw(t,e,n,r,i){for(var o=e._reactName,s=[];n!==null&&n!==r;){var a=n,l=a.alternate,c=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&c!==null&&(a=c,i?(l=Dc(n,o),l!=null&&s.unshift(Vc(n,l,a))):i||(l=Dc(n,o),l!=null&&s.push(Vc(n,l,a)))),n=n.return}s.length!==0&&t.push({event:e,listeners:s})}var JI=/\r\n?/g,YI=/\u0000|\uFFFD/g;function xw(t){return(typeof t=="string"?t:""+t).replace(JI,`
`).replace(YI,"")}function pd(t,e,n){if(e=xw(e),xw(t)!==e&&n)throw Error(z(425))}function Ef(){}var Tg=null,_g=null;function Rg(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Og=typeof setTimeout=="function"?setTimeout:void 0,QI=typeof clearTimeout=="function"?clearTimeout:void 0,ww=typeof Promise=="function"?Promise:void 0,XI=typeof queueMicrotask=="function"?queueMicrotask:typeof ww<"u"?function(t){return ww.resolve(null).then(t).catch(ZI)}:Og;function ZI(t){setTimeout(function(){throw t})}function Qp(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),$c(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);$c(e)}function fo(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function bw(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Ol=Math.random().toString(36).slice(2),Or="__reactFiber$"+Ol,Uc="__reactProps$"+Ol,ci="__reactContainer$"+Ol,Pg="__reactEvents$"+Ol,eA="__reactListeners$"+Ol,tA="__reactHandles$"+Ol;function es(t){var e=t[Or];if(e)return e;for(var n=t.parentNode;n;){if(e=n[ci]||n[Or]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=bw(t);t!==null;){if(n=t[Or])return n;t=bw(t)}return e}t=n,n=t.parentNode}return null}function Au(t){return t=t[Or]||t[ci],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function xa(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(z(33))}function Rh(t){return t[Uc]||null}var Mg=[],wa=-1;function Ao(t){return{current:t}}function je(t){0>wa||(t.current=Mg[wa],Mg[wa]=null,wa--)}function Ae(t,e){wa++,Mg[wa]=t.current,t.current=e}var ko={},Rt=Ao(ko),ln=Ao(!1),ks=ko;function rl(t,e){var n=t.type.contextTypes;if(!n)return ko;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},o;for(o in n)i[o]=e[o];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function cn(t){return t=t.childContextTypes,t!=null}function Tf(){je(ln),je(Rt)}function Sw(t,e,n){if(Rt.current!==ko)throw Error(z(168));Ae(Rt,e),Ae(ln,n)}function ok(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(z(108,FM(t)||"Unknown",i));return Ve({},n,r)}function _f(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||ko,ks=Rt.current,Ae(Rt,t),Ae(ln,ln.current),!0}function Cw(t,e,n){var r=t.stateNode;if(!r)throw Error(z(169));n?(t=ok(t,e,ks),r.__reactInternalMemoizedMergedChildContext=t,je(ln),je(Rt),Ae(Rt,t)):je(ln),Ae(ln,n)}var Xr=null,Oh=!1,Xp=!1;function sk(t){Xr===null?Xr=[t]:Xr.push(t)}function nA(t){Oh=!0,sk(t)}function No(){if(!Xp&&Xr!==null){Xp=!0;var t=0,e=ke;try{var n=Xr;for(ke=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Xr=null,Oh=!1}catch(i){throw Xr!==null&&(Xr=Xr.slice(t+1)),MC(Pv,No),i}finally{ke=e,Xp=!1}}return null}var ba=[],Sa=0,Rf=null,Of=0,An=[],Nn=0,Es=null,ti=1,ni="";function Ko(t,e){ba[Sa++]=Of,ba[Sa++]=Rf,Rf=t,Of=e}function ak(t,e,n){An[Nn++]=ti,An[Nn++]=ni,An[Nn++]=Es,Es=t;var r=ti;t=ni;var i=32-ar(r)-1;r&=~(1<<i),n+=1;var o=32-ar(e)+i;if(30<o){var s=i-i%5;o=(r&(1<<s)-1).toString(32),r>>=s,i-=s,ti=1<<32-ar(e)+i|n<<i|r,ni=o+t}else ti=1<<o|n<<i|r,ni=t}function Fv(t){t.return!==null&&(Ko(t,1),ak(t,1,0))}function Bv(t){for(;t===Rf;)Rf=ba[--Sa],ba[Sa]=null,Of=ba[--Sa],ba[Sa]=null;for(;t===Es;)Es=An[--Nn],An[Nn]=null,ni=An[--Nn],An[Nn]=null,ti=An[--Nn],An[Nn]=null}var Sn=null,bn=null,$e=!1,ir=null;function lk(t,e){var n=jn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function kw(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Sn=t,bn=fo(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Sn=t,bn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Es!==null?{id:ti,overflow:ni}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=jn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Sn=t,bn=null,!0):!1;default:return!1}}function Ig(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Ag(t){if($e){var e=bn;if(e){var n=e;if(!kw(t,e)){if(Ig(t))throw Error(z(418));e=fo(n.nextSibling);var r=Sn;e&&kw(t,e)?lk(r,n):(t.flags=t.flags&-4097|2,$e=!1,Sn=t)}}else{if(Ig(t))throw Error(z(418));t.flags=t.flags&-4097|2,$e=!1,Sn=t}}}function Ew(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Sn=t}function md(t){if(t!==Sn)return!1;if(!$e)return Ew(t),$e=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Rg(t.type,t.memoizedProps)),e&&(e=bn)){if(Ig(t))throw ck(),Error(z(418));for(;e;)lk(t,e),e=fo(e.nextSibling)}if(Ew(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(z(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){bn=fo(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}bn=null}}else bn=Sn?fo(t.stateNode.nextSibling):null;return!0}function ck(){for(var t=bn;t;)t=fo(t.nextSibling)}function il(){bn=Sn=null,$e=!1}function zv(t){ir===null?ir=[t]:ir.push(t)}var rA=mi.ReactCurrentBatchConfig;function Yl(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(z(309));var r=n.stateNode}if(!r)throw Error(z(147,t));var i=r,o=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===o?e.ref:(e=function(s){var a=i.refs;s===null?delete a[o]:a[o]=s},e._stringRef=o,e)}if(typeof t!="string")throw Error(z(284));if(!n._owner)throw Error(z(290,t))}return t}function gd(t,e){throw t=Object.prototype.toString.call(e),Error(z(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Tw(t){var e=t._init;return e(t._payload)}function uk(t){function e(x,w){if(t){var b=x.deletions;b===null?(x.deletions=[w],x.flags|=16):b.push(w)}}function n(x,w){if(!t)return null;for(;w!==null;)e(x,w),w=w.sibling;return null}function r(x,w){for(x=new Map;w!==null;)w.key!==null?x.set(w.key,w):x.set(w.index,w),w=w.sibling;return x}function i(x,w){return x=go(x,w),x.index=0,x.sibling=null,x}function o(x,w,b){return x.index=b,t?(b=x.alternate,b!==null?(b=b.index,b<w?(x.flags|=2,w):b):(x.flags|=2,w)):(x.flags|=1048576,w)}function s(x){return t&&x.alternate===null&&(x.flags|=2),x}function a(x,w,b,S){return w===null||w.tag!==6?(w=om(b,x.mode,S),w.return=x,w):(w=i(w,b),w.return=x,w)}function l(x,w,b,S){var C=b.type;return C===ma?u(x,w,b.props.children,S,b.key):w!==null&&(w.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===Oi&&Tw(C)===w.type)?(S=i(w,b.props),S.ref=Yl(x,w,b),S.return=x,S):(S=of(b.type,b.key,b.props,null,x.mode,S),S.ref=Yl(x,w,b),S.return=x,S)}function c(x,w,b,S){return w===null||w.tag!==4||w.stateNode.containerInfo!==b.containerInfo||w.stateNode.implementation!==b.implementation?(w=sm(b,x.mode,S),w.return=x,w):(w=i(w,b.children||[]),w.return=x,w)}function u(x,w,b,S,C){return w===null||w.tag!==7?(w=gs(b,x.mode,S,C),w.return=x,w):(w=i(w,b),w.return=x,w)}function d(x,w,b){if(typeof w=="string"&&w!==""||typeof w=="number")return w=om(""+w,x.mode,b),w.return=x,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case od:return b=of(w.type,w.key,w.props,null,x.mode,b),b.ref=Yl(x,null,w),b.return=x,b;case pa:return w=sm(w,x.mode,b),w.return=x,w;case Oi:var S=w._init;return d(x,S(w._payload),b)}if(oc(w)||Wl(w))return w=gs(w,x.mode,b,null),w.return=x,w;gd(x,w)}return null}function h(x,w,b,S){var C=w!==null?w.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return C!==null?null:a(x,w,""+b,S);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case od:return b.key===C?l(x,w,b,S):null;case pa:return b.key===C?c(x,w,b,S):null;case Oi:return C=b._init,h(x,w,C(b._payload),S)}if(oc(b)||Wl(b))return C!==null?null:u(x,w,b,S,null);gd(x,b)}return null}function p(x,w,b,S,C){if(typeof S=="string"&&S!==""||typeof S=="number")return x=x.get(b)||null,a(w,x,""+S,C);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case od:return x=x.get(S.key===null?b:S.key)||null,l(w,x,S,C);case pa:return x=x.get(S.key===null?b:S.key)||null,c(w,x,S,C);case Oi:var k=S._init;return p(x,w,b,k(S._payload),C)}if(oc(S)||Wl(S))return x=x.get(b)||null,u(w,x,S,C,null);gd(w,S)}return null}function m(x,w,b,S){for(var C=null,k=null,E=w,T=w=0,O=null;E!==null&&T<b.length;T++){E.index>T?(O=E,E=null):O=E.sibling;var _=h(x,E,b[T],S);if(_===null){E===null&&(E=O);break}t&&E&&_.alternate===null&&e(x,E),w=o(_,w,T),k===null?C=_:k.sibling=_,k=_,E=O}if(T===b.length)return n(x,E),$e&&Ko(x,T),C;if(E===null){for(;T<b.length;T++)E=d(x,b[T],S),E!==null&&(w=o(E,w,T),k===null?C=E:k.sibling=E,k=E);return $e&&Ko(x,T),C}for(E=r(x,E);T<b.length;T++)O=p(E,x,T,b[T],S),O!==null&&(t&&O.alternate!==null&&E.delete(O.key===null?T:O.key),w=o(O,w,T),k===null?C=O:k.sibling=O,k=O);return t&&E.forEach(function(D){return e(x,D)}),$e&&Ko(x,T),C}function y(x,w,b,S){var C=Wl(b);if(typeof C!="function")throw Error(z(150));if(b=C.call(b),b==null)throw Error(z(151));for(var k=C=null,E=w,T=w=0,O=null,_=b.next();E!==null&&!_.done;T++,_=b.next()){E.index>T?(O=E,E=null):O=E.sibling;var D=h(x,E,_.value,S);if(D===null){E===null&&(E=O);break}t&&E&&D.alternate===null&&e(x,E),w=o(D,w,T),k===null?C=D:k.sibling=D,k=D,E=O}if(_.done)return n(x,E),$e&&Ko(x,T),C;if(E===null){for(;!_.done;T++,_=b.next())_=d(x,_.value,S),_!==null&&(w=o(_,w,T),k===null?C=_:k.sibling=_,k=_);return $e&&Ko(x,T),C}for(E=r(x,E);!_.done;T++,_=b.next())_=p(E,x,T,_.value,S),_!==null&&(t&&_.alternate!==null&&E.delete(_.key===null?T:_.key),w=o(_,w,T),k===null?C=_:k.sibling=_,k=_);return t&&E.forEach(function(L){return e(x,L)}),$e&&Ko(x,T),C}function v(x,w,b,S){if(typeof b=="object"&&b!==null&&b.type===ma&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case od:e:{for(var C=b.key,k=w;k!==null;){if(k.key===C){if(C=b.type,C===ma){if(k.tag===7){n(x,k.sibling),w=i(k,b.props.children),w.return=x,x=w;break e}}else if(k.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===Oi&&Tw(C)===k.type){n(x,k.sibling),w=i(k,b.props),w.ref=Yl(x,k,b),w.return=x,x=w;break e}n(x,k);break}else e(x,k);k=k.sibling}b.type===ma?(w=gs(b.props.children,x.mode,S,b.key),w.return=x,x=w):(S=of(b.type,b.key,b.props,null,x.mode,S),S.ref=Yl(x,w,b),S.return=x,x=S)}return s(x);case pa:e:{for(k=b.key;w!==null;){if(w.key===k)if(w.tag===4&&w.stateNode.containerInfo===b.containerInfo&&w.stateNode.implementation===b.implementation){n(x,w.sibling),w=i(w,b.children||[]),w.return=x,x=w;break e}else{n(x,w);break}else e(x,w);w=w.sibling}w=sm(b,x.mode,S),w.return=x,x=w}return s(x);case Oi:return k=b._init,v(x,w,k(b._payload),S)}if(oc(b))return m(x,w,b,S);if(Wl(b))return y(x,w,b,S);gd(x,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,w!==null&&w.tag===6?(n(x,w.sibling),w=i(w,b),w.return=x,x=w):(n(x,w),w=om(b,x.mode,S),w.return=x,x=w),s(x)):n(x,w)}return v}var ol=uk(!0),dk=uk(!1),Pf=Ao(null),Mf=null,Ca=null,Vv=null;function Uv(){Vv=Ca=Mf=null}function Hv(t){var e=Pf.current;je(Pf),t._currentValue=e}function Ng(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Aa(t,e){Mf=t,Vv=Ca=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(on=!0),t.firstContext=null)}function Un(t){var e=t._currentValue;if(Vv!==t)if(t={context:t,memoizedValue:e,next:null},Ca===null){if(Mf===null)throw Error(z(308));Ca=t,Mf.dependencies={lanes:0,firstContext:t}}else Ca=Ca.next=t;return e}var ts=null;function Wv(t){ts===null?ts=[t]:ts.push(t)}function fk(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,Wv(e)):(n.next=i.next,i.next=n),e.interleaved=n,ui(t,r)}function ui(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Pi=!1;function Kv(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function hk(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function oi(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function ho(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,we&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,ui(t,n)}return i=r.interleaved,i===null?(e.next=e,Wv(r)):(e.next=i.next,i.next=e),r.interleaved=e,ui(t,n)}function Xd(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Mv(t,n)}}function _w(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,o=null;if(n=n.firstBaseUpdate,n!==null){do{var s={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};o===null?i=o=s:o=o.next=s,n=n.next}while(n!==null);o===null?i=o=e:o=o.next=e}else i=o=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function If(t,e,n,r){var i=t.updateQueue;Pi=!1;var o=i.firstBaseUpdate,s=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var l=a,c=l.next;l.next=null,s===null?o=c:s.next=c,s=l;var u=t.alternate;u!==null&&(u=u.updateQueue,a=u.lastBaseUpdate,a!==s&&(a===null?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(o!==null){var d=i.baseState;s=0,u=c=l=null,a=o;do{var h=a.lane,p=a.eventTime;if((r&h)===h){u!==null&&(u=u.next={eventTime:p,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var m=t,y=a;switch(h=e,p=n,y.tag){case 1:if(m=y.payload,typeof m=="function"){d=m.call(p,d,h);break e}d=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=y.payload,h=typeof m=="function"?m.call(p,d,h):m,h==null)break e;d=Ve({},d,h);break e;case 2:Pi=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,h=i.effects,h===null?i.effects=[a]:h.push(a))}else p={eventTime:p,lane:h,tag:a.tag,payload:a.payload,callback:a.callback,next:null},u===null?(c=u=p,l=d):u=u.next=p,s|=h;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;h=a,a=h.next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}while(1);if(u===null&&(l=d),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=u,e=i.shared.interleaved,e!==null){i=e;do s|=i.lane,i=i.next;while(i!==e)}else o===null&&(i.shared.lanes=0);_s|=s,t.lanes=s,t.memoizedState=d}}function Rw(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(z(191,i));i.call(r)}}}var Nu={},Nr=Ao(Nu),Hc=Ao(Nu),Wc=Ao(Nu);function ns(t){if(t===Nu)throw Error(z(174));return t}function qv(t,e){switch(Ae(Wc,e),Ae(Hc,t),Ae(Nr,Nu),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:pg(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=pg(e,t)}je(Nr),Ae(Nr,e)}function sl(){je(Nr),je(Hc),je(Wc)}function pk(t){ns(Wc.current);var e=ns(Nr.current),n=pg(e,t.type);e!==n&&(Ae(Hc,t),Ae(Nr,n))}function Gv(t){Hc.current===t&&(je(Nr),je(Hc))}var Be=Ao(0);function Af(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Zp=[];function Jv(){for(var t=0;t<Zp.length;t++)Zp[t]._workInProgressVersionPrimary=null;Zp.length=0}var Zd=mi.ReactCurrentDispatcher,em=mi.ReactCurrentBatchConfig,Ts=0,ze=null,et=null,ot=null,Nf=!1,wc=!1,Kc=0,iA=0;function wt(){throw Error(z(321))}function Yv(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!cr(t[n],e[n]))return!1;return!0}function Qv(t,e,n,r,i,o){if(Ts=o,ze=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Zd.current=t===null||t.memoizedState===null?lA:cA,t=n(r,i),wc){o=0;do{if(wc=!1,Kc=0,25<=o)throw Error(z(301));o+=1,ot=et=null,e.updateQueue=null,Zd.current=uA,t=n(r,i)}while(wc)}if(Zd.current=Df,e=et!==null&&et.next!==null,Ts=0,ot=et=ze=null,Nf=!1,e)throw Error(z(300));return t}function Xv(){var t=Kc!==0;return Kc=0,t}function Cr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ot===null?ze.memoizedState=ot=t:ot=ot.next=t,ot}function Hn(){if(et===null){var t=ze.alternate;t=t!==null?t.memoizedState:null}else t=et.next;var e=ot===null?ze.memoizedState:ot.next;if(e!==null)ot=e,et=t;else{if(t===null)throw Error(z(310));et=t,t={memoizedState:et.memoizedState,baseState:et.baseState,baseQueue:et.baseQueue,queue:et.queue,next:null},ot===null?ze.memoizedState=ot=t:ot=ot.next=t}return ot}function qc(t,e){return typeof e=="function"?e(t):e}function tm(t){var e=Hn(),n=e.queue;if(n===null)throw Error(z(311));n.lastRenderedReducer=t;var r=et,i=r.baseQueue,o=n.pending;if(o!==null){if(i!==null){var s=i.next;i.next=o.next,o.next=s}r.baseQueue=i=o,n.pending=null}if(i!==null){o=i.next,r=r.baseState;var a=s=null,l=null,c=o;do{var u=c.lane;if((Ts&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:t(r,c.action);else{var d={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(a=l=d,s=r):l=l.next=d,ze.lanes|=u,_s|=u}c=c.next}while(c!==null&&c!==o);l===null?s=r:l.next=a,cr(r,e.memoizedState)||(on=!0),e.memoizedState=r,e.baseState=s,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do o=i.lane,ze.lanes|=o,_s|=o,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function nm(t){var e=Hn(),n=e.queue;if(n===null)throw Error(z(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,o=e.memoizedState;if(i!==null){n.pending=null;var s=i=i.next;do o=t(o,s.action),s=s.next;while(s!==i);cr(o,e.memoizedState)||(on=!0),e.memoizedState=o,e.baseQueue===null&&(e.baseState=o),n.lastRenderedState=o}return[o,r]}function mk(){}function gk(t,e){var n=ze,r=Hn(),i=e(),o=!cr(r.memoizedState,i);if(o&&(r.memoizedState=i,on=!0),r=r.queue,Zv(xk.bind(null,n,r,t),[t]),r.getSnapshot!==e||o||ot!==null&&ot.memoizedState.tag&1){if(n.flags|=2048,Gc(9,vk.bind(null,n,r,i,e),void 0,null),at===null)throw Error(z(349));Ts&30||yk(n,e,i)}return i}function yk(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=ze.updateQueue,e===null?(e={lastEffect:null,stores:null},ze.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function vk(t,e,n,r){e.value=n,e.getSnapshot=r,wk(e)&&bk(t)}function xk(t,e,n){return n(function(){wk(e)&&bk(t)})}function wk(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!cr(t,n)}catch{return!0}}function bk(t){var e=ui(t,1);e!==null&&lr(e,t,1,-1)}function Ow(t){var e=Cr();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:qc,lastRenderedState:t},e.queue=t,t=t.dispatch=aA.bind(null,ze,t),[e.memoizedState,t]}function Gc(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=ze.updateQueue,e===null?(e={lastEffect:null,stores:null},ze.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function Sk(){return Hn().memoizedState}function ef(t,e,n,r){var i=Cr();ze.flags|=t,i.memoizedState=Gc(1|e,n,void 0,r===void 0?null:r)}function Ph(t,e,n,r){var i=Hn();r=r===void 0?null:r;var o=void 0;if(et!==null){var s=et.memoizedState;if(o=s.destroy,r!==null&&Yv(r,s.deps)){i.memoizedState=Gc(e,n,o,r);return}}ze.flags|=t,i.memoizedState=Gc(1|e,n,o,r)}function Pw(t,e){return ef(8390656,8,t,e)}function Zv(t,e){return Ph(2048,8,t,e)}function Ck(t,e){return Ph(4,2,t,e)}function kk(t,e){return Ph(4,4,t,e)}function Ek(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Tk(t,e,n){return n=n!=null?n.concat([t]):null,Ph(4,4,Ek.bind(null,e,t),n)}function e0(){}function _k(t,e){var n=Hn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Yv(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function Rk(t,e){var n=Hn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Yv(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function Ok(t,e,n){return Ts&21?(cr(n,e)||(n=NC(),ze.lanes|=n,_s|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,on=!0),t.memoizedState=n)}function oA(t,e){var n=ke;ke=n!==0&&4>n?n:4,t(!0);var r=em.transition;em.transition={};try{t(!1),e()}finally{ke=n,em.transition=r}}function Pk(){return Hn().memoizedState}function sA(t,e,n){var r=mo(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Mk(t))Ik(e,n);else if(n=fk(t,e,n,r),n!==null){var i=Vt();lr(n,t,r,i),Ak(n,e,r)}}function aA(t,e,n){var r=mo(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Mk(t))Ik(e,i);else{var o=t.alternate;if(t.lanes===0&&(o===null||o.lanes===0)&&(o=e.lastRenderedReducer,o!==null))try{var s=e.lastRenderedState,a=o(s,n);if(i.hasEagerState=!0,i.eagerState=a,cr(a,s)){var l=e.interleaved;l===null?(i.next=i,Wv(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}n=fk(t,e,i,r),n!==null&&(i=Vt(),lr(n,t,r,i),Ak(n,e,r))}}function Mk(t){var e=t.alternate;return t===ze||e!==null&&e===ze}function Ik(t,e){wc=Nf=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function Ak(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Mv(t,n)}}var Df={readContext:Un,useCallback:wt,useContext:wt,useEffect:wt,useImperativeHandle:wt,useInsertionEffect:wt,useLayoutEffect:wt,useMemo:wt,useReducer:wt,useRef:wt,useState:wt,useDebugValue:wt,useDeferredValue:wt,useTransition:wt,useMutableSource:wt,useSyncExternalStore:wt,useId:wt,unstable_isNewReconciler:!1},lA={readContext:Un,useCallback:function(t,e){return Cr().memoizedState=[t,e===void 0?null:e],t},useContext:Un,useEffect:Pw,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,ef(4194308,4,Ek.bind(null,e,t),n)},useLayoutEffect:function(t,e){return ef(4194308,4,t,e)},useInsertionEffect:function(t,e){return ef(4,2,t,e)},useMemo:function(t,e){var n=Cr();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Cr();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=sA.bind(null,ze,t),[r.memoizedState,t]},useRef:function(t){var e=Cr();return t={current:t},e.memoizedState=t},useState:Ow,useDebugValue:e0,useDeferredValue:function(t){return Cr().memoizedState=t},useTransition:function(){var t=Ow(!1),e=t[0];return t=oA.bind(null,t[1]),Cr().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=ze,i=Cr();if($e){if(n===void 0)throw Error(z(407));n=n()}else{if(n=e(),at===null)throw Error(z(349));Ts&30||yk(r,e,n)}i.memoizedState=n;var o={value:n,getSnapshot:e};return i.queue=o,Pw(xk.bind(null,r,o,t),[t]),r.flags|=2048,Gc(9,vk.bind(null,r,o,n,e),void 0,null),n},useId:function(){var t=Cr(),e=at.identifierPrefix;if($e){var n=ni,r=ti;n=(r&~(1<<32-ar(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Kc++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=iA++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},cA={readContext:Un,useCallback:_k,useContext:Un,useEffect:Zv,useImperativeHandle:Tk,useInsertionEffect:Ck,useLayoutEffect:kk,useMemo:Rk,useReducer:tm,useRef:Sk,useState:function(){return tm(qc)},useDebugValue:e0,useDeferredValue:function(t){var e=Hn();return Ok(e,et.memoizedState,t)},useTransition:function(){var t=tm(qc)[0],e=Hn().memoizedState;return[t,e]},useMutableSource:mk,useSyncExternalStore:gk,useId:Pk,unstable_isNewReconciler:!1},uA={readContext:Un,useCallback:_k,useContext:Un,useEffect:Zv,useImperativeHandle:Tk,useInsertionEffect:Ck,useLayoutEffect:kk,useMemo:Rk,useReducer:nm,useRef:Sk,useState:function(){return nm(qc)},useDebugValue:e0,useDeferredValue:function(t){var e=Hn();return et===null?e.memoizedState=t:Ok(e,et.memoizedState,t)},useTransition:function(){var t=nm(qc)[0],e=Hn().memoizedState;return[t,e]},useMutableSource:mk,useSyncExternalStore:gk,useId:Pk,unstable_isNewReconciler:!1};function Zn(t,e){if(t&&t.defaultProps){e=Ve({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Dg(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Ve({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Mh={isMounted:function(t){return(t=t._reactInternals)?zs(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Vt(),i=mo(t),o=oi(r,i);o.payload=e,n!=null&&(o.callback=n),e=ho(t,o,i),e!==null&&(lr(e,t,i,r),Xd(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Vt(),i=mo(t),o=oi(r,i);o.tag=1,o.payload=e,n!=null&&(o.callback=n),e=ho(t,o,i),e!==null&&(lr(e,t,i,r),Xd(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Vt(),r=mo(t),i=oi(n,r);i.tag=2,e!=null&&(i.callback=e),e=ho(t,i,r),e!==null&&(lr(e,t,r,n),Xd(e,t,r))}};function Mw(t,e,n,r,i,o,s){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,o,s):e.prototype&&e.prototype.isPureReactComponent?!Bc(n,r)||!Bc(i,o):!0}function Nk(t,e,n){var r=!1,i=ko,o=e.contextType;return typeof o=="object"&&o!==null?o=Un(o):(i=cn(e)?ks:Rt.current,r=e.contextTypes,o=(r=r!=null)?rl(t,i):ko),e=new e(n,o),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Mh,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=o),e}function Iw(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Mh.enqueueReplaceState(e,e.state,null)}function jg(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},Kv(t);var o=e.contextType;typeof o=="object"&&o!==null?i.context=Un(o):(o=cn(e)?ks:Rt.current,i.context=rl(t,o)),i.state=t.memoizedState,o=e.getDerivedStateFromProps,typeof o=="function"&&(Dg(t,e,o,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Mh.enqueueReplaceState(i,i.state,null),If(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function al(t,e){try{var n="",r=e;do n+=$M(r),r=r.return;while(r);var i=n}catch(o){i=`
Error generating stack: `+o.message+`
`+o.stack}return{value:t,source:e,stack:i,digest:null}}function rm(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Lg(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var dA=typeof WeakMap=="function"?WeakMap:Map;function Dk(t,e,n){n=oi(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Lf||(Lf=!0,qg=r),Lg(t,e)},n}function jk(t,e,n){n=oi(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){Lg(t,e)}}var o=t.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(n.callback=function(){Lg(t,e),typeof r!="function"&&(po===null?po=new Set([this]):po.add(this));var s=e.stack;this.componentDidCatch(e.value,{componentStack:s!==null?s:""})}),n}function Aw(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new dA;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=EA.bind(null,t,e,n),e.then(t,t))}function Nw(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Dw(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=oi(-1,1),e.tag=2,ho(n,e,1))),n.lanes|=1),t)}var fA=mi.ReactCurrentOwner,on=!1;function zt(t,e,n,r){e.child=t===null?dk(e,null,n,r):ol(e,t.child,n,r)}function jw(t,e,n,r,i){n=n.render;var o=e.ref;return Aa(e,i),r=Qv(t,e,n,r,o,i),n=Xv(),t!==null&&!on?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,di(t,e,i)):($e&&n&&Fv(e),e.flags|=1,zt(t,e,r,i),e.child)}function Lw(t,e,n,r,i){if(t===null){var o=n.type;return typeof o=="function"&&!l0(o)&&o.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=o,Lk(t,e,o,r,i)):(t=of(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(o=t.child,!(t.lanes&i)){var s=o.memoizedProps;if(n=n.compare,n=n!==null?n:Bc,n(s,r)&&t.ref===e.ref)return di(t,e,i)}return e.flags|=1,t=go(o,r),t.ref=e.ref,t.return=e,e.child=t}function Lk(t,e,n,r,i){if(t!==null){var o=t.memoizedProps;if(Bc(o,r)&&t.ref===e.ref)if(on=!1,e.pendingProps=r=o,(t.lanes&i)!==0)t.flags&131072&&(on=!0);else return e.lanes=t.lanes,di(t,e,i)}return $g(t,e,n,r,i)}function $k(t,e,n){var r=e.pendingProps,i=r.children,o=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ae(Ea,vn),vn|=n;else{if(!(n&1073741824))return t=o!==null?o.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Ae(Ea,vn),vn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=o!==null?o.baseLanes:n,Ae(Ea,vn),vn|=r}else o!==null?(r=o.baseLanes|n,e.memoizedState=null):r=n,Ae(Ea,vn),vn|=r;return zt(t,e,i,n),e.child}function Fk(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function $g(t,e,n,r,i){var o=cn(n)?ks:Rt.current;return o=rl(e,o),Aa(e,i),n=Qv(t,e,n,r,o,i),r=Xv(),t!==null&&!on?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,di(t,e,i)):($e&&r&&Fv(e),e.flags|=1,zt(t,e,n,i),e.child)}function $w(t,e,n,r,i){if(cn(n)){var o=!0;_f(e)}else o=!1;if(Aa(e,i),e.stateNode===null)tf(t,e),Nk(e,n,r),jg(e,n,r,i),r=!0;else if(t===null){var s=e.stateNode,a=e.memoizedProps;s.props=a;var l=s.context,c=n.contextType;typeof c=="object"&&c!==null?c=Un(c):(c=cn(n)?ks:Rt.current,c=rl(e,c));var u=n.getDerivedStateFromProps,d=typeof u=="function"||typeof s.getSnapshotBeforeUpdate=="function";d||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(a!==r||l!==c)&&Iw(e,s,r,c),Pi=!1;var h=e.memoizedState;s.state=h,If(e,r,s,i),l=e.memoizedState,a!==r||h!==l||ln.current||Pi?(typeof u=="function"&&(Dg(e,n,u,r),l=e.memoizedState),(a=Pi||Mw(e,n,a,r,h,l,c))?(d||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(e.flags|=4194308)):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),s.props=r,s.state=l,s.context=c,r=a):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{s=e.stateNode,hk(t,e),a=e.memoizedProps,c=e.type===e.elementType?a:Zn(e.type,a),s.props=c,d=e.pendingProps,h=s.context,l=n.contextType,typeof l=="object"&&l!==null?l=Un(l):(l=cn(n)?ks:Rt.current,l=rl(e,l));var p=n.getDerivedStateFromProps;(u=typeof p=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(a!==d||h!==l)&&Iw(e,s,r,l),Pi=!1,h=e.memoizedState,s.state=h,If(e,r,s,i);var m=e.memoizedState;a!==d||h!==m||ln.current||Pi?(typeof p=="function"&&(Dg(e,n,p,r),m=e.memoizedState),(c=Pi||Mw(e,n,c,r,h,m,l)||!1)?(u||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(r,m,l),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(r,m,l)),typeof s.componentDidUpdate=="function"&&(e.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof s.componentDidUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=m),s.props=r,s.state=m,s.context=l,r=c):(typeof s.componentDidUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),r=!1)}return Fg(t,e,n,r,o,i)}function Fg(t,e,n,r,i,o){Fk(t,e);var s=(e.flags&128)!==0;if(!r&&!s)return i&&Cw(e,n,!1),di(t,e,o);r=e.stateNode,fA.current=e;var a=s&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&s?(e.child=ol(e,t.child,null,o),e.child=ol(e,null,a,o)):zt(t,e,a,o),e.memoizedState=r.state,i&&Cw(e,n,!0),e.child}function Bk(t){var e=t.stateNode;e.pendingContext?Sw(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Sw(t,e.context,!1),qv(t,e.containerInfo)}function Fw(t,e,n,r,i){return il(),zv(i),e.flags|=256,zt(t,e,n,r),e.child}var Bg={dehydrated:null,treeContext:null,retryLane:0};function zg(t){return{baseLanes:t,cachePool:null,transitions:null}}function zk(t,e,n){var r=e.pendingProps,i=Be.current,o=!1,s=(e.flags&128)!==0,a;if((a=s)||(a=t!==null&&t.memoizedState===null?!1:(i&2)!==0),a?(o=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),Ae(Be,i&1),t===null)return Ag(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(s=r.children,t=r.fallback,o?(r=e.mode,o=e.child,s={mode:"hidden",children:s},!(r&1)&&o!==null?(o.childLanes=0,o.pendingProps=s):o=Nh(s,r,0,null),t=gs(t,r,n,null),o.return=e,t.return=e,o.sibling=t,e.child=o,e.child.memoizedState=zg(n),e.memoizedState=Bg,t):t0(e,s));if(i=t.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return hA(t,e,s,r,a,i,n);if(o){o=r.fallback,s=e.mode,i=t.child,a=i.sibling;var l={mode:"hidden",children:r.children};return!(s&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=go(i,l),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?o=go(a,o):(o=gs(o,s,n,null),o.flags|=2),o.return=e,r.return=e,r.sibling=o,e.child=r,r=o,o=e.child,s=t.child.memoizedState,s=s===null?zg(n):{baseLanes:s.baseLanes|n,cachePool:null,transitions:s.transitions},o.memoizedState=s,o.childLanes=t.childLanes&~n,e.memoizedState=Bg,r}return o=t.child,t=o.sibling,r=go(o,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function t0(t,e){return e=Nh({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function yd(t,e,n,r){return r!==null&&zv(r),ol(e,t.child,null,n),t=t0(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function hA(t,e,n,r,i,o,s){if(n)return e.flags&256?(e.flags&=-257,r=rm(Error(z(422))),yd(t,e,s,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(o=r.fallback,i=e.mode,r=Nh({mode:"visible",children:r.children},i,0,null),o=gs(o,i,s,null),o.flags|=2,r.return=e,o.return=e,r.sibling=o,e.child=r,e.mode&1&&ol(e,t.child,null,s),e.child.memoizedState=zg(s),e.memoizedState=Bg,o);if(!(e.mode&1))return yd(t,e,s,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,o=Error(z(419)),r=rm(o,r,void 0),yd(t,e,s,r)}if(a=(s&t.childLanes)!==0,on||a){if(r=at,r!==null){switch(s&-s){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|s)?0:i,i!==0&&i!==o.retryLane&&(o.retryLane=i,ui(t,i),lr(r,t,i,-1))}return a0(),r=rm(Error(z(421))),yd(t,e,s,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=TA.bind(null,t),i._reactRetry=e,null):(t=o.treeContext,bn=fo(i.nextSibling),Sn=e,$e=!0,ir=null,t!==null&&(An[Nn++]=ti,An[Nn++]=ni,An[Nn++]=Es,ti=t.id,ni=t.overflow,Es=e),e=t0(e,r.children),e.flags|=4096,e)}function Bw(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Ng(t.return,e,n)}function im(t,e,n,r,i){var o=t.memoizedState;o===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(o.isBackwards=e,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=i)}function Vk(t,e,n){var r=e.pendingProps,i=r.revealOrder,o=r.tail;if(zt(t,e,r.children,n),r=Be.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Bw(t,n,e);else if(t.tag===19)Bw(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Ae(Be,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&Af(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),im(e,!1,i,n,o);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&Af(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}im(e,!0,n,null,o);break;case"together":im(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function tf(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function di(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),_s|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(z(153));if(e.child!==null){for(t=e.child,n=go(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=go(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function pA(t,e,n){switch(e.tag){case 3:Bk(e),il();break;case 5:pk(e);break;case 1:cn(e.type)&&_f(e);break;case 4:qv(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;Ae(Pf,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Ae(Be,Be.current&1),e.flags|=128,null):n&e.child.childLanes?zk(t,e,n):(Ae(Be,Be.current&1),t=di(t,e,n),t!==null?t.sibling:null);Ae(Be,Be.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return Vk(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Ae(Be,Be.current),r)break;return null;case 22:case 23:return e.lanes=0,$k(t,e,n)}return di(t,e,n)}var Uk,Vg,Hk,Wk;Uk=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Vg=function(){};Hk=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,ns(Nr.current);var o=null;switch(n){case"input":i=ug(t,i),r=ug(t,r),o=[];break;case"select":i=Ve({},i,{value:void 0}),r=Ve({},r,{value:void 0}),o=[];break;case"textarea":i=hg(t,i),r=hg(t,r),o=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Ef)}mg(n,r);var s;n=null;for(c in i)if(!r.hasOwnProperty(c)&&i.hasOwnProperty(c)&&i[c]!=null)if(c==="style"){var a=i[c];for(s in a)a.hasOwnProperty(s)&&(n||(n={}),n[s]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Ac.hasOwnProperty(c)?o||(o=[]):(o=o||[]).push(c,null));for(c in r){var l=r[c];if(a=i!=null?i[c]:void 0,r.hasOwnProperty(c)&&l!==a&&(l!=null||a!=null))if(c==="style")if(a){for(s in a)!a.hasOwnProperty(s)||l&&l.hasOwnProperty(s)||(n||(n={}),n[s]="");for(s in l)l.hasOwnProperty(s)&&a[s]!==l[s]&&(n||(n={}),n[s]=l[s])}else n||(o||(o=[]),o.push(c,n)),n=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(o=o||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(o=o||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Ac.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&De("scroll",t),o||a===l||(o=[])):(o=o||[]).push(c,l))}n&&(o=o||[]).push("style",n);var c=o;(e.updateQueue=c)&&(e.flags|=4)}};Wk=function(t,e,n,r){n!==r&&(e.flags|=4)};function Ql(t,e){if(!$e)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function bt(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function mA(t,e,n){var r=e.pendingProps;switch(Bv(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return bt(e),null;case 1:return cn(e.type)&&Tf(),bt(e),null;case 3:return r=e.stateNode,sl(),je(ln),je(Rt),Jv(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(md(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,ir!==null&&(Yg(ir),ir=null))),Vg(t,e),bt(e),null;case 5:Gv(e);var i=ns(Wc.current);if(n=e.type,t!==null&&e.stateNode!=null)Hk(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(z(166));return bt(e),null}if(t=ns(Nr.current),md(e)){r=e.stateNode,n=e.type;var o=e.memoizedProps;switch(r[Or]=e,r[Uc]=o,t=(e.mode&1)!==0,n){case"dialog":De("cancel",r),De("close",r);break;case"iframe":case"object":case"embed":De("load",r);break;case"video":case"audio":for(i=0;i<ac.length;i++)De(ac[i],r);break;case"source":De("error",r);break;case"img":case"image":case"link":De("error",r),De("load",r);break;case"details":De("toggle",r);break;case"input":Jx(r,o),De("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},De("invalid",r);break;case"textarea":Qx(r,o),De("invalid",r)}mg(n,o),i=null;for(var s in o)if(o.hasOwnProperty(s)){var a=o[s];s==="children"?typeof a=="string"?r.textContent!==a&&(o.suppressHydrationWarning!==!0&&pd(r.textContent,a,t),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(o.suppressHydrationWarning!==!0&&pd(r.textContent,a,t),i=["children",""+a]):Ac.hasOwnProperty(s)&&a!=null&&s==="onScroll"&&De("scroll",r)}switch(n){case"input":sd(r),Yx(r,o,!0);break;case"textarea":sd(r),Xx(r);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(r.onclick=Ef)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{s=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=xC(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=s.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=s.createElement(n,{is:r.is}):(t=s.createElement(n),n==="select"&&(s=t,r.multiple?s.multiple=!0:r.size&&(s.size=r.size))):t=s.createElementNS(t,n),t[Or]=e,t[Uc]=r,Uk(t,e,!1,!1),e.stateNode=t;e:{switch(s=gg(n,r),n){case"dialog":De("cancel",t),De("close",t),i=r;break;case"iframe":case"object":case"embed":De("load",t),i=r;break;case"video":case"audio":for(i=0;i<ac.length;i++)De(ac[i],t);i=r;break;case"source":De("error",t),i=r;break;case"img":case"image":case"link":De("error",t),De("load",t),i=r;break;case"details":De("toggle",t),i=r;break;case"input":Jx(t,r),i=ug(t,r),De("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=Ve({},r,{value:void 0}),De("invalid",t);break;case"textarea":Qx(t,r),i=hg(t,r),De("invalid",t);break;default:i=r}mg(n,i),a=i;for(o in a)if(a.hasOwnProperty(o)){var l=a[o];o==="style"?SC(t,l):o==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&wC(t,l)):o==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&Nc(t,l):typeof l=="number"&&Nc(t,""+l):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(Ac.hasOwnProperty(o)?l!=null&&o==="onScroll"&&De("scroll",t):l!=null&&Ev(t,o,l,s))}switch(n){case"input":sd(t),Yx(t,r,!1);break;case"textarea":sd(t),Xx(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Co(r.value));break;case"select":t.multiple=!!r.multiple,o=r.value,o!=null?Oa(t,!!r.multiple,o,!1):r.defaultValue!=null&&Oa(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=Ef)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return bt(e),null;case 6:if(t&&e.stateNode!=null)Wk(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(z(166));if(n=ns(Wc.current),ns(Nr.current),md(e)){if(r=e.stateNode,n=e.memoizedProps,r[Or]=e,(o=r.nodeValue!==n)&&(t=Sn,t!==null))switch(t.tag){case 3:pd(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&pd(r.nodeValue,n,(t.mode&1)!==0)}o&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Or]=e,e.stateNode=r}return bt(e),null;case 13:if(je(Be),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if($e&&bn!==null&&e.mode&1&&!(e.flags&128))ck(),il(),e.flags|=98560,o=!1;else if(o=md(e),r!==null&&r.dehydrated!==null){if(t===null){if(!o)throw Error(z(318));if(o=e.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(z(317));o[Or]=e}else il(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;bt(e),o=!1}else ir!==null&&(Yg(ir),ir=null),o=!0;if(!o)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Be.current&1?nt===0&&(nt=3):a0())),e.updateQueue!==null&&(e.flags|=4),bt(e),null);case 4:return sl(),Vg(t,e),t===null&&zc(e.stateNode.containerInfo),bt(e),null;case 10:return Hv(e.type._context),bt(e),null;case 17:return cn(e.type)&&Tf(),bt(e),null;case 19:if(je(Be),o=e.memoizedState,o===null)return bt(e),null;if(r=(e.flags&128)!==0,s=o.rendering,s===null)if(r)Ql(o,!1);else{if(nt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(s=Af(t),s!==null){for(e.flags|=128,Ql(o,!1),r=s.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)o=n,t=r,o.flags&=14680066,s=o.alternate,s===null?(o.childLanes=0,o.lanes=t,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=s.childLanes,o.lanes=s.lanes,o.child=s.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=s.memoizedProps,o.memoizedState=s.memoizedState,o.updateQueue=s.updateQueue,o.type=s.type,t=s.dependencies,o.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Ae(Be,Be.current&1|2),e.child}t=t.sibling}o.tail!==null&&Ge()>ll&&(e.flags|=128,r=!0,Ql(o,!1),e.lanes=4194304)}else{if(!r)if(t=Af(s),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Ql(o,!0),o.tail===null&&o.tailMode==="hidden"&&!s.alternate&&!$e)return bt(e),null}else 2*Ge()-o.renderingStartTime>ll&&n!==1073741824&&(e.flags|=128,r=!0,Ql(o,!1),e.lanes=4194304);o.isBackwards?(s.sibling=e.child,e.child=s):(n=o.last,n!==null?n.sibling=s:e.child=s,o.last=s)}return o.tail!==null?(e=o.tail,o.rendering=e,o.tail=e.sibling,o.renderingStartTime=Ge(),e.sibling=null,n=Be.current,Ae(Be,r?n&1|2:n&1),e):(bt(e),null);case 22:case 23:return s0(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?vn&1073741824&&(bt(e),e.subtreeFlags&6&&(e.flags|=8192)):bt(e),null;case 24:return null;case 25:return null}throw Error(z(156,e.tag))}function gA(t,e){switch(Bv(e),e.tag){case 1:return cn(e.type)&&Tf(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return sl(),je(ln),je(Rt),Jv(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Gv(e),null;case 13:if(je(Be),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(z(340));il()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return je(Be),null;case 4:return sl(),null;case 10:return Hv(e.type._context),null;case 22:case 23:return s0(),null;case 24:return null;default:return null}}var vd=!1,Tt=!1,yA=typeof WeakSet=="function"?WeakSet:Set,K=null;function ka(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){He(t,e,r)}else n.current=null}function Ug(t,e,n){try{n()}catch(r){He(t,e,r)}}var zw=!1;function vA(t,e){if(Tg=Sf,t=YC(),$v(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch{n=null;break e}var s=0,a=-1,l=-1,c=0,u=0,d=t,h=null;t:for(;;){for(var p;d!==n||i!==0&&d.nodeType!==3||(a=s+i),d!==o||r!==0&&d.nodeType!==3||(l=s+r),d.nodeType===3&&(s+=d.nodeValue.length),(p=d.firstChild)!==null;)h=d,d=p;for(;;){if(d===t)break t;if(h===n&&++c===i&&(a=s),h===o&&++u===r&&(l=s),(p=d.nextSibling)!==null)break;d=h,h=d.parentNode}d=p}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(_g={focusedElem:t,selectionRange:n},Sf=!1,K=e;K!==null;)if(e=K,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,K=t;else for(;K!==null;){e=K;try{var m=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(m!==null){var y=m.memoizedProps,v=m.memoizedState,x=e.stateNode,w=x.getSnapshotBeforeUpdate(e.elementType===e.type?y:Zn(e.type,y),v);x.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var b=e.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(z(163))}}catch(S){He(e,e.return,S)}if(t=e.sibling,t!==null){t.return=e.return,K=t;break}K=e.return}return m=zw,zw=!1,m}function bc(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var o=i.destroy;i.destroy=void 0,o!==void 0&&Ug(e,n,o)}i=i.next}while(i!==r)}}function Ih(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Hg(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function Kk(t){var e=t.alternate;e!==null&&(t.alternate=null,Kk(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Or],delete e[Uc],delete e[Pg],delete e[eA],delete e[tA])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function qk(t){return t.tag===5||t.tag===3||t.tag===4}function Vw(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||qk(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Wg(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Ef));else if(r!==4&&(t=t.child,t!==null))for(Wg(t,e,n),t=t.sibling;t!==null;)Wg(t,e,n),t=t.sibling}function Kg(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Kg(t,e,n),t=t.sibling;t!==null;)Kg(t,e,n),t=t.sibling}var ht=null,nr=!1;function xi(t,e,n){for(n=n.child;n!==null;)Gk(t,e,n),n=n.sibling}function Gk(t,e,n){if(Ar&&typeof Ar.onCommitFiberUnmount=="function")try{Ar.onCommitFiberUnmount(kh,n)}catch{}switch(n.tag){case 5:Tt||ka(n,e);case 6:var r=ht,i=nr;ht=null,xi(t,e,n),ht=r,nr=i,ht!==null&&(nr?(t=ht,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):ht.removeChild(n.stateNode));break;case 18:ht!==null&&(nr?(t=ht,n=n.stateNode,t.nodeType===8?Qp(t.parentNode,n):t.nodeType===1&&Qp(t,n),$c(t)):Qp(ht,n.stateNode));break;case 4:r=ht,i=nr,ht=n.stateNode.containerInfo,nr=!0,xi(t,e,n),ht=r,nr=i;break;case 0:case 11:case 14:case 15:if(!Tt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var o=i,s=o.destroy;o=o.tag,s!==void 0&&(o&2||o&4)&&Ug(n,e,s),i=i.next}while(i!==r)}xi(t,e,n);break;case 1:if(!Tt&&(ka(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){He(n,e,a)}xi(t,e,n);break;case 21:xi(t,e,n);break;case 22:n.mode&1?(Tt=(r=Tt)||n.memoizedState!==null,xi(t,e,n),Tt=r):xi(t,e,n);break;default:xi(t,e,n)}}function Uw(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new yA),e.forEach(function(r){var i=_A.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function Qn(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var o=t,s=e,a=s;e:for(;a!==null;){switch(a.tag){case 5:ht=a.stateNode,nr=!1;break e;case 3:ht=a.stateNode.containerInfo,nr=!0;break e;case 4:ht=a.stateNode.containerInfo,nr=!0;break e}a=a.return}if(ht===null)throw Error(z(160));Gk(o,s,i),ht=null,nr=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(c){He(i,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Jk(e,t),e=e.sibling}function Jk(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Qn(e,t),wr(t),r&4){try{bc(3,t,t.return),Ih(3,t)}catch(y){He(t,t.return,y)}try{bc(5,t,t.return)}catch(y){He(t,t.return,y)}}break;case 1:Qn(e,t),wr(t),r&512&&n!==null&&ka(n,n.return);break;case 5:if(Qn(e,t),wr(t),r&512&&n!==null&&ka(n,n.return),t.flags&32){var i=t.stateNode;try{Nc(i,"")}catch(y){He(t,t.return,y)}}if(r&4&&(i=t.stateNode,i!=null)){var o=t.memoizedProps,s=n!==null?n.memoizedProps:o,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&o.type==="radio"&&o.name!=null&&yC(i,o),gg(a,s);var c=gg(a,o);for(s=0;s<l.length;s+=2){var u=l[s],d=l[s+1];u==="style"?SC(i,d):u==="dangerouslySetInnerHTML"?wC(i,d):u==="children"?Nc(i,d):Ev(i,u,d,c)}switch(a){case"input":dg(i,o);break;case"textarea":vC(i,o);break;case"select":var h=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!o.multiple;var p=o.value;p!=null?Oa(i,!!o.multiple,p,!1):h!==!!o.multiple&&(o.defaultValue!=null?Oa(i,!!o.multiple,o.defaultValue,!0):Oa(i,!!o.multiple,o.multiple?[]:"",!1))}i[Uc]=o}catch(y){He(t,t.return,y)}}break;case 6:if(Qn(e,t),wr(t),r&4){if(t.stateNode===null)throw Error(z(162));i=t.stateNode,o=t.memoizedProps;try{i.nodeValue=o}catch(y){He(t,t.return,y)}}break;case 3:if(Qn(e,t),wr(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{$c(e.containerInfo)}catch(y){He(t,t.return,y)}break;case 4:Qn(e,t),wr(t);break;case 13:Qn(e,t),wr(t),i=t.child,i.flags&8192&&(o=i.memoizedState!==null,i.stateNode.isHidden=o,!o||i.alternate!==null&&i.alternate.memoizedState!==null||(i0=Ge())),r&4&&Uw(t);break;case 22:if(u=n!==null&&n.memoizedState!==null,t.mode&1?(Tt=(c=Tt)||u,Qn(e,t),Tt=c):Qn(e,t),wr(t),r&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!u&&t.mode&1)for(K=t,u=t.child;u!==null;){for(d=K=u;K!==null;){switch(h=K,p=h.child,h.tag){case 0:case 11:case 14:case 15:bc(4,h,h.return);break;case 1:ka(h,h.return);var m=h.stateNode;if(typeof m.componentWillUnmount=="function"){r=h,n=h.return;try{e=r,m.props=e.memoizedProps,m.state=e.memoizedState,m.componentWillUnmount()}catch(y){He(r,n,y)}}break;case 5:ka(h,h.return);break;case 22:if(h.memoizedState!==null){Ww(d);continue}}p!==null?(p.return=h,K=p):Ww(d)}u=u.sibling}e:for(u=null,d=t;;){if(d.tag===5){if(u===null){u=d;try{i=d.stateNode,c?(o=i.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(a=d.stateNode,l=d.memoizedProps.style,s=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=bC("display",s))}catch(y){He(t,t.return,y)}}}else if(d.tag===6){if(u===null)try{d.stateNode.nodeValue=c?"":d.memoizedProps}catch(y){He(t,t.return,y)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===t)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===t)break e;for(;d.sibling===null;){if(d.return===null||d.return===t)break e;u===d&&(u=null),d=d.return}u===d&&(u=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:Qn(e,t),wr(t),r&4&&Uw(t);break;case 21:break;default:Qn(e,t),wr(t)}}function wr(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(qk(n)){var r=n;break e}n=n.return}throw Error(z(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(Nc(i,""),r.flags&=-33);var o=Vw(t);Kg(t,o,i);break;case 3:case 4:var s=r.stateNode.containerInfo,a=Vw(t);Wg(t,a,s);break;default:throw Error(z(161))}}catch(l){He(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function xA(t,e,n){K=t,Yk(t)}function Yk(t,e,n){for(var r=(t.mode&1)!==0;K!==null;){var i=K,o=i.child;if(i.tag===22&&r){var s=i.memoizedState!==null||vd;if(!s){var a=i.alternate,l=a!==null&&a.memoizedState!==null||Tt;a=vd;var c=Tt;if(vd=s,(Tt=l)&&!c)for(K=i;K!==null;)s=K,l=s.child,s.tag===22&&s.memoizedState!==null?Kw(i):l!==null?(l.return=s,K=l):Kw(i);for(;o!==null;)K=o,Yk(o),o=o.sibling;K=i,vd=a,Tt=c}Hw(t)}else i.subtreeFlags&8772&&o!==null?(o.return=i,K=o):Hw(t)}}function Hw(t){for(;K!==null;){var e=K;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Tt||Ih(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Tt)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:Zn(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=e.updateQueue;o!==null&&Rw(e,o,r);break;case 3:var s=e.updateQueue;if(s!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}Rw(e,s,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var d=u.dehydrated;d!==null&&$c(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(z(163))}Tt||e.flags&512&&Hg(e)}catch(h){He(e,e.return,h)}}if(e===t){K=null;break}if(n=e.sibling,n!==null){n.return=e.return,K=n;break}K=e.return}}function Ww(t){for(;K!==null;){var e=K;if(e===t){K=null;break}var n=e.sibling;if(n!==null){n.return=e.return,K=n;break}K=e.return}}function Kw(t){for(;K!==null;){var e=K;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Ih(4,e)}catch(l){He(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(l){He(e,i,l)}}var o=e.return;try{Hg(e)}catch(l){He(e,o,l)}break;case 5:var s=e.return;try{Hg(e)}catch(l){He(e,s,l)}}}catch(l){He(e,e.return,l)}if(e===t){K=null;break}var a=e.sibling;if(a!==null){a.return=e.return,K=a;break}K=e.return}}var wA=Math.ceil,jf=mi.ReactCurrentDispatcher,n0=mi.ReactCurrentOwner,Ln=mi.ReactCurrentBatchConfig,we=0,at=null,Qe=null,yt=0,vn=0,Ea=Ao(0),nt=0,Jc=null,_s=0,Ah=0,r0=0,Sc=null,nn=null,i0=0,ll=1/0,Jr=null,Lf=!1,qg=null,po=null,xd=!1,io=null,$f=0,Cc=0,Gg=null,nf=-1,rf=0;function Vt(){return we&6?Ge():nf!==-1?nf:nf=Ge()}function mo(t){return t.mode&1?we&2&&yt!==0?yt&-yt:rA.transition!==null?(rf===0&&(rf=NC()),rf):(t=ke,t!==0||(t=window.event,t=t===void 0?16:zC(t.type)),t):1}function lr(t,e,n,r){if(50<Cc)throw Cc=0,Gg=null,Error(z(185));Mu(t,n,r),(!(we&2)||t!==at)&&(t===at&&(!(we&2)&&(Ah|=n),nt===4&&Wi(t,yt)),un(t,r),n===1&&we===0&&!(e.mode&1)&&(ll=Ge()+500,Oh&&No()))}function un(t,e){var n=t.callbackNode;rI(t,e);var r=bf(t,t===at?yt:0);if(r===0)n!==null&&tw(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&tw(n),e===1)t.tag===0?nA(qw.bind(null,t)):sk(qw.bind(null,t)),XI(function(){!(we&6)&&No()}),n=null;else{switch(DC(r)){case 1:n=Pv;break;case 4:n=IC;break;case 16:n=wf;break;case 536870912:n=AC;break;default:n=wf}n=iE(n,Qk.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function Qk(t,e){if(nf=-1,rf=0,we&6)throw Error(z(327));var n=t.callbackNode;if(Na()&&t.callbackNode!==n)return null;var r=bf(t,t===at?yt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Ff(t,r);else{e=r;var i=we;we|=2;var o=Zk();(at!==t||yt!==e)&&(Jr=null,ll=Ge()+500,ms(t,e));do try{CA();break}catch(a){Xk(t,a)}while(1);Uv(),jf.current=o,we=i,Qe!==null?e=0:(at=null,yt=0,e=nt)}if(e!==0){if(e===2&&(i=bg(t),i!==0&&(r=i,e=Jg(t,i))),e===1)throw n=Jc,ms(t,0),Wi(t,r),un(t,Ge()),n;if(e===6)Wi(t,r);else{if(i=t.current.alternate,!(r&30)&&!bA(i)&&(e=Ff(t,r),e===2&&(o=bg(t),o!==0&&(r=o,e=Jg(t,o))),e===1))throw n=Jc,ms(t,0),Wi(t,r),un(t,Ge()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(z(345));case 2:qo(t,nn,Jr);break;case 3:if(Wi(t,r),(r&130023424)===r&&(e=i0+500-Ge(),10<e)){if(bf(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){Vt(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=Og(qo.bind(null,t,nn,Jr),e);break}qo(t,nn,Jr);break;case 4:if(Wi(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var s=31-ar(r);o=1<<s,s=e[s],s>i&&(i=s),r&=~o}if(r=i,r=Ge()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*wA(r/1960))-r,10<r){t.timeoutHandle=Og(qo.bind(null,t,nn,Jr),r);break}qo(t,nn,Jr);break;case 5:qo(t,nn,Jr);break;default:throw Error(z(329))}}}return un(t,Ge()),t.callbackNode===n?Qk.bind(null,t):null}function Jg(t,e){var n=Sc;return t.current.memoizedState.isDehydrated&&(ms(t,e).flags|=256),t=Ff(t,e),t!==2&&(e=nn,nn=n,e!==null&&Yg(e)),t}function Yg(t){nn===null?nn=t:nn.push.apply(nn,t)}function bA(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],o=i.getSnapshot;i=i.value;try{if(!cr(o(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Wi(t,e){for(e&=~r0,e&=~Ah,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-ar(e),r=1<<n;t[n]=-1,e&=~r}}function qw(t){if(we&6)throw Error(z(327));Na();var e=bf(t,0);if(!(e&1))return un(t,Ge()),null;var n=Ff(t,e);if(t.tag!==0&&n===2){var r=bg(t);r!==0&&(e=r,n=Jg(t,r))}if(n===1)throw n=Jc,ms(t,0),Wi(t,e),un(t,Ge()),n;if(n===6)throw Error(z(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,qo(t,nn,Jr),un(t,Ge()),null}function o0(t,e){var n=we;we|=1;try{return t(e)}finally{we=n,we===0&&(ll=Ge()+500,Oh&&No())}}function Rs(t){io!==null&&io.tag===0&&!(we&6)&&Na();var e=we;we|=1;var n=Ln.transition,r=ke;try{if(Ln.transition=null,ke=1,t)return t()}finally{ke=r,Ln.transition=n,we=e,!(we&6)&&No()}}function s0(){vn=Ea.current,je(Ea)}function ms(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,QI(n)),Qe!==null)for(n=Qe.return;n!==null;){var r=n;switch(Bv(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Tf();break;case 3:sl(),je(ln),je(Rt),Jv();break;case 5:Gv(r);break;case 4:sl();break;case 13:je(Be);break;case 19:je(Be);break;case 10:Hv(r.type._context);break;case 22:case 23:s0()}n=n.return}if(at=t,Qe=t=go(t.current,null),yt=vn=e,nt=0,Jc=null,r0=Ah=_s=0,nn=Sc=null,ts!==null){for(e=0;e<ts.length;e++)if(n=ts[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,o=n.pending;if(o!==null){var s=o.next;o.next=i,r.next=s}n.pending=r}ts=null}return t}function Xk(t,e){do{var n=Qe;try{if(Uv(),Zd.current=Df,Nf){for(var r=ze.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Nf=!1}if(Ts=0,ot=et=ze=null,wc=!1,Kc=0,n0.current=null,n===null||n.return===null){nt=1,Jc=e,Qe=null;break}e:{var o=t,s=n.return,a=n,l=e;if(e=yt,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=a,d=u.tag;if(!(u.mode&1)&&(d===0||d===11||d===15)){var h=u.alternate;h?(u.updateQueue=h.updateQueue,u.memoizedState=h.memoizedState,u.lanes=h.lanes):(u.updateQueue=null,u.memoizedState=null)}var p=Nw(s);if(p!==null){p.flags&=-257,Dw(p,s,a,o,e),p.mode&1&&Aw(o,c,e),e=p,l=c;var m=e.updateQueue;if(m===null){var y=new Set;y.add(l),e.updateQueue=y}else m.add(l);break e}else{if(!(e&1)){Aw(o,c,e),a0();break e}l=Error(z(426))}}else if($e&&a.mode&1){var v=Nw(s);if(v!==null){!(v.flags&65536)&&(v.flags|=256),Dw(v,s,a,o,e),zv(al(l,a));break e}}o=l=al(l,a),nt!==4&&(nt=2),Sc===null?Sc=[o]:Sc.push(o),o=s;do{switch(o.tag){case 3:o.flags|=65536,e&=-e,o.lanes|=e;var x=Dk(o,l,e);_w(o,x);break e;case 1:a=l;var w=o.type,b=o.stateNode;if(!(o.flags&128)&&(typeof w.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(po===null||!po.has(b)))){o.flags|=65536,e&=-e,o.lanes|=e;var S=jk(o,a,e);_w(o,S);break e}}o=o.return}while(o!==null)}tE(n)}catch(C){e=C,Qe===n&&n!==null&&(Qe=n=n.return);continue}break}while(1)}function Zk(){var t=jf.current;return jf.current=Df,t===null?Df:t}function a0(){(nt===0||nt===3||nt===2)&&(nt=4),at===null||!(_s&268435455)&&!(Ah&268435455)||Wi(at,yt)}function Ff(t,e){var n=we;we|=2;var r=Zk();(at!==t||yt!==e)&&(Jr=null,ms(t,e));do try{SA();break}catch(i){Xk(t,i)}while(1);if(Uv(),we=n,jf.current=r,Qe!==null)throw Error(z(261));return at=null,yt=0,nt}function SA(){for(;Qe!==null;)eE(Qe)}function CA(){for(;Qe!==null&&!GM();)eE(Qe)}function eE(t){var e=rE(t.alternate,t,vn);t.memoizedProps=t.pendingProps,e===null?tE(t):Qe=e,n0.current=null}function tE(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=gA(n,e),n!==null){n.flags&=32767,Qe=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{nt=6,Qe=null;return}}else if(n=mA(n,e,vn),n!==null){Qe=n;return}if(e=e.sibling,e!==null){Qe=e;return}Qe=e=t}while(e!==null);nt===0&&(nt=5)}function qo(t,e,n){var r=ke,i=Ln.transition;try{Ln.transition=null,ke=1,kA(t,e,n,r)}finally{Ln.transition=i,ke=r}return null}function kA(t,e,n,r){do Na();while(io!==null);if(we&6)throw Error(z(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(z(177));t.callbackNode=null,t.callbackPriority=0;var o=n.lanes|n.childLanes;if(iI(t,o),t===at&&(Qe=at=null,yt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||xd||(xd=!0,iE(wf,function(){return Na(),null})),o=(n.flags&15990)!==0,n.subtreeFlags&15990||o){o=Ln.transition,Ln.transition=null;var s=ke;ke=1;var a=we;we|=4,n0.current=null,vA(t,n),Jk(n,t),HI(_g),Sf=!!Tg,_g=Tg=null,t.current=n,xA(n),JM(),we=a,ke=s,Ln.transition=o}else t.current=n;if(xd&&(xd=!1,io=t,$f=i),o=t.pendingLanes,o===0&&(po=null),XM(n.stateNode),un(t,Ge()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Lf)throw Lf=!1,t=qg,qg=null,t;return $f&1&&t.tag!==0&&Na(),o=t.pendingLanes,o&1?t===Gg?Cc++:(Cc=0,Gg=t):Cc=0,No(),null}function Na(){if(io!==null){var t=DC($f),e=Ln.transition,n=ke;try{if(Ln.transition=null,ke=16>t?16:t,io===null)var r=!1;else{if(t=io,io=null,$f=0,we&6)throw Error(z(331));var i=we;for(we|=4,K=t.current;K!==null;){var o=K,s=o.child;if(K.flags&16){var a=o.deletions;if(a!==null){for(var l=0;l<a.length;l++){var c=a[l];for(K=c;K!==null;){var u=K;switch(u.tag){case 0:case 11:case 15:bc(8,u,o)}var d=u.child;if(d!==null)d.return=u,K=d;else for(;K!==null;){u=K;var h=u.sibling,p=u.return;if(Kk(u),u===c){K=null;break}if(h!==null){h.return=p,K=h;break}K=p}}}var m=o.alternate;if(m!==null){var y=m.child;if(y!==null){m.child=null;do{var v=y.sibling;y.sibling=null,y=v}while(y!==null)}}K=o}}if(o.subtreeFlags&2064&&s!==null)s.return=o,K=s;else e:for(;K!==null;){if(o=K,o.flags&2048)switch(o.tag){case 0:case 11:case 15:bc(9,o,o.return)}var x=o.sibling;if(x!==null){x.return=o.return,K=x;break e}K=o.return}}var w=t.current;for(K=w;K!==null;){s=K;var b=s.child;if(s.subtreeFlags&2064&&b!==null)b.return=s,K=b;else e:for(s=w;K!==null;){if(a=K,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Ih(9,a)}}catch(C){He(a,a.return,C)}if(a===s){K=null;break e}var S=a.sibling;if(S!==null){S.return=a.return,K=S;break e}K=a.return}}if(we=i,No(),Ar&&typeof Ar.onPostCommitFiberRoot=="function")try{Ar.onPostCommitFiberRoot(kh,t)}catch{}r=!0}return r}finally{ke=n,Ln.transition=e}}return!1}function Gw(t,e,n){e=al(n,e),e=Dk(t,e,1),t=ho(t,e,1),e=Vt(),t!==null&&(Mu(t,1,e),un(t,e))}function He(t,e,n){if(t.tag===3)Gw(t,t,n);else for(;e!==null;){if(e.tag===3){Gw(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(po===null||!po.has(r))){t=al(n,t),t=jk(e,t,1),e=ho(e,t,1),t=Vt(),e!==null&&(Mu(e,1,t),un(e,t));break}}e=e.return}}function EA(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Vt(),t.pingedLanes|=t.suspendedLanes&n,at===t&&(yt&n)===n&&(nt===4||nt===3&&(yt&130023424)===yt&&500>Ge()-i0?ms(t,0):r0|=n),un(t,e)}function nE(t,e){e===0&&(t.mode&1?(e=cd,cd<<=1,!(cd&130023424)&&(cd=4194304)):e=1);var n=Vt();t=ui(t,e),t!==null&&(Mu(t,e,n),un(t,n))}function TA(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),nE(t,n)}function _A(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(z(314))}r!==null&&r.delete(e),nE(t,n)}var rE;rE=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||ln.current)on=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return on=!1,pA(t,e,n);on=!!(t.flags&131072)}else on=!1,$e&&e.flags&1048576&&ak(e,Of,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;tf(t,e),t=e.pendingProps;var i=rl(e,Rt.current);Aa(e,n),i=Qv(null,e,r,t,i,n);var o=Xv();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,cn(r)?(o=!0,_f(e)):o=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Kv(e),i.updater=Mh,e.stateNode=i,i._reactInternals=e,jg(e,r,t,n),e=Fg(null,e,r,!0,o,n)):(e.tag=0,$e&&o&&Fv(e),zt(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(tf(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=OA(r),t=Zn(r,t),i){case 0:e=$g(null,e,r,t,n);break e;case 1:e=$w(null,e,r,t,n);break e;case 11:e=jw(null,e,r,t,n);break e;case 14:e=Lw(null,e,r,Zn(r.type,t),n);break e}throw Error(z(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Zn(r,i),$g(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Zn(r,i),$w(t,e,r,i,n);case 3:e:{if(Bk(e),t===null)throw Error(z(387));r=e.pendingProps,o=e.memoizedState,i=o.element,hk(t,e),If(e,r,null,n);var s=e.memoizedState;if(r=s.element,o.isDehydrated)if(o={element:r,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},e.updateQueue.baseState=o,e.memoizedState=o,e.flags&256){i=al(Error(z(423)),e),e=Fw(t,e,r,n,i);break e}else if(r!==i){i=al(Error(z(424)),e),e=Fw(t,e,r,n,i);break e}else for(bn=fo(e.stateNode.containerInfo.firstChild),Sn=e,$e=!0,ir=null,n=dk(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(il(),r===i){e=di(t,e,n);break e}zt(t,e,r,n)}e=e.child}return e;case 5:return pk(e),t===null&&Ag(e),r=e.type,i=e.pendingProps,o=t!==null?t.memoizedProps:null,s=i.children,Rg(r,i)?s=null:o!==null&&Rg(r,o)&&(e.flags|=32),Fk(t,e),zt(t,e,s,n),e.child;case 6:return t===null&&Ag(e),null;case 13:return zk(t,e,n);case 4:return qv(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=ol(e,null,r,n):zt(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Zn(r,i),jw(t,e,r,i,n);case 7:return zt(t,e,e.pendingProps,n),e.child;case 8:return zt(t,e,e.pendingProps.children,n),e.child;case 12:return zt(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,o=e.memoizedProps,s=i.value,Ae(Pf,r._currentValue),r._currentValue=s,o!==null)if(cr(o.value,s)){if(o.children===i.children&&!ln.current){e=di(t,e,n);break e}}else for(o=e.child,o!==null&&(o.return=e);o!==null;){var a=o.dependencies;if(a!==null){s=o.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(o.tag===1){l=oi(-1,n&-n),l.tag=2;var c=o.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),Ng(o.return,n,e),a.lanes|=n;break}l=l.next}}else if(o.tag===10)s=o.type===e.type?null:o.child;else if(o.tag===18){if(s=o.return,s===null)throw Error(z(341));s.lanes|=n,a=s.alternate,a!==null&&(a.lanes|=n),Ng(s,n,e),s=o.sibling}else s=o.child;if(s!==null)s.return=o;else for(s=o;s!==null;){if(s===e){s=null;break}if(o=s.sibling,o!==null){o.return=s.return,s=o;break}s=s.return}o=s}zt(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,Aa(e,n),i=Un(i),r=r(i),e.flags|=1,zt(t,e,r,n),e.child;case 14:return r=e.type,i=Zn(r,e.pendingProps),i=Zn(r.type,i),Lw(t,e,r,i,n);case 15:return Lk(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Zn(r,i),tf(t,e),e.tag=1,cn(r)?(t=!0,_f(e)):t=!1,Aa(e,n),Nk(e,r,i),jg(e,r,i,n),Fg(null,e,r,!0,t,n);case 19:return Vk(t,e,n);case 22:return $k(t,e,n)}throw Error(z(156,e.tag))};function iE(t,e){return MC(t,e)}function RA(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function jn(t,e,n,r){return new RA(t,e,n,r)}function l0(t){return t=t.prototype,!(!t||!t.isReactComponent)}function OA(t){if(typeof t=="function")return l0(t)?1:0;if(t!=null){if(t=t.$$typeof,t===_v)return 11;if(t===Rv)return 14}return 2}function go(t,e){var n=t.alternate;return n===null?(n=jn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function of(t,e,n,r,i,o){var s=2;if(r=t,typeof t=="function")l0(t)&&(s=1);else if(typeof t=="string")s=5;else e:switch(t){case ma:return gs(n.children,i,o,e);case Tv:s=8,i|=8;break;case sg:return t=jn(12,n,e,i|2),t.elementType=sg,t.lanes=o,t;case ag:return t=jn(13,n,e,i),t.elementType=ag,t.lanes=o,t;case lg:return t=jn(19,n,e,i),t.elementType=lg,t.lanes=o,t;case pC:return Nh(n,i,o,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case fC:s=10;break e;case hC:s=9;break e;case _v:s=11;break e;case Rv:s=14;break e;case Oi:s=16,r=null;break e}throw Error(z(130,t==null?t:typeof t,""))}return e=jn(s,n,e,i),e.elementType=t,e.type=r,e.lanes=o,e}function gs(t,e,n,r){return t=jn(7,t,r,e),t.lanes=n,t}function Nh(t,e,n,r){return t=jn(22,t,r,e),t.elementType=pC,t.lanes=n,t.stateNode={isHidden:!1},t}function om(t,e,n){return t=jn(6,t,null,e),t.lanes=n,t}function sm(t,e,n){return e=jn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function PA(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Bp(0),this.expirationTimes=Bp(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Bp(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function c0(t,e,n,r,i,o,s,a,l){return t=new PA(t,e,n,a,l),e===1?(e=1,o===!0&&(e|=8)):e=0,o=jn(3,null,null,e),t.current=o,o.stateNode=t,o.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Kv(o),t}function MA(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:pa,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function oE(t){if(!t)return ko;t=t._reactInternals;e:{if(zs(t)!==t||t.tag!==1)throw Error(z(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(cn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(z(171))}if(t.tag===1){var n=t.type;if(cn(n))return ok(t,n,e)}return e}function sE(t,e,n,r,i,o,s,a,l){return t=c0(n,r,!0,t,i,o,s,a,l),t.context=oE(null),n=t.current,r=Vt(),i=mo(n),o=oi(r,i),o.callback=e??null,ho(n,o,i),t.current.lanes=i,Mu(t,i,r),un(t,r),t}function Dh(t,e,n,r){var i=e.current,o=Vt(),s=mo(i);return n=oE(n),e.context===null?e.context=n:e.pendingContext=n,e=oi(o,s),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=ho(i,e,s),t!==null&&(lr(t,i,s,o),Xd(t,i,s)),s}function Bf(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Jw(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function u0(t,e){Jw(t,e),(t=t.alternate)&&Jw(t,e)}function IA(){return null}var aE=typeof reportError=="function"?reportError:function(t){console.error(t)};function d0(t){this._internalRoot=t}jh.prototype.render=d0.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(z(409));Dh(t,e,null,null)};jh.prototype.unmount=d0.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Rs(function(){Dh(null,t,null,null)}),e[ci]=null}};function jh(t){this._internalRoot=t}jh.prototype.unstable_scheduleHydration=function(t){if(t){var e=$C();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Hi.length&&e!==0&&e<Hi[n].priority;n++);Hi.splice(n,0,t),n===0&&BC(t)}};function f0(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Lh(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Yw(){}function AA(t,e,n,r,i){if(i){if(typeof r=="function"){var o=r;r=function(){var c=Bf(s);o.call(c)}}var s=sE(e,r,t,0,null,!1,!1,"",Yw);return t._reactRootContainer=s,t[ci]=s.current,zc(t.nodeType===8?t.parentNode:t),Rs(),s}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var c=Bf(l);a.call(c)}}var l=c0(t,0,!1,null,null,!1,!1,"",Yw);return t._reactRootContainer=l,t[ci]=l.current,zc(t.nodeType===8?t.parentNode:t),Rs(function(){Dh(e,l,n,r)}),l}function $h(t,e,n,r,i){var o=n._reactRootContainer;if(o){var s=o;if(typeof i=="function"){var a=i;i=function(){var l=Bf(s);a.call(l)}}Dh(e,s,t,i)}else s=AA(n,e,t,i,r);return Bf(s)}jC=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=sc(e.pendingLanes);n!==0&&(Mv(e,n|1),un(e,Ge()),!(we&6)&&(ll=Ge()+500,No()))}break;case 13:Rs(function(){var r=ui(t,1);if(r!==null){var i=Vt();lr(r,t,1,i)}}),u0(t,1)}};Iv=function(t){if(t.tag===13){var e=ui(t,134217728);if(e!==null){var n=Vt();lr(e,t,134217728,n)}u0(t,134217728)}};LC=function(t){if(t.tag===13){var e=mo(t),n=ui(t,e);if(n!==null){var r=Vt();lr(n,t,e,r)}u0(t,e)}};$C=function(){return ke};FC=function(t,e){var n=ke;try{return ke=t,e()}finally{ke=n}};vg=function(t,e,n){switch(e){case"input":if(dg(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=Rh(r);if(!i)throw Error(z(90));gC(r),dg(r,i)}}}break;case"textarea":vC(t,n);break;case"select":e=n.value,e!=null&&Oa(t,!!n.multiple,e,!1)}};EC=o0;TC=Rs;var NA={usingClientEntryPoint:!1,Events:[Au,xa,Rh,CC,kC,o0]},Xl={findFiberByHostInstance:es,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},DA={bundleType:Xl.bundleType,version:Xl.version,rendererPackageName:Xl.rendererPackageName,rendererConfig:Xl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:mi.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=OC(t),t===null?null:t.stateNode},findFiberByHostInstance:Xl.findFiberByHostInstance||IA,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var wd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!wd.isDisabled&&wd.supportsFiber)try{kh=wd.inject(DA),Ar=wd}catch{}}Tn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=NA;Tn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f0(e))throw Error(z(200));return MA(t,e,null,n)};Tn.createRoot=function(t,e){if(!f0(t))throw Error(z(299));var n=!1,r="",i=aE;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=c0(t,1,!1,null,null,n,!1,r,i),t[ci]=e.current,zc(t.nodeType===8?t.parentNode:t),new d0(e)};Tn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(z(188)):(t=Object.keys(t).join(","),Error(z(268,t)));return t=OC(e),t=t===null?null:t.stateNode,t};Tn.flushSync=function(t){return Rs(t)};Tn.hydrate=function(t,e,n){if(!Lh(e))throw Error(z(200));return $h(null,t,e,!0,n)};Tn.hydrateRoot=function(t,e,n){if(!f0(t))throw Error(z(405));var r=n!=null&&n.hydratedSources||null,i=!1,o="",s=aE;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onRecoverableError!==void 0&&(s=n.onRecoverableError)),e=sE(e,null,t,1,n??null,i,!1,o,s),t[ci]=e.current,zc(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new jh(e)};Tn.render=function(t,e,n){if(!Lh(e))throw Error(z(200));return $h(null,t,e,!1,n)};Tn.unmountComponentAtNode=function(t){if(!Lh(t))throw Error(z(40));return t._reactRootContainer?(Rs(function(){$h(null,null,t,!1,function(){t._reactRootContainer=null,t[ci]=null})}),!0):!1};Tn.unstable_batchedUpdates=o0;Tn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Lh(n))throw Error(z(200));if(t==null||t._reactInternals===void 0)throw Error(z(38));return $h(t,e,n,!1,r)};Tn.version="18.3.1-next-f1338f8080-20240426";function lE(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(lE)}catch(t){console.error(t)}}lE(),lC.exports=Tn;var Vs=lC.exports;const cE=YS(Vs);var Qw=Vs;ig.createRoot=Qw.createRoot,ig.hydrateRoot=Qw.hydrateRoot;const jA="modulepreload",LA=function(t){return"/"+t},Xw={},Os=function(e,n,r){if(!n||n.length===0)return e();const i=document.getElementsByTagName("link");return Promise.all(n.map(o=>{if(o=LA(o),o in Xw)return;Xw[o]=!0;const s=o.endsWith(".css"),a=s?'[rel="stylesheet"]':"";if(!!r)for(let u=i.length-1;u>=0;u--){const d=i[u];if(d.href===o&&(!s||d.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${o}"]${a}`))return;const c=document.createElement("link");if(c.rel=s?"stylesheet":jA,s||(c.as="script",c.crossOrigin=""),c.href=o,document.head.appendChild(c),s)return new Promise((u,d)=>{c.addEventListener("load",u),c.addEventListener("error",()=>d(new Error(`Unable to preload CSS for ${o}`)))})})).then(()=>e()).catch(o=>{const s=new Event("vite:preloadError",{cancelable:!0});if(s.payload=o,window.dispatchEvent(s),!s.defaultPrevented)throw o})};var h0={};Object.defineProperty(h0,"__esModule",{value:!0});h0.parse=HA;h0.serialize=WA;const $A=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,FA=/^[\u0021-\u003A\u003C-\u007E]*$/,BA=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,zA=/^[\u0020-\u003A\u003D-\u007E]*$/,VA=Object.prototype.toString,UA=(()=>{const t=function(){};return t.prototype=Object.create(null),t})();function HA(t,e){const n=new UA,r=t.length;if(r<2)return n;const i=(e==null?void 0:e.decode)||KA;let o=0;do{const s=t.indexOf("=",o);if(s===-1)break;const a=t.indexOf(";",o),l=a===-1?r:a;if(s>l){o=t.lastIndexOf(";",s-1)+1;continue}const c=Zw(t,o,s),u=eb(t,s,c),d=t.slice(c,u);if(n[d]===void 0){let h=Zw(t,s+1,l),p=eb(t,l,h);const m=i(t.slice(h,p));n[d]=m}o=l+1}while(o<r);return n}function Zw(t,e,n){do{const r=t.charCodeAt(e);if(r!==32&&r!==9)return e}while(++e<n);return n}function eb(t,e,n){for(;e>n;){const r=t.charCodeAt(--e);if(r!==32&&r!==9)return e+1}return n}function WA(t,e,n){const r=(n==null?void 0:n.encode)||encodeURIComponent;if(!$A.test(t))throw new TypeError(`argument name is invalid: ${t}`);const i=r(e);if(!FA.test(i))throw new TypeError(`argument val is invalid: ${e}`);let o=t+"="+i;if(!n)return o;if(n.maxAge!==void 0){if(!Number.isInteger(n.maxAge))throw new TypeError(`option maxAge is invalid: ${n.maxAge}`);o+="; Max-Age="+n.maxAge}if(n.domain){if(!BA.test(n.domain))throw new TypeError(`option domain is invalid: ${n.domain}`);o+="; Domain="+n.domain}if(n.path){if(!zA.test(n.path))throw new TypeError(`option path is invalid: ${n.path}`);o+="; Path="+n.path}if(n.expires){if(!qA(n.expires)||!Number.isFinite(n.expires.valueOf()))throw new TypeError(`option expires is invalid: ${n.expires}`);o+="; Expires="+n.expires.toUTCString()}if(n.httpOnly&&(o+="; HttpOnly"),n.secure&&(o+="; Secure"),n.partitioned&&(o+="; Partitioned"),n.priority)switch(typeof n.priority=="string"?n.priority.toLowerCase():void 0){case"low":o+="; Priority=Low";break;case"medium":o+="; Priority=Medium";break;case"high":o+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${n.priority}`)}if(n.sameSite)switch(typeof n.sameSite=="string"?n.sameSite.toLowerCase():n.sameSite){case!0:case"strict":o+="; SameSite=Strict";break;case"lax":o+="; SameSite=Lax";break;case"none":o+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${n.sameSite}`)}return o}function KA(t){if(t.indexOf("%")===-1)return t;try{return decodeURIComponent(t)}catch{return t}}function qA(t){return VA.call(t)==="[object Date]"}var tb="popstate";function GA(t={}){function e(r,i){let{pathname:o,search:s,hash:a}=r.location;return Qg("",{pathname:o,search:s,hash:a},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function n(r,i){return typeof i=="string"?i:Yc(i)}return YA(e,n,null,t)}function Fe(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Wn(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function JA(){return Math.random().toString(36).substring(2,10)}function nb(t,e){return{usr:t.state,key:t.key,idx:e}}function Qg(t,e,n=null,r){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?Pl(e):e,state:n,key:e&&e.key||r||JA()}}function Yc({pathname:t="/",search:e="",hash:n=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function Pl(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substring(n),t=t.substring(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substring(r),t=t.substring(0,r)),t&&(e.pathname=t)}return e}function YA(t,e,n,r={}){let{window:i=document.defaultView,v5Compat:o=!1}=r,s=i.history,a="POP",l=null,c=u();c==null&&(c=0,s.replaceState({...s.state,idx:c},""));function u(){return(s.state||{idx:null}).idx}function d(){a="POP";let v=u(),x=v==null?null:v-c;c=v,l&&l({action:a,location:y.location,delta:x})}function h(v,x){a="PUSH";let w=Qg(y.location,v,x);n&&n(w,v),c=u()+1;let b=nb(w,c),S=y.createHref(w);try{s.pushState(b,"",S)}catch(C){if(C instanceof DOMException&&C.name==="DataCloneError")throw C;i.location.assign(S)}o&&l&&l({action:a,location:y.location,delta:1})}function p(v,x){a="REPLACE";let w=Qg(y.location,v,x);n&&n(w,v),c=u();let b=nb(w,c),S=y.createHref(w);s.replaceState(b,"",S),o&&l&&l({action:a,location:y.location,delta:0})}function m(v){let x=i.location.origin!=="null"?i.location.origin:i.location.href,w=typeof v=="string"?v:Yc(v);return w=w.replace(/ $/,"%20"),Fe(x,`No window.location.(origin|href) available to create URL for href: ${w}`),new URL(w,x)}let y={get action(){return a},get location(){return t(i,s)},listen(v){if(l)throw new Error("A history only accepts one active listener");return i.addEventListener(tb,d),l=v,()=>{i.removeEventListener(tb,d),l=null}},createHref(v){return e(i,v)},createURL:m,encodeLocation(v){let x=m(v);return{pathname:x.pathname,search:x.search,hash:x.hash}},push:h,replace:p,go(v){return s.go(v)}};return y}function uE(t,e,n="/"){return QA(t,e,n,!1)}function QA(t,e,n,r){let i=typeof e=="string"?Pl(e):e,o=Eo(i.pathname||"/",n);if(o==null)return null;let s=dE(t);XA(s);let a=null;for(let l=0;a==null&&l<s.length;++l){let c=cN(o);a=aN(s[l],c,r)}return a}function dE(t,e=[],n=[],r=""){let i=(o,s,a)=>{let l={relativePath:a===void 0?o.path||"":a,caseSensitive:o.caseSensitive===!0,childrenIndex:s,route:o};l.relativePath.startsWith("/")&&(Fe(l.relativePath.startsWith(r),`Absolute route path "${l.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),l.relativePath=l.relativePath.slice(r.length));let c=si([r,l.relativePath]),u=n.concat(l);o.children&&o.children.length>0&&(Fe(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${c}".`),dE(o.children,e,u,c)),!(o.path==null&&!o.index)&&e.push({path:c,score:oN(c,o.index),routesMeta:u})};return t.forEach((o,s)=>{var a;if(o.path===""||!((a=o.path)!=null&&a.includes("?")))i(o,s);else for(let l of fE(o.path))i(o,s,l)}),e}function fE(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,i=n.endsWith("?"),o=n.replace(/\?$/,"");if(r.length===0)return i?[o,""]:[o];let s=fE(r.join("/")),a=[];return a.push(...s.map(l=>l===""?o:[o,l].join("/"))),i&&a.push(...s),a.map(l=>t.startsWith("/")&&l===""?"/":l)}function XA(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:sN(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}var ZA=/^:[\w-]+$/,eN=3,tN=2,nN=1,rN=10,iN=-2,rb=t=>t==="*";function oN(t,e){let n=t.split("/"),r=n.length;return n.some(rb)&&(r+=iN),e&&(r+=tN),n.filter(i=>!rb(i)).reduce((i,o)=>i+(ZA.test(o)?eN:o===""?nN:rN),r)}function sN(t,e){return t.length===e.length&&t.slice(0,-1).every((r,i)=>r===e[i])?t[t.length-1]-e[e.length-1]:0}function aN(t,e,n=!1){let{routesMeta:r}=t,i={},o="/",s=[];for(let a=0;a<r.length;++a){let l=r[a],c=a===r.length-1,u=o==="/"?e:e.slice(o.length)||"/",d=zf({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},u),h=l.route;if(!d&&c&&n&&!r[r.length-1].route.index&&(d=zf({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},u)),!d)return null;Object.assign(i,d.params),s.push({params:i,pathname:si([o,d.pathname]),pathnameBase:hN(si([o,d.pathnameBase])),route:h}),d.pathnameBase!=="/"&&(o=si([o,d.pathnameBase]))}return s}function zf(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=lN(t.path,t.caseSensitive,t.end),i=e.match(n);if(!i)return null;let o=i[0],s=o.replace(/(.)\/+$/,"$1"),a=i.slice(1);return{params:r.reduce((c,{paramName:u,isOptional:d},h)=>{if(u==="*"){let m=a[h]||"";s=o.slice(0,o.length-m.length).replace(/(.)\/+$/,"$1")}const p=a[h];return d&&!p?c[u]=void 0:c[u]=(p||"").replace(/%2F/g,"/"),c},{}),pathname:o,pathnameBase:s,pattern:t}}function lN(t,e=!1,n=!0){Wn(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let r=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(s,a,l)=>(r.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),r]}function cN(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Wn(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function Eo(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function uN(t,e="/"){let{pathname:n,search:r="",hash:i=""}=typeof t=="string"?Pl(t):t;return{pathname:n?n.startsWith("/")?n:dN(n,e):e,search:pN(r),hash:mN(i)}}function dN(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?n.length>1&&n.pop():i!=="."&&n.push(i)}),n.length>1?n.join("/"):"/"}function am(t,e,n,r){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function fN(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function p0(t){let e=fN(t);return e.map((n,r)=>r===e.length-1?n.pathname:n.pathnameBase)}function m0(t,e,n,r=!1){let i;typeof t=="string"?i=Pl(t):(i={...t},Fe(!i.pathname||!i.pathname.includes("?"),am("?","pathname","search",i)),Fe(!i.pathname||!i.pathname.includes("#"),am("#","pathname","hash",i)),Fe(!i.search||!i.search.includes("#"),am("#","search","hash",i)));let o=t===""||i.pathname==="",s=o?"/":i.pathname,a;if(s==null)a=n;else{let d=e.length-1;if(!r&&s.startsWith("..")){let h=s.split("/");for(;h[0]==="..";)h.shift(),d-=1;i.pathname=h.join("/")}a=d>=0?e[d]:"/"}let l=uN(i,a),c=s&&s!=="/"&&s.endsWith("/"),u=(o||s===".")&&n.endsWith("/");return!l.pathname.endsWith("/")&&(c||u)&&(l.pathname+="/"),l}var si=t=>t.join("/").replace(/\/\/+/g,"/"),hN=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),pN=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,mN=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function gN(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}var hE=["POST","PUT","PATCH","DELETE"];new Set(hE);var yN=["GET",...hE];new Set(yN);var Ml=g.createContext(null);Ml.displayName="DataRouter";var Fh=g.createContext(null);Fh.displayName="DataRouterState";var pE=g.createContext({isTransitioning:!1});pE.displayName="ViewTransition";var vN=g.createContext(new Map);vN.displayName="Fetchers";var xN=g.createContext(null);xN.displayName="Await";var hr=g.createContext(null);hr.displayName="Navigation";var Du=g.createContext(null);Du.displayName="Location";var pr=g.createContext({outlet:null,matches:[],isDataRoute:!1});pr.displayName="Route";var g0=g.createContext(null);g0.displayName="RouteError";function wN(t,{relative:e}={}){Fe(Il(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:r}=g.useContext(hr),{hash:i,pathname:o,search:s}=ju(t,{relative:e}),a=o;return n!=="/"&&(a=o==="/"?n:si([n,o])),r.createHref({pathname:a,search:s,hash:i})}function Il(){return g.useContext(Du)!=null}function Gn(){return Fe(Il(),"useLocation() may be used only in the context of a <Router> component."),g.useContext(Du).location}var mE="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function gE(t){g.useContext(hr).static||g.useLayoutEffect(t)}function mr(){let{isDataRoute:t}=g.useContext(pr);return t?NN():bN()}function bN(){Fe(Il(),"useNavigate() may be used only in the context of a <Router> component.");let t=g.useContext(Ml),{basename:e,navigator:n}=g.useContext(hr),{matches:r}=g.useContext(pr),{pathname:i}=Gn(),o=JSON.stringify(p0(r)),s=g.useRef(!1);return gE(()=>{s.current=!0}),g.useCallback((l,c={})=>{if(Wn(s.current,mE),!s.current)return;if(typeof l=="number"){n.go(l);return}let u=m0(l,JSON.parse(o),i,c.relative==="path");t==null&&e!=="/"&&(u.pathname=u.pathname==="/"?e:si([e,u.pathname])),(c.replace?n.replace:n.push)(u,c.state,c)},[e,n,o,i,t])}g.createContext(null);function SN(){let{matches:t}=g.useContext(pr),e=t[t.length-1];return e?e.params:{}}function ju(t,{relative:e}={}){let{matches:n}=g.useContext(pr),{pathname:r}=Gn(),i=JSON.stringify(p0(n));return g.useMemo(()=>m0(t,JSON.parse(i),r,e==="path"),[t,i,r,e])}function CN(t,e){return yE(t,e)}function yE(t,e,n,r){var w;Fe(Il(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:i,static:o}=g.useContext(hr),{matches:s}=g.useContext(pr),a=s[s.length-1],l=a?a.params:{},c=a?a.pathname:"/",u=a?a.pathnameBase:"/",d=a&&a.route;{let b=d&&d.path||"";vE(c,!d||b.endsWith("*")||b.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${c}" (under <Route path="${b}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${b}"> to <Route path="${b==="/"?"*":`${b}/*`}">.`)}let h=Gn(),p;if(e){let b=typeof e=="string"?Pl(e):e;Fe(u==="/"||((w=b.pathname)==null?void 0:w.startsWith(u)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${u}" but pathname "${b.pathname}" was given in the \`location\` prop.`),p=b}else p=h;let m=p.pathname||"/",y=m;if(u!=="/"){let b=u.replace(/^\//,"").split("/");y="/"+m.replace(/^\//,"").split("/").slice(b.length).join("/")}let v=!o&&n&&n.matches&&n.matches.length>0?n.matches:uE(t,{pathname:y});Wn(d||v!=null,`No routes matched location "${p.pathname}${p.search}${p.hash}" `),Wn(v==null||v[v.length-1].route.element!==void 0||v[v.length-1].route.Component!==void 0||v[v.length-1].route.lazy!==void 0,`Matched leaf route at location "${p.pathname}${p.search}${p.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let x=RN(v&&v.map(b=>Object.assign({},b,{params:Object.assign({},l,b.params),pathname:si([u,i.encodeLocation?i.encodeLocation(b.pathname).pathname:b.pathname]),pathnameBase:b.pathnameBase==="/"?u:si([u,i.encodeLocation?i.encodeLocation(b.pathnameBase).pathname:b.pathnameBase])})),s,n,r);return e&&x?g.createElement(Du.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...p},navigationType:"POP"}},x):x}function kN(){let t=AN(),e=gN(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,r="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:r},o={padding:"2px 4px",backgroundColor:r},s=null;return console.error("Error handled by React Router default ErrorBoundary:",t),s=g.createElement(g.Fragment,null,g.createElement("p",null,"💿 Hey developer 👋"),g.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",g.createElement("code",{style:o},"ErrorBoundary")," or"," ",g.createElement("code",{style:o},"errorElement")," prop on your route.")),g.createElement(g.Fragment,null,g.createElement("h2",null,"Unexpected Application Error!"),g.createElement("h3",{style:{fontStyle:"italic"}},e),n?g.createElement("pre",{style:i},n):null,s)}var EN=g.createElement(kN,null),TN=class extends g.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){console.error("React Router caught the following error during render",t,e)}render(){return this.state.error!==void 0?g.createElement(pr.Provider,{value:this.props.routeContext},g.createElement(g0.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function _N({routeContext:t,match:e,children:n}){let r=g.useContext(Ml);return r&&r.static&&r.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=e.route.id),g.createElement(pr.Provider,{value:t},n)}function RN(t,e=[],n=null,r=null){if(t==null){if(!n)return null;if(n.errors)t=n.matches;else if(e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let i=t,o=n==null?void 0:n.errors;if(o!=null){let l=i.findIndex(c=>c.route.id&&(o==null?void 0:o[c.route.id])!==void 0);Fe(l>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),i=i.slice(0,Math.min(i.length,l+1))}let s=!1,a=-1;if(n)for(let l=0;l<i.length;l++){let c=i[l];if((c.route.HydrateFallback||c.route.hydrateFallbackElement)&&(a=l),c.route.id){let{loaderData:u,errors:d}=n,h=c.route.loader&&!u.hasOwnProperty(c.route.id)&&(!d||d[c.route.id]===void 0);if(c.route.lazy||h){s=!0,a>=0?i=i.slice(0,a+1):i=[i[0]];break}}}return i.reduceRight((l,c,u)=>{let d,h=!1,p=null,m=null;n&&(d=o&&c.route.id?o[c.route.id]:void 0,p=c.route.errorElement||EN,s&&(a<0&&u===0?(vE("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),h=!0,m=null):a===u&&(h=!0,m=c.route.hydrateFallbackElement||null)));let y=e.concat(i.slice(0,u+1)),v=()=>{let x;return d?x=p:h?x=m:c.route.Component?x=g.createElement(c.route.Component,null):c.route.element?x=c.route.element:x=l,g.createElement(_N,{match:c,routeContext:{outlet:l,matches:y,isDataRoute:n!=null},children:x})};return n&&(c.route.ErrorBoundary||c.route.errorElement||u===0)?g.createElement(TN,{location:n.location,revalidation:n.revalidation,component:p,error:d,children:v(),routeContext:{outlet:null,matches:y,isDataRoute:!0}}):v()},null)}function y0(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function ON(t){let e=g.useContext(Ml);return Fe(e,y0(t)),e}function PN(t){let e=g.useContext(Fh);return Fe(e,y0(t)),e}function MN(t){let e=g.useContext(pr);return Fe(e,y0(t)),e}function v0(t){let e=MN(t),n=e.matches[e.matches.length-1];return Fe(n.route.id,`${t} can only be used on routes that contain a unique "id"`),n.route.id}function IN(){return v0("useRouteId")}function AN(){var r;let t=g.useContext(g0),e=PN("useRouteError"),n=v0("useRouteError");return t!==void 0?t:(r=e.errors)==null?void 0:r[n]}function NN(){let{router:t}=ON("useNavigate"),e=v0("useNavigate"),n=g.useRef(!1);return gE(()=>{n.current=!0}),g.useCallback(async(i,o={})=>{Wn(n.current,mE),n.current&&(typeof i=="number"?t.navigate(i):await t.navigate(i,{fromRouteId:e,...o}))},[t,e])}var ib={};function vE(t,e,n){!e&&!ib[t]&&(ib[t]=!0,Wn(!1,n))}g.memo(DN);function DN({routes:t,future:e,state:n}){return yE(t,void 0,n,e)}function Vf({to:t,replace:e,state:n,relative:r}){Fe(Il(),"<Navigate> may be used only in the context of a <Router> component.");let{static:i}=g.useContext(hr);Wn(!i,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:o}=g.useContext(pr),{pathname:s}=Gn(),a=mr(),l=m0(t,p0(o),s,r==="path"),c=JSON.stringify(l);return g.useEffect(()=>{a(JSON.parse(c),{replace:e,state:n,relative:r})},[a,c,r,e,n]),null}function mn(t){Fe(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function jN({basename:t="/",children:e=null,location:n,navigationType:r="POP",navigator:i,static:o=!1}){Fe(!Il(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let s=t.replace(/^\/*/,"/"),a=g.useMemo(()=>({basename:s,navigator:i,static:o,future:{}}),[s,i,o]);typeof n=="string"&&(n=Pl(n));let{pathname:l="/",search:c="",hash:u="",state:d=null,key:h="default"}=n,p=g.useMemo(()=>{let m=Eo(l,s);return m==null?null:{location:{pathname:m,search:c,hash:u,state:d,key:h},navigationType:r}},[s,l,c,u,d,h,r]);return Wn(p!=null,`<Router basename="${s}"> is not able to match the URL "${l}${c}${u}" because it does not start with the basename, so the <Router> won't render anything.`),p==null?null:g.createElement(hr.Provider,{value:a},g.createElement(Du.Provider,{children:e,value:p}))}function LN({children:t,location:e}){return CN(Xg(t),e)}function Xg(t,e=[]){let n=[];return g.Children.forEach(t,(r,i)=>{if(!g.isValidElement(r))return;let o=[...e,i];if(r.type===g.Fragment){n.push.apply(n,Xg(r.props.children,o));return}Fe(r.type===mn,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Fe(!r.props.index||!r.props.children,"An index route cannot have child routes.");let s={id:r.props.id||o.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(s.children=Xg(r.props.children,o)),n.push(s)}),n}var sf="get",af="application/x-www-form-urlencoded";function Bh(t){return t!=null&&typeof t.tagName=="string"}function $N(t){return Bh(t)&&t.tagName.toLowerCase()==="button"}function FN(t){return Bh(t)&&t.tagName.toLowerCase()==="form"}function BN(t){return Bh(t)&&t.tagName.toLowerCase()==="input"}function zN(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function VN(t,e){return t.button===0&&(!e||e==="_self")&&!zN(t)}function Zg(t=""){return new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,n)=>{let r=t[n];return e.concat(Array.isArray(r)?r.map(i=>[n,i]):[[n,r]])},[]))}function UN(t,e){let n=Zg(t);return e&&e.forEach((r,i)=>{n.has(i)||e.getAll(i).forEach(o=>{n.append(i,o)})}),n}var bd=null;function HN(){if(bd===null)try{new FormData(document.createElement("form"),0),bd=!1}catch{bd=!0}return bd}var WN=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function lm(t){return t!=null&&!WN.has(t)?(Wn(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${af}"`),null):t}function KN(t,e){let n,r,i,o,s;if(FN(t)){let a=t.getAttribute("action");r=a?Eo(a,e):null,n=t.getAttribute("method")||sf,i=lm(t.getAttribute("enctype"))||af,o=new FormData(t)}else if($N(t)||BN(t)&&(t.type==="submit"||t.type==="image")){let a=t.form;if(a==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let l=t.getAttribute("formaction")||a.getAttribute("action");if(r=l?Eo(l,e):null,n=t.getAttribute("formmethod")||a.getAttribute("method")||sf,i=lm(t.getAttribute("formenctype"))||lm(a.getAttribute("enctype"))||af,o=new FormData(a,t),!HN()){let{name:c,type:u,value:d}=t;if(u==="image"){let h=c?`${c}.`:"";o.append(`${h}x`,"0"),o.append(`${h}y`,"0")}else c&&o.append(c,d)}}else{if(Bh(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=sf,r=null,i=af,s=t}return o&&i==="text/plain"&&(s=o,o=void 0),{action:r,method:n.toLowerCase(),encType:i,formData:o,body:s}}function x0(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}async function qN(t,e){if(t.id in e)return e[t.id];try{let n=await Os(()=>import(t.module),[]);return e[t.id]=n,n}catch(n){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function GN(t){return t!=null&&typeof t.page=="string"}function JN(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function YN(t,e,n){let r=await Promise.all(t.map(async i=>{let o=e.routes[i.route.id];if(o){let s=await qN(o,n);return s.links?s.links():[]}return[]}));return e2(r.flat(1).filter(JN).filter(i=>i.rel==="stylesheet"||i.rel==="preload").map(i=>i.rel==="stylesheet"?{...i,rel:"prefetch",as:"style"}:{...i,rel:"prefetch"}))}function ob(t,e,n,r,i,o){let s=(l,c)=>n[c]?l.route.id!==n[c].route.id:!0,a=(l,c)=>{var u;return n[c].pathname!==l.pathname||((u=n[c].route.path)==null?void 0:u.endsWith("*"))&&n[c].params["*"]!==l.params["*"]};return o==="assets"?e.filter((l,c)=>s(l,c)||a(l,c)):o==="data"?e.filter((l,c)=>{var d;let u=r.routes[l.route.id];if(!u||!u.hasLoader)return!1;if(s(l,c)||a(l,c))return!0;if(l.route.shouldRevalidate){let h=l.route.shouldRevalidate({currentUrl:new URL(i.pathname+i.search+i.hash,window.origin),currentParams:((d=n[0])==null?void 0:d.params)||{},nextUrl:new URL(t,window.origin),nextParams:l.params,defaultShouldRevalidate:!0});if(typeof h=="boolean")return h}return!0}):[]}function QN(t,e,{includeHydrateFallback:n}={}){return XN(t.map(r=>{let i=e.routes[r.route.id];if(!i)return[];let o=[i.module];return i.clientActionModule&&(o=o.concat(i.clientActionModule)),i.clientLoaderModule&&(o=o.concat(i.clientLoaderModule)),n&&i.hydrateFallbackModule&&(o=o.concat(i.hydrateFallbackModule)),i.imports&&(o=o.concat(i.imports)),o}).flat(1))}function XN(t){return[...new Set(t)]}function ZN(t){let e={},n=Object.keys(t).sort();for(let r of n)e[r]=t[r];return e}function e2(t,e){let n=new Set,r=new Set(e);return t.reduce((i,o)=>{if(e&&!GN(o)&&o.as==="script"&&o.href&&r.has(o.href))return i;let a=JSON.stringify(ZN(o));return n.has(a)||(n.add(a),i.push({key:a,link:o})),i},[])}function t2(t){let e=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return e.pathname==="/"?e.pathname="_root.data":e.pathname=`${e.pathname.replace(/\/$/,"")}.data`,e}function n2(){let t=g.useContext(Ml);return x0(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function r2(){let t=g.useContext(Fh);return x0(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var w0=g.createContext(void 0);w0.displayName="FrameworkContext";function xE(){let t=g.useContext(w0);return x0(t,"You must render this element inside a <HydratedRouter> element"),t}function i2(t,e){let n=g.useContext(w0),[r,i]=g.useState(!1),[o,s]=g.useState(!1),{onFocus:a,onBlur:l,onMouseEnter:c,onMouseLeave:u,onTouchStart:d}=e,h=g.useRef(null);g.useEffect(()=>{if(t==="render"&&s(!0),t==="viewport"){let y=x=>{x.forEach(w=>{s(w.isIntersecting)})},v=new IntersectionObserver(y,{threshold:.5});return h.current&&v.observe(h.current),()=>{v.disconnect()}}},[t]),g.useEffect(()=>{if(r){let y=setTimeout(()=>{s(!0)},100);return()=>{clearTimeout(y)}}},[r]);let p=()=>{i(!0)},m=()=>{i(!1),s(!1)};return n?t!=="intent"?[o,h,{}]:[o,h,{onFocus:Zl(a,p),onBlur:Zl(l,m),onMouseEnter:Zl(c,p),onMouseLeave:Zl(u,m),onTouchStart:Zl(d,p)}]:[!1,h,{}]}function Zl(t,e){return n=>{t&&t(n),n.defaultPrevented||e(n)}}function o2({page:t,...e}){let{router:n}=n2(),r=g.useMemo(()=>uE(n.routes,t,n.basename),[n.routes,t,n.basename]);return r?g.createElement(a2,{page:t,matches:r,...e}):null}function s2(t){let{manifest:e,routeModules:n}=xE(),[r,i]=g.useState([]);return g.useEffect(()=>{let o=!1;return YN(t,e,n).then(s=>{o||i(s)}),()=>{o=!0}},[t,e,n]),r}function a2({page:t,matches:e,...n}){let r=Gn(),{manifest:i,routeModules:o}=xE(),{loaderData:s,matches:a}=r2(),l=g.useMemo(()=>ob(t,e,a,i,r,"data"),[t,e,a,i,r]),c=g.useMemo(()=>ob(t,e,a,i,r,"assets"),[t,e,a,i,r]),u=g.useMemo(()=>{if(t===r.pathname+r.search+r.hash)return[];let p=new Set,m=!1;if(e.forEach(v=>{var w;let x=i.routes[v.route.id];!x||!x.hasLoader||(!l.some(b=>b.route.id===v.route.id)&&v.route.id in s&&((w=o[v.route.id])!=null&&w.shouldRevalidate)||x.hasClientLoader?m=!0:p.add(v.route.id))}),p.size===0)return[];let y=t2(t);return m&&p.size>0&&y.searchParams.set("_routes",e.filter(v=>p.has(v.route.id)).map(v=>v.route.id).join(",")),[y.pathname+y.search]},[s,r,i,l,e,t,o]),d=g.useMemo(()=>QN(c,i),[c,i]),h=s2(c);return g.createElement(g.Fragment,null,u.map(p=>g.createElement("link",{key:p,rel:"prefetch",as:"fetch",href:p,...n})),d.map(p=>g.createElement("link",{key:p,rel:"modulepreload",href:p,...n})),h.map(({key:p,link:m})=>g.createElement("link",{key:p,...m})))}function l2(...t){return e=>{t.forEach(n=>{typeof n=="function"?n(e):n!=null&&(n.current=e)})}}var wE=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{wE&&(window.__reactRouterVersion="7.2.0")}catch{}function c2({basename:t,children:e,window:n}){let r=g.useRef();r.current==null&&(r.current=GA({window:n,v5Compat:!0}));let i=r.current,[o,s]=g.useState({action:i.action,location:i.location}),a=g.useCallback(l=>{g.startTransition(()=>s(l))},[s]);return g.useLayoutEffect(()=>i.listen(a),[i,a]),g.createElement(jN,{basename:t,children:e,location:o.location,navigationType:o.action,navigator:i})}var bE=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,b0=g.forwardRef(function({onClick:e,discover:n="render",prefetch:r="none",relative:i,reloadDocument:o,replace:s,state:a,target:l,to:c,preventScrollReset:u,viewTransition:d,...h},p){let{basename:m}=g.useContext(hr),y=typeof c=="string"&&bE.test(c),v,x=!1;if(typeof c=="string"&&y&&(v=c,wE))try{let O=new URL(window.location.href),_=c.startsWith("//")?new URL(O.protocol+c):new URL(c),D=Eo(_.pathname,m);_.origin===O.origin&&D!=null?c=D+_.search+_.hash:x=!0}catch{Wn(!1,`<Link to="${c}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let w=wN(c,{relative:i}),[b,S,C]=i2(r,h),k=h2(c,{replace:s,state:a,target:l,preventScrollReset:u,relative:i,viewTransition:d});function E(O){e&&e(O),O.defaultPrevented||k(O)}let T=g.createElement("a",{...h,...C,href:v||w,onClick:x||o?e:E,ref:l2(p,S),target:l,"data-discover":!y&&n==="render"?"true":void 0});return b&&!y?g.createElement(g.Fragment,null,T,g.createElement(o2,{page:w})):T});b0.displayName="Link";var u2=g.forwardRef(function({"aria-current":e="page",caseSensitive:n=!1,className:r="",end:i=!1,style:o,to:s,viewTransition:a,children:l,...c},u){let d=ju(s,{relative:c.relative}),h=Gn(),p=g.useContext(Fh),{navigator:m,basename:y}=g.useContext(hr),v=p!=null&&x2(d)&&a===!0,x=m.encodeLocation?m.encodeLocation(d).pathname:d.pathname,w=h.pathname,b=p&&p.navigation&&p.navigation.location?p.navigation.location.pathname:null;n||(w=w.toLowerCase(),b=b?b.toLowerCase():null,x=x.toLowerCase()),b&&y&&(b=Eo(b,y)||b);const S=x!=="/"&&x.endsWith("/")?x.length-1:x.length;let C=w===x||!i&&w.startsWith(x)&&w.charAt(S)==="/",k=b!=null&&(b===x||!i&&b.startsWith(x)&&b.charAt(x.length)==="/"),E={isActive:C,isPending:k,isTransitioning:v},T=C?e:void 0,O;typeof r=="function"?O=r(E):O=[r,C?"active":null,k?"pending":null,v?"transitioning":null].filter(Boolean).join(" ");let _=typeof o=="function"?o(E):o;return g.createElement(b0,{...c,"aria-current":T,className:O,ref:u,style:_,to:s,viewTransition:a},typeof l=="function"?l(E):l)});u2.displayName="NavLink";var d2=g.forwardRef(({discover:t="render",fetcherKey:e,navigate:n,reloadDocument:r,replace:i,state:o,method:s=sf,action:a,onSubmit:l,relative:c,preventScrollReset:u,viewTransition:d,...h},p)=>{let m=y2(),y=v2(a,{relative:c}),v=s.toLowerCase()==="get"?"get":"post",x=typeof a=="string"&&bE.test(a),w=b=>{if(l&&l(b),b.defaultPrevented)return;b.preventDefault();let S=b.nativeEvent.submitter,C=(S==null?void 0:S.getAttribute("formmethod"))||s;m(S||b.currentTarget,{fetcherKey:e,method:C,navigate:n,replace:i,state:o,relative:c,preventScrollReset:u,viewTransition:d})};return g.createElement("form",{ref:p,method:v,action:y,onSubmit:r?l:w,...h,"data-discover":!x&&t==="render"?"true":void 0})});d2.displayName="Form";function f2(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function SE(t){let e=g.useContext(Ml);return Fe(e,f2(t)),e}function h2(t,{target:e,replace:n,state:r,preventScrollReset:i,relative:o,viewTransition:s}={}){let a=mr(),l=Gn(),c=ju(t,{relative:o});return g.useCallback(u=>{if(VN(u,e)){u.preventDefault();let d=n!==void 0?n:Yc(l)===Yc(c);a(t,{replace:d,state:r,preventScrollReset:i,relative:o,viewTransition:s})}},[l,a,c,n,r,e,t,i,o,s])}function p2(t){Wn(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=g.useRef(Zg(t)),n=g.useRef(!1),r=Gn(),i=g.useMemo(()=>UN(r.search,n.current?null:e.current),[r.search]),o=mr(),s=g.useCallback((a,l)=>{const c=Zg(typeof a=="function"?a(i):a);n.current=!0,o("?"+c,l)},[o,i]);return[i,s]}var m2=0,g2=()=>`__${String(++m2)}__`;function y2(){let{router:t}=SE("useSubmit"),{basename:e}=g.useContext(hr),n=IN();return g.useCallback(async(r,i={})=>{let{action:o,method:s,encType:a,formData:l,body:c}=KN(r,e);if(i.navigate===!1){let u=i.fetcherKey||g2();await t.fetch(u,n,i.action||o,{preventScrollReset:i.preventScrollReset,formData:l,body:c,formMethod:i.method||s,formEncType:i.encType||a,flushSync:i.flushSync})}else await t.navigate(i.action||o,{preventScrollReset:i.preventScrollReset,formData:l,body:c,formMethod:i.method||s,formEncType:i.encType||a,replace:i.replace,state:i.state,fromRouteId:n,flushSync:i.flushSync,viewTransition:i.viewTransition})},[t,e,n])}function v2(t,{relative:e}={}){let{basename:n}=g.useContext(hr),r=g.useContext(pr);Fe(r,"useFormAction must be used inside a RouteContext");let[i]=r.matches.slice(-1),o={...ju(t||".",{relative:e})},s=Gn();if(t==null){o.search=s.search;let a=new URLSearchParams(o.search),l=a.getAll("index");if(l.some(u=>u==="")){a.delete("index"),l.filter(d=>d).forEach(d=>a.append("index",d));let u=a.toString();o.search=u?`?${u}`:""}}return(!t||t===".")&&i.route.index&&(o.search=o.search?o.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(o.pathname=o.pathname==="/"?n:si([n,o.pathname])),Yc(o)}function x2(t,e={}){let n=g.useContext(pE);Fe(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=SE("useViewTransitionState"),i=ju(t,{relative:e.relative});if(!n.isTransitioning)return!1;let o=Eo(n.currentLocation.pathname,r)||n.currentLocation.pathname,s=Eo(n.nextLocation.pathname,r)||n.nextLocation.pathname;return zf(i.pathname,s)!=null||zf(i.pathname,o)!=null}new TextEncoder;var Al=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(t){return this.listeners.add(t),this.onSubscribe(),()=>{this.listeners.delete(t),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},Ps=typeof window>"u"||"Deno"in globalThis;function Mn(){}function w2(t,e){return typeof t=="function"?t(e):t}function ey(t){return typeof t=="number"&&t>=0&&t!==1/0}function CE(t,e){return Math.max(t+(e||0)-Date.now(),0)}function Da(t,e){return typeof t=="function"?t(e):t}function or(t,e){return typeof t=="function"?t(e):t}function sb(t,e){const{type:n="all",exact:r,fetchStatus:i,predicate:o,queryKey:s,stale:a}=t;if(s){if(r){if(e.queryHash!==S0(s,e.options))return!1}else if(!Qc(e.queryKey,s))return!1}if(n!=="all"){const l=e.isActive();if(n==="active"&&!l||n==="inactive"&&l)return!1}return!(typeof a=="boolean"&&e.isStale()!==a||i&&i!==e.state.fetchStatus||o&&!o(e))}function ab(t,e){const{exact:n,status:r,predicate:i,mutationKey:o}=t;if(o){if(!e.options.mutationKey)return!1;if(n){if(Ms(e.options.mutationKey)!==Ms(o))return!1}else if(!Qc(e.options.mutationKey,o))return!1}return!(r&&e.state.status!==r||i&&!i(e))}function S0(t,e){return((e==null?void 0:e.queryKeyHashFn)||Ms)(t)}function Ms(t){return JSON.stringify(t,(e,n)=>ty(n)?Object.keys(n).sort().reduce((r,i)=>(r[i]=n[i],r),{}):n)}function Qc(t,e){return t===e?!0:typeof t!=typeof e?!1:t&&e&&typeof t=="object"&&typeof e=="object"?!Object.keys(e).some(n=>!Qc(t[n],e[n])):!1}function kE(t,e){if(t===e)return t;const n=lb(t)&&lb(e);if(n||ty(t)&&ty(e)){const r=n?t:Object.keys(t),i=r.length,o=n?e:Object.keys(e),s=o.length,a=n?[]:{};let l=0;for(let c=0;c<s;c++){const u=n?c:o[c];(!n&&r.includes(u)||n)&&t[u]===void 0&&e[u]===void 0?(a[u]=void 0,l++):(a[u]=kE(t[u],e[u]),a[u]===t[u]&&t[u]!==void 0&&l++)}return i===s&&l===i?t:a}return e}function Uf(t,e){if(!e||Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(t[n]!==e[n])return!1;return!0}function lb(t){return Array.isArray(t)&&t.length===Object.keys(t).length}function ty(t){if(!cb(t))return!1;const e=t.constructor;if(e===void 0)return!0;const n=e.prototype;return!(!cb(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(t)!==Object.prototype)}function cb(t){return Object.prototype.toString.call(t)==="[object Object]"}function b2(t){return new Promise(e=>{setTimeout(e,t)})}function ny(t,e,n){return typeof n.structuralSharing=="function"?n.structuralSharing(t,e):n.structuralSharing!==!1?kE(t,e):e}function S2(t,e,n=0){const r=[...t,e];return n&&r.length>n?r.slice(1):r}function C2(t,e,n=0){const r=[e,...t];return n&&r.length>n?r.slice(0,-1):r}var C0=Symbol();function EE(t,e){return!t.queryFn&&(e!=null&&e.initialPromise)?()=>e.initialPromise:!t.queryFn||t.queryFn===C0?()=>Promise.reject(new Error(`Missing queryFn: '${t.queryHash}'`)):t.queryFn}var ss,Gi,Va,BS,k2=(BS=class extends Al{constructor(){super();Q(this,ss,void 0);Q(this,Gi,void 0);Q(this,Va,void 0);U(this,Va,e=>{if(!Ps&&window.addEventListener){const n=()=>e();return window.addEventListener("visibilitychange",n,!1),()=>{window.removeEventListener("visibilitychange",n)}}})}onSubscribe(){R(this,Gi)||this.setEventListener(R(this,Va))}onUnsubscribe(){var e;this.hasListeners()||((e=R(this,Gi))==null||e.call(this),U(this,Gi,void 0))}setEventListener(e){var n;U(this,Va,e),(n=R(this,Gi))==null||n.call(this),U(this,Gi,e(r=>{typeof r=="boolean"?this.setFocused(r):this.onFocus()}))}setFocused(e){R(this,ss)!==e&&(U(this,ss,e),this.onFocus())}onFocus(){const e=this.isFocused();this.listeners.forEach(n=>{n(e)})}isFocused(){var e;return typeof R(this,ss)=="boolean"?R(this,ss):((e=globalThis.document)==null?void 0:e.visibilityState)!=="hidden"}},ss=new WeakMap,Gi=new WeakMap,Va=new WeakMap,BS),k0=new k2,Ua,Ji,Ha,zS,E2=(zS=class extends Al{constructor(){super();Q(this,Ua,!0);Q(this,Ji,void 0);Q(this,Ha,void 0);U(this,Ha,e=>{if(!Ps&&window.addEventListener){const n=()=>e(!0),r=()=>e(!1);return window.addEventListener("online",n,!1),window.addEventListener("offline",r,!1),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",r)}}})}onSubscribe(){R(this,Ji)||this.setEventListener(R(this,Ha))}onUnsubscribe(){var e;this.hasListeners()||((e=R(this,Ji))==null||e.call(this),U(this,Ji,void 0))}setEventListener(e){var n;U(this,Ha,e),(n=R(this,Ji))==null||n.call(this),U(this,Ji,e(this.setOnline.bind(this)))}setOnline(e){R(this,Ua)!==e&&(U(this,Ua,e),this.listeners.forEach(r=>{r(e)}))}isOnline(){return R(this,Ua)}},Ua=new WeakMap,Ji=new WeakMap,Ha=new WeakMap,zS),Hf=new E2;function ry(){let t,e;const n=new Promise((i,o)=>{t=i,e=o});n.status="pending",n.catch(()=>{});function r(i){Object.assign(n,i),delete n.resolve,delete n.reject}return n.resolve=i=>{r({status:"fulfilled",value:i}),t(i)},n.reject=i=>{r({status:"rejected",reason:i}),e(i)},n}function T2(t){return Math.min(1e3*2**t,3e4)}function TE(t){return(t??"online")==="online"?Hf.isOnline():!0}var _E=class extends Error{constructor(t){super("CancelledError"),this.revert=t==null?void 0:t.revert,this.silent=t==null?void 0:t.silent}};function cm(t){return t instanceof _E}function RE(t){let e=!1,n=0,r=!1,i;const o=ry(),s=y=>{var v;r||(h(new _E(y)),(v=t.abort)==null||v.call(t))},a=()=>{e=!0},l=()=>{e=!1},c=()=>k0.isFocused()&&(t.networkMode==="always"||Hf.isOnline())&&t.canRun(),u=()=>TE(t.networkMode)&&t.canRun(),d=y=>{var v;r||(r=!0,(v=t.onSuccess)==null||v.call(t,y),i==null||i(),o.resolve(y))},h=y=>{var v;r||(r=!0,(v=t.onError)==null||v.call(t,y),i==null||i(),o.reject(y))},p=()=>new Promise(y=>{var v;i=x=>{(r||c())&&y(x)},(v=t.onPause)==null||v.call(t)}).then(()=>{var y;i=void 0,r||(y=t.onContinue)==null||y.call(t)}),m=()=>{if(r)return;let y;const v=n===0?t.initialPromise:void 0;try{y=v??t.fn()}catch(x){y=Promise.reject(x)}Promise.resolve(y).then(d).catch(x=>{var k;if(r)return;const w=t.retry??(Ps?0:3),b=t.retryDelay??T2,S=typeof b=="function"?b(n,x):b,C=w===!0||typeof w=="number"&&n<w||typeof w=="function"&&w(n,x);if(e||!C){h(x);return}n++,(k=t.onFail)==null||k.call(t,n,x),b2(S).then(()=>c()?void 0:p()).then(()=>{e?h(x):m()})})};return{promise:o,cancel:s,continue:()=>(i==null||i(),o),cancelRetry:a,continueRetry:l,canStart:u,start:()=>(u()?m():p().then(m),o)}}function _2(){let t=[],e=0,n=a=>{a()},r=a=>{a()},i=a=>setTimeout(a,0);const o=a=>{e?t.push(a):i(()=>{n(a)})},s=()=>{const a=t;t=[],a.length&&i(()=>{r(()=>{a.forEach(l=>{n(l)})})})};return{batch:a=>{let l;e++;try{l=a()}finally{e--,e||s()}return l},batchCalls:a=>(...l)=>{o(()=>{a(...l)})},schedule:o,setNotifyFunction:a=>{n=a},setBatchNotifyFunction:a=>{r=a},setScheduler:a=>{i=a}}}var tt=_2(),as,VS,OE=(VS=class{constructor(){Q(this,as,void 0)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),ey(this.gcTime)&&U(this,as,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(t){this.gcTime=Math.max(this.gcTime||0,t??(Ps?1/0:5*60*1e3))}clearGcTimeout(){R(this,as)&&(clearTimeout(R(this,as)),U(this,as,void 0))}},as=new WeakMap,VS),Wa,Ka,Pn,ls,kt,vu,cs,er,Gr,US,R2=(US=class extends OE{constructor(e){super();Q(this,er);Q(this,Wa,void 0);Q(this,Ka,void 0);Q(this,Pn,void 0);Q(this,ls,void 0);Q(this,kt,void 0);Q(this,vu,void 0);Q(this,cs,void 0);U(this,cs,!1),U(this,vu,e.defaultOptions),this.setOptions(e.options),this.observers=[],U(this,ls,e.client),U(this,Pn,R(this,ls).getQueryCache()),this.queryKey=e.queryKey,this.queryHash=e.queryHash,U(this,Wa,O2(this.options)),this.state=e.state??R(this,Wa),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var e;return(e=R(this,kt))==null?void 0:e.promise}setOptions(e){this.options={...R(this,vu),...e},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&R(this,Pn).remove(this)}setData(e,n){const r=ny(this.state.data,e,this.options);return ae(this,er,Gr).call(this,{data:r,type:"success",dataUpdatedAt:n==null?void 0:n.updatedAt,manual:n==null?void 0:n.manual}),r}setState(e,n){ae(this,er,Gr).call(this,{type:"setState",state:e,setStateOptions:n})}cancel(e){var r,i;const n=(r=R(this,kt))==null?void 0:r.promise;return(i=R(this,kt))==null||i.cancel(e),n?n.then(Mn).catch(Mn):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(R(this,Wa))}isActive(){return this.observers.some(e=>or(e.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===C0||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStale(){return this.state.isInvalidated?!0:this.getObserversCount()>0?this.observers.some(e=>e.getCurrentResult().isStale):this.state.data===void 0}isStaleByTime(e=0){return this.state.isInvalidated||this.state.data===void 0||!CE(this.state.dataUpdatedAt,e)}onFocus(){var n;const e=this.observers.find(r=>r.shouldFetchOnWindowFocus());e==null||e.refetch({cancelRefetch:!1}),(n=R(this,kt))==null||n.continue()}onOnline(){var n;const e=this.observers.find(r=>r.shouldFetchOnReconnect());e==null||e.refetch({cancelRefetch:!1}),(n=R(this,kt))==null||n.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),R(this,Pn).notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter(n=>n!==e),this.observers.length||(R(this,kt)&&(R(this,cs)?R(this,kt).cancel({revert:!0}):R(this,kt).cancelRetry()),this.scheduleGc()),R(this,Pn).notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||ae(this,er,Gr).call(this,{type:"invalidate"})}fetch(e,n){var l,c,u;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(n!=null&&n.cancelRefetch))this.cancel({silent:!0});else if(R(this,kt))return R(this,kt).continueRetry(),R(this,kt).promise}if(e&&this.setOptions(e),!this.options.queryFn){const d=this.observers.find(h=>h.options.queryFn);d&&this.setOptions(d.options)}const r=new AbortController,i=d=>{Object.defineProperty(d,"signal",{enumerable:!0,get:()=>(U(this,cs,!0),r.signal)})},o=()=>{const d=EE(this.options,n),h={client:R(this,ls),queryKey:this.queryKey,meta:this.meta};return i(h),U(this,cs,!1),this.options.persister?this.options.persister(d,h,this):d(h)},s={fetchOptions:n,options:this.options,queryKey:this.queryKey,client:R(this,ls),state:this.state,fetchFn:o};i(s),(l=this.options.behavior)==null||l.onFetch(s,this),U(this,Ka,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((c=s.fetchOptions)==null?void 0:c.meta))&&ae(this,er,Gr).call(this,{type:"fetch",meta:(u=s.fetchOptions)==null?void 0:u.meta});const a=d=>{var h,p,m,y;cm(d)&&d.silent||ae(this,er,Gr).call(this,{type:"error",error:d}),cm(d)||((p=(h=R(this,Pn).config).onError)==null||p.call(h,d,this),(y=(m=R(this,Pn).config).onSettled)==null||y.call(m,this.state.data,d,this)),this.scheduleGc()};return U(this,kt,RE({initialPromise:n==null?void 0:n.initialPromise,fn:s.fetchFn,abort:r.abort.bind(r),onSuccess:d=>{var h,p,m,y;if(d===void 0){a(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(d)}catch(v){a(v);return}(p=(h=R(this,Pn).config).onSuccess)==null||p.call(h,d,this),(y=(m=R(this,Pn).config).onSettled)==null||y.call(m,d,this.state.error,this),this.scheduleGc()},onError:a,onFail:(d,h)=>{ae(this,er,Gr).call(this,{type:"failed",failureCount:d,error:h})},onPause:()=>{ae(this,er,Gr).call(this,{type:"pause"})},onContinue:()=>{ae(this,er,Gr).call(this,{type:"continue"})},retry:s.options.retry,retryDelay:s.options.retryDelay,networkMode:s.options.networkMode,canRun:()=>!0})),R(this,kt).start()}},Wa=new WeakMap,Ka=new WeakMap,Pn=new WeakMap,ls=new WeakMap,kt=new WeakMap,vu=new WeakMap,cs=new WeakMap,er=new WeakSet,Gr=function(e){const n=r=>{switch(e.type){case"failed":return{...r,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...r,fetchStatus:"paused"};case"continue":return{...r,fetchStatus:"fetching"};case"fetch":return{...r,...PE(r.data,this.options),fetchMeta:e.meta??null};case"success":return{...r,data:e.data,dataUpdateCount:r.dataUpdateCount+1,dataUpdatedAt:e.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const i=e.error;return cm(i)&&i.revert&&R(this,Ka)?{...R(this,Ka),fetchStatus:"idle"}:{...r,error:i,errorUpdateCount:r.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:r.fetchFailureCount+1,fetchFailureReason:i,fetchStatus:"idle",status:"error"};case"invalidate":return{...r,isInvalidated:!0};case"setState":return{...r,...e.state}}};this.state=n(this.state),tt.batch(()=>{this.observers.forEach(r=>{r.onQueryUpdate()}),R(this,Pn).notify({query:this,type:"updated",action:e})})},US);function PE(t,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:TE(e.networkMode)?"fetching":"paused",...t===void 0&&{error:null,status:"pending"}}}function O2(t){const e=typeof t.initialData=="function"?t.initialData():t.initialData,n=e!==void 0,r=n?typeof t.initialDataUpdatedAt=="function"?t.initialDataUpdatedAt():t.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:n?r??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}var kr,HS,P2=(HS=class extends Al{constructor(e={}){super();Q(this,kr,void 0);this.config=e,U(this,kr,new Map)}build(e,n,r){const i=n.queryKey,o=n.queryHash??S0(i,n);let s=this.get(o);return s||(s=new R2({client:e,queryKey:i,queryHash:o,options:e.defaultQueryOptions(n),state:r,defaultOptions:e.getQueryDefaults(i)}),this.add(s)),s}add(e){R(this,kr).has(e.queryHash)||(R(this,kr).set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const n=R(this,kr).get(e.queryHash);n&&(e.destroy(),n===e&&R(this,kr).delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){tt.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return R(this,kr).get(e)}getAll(){return[...R(this,kr).values()]}find(e){const n={exact:!0,...e};return this.getAll().find(r=>sb(n,r))}findAll(e={}){const n=this.getAll();return Object.keys(e).length>0?n.filter(r=>sb(e,r)):n}notify(e){tt.batch(()=>{this.listeners.forEach(n=>{n(e)})})}onFocus(){tt.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){tt.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}},kr=new WeakMap,HS),Er,$t,us,Tr,ki,WS,M2=(WS=class extends OE{constructor(e){super();Q(this,Tr);Q(this,Er,void 0);Q(this,$t,void 0);Q(this,us,void 0);this.mutationId=e.mutationId,U(this,$t,e.mutationCache),U(this,Er,[]),this.state=e.state||ME(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){R(this,Er).includes(e)||(R(this,Er).push(e),this.clearGcTimeout(),R(this,$t).notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){U(this,Er,R(this,Er).filter(n=>n!==e)),this.scheduleGc(),R(this,$t).notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){R(this,Er).length||(this.state.status==="pending"?this.scheduleGc():R(this,$t).remove(this))}continue(){var e;return((e=R(this,us))==null?void 0:e.continue())??this.execute(this.state.variables)}async execute(e){var i,o,s,a,l,c,u,d,h,p,m,y,v,x,w,b,S,C,k,E;U(this,us,RE({fn:()=>this.options.mutationFn?this.options.mutationFn(e):Promise.reject(new Error("No mutationFn found")),onFail:(T,O)=>{ae(this,Tr,ki).call(this,{type:"failed",failureCount:T,error:O})},onPause:()=>{ae(this,Tr,ki).call(this,{type:"pause"})},onContinue:()=>{ae(this,Tr,ki).call(this,{type:"continue"})},retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>R(this,$t).canRun(this)}));const n=this.state.status==="pending",r=!R(this,us).canStart();try{if(!n){ae(this,Tr,ki).call(this,{type:"pending",variables:e,isPaused:r}),await((o=(i=R(this,$t).config).onMutate)==null?void 0:o.call(i,e,this));const O=await((a=(s=this.options).onMutate)==null?void 0:a.call(s,e));O!==this.state.context&&ae(this,Tr,ki).call(this,{type:"pending",context:O,variables:e,isPaused:r})}const T=await R(this,us).start();return await((c=(l=R(this,$t).config).onSuccess)==null?void 0:c.call(l,T,e,this.state.context,this)),await((d=(u=this.options).onSuccess)==null?void 0:d.call(u,T,e,this.state.context)),await((p=(h=R(this,$t).config).onSettled)==null?void 0:p.call(h,T,null,this.state.variables,this.state.context,this)),await((y=(m=this.options).onSettled)==null?void 0:y.call(m,T,null,e,this.state.context)),ae(this,Tr,ki).call(this,{type:"success",data:T}),T}catch(T){try{throw await((x=(v=R(this,$t).config).onError)==null?void 0:x.call(v,T,e,this.state.context,this)),await((b=(w=this.options).onError)==null?void 0:b.call(w,T,e,this.state.context)),await((C=(S=R(this,$t).config).onSettled)==null?void 0:C.call(S,void 0,T,this.state.variables,this.state.context,this)),await((E=(k=this.options).onSettled)==null?void 0:E.call(k,void 0,T,e,this.state.context)),T}finally{ae(this,Tr,ki).call(this,{type:"error",error:T})}}finally{R(this,$t).runNext(this)}}},Er=new WeakMap,$t=new WeakMap,us=new WeakMap,Tr=new WeakSet,ki=function(e){const n=r=>{switch(e.type){case"failed":return{...r,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...r,isPaused:!0};case"continue":return{...r,isPaused:!1};case"pending":return{...r,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...r,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...r,data:void 0,error:e.error,failureCount:r.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}};this.state=n(this.state),tt.batch(()=>{R(this,Er).forEach(r=>{r.onMutationUpdate(e)}),R(this,$t).notify({mutation:this,type:"updated",action:e})})},WS);function ME(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var Zr,tr,xu,KS,I2=(KS=class extends Al{constructor(e={}){super();Q(this,Zr,void 0);Q(this,tr,void 0);Q(this,xu,void 0);this.config=e,U(this,Zr,new Set),U(this,tr,new Map),U(this,xu,0)}build(e,n,r){const i=new M2({mutationCache:this,mutationId:++rd(this,xu)._,options:e.defaultMutationOptions(n),state:r});return this.add(i),i}add(e){R(this,Zr).add(e);const n=Sd(e);if(typeof n=="string"){const r=R(this,tr).get(n);r?r.push(e):R(this,tr).set(n,[e])}this.notify({type:"added",mutation:e})}remove(e){if(R(this,Zr).delete(e)){const n=Sd(e);if(typeof n=="string"){const r=R(this,tr).get(n);if(r)if(r.length>1){const i=r.indexOf(e);i!==-1&&r.splice(i,1)}else r[0]===e&&R(this,tr).delete(n)}}this.notify({type:"removed",mutation:e})}canRun(e){const n=Sd(e);if(typeof n=="string"){const r=R(this,tr).get(n),i=r==null?void 0:r.find(o=>o.state.status==="pending");return!i||i===e}else return!0}runNext(e){var r;const n=Sd(e);if(typeof n=="string"){const i=(r=R(this,tr).get(n))==null?void 0:r.find(o=>o!==e&&o.state.isPaused);return(i==null?void 0:i.continue())??Promise.resolve()}else return Promise.resolve()}clear(){tt.batch(()=>{R(this,Zr).forEach(e=>{this.notify({type:"removed",mutation:e})}),R(this,Zr).clear(),R(this,tr).clear()})}getAll(){return Array.from(R(this,Zr))}find(e){const n={exact:!0,...e};return this.getAll().find(r=>ab(n,r))}findAll(e={}){return this.getAll().filter(n=>ab(e,n))}notify(e){tt.batch(()=>{this.listeners.forEach(n=>{n(e)})})}resumePausedMutations(){const e=this.getAll().filter(n=>n.state.isPaused);return tt.batch(()=>Promise.all(e.map(n=>n.continue().catch(Mn))))}},Zr=new WeakMap,tr=new WeakMap,xu=new WeakMap,KS);function Sd(t){var e;return(e=t.options.scope)==null?void 0:e.id}function ub(t){return{onFetch:(e,n)=>{var u,d,h,p,m;const r=e.options,i=(h=(d=(u=e.fetchOptions)==null?void 0:u.meta)==null?void 0:d.fetchMore)==null?void 0:h.direction,o=((p=e.state.data)==null?void 0:p.pages)||[],s=((m=e.state.data)==null?void 0:m.pageParams)||[];let a={pages:[],pageParams:[]},l=0;const c=async()=>{let y=!1;const v=b=>{Object.defineProperty(b,"signal",{enumerable:!0,get:()=>(e.signal.aborted?y=!0:e.signal.addEventListener("abort",()=>{y=!0}),e.signal)})},x=EE(e.options,e.fetchOptions),w=async(b,S,C)=>{if(y)return Promise.reject();if(S==null&&b.pages.length)return Promise.resolve(b);const k={client:e.client,queryKey:e.queryKey,pageParam:S,direction:C?"backward":"forward",meta:e.options.meta};v(k);const E=await x(k),{maxPages:T}=e.options,O=C?C2:S2;return{pages:O(b.pages,E,T),pageParams:O(b.pageParams,S,T)}};if(i&&o.length){const b=i==="backward",S=b?A2:db,C={pages:o,pageParams:s},k=S(r,C);a=await w(C,k,b)}else{const b=t??o.length;do{const S=l===0?s[0]??r.initialPageParam:db(r,a);if(l>0&&S==null)break;a=await w(a,S),l++}while(l<b)}return a};e.options.persister?e.fetchFn=()=>{var y,v;return(v=(y=e.options).persister)==null?void 0:v.call(y,c,{client:e.client,queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},n)}:e.fetchFn=c}}}function db(t,{pages:e,pageParams:n}){const r=e.length-1;return e.length>0?t.getNextPageParam(e[r],e,n[r],n):void 0}function A2(t,{pages:e,pageParams:n}){var r;return e.length>0?(r=t.getPreviousPageParam)==null?void 0:r.call(t,e[0],e,n[0],n):void 0}var Ue,Yi,Qi,qa,Ga,Xi,Ja,Ya,qS,IE=(qS=class{constructor(t={}){Q(this,Ue,void 0);Q(this,Yi,void 0);Q(this,Qi,void 0);Q(this,qa,void 0);Q(this,Ga,void 0);Q(this,Xi,void 0);Q(this,Ja,void 0);Q(this,Ya,void 0);U(this,Ue,t.queryCache||new P2),U(this,Yi,t.mutationCache||new I2),U(this,Qi,t.defaultOptions||{}),U(this,qa,new Map),U(this,Ga,new Map),U(this,Xi,0)}mount(){rd(this,Xi)._++,R(this,Xi)===1&&(U(this,Ja,k0.subscribe(async t=>{t&&(await this.resumePausedMutations(),R(this,Ue).onFocus())})),U(this,Ya,Hf.subscribe(async t=>{t&&(await this.resumePausedMutations(),R(this,Ue).onOnline())})))}unmount(){var t,e;rd(this,Xi)._--,R(this,Xi)===0&&((t=R(this,Ja))==null||t.call(this),U(this,Ja,void 0),(e=R(this,Ya))==null||e.call(this),U(this,Ya,void 0))}isFetching(t){return R(this,Ue).findAll({...t,fetchStatus:"fetching"}).length}isMutating(t){return R(this,Yi).findAll({...t,status:"pending"}).length}getQueryData(t){var n;const e=this.defaultQueryOptions({queryKey:t});return(n=R(this,Ue).get(e.queryHash))==null?void 0:n.state.data}ensureQueryData(t){const e=this.defaultQueryOptions(t),n=R(this,Ue).build(this,e),r=n.state.data;return r===void 0?this.fetchQuery(t):(t.revalidateIfStale&&n.isStaleByTime(Da(e.staleTime,n))&&this.prefetchQuery(e),Promise.resolve(r))}getQueriesData(t){return R(this,Ue).findAll(t).map(({queryKey:e,state:n})=>{const r=n.data;return[e,r]})}setQueryData(t,e,n){const r=this.defaultQueryOptions({queryKey:t}),i=R(this,Ue).get(r.queryHash),o=i==null?void 0:i.state.data,s=w2(e,o);if(s!==void 0)return R(this,Ue).build(this,r).setData(s,{...n,manual:!0})}setQueriesData(t,e,n){return tt.batch(()=>R(this,Ue).findAll(t).map(({queryKey:r})=>[r,this.setQueryData(r,e,n)]))}getQueryState(t){var n;const e=this.defaultQueryOptions({queryKey:t});return(n=R(this,Ue).get(e.queryHash))==null?void 0:n.state}removeQueries(t){const e=R(this,Ue);tt.batch(()=>{e.findAll(t).forEach(n=>{e.remove(n)})})}resetQueries(t,e){const n=R(this,Ue);return tt.batch(()=>(n.findAll(t).forEach(r=>{r.reset()}),this.refetchQueries({type:"active",...t},e)))}cancelQueries(t,e={}){const n={revert:!0,...e},r=tt.batch(()=>R(this,Ue).findAll(t).map(i=>i.cancel(n)));return Promise.all(r).then(Mn).catch(Mn)}invalidateQueries(t,e={}){return tt.batch(()=>(R(this,Ue).findAll(t).forEach(n=>{n.invalidate()}),(t==null?void 0:t.refetchType)==="none"?Promise.resolve():this.refetchQueries({...t,type:(t==null?void 0:t.refetchType)??(t==null?void 0:t.type)??"active"},e)))}refetchQueries(t,e={}){const n={...e,cancelRefetch:e.cancelRefetch??!0},r=tt.batch(()=>R(this,Ue).findAll(t).filter(i=>!i.isDisabled()).map(i=>{let o=i.fetch(void 0,n);return n.throwOnError||(o=o.catch(Mn)),i.state.fetchStatus==="paused"?Promise.resolve():o}));return Promise.all(r).then(Mn)}fetchQuery(t){const e=this.defaultQueryOptions(t);e.retry===void 0&&(e.retry=!1);const n=R(this,Ue).build(this,e);return n.isStaleByTime(Da(e.staleTime,n))?n.fetch(e):Promise.resolve(n.state.data)}prefetchQuery(t){return this.fetchQuery(t).then(Mn).catch(Mn)}fetchInfiniteQuery(t){return t.behavior=ub(t.pages),this.fetchQuery(t)}prefetchInfiniteQuery(t){return this.fetchInfiniteQuery(t).then(Mn).catch(Mn)}ensureInfiniteQueryData(t){return t.behavior=ub(t.pages),this.ensureQueryData(t)}resumePausedMutations(){return Hf.isOnline()?R(this,Yi).resumePausedMutations():Promise.resolve()}getQueryCache(){return R(this,Ue)}getMutationCache(){return R(this,Yi)}getDefaultOptions(){return R(this,Qi)}setDefaultOptions(t){U(this,Qi,t)}setQueryDefaults(t,e){R(this,qa).set(Ms(t),{queryKey:t,defaultOptions:e})}getQueryDefaults(t){const e=[...R(this,qa).values()],n={};return e.forEach(r=>{Qc(t,r.queryKey)&&Object.assign(n,r.defaultOptions)}),n}setMutationDefaults(t,e){R(this,Ga).set(Ms(t),{mutationKey:t,defaultOptions:e})}getMutationDefaults(t){const e=[...R(this,Ga).values()],n={};return e.forEach(r=>{Qc(t,r.mutationKey)&&Object.assign(n,r.defaultOptions)}),n}defaultQueryOptions(t){if(t._defaulted)return t;const e={...R(this,Qi).queries,...this.getQueryDefaults(t.queryKey),...t,_defaulted:!0};return e.queryHash||(e.queryHash=S0(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.queryFn===C0&&(e.enabled=!1),e}defaultMutationOptions(t){return t!=null&&t._defaulted?t:{...R(this,Qi).mutations,...(t==null?void 0:t.mutationKey)&&this.getMutationDefaults(t.mutationKey),...t,_defaulted:!0}}clear(){R(this,Ue).clear(),R(this,Yi).clear()}},Ue=new WeakMap,Yi=new WeakMap,Qi=new WeakMap,qa=new WeakMap,Ga=new WeakMap,Xi=new WeakMap,Ja=new WeakMap,Ya=new WeakMap,qS),Zt,pe,wu,Ft,ds,Qa,Zi,_r,bu,Xa,Za,fs,hs,eo,el,ps,lc,Su,iy,Cu,oy,ku,sy,Eu,ay,Tu,ly,_u,cy,Ru,uy,Sh,AE,GS,N2=(GS=class extends Al{constructor(e,n){super();Q(this,ps);Q(this,Su);Q(this,Cu);Q(this,ku);Q(this,Eu);Q(this,Tu);Q(this,_u);Q(this,Ru);Q(this,Sh);Q(this,Zt,void 0);Q(this,pe,void 0);Q(this,wu,void 0);Q(this,Ft,void 0);Q(this,ds,void 0);Q(this,Qa,void 0);Q(this,Zi,void 0);Q(this,_r,void 0);Q(this,bu,void 0);Q(this,Xa,void 0);Q(this,Za,void 0);Q(this,fs,void 0);Q(this,hs,void 0);Q(this,eo,void 0);Q(this,el,new Set);this.options=n,U(this,Zt,e),U(this,_r,null),U(this,Zi,ry()),this.options.experimental_prefetchInRender||R(this,Zi).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(n)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(R(this,pe).addObserver(this),fb(R(this,pe),this.options)?ae(this,ps,lc).call(this):this.updateResult(),ae(this,Eu,ay).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return dy(R(this,pe),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return dy(R(this,pe),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,ae(this,Tu,ly).call(this),ae(this,_u,cy).call(this),R(this,pe).removeObserver(this)}setOptions(e,n){const r=this.options,i=R(this,pe);if(this.options=R(this,Zt).defaultQueryOptions(e),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof or(this.options.enabled,R(this,pe))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");ae(this,Ru,uy).call(this),R(this,pe).setOptions(this.options),r._defaulted&&!Uf(this.options,r)&&R(this,Zt).getQueryCache().notify({type:"observerOptionsUpdated",query:R(this,pe),observer:this});const o=this.hasListeners();o&&hb(R(this,pe),i,this.options,r)&&ae(this,ps,lc).call(this),this.updateResult(n),o&&(R(this,pe)!==i||or(this.options.enabled,R(this,pe))!==or(r.enabled,R(this,pe))||Da(this.options.staleTime,R(this,pe))!==Da(r.staleTime,R(this,pe)))&&ae(this,Su,iy).call(this);const s=ae(this,Cu,oy).call(this);o&&(R(this,pe)!==i||or(this.options.enabled,R(this,pe))!==or(r.enabled,R(this,pe))||s!==R(this,eo))&&ae(this,ku,sy).call(this,s)}getOptimisticResult(e){const n=R(this,Zt).getQueryCache().build(R(this,Zt),e),r=this.createResult(n,e);return j2(this,r)&&(U(this,Ft,r),U(this,Qa,this.options),U(this,ds,R(this,pe).state)),r}getCurrentResult(){return R(this,Ft)}trackResult(e,n){const r={};return Object.keys(e).forEach(i=>{Object.defineProperty(r,i,{configurable:!1,enumerable:!0,get:()=>(this.trackProp(i),n==null||n(i),e[i])})}),r}trackProp(e){R(this,el).add(e)}getCurrentQuery(){return R(this,pe)}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){const n=R(this,Zt).defaultQueryOptions(e),r=R(this,Zt).getQueryCache().build(R(this,Zt),n);return r.fetch().then(()=>this.createResult(r,n))}fetch(e){return ae(this,ps,lc).call(this,{...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),R(this,Ft)))}createResult(e,n){var T;const r=R(this,pe),i=this.options,o=R(this,Ft),s=R(this,ds),a=R(this,Qa),c=e!==r?e.state:R(this,wu),{state:u}=e;let d={...u},h=!1,p;if(n._optimisticResults){const O=this.hasListeners(),_=!O&&fb(e,n),D=O&&hb(e,r,n,i);(_||D)&&(d={...d,...PE(u.data,e.options)}),n._optimisticResults==="isRestoring"&&(d.fetchStatus="idle")}let{error:m,errorUpdatedAt:y,status:v}=d;if(n.select&&d.data!==void 0)if(o&&d.data===(s==null?void 0:s.data)&&n.select===R(this,bu))p=R(this,Xa);else try{U(this,bu,n.select),p=n.select(d.data),p=ny(o==null?void 0:o.data,p,n),U(this,Xa,p),U(this,_r,null)}catch(O){U(this,_r,O)}else p=d.data;if(n.placeholderData!==void 0&&p===void 0&&v==="pending"){let O;if(o!=null&&o.isPlaceholderData&&n.placeholderData===(a==null?void 0:a.placeholderData))O=o.data;else if(O=typeof n.placeholderData=="function"?n.placeholderData((T=R(this,Za))==null?void 0:T.state.data,R(this,Za)):n.placeholderData,n.select&&O!==void 0)try{O=n.select(O),U(this,_r,null)}catch(_){U(this,_r,_)}O!==void 0&&(v="success",p=ny(o==null?void 0:o.data,O,n),h=!0)}R(this,_r)&&(m=R(this,_r),p=R(this,Xa),y=Date.now(),v="error");const x=d.fetchStatus==="fetching",w=v==="pending",b=v==="error",S=w&&x,C=p!==void 0,E={status:v,fetchStatus:d.fetchStatus,isPending:w,isSuccess:v==="success",isError:b,isInitialLoading:S,isLoading:S,data:p,dataUpdatedAt:d.dataUpdatedAt,error:m,errorUpdatedAt:y,failureCount:d.fetchFailureCount,failureReason:d.fetchFailureReason,errorUpdateCount:d.errorUpdateCount,isFetched:d.dataUpdateCount>0||d.errorUpdateCount>0,isFetchedAfterMount:d.dataUpdateCount>c.dataUpdateCount||d.errorUpdateCount>c.errorUpdateCount,isFetching:x,isRefetching:x&&!w,isLoadingError:b&&!C,isPaused:d.fetchStatus==="paused",isPlaceholderData:h,isRefetchError:b&&C,isStale:E0(e,n),refetch:this.refetch,promise:R(this,Zi)};if(this.options.experimental_prefetchInRender){const O=L=>{E.status==="error"?L.reject(E.error):E.data!==void 0&&L.resolve(E.data)},_=()=>{const L=U(this,Zi,E.promise=ry());O(L)},D=R(this,Zi);switch(D.status){case"pending":e.queryHash===r.queryHash&&O(D);break;case"fulfilled":(E.status==="error"||E.data!==D.value)&&_();break;case"rejected":(E.status!=="error"||E.error!==D.reason)&&_();break}}return E}updateResult(e){const n=R(this,Ft),r=this.createResult(R(this,pe),this.options);if(U(this,ds,R(this,pe).state),U(this,Qa,this.options),R(this,ds).data!==void 0&&U(this,Za,R(this,pe)),Uf(r,n))return;U(this,Ft,r);const i={},o=()=>{if(!n)return!0;const{notifyOnChangeProps:s}=this.options,a=typeof s=="function"?s():s;if(a==="all"||!a&&!R(this,el).size)return!0;const l=new Set(a??R(this,el));return this.options.throwOnError&&l.add("error"),Object.keys(R(this,Ft)).some(c=>{const u=c;return R(this,Ft)[u]!==n[u]&&l.has(u)})};(e==null?void 0:e.listeners)!==!1&&o()&&(i.listeners=!0),ae(this,Sh,AE).call(this,{...i,...e})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&ae(this,Eu,ay).call(this)}},Zt=new WeakMap,pe=new WeakMap,wu=new WeakMap,Ft=new WeakMap,ds=new WeakMap,Qa=new WeakMap,Zi=new WeakMap,_r=new WeakMap,bu=new WeakMap,Xa=new WeakMap,Za=new WeakMap,fs=new WeakMap,hs=new WeakMap,eo=new WeakMap,el=new WeakMap,ps=new WeakSet,lc=function(e){ae(this,Ru,uy).call(this);let n=R(this,pe).fetch(this.options,e);return e!=null&&e.throwOnError||(n=n.catch(Mn)),n},Su=new WeakSet,iy=function(){ae(this,Tu,ly).call(this);const e=Da(this.options.staleTime,R(this,pe));if(Ps||R(this,Ft).isStale||!ey(e))return;const r=CE(R(this,Ft).dataUpdatedAt,e)+1;U(this,fs,setTimeout(()=>{R(this,Ft).isStale||this.updateResult()},r))},Cu=new WeakSet,oy=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(R(this,pe)):this.options.refetchInterval)??!1},ku=new WeakSet,sy=function(e){ae(this,_u,cy).call(this),U(this,eo,e),!(Ps||or(this.options.enabled,R(this,pe))===!1||!ey(R(this,eo))||R(this,eo)===0)&&U(this,hs,setInterval(()=>{(this.options.refetchIntervalInBackground||k0.isFocused())&&ae(this,ps,lc).call(this)},R(this,eo)))},Eu=new WeakSet,ay=function(){ae(this,Su,iy).call(this),ae(this,ku,sy).call(this,ae(this,Cu,oy).call(this))},Tu=new WeakSet,ly=function(){R(this,fs)&&(clearTimeout(R(this,fs)),U(this,fs,void 0))},_u=new WeakSet,cy=function(){R(this,hs)&&(clearInterval(R(this,hs)),U(this,hs,void 0))},Ru=new WeakSet,uy=function(){const e=R(this,Zt).getQueryCache().build(R(this,Zt),this.options);if(e===R(this,pe))return;const n=R(this,pe);U(this,pe,e),U(this,wu,e.state),this.hasListeners()&&(n==null||n.removeObserver(this),e.addObserver(this))},Sh=new WeakSet,AE=function(e){tt.batch(()=>{e.listeners&&this.listeners.forEach(n=>{n(R(this,Ft))}),R(this,Zt).getQueryCache().notify({query:R(this,pe),type:"observerResultsUpdated"})})},GS);function D2(t,e){return or(e.enabled,t)!==!1&&t.state.data===void 0&&!(t.state.status==="error"&&e.retryOnMount===!1)}function fb(t,e){return D2(t,e)||t.state.data!==void 0&&dy(t,e,e.refetchOnMount)}function dy(t,e,n){if(or(e.enabled,t)!==!1){const r=typeof n=="function"?n(t):n;return r==="always"||r!==!1&&E0(t,e)}return!1}function hb(t,e,n,r){return(t!==e||or(r.enabled,t)===!1)&&(!n.suspense||t.state.status!=="error")&&E0(t,n)}function E0(t,e){return or(e.enabled,t)!==!1&&t.isStaleByTime(Da(e.staleTime,t))}function j2(t,e){return!Uf(t.getCurrentResult(),e)}var to,no,en,ei,tl,lf,Ou,fy,JS,L2=(JS=class extends Al{constructor(n,r){super();Q(this,tl);Q(this,Ou);Q(this,to,void 0);Q(this,no,void 0);Q(this,en,void 0);Q(this,ei,void 0);U(this,to,n),this.setOptions(r),this.bindMethods(),ae(this,tl,lf).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(n){var i;const r=this.options;this.options=R(this,to).defaultMutationOptions(n),Uf(this.options,r)||R(this,to).getMutationCache().notify({type:"observerOptionsUpdated",mutation:R(this,en),observer:this}),r!=null&&r.mutationKey&&this.options.mutationKey&&Ms(r.mutationKey)!==Ms(this.options.mutationKey)?this.reset():((i=R(this,en))==null?void 0:i.state.status)==="pending"&&R(this,en).setOptions(this.options)}onUnsubscribe(){var n;this.hasListeners()||(n=R(this,en))==null||n.removeObserver(this)}onMutationUpdate(n){ae(this,tl,lf).call(this),ae(this,Ou,fy).call(this,n)}getCurrentResult(){return R(this,no)}reset(){var n;(n=R(this,en))==null||n.removeObserver(this),U(this,en,void 0),ae(this,tl,lf).call(this),ae(this,Ou,fy).call(this)}mutate(n,r){var i;return U(this,ei,r),(i=R(this,en))==null||i.removeObserver(this),U(this,en,R(this,to).getMutationCache().build(R(this,to),this.options)),R(this,en).addObserver(this),R(this,en).execute(n)}},to=new WeakMap,no=new WeakMap,en=new WeakMap,ei=new WeakMap,tl=new WeakSet,lf=function(){var r;const n=((r=R(this,en))==null?void 0:r.state)??ME();U(this,no,{...n,isPending:n.status==="pending",isSuccess:n.status==="success",isError:n.status==="error",isIdle:n.status==="idle",mutate:this.mutate,reset:this.reset})},Ou=new WeakSet,fy=function(n){tt.batch(()=>{var r,i,o,s,a,l,c,u;if(R(this,ei)&&this.hasListeners()){const d=R(this,no).variables,h=R(this,no).context;(n==null?void 0:n.type)==="success"?((i=(r=R(this,ei)).onSuccess)==null||i.call(r,n.data,d,h),(s=(o=R(this,ei)).onSettled)==null||s.call(o,n.data,null,d,h)):(n==null?void 0:n.type)==="error"&&((l=(a=R(this,ei)).onError)==null||l.call(a,n.error,d,h),(u=(c=R(this,ei)).onSettled)==null||u.call(c,void 0,n.error,d,h))}this.listeners.forEach(d=>{d(R(this,no))})})},JS),NE=g.createContext(void 0),Ur=t=>{const e=g.useContext(NE);if(t)return t;if(!e)throw new Error("No QueryClient set, use QueryClientProvider to set one");return e},DE=({client:t,children:e})=>(g.useEffect(()=>(t.mount(),()=>{t.unmount()}),[t]),f.jsx(NE.Provider,{value:t,children:e})),jE=g.createContext(!1),$2=()=>g.useContext(jE);jE.Provider;function F2(){let t=!1;return{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t}}var B2=g.createContext(F2()),z2=()=>g.useContext(B2);function LE(t,e){return typeof t=="function"?t(...e):!!t}function hy(){}var V2=(t,e)=>{(t.suspense||t.throwOnError||t.experimental_prefetchInRender)&&(e.isReset()||(t.retryOnMount=!1))},U2=t=>{g.useEffect(()=>{t.clearReset()},[t])},H2=({result:t,errorResetBoundary:e,throwOnError:n,query:r,suspense:i})=>t.isError&&!e.isReset()&&!t.isFetching&&r&&(i&&t.data===void 0||LE(n,[t.error,r])),W2=t=>{const e=t.staleTime;t.suspense&&(t.staleTime=typeof e=="function"?(...n)=>Math.max(e(...n),1e3):Math.max(e??1e3,1e3),typeof t.gcTime=="number"&&(t.gcTime=Math.max(t.gcTime,1e3)))},K2=(t,e)=>t.isLoading&&t.isFetching&&!e,q2=(t,e)=>(t==null?void 0:t.suspense)&&e.isPending,pb=(t,e,n)=>e.fetchOptimistic(t).catch(()=>{n.clearReset()});function G2(t,e,n){var d,h,p,m,y;const r=Ur(n),i=$2(),o=z2(),s=r.defaultQueryOptions(t);(h=(d=r.getDefaultOptions().queries)==null?void 0:d._experimental_beforeQuery)==null||h.call(d,s),s._optimisticResults=i?"isRestoring":"optimistic",W2(s),V2(s,o),U2(o);const a=!r.getQueryCache().get(s.queryHash),[l]=g.useState(()=>new e(r,s)),c=l.getOptimisticResult(s),u=!i&&t.subscribed!==!1;if(g.useSyncExternalStore(g.useCallback(v=>{const x=u?l.subscribe(tt.batchCalls(v)):hy;return l.updateResult(),x},[l,u]),()=>l.getCurrentResult(),()=>l.getCurrentResult()),g.useEffect(()=>{l.setOptions(s,{listeners:!1})},[s,l]),q2(s,c))throw pb(s,l,o);if(H2({result:c,errorResetBoundary:o,throwOnError:s.throwOnError,query:r.getQueryCache().get(s.queryHash),suspense:s.suspense}))throw c.error;if((m=(p=r.getDefaultOptions().queries)==null?void 0:p._experimental_afterQuery)==null||m.call(p,s,c),s.experimental_prefetchInRender&&!Ps&&K2(c,i)){const v=a?pb(s,l,o):(y=r.getQueryCache().get(s.queryHash))==null?void 0:y.promise;v==null||v.catch(hy).finally(()=>{l.updateResult()})}return s.notifyOnChangeProps?c:l.trackResult(c)}function Xc(t,e){return G2(t,N2,e)}function Pr(t,e){const n=Ur(e),[r]=g.useState(()=>new L2(n,t));g.useEffect(()=>{r.setOptions(t)},[r,t]);const i=g.useSyncExternalStore(g.useCallback(s=>r.subscribe(tt.batchCalls(s)),[r]),()=>r.getCurrentResult(),()=>r.getCurrentResult()),o=g.useCallback((s,a)=>{r.mutate(s,a).catch(hy)},[r]);if(i.error&&LE(r.options.throwOnError,[i.error]))throw i.error;return{...i,mutate:o,mutateAsync:i.mutate}}const J2=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>Os(()=>Promise.resolve().then(()=>Nl),void 0).then(({default:r})=>r(...n)):e=fetch,(...n)=>e(...n)};class T0 extends Error{constructor(e,n="FunctionsError",r){super(e),this.name=n,this.context=r}}class Y2 extends T0{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Q2 extends T0{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class X2 extends T0{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var py;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(py||(py={}));var Z2=globalThis&&globalThis.__awaiter||function(t,e,n,r){function i(o){return o instanceof n?o:new n(function(s){s(o)})}return new(n||(n=Promise))(function(o,s){function a(u){try{c(r.next(u))}catch(d){s(d)}}function l(u){try{c(r.throw(u))}catch(d){s(d)}}function c(u){u.done?o(u.value):i(u.value).then(a,l)}c((r=r.apply(t,e||[])).next())})};class eD{constructor(e,{headers:n={},customFetch:r,region:i=py.Any}={}){this.url=e,this.headers=n,this.region=i,this.fetch=J2(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,n={}){var r;return Z2(this,void 0,void 0,function*(){try{const{headers:i,method:o,body:s}=n;let a={},{region:l}=n;l||(l=this.region),l&&l!=="any"&&(a["x-region"]=l);let c;s&&(i&&!Object.prototype.hasOwnProperty.call(i,"Content-Type")||!i)&&(typeof Blob<"u"&&s instanceof Blob||s instanceof ArrayBuffer?(a["Content-Type"]="application/octet-stream",c=s):typeof s=="string"?(a["Content-Type"]="text/plain",c=s):typeof FormData<"u"&&s instanceof FormData?c=s:(a["Content-Type"]="application/json",c=JSON.stringify(s)));const u=yield this.fetch(`${this.url}/${e}`,{method:o||"POST",headers:Object.assign(Object.assign(Object.assign({},a),this.headers),i),body:c}).catch(m=>{throw new Y2(m)}),d=u.headers.get("x-relay-error");if(d&&d==="true")throw new Q2(u);if(!u.ok)throw new X2(u);let h=((r=u.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),p;return h==="application/json"?p=yield u.json():h==="application/octet-stream"?p=yield u.blob():h==="text/event-stream"?p=u:h==="multipart/form-data"?p=yield u.formData():p=yield u.text(),{data:p,error:null}}catch(i){return{data:null,error:i}}})}}var rn={},_0={},zh={},Lu={},Vh={},Uh={},tD=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},cl=tD();const nD=cl.fetch,$E=cl.fetch.bind(cl),FE=cl.Headers,rD=cl.Request,iD=cl.Response,Nl=Object.freeze(Object.defineProperty({__proto__:null,Headers:FE,Request:rD,Response:iD,default:$E,fetch:nD},Symbol.toStringTag,{value:"Module"})),oD=cM(Nl);var Hh={};Object.defineProperty(Hh,"__esModule",{value:!0});let sD=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}};Hh.default=sD;var BE=Vn&&Vn.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Uh,"__esModule",{value:!0});const aD=BE(oD),lD=BE(Hh);let cD=class{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=aD.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,n){return this.headers=Object.assign({},this.headers),this.headers[e]=n,this}then(e,n){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const r=this.fetch;let i=r(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async o=>{var s,a,l;let c=null,u=null,d=null,h=o.status,p=o.statusText;if(o.ok){if(this.method!=="HEAD"){const x=await o.text();x===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?u=x:u=JSON.parse(x))}const y=(s=this.headers.Prefer)===null||s===void 0?void 0:s.match(/count=(exact|planned|estimated)/),v=(a=o.headers.get("content-range"))===null||a===void 0?void 0:a.split("/");y&&v&&v.length>1&&(d=parseInt(v[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(u)&&(u.length>1?(c={code:"PGRST116",details:`Results contain ${u.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},u=null,d=null,h=406,p="Not Acceptable"):u.length===1?u=u[0]:u=null)}else{const y=await o.text();try{c=JSON.parse(y),Array.isArray(c)&&o.status===404&&(u=[],c=null,h=200,p="OK")}catch{o.status===404&&y===""?(h=204,p="No Content"):c={message:y}}if(c&&this.isMaybeSingle&&(!((l=c==null?void 0:c.details)===null||l===void 0)&&l.includes("0 rows"))&&(c=null,h=200,p="OK"),c&&this.shouldThrowOnError)throw new lD.default(c)}return{error:c,data:u,count:d,status:h,statusText:p}});return this.shouldThrowOnError||(i=i.catch(o=>{var s,a,l;return{error:{message:`${(s=o==null?void 0:o.name)!==null&&s!==void 0?s:"FetchError"}: ${o==null?void 0:o.message}`,details:`${(a=o==null?void 0:o.stack)!==null&&a!==void 0?a:""}`,hint:"",code:`${(l=o==null?void 0:o.code)!==null&&l!==void 0?l:""}`},data:null,count:null,status:0,statusText:""}})),i.then(e,n)}returns(){return this}overrideTypes(){return this}};Uh.default=cD;var uD=Vn&&Vn.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Vh,"__esModule",{value:!0});const dD=uD(Uh);let fD=class extends dD.default{select(e){let n=!1;const r=(e??"*").split("").map(i=>/\s/.test(i)&&!n?"":(i==='"'&&(n=!n),i)).join("");return this.url.searchParams.set("select",r),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:n=!0,nullsFirst:r,foreignTable:i,referencedTable:o=i}={}){const s=o?`${o}.order`:"order",a=this.url.searchParams.get(s);return this.url.searchParams.set(s,`${a?`${a},`:""}${e}.${n?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:n,referencedTable:r=n}={}){const i=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(i,`${e}`),this}range(e,n,{foreignTable:r,referencedTable:i=r}={}){const o=typeof i>"u"?"offset":`${i}.offset`,s=typeof i>"u"?"limit":`${i}.limit`;return this.url.searchParams.set(o,`${e}`),this.url.searchParams.set(s,`${n-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:n=!1,settings:r=!1,buffers:i=!1,wal:o=!1,format:s="text"}={}){var a;const l=[e?"analyze":null,n?"verbose":null,r?"settings":null,i?"buffers":null,o?"wal":null].filter(Boolean).join("|"),c=(a=this.headers.Accept)!==null&&a!==void 0?a:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${s}; for="${c}"; options=${l};`,s==="json"?this:this}rollback(){var e;return((e=this.headers.Prefer)!==null&&e!==void 0?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};Vh.default=fD;var hD=Vn&&Vn.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Lu,"__esModule",{value:!0});const pD=hD(Vh);let mD=class extends pD.default{eq(e,n){return this.url.searchParams.append(e,`eq.${n}`),this}neq(e,n){return this.url.searchParams.append(e,`neq.${n}`),this}gt(e,n){return this.url.searchParams.append(e,`gt.${n}`),this}gte(e,n){return this.url.searchParams.append(e,`gte.${n}`),this}lt(e,n){return this.url.searchParams.append(e,`lt.${n}`),this}lte(e,n){return this.url.searchParams.append(e,`lte.${n}`),this}like(e,n){return this.url.searchParams.append(e,`like.${n}`),this}likeAllOf(e,n){return this.url.searchParams.append(e,`like(all).{${n.join(",")}}`),this}likeAnyOf(e,n){return this.url.searchParams.append(e,`like(any).{${n.join(",")}}`),this}ilike(e,n){return this.url.searchParams.append(e,`ilike.${n}`),this}ilikeAllOf(e,n){return this.url.searchParams.append(e,`ilike(all).{${n.join(",")}}`),this}ilikeAnyOf(e,n){return this.url.searchParams.append(e,`ilike(any).{${n.join(",")}}`),this}is(e,n){return this.url.searchParams.append(e,`is.${n}`),this}in(e,n){const r=Array.from(new Set(n)).map(i=>typeof i=="string"&&new RegExp("[,()]").test(i)?`"${i}"`:`${i}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}contains(e,n){return typeof n=="string"?this.url.searchParams.append(e,`cs.${n}`):Array.isArray(n)?this.url.searchParams.append(e,`cs.{${n.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(n)}`),this}containedBy(e,n){return typeof n=="string"?this.url.searchParams.append(e,`cd.${n}`):Array.isArray(n)?this.url.searchParams.append(e,`cd.{${n.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(n)}`),this}rangeGt(e,n){return this.url.searchParams.append(e,`sr.${n}`),this}rangeGte(e,n){return this.url.searchParams.append(e,`nxl.${n}`),this}rangeLt(e,n){return this.url.searchParams.append(e,`sl.${n}`),this}rangeLte(e,n){return this.url.searchParams.append(e,`nxr.${n}`),this}rangeAdjacent(e,n){return this.url.searchParams.append(e,`adj.${n}`),this}overlaps(e,n){return typeof n=="string"?this.url.searchParams.append(e,`ov.${n}`):this.url.searchParams.append(e,`ov.{${n.join(",")}}`),this}textSearch(e,n,{config:r,type:i}={}){let o="";i==="plain"?o="pl":i==="phrase"?o="ph":i==="websearch"&&(o="w");const s=r===void 0?"":`(${r})`;return this.url.searchParams.append(e,`${o}fts${s}.${n}`),this}match(e){return Object.entries(e).forEach(([n,r])=>{this.url.searchParams.append(n,`eq.${r}`)}),this}not(e,n,r){return this.url.searchParams.append(e,`not.${n}.${r}`),this}or(e,{foreignTable:n,referencedTable:r=n}={}){const i=r?`${r}.or`:"or";return this.url.searchParams.append(i,`(${e})`),this}filter(e,n,r){return this.url.searchParams.append(e,`${n}.${r}`),this}};Lu.default=mD;var gD=Vn&&Vn.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(zh,"__esModule",{value:!0});const ec=gD(Lu);let yD=class{constructor(e,{headers:n={},schema:r,fetch:i}){this.url=e,this.headers=n,this.schema=r,this.fetch=i}select(e,{head:n=!1,count:r}={}){const i=n?"HEAD":"GET";let o=!1;const s=(e??"*").split("").map(a=>/\s/.test(a)&&!o?"":(a==='"'&&(o=!o),a)).join("");return this.url.searchParams.set("select",s),r&&(this.headers.Prefer=`count=${r}`),new ec.default({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:n,defaultToNull:r=!0}={}){const i="POST",o=[];if(this.headers.Prefer&&o.push(this.headers.Prefer),n&&o.push(`count=${n}`),r||o.push("missing=default"),this.headers.Prefer=o.join(","),Array.isArray(e)){const s=e.reduce((a,l)=>a.concat(Object.keys(l)),[]);if(s.length>0){const a=[...new Set(s)].map(l=>`"${l}"`);this.url.searchParams.set("columns",a.join(","))}}return new ec.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:n,ignoreDuplicates:r=!1,count:i,defaultToNull:o=!0}={}){const s="POST",a=[`resolution=${r?"ignore":"merge"}-duplicates`];if(n!==void 0&&this.url.searchParams.set("on_conflict",n),this.headers.Prefer&&a.push(this.headers.Prefer),i&&a.push(`count=${i}`),o||a.push("missing=default"),this.headers.Prefer=a.join(","),Array.isArray(e)){const l=e.reduce((c,u)=>c.concat(Object.keys(u)),[]);if(l.length>0){const c=[...new Set(l)].map(u=>`"${u}"`);this.url.searchParams.set("columns",c.join(","))}}return new ec.default({method:s,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:n}={}){const r="PATCH",i=[];return this.headers.Prefer&&i.push(this.headers.Prefer),n&&i.push(`count=${n}`),this.headers.Prefer=i.join(","),new ec.default({method:r,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){const n="DELETE",r=[];return e&&r.push(`count=${e}`),this.headers.Prefer&&r.unshift(this.headers.Prefer),this.headers.Prefer=r.join(","),new ec.default({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};zh.default=yD;var Wh={},Kh={};Object.defineProperty(Kh,"__esModule",{value:!0});Kh.version=void 0;Kh.version="0.0.0-automated";Object.defineProperty(Wh,"__esModule",{value:!0});Wh.DEFAULT_HEADERS=void 0;const vD=Kh;Wh.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${vD.version}`};var zE=Vn&&Vn.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(_0,"__esModule",{value:!0});const xD=zE(zh),wD=zE(Lu),bD=Wh;let SD=class VE{constructor(e,{headers:n={},schema:r,fetch:i}={}){this.url=e,this.headers=Object.assign(Object.assign({},bD.DEFAULT_HEADERS),n),this.schemaName=r,this.fetch=i}from(e){const n=new URL(`${this.url}/${e}`);return new xD.default(n,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new VE(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,n={},{head:r=!1,get:i=!1,count:o}={}){let s;const a=new URL(`${this.url}/rpc/${e}`);let l;r||i?(s=r?"HEAD":"GET",Object.entries(n).filter(([u,d])=>d!==void 0).map(([u,d])=>[u,Array.isArray(d)?`{${d.join(",")}}`:`${d}`]).forEach(([u,d])=>{a.searchParams.append(u,d)})):(s="POST",l=n);const c=Object.assign({},this.headers);return o&&(c.Prefer=`count=${o}`),new wD.default({method:s,url:a,headers:c,schema:this.schemaName,body:l,fetch:this.fetch,allowEmpty:!1})}};_0.default=SD;var Dl=Vn&&Vn.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(rn,"__esModule",{value:!0});rn.PostgrestError=rn.PostgrestBuilder=rn.PostgrestTransformBuilder=rn.PostgrestFilterBuilder=rn.PostgrestQueryBuilder=rn.PostgrestClient=void 0;const UE=Dl(_0);rn.PostgrestClient=UE.default;const HE=Dl(zh);rn.PostgrestQueryBuilder=HE.default;const WE=Dl(Lu);rn.PostgrestFilterBuilder=WE.default;const KE=Dl(Vh);rn.PostgrestTransformBuilder=KE.default;const qE=Dl(Uh);rn.PostgrestBuilder=qE.default;const GE=Dl(Hh);rn.PostgrestError=GE.default;var CD=rn.default={PostgrestClient:UE.default,PostgrestQueryBuilder:HE.default,PostgrestFilterBuilder:WE.default,PostgrestTransformBuilder:KE.default,PostgrestBuilder:qE.default,PostgrestError:GE.default};const{PostgrestClient:kD,PostgrestQueryBuilder:IW,PostgrestFilterBuilder:AW,PostgrestTransformBuilder:NW,PostgrestBuilder:DW,PostgrestError:jW}=CD,ED="2.11.2",TD={"X-Client-Info":`realtime-js/${ED}`},_D="1.0.0",JE=1e4,RD=1e3;var ja;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(ja||(ja={}));var yn;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(yn||(yn={}));var rr;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(rr||(rr={}));var my;(function(t){t.websocket="websocket"})(my||(my={}));var Yo;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(Yo||(Yo={}));class OD{constructor(){this.HEADER_LENGTH=1}decode(e,n){return e.constructor===ArrayBuffer?n(this._binaryDecode(e)):n(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const n=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,n,r)}_decodeBroadcast(e,n,r){const i=n.getUint8(1),o=n.getUint8(2);let s=this.HEADER_LENGTH+2;const a=r.decode(e.slice(s,s+i));s=s+i;const l=r.decode(e.slice(s,s+o));s=s+o;const c=JSON.parse(r.decode(e.slice(s,e.byteLength)));return{ref:null,topic:a,event:l,payload:c}}}class YE{constructor(e,n){this.callback=e,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Ie;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(Ie||(Ie={}));const mb=(t,e,n={})=>{var r;const i=(r=n.skipTypes)!==null&&r!==void 0?r:[];return Object.keys(e).reduce((o,s)=>(o[s]=PD(s,t,e,i),o),{})},PD=(t,e,n,r)=>{const i=e.find(a=>a.name===t),o=i==null?void 0:i.type,s=n[t];return o&&!r.includes(o)?QE(o,s):gy(s)},QE=(t,e)=>{if(t.charAt(0)==="_"){const n=t.slice(1,t.length);return ND(e,n)}switch(t){case Ie.bool:return MD(e);case Ie.float4:case Ie.float8:case Ie.int2:case Ie.int4:case Ie.int8:case Ie.numeric:case Ie.oid:return ID(e);case Ie.json:case Ie.jsonb:return AD(e);case Ie.timestamp:return DD(e);case Ie.abstime:case Ie.date:case Ie.daterange:case Ie.int4range:case Ie.int8range:case Ie.money:case Ie.reltime:case Ie.text:case Ie.time:case Ie.timestamptz:case Ie.timetz:case Ie.tsrange:case Ie.tstzrange:return gy(e);default:return gy(e)}},gy=t=>t,MD=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},ID=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},AD=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(e){return console.log(`JSON parse error: ${e}`),t}return t},ND=(t,e)=>{if(typeof t!="string")return t;const n=t.length-1,r=t[n];if(t[0]==="{"&&r==="}"){let o;const s=t.slice(1,n);try{o=JSON.parse("["+s+"]")}catch{o=s?s.split(","):[]}return o.map(a=>QE(e,a))}return t},DD=t=>typeof t=="string"?t.replace(" ","T"):t,XE=t=>{let e=t;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")};class um{constructor(e,n,r={},i=JE){this.channel=e,this.event=n,this.payload=r,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,n){var r;return this._hasReceived(e)&&n((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:e,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:n}){this.recHooks.filter(r=>r.status===e).forEach(r=>r.callback(n))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var gb;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(gb||(gb={}));class kc{constructor(e,n){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(n==null?void 0:n.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},i=>{const{onJoin:o,onLeave:s,onSync:a}=this.caller;this.joinRef=this.channel._joinRef(),this.state=kc.syncState(this.state,i,o,s),this.pendingDiffs.forEach(l=>{this.state=kc.syncDiff(this.state,l,o,s)}),this.pendingDiffs=[],a()}),this.channel._on(r.diff,{},i=>{const{onJoin:o,onLeave:s,onSync:a}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(i):(this.state=kc.syncDiff(this.state,i,o,s),a())}),this.onJoin((i,o,s)=>{this.channel._trigger("presence",{event:"join",key:i,currentPresences:o,newPresences:s})}),this.onLeave((i,o,s)=>{this.channel._trigger("presence",{event:"leave",key:i,currentPresences:o,leftPresences:s})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,n,r,i){const o=this.cloneDeep(e),s=this.transformState(n),a={},l={};return this.map(o,(c,u)=>{s[c]||(l[c]=u)}),this.map(s,(c,u)=>{const d=o[c];if(d){const h=u.map(v=>v.presence_ref),p=d.map(v=>v.presence_ref),m=u.filter(v=>p.indexOf(v.presence_ref)<0),y=d.filter(v=>h.indexOf(v.presence_ref)<0);m.length>0&&(a[c]=m),y.length>0&&(l[c]=y)}else a[c]=u}),this.syncDiff(o,{joins:a,leaves:l},r,i)}static syncDiff(e,n,r,i){const{joins:o,leaves:s}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return r||(r=()=>{}),i||(i=()=>{}),this.map(o,(a,l)=>{var c;const u=(c=e[a])!==null&&c!==void 0?c:[];if(e[a]=this.cloneDeep(l),u.length>0){const d=e[a].map(p=>p.presence_ref),h=u.filter(p=>d.indexOf(p.presence_ref)<0);e[a].unshift(...h)}r(a,u,l)}),this.map(s,(a,l)=>{let c=e[a];if(!c)return;const u=l.map(d=>d.presence_ref);c=c.filter(d=>u.indexOf(d.presence_ref)<0),e[a]=c,i(a,c,l),c.length===0&&delete e[a]}),e}static map(e,n){return Object.getOwnPropertyNames(e).map(r=>n(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((n,r)=>{const i=e[r];return"metas"in i?n[r]=i.metas.map(o=>(o.presence_ref=o.phx_ref,delete o.phx_ref,delete o.phx_ref_prev,o)):n[r]=i,n},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var yo;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(yo||(yo={}));var yb;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(yb||(yb={}));var Yr;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(Yr||(Yr={}));class R0{constructor(e,n={config:{}},r){this.topic=e,this.params=n,this.socket=r,this.bindings={},this.state=yn.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},n.config),this.timeout=this.socket.timeout,this.joinPush=new um(this,rr.join,this.params,this.timeout),this.rejoinTimer=new YE(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=yn.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(i=>i.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=yn.closed,this.socket._remove(this)}),this._onError(i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=yn.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=yn.errored,this.rejoinTimer.scheduleTimeout())}),this._on(rr.reply,{},(i,o)=>{this._trigger(this._replyEventName(o),i)}),this.presence=new kc(this),this.broadcastEndpointURL=XE(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,n=this.timeout){var r,i;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:o,presence:s,private:a}}=this.params;this._onError(u=>e==null?void 0:e(Yr.CHANNEL_ERROR,u)),this._onClose(()=>e==null?void 0:e(Yr.CLOSED));const l={},c={broadcast:o,presence:s,postgres_changes:(i=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(u=>u.filter))!==null&&i!==void 0?i:[],private:a};this.socket.accessTokenValue&&(l.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:c},l)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",async({postgres_changes:u})=>{var d;if(this.socket.setAuth(),u===void 0){e==null||e(Yr.SUBSCRIBED);return}else{const h=this.bindings.postgres_changes,p=(d=h==null?void 0:h.length)!==null&&d!==void 0?d:0,m=[];for(let y=0;y<p;y++){const v=h[y],{filter:{event:x,schema:w,table:b,filter:S}}=v,C=u&&u[y];if(C&&C.event===x&&C.schema===w&&C.table===b&&C.filter===S)m.push(Object.assign(Object.assign({},v),{id:C.id}));else{this.unsubscribe(),e==null||e(Yr.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=m,e&&e(Yr.SUBSCRIBED);return}}).receive("error",u=>{e==null||e(Yr.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(u).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(Yr.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,n={}){return await this.send({type:"presence",event:"track",payload:e},n.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,n,r){return this._on(e,n,r)}async send(e,n={}){var r,i;if(!this._canPush()&&e.type==="broadcast"){const{event:o,payload:s}=e,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:o,payload:s,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(r=n.timeout)!==null&&r!==void 0?r:this.timeout);return await((i=c.body)===null||i===void 0?void 0:i.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(o=>{var s,a,l;const c=this._push(e.type,e,n.timeout||this.timeout);e.type==="broadcast"&&!(!((l=(a=(s=this.params)===null||s===void 0?void 0:s.config)===null||a===void 0?void 0:a.broadcast)===null||l===void 0)&&l.ack)&&o("ok"),c.receive("ok",()=>o("ok")),c.receive("error",()=>o("error")),c.receive("timeout",()=>o("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=yn.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(rr.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(r=>{const i=new um(this,rr.leave,{},e);i.receive("ok",()=>{n(),r("ok")}).receive("timeout",()=>{n(),r("timed out")}).receive("error",()=>{r("error")}),i.send(),this._canPush()||i.trigger("ok",{})})}async _fetchWithTimeout(e,n,r){const i=new AbortController,o=setTimeout(()=>i.abort(),r),s=await this.socket.fetch(e,Object.assign(Object.assign({},n),{signal:i.signal}));return clearTimeout(o),s}_push(e,n,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new um(this,e,n,r);return this._canPush()?i.send():(i.startTimeout(),this.pushBuffer.push(i)),i}_onMessage(e,n,r){return n}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,n,r){var i,o;const s=e.toLocaleLowerCase(),{close:a,error:l,leave:c,join:u}=rr;if(r&&[a,l,c,u].indexOf(s)>=0&&r!==this._joinRef())return;let h=this._onMessage(s,n,r);if(n&&!h)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(s)?(i=this.bindings.postgres_changes)===null||i===void 0||i.filter(p=>{var m,y,v;return((m=p.filter)===null||m===void 0?void 0:m.event)==="*"||((v=(y=p.filter)===null||y===void 0?void 0:y.event)===null||v===void 0?void 0:v.toLocaleLowerCase())===s}).map(p=>p.callback(h,r)):(o=this.bindings[s])===null||o===void 0||o.filter(p=>{var m,y,v,x,w,b;if(["broadcast","presence","postgres_changes"].includes(s))if("id"in p){const S=p.id,C=(m=p.filter)===null||m===void 0?void 0:m.event;return S&&((y=n.ids)===null||y===void 0?void 0:y.includes(S))&&(C==="*"||(C==null?void 0:C.toLocaleLowerCase())===((v=n.data)===null||v===void 0?void 0:v.type.toLocaleLowerCase()))}else{const S=(w=(x=p==null?void 0:p.filter)===null||x===void 0?void 0:x.event)===null||w===void 0?void 0:w.toLocaleLowerCase();return S==="*"||S===((b=n==null?void 0:n.event)===null||b===void 0?void 0:b.toLocaleLowerCase())}else return p.type.toLocaleLowerCase()===s}).map(p=>{if(typeof h=="object"&&"ids"in h){const m=h.data,{schema:y,table:v,commit_timestamp:x,type:w,errors:b}=m;h=Object.assign(Object.assign({},{schema:y,table:v,commit_timestamp:x,eventType:w,new:{},old:{},errors:b}),this._getPayloadRecords(m))}p.callback(h,r)})}_isClosed(){return this.state===yn.closed}_isJoined(){return this.state===yn.joined}_isJoining(){return this.state===yn.joining}_isLeaving(){return this.state===yn.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,n,r){const i=e.toLocaleLowerCase(),o={type:i,filter:n,callback:r};return this.bindings[i]?this.bindings[i].push(o):this.bindings[i]=[o],this}_off(e,n){const r=e.toLocaleLowerCase();return this.bindings[r]=this.bindings[r].filter(i=>{var o;return!(((o=i.type)===null||o===void 0?void 0:o.toLocaleLowerCase())===r&&R0.isEqual(i.filter,n))}),this}static isEqual(e,n){if(Object.keys(e).length!==Object.keys(n).length)return!1;for(const r in e)if(e[r]!==n[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(rr.close,{},e)}_onError(e){this._on(rr.error,{},n=>e(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=yn.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const n={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(n.new=mb(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(n.old=mb(e.columns,e.old_record)),n}}const jD=()=>{},LD=typeof WebSocket<"u",$D=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class FD{constructor(e,n){var r;this.accessTokenValue=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=TD,this.params={},this.timeout=JE,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=jD,this.conn=null,this.sendBuffer=[],this.serializer=new OD,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=o=>{let s;return o?s=o:typeof fetch>"u"?s=(...a)=>Os(()=>Promise.resolve().then(()=>Nl),void 0).then(({default:l})=>l(...a)):s=fetch,(...a)=>s(...a)},this.endPoint=`${e}/${my.websocket}`,this.httpEndpoint=XE(e),n!=null&&n.transport?this.transport=n.transport:this.transport=null,n!=null&&n.params&&(this.params=n.params),n!=null&&n.headers&&(this.headers=Object.assign(Object.assign({},this.headers),n.headers)),n!=null&&n.timeout&&(this.timeout=n.timeout),n!=null&&n.logger&&(this.logger=n.logger),n!=null&&n.heartbeatIntervalMs&&(this.heartbeatIntervalMs=n.heartbeatIntervalMs);const i=(r=n==null?void 0:n.params)===null||r===void 0?void 0:r.apikey;if(i&&(this.accessTokenValue=i,this.apiKey=i),this.reconnectAfterMs=n!=null&&n.reconnectAfterMs?n.reconnectAfterMs:o=>[1e3,2e3,5e3,1e4][o-1]||1e4,this.encode=n!=null&&n.encode?n.encode:(o,s)=>s(JSON.stringify(o)),this.decode=n!=null&&n.decode?n.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new YE(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(n==null?void 0:n.fetch),n!=null&&n.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(n==null?void 0:n.worker)||!1,this.workerUrl=n==null?void 0:n.workerUrl}this.accessToken=(n==null?void 0:n.accessToken)||null}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers});return}if(LD){this.conn=new WebSocket(this.endpointURL()),this.setupConnection();return}this.conn=new BD(this.endpointURL(),void 0,{close:()=>{this.conn=null}}),Os(()=>import("./browser-73782eb3.js").then(e=>e.b),[]).then(({default:e})=>{this.conn=new e(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:_D}))}disconnect(e,n){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,n??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(e){const n=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const e=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.disconnect(),e}log(e,n,r){this.logger(e,n,r)}connectionState(){switch(this.conn&&this.conn.readyState){case ja.connecting:return Yo.Connecting;case ja.open:return Yo.Open;case ja.closing:return Yo.Closing;default:return Yo.Closed}}isConnected(){return this.connectionState()===Yo.Open}channel(e,n={config:{}}){const r=new R0(`realtime:${e}`,n,this);return this.channels.push(r),r}push(e){const{topic:n,event:r,payload:i,ref:o}=e,s=()=>{this.encode(e,a=>{var l;(l=this.conn)===null||l===void 0||l.send(a)})};this.log("push",`${n} ${r} (${o})`,i),this.isConnected()?s():this.sendBuffer.push(s)}async setAuth(e=null){let n=e||this.accessToken&&await this.accessToken()||this.accessTokenValue;if(n){let r=null;try{r=JSON.parse(atob(n.split(".")[1]))}catch{}if(r&&r.exp&&!(Math.floor(Date.now()/1e3)-r.exp<0))return this.log("auth",`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${r.exp}`),Promise.reject(`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${r.exp}`);this.accessTokenValue=n,this.channels.forEach(i=>{n&&i.updateJoinPayload({access_token:n}),i.joinedOnce&&i._isJoined()&&i._push(rr.access_token,{access_token:n})})}}async sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(e=this.conn)===null||e===void 0||e.close(RD,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth()}}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let n=this.channels.find(r=>r.topic===e&&(r._isJoined()||r._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${e}"`),n.unsubscribe())}_remove(e){this.channels=this.channels.filter(n=>n._joinRef()!==e._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,n=>{let{topic:r,event:i,payload:o,ref:s}=n;s&&s===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${o.status||""} ${r} ${i} ${s&&"("+s+")"||""}`,o),this.channels.filter(a=>a._isMember(r)).forEach(a=>a._trigger(i,o,s)),this.stateChangeCallbacks.message.forEach(a=>a(n))})}async _onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),!this.worker)this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs);else{this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=n=>{this.log("worker","worker error",n.message),this.workerRef.terminate()},this.workerRef.onmessage=n=>{n.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}this.stateChangeCallbacks.open.forEach(e=>e())}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(n=>n(e))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(n=>n(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(rr.error))}_appendParams(e,n){if(Object.keys(n).length===0)return e;const r=e.match(/\?/)?"&":"?",i=new URLSearchParams(n);return`${e}${r}${i}`}_workerObjectUrl(e){let n;if(e)n=e;else{const r=new Blob([$D],{type:"application/javascript"});n=URL.createObjectURL(r)}return n}}class BD{constructor(e,n,r){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=ja.connecting,this.send=()=>{},this.url=null,this.url=e,this.close=r.close}}class O0 extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function it(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class zD extends O0{constructor(e,n){super(e),this.name="StorageApiError",this.status=n}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class yy extends O0{constructor(e,n){super(e),this.name="StorageUnknownError",this.originalError=n}}var VD=globalThis&&globalThis.__awaiter||function(t,e,n,r){function i(o){return o instanceof n?o:new n(function(s){s(o)})}return new(n||(n=Promise))(function(o,s){function a(u){try{c(r.next(u))}catch(d){s(d)}}function l(u){try{c(r.throw(u))}catch(d){s(d)}}function c(u){u.done?o(u.value):i(u.value).then(a,l)}c((r=r.apply(t,e||[])).next())})};const ZE=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>Os(()=>Promise.resolve().then(()=>Nl),void 0).then(({default:r})=>r(...n)):e=fetch,(...n)=>e(...n)},UD=()=>VD(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Os(()=>Promise.resolve().then(()=>Nl),void 0)).Response:Response}),vy=t=>{if(Array.isArray(t))return t.map(n=>vy(n));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([n,r])=>{const i=n.replace(/([-_][a-z])/gi,o=>o.toUpperCase().replace(/[-_]/g,""));e[i]=vy(r)}),e};var Us=globalThis&&globalThis.__awaiter||function(t,e,n,r){function i(o){return o instanceof n?o:new n(function(s){s(o)})}return new(n||(n=Promise))(function(o,s){function a(u){try{c(r.next(u))}catch(d){s(d)}}function l(u){try{c(r.throw(u))}catch(d){s(d)}}function c(u){u.done?o(u.value):i(u.value).then(a,l)}c((r=r.apply(t,e||[])).next())})};const dm=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),HD=(t,e,n)=>Us(void 0,void 0,void 0,function*(){const r=yield UD();t instanceof r&&!(n!=null&&n.noResolveJson)?t.json().then(i=>{e(new zD(dm(i),t.status||500))}).catch(i=>{e(new yy(dm(i),i))}):e(new yy(dm(t),t))}),WD=(t,e,n,r)=>{const i={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),r&&(i.body=JSON.stringify(r)),Object.assign(Object.assign({},i),n))};function $u(t,e,n,r,i,o){return Us(this,void 0,void 0,function*(){return new Promise((s,a)=>{t(n,WD(e,r,i,o)).then(l=>{if(!l.ok)throw l;return r!=null&&r.noResolveJson?l:l.json()}).then(l=>s(l)).catch(l=>HD(l,a,r))})})}function Wf(t,e,n,r){return Us(this,void 0,void 0,function*(){return $u(t,"GET",e,n,r)})}function Mi(t,e,n,r,i){return Us(this,void 0,void 0,function*(){return $u(t,"POST",e,r,i,n)})}function KD(t,e,n,r,i){return Us(this,void 0,void 0,function*(){return $u(t,"PUT",e,r,i,n)})}function qD(t,e,n,r){return Us(this,void 0,void 0,function*(){return $u(t,"HEAD",e,Object.assign(Object.assign({},n),{noResolveJson:!0}),r)})}function eT(t,e,n,r,i){return Us(this,void 0,void 0,function*(){return $u(t,"DELETE",e,r,i,n)})}var Yt=globalThis&&globalThis.__awaiter||function(t,e,n,r){function i(o){return o instanceof n?o:new n(function(s){s(o)})}return new(n||(n=Promise))(function(o,s){function a(u){try{c(r.next(u))}catch(d){s(d)}}function l(u){try{c(r.throw(u))}catch(d){s(d)}}function c(u){u.done?o(u.value):i(u.value).then(a,l)}c((r=r.apply(t,e||[])).next())})};const GD={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},vb={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class JD{constructor(e,n={},r,i){this.url=e,this.headers=n,this.bucketId=r,this.fetch=ZE(i)}uploadOrUpdate(e,n,r,i){return Yt(this,void 0,void 0,function*(){try{let o;const s=Object.assign(Object.assign({},vb),i);let a=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(s.upsert)});const l=s.metadata;typeof Blob<"u"&&r instanceof Blob?(o=new FormData,o.append("cacheControl",s.cacheControl),l&&o.append("metadata",this.encodeMetadata(l)),o.append("",r)):typeof FormData<"u"&&r instanceof FormData?(o=r,o.append("cacheControl",s.cacheControl),l&&o.append("metadata",this.encodeMetadata(l))):(o=r,a["cache-control"]=`max-age=${s.cacheControl}`,a["content-type"]=s.contentType,l&&(a["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),i!=null&&i.headers&&(a=Object.assign(Object.assign({},a),i.headers));const c=this._removeEmptyFolders(n),u=this._getFinalPath(c),d=yield this.fetch(`${this.url}/object/${u}`,Object.assign({method:e,body:o,headers:a},s!=null&&s.duplex?{duplex:s.duplex}:{})),h=yield d.json();return d.ok?{data:{path:c,id:h.Id,fullPath:h.Key},error:null}:{data:null,error:h}}catch(o){if(it(o))return{data:null,error:o};throw o}})}upload(e,n,r){return Yt(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,n,r)})}uploadToSignedUrl(e,n,r,i){return Yt(this,void 0,void 0,function*(){const o=this._removeEmptyFolders(e),s=this._getFinalPath(o),a=new URL(this.url+`/object/upload/sign/${s}`);a.searchParams.set("token",n);try{let l;const c=Object.assign({upsert:vb.upsert},i),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&r instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),l.append("",r)):typeof FormData<"u"&&r instanceof FormData?(l=r,l.append("cacheControl",c.cacheControl)):(l=r,u["cache-control"]=`max-age=${c.cacheControl}`,u["content-type"]=c.contentType);const d=yield this.fetch(a.toString(),{method:"PUT",body:l,headers:u}),h=yield d.json();return d.ok?{data:{path:o,fullPath:h.Key},error:null}:{data:null,error:h}}catch(l){if(it(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(e,n){return Yt(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e);const i=Object.assign({},this.headers);n!=null&&n.upsert&&(i["x-upsert"]="true");const o=yield Mi(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:i}),s=new URL(this.url+o.url),a=s.searchParams.get("token");if(!a)throw new O0("No token returned by API");return{data:{signedUrl:s.toString(),path:e,token:a},error:null}}catch(r){if(it(r))return{data:null,error:r};throw r}})}update(e,n,r){return Yt(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,n,r)})}move(e,n,r){return Yt(this,void 0,void 0,function*(){try{return{data:yield Mi(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers}),error:null}}catch(i){if(it(i))return{data:null,error:i};throw i}})}copy(e,n,r){return Yt(this,void 0,void 0,function*(){try{return{data:{path:(yield Mi(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers})).Key},error:null}}catch(i){if(it(i))return{data:null,error:i};throw i}})}createSignedUrl(e,n,r){return Yt(this,void 0,void 0,function*(){try{let i=this._getFinalPath(e),o=yield Mi(this.fetch,`${this.url}/object/sign/${i}`,Object.assign({expiresIn:n},r!=null&&r.transform?{transform:r.transform}:{}),{headers:this.headers});const s=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return o={signedUrl:encodeURI(`${this.url}${o.signedURL}${s}`)},{data:o,error:null}}catch(i){if(it(i))return{data:null,error:i};throw i}})}createSignedUrls(e,n,r){return Yt(this,void 0,void 0,function*(){try{const i=yield Mi(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:n,paths:e},{headers:this.headers}),o=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:i.map(s=>Object.assign(Object.assign({},s),{signedUrl:s.signedURL?encodeURI(`${this.url}${s.signedURL}${o}`):null})),error:null}}catch(i){if(it(i))return{data:null,error:i};throw i}})}download(e,n){return Yt(this,void 0,void 0,function*(){const i=typeof(n==null?void 0:n.transform)<"u"?"render/image/authenticated":"object",o=this.transformOptsToQueryString((n==null?void 0:n.transform)||{}),s=o?`?${o}`:"";try{const a=this._getFinalPath(e);return{data:yield(yield Wf(this.fetch,`${this.url}/${i}/${a}${s}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(a){if(it(a))return{data:null,error:a};throw a}})}info(e){return Yt(this,void 0,void 0,function*(){const n=this._getFinalPath(e);try{const r=yield Wf(this.fetch,`${this.url}/object/info/${n}`,{headers:this.headers});return{data:vy(r),error:null}}catch(r){if(it(r))return{data:null,error:r};throw r}})}exists(e){return Yt(this,void 0,void 0,function*(){const n=this._getFinalPath(e);try{return yield qD(this.fetch,`${this.url}/object/${n}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(it(r)&&r instanceof yy){const i=r.originalError;if([400,404].includes(i==null?void 0:i.status))return{data:!1,error:r}}throw r}})}getPublicUrl(e,n){const r=this._getFinalPath(e),i=[],o=n!=null&&n.download?`download=${n.download===!0?"":n.download}`:"";o!==""&&i.push(o);const a=typeof(n==null?void 0:n.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((n==null?void 0:n.transform)||{});l!==""&&i.push(l);let c=i.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${a}/public/${r}${c}`)}}}remove(e){return Yt(this,void 0,void 0,function*(){try{return{data:yield eT(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(n){if(it(n))return{data:null,error:n};throw n}})}list(e,n,r){return Yt(this,void 0,void 0,function*(){try{const i=Object.assign(Object.assign(Object.assign({},GD),n),{prefix:e||""});return{data:yield Mi(this.fetch,`${this.url}/object/list/${this.bucketId}`,i,{headers:this.headers},r),error:null}}catch(i){if(it(i))return{data:null,error:i};throw i}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const n=[];return e.width&&n.push(`width=${e.width}`),e.height&&n.push(`height=${e.height}`),e.resize&&n.push(`resize=${e.resize}`),e.format&&n.push(`format=${e.format}`),e.quality&&n.push(`quality=${e.quality}`),n.join("&")}}const YD="2.7.1",QD={"X-Client-Info":`storage-js/${YD}`};var Xs=globalThis&&globalThis.__awaiter||function(t,e,n,r){function i(o){return o instanceof n?o:new n(function(s){s(o)})}return new(n||(n=Promise))(function(o,s){function a(u){try{c(r.next(u))}catch(d){s(d)}}function l(u){try{c(r.throw(u))}catch(d){s(d)}}function c(u){u.done?o(u.value):i(u.value).then(a,l)}c((r=r.apply(t,e||[])).next())})};class XD{constructor(e,n={},r){this.url=e,this.headers=Object.assign(Object.assign({},QD),n),this.fetch=ZE(r)}listBuckets(){return Xs(this,void 0,void 0,function*(){try{return{data:yield Wf(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(it(e))return{data:null,error:e};throw e}})}getBucket(e){return Xs(this,void 0,void 0,function*(){try{return{data:yield Wf(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(n){if(it(n))return{data:null,error:n};throw n}})}createBucket(e,n={public:!1}){return Xs(this,void 0,void 0,function*(){try{return{data:yield Mi(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(it(r))return{data:null,error:r};throw r}})}updateBucket(e,n){return Xs(this,void 0,void 0,function*(){try{return{data:yield KD(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(it(r))return{data:null,error:r};throw r}})}emptyBucket(e){return Xs(this,void 0,void 0,function*(){try{return{data:yield Mi(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(n){if(it(n))return{data:null,error:n};throw n}})}deleteBucket(e){return Xs(this,void 0,void 0,function*(){try{return{data:yield eT(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(n){if(it(n))return{data:null,error:n};throw n}})}}class ZD extends XD{constructor(e,n={},r){super(e,n,r)}from(e){return new JD(this.url,this.headers,e,this.fetch)}}const ej="2.49.1";let cc="";typeof Deno<"u"?cc="deno":typeof document<"u"?cc="web":typeof navigator<"u"&&navigator.product==="ReactNative"?cc="react-native":cc="node";const tj={"X-Client-Info":`supabase-js-${cc}/${ej}`},nj={headers:tj},rj={schema:"public"},ij={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},oj={};var sj=globalThis&&globalThis.__awaiter||function(t,e,n,r){function i(o){return o instanceof n?o:new n(function(s){s(o)})}return new(n||(n=Promise))(function(o,s){function a(u){try{c(r.next(u))}catch(d){s(d)}}function l(u){try{c(r.throw(u))}catch(d){s(d)}}function c(u){u.done?o(u.value):i(u.value).then(a,l)}c((r=r.apply(t,e||[])).next())})};const aj=t=>{let e;return t?e=t:typeof fetch>"u"?e=$E:e=fetch,(...n)=>e(...n)},lj=()=>typeof Headers>"u"?FE:Headers,cj=(t,e,n)=>{const r=aj(n),i=lj();return(o,s)=>sj(void 0,void 0,void 0,function*(){var a;const l=(a=yield e())!==null&&a!==void 0?a:t;let c=new i(s==null?void 0:s.headers);return c.has("apikey")||c.set("apikey",t),c.has("Authorization")||c.set("Authorization",`Bearer ${l}`),r(o,Object.assign(Object.assign({},s),{headers:c}))})};var uj=globalThis&&globalThis.__awaiter||function(t,e,n,r){function i(o){return o instanceof n?o:new n(function(s){s(o)})}return new(n||(n=Promise))(function(o,s){function a(u){try{c(r.next(u))}catch(d){s(d)}}function l(u){try{c(r.throw(u))}catch(d){s(d)}}function c(u){u.done?o(u.value):i(u.value).then(a,l)}c((r=r.apply(t,e||[])).next())})};function dj(t){return t.replace(/\/$/,"")}function fj(t,e){const{db:n,auth:r,realtime:i,global:o}=t,{db:s,auth:a,realtime:l,global:c}=e,u={db:Object.assign(Object.assign({},s),n),auth:Object.assign(Object.assign({},a),r),realtime:Object.assign(Object.assign({},l),i),global:Object.assign(Object.assign({},c),o),accessToken:()=>uj(this,void 0,void 0,function*(){return""})};return t.accessToken?u.accessToken=t.accessToken:delete u.accessToken,u}const tT="2.68.0",ca=30*1e3,xy=3,fm=xy*ca,hj="http://localhost:9999",pj="supabase.auth.token",mj={"X-Client-Info":`gotrue-js/${tT}`},wy="X-Supabase-Api-Version",nT={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}};function gj(t){return Math.round(Date.now()/1e3)+t}function yj(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const e=Math.random()*16|0;return(t=="x"?e:e&3|8).toString(16)})}const Sr=()=>typeof window<"u"&&typeof document<"u",Ho={tested:!1,writable:!1},Ec=()=>{if(!Sr())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Ho.tested)return Ho.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),Ho.tested=!0,Ho.writable=!0}catch{Ho.tested=!0,Ho.writable=!1}return Ho.writable};function vj(t){const e={},n=new URL(t);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((i,o)=>{e[o]=i})}catch{}return n.searchParams.forEach((r,i)=>{e[i]=r}),e}const rT=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>Os(()=>Promise.resolve().then(()=>Nl),void 0).then(({default:r})=>r(...n)):e=fetch,(...n)=>e(...n)},xj=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",iT=async(t,e,n)=>{await t.setItem(e,JSON.stringify(n))},Cd=async(t,e)=>{const n=await t.getItem(e);if(!n)return null;try{return JSON.parse(n)}catch{return n}},kd=async(t,e)=>{await t.removeItem(e)};function wj(t){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let n="",r,i,o,s,a,l,c,u=0;for(t=t.replace("-","+").replace("_","/");u<t.length;)s=e.indexOf(t.charAt(u++)),a=e.indexOf(t.charAt(u++)),l=e.indexOf(t.charAt(u++)),c=e.indexOf(t.charAt(u++)),r=s<<2|a>>4,i=(a&15)<<4|l>>2,o=(l&3)<<6|c,n=n+String.fromCharCode(r),l!=64&&i!=0&&(n=n+String.fromCharCode(i)),c!=64&&o!=0&&(n=n+String.fromCharCode(o));return n}class qh{constructor(){this.promise=new qh.promiseConstructor((e,n)=>{this.resolve=e,this.reject=n})}}qh.promiseConstructor=Promise;function xb(t){const e=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}=?$|[a-z0-9_-]{2}(==)?$)$/i,n=t.split(".");if(n.length!==3)throw new Error("JWT is not valid: not a JWT structure");if(!e.test(n[1]))throw new Error("JWT is not valid: payload is not in base64url format");const r=n[1];return JSON.parse(wj(r))}async function bj(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function Sj(t,e){return new Promise((r,i)=>{(async()=>{for(let o=0;o<1/0;o++)try{const s=await t(o);if(!e(o,null,s)){r(s);return}}catch(s){if(!e(o,s)){i(s);return}}})()})}function Cj(t){return("0"+t.toString(16)).substr(-2)}function kj(){const e=new Uint32Array(56);if(typeof crypto>"u"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=n.length;let i="";for(let o=0;o<56;o++)i+=n.charAt(Math.floor(Math.random()*r));return i}return crypto.getRandomValues(e),Array.from(e,Cj).join("")}async function Ej(t){const n=new TextEncoder().encode(t),r=await crypto.subtle.digest("SHA-256",n),i=new Uint8Array(r);return Array.from(i).map(o=>String.fromCharCode(o)).join("")}function Tj(t){return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function _j(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const n=await Ej(t);return Tj(n)}async function Zs(t,e,n=!1){const r=kj();let i=r;n&&(i+="/PASSWORD_RECOVERY"),await iT(t,`${e}-code-verifier`,i);const o=await _j(r);return[o,r===o?"plain":"s256"]}const Rj=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Oj(t){const e=t.headers.get(wy);if(!e||!e.match(Rj))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}class P0 extends Error{constructor(e,n,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=n,this.code=r}}function le(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class Pj extends P0{constructor(e,n,r){super(e,n,r),this.name="AuthApiError",this.status=n,this.code=r}}function Mj(t){return le(t)&&t.name==="AuthApiError"}class oT extends P0{constructor(e,n){super(e),this.name="AuthUnknownError",this.originalError=n}}class Hs extends P0{constructor(e,n,r,i){super(e,r,i),this.name=n,this.status=r}}class Ei extends Hs{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Ij(t){return le(t)&&t.name==="AuthSessionMissingError"}class hm extends Hs{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Ed extends Hs{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Td extends Hs{constructor(e,n=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Aj(t){return le(t)&&t.name==="AuthImplicitGrantRedirectError"}class wb extends Hs{constructor(e,n=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class by extends Hs{constructor(e,n){super(e,"AuthRetryableFetchError",n,void 0)}}function pm(t){return le(t)&&t.name==="AuthRetryableFetchError"}class bb extends Hs{constructor(e,n,r){super(e,"AuthWeakPasswordError",n,"weak_password"),this.reasons=r}}var Nj=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};const Go=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),Dj=[502,503,504];async function Sb(t){var e;if(!xj(t))throw new by(Go(t),0);if(Dj.includes(t.status))throw new by(Go(t),t.status);let n;try{n=await t.json()}catch(o){throw new oT(Go(o),o)}let r;const i=Oj(t);if(i&&i.getTime()>=nT["2024-01-01"].timestamp&&typeof n=="object"&&n&&typeof n.code=="string"?r=n.code:typeof n=="object"&&n&&typeof n.error_code=="string"&&(r=n.error_code),r){if(r==="weak_password")throw new bb(Go(n),t.status,((e=n.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(r==="session_not_found")throw new Ei}else if(typeof n=="object"&&n&&typeof n.weak_password=="object"&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((o,s)=>o&&typeof s=="string",!0))throw new bb(Go(n),t.status,n.weak_password.reasons);throw new Pj(Go(n),t.status||500,r)}const jj=(t,e,n,r)=>{const i={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),i.body=JSON.stringify(r),Object.assign(Object.assign({},i),n))};async function me(t,e,n,r){var i;const o=Object.assign({},r==null?void 0:r.headers);o[wy]||(o[wy]=nT["2024-01-01"].name),r!=null&&r.jwt&&(o.Authorization=`Bearer ${r.jwt}`);const s=(i=r==null?void 0:r.query)!==null&&i!==void 0?i:{};r!=null&&r.redirectTo&&(s.redirect_to=r.redirectTo);const a=Object.keys(s).length?"?"+new URLSearchParams(s).toString():"",l=await Lj(t,e,n+a,{headers:o,noResolveJson:r==null?void 0:r.noResolveJson},{},r==null?void 0:r.body);return r!=null&&r.xform?r==null?void 0:r.xform(l):{data:Object.assign({},l),error:null}}async function Lj(t,e,n,r,i,o){const s=jj(e,r,i,o);let a;try{a=await t(n,Object.assign({},s))}catch(l){throw console.error(l),new by(Go(l),0)}if(a.ok||await Sb(a),r!=null&&r.noResolveJson)return a;try{return await a.json()}catch(l){await Sb(l)}}function Ti(t){var e;let n=null;zj(t)&&(n=Object.assign({},t),t.expires_at||(n.expires_at=gj(t.expires_in)));const r=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:n,user:r},error:null}}function Cb(t){const e=Ti(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((n,r)=>n&&typeof r=="string",!0)&&(e.data.weak_password=t.weak_password),e}function Ki(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function $j(t){return{data:t,error:null}}function Fj(t){const{action_link:e,email_otp:n,hashed_token:r,redirect_to:i,verification_type:o}=t,s=Nj(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),a={action_link:e,email_otp:n,hashed_token:r,redirect_to:i,verification_type:o},l=Object.assign({},s);return{data:{properties:a,user:l},error:null}}function Bj(t){return t}function zj(t){return t.access_token&&t.refresh_token&&t.expires_in}var Vj=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};class Uj{constructor({url:e="",headers:n={},fetch:r}){this.url=e,this.headers=n,this.fetch=rT(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,n="global"){try{return await me(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(le(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,n={}){try{return await me(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:Ki})}catch(r){if(le(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:n}=e,r=Vj(e,["options"]),i=Object.assign(Object.assign({},r),n);return"newEmail"in r&&(i.new_email=r==null?void 0:r.newEmail,delete i.newEmail),await me(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:Fj,redirectTo:n==null?void 0:n.redirectTo})}catch(n){if(le(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(e){try{return await me(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Ki})}catch(n){if(le(n))return{data:{user:null},error:n};throw n}}async listUsers(e){var n,r,i,o,s,a,l;try{const c={nextPage:null,lastPage:0,total:0},u=await me(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(n=e==null?void 0:e.page)===null||n===void 0?void 0:n.toString())!==null&&r!==void 0?r:"",per_page:(o=(i=e==null?void 0:e.perPage)===null||i===void 0?void 0:i.toString())!==null&&o!==void 0?o:""},xform:Bj});if(u.error)throw u.error;const d=await u.json(),h=(s=u.headers.get("x-total-count"))!==null&&s!==void 0?s:0,p=(l=(a=u.headers.get("link"))===null||a===void 0?void 0:a.split(","))!==null&&l!==void 0?l:[];return p.length>0&&(p.forEach(m=>{const y=parseInt(m.split(";")[0].split("=")[1].substring(0,1)),v=JSON.parse(m.split(";")[1].split("=")[1]);c[`${v}Page`]=y}),c.total=parseInt(h)),{data:Object.assign(Object.assign({},d),c),error:null}}catch(c){if(le(c))return{data:{users:[]},error:c};throw c}}async getUserById(e){try{return await me(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Ki})}catch(n){if(le(n))return{data:{user:null},error:n};throw n}}async updateUserById(e,n){try{return await me(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:n,headers:this.headers,xform:Ki})}catch(r){if(le(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,n=!1){try{return await me(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:n},xform:Ki})}catch(r){if(le(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){try{const{data:n,error:r}=await me(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:i=>({data:{factors:i},error:null})});return{data:n,error:r}}catch(n){if(le(n))return{data:null,error:n};throw n}}async _deleteFactor(e){try{return{data:await me(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(n){if(le(n))return{data:null,error:n};throw n}}}const Hj={getItem:t=>Ec()?globalThis.localStorage.getItem(t):null,setItem:(t,e)=>{Ec()&&globalThis.localStorage.setItem(t,e)},removeItem:t=>{Ec()&&globalThis.localStorage.removeItem(t)}};function kb(t={}){return{getItem:e=>t[e]||null,setItem:(e,n)=>{t[e]=n},removeItem:e=>{delete t[e]}}}function Wj(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const ea={debug:!!(globalThis&&Ec()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class sT extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class Kj extends sT{}async function qj(t,e,n){ea.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const r=new globalThis.AbortController;return e>0&&setTimeout(()=>{r.abort(),ea.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async i=>{if(i){ea.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,i.name);try{return await n()}finally{ea.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,i.name)}}else{if(e===0)throw ea.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new Kj(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(ea.debug)try{const o=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(o,null,"  "))}catch(o){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",o)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}}))}Wj();const Gj={url:hj,storageKey:pj,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:mj,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Eb(t,e,n){return await n()}class Zc{constructor(e){var n,r;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Zc.nextInstanceID,Zc.nextInstanceID+=1,this.instanceID>0&&Sr()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const i=Object.assign(Object.assign({},Gj),e);if(this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.persistSession=i.persistSession,this.storageKey=i.storageKey,this.autoRefreshToken=i.autoRefreshToken,this.admin=new Uj({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=rT(i.fetch),this.lock=i.lock||Eb,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,i.lock?this.lock=i.lock:Sr()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=qj:this.lock=Eb,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?i.storage?this.storage=i.storage:Ec()?this.storage=Hj:(this.memoryStorage={},this.storage=kb(this.memoryStorage)):(this.memoryStorage={},this.storage=kb(this.memoryStorage)),Sr()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(o){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",o)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async o=>{this._debug("received broadcast notification from other tab or client",o),await this._notifyAllSubscribers(o.data.event,o.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${tT}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const n=vj(window.location.href);let r="none";if(this._isImplicitGrantCallback(n)?r="implicit":await this._isPKCECallback(n)&&(r="pkce"),Sr()&&this.detectSessionInUrl&&r!=="none"){const{data:i,error:o}=await this._getSessionFromURL(n,r);if(o){if(this._debug("#_initialize()","error detecting session from URL",o),Aj(o)){const l=(e=o.details)===null||e===void 0?void 0:e.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:o}}return await this._removeSession(),{error:o}}const{session:s,redirectType:a}=i;return this._debug("#_initialize()","detected session in URL",s,"redirect type",a),await this._saveSession(s),setTimeout(async()=>{a==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",s):await this._notifyAllSubscribers("SIGNED_IN",s)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(n){return le(n)?{error:n}:{error:new oT("Unexpected error during initialization",n)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var n,r,i;try{const o=await me(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(n=e==null?void 0:e.options)===null||n===void 0?void 0:n.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(i=e==null?void 0:e.options)===null||i===void 0?void 0:i.captchaToken}},xform:Ti}),{data:s,error:a}=o;if(a||!s)return{data:{user:null,session:null},error:a};const l=s.session,c=s.user;return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(o){if(le(o))return{data:{user:null,session:null},error:o};throw o}}async signUp(e){var n,r,i;try{let o;if("email"in e){const{email:u,password:d,options:h}=e;let p=null,m=null;this.flowType==="pkce"&&([p,m]=await Zs(this.storage,this.storageKey)),o=await me(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:h==null?void 0:h.emailRedirectTo,body:{email:u,password:d,data:(n=h==null?void 0:h.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken},code_challenge:p,code_challenge_method:m},xform:Ti})}else if("phone"in e){const{phone:u,password:d,options:h}=e;o=await me(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:d,data:(r=h==null?void 0:h.data)!==null&&r!==void 0?r:{},channel:(i=h==null?void 0:h.channel)!==null&&i!==void 0?i:"sms",gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}},xform:Ti})}else throw new Ed("You must provide either an email or phone number and a password");const{data:s,error:a}=o;if(a||!s)return{data:{user:null,session:null},error:a};const l=s.session,c=s.user;return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(o){if(le(o))return{data:{user:null,session:null},error:o};throw o}}async signInWithPassword(e){try{let n;if("email"in e){const{email:o,password:s,options:a}=e;n=await me(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:o,password:s,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:Cb})}else if("phone"in e){const{phone:o,password:s,options:a}=e;n=await me(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:o,password:s,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:Cb})}else throw new Ed("You must provide either an email or phone number and a password");const{data:r,error:i}=n;return i?{data:{user:null,session:null},error:i}:!r||!r.session||!r.user?{data:{user:null,session:null},error:new hm}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:i})}catch(n){if(le(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOAuth(e){var n,r,i,o;return await this._handleProviderSignIn(e.provider,{redirectTo:(n=e.options)===null||n===void 0?void 0:n.redirectTo,scopes:(r=e.options)===null||r===void 0?void 0:r.scopes,queryParams:(i=e.options)===null||i===void 0?void 0:i.queryParams,skipBrowserRedirect:(o=e.options)===null||o===void 0?void 0:o.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async _exchangeCodeForSession(e){const n=await Cd(this.storage,`${this.storageKey}-code-verifier`),[r,i]=(n??"").split("/");try{const{data:o,error:s}=await me(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:Ti});if(await kd(this.storage,`${this.storageKey}-code-verifier`),s)throw s;return!o||!o.session||!o.user?{data:{user:null,session:null,redirectType:null},error:new hm}:(o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",o.session)),{data:Object.assign(Object.assign({},o),{redirectType:i??null}),error:s})}catch(o){if(le(o))return{data:{user:null,session:null,redirectType:null},error:o};throw o}}async signInWithIdToken(e){try{const{options:n,provider:r,token:i,access_token:o,nonce:s}=e,a=await me(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:i,access_token:o,nonce:s,gotrue_meta_security:{captcha_token:n==null?void 0:n.captchaToken}},xform:Ti}),{data:l,error:c}=a;return c?{data:{user:null,session:null},error:c}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new hm}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:c})}catch(n){if(le(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOtp(e){var n,r,i,o,s;try{if("email"in e){const{email:a,options:l}=e;let c=null,u=null;this.flowType==="pkce"&&([c,u]=await Zs(this.storage,this.storageKey));const{error:d}=await me(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:a,data:(n=l==null?void 0:l.data)!==null&&n!==void 0?n:{},create_user:(r=l==null?void 0:l.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:c,code_challenge_method:u},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:d}}if("phone"in e){const{phone:a,options:l}=e,{data:c,error:u}=await me(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:a,data:(i=l==null?void 0:l.data)!==null&&i!==void 0?i:{},create_user:(o=l==null?void 0:l.shouldCreateUser)!==null&&o!==void 0?o:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(s=l==null?void 0:l.channel)!==null&&s!==void 0?s:"sms"}});return{data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:u}}throw new Ed("You must provide either an email or phone number.")}catch(a){if(le(a))return{data:{user:null,session:null},error:a};throw a}}async verifyOtp(e){var n,r;try{let i,o;"options"in e&&(i=(n=e.options)===null||n===void 0?void 0:n.redirectTo,o=(r=e.options)===null||r===void 0?void 0:r.captchaToken);const{data:s,error:a}=await me(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:o}}),redirectTo:i,xform:Ti});if(a)throw a;if(!s)throw new Error("An error occurred on token verification.");const l=s.session,c=s.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(i){if(le(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithSSO(e){var n,r,i;try{let o=null,s=null;return this.flowType==="pkce"&&([o,s]=await Zs(this.storage,this.storageKey)),await me(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(r=(n=e.options)===null||n===void 0?void 0:n.redirectTo)!==null&&r!==void 0?r:void 0}),!((i=e==null?void 0:e.options)===null||i===void 0)&&i.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:o,code_challenge_method:s}),headers:this.headers,xform:$j})}catch(o){if(le(o))return{data:null,error:o};throw o}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:n},error:r}=e;if(r)throw r;if(!n)throw new Ei;const{error:i}=await me(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return{data:{user:null,session:null},error:i}})}catch(e){if(le(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const n=`${this.url}/resend`;if("email"in e){const{email:r,type:i,options:o}=e,{error:s}=await me(this.fetch,"POST",n,{headers:this.headers,body:{email:r,type:i,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},redirectTo:o==null?void 0:o.emailRedirectTo});return{data:{user:null,session:null},error:s}}else if("phone"in e){const{phone:r,type:i,options:o}=e,{data:s,error:a}=await me(this.fetch,"POST",n,{headers:this.headers,body:{phone:r,type:i,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}}});return{data:{user:null,session:null,messageId:s==null?void 0:s.message_id},error:a}}throw new Ed("You must provide either an email or phone number and a type")}catch(n){if(le(n))return{data:{user:null,session:null},error:n};throw n}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async n=>n))}async _acquireLock(e,n){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),i=(async()=>(await r,await n()))();return this.pendingInLock.push((async()=>{try{await i}catch{}})()),i}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=n();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const i=[...this.pendingInLock];await Promise.all(i),this.pendingInLock.splice(0,i.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await e(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const n=await Cd(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?e=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=e.expires_at?e.expires_at*1e3-Date.now()<fm:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.storage.isServer){let s=this.suppressGetSessionWarning;e=new Proxy(e,{get:(l,c,u)=>(!s&&c==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),s=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,c,u))})}return{data:{session:e},error:null}}const{session:i,error:o}=await this._callRefreshToken(e.refresh_token);return o?{data:{session:null},error:o}:{data:{session:i},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await me(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Ki}):await this._useSession(async n=>{var r,i,o;const{data:s,error:a}=n;if(a)throw a;return!(!((r=s.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Ei}:await me(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(o=(i=s.session)===null||i===void 0?void 0:i.access_token)!==null&&o!==void 0?o:void 0,xform:Ki})})}catch(n){if(le(n))return Ij(n)&&(await this._removeSession(),await kd(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:n};throw n}}async updateUser(e,n={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,n))}async _updateUser(e,n={}){try{return await this._useSession(async r=>{const{data:i,error:o}=r;if(o)throw o;if(!i.session)throw new Ei;const s=i.session;let a=null,l=null;this.flowType==="pkce"&&e.email!=null&&([a,l]=await Zs(this.storage,this.storageKey));const{data:c,error:u}=await me(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n==null?void 0:n.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:a,code_challenge_method:l}),jwt:s.access_token,xform:Ki});if(u)throw u;return s.user=c.user,await this._saveSession(s),await this._notifyAllSubscribers("USER_UPDATED",s),{data:{user:s.user},error:null}})}catch(r){if(le(r))return{data:{user:null},error:r};throw r}}_decodeJWT(e){return xb(e)}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Ei;const n=Date.now()/1e3;let r=n,i=!0,o=null;const s=xb(e.access_token);if(s.exp&&(r=s.exp,i=r<=n),i){const{session:a,error:l}=await this._callRefreshToken(e.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!a)return{data:{user:null,session:null},error:null};o=a}else{const{data:a,error:l}=await this._getUser(e.access_token);if(l)throw l;o={access_token:e.access_token,refresh_token:e.refresh_token,user:a.user,token_type:"bearer",expires_in:r-n,expires_at:r},await this._saveSession(o),await this._notifyAllSubscribers("SIGNED_IN",o)}return{data:{user:o.user,session:o},error:null}}catch(n){if(le(n))return{data:{session:null,user:null},error:n};throw n}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async n=>{var r;if(!e){const{data:s,error:a}=n;if(a)throw a;e=(r=s.session)!==null&&r!==void 0?r:void 0}if(!(e!=null&&e.refresh_token))throw new Ei;const{session:i,error:o}=await this._callRefreshToken(e.refresh_token);return o?{data:{user:null,session:null},error:o}:i?{data:{user:i.user,session:i},error:null}:{data:{user:null,session:null},error:null}})}catch(n){if(le(n))return{data:{user:null,session:null},error:n};throw n}}async _getSessionFromURL(e,n){try{if(!Sr())throw new Td("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Td(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(n){case"implicit":if(this.flowType==="pkce")throw new wb("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Td("Not a valid implicit grant flow url.");break;default:}if(n==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new wb("No code detected.");const{data:w,error:b}=await this._exchangeCodeForSession(e.code);if(b)throw b;const S=new URL(window.location.href);return S.searchParams.delete("code"),window.history.replaceState(window.history.state,"",S.toString()),{data:{session:w.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:i,access_token:o,refresh_token:s,expires_in:a,expires_at:l,token_type:c}=e;if(!o||!a||!s||!c)throw new Td("No session defined in URL");const u=Math.round(Date.now()/1e3),d=parseInt(a);let h=u+d;l&&(h=parseInt(l));const p=h-u;p*1e3<=ca&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${p}s, should have been closer to ${d}s`);const m=h-d;u-m>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",m,h,u):u-m<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",m,h,u);const{data:y,error:v}=await this._getUser(o);if(v)throw v;const x={provider_token:r,provider_refresh_token:i,access_token:o,expires_in:d,expires_at:h,refresh_token:s,token_type:c,user:y.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:x,redirectType:e.type},error:null}}catch(r){if(le(r))return{data:{session:null,redirectType:null},error:r};throw r}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const n=await Cd(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&n)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async n=>{var r;const{data:i,error:o}=n;if(o)return{error:o};const s=(r=i.session)===null||r===void 0?void 0:r.access_token;if(s){const{error:a}=await this.admin.signOut(s,e);if(a&&!(Mj(a)&&(a.status===404||a.status===401||a.status===403)))return{error:a}}return e!=="others"&&(await this._removeSession(),await kd(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const n=yj(),r={id:n,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async n=>{var r,i;try{const{data:{session:o},error:s}=n;if(s)throw s;await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",o)),this._debug("INITIAL_SESSION","callback id",e,"session",o)}catch(o){await((i=this.stateChangeEmitters.get(e))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",o),console.error(o)}})}async resetPasswordForEmail(e,n={}){let r=null,i=null;this.flowType==="pkce"&&([r,i]=await Zs(this.storage,this.storageKey,!0));try{return await me(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:i,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(o){if(le(o))return{data:null,error:o};throw o}}async getUserIdentities(){var e;try{const{data:n,error:r}=await this.getUser();if(r)throw r;return{data:{identities:(e=n.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(n){if(le(n))return{data:null,error:n};throw n}}async linkIdentity(e){var n;try{const{data:r,error:i}=await this._useSession(async o=>{var s,a,l,c,u;const{data:d,error:h}=o;if(h)throw h;const p=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(s=e.options)===null||s===void 0?void 0:s.redirectTo,scopes:(a=e.options)===null||a===void 0?void 0:a.scopes,queryParams:(l=e.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await me(this.fetch,"GET",p,{headers:this.headers,jwt:(u=(c=d.session)===null||c===void 0?void 0:c.access_token)!==null&&u!==void 0?u:void 0})});if(i)throw i;return Sr()&&!(!((n=e.options)===null||n===void 0)&&n.skipBrowserRedirect)&&window.location.assign(r==null?void 0:r.url),{data:{provider:e.provider,url:r==null?void 0:r.url},error:null}}catch(r){if(le(r))return{data:{provider:e.provider,url:null},error:r};throw r}}async unlinkIdentity(e){try{return await this._useSession(async n=>{var r,i;const{data:o,error:s}=n;if(s)throw s;return await me(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(i=(r=o.session)===null||r===void 0?void 0:r.access_token)!==null&&i!==void 0?i:void 0})})}catch(n){if(le(n))return{data:null,error:n};throw n}}async _refreshAccessToken(e){const n=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{const r=Date.now();return await Sj(async i=>(i>0&&await bj(200*Math.pow(2,i-1)),this._debug(n,"refreshing attempt",i),await me(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Ti})),(i,o)=>{const s=200*Math.pow(2,i);return o&&pm(o)&&Date.now()+s-r<ca})}catch(r){if(this._debug(n,"error",r),le(r))return{data:{session:null,user:null},error:r};throw r}finally{this._debug(n,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,n){const r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",n,"url",r),Sr()&&!n.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const r=await Cd(this.storage,this.storageKey);if(this._debug(n,"session from storage",r),!this._isValidSession(r)){this._debug(n,"session is not valid"),r!==null&&await this._removeSession();return}const i=((e=r.expires_at)!==null&&e!==void 0?e:1/0)*1e3-Date.now()<fm;if(this._debug(n,`session has${i?"":" not"} expired with margin of ${fm}s`),i){if(this.autoRefreshToken&&r.refresh_token){const{error:o}=await this._callRefreshToken(r.refresh_token);o&&(console.error(o),pm(o)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",r)}catch(r){this._debug(n,"error",r),console.error(r);return}finally{this._debug(n,"end")}}async _callRefreshToken(e){var n,r;if(!e)throw new Ei;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const i=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(i,"begin");try{this.refreshingDeferred=new qh;const{data:o,error:s}=await this._refreshAccessToken(e);if(s)throw s;if(!o.session)throw new Ei;await this._saveSession(o.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",o.session);const a={session:o.session,error:null};return this.refreshingDeferred.resolve(a),a}catch(o){if(this._debug(i,"error",o),le(o)){const s={session:null,error:o};return pm(o)||await this._removeSession(),(n=this.refreshingDeferred)===null||n===void 0||n.resolve(s),s}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(o),o}finally{this.refreshingDeferred=null,this._debug(i,"end")}}async _notifyAllSubscribers(e,n,r=!0){const i=`#_notifyAllSubscribers(${e})`;this._debug(i,"begin",n,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:n});const o=[],s=Array.from(this.stateChangeEmitters.values()).map(async a=>{try{await a.callback(e,n)}catch(l){o.push(l)}});if(await Promise.all(s),o.length>0){for(let a=0;a<o.length;a+=1)console.error(o[a]);throw o[0]}}finally{this._debug(i,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await iT(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await kd(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Sr()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(n){console.error("removing visibilitychange callback failed",n)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),ca);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async n=>{const{data:{session:r}}=n;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const i=Math.floor((r.expires_at*1e3-e)/ca);this._debug("#_autoRefreshTokenTick()",`access token expires in ${i} ticks, a tick lasts ${ca}ms, refresh threshold is ${xy} ticks`),i<=xy&&await this._callRefreshToken(r.refresh_token)})}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof sT)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Sr()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const n=`#_onVisibilityChanged(${e})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,n,r){const i=[`provider=${encodeURIComponent(n)}`];if(r!=null&&r.redirectTo&&i.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r!=null&&r.scopes&&i.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[o,s]=await Zs(this.storage,this.storageKey),a=new URLSearchParams({code_challenge:`${encodeURIComponent(o)}`,code_challenge_method:`${encodeURIComponent(s)}`});i.push(a.toString())}if(r!=null&&r.queryParams){const o=new URLSearchParams(r.queryParams);i.push(o.toString())}return r!=null&&r.skipBrowserRedirect&&i.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${i.join("&")}`}async _unenroll(e){try{return await this._useSession(async n=>{var r;const{data:i,error:o}=n;return o?{data:null,error:o}:await me(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token})})}catch(n){if(le(n))return{data:null,error:n};throw n}}async _enroll(e){try{return await this._useSession(async n=>{var r,i;const{data:o,error:s}=n;if(s)return{data:null,error:s};const a=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:l,error:c}=await me(this.fetch,"POST",`${this.url}/factors`,{body:a,headers:this.headers,jwt:(r=o==null?void 0:o.session)===null||r===void 0?void 0:r.access_token});return c?{data:null,error:c}:(e.factorType==="totp"&&(!((i=l==null?void 0:l.totp)===null||i===void 0)&&i.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(n){if(le(n))return{data:null,error:n};throw n}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var r;const{data:i,error:o}=n;if(o)return{data:null,error:o};const{data:s,error:a}=await me(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token});return a?{data:null,error:a}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+s.expires_in},s)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",s),{data:s,error:a})})}catch(n){if(le(n))return{data:null,error:n};throw n}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var r;const{data:i,error:o}=n;return o?{data:null,error:o}:await me(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token})})}catch(n){if(le(n))return{data:null,error:n};throw n}})}async _challengeAndVerify(e){const{data:n,error:r}=await this._challenge({factorId:e.factorId});return r?{data:null,error:r}:await this._verify({factorId:e.factorId,challengeId:n.id,code:e.code})}async _listFactors(){const{data:{user:e},error:n}=await this.getUser();if(n)return{data:null,error:n};const r=(e==null?void 0:e.factors)||[],i=r.filter(s=>s.factor_type==="totp"&&s.status==="verified"),o=r.filter(s=>s.factor_type==="phone"&&s.status==="verified");return{data:{all:r,totp:i,phone:o},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var n,r;const{data:{session:i},error:o}=e;if(o)return{data:null,error:o};if(!i)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const s=this._decodeJWT(i.access_token);let a=null;s.aal&&(a=s.aal);let l=a;((r=(n=i.user.factors)===null||n===void 0?void 0:n.filter(d=>d.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(l="aal2");const u=s.amr||[];return{data:{currentLevel:a,nextLevel:l,currentAuthenticationMethods:u},error:null}}))}}Zc.nextInstanceID=0;const Jj=Zc;class Yj extends Jj{constructor(e){super(e)}}var Qj=globalThis&&globalThis.__awaiter||function(t,e,n,r){function i(o){return o instanceof n?o:new n(function(s){s(o)})}return new(n||(n=Promise))(function(o,s){function a(u){try{c(r.next(u))}catch(d){s(d)}}function l(u){try{c(r.throw(u))}catch(d){s(d)}}function c(u){u.done?o(u.value):i(u.value).then(a,l)}c((r=r.apply(t,e||[])).next())})};class Xj{constructor(e,n,r){var i,o,s;if(this.supabaseUrl=e,this.supabaseKey=n,!e)throw new Error("supabaseUrl is required.");if(!n)throw new Error("supabaseKey is required.");const a=dj(e);this.realtimeUrl=`${a}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${a}/auth/v1`,this.storageUrl=`${a}/storage/v1`,this.functionsUrl=`${a}/functions/v1`;const l=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,c={db:rj,realtime:oj,auth:Object.assign(Object.assign({},ij),{storageKey:l}),global:nj},u=fj(r??{},c);this.storageKey=(i=u.auth.storageKey)!==null&&i!==void 0?i:"",this.headers=(o=u.global.headers)!==null&&o!==void 0?o:{},u.accessToken?(this.accessToken=u.accessToken,this.auth=new Proxy({},{get:(d,h)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(h)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((s=u.auth)!==null&&s!==void 0?s:{},this.headers,u.global.fetch),this.fetch=cj(n,this._getAccessToken.bind(this),u.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},u.realtime)),this.rest=new kD(`${a}/rest/v1`,{headers:this.headers,schema:u.db.schema,fetch:this.fetch}),u.accessToken||this._listenForAuthEvents()}get functions(){return new eD(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new ZD(this.storageUrl,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,n={},r={}){return this.rest.rpc(e,n,r)}channel(e,n={config:{}}){return this.realtime.channel(e,n)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,n;return Qj(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:r}=yield this.auth.getSession();return(n=(e=r.session)===null||e===void 0?void 0:e.access_token)!==null&&n!==void 0?n:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:n,detectSessionInUrl:r,storage:i,storageKey:o,flowType:s,lock:a,debug:l},c,u){const d={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Yj({url:this.authUrl,headers:Object.assign(Object.assign({},d),c),storageKey:o,autoRefreshToken:e,persistSession:n,detectSessionInUrl:r,storage:i,flowType:s,lock:a,debug:l,fetch:u,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new FD(this.realtimeUrl,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((n,r)=>{this._handleTokenChanged(n,"CLIENT",r==null?void 0:r.access_token)})}_handleTokenChanged(e,n,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?this.changedAccessToken=r:e==="SIGNED_OUT"&&(this.realtime.setAuth(),n=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const Zj=(t,e,n)=>new Xj(t,e,n);function eL(){const t="production";return{apiUrl:"https://api.eastmedical.ai",wsUrl:{}.VITE_WS_URL||"ws://localhost:3000",supabaseUrl:"https://apnxgktdaiqoesqyseiz.supabase.co",supabaseAnonKey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFwbnhna3RkYWlxb2VzcXlzZWl6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDExMzQxNjEsImV4cCI6MjA1NjcxMDE2MX0.XhGhD7ESMUFhZso3wY_ee_WHGWde5v748qFDAhgSQ04",environment:t}}const $r=eL(),sn=Zj($r.supabaseUrl,$r.supabaseAnonKey,{realtime:{params:{eventsPerSecond:10}},auth:{persistSession:!0,autoRefreshToken:!0}});function Je(){return sn}const aT=g.createContext(void 0);function tL({children:t}){const e=Je(),[n,r]=g.useState(void 0),[i,o]=g.useState(!0),s=Ur();g.useEffect(()=>{e.auth.getSession().then(({data:{session:d}})=>{r((d==null?void 0:d.user)??void 0),o(!1)});const{data:{subscription:u}}=e.auth.onAuthStateChange((d,h)=>{r((h==null?void 0:h.user)??void 0),d==="SIGNED_OUT"&&s.clear()});return()=>{u.unsubscribe()}},[e,s]);const c={user:n,loading:i,signIn:async(u,d)=>{const{data:h,error:p}=await e.auth.signInWithPassword({email:u,password:d});if(p)throw p;return h},signOut:async()=>{const{error:u}=await e.auth.signOut();if(u)throw u;s.clear()}};return f.jsx(aT.Provider,{value:c,children:t})}const wi={container:{display:"flex",gap:"24px",height:"100%"},transcriptPanel:{flex:1,display:"flex",flexDirection:"column",backgroundColor:"white",borderRadius:"6px",border:"1px solid #e5e7eb",padding:"16px",overflow:"auto"},contextPanel:{flex:1,display:"flex",flexDirection:"column",backgroundColor:"white",borderRadius:"6px",border:"1px solid #e5e7eb",padding:"16px",overflow:"auto"},text:{fontSize:"16px",color:"#374151",lineHeight:"1.5",whiteSpace:"pre-wrap",margin:0},contentContainer:{display:"flex",flexDirection:"column",height:"100%"},contextTitle:{fontSize:"18px",fontWeight:600,color:"#111827",marginBottom:"12px"},contextContent:{fontSize:"16px",lineHeight:"1.5",color:"#374151",whiteSpace:"pre-wrap",flex:1}};function nL({transcription:t="",placeholder:e="Your transcription will appear here as you speak...",isTranscribing:n,visit:r,aiContextNote:i}){const[o,s]=g.useState(""),a=g.useRef([]),l=g.useRef(null),c=g.useRef(0),u=g.useRef(t),d=g.useCallback(()=>{l.current&&(window.clearTimeout(l.current),l.current=null)},[]);g.useEffect(()=>{s(""),a.current=[],c.current=0,u.current="",d()},[r==null?void 0:r.id,d]);const h=g.useCallback((y,v)=>{const x=100+Math.random()*100,w=Math.min(y.length*10,100),b=/[,.!?]$/.test(y)?200:0,S=Math.max(.7,1-v/200);return(x+w+b)*S},[]),p=g.useCallback(()=>{const y=a.current;if(y.length>0){const v=y[0];if(a.current=y.slice(1),c.current+=1,s(x=>{const w=x.length>0&&!/[\s\u4e00-\u9fff]$/.test(x)&&!/^[\u4e00-\u9fff]/.test(v);return x+(w?" ":"")+v}),a.current.length>0){const x=h(v,c.current);d(),l.current=window.setTimeout(p,x)}else d()}},[h,d]),m=g.useCallback(y=>{if(!y)return[];const x=y.replace(/([\u4e00-\u9fff])/g," $1 ").split(/\s+/).filter(Boolean),w=[];for(const b of x)if(/[\u4e00-\u9fff]/.test(b)){const S=b.split("");w.push(...S)}else w.push(b);return w},[]);return g.useEffect(()=>{if(!n){s(t),d();return}if(t===u.current)return;if(u.current=t,!t){console.log("[LiveTranscriptionDisplay] Resetting display - no transcription"),s(""),a.current=[],c.current=0,d();return}const y=m(t);if(y.length<c.current){console.log("[LiveTranscriptionDisplay] Reset detected"),d(),s(t),a.current=[],c.current=y.length;return}if(y.length>c.current){console.log("[LiveTranscriptionDisplay] New words detected:",{newWordsCount:y.length-c.current});const v=y.slice(c.current);a.current=v,l.current||p()}},[t,n,d,m,p]),g.useEffect(()=>()=>{d()},[d]),f.jsxs("div",{style:wi.container,children:[f.jsxs("div",{style:wi.transcriptPanel,children:[f.jsx("div",{style:wi.contextTitle,children:"Transcript"}),f.jsx("div",{style:wi.contentContainer,children:f.jsx("p",{style:wi.text,children:o||t||e})})]}),f.jsxs("div",{style:wi.contextPanel,children:[f.jsx("div",{style:wi.contextTitle,children:"Context"}),f.jsx("div",{style:wi.contextContent,children:(i==null?void 0:i.content)||"No context available yet..."})]})]})}const Dt={modalOverlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3},modalContent:{backgroundColor:"white",padding:"24px",borderRadius:"8px",width:"90%",maxWidth:"600px",maxHeight:"80vh",display:"flex",flexDirection:"column"},header:{marginBottom:"16px"},title:{fontSize:"18px",fontWeight:"600",color:"#111827",marginBottom:"8px"},description:{fontSize:"14px",color:"#6b7280"},templateList:{overflowY:"auto",flex:1,marginBottom:"16px",padding:"8px 0"},templateItem:{padding:"12px 16px",borderRadius:"6px",cursor:"pointer",transition:"all 0.2s ease",marginBottom:"8px",border:"1px solid #e5e7eb",minHeight:"48px",display:"flex","&:hover":{backgroundColor:"#f3f4f6"}},templateName:{fontSize:"16px",fontWeight:"500",color:"#111827",marginBottom:"4px"},templateDescription:{fontSize:"14px",color:"#6b7280"},footer:{display:"flex",justifyContent:"flex-end",gap:"8px",borderTop:"1px solid #e5e7eb",paddingTop:"16px"},button:{padding:"8px 16px",borderRadius:"6px",border:"none",cursor:"pointer",fontSize:"14px",fontWeight:"500",transition:"all 0.2s ease"},cancelButton:{backgroundColor:"#f3f4f6",color:"#374151","&:hover":{backgroundColor:"#e5e7eb"}},generateButton:{backgroundColor:"#3b82f6",color:"white","&:hover":{backgroundColor:"#2563eb"}},disabledButton:{opacity:.5,cursor:"not-allowed","&:hover":{backgroundColor:"#3b82f6"}}};function rL({isOpen:t,onClose:e,onGenerate:n,existingTemplateIds:r=[]}){const[i,o]=g.useState([]),[s,a]=g.useState(void 0),[l,c]=g.useState(!0),u=Je();if(g.useEffect(()=>{t&&(async()=>{try{const{data:h,error:p}=await u.from("template_library").select("*").order("name");if(p)throw p;const m=(h==null?void 0:h.filter(y=>!r.includes(y.id)))||[];console.log("Available templates:",m),o(m)}catch(h){console.error("Error fetching templates:",h)}finally{c(!1)}})()},[t,u,r]),!!t)return f.jsx("div",{style:Dt.modalOverlay,onClick:e,children:f.jsxs("div",{style:Dt.modalContent,onClick:d=>d.stopPropagation(),children:[f.jsxs("div",{style:Dt.header,children:[f.jsx("h2",{style:Dt.title,children:"Select Template"}),f.jsx("p",{style:Dt.description,children:"Choose a template to generate a new note"})]}),f.jsx("div",{style:Dt.templateList,children:l?f.jsx("div",{children:"Loading templates..."}):i.length===0?f.jsx("div",{children:"No templates available"}):i.map(d=>f.jsxs("div",{style:{...Dt.templateItem,...(s==null?void 0:s.id)===d.id?{backgroundColor:"#f3f4f6",borderColor:"#3b82f6"}:{}},onClick:()=>a(d),children:[f.jsx("div",{style:Dt.templateName,children:d.name}),d.description&&f.jsx("div",{style:Dt.templateDescription,children:d.description})]},d.id))}),f.jsxs("div",{style:Dt.footer,children:[f.jsx("button",{style:{...Dt.button,...Dt.cancelButton},onClick:e,children:"Cancel"}),f.jsx("button",{style:{...Dt.button,...Dt.generateButton,...!s||l?Dt.disabledButton:{}},onClick:()=>s&&n(s),disabled:!s||l,children:"Generate Note"})]})]})})}function pt(t){this.content=t}pt.prototype={constructor:pt,find:function(t){for(var e=0;e<this.content.length;e+=2)if(this.content[e]===t)return e;return-1},get:function(t){var e=this.find(t);return e==-1?void 0:this.content[e+1]},update:function(t,e,n){var r=n&&n!=t?this.remove(n):this,i=r.find(t),o=r.content.slice();return i==-1?o.push(n||t,e):(o[i+1]=e,n&&(o[i]=n)),new pt(o)},remove:function(t){var e=this.find(t);if(e==-1)return this;var n=this.content.slice();return n.splice(e,2),new pt(n)},addToStart:function(t,e){return new pt([t,e].concat(this.remove(t).content))},addToEnd:function(t,e){var n=this.remove(t).content.slice();return n.push(t,e),new pt(n)},addBefore:function(t,e,n){var r=this.remove(e),i=r.content.slice(),o=r.find(t);return i.splice(o==-1?i.length:o,0,e,n),new pt(i)},forEach:function(t){for(var e=0;e<this.content.length;e+=2)t(this.content[e],this.content[e+1])},prepend:function(t){return t=pt.from(t),t.size?new pt(t.content.concat(this.subtract(t).content)):this},append:function(t){return t=pt.from(t),t.size?new pt(this.subtract(t).content.concat(t.content)):this},subtract:function(t){var e=this;t=pt.from(t);for(var n=0;n<t.content.length;n+=2)e=e.remove(t.content[n]);return e},toObject:function(){var t={};return this.forEach(function(e,n){t[e]=n}),t},get size(){return this.content.length>>1}};pt.from=function(t){if(t instanceof pt)return t;var e=[];if(t)for(var n in t)e.push(n,t[n]);return new pt(e)};function lT(t,e,n){for(let r=0;;r++){if(r==t.childCount||r==e.childCount)return t.childCount==e.childCount?null:n;let i=t.child(r),o=e.child(r);if(i==o){n+=i.nodeSize;continue}if(!i.sameMarkup(o))return n;if(i.isText&&i.text!=o.text){for(let s=0;i.text[s]==o.text[s];s++)n++;return n}if(i.content.size||o.content.size){let s=lT(i.content,o.content,n+1);if(s!=null)return s}n+=i.nodeSize}}function cT(t,e,n,r){for(let i=t.childCount,o=e.childCount;;){if(i==0||o==0)return i==o?null:{a:n,b:r};let s=t.child(--i),a=e.child(--o),l=s.nodeSize;if(s==a){n-=l,r-=l;continue}if(!s.sameMarkup(a))return{a:n,b:r};if(s.isText&&s.text!=a.text){let c=0,u=Math.min(s.text.length,a.text.length);for(;c<u&&s.text[s.text.length-c-1]==a.text[a.text.length-c-1];)c++,n--,r--;return{a:n,b:r}}if(s.content.size||a.content.size){let c=cT(s.content,a.content,n-1,r-1);if(c)return c}n-=l,r-=l}}class B{constructor(e,n){if(this.content=e,this.size=n||0,n==null)for(let r=0;r<e.length;r++)this.size+=e[r].nodeSize}nodesBetween(e,n,r,i=0,o){for(let s=0,a=0;a<n;s++){let l=this.content[s],c=a+l.nodeSize;if(c>e&&r(l,i+a,o||null,s)!==!1&&l.content.size){let u=a+1;l.nodesBetween(Math.max(0,e-u),Math.min(l.content.size,n-u),r,i+u)}a=c}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,n,r,i){let o="",s=!0;return this.nodesBetween(e,n,(a,l)=>{let c=a.isText?a.text.slice(Math.max(e,l)-l,n-l):a.isLeaf?i?typeof i=="function"?i(a):i:a.type.spec.leafText?a.type.spec.leafText(a):"":"";a.isBlock&&(a.isLeaf&&c||a.isTextblock)&&r&&(s?s=!1:o+=r),o+=c},0),o}append(e){if(!e.size)return this;if(!this.size)return e;let n=this.lastChild,r=e.firstChild,i=this.content.slice(),o=0;for(n.isText&&n.sameMarkup(r)&&(i[i.length-1]=n.withText(n.text+r.text),o=1);o<e.content.length;o++)i.push(e.content[o]);return new B(i,this.size+e.size)}cut(e,n=this.size){if(e==0&&n==this.size)return this;let r=[],i=0;if(n>e)for(let o=0,s=0;s<n;o++){let a=this.content[o],l=s+a.nodeSize;l>e&&((s<e||l>n)&&(a.isText?a=a.cut(Math.max(0,e-s),Math.min(a.text.length,n-s)):a=a.cut(Math.max(0,e-s-1),Math.min(a.content.size,n-s-1))),r.push(a),i+=a.nodeSize),s=l}return new B(r,i)}cutByIndex(e,n){return e==n?B.empty:e==0&&n==this.content.length?this:new B(this.content.slice(e,n))}replaceChild(e,n){let r=this.content[e];if(r==n)return this;let i=this.content.slice(),o=this.size+n.nodeSize-r.nodeSize;return i[e]=n,new B(i,o)}addToStart(e){return new B([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new B(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let n=0;n<this.content.length;n++)if(!this.content[n].eq(e.content[n]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let n=this.content[e];if(!n)throw new RangeError("Index "+e+" out of range for "+this);return n}maybeChild(e){return this.content[e]||null}forEach(e){for(let n=0,r=0;n<this.content.length;n++){let i=this.content[n];e(i,r,n),r+=i.nodeSize}}findDiffStart(e,n=0){return lT(this,e,n)}findDiffEnd(e,n=this.size,r=e.size){return cT(this,e,n,r)}findIndex(e,n=-1){if(e==0)return _d(0,e);if(e==this.size)return _d(this.content.length,e);if(e>this.size||e<0)throw new RangeError(`Position ${e} outside of fragment (${this})`);for(let r=0,i=0;;r++){let o=this.child(r),s=i+o.nodeSize;if(s>=e)return s==e||n>0?_d(r+1,s):_d(r,i);i=s}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,n){if(!n)return B.empty;if(!Array.isArray(n))throw new RangeError("Invalid input for Fragment.fromJSON");return new B(n.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return B.empty;let n,r=0;for(let i=0;i<e.length;i++){let o=e[i];r+=o.nodeSize,i&&o.isText&&e[i-1].sameMarkup(o)?(n||(n=e.slice(0,i)),n[n.length-1]=o.withText(n[n.length-1].text+o.text)):n&&n.push(o)}return new B(n||e,r)}static from(e){if(!e)return B.empty;if(e instanceof B)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new B([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}B.empty=new B([],0);const mm={index:0,offset:0};function _d(t,e){return mm.index=t,mm.offset=e,mm}function Kf(t,e){if(t===e)return!0;if(!(t&&typeof t=="object")||!(e&&typeof e=="object"))return!1;let n=Array.isArray(t);if(Array.isArray(e)!=n)return!1;if(n){if(t.length!=e.length)return!1;for(let r=0;r<t.length;r++)if(!Kf(t[r],e[r]))return!1}else{for(let r in t)if(!(r in e)||!Kf(t[r],e[r]))return!1;for(let r in e)if(!(r in t))return!1}return!0}let Re=class Sy{constructor(e,n){this.type=e,this.attrs=n}addToSet(e){let n,r=!1;for(let i=0;i<e.length;i++){let o=e[i];if(this.eq(o))return e;if(this.type.excludes(o.type))n||(n=e.slice(0,i));else{if(o.type.excludes(this.type))return e;!r&&o.type.rank>this.type.rank&&(n||(n=e.slice(0,i)),n.push(this),r=!0),n&&n.push(o)}}return n||(n=e.slice()),r||n.push(this),n}removeFromSet(e){for(let n=0;n<e.length;n++)if(this.eq(e[n]))return e.slice(0,n).concat(e.slice(n+1));return e}isInSet(e){for(let n=0;n<e.length;n++)if(this.eq(e[n]))return!0;return!1}eq(e){return this==e||this.type==e.type&&Kf(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let n in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,n){if(!n)throw new RangeError("Invalid input for Mark.fromJSON");let r=e.marks[n.type];if(!r)throw new RangeError(`There is no mark type ${n.type} in this schema`);let i=r.create(n.attrs);return r.checkAttrs(i.attrs),i}static sameSet(e,n){if(e==n)return!0;if(e.length!=n.length)return!1;for(let r=0;r<e.length;r++)if(!e[r].eq(n[r]))return!1;return!0}static setFrom(e){if(!e||Array.isArray(e)&&e.length==0)return Sy.none;if(e instanceof Sy)return[e];let n=e.slice();return n.sort((r,i)=>r.type.rank-i.type.rank),n}};Re.none=[];class qf extends Error{}class W{constructor(e,n,r){this.content=e,this.openStart=n,this.openEnd=r}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,n){let r=dT(this.content,e+this.openStart,n);return r&&new W(r,this.openStart,this.openEnd)}removeBetween(e,n){return new W(uT(this.content,e+this.openStart,n+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,n){if(!n)return W.empty;let r=n.openStart||0,i=n.openEnd||0;if(typeof r!="number"||typeof i!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new W(B.fromJSON(e,n.content),r,i)}static maxOpen(e,n=!0){let r=0,i=0;for(let o=e.firstChild;o&&!o.isLeaf&&(n||!o.type.spec.isolating);o=o.firstChild)r++;for(let o=e.lastChild;o&&!o.isLeaf&&(n||!o.type.spec.isolating);o=o.lastChild)i++;return new W(e,r,i)}}W.empty=new W(B.empty,0,0);function uT(t,e,n){let{index:r,offset:i}=t.findIndex(e),o=t.maybeChild(r),{index:s,offset:a}=t.findIndex(n);if(i==e||o.isText){if(a!=n&&!t.child(s).isText)throw new RangeError("Removing non-flat range");return t.cut(0,e).append(t.cut(n))}if(r!=s)throw new RangeError("Removing non-flat range");return t.replaceChild(r,o.copy(uT(o.content,e-i-1,n-i-1)))}function dT(t,e,n,r){let{index:i,offset:o}=t.findIndex(e),s=t.maybeChild(i);if(o==e||s.isText)return r&&!r.canReplace(i,i,n)?null:t.cut(0,e).append(n).append(t.cut(e));let a=dT(s.content,e-o-1,n);return a&&t.replaceChild(i,s.copy(a))}function iL(t,e,n){if(n.openStart>t.depth)throw new qf("Inserted content deeper than insertion position");if(t.depth-n.openStart!=e.depth-n.openEnd)throw new qf("Inconsistent open depths");return fT(t,e,n,0)}function fT(t,e,n,r){let i=t.index(r),o=t.node(r);if(i==e.index(r)&&r<t.depth-n.openStart){let s=fT(t,e,n,r+1);return o.copy(o.content.replaceChild(i,s))}else if(n.content.size)if(!n.openStart&&!n.openEnd&&t.depth==r&&e.depth==r){let s=t.parent,a=s.content;return vs(s,a.cut(0,t.parentOffset).append(n.content).append(a.cut(e.parentOffset)))}else{let{start:s,end:a}=oL(n,t);return vs(o,pT(t,s,a,e,r))}else return vs(o,Gf(t,e,r))}function hT(t,e){if(!e.type.compatibleContent(t.type))throw new qf("Cannot join "+e.type.name+" onto "+t.type.name)}function Cy(t,e,n){let r=t.node(n);return hT(r,e.node(n)),r}function ys(t,e){let n=e.length-1;n>=0&&t.isText&&t.sameMarkup(e[n])?e[n]=t.withText(e[n].text+t.text):e.push(t)}function Tc(t,e,n,r){let i=(e||t).node(n),o=0,s=e?e.index(n):i.childCount;t&&(o=t.index(n),t.depth>n?o++:t.textOffset&&(ys(t.nodeAfter,r),o++));for(let a=o;a<s;a++)ys(i.child(a),r);e&&e.depth==n&&e.textOffset&&ys(e.nodeBefore,r)}function vs(t,e){return t.type.checkContent(e),t.copy(e)}function pT(t,e,n,r,i){let o=t.depth>i&&Cy(t,e,i+1),s=r.depth>i&&Cy(n,r,i+1),a=[];return Tc(null,t,i,a),o&&s&&e.index(i)==n.index(i)?(hT(o,s),ys(vs(o,pT(t,e,n,r,i+1)),a)):(o&&ys(vs(o,Gf(t,e,i+1)),a),Tc(e,n,i,a),s&&ys(vs(s,Gf(n,r,i+1)),a)),Tc(r,null,i,a),new B(a)}function Gf(t,e,n){let r=[];if(Tc(null,t,n,r),t.depth>n){let i=Cy(t,e,n+1);ys(vs(i,Gf(t,e,n+1)),r)}return Tc(e,null,n,r),new B(r)}function oL(t,e){let n=e.depth-t.openStart,i=e.node(n).copy(t.content);for(let o=n-1;o>=0;o--)i=e.node(o).copy(B.from(i));return{start:i.resolveNoCache(t.openStart+n),end:i.resolveNoCache(i.content.size-t.openEnd-n)}}class eu{constructor(e,n,r){this.pos=e,this.path=n,this.parentOffset=r,this.depth=n.length/3-1}resolveDepth(e){return e==null?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[this.resolveDepth(e)*3]}index(e){return this.path[this.resolveDepth(e)*3+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e==this.depth&&!this.textOffset?0:1)}start(e){return e=this.resolveDepth(e),e==0?0:this.path[e*3-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]}after(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]+this.path[e*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,n=this.index(this.depth);if(n==e.childCount)return null;let r=this.pos-this.path[this.path.length-1],i=e.child(n);return r?e.child(n).cut(r):i}get nodeBefore(){let e=this.index(this.depth),n=this.pos-this.path[this.path.length-1];return n?this.parent.child(e).cut(0,n):e==0?null:this.parent.child(e-1)}posAtIndex(e,n){n=this.resolveDepth(n);let r=this.path[n*3],i=n==0?0:this.path[n*3-1]+1;for(let o=0;o<e;o++)i+=r.child(o).nodeSize;return i}marks(){let e=this.parent,n=this.index();if(e.content.size==0)return Re.none;if(this.textOffset)return e.child(n).marks;let r=e.maybeChild(n-1),i=e.maybeChild(n);if(!r){let a=r;r=i,i=a}let o=r.marks;for(var s=0;s<o.length;s++)o[s].type.spec.inclusive===!1&&(!i||!o[s].isInSet(i.marks))&&(o=o[s--].removeFromSet(o));return o}marksAcross(e){let n=this.parent.maybeChild(this.index());if(!n||!n.isInline)return null;let r=n.marks,i=e.parent.maybeChild(e.index());for(var o=0;o<r.length;o++)r[o].type.spec.inclusive===!1&&(!i||!r[o].isInSet(i.marks))&&(r=r[o--].removeFromSet(r));return r}sharedDepth(e){for(let n=this.depth;n>0;n--)if(this.start(n)<=e&&this.end(n)>=e)return n;return 0}blockRange(e=this,n){if(e.pos<this.pos)return e.blockRange(this);for(let r=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);r>=0;r--)if(e.pos<=this.end(r)&&(!n||n(this.node(r))))return new Jf(this,e,r);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let n=1;n<=this.depth;n++)e+=(e?"/":"")+this.node(n).type.name+"_"+this.index(n-1);return e+":"+this.parentOffset}static resolve(e,n){if(!(n>=0&&n<=e.content.size))throw new RangeError("Position "+n+" out of range");let r=[],i=0,o=n;for(let s=e;;){let{index:a,offset:l}=s.content.findIndex(o),c=o-l;if(r.push(s,a,i+l),!c||(s=s.child(a),s.isText))break;o=c-1,i+=l+1}return new eu(n,r,o)}static resolveCached(e,n){let r=Tb.get(e);if(r)for(let o=0;o<r.elts.length;o++){let s=r.elts[o];if(s.pos==n)return s}else Tb.set(e,r=new sL);let i=r.elts[r.i]=eu.resolve(e,n);return r.i=(r.i+1)%aL,i}}class sL{constructor(){this.elts=[],this.i=0}}const aL=12,Tb=new WeakMap;class Jf{constructor(e,n,r){this.$from=e,this.$to=n,this.depth=r}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const lL=Object.create(null);let vo=class ky{constructor(e,n,r,i=Re.none){this.type=e,this.attrs=n,this.marks=i,this.content=r||B.empty}get children(){return this.content.content}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,n,r,i=0){this.content.nodesBetween(e,n,r,i,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,n,r,i){return this.content.textBetween(e,n,r,i)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,n,r){return this.type==e&&Kf(this.attrs,n||e.defaultAttrs||lL)&&Re.sameSet(this.marks,r||Re.none)}copy(e=null){return e==this.content?this:new ky(this.type,this.attrs,e,this.marks)}mark(e){return e==this.marks?this:new ky(this.type,this.attrs,this.content,e)}cut(e,n=this.content.size){return e==0&&n==this.content.size?this:this.copy(this.content.cut(e,n))}slice(e,n=this.content.size,r=!1){if(e==n)return W.empty;let i=this.resolve(e),o=this.resolve(n),s=r?0:i.sharedDepth(n),a=i.start(s),c=i.node(s).content.cut(i.pos-a,o.pos-a);return new W(c,i.depth-s,o.depth-s)}replace(e,n,r){return iL(this.resolve(e),this.resolve(n),r)}nodeAt(e){for(let n=this;;){let{index:r,offset:i}=n.content.findIndex(e);if(n=n.maybeChild(r),!n)return null;if(i==e||n.isText)return n;e-=i+1}}childAfter(e){let{index:n,offset:r}=this.content.findIndex(e);return{node:this.content.maybeChild(n),index:n,offset:r}}childBefore(e){if(e==0)return{node:null,index:0,offset:0};let{index:n,offset:r}=this.content.findIndex(e);if(r<e)return{node:this.content.child(n),index:n,offset:r};let i=this.content.child(n-1);return{node:i,index:n-1,offset:r-i.nodeSize}}resolve(e){return eu.resolveCached(this,e)}resolveNoCache(e){return eu.resolve(this,e)}rangeHasMark(e,n,r){let i=!1;return n>e&&this.nodesBetween(e,n,o=>(r.isInSet(o.marks)&&(i=!0),!i)),i}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),mT(this.marks,e)}contentMatchAt(e){let n=this.type.contentMatch.matchFragment(this.content,0,e);if(!n)throw new Error("Called contentMatchAt on a node with invalid content");return n}canReplace(e,n,r=B.empty,i=0,o=r.childCount){let s=this.contentMatchAt(e).matchFragment(r,i,o),a=s&&s.matchFragment(this.content,n);if(!a||!a.validEnd)return!1;for(let l=i;l<o;l++)if(!this.type.allowsMarks(r.child(l).marks))return!1;return!0}canReplaceWith(e,n,r,i){if(i&&!this.type.allowsMarks(i))return!1;let o=this.contentMatchAt(e).matchType(r),s=o&&o.matchFragment(this.content,n);return s?s.validEnd:!1}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let e=Re.none;for(let n=0;n<this.marks.length;n++){let r=this.marks[n];r.type.checkAttrs(r.attrs),e=r.addToSet(e)}if(!Re.sameSet(e,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(n=>n.type.name)}`);this.content.forEach(n=>n.check())}toJSON(){let e={type:this.type.name};for(let n in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map(n=>n.toJSON())),e}static fromJSON(e,n){if(!n)throw new RangeError("Invalid input for Node.fromJSON");let r;if(n.marks){if(!Array.isArray(n.marks))throw new RangeError("Invalid mark data for Node.fromJSON");r=n.marks.map(e.markFromJSON)}if(n.type=="text"){if(typeof n.text!="string")throw new RangeError("Invalid text node in JSON");return e.text(n.text,r)}let i=B.fromJSON(e,n.content),o=e.nodeType(n.type).create(n.attrs,i,r);return o.type.checkAttrs(o.attrs),o}};vo.prototype.text=void 0;class Yf extends vo{constructor(e,n,r,i){if(super(e,n,null,i),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):mT(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(e,n){return this.text.slice(e,n)}get nodeSize(){return this.text.length}mark(e){return e==this.marks?this:new Yf(this.type,this.attrs,this.text,e)}withText(e){return e==this.text?this:new Yf(this.type,this.attrs,e,this.marks)}cut(e=0,n=this.text.length){return e==0&&n==this.text.length?this:this.withText(this.text.slice(e,n))}eq(e){return this.sameMarkup(e)&&this.text==e.text}toJSON(){let e=super.toJSON();return e.text=this.text,e}}function mT(t,e){for(let n=t.length-1;n>=0;n--)e=t[n].type.name+"("+e+")";return e}class Is{constructor(e){this.validEnd=e,this.next=[],this.wrapCache=[]}static parse(e,n){let r=new cL(e,n);if(r.next==null)return Is.empty;let i=gT(r);r.next&&r.err("Unexpected trailing text");let o=gL(mL(i));return yL(o,r),o}matchType(e){for(let n=0;n<this.next.length;n++)if(this.next[n].type==e)return this.next[n].next;return null}matchFragment(e,n=0,r=e.childCount){let i=this;for(let o=n;i&&o<r;o++)i=i.matchType(e.child(o).type);return i}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let e=0;e<this.next.length;e++){let{type:n}=this.next[e];if(!(n.isText||n.hasRequiredAttrs()))return n}return null}compatible(e){for(let n=0;n<this.next.length;n++)for(let r=0;r<e.next.length;r++)if(this.next[n].type==e.next[r].type)return!0;return!1}fillBefore(e,n=!1,r=0){let i=[this];function o(s,a){let l=s.matchFragment(e,r);if(l&&(!n||l.validEnd))return B.from(a.map(c=>c.createAndFill()));for(let c=0;c<s.next.length;c++){let{type:u,next:d}=s.next[c];if(!(u.isText||u.hasRequiredAttrs())&&i.indexOf(d)==-1){i.push(d);let h=o(d,a.concat(u));if(h)return h}}return null}return o(this,[])}findWrapping(e){for(let r=0;r<this.wrapCache.length;r+=2)if(this.wrapCache[r]==e)return this.wrapCache[r+1];let n=this.computeWrapping(e);return this.wrapCache.push(e,n),n}computeWrapping(e){let n=Object.create(null),r=[{match:this,type:null,via:null}];for(;r.length;){let i=r.shift(),o=i.match;if(o.matchType(e)){let s=[];for(let a=i;a.type;a=a.via)s.push(a.type);return s.reverse()}for(let s=0;s<o.next.length;s++){let{type:a,next:l}=o.next[s];!a.isLeaf&&!a.hasRequiredAttrs()&&!(a.name in n)&&(!i.type||l.validEnd)&&(r.push({match:a.contentMatch,type:a,via:i}),n[a.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(e){if(e>=this.next.length)throw new RangeError(`There's no ${e}th edge in this content match`);return this.next[e]}toString(){let e=[];function n(r){e.push(r);for(let i=0;i<r.next.length;i++)e.indexOf(r.next[i].next)==-1&&n(r.next[i].next)}return n(this),e.map((r,i)=>{let o=i+(r.validEnd?"*":" ")+" ";for(let s=0;s<r.next.length;s++)o+=(s?", ":"")+r.next[s].type.name+"->"+e.indexOf(r.next[s].next);return o}).join(`
`)}}Is.empty=new Is(!0);class cL{constructor(e,n){this.string=e,this.nodeTypes=n,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")}}function gT(t){let e=[];do e.push(uL(t));while(t.eat("|"));return e.length==1?e[0]:{type:"choice",exprs:e}}function uL(t){let e=[];do e.push(dL(t));while(t.next&&t.next!=")"&&t.next!="|");return e.length==1?e[0]:{type:"seq",exprs:e}}function dL(t){let e=pL(t);for(;;)if(t.eat("+"))e={type:"plus",expr:e};else if(t.eat("*"))e={type:"star",expr:e};else if(t.eat("?"))e={type:"opt",expr:e};else if(t.eat("{"))e=fL(t,e);else break;return e}function _b(t){/\D/.test(t.next)&&t.err("Expected number, got '"+t.next+"'");let e=Number(t.next);return t.pos++,e}function fL(t,e){let n=_b(t),r=n;return t.eat(",")&&(t.next!="}"?r=_b(t):r=-1),t.eat("}")||t.err("Unclosed braced range"),{type:"range",min:n,max:r,expr:e}}function hL(t,e){let n=t.nodeTypes,r=n[e];if(r)return[r];let i=[];for(let o in n){let s=n[o];s.isInGroup(e)&&i.push(s)}return i.length==0&&t.err("No node type or group '"+e+"' found"),i}function pL(t){if(t.eat("(")){let e=gT(t);return t.eat(")")||t.err("Missing closing paren"),e}else if(/\W/.test(t.next))t.err("Unexpected token '"+t.next+"'");else{let e=hL(t,t.next).map(n=>(t.inline==null?t.inline=n.isInline:t.inline!=n.isInline&&t.err("Mixing inline and block content"),{type:"name",value:n}));return t.pos++,e.length==1?e[0]:{type:"choice",exprs:e}}}function mL(t){let e=[[]];return i(o(t,0),n()),e;function n(){return e.push([])-1}function r(s,a,l){let c={term:l,to:a};return e[s].push(c),c}function i(s,a){s.forEach(l=>l.to=a)}function o(s,a){if(s.type=="choice")return s.exprs.reduce((l,c)=>l.concat(o(c,a)),[]);if(s.type=="seq")for(let l=0;;l++){let c=o(s.exprs[l],a);if(l==s.exprs.length-1)return c;i(c,a=n())}else if(s.type=="star"){let l=n();return r(a,l),i(o(s.expr,l),l),[r(l)]}else if(s.type=="plus"){let l=n();return i(o(s.expr,a),l),i(o(s.expr,l),l),[r(l)]}else{if(s.type=="opt")return[r(a)].concat(o(s.expr,a));if(s.type=="range"){let l=a;for(let c=0;c<s.min;c++){let u=n();i(o(s.expr,l),u),l=u}if(s.max==-1)i(o(s.expr,l),l);else for(let c=s.min;c<s.max;c++){let u=n();r(l,u),i(o(s.expr,l),u),l=u}return[r(l)]}else{if(s.type=="name")return[r(a,void 0,s.value)];throw new Error("Unknown expr type")}}}}function yT(t,e){return e-t}function Rb(t,e){let n=[];return r(e),n.sort(yT);function r(i){let o=t[i];if(o.length==1&&!o[0].term)return r(o[0].to);n.push(i);for(let s=0;s<o.length;s++){let{term:a,to:l}=o[s];!a&&n.indexOf(l)==-1&&r(l)}}}function gL(t){let e=Object.create(null);return n(Rb(t,0));function n(r){let i=[];r.forEach(s=>{t[s].forEach(({term:a,to:l})=>{if(!a)return;let c;for(let u=0;u<i.length;u++)i[u][0]==a&&(c=i[u][1]);Rb(t,l).forEach(u=>{c||i.push([a,c=[]]),c.indexOf(u)==-1&&c.push(u)})})});let o=e[r.join(",")]=new Is(r.indexOf(t.length-1)>-1);for(let s=0;s<i.length;s++){let a=i[s][1].sort(yT);o.next.push({type:i[s][0],next:e[a.join(",")]||n(a)})}return o}}function yL(t,e){for(let n=0,r=[t];n<r.length;n++){let i=r[n],o=!i.validEnd,s=[];for(let a=0;a<i.next.length;a++){let{type:l,next:c}=i.next[a];s.push(l.name),o&&!(l.isText||l.hasRequiredAttrs())&&(o=!1),r.indexOf(c)==-1&&r.push(c)}o&&e.err("Only non-generatable nodes ("+s.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function vT(t){let e=Object.create(null);for(let n in t){let r=t[n];if(!r.hasDefault)return null;e[n]=r.default}return e}function xT(t,e){let n=Object.create(null);for(let r in t){let i=e&&e[r];if(i===void 0){let o=t[r];if(o.hasDefault)i=o.default;else throw new RangeError("No value supplied for attribute "+r)}n[r]=i}return n}function wT(t,e,n,r){for(let i in e)if(!(i in t))throw new RangeError(`Unsupported attribute ${i} for ${n} of type ${i}`);for(let i in t){let o=t[i];o.validate&&o.validate(e[i])}}function bT(t,e){let n=Object.create(null);if(e)for(let r in e)n[r]=new xL(t,r,e[r]);return n}let Ob=class ST{constructor(e,n,r){this.name=e,this.schema=n,this.spec=r,this.markSet=null,this.groups=r.group?r.group.split(" "):[],this.attrs=bT(e,r.attrs),this.defaultAttrs=vT(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(r.inline||e=="text"),this.isText=e=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==Is.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(e){return this.groups.indexOf(e)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}compatibleContent(e){return this==e||this.contentMatch.compatible(e.contentMatch)}computeAttrs(e){return!e&&this.defaultAttrs?this.defaultAttrs:xT(this.attrs,e)}create(e=null,n,r){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new vo(this,this.computeAttrs(e),B.from(n),Re.setFrom(r))}createChecked(e=null,n,r){return n=B.from(n),this.checkContent(n),new vo(this,this.computeAttrs(e),n,Re.setFrom(r))}createAndFill(e=null,n,r){if(e=this.computeAttrs(e),n=B.from(n),n.size){let s=this.contentMatch.fillBefore(n);if(!s)return null;n=s.append(n)}let i=this.contentMatch.matchFragment(n),o=i&&i.fillBefore(B.empty,!0);return o?new vo(this,e,n.append(o),Re.setFrom(r)):null}validContent(e){let n=this.contentMatch.matchFragment(e);if(!n||!n.validEnd)return!1;for(let r=0;r<e.childCount;r++)if(!this.allowsMarks(e.child(r).marks))return!1;return!0}checkContent(e){if(!this.validContent(e))throw new RangeError(`Invalid content for node ${this.name}: ${e.toString().slice(0,50)}`)}checkAttrs(e){wT(this.attrs,e,"node",this.name)}allowsMarkType(e){return this.markSet==null||this.markSet.indexOf(e)>-1}allowsMarks(e){if(this.markSet==null)return!0;for(let n=0;n<e.length;n++)if(!this.allowsMarkType(e[n].type))return!1;return!0}allowedMarks(e){if(this.markSet==null)return e;let n;for(let r=0;r<e.length;r++)this.allowsMarkType(e[r].type)?n&&n.push(e[r]):n||(n=e.slice(0,r));return n?n.length?n:Re.none:e}static compile(e,n){let r=Object.create(null);e.forEach((o,s)=>r[o]=new ST(o,n,s));let i=n.spec.topNode||"doc";if(!r[i])throw new RangeError("Schema is missing its top node type ('"+i+"')");if(!r.text)throw new RangeError("Every schema needs a 'text' type");for(let o in r.text.attrs)throw new RangeError("The text node type should not have attributes");return r}};function vL(t,e,n){let r=n.split("|");return i=>{let o=i===null?"null":typeof i;if(r.indexOf(o)<0)throw new RangeError(`Expected value of type ${r} for attribute ${e} on type ${t}, got ${o}`)}}class xL{constructor(e,n,r){this.hasDefault=Object.prototype.hasOwnProperty.call(r,"default"),this.default=r.default,this.validate=typeof r.validate=="string"?vL(e,n,r.validate):r.validate}get isRequired(){return!this.hasDefault}}class Gh{constructor(e,n,r,i){this.name=e,this.rank=n,this.schema=r,this.spec=i,this.attrs=bT(e,i.attrs),this.excluded=null;let o=vT(this.attrs);this.instance=o?new Re(this,o):null}create(e=null){return!e&&this.instance?this.instance:new Re(this,xT(this.attrs,e))}static compile(e,n){let r=Object.create(null),i=0;return e.forEach((o,s)=>r[o]=new Gh(o,i++,n,s)),r}removeFromSet(e){for(var n=0;n<e.length;n++)e[n].type==this&&(e=e.slice(0,n).concat(e.slice(n+1)),n--);return e}isInSet(e){for(let n=0;n<e.length;n++)if(e[n].type==this)return e[n]}checkAttrs(e){wT(this.attrs,e,"mark",this.name)}excludes(e){return this.excluded.indexOf(e)>-1}}class CT{constructor(e){this.linebreakReplacement=null,this.cached=Object.create(null);let n=this.spec={};for(let i in e)n[i]=e[i];n.nodes=pt.from(e.nodes),n.marks=pt.from(e.marks||{}),this.nodes=Ob.compile(this.spec.nodes,this),this.marks=Gh.compile(this.spec.marks,this);let r=Object.create(null);for(let i in this.nodes){if(i in this.marks)throw new RangeError(i+" can not be both a node and a mark");let o=this.nodes[i],s=o.spec.content||"",a=o.spec.marks;if(o.contentMatch=r[s]||(r[s]=Is.parse(s,this.nodes)),o.inlineContent=o.contentMatch.inlineContent,o.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!o.isInline||!o.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=o}o.markSet=a=="_"?null:a?Pb(this,a.split(" ")):a==""||!o.inlineContent?[]:null}for(let i in this.marks){let o=this.marks[i],s=o.spec.excludes;o.excluded=s==null?[o]:s==""?[]:Pb(this,s.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(e,n=null,r,i){if(typeof e=="string")e=this.nodeType(e);else if(e instanceof Ob){if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}else throw new RangeError("Invalid node type: "+e);return e.createChecked(n,r,i)}text(e,n){let r=this.nodes.text;return new Yf(r,r.defaultAttrs,e,Re.setFrom(n))}mark(e,n){return typeof e=="string"&&(e=this.marks[e]),e.create(n)}nodeFromJSON(e){return vo.fromJSON(this,e)}markFromJSON(e){return Re.fromJSON(this,e)}nodeType(e){let n=this.nodes[e];if(!n)throw new RangeError("Unknown node type: "+e);return n}}function Pb(t,e){let n=[];for(let r=0;r<e.length;r++){let i=e[r],o=t.marks[i],s=o;if(o)n.push(o);else for(let a in t.marks){let l=t.marks[a];(i=="_"||l.spec.group&&l.spec.group.split(" ").indexOf(i)>-1)&&n.push(s=l)}if(!s)throw new SyntaxError("Unknown mark type: '"+e[r]+"'")}return n}function wL(t){return t.tag!=null}function bL(t){return t.style!=null}class xo{constructor(e,n){this.schema=e,this.rules=n,this.tags=[],this.styles=[];let r=this.matchedStyles=[];n.forEach(i=>{if(wL(i))this.tags.push(i);else if(bL(i)){let o=/[^=]*/.exec(i.style)[0];r.indexOf(o)<0&&r.push(o),this.styles.push(i)}}),this.normalizeLists=!this.tags.some(i=>{if(!/^(ul|ol)\b/.test(i.tag)||!i.node)return!1;let o=e.nodes[i.node];return o.contentMatch.matchType(o)})}parse(e,n={}){let r=new Ib(this,n,!1);return r.addAll(e,Re.none,n.from,n.to),r.finish()}parseSlice(e,n={}){let r=new Ib(this,n,!0);return r.addAll(e,Re.none,n.from,n.to),W.maxOpen(r.finish())}matchTag(e,n,r){for(let i=r?this.tags.indexOf(r)+1:0;i<this.tags.length;i++){let o=this.tags[i];if(kL(e,o.tag)&&(o.namespace===void 0||e.namespaceURI==o.namespace)&&(!o.context||n.matchesContext(o.context))){if(o.getAttrs){let s=o.getAttrs(e);if(s===!1)continue;o.attrs=s||void 0}return o}}}matchStyle(e,n,r,i){for(let o=i?this.styles.indexOf(i)+1:0;o<this.styles.length;o++){let s=this.styles[o],a=s.style;if(!(a.indexOf(e)!=0||s.context&&!r.matchesContext(s.context)||a.length>e.length&&(a.charCodeAt(e.length)!=61||a.slice(e.length+1)!=n))){if(s.getAttrs){let l=s.getAttrs(n);if(l===!1)continue;s.attrs=l||void 0}return s}}}static schemaRules(e){let n=[];function r(i){let o=i.priority==null?50:i.priority,s=0;for(;s<n.length;s++){let a=n[s];if((a.priority==null?50:a.priority)<o)break}n.splice(s,0,i)}for(let i in e.marks){let o=e.marks[i].spec.parseDOM;o&&o.forEach(s=>{r(s=Ab(s)),s.mark||s.ignore||s.clearMark||(s.mark=i)})}for(let i in e.nodes){let o=e.nodes[i].spec.parseDOM;o&&o.forEach(s=>{r(s=Ab(s)),s.node||s.ignore||s.mark||(s.node=i)})}return n}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new xo(e,xo.schemaRules(e)))}}const kT={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},SL={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},ET={ol:!0,ul:!0},tu=1,Ey=2,_c=4;function Mb(t,e,n){return e!=null?(e?tu:0)|(e==="full"?Ey:0):t&&t.whitespace=="pre"?tu|Ey:n&~_c}class Rd{constructor(e,n,r,i,o,s){this.type=e,this.attrs=n,this.marks=r,this.solid=i,this.options=s,this.content=[],this.activeMarks=Re.none,this.match=o||(s&_c?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let n=this.type.contentMatch.fillBefore(B.from(e));if(n)this.match=this.type.contentMatch.matchFragment(n);else{let r=this.type.contentMatch,i;return(i=r.findWrapping(e.type))?(this.match=r,i):null}}return this.match.findWrapping(e.type)}finish(e){if(!(this.options&tu)){let r=this.content[this.content.length-1],i;if(r&&r.isText&&(i=/[ \t\r\n\u000c]+$/.exec(r.text))){let o=r;r.text.length==i[0].length?this.content.pop():this.content[this.content.length-1]=o.withText(o.text.slice(0,o.text.length-i[0].length))}}let n=B.from(this.content);return!e&&this.match&&(n=n.append(this.match.fillBefore(B.empty,!0))),this.type?this.type.create(this.attrs,n,this.marks):n}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!kT.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}class Ib{constructor(e,n,r){this.parser=e,this.options=n,this.isOpen=r,this.open=0,this.localPreserveWS=!1;let i=n.topNode,o,s=Mb(null,n.preserveWhitespace,0)|(r?_c:0);i?o=new Rd(i.type,i.attrs,Re.none,!0,n.topMatch||i.type.contentMatch,s):r?o=new Rd(null,null,Re.none,!0,null,s):o=new Rd(e.schema.topNodeType,null,Re.none,!0,null,s),this.nodes=[o],this.find=n.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e,n){e.nodeType==3?this.addTextNode(e,n):e.nodeType==1&&this.addElement(e,n)}addTextNode(e,n){let r=e.nodeValue,i=this.top,o=i.options&Ey?"full":this.localPreserveWS||(i.options&tu)>0;if(o==="full"||i.inlineContext(e)||/[^ \t\r\n\u000c]/.test(r)){if(o)o!=="full"?r=r.replace(/\r?\n|\r/g," "):r=r.replace(/\r\n?/g,`
`);else if(r=r.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(r)&&this.open==this.nodes.length-1){let s=i.content[i.content.length-1],a=e.previousSibling;(!s||a&&a.nodeName=="BR"||s.isText&&/[ \t\r\n\u000c]$/.test(s.text))&&(r=r.slice(1))}r&&this.insertNode(this.parser.schema.text(r),n),this.findInText(e)}else this.findInside(e)}addElement(e,n,r){let i=this.localPreserveWS,o=this.top;(e.tagName=="PRE"||/pre/.test(e.style&&e.style.whiteSpace))&&(this.localPreserveWS=!0);let s=e.nodeName.toLowerCase(),a;ET.hasOwnProperty(s)&&this.parser.normalizeLists&&CL(e);let l=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(a=this.parser.matchTag(e,this,r));e:if(l?l.ignore:SL.hasOwnProperty(s))this.findInside(e),this.ignoreFallback(e,n);else if(!l||l.skip||l.closeParent){l&&l.closeParent?this.open=Math.max(0,this.open-1):l&&l.skip.nodeType&&(e=l.skip);let c,u=this.needsBlock;if(kT.hasOwnProperty(s))o.content.length&&o.content[0].isInline&&this.open&&(this.open--,o=this.top),c=!0,o.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e,n);break e}let d=l&&l.skip?n:this.readStyles(e,n);d&&this.addAll(e,d),c&&this.sync(o),this.needsBlock=u}else{let c=this.readStyles(e,n);c&&this.addElementByRule(e,l,c,l.consuming===!1?a:void 0)}this.localPreserveWS=i}leafFallback(e,n){e.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode(`
`),n)}ignoreFallback(e,n){e.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"),n)}readStyles(e,n){let r=e.style;if(r&&r.length)for(let i=0;i<this.parser.matchedStyles.length;i++){let o=this.parser.matchedStyles[i],s=r.getPropertyValue(o);if(s)for(let a=void 0;;){let l=this.parser.matchStyle(o,s,this,a);if(!l)break;if(l.ignore)return null;if(l.clearMark?n=n.filter(c=>!l.clearMark(c)):n=n.concat(this.parser.schema.marks[l.mark].create(l.attrs)),l.consuming===!1)a=l;else break}}return n}addElementByRule(e,n,r,i){let o,s;if(n.node)if(s=this.parser.schema.nodes[n.node],s.isLeaf)this.insertNode(s.create(n.attrs),r)||this.leafFallback(e,r);else{let l=this.enter(s,n.attrs||null,r,n.preserveWhitespace);l&&(o=!0,r=l)}else{let l=this.parser.schema.marks[n.mark];r=r.concat(l.create(n.attrs))}let a=this.top;if(s&&s.isLeaf)this.findInside(e);else if(i)this.addElement(e,r,i);else if(n.getContent)this.findInside(e),n.getContent(e,this.parser.schema).forEach(l=>this.insertNode(l,r));else{let l=e;typeof n.contentElement=="string"?l=e.querySelector(n.contentElement):typeof n.contentElement=="function"?l=n.contentElement(e):n.contentElement&&(l=n.contentElement),this.findAround(e,l,!0),this.addAll(l,r),this.findAround(e,l,!1)}o&&this.sync(a)&&this.open--}addAll(e,n,r,i){let o=r||0;for(let s=r?e.childNodes[r]:e.firstChild,a=i==null?null:e.childNodes[i];s!=a;s=s.nextSibling,++o)this.findAtPoint(e,o),this.addDOM(s,n);this.findAtPoint(e,o)}findPlace(e,n){let r,i;for(let o=this.open;o>=0;o--){let s=this.nodes[o],a=s.findWrapping(e);if(a&&(!r||r.length>a.length)&&(r=a,i=s,!a.length)||s.solid)break}if(!r)return null;this.sync(i);for(let o=0;o<r.length;o++)n=this.enterInner(r[o],null,n,!1);return n}insertNode(e,n){if(e.isInline&&this.needsBlock&&!this.top.type){let i=this.textblockFromContext();i&&(n=this.enterInner(i,null,n))}let r=this.findPlace(e,n);if(r){this.closeExtra();let i=this.top;i.match&&(i.match=i.match.matchType(e.type));let o=Re.none;for(let s of r.concat(e.marks))(i.type?i.type.allowsMarkType(s.type):Nb(s.type,e.type))&&(o=s.addToSet(o));return i.content.push(e.mark(o)),!0}return!1}enter(e,n,r,i){let o=this.findPlace(e.create(n),r);return o&&(o=this.enterInner(e,n,r,!0,i)),o}enterInner(e,n,r,i=!1,o){this.closeExtra();let s=this.top;s.match=s.match&&s.match.matchType(e);let a=Mb(e,o,s.options);s.options&_c&&s.content.length==0&&(a|=_c);let l=Re.none;return r=r.filter(c=>(s.type?s.type.allowsMarkType(c.type):Nb(c.type,e))?(l=c.addToSet(l),!1):!0),this.nodes.push(new Rd(e,n,l,i,null,a)),this.open++,r}closeExtra(e=!1){let n=this.nodes.length-1;if(n>this.open){for(;n>this.open;n--)this.nodes[n-1].content.push(this.nodes[n].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!!(this.isOpen||this.options.topOpen))}sync(e){for(let n=this.open;n>=0;n--){if(this.nodes[n]==e)return this.open=n,!0;this.localPreserveWS&&(this.nodes[n].options|=tu)}return!1}get currentPos(){this.closeExtra();let e=0;for(let n=this.open;n>=0;n--){let r=this.nodes[n].content;for(let i=r.length-1;i>=0;i--)e+=r[i].nodeSize;n&&e++}return e}findAtPoint(e,n){if(this.find)for(let r=0;r<this.find.length;r++)this.find[r].node==e&&this.find[r].offset==n&&(this.find[r].pos=this.currentPos)}findInside(e){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].pos==null&&e.nodeType==1&&e.contains(this.find[n].node)&&(this.find[n].pos=this.currentPos)}findAround(e,n,r){if(e!=n&&this.find)for(let i=0;i<this.find.length;i++)this.find[i].pos==null&&e.nodeType==1&&e.contains(this.find[i].node)&&n.compareDocumentPosition(this.find[i].node)&(r?2:4)&&(this.find[i].pos=this.currentPos)}findInText(e){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].node==e&&(this.find[n].pos=this.currentPos-(e.nodeValue.length-this.find[n].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let n=e.split("/"),r=this.options.context,i=!this.isOpen&&(!r||r.parent.type==this.nodes[0].type),o=-(r?r.depth+1:0)+(i?0:1),s=(a,l)=>{for(;a>=0;a--){let c=n[a];if(c==""){if(a==n.length-1||a==0)continue;for(;l>=o;l--)if(s(a-1,l))return!0;return!1}else{let u=l>0||l==0&&i?this.nodes[l].type:r&&l>=o?r.node(l-o).type:null;if(!u||u.name!=c&&!u.isInGroup(c))return!1;l--}}return!0};return s(n.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let n=e.depth;n>=0;n--){let r=e.node(n).contentMatchAt(e.indexAfter(n)).defaultType;if(r&&r.isTextblock&&r.defaultAttrs)return r}for(let n in this.parser.schema.nodes){let r=this.parser.schema.nodes[n];if(r.isTextblock&&r.defaultAttrs)return r}}}function CL(t){for(let e=t.firstChild,n=null;e;e=e.nextSibling){let r=e.nodeType==1?e.nodeName.toLowerCase():null;r&&ET.hasOwnProperty(r)&&n?(n.appendChild(e),e=n):r=="li"?n=e:r&&(n=null)}}function kL(t,e){return(t.matches||t.msMatchesSelector||t.webkitMatchesSelector||t.mozMatchesSelector).call(t,e)}function Ab(t){let e={};for(let n in t)e[n]=t[n];return e}function Nb(t,e){let n=e.schema.nodes;for(let r in n){let i=n[r];if(!i.allowsMarkType(t))continue;let o=[],s=a=>{o.push(a);for(let l=0;l<a.edgeCount;l++){let{type:c,next:u}=a.edge(l);if(c==e||o.indexOf(u)<0&&s(u))return!0}};if(s(i.contentMatch))return!0}}class Ws{constructor(e,n){this.nodes=e,this.marks=n}serializeFragment(e,n={},r){r||(r=gm(n).createDocumentFragment());let i=r,o=[];return e.forEach(s=>{if(o.length||s.marks.length){let a=0,l=0;for(;a<o.length&&l<s.marks.length;){let c=s.marks[l];if(!this.marks[c.type.name]){l++;continue}if(!c.eq(o[a][0])||c.type.spec.spanning===!1)break;a++,l++}for(;a<o.length;)i=o.pop()[1];for(;l<s.marks.length;){let c=s.marks[l++],u=this.serializeMark(c,s.isInline,n);u&&(o.push([c,i]),i.appendChild(u.dom),i=u.contentDOM||u.dom)}}i.appendChild(this.serializeNodeInner(s,n))}),r}serializeNodeInner(e,n){let{dom:r,contentDOM:i}=cf(gm(n),this.nodes[e.type.name](e),null,e.attrs);if(i){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(e.content,n,i)}return r}serializeNode(e,n={}){let r=this.serializeNodeInner(e,n);for(let i=e.marks.length-1;i>=0;i--){let o=this.serializeMark(e.marks[i],e.isInline,n);o&&((o.contentDOM||o.dom).appendChild(r),r=o.dom)}return r}serializeMark(e,n,r={}){let i=this.marks[e.type.name];return i&&cf(gm(r),i(e,n),null,e.attrs)}static renderSpec(e,n,r=null,i){return cf(e,n,r,i)}static fromSchema(e){return e.cached.domSerializer||(e.cached.domSerializer=new Ws(this.nodesFromSchema(e),this.marksFromSchema(e)))}static nodesFromSchema(e){let n=Db(e.nodes);return n.text||(n.text=r=>r.text),n}static marksFromSchema(e){return Db(e.marks)}}function Db(t){let e={};for(let n in t){let r=t[n].spec.toDOM;r&&(e[n]=r)}return e}function gm(t){return t.document||window.document}const jb=new WeakMap;function EL(t){let e=jb.get(t);return e===void 0&&jb.set(t,e=TL(t)),e}function TL(t){let e=null;function n(r){if(r&&typeof r=="object")if(Array.isArray(r))if(typeof r[0]=="string")e||(e=[]),e.push(r);else for(let i=0;i<r.length;i++)n(r[i]);else for(let i in r)n(r[i])}return n(t),e}function cf(t,e,n,r){if(typeof e=="string")return{dom:t.createTextNode(e)};if(e.nodeType!=null)return{dom:e};if(e.dom&&e.dom.nodeType!=null)return e;let i=e[0],o;if(typeof i!="string")throw new RangeError("Invalid array passed to renderSpec");if(r&&(o=EL(r))&&o.indexOf(e)>-1)throw new RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let s=i.indexOf(" ");s>0&&(n=i.slice(0,s),i=i.slice(s+1));let a,l=n?t.createElementNS(n,i):t.createElement(i),c=e[1],u=1;if(c&&typeof c=="object"&&c.nodeType==null&&!Array.isArray(c)){u=2;for(let d in c)if(c[d]!=null){let h=d.indexOf(" ");h>0?l.setAttributeNS(d.slice(0,h),d.slice(h+1),c[d]):l.setAttribute(d,c[d])}}for(let d=u;d<e.length;d++){let h=e[d];if(h===0){if(d<e.length-1||d>u)throw new RangeError("Content hole must be the only child of its parent node");return{dom:l,contentDOM:l}}else{let{dom:p,contentDOM:m}=cf(t,h,n,r);if(l.appendChild(p),m){if(a)throw new RangeError("Multiple content holes");a=m}}}return{dom:l,contentDOM:a}}const TT=65535,_T=Math.pow(2,16);function _L(t,e){return t+e*_T}function Lb(t){return t&TT}function RL(t){return(t-(t&TT))/_T}const RT=1,OT=2,uf=4,PT=8;class Ty{constructor(e,n,r){this.pos=e,this.delInfo=n,this.recover=r}get deleted(){return(this.delInfo&PT)>0}get deletedBefore(){return(this.delInfo&(RT|uf))>0}get deletedAfter(){return(this.delInfo&(OT|uf))>0}get deletedAcross(){return(this.delInfo&uf)>0}}class wn{constructor(e,n=!1){if(this.ranges=e,this.inverted=n,!e.length&&wn.empty)return wn.empty}recover(e){let n=0,r=Lb(e);if(!this.inverted)for(let i=0;i<r;i++)n+=this.ranges[i*3+2]-this.ranges[i*3+1];return this.ranges[r*3]+n+RL(e)}mapResult(e,n=1){return this._map(e,n,!1)}map(e,n=1){return this._map(e,n,!0)}_map(e,n,r){let i=0,o=this.inverted?2:1,s=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let l=this.ranges[a]-(this.inverted?i:0);if(l>e)break;let c=this.ranges[a+o],u=this.ranges[a+s],d=l+c;if(e<=d){let h=c?e==l?-1:e==d?1:n:n,p=l+i+(h<0?0:u);if(r)return p;let m=e==(n<0?l:d)?null:_L(a/3,e-l),y=e==l?OT:e==d?RT:uf;return(n<0?e!=l:e!=d)&&(y|=PT),new Ty(p,y,m)}i+=u-c}return r?e+i:new Ty(e+i,0,null)}touches(e,n){let r=0,i=Lb(n),o=this.inverted?2:1,s=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let l=this.ranges[a]-(this.inverted?r:0);if(l>e)break;let c=this.ranges[a+o],u=l+c;if(e<=u&&a==i*3)return!0;r+=this.ranges[a+s]-c}return!1}forEach(e){let n=this.inverted?2:1,r=this.inverted?1:2;for(let i=0,o=0;i<this.ranges.length;i+=3){let s=this.ranges[i],a=s-(this.inverted?o:0),l=s+(this.inverted?0:o),c=this.ranges[i+n],u=this.ranges[i+r];e(a,a+c,l,l+u),o+=u-c}}invert(){return new wn(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?wn.empty:new wn(e<0?[0,-e,0]:[0,0,e])}}wn.empty=new wn([]);class nu{constructor(e,n,r=0,i=e?e.length:0){this.mirror=n,this.from=r,this.to=i,this._maps=e||[],this.ownData=!(e||n)}get maps(){return this._maps}slice(e=0,n=this.maps.length){return new nu(this._maps,this.mirror,e,n)}appendMap(e,n){this.ownData||(this._maps=this._maps.slice(),this.mirror=this.mirror&&this.mirror.slice(),this.ownData=!0),this.to=this._maps.push(e),n!=null&&this.setMirror(this._maps.length-1,n)}appendMapping(e){for(let n=0,r=this._maps.length;n<e._maps.length;n++){let i=e.getMirror(n);this.appendMap(e._maps[n],i!=null&&i<n?r+i:void 0)}}getMirror(e){if(this.mirror){for(let n=0;n<this.mirror.length;n++)if(this.mirror[n]==e)return this.mirror[n+(n%2?-1:1)]}}setMirror(e,n){this.mirror||(this.mirror=[]),this.mirror.push(e,n)}appendMappingInverted(e){for(let n=e.maps.length-1,r=this._maps.length+e._maps.length;n>=0;n--){let i=e.getMirror(n);this.appendMap(e._maps[n].invert(),i!=null&&i>n?r-i-1:void 0)}}invert(){let e=new nu;return e.appendMappingInverted(this),e}map(e,n=1){if(this.mirror)return this._map(e,n,!0);for(let r=this.from;r<this.to;r++)e=this._maps[r].map(e,n);return e}mapResult(e,n=1){return this._map(e,n,!1)}_map(e,n,r){let i=0;for(let o=this.from;o<this.to;o++){let s=this._maps[o],a=s.mapResult(e,n);if(a.recover!=null){let l=this.getMirror(o);if(l!=null&&l>o&&l<this.to){o=l,e=this._maps[l].recover(a.recover);continue}}i|=a.delInfo,e=a.pos}return r?e:new Ty(e,i,null)}}const ym=Object.create(null);class Mt{getMap(){return wn.empty}merge(e){return null}static fromJSON(e,n){if(!n||!n.stepType)throw new RangeError("Invalid input for Step.fromJSON");let r=ym[n.stepType];if(!r)throw new RangeError(`No step type ${n.stepType} defined`);return r.fromJSON(e,n)}static jsonID(e,n){if(e in ym)throw new RangeError("Duplicate use of step JSON ID "+e);return ym[e]=n,n.prototype.jsonID=e,n}}class Xe{constructor(e,n){this.doc=e,this.failed=n}static ok(e){return new Xe(e,null)}static fail(e){return new Xe(null,e)}static fromReplace(e,n,r,i){try{return Xe.ok(e.replace(n,r,i))}catch(o){if(o instanceof qf)return Xe.fail(o.message);throw o}}}function M0(t,e,n){let r=[];for(let i=0;i<t.childCount;i++){let o=t.child(i);o.content.size&&(o=o.copy(M0(o.content,e,o))),o.isInline&&(o=e(o,n,i)),r.push(o)}return B.fromArray(r)}class oo extends Mt{constructor(e,n,r){super(),this.from=e,this.to=n,this.mark=r}apply(e){let n=e.slice(this.from,this.to),r=e.resolve(this.from),i=r.node(r.sharedDepth(this.to)),o=new W(M0(n.content,(s,a)=>!s.isAtom||!a.type.allowsMarkType(this.mark.type)?s:s.mark(this.mark.addToSet(s.marks)),i),n.openStart,n.openEnd);return Xe.fromReplace(e,this.from,this.to,o)}invert(){return new Ir(this.from,this.to,this.mark)}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deleted&&r.deleted||n.pos>=r.pos?null:new oo(n.pos,r.pos,this.mark)}merge(e){return e instanceof oo&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new oo(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new oo(n.from,n.to,e.markFromJSON(n.mark))}}Mt.jsonID("addMark",oo);class Ir extends Mt{constructor(e,n,r){super(),this.from=e,this.to=n,this.mark=r}apply(e){let n=e.slice(this.from,this.to),r=new W(M0(n.content,i=>i.mark(this.mark.removeFromSet(i.marks)),e),n.openStart,n.openEnd);return Xe.fromReplace(e,this.from,this.to,r)}invert(){return new oo(this.from,this.to,this.mark)}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deleted&&r.deleted||n.pos>=r.pos?null:new Ir(n.pos,r.pos,this.mark)}merge(e){return e instanceof Ir&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Ir(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new Ir(n.from,n.to,e.markFromJSON(n.mark))}}Mt.jsonID("removeMark",Ir);class so extends Mt{constructor(e,n){super(),this.pos=e,this.mark=n}apply(e){let n=e.nodeAt(this.pos);if(!n)return Xe.fail("No node at mark step's position");let r=n.type.create(n.attrs,null,this.mark.addToSet(n.marks));return Xe.fromReplace(e,this.pos,this.pos+1,new W(B.from(r),0,n.isLeaf?0:1))}invert(e){let n=e.nodeAt(this.pos);if(n){let r=this.mark.addToSet(n.marks);if(r.length==n.marks.length){for(let i=0;i<n.marks.length;i++)if(!n.marks[i].isInSet(r))return new so(this.pos,n.marks[i]);return new so(this.pos,this.mark)}}return new ul(this.pos,this.mark)}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new so(n.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new so(n.pos,e.markFromJSON(n.mark))}}Mt.jsonID("addNodeMark",so);class ul extends Mt{constructor(e,n){super(),this.pos=e,this.mark=n}apply(e){let n=e.nodeAt(this.pos);if(!n)return Xe.fail("No node at mark step's position");let r=n.type.create(n.attrs,null,this.mark.removeFromSet(n.marks));return Xe.fromReplace(e,this.pos,this.pos+1,new W(B.from(r),0,n.isLeaf?0:1))}invert(e){let n=e.nodeAt(this.pos);return!n||!this.mark.isInSet(n.marks)?this:new so(this.pos,this.mark)}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new ul(n.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new ul(n.pos,e.markFromJSON(n.mark))}}Mt.jsonID("removeNodeMark",ul);class st extends Mt{constructor(e,n,r,i=!1){super(),this.from=e,this.to=n,this.slice=r,this.structure=i}apply(e){return this.structure&&_y(e,this.from,this.to)?Xe.fail("Structure replace would overwrite content"):Xe.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new wn([this.from,this.to-this.from,this.slice.size])}invert(e){return new st(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deletedAcross&&r.deletedAcross?null:new st(n.pos,Math.max(n.pos,r.pos),this.slice)}merge(e){if(!(e instanceof st)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let n=this.slice.size+e.slice.size==0?W.empty:new W(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new st(this.from,this.to+(e.to-e.from),n,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let n=this.slice.size+e.slice.size==0?W.empty:new W(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new st(e.from,this.to,n,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new st(n.from,n.to,W.fromJSON(e,n.slice),!!n.structure)}}Mt.jsonID("replace",st);class lt extends Mt{constructor(e,n,r,i,o,s,a=!1){super(),this.from=e,this.to=n,this.gapFrom=r,this.gapTo=i,this.slice=o,this.insert=s,this.structure=a}apply(e){if(this.structure&&(_y(e,this.from,this.gapFrom)||_y(e,this.gapTo,this.to)))return Xe.fail("Structure gap-replace would overwrite content");let n=e.slice(this.gapFrom,this.gapTo);if(n.openStart||n.openEnd)return Xe.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,n.content);return r?Xe.fromReplace(e,this.from,this.to,r):Xe.fail("Content does not fit in gap")}getMap(){return new wn([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let n=this.gapTo-this.gapFrom;return new lt(this.from,this.from+this.slice.size+n,this.from+this.insert,this.from+this.insert+n,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1),i=this.from==this.gapFrom?n.pos:e.map(this.gapFrom,-1),o=this.to==this.gapTo?r.pos:e.map(this.gapTo,1);return n.deletedAcross&&r.deletedAcross||i<n.pos||o>r.pos?null:new lt(n.pos,r.pos,i,o,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number"||typeof n.gapFrom!="number"||typeof n.gapTo!="number"||typeof n.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new lt(n.from,n.to,n.gapFrom,n.gapTo,W.fromJSON(e,n.slice),n.insert,!!n.structure)}}Mt.jsonID("replaceAround",lt);function _y(t,e,n){let r=t.resolve(e),i=n-e,o=r.depth;for(;i>0&&o>0&&r.indexAfter(o)==r.node(o).childCount;)o--,i--;if(i>0){let s=r.node(o).maybeChild(r.indexAfter(o));for(;i>0;){if(!s||s.isLeaf)return!0;s=s.firstChild,i--}}return!1}function OL(t,e,n,r){let i=[],o=[],s,a;t.doc.nodesBetween(e,n,(l,c,u)=>{if(!l.isInline)return;let d=l.marks;if(!r.isInSet(d)&&u.type.allowsMarkType(r.type)){let h=Math.max(c,e),p=Math.min(c+l.nodeSize,n),m=r.addToSet(d);for(let y=0;y<d.length;y++)d[y].isInSet(m)||(s&&s.to==h&&s.mark.eq(d[y])?s.to=p:i.push(s=new Ir(h,p,d[y])));a&&a.to==h?a.to=p:o.push(a=new oo(h,p,r))}}),i.forEach(l=>t.step(l)),o.forEach(l=>t.step(l))}function PL(t,e,n,r){let i=[],o=0;t.doc.nodesBetween(e,n,(s,a)=>{if(!s.isInline)return;o++;let l=null;if(r instanceof Gh){let c=s.marks,u;for(;u=r.isInSet(c);)(l||(l=[])).push(u),c=u.removeFromSet(c)}else r?r.isInSet(s.marks)&&(l=[r]):l=s.marks;if(l&&l.length){let c=Math.min(a+s.nodeSize,n);for(let u=0;u<l.length;u++){let d=l[u],h;for(let p=0;p<i.length;p++){let m=i[p];m.step==o-1&&d.eq(i[p].style)&&(h=m)}h?(h.to=c,h.step=o):i.push({style:d,from:Math.max(a,e),to:c,step:o})}}}),i.forEach(s=>t.step(new Ir(s.from,s.to,s.style)))}function I0(t,e,n,r=n.contentMatch,i=!0){let o=t.doc.nodeAt(e),s=[],a=e+1;for(let l=0;l<o.childCount;l++){let c=o.child(l),u=a+c.nodeSize,d=r.matchType(c.type);if(!d)s.push(new st(a,u,W.empty));else{r=d;for(let h=0;h<c.marks.length;h++)n.allowsMarkType(c.marks[h].type)||t.step(new Ir(a,u,c.marks[h]));if(i&&c.isText&&n.whitespace!="pre"){let h,p=/\r?\n|\r/g,m;for(;h=p.exec(c.text);)m||(m=new W(B.from(n.schema.text(" ",n.allowedMarks(c.marks))),0,0)),s.push(new st(a+h.index,a+h.index+h[0].length,m))}}a=u}if(!r.validEnd){let l=r.fillBefore(B.empty,!0);t.replace(a,a,new W(l,0,0))}for(let l=s.length-1;l>=0;l--)t.step(s[l])}function ML(t,e,n){return(e==0||t.canReplace(e,t.childCount))&&(n==t.childCount||t.canReplace(0,n))}function jl(t){let n=t.parent.content.cutByIndex(t.startIndex,t.endIndex);for(let r=t.depth;;--r){let i=t.$from.node(r),o=t.$from.index(r),s=t.$to.indexAfter(r);if(r<t.depth&&i.canReplace(o,s,n))return r;if(r==0||i.type.spec.isolating||!ML(i,o,s))break}return null}function IL(t,e,n){let{$from:r,$to:i,depth:o}=e,s=r.before(o+1),a=i.after(o+1),l=s,c=a,u=B.empty,d=0;for(let m=o,y=!1;m>n;m--)y||r.index(m)>0?(y=!0,u=B.from(r.node(m).copy(u)),d++):l--;let h=B.empty,p=0;for(let m=o,y=!1;m>n;m--)y||i.after(m+1)<i.end(m)?(y=!0,h=B.from(i.node(m).copy(h)),p++):c++;t.step(new lt(l,c,s,a,new W(u.append(h),d,p),u.size-d,!0))}function A0(t,e,n=null,r=t){let i=AL(t,e),o=i&&NL(r,e);return o?i.map($b).concat({type:e,attrs:n}).concat(o.map($b)):null}function $b(t){return{type:t,attrs:null}}function AL(t,e){let{parent:n,startIndex:r,endIndex:i}=t,o=n.contentMatchAt(r).findWrapping(e);if(!o)return null;let s=o.length?o[0]:e;return n.canReplaceWith(r,i,s)?o:null}function NL(t,e){let{parent:n,startIndex:r,endIndex:i}=t,o=n.child(r),s=e.contentMatch.findWrapping(o.type);if(!s)return null;let l=(s.length?s[s.length-1]:e).contentMatch;for(let c=r;l&&c<i;c++)l=l.matchType(n.child(c).type);return!l||!l.validEnd?null:s}function DL(t,e,n){let r=B.empty;for(let s=n.length-1;s>=0;s--){if(r.size){let a=n[s].type.contentMatch.matchFragment(r);if(!a||!a.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}r=B.from(n[s].type.create(n[s].attrs,r))}let i=e.start,o=e.end;t.step(new lt(i,o,i,o,new W(r,0,0),n.length,!0))}function jL(t,e,n,r,i){if(!r.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let o=t.steps.length;t.doc.nodesBetween(e,n,(s,a)=>{let l=typeof i=="function"?i(s):i;if(s.isTextblock&&!s.hasMarkup(r,l)&&LL(t.doc,t.mapping.slice(o).map(a),r)){let c=null;if(r.schema.linebreakReplacement){let p=r.whitespace=="pre",m=!!r.contentMatch.matchType(r.schema.linebreakReplacement);p&&!m?c=!1:!p&&m&&(c=!0)}c===!1&&IT(t,s,a,o),I0(t,t.mapping.slice(o).map(a,1),r,void 0,c===null);let u=t.mapping.slice(o),d=u.map(a,1),h=u.map(a+s.nodeSize,1);return t.step(new lt(d,h,d+1,h-1,new W(B.from(r.create(l,null,s.marks)),0,0),1,!0)),c===!0&&MT(t,s,a,o),!1}})}function MT(t,e,n,r){e.forEach((i,o)=>{if(i.isText){let s,a=/\r?\n|\r/g;for(;s=a.exec(i.text);){let l=t.mapping.slice(r).map(n+1+o+s.index);t.replaceWith(l,l+1,e.type.schema.linebreakReplacement.create())}}})}function IT(t,e,n,r){e.forEach((i,o)=>{if(i.type==i.type.schema.linebreakReplacement){let s=t.mapping.slice(r).map(n+1+o);t.replaceWith(s,s+1,e.type.schema.text(`
`))}})}function LL(t,e,n){let r=t.resolve(e),i=r.index();return r.parent.canReplaceWith(i,i+1,n)}function $L(t,e,n,r,i){let o=t.doc.nodeAt(e);if(!o)throw new RangeError("No node at given position");n||(n=o.type);let s=n.create(r,null,i||o.marks);if(o.isLeaf)return t.replaceWith(e,e+o.nodeSize,s);if(!n.validContent(o.content))throw new RangeError("Invalid content for node type "+n.name);t.step(new lt(e,e+o.nodeSize,e+1,e+o.nodeSize-1,new W(B.from(s),0,0),1,!0))}function La(t,e,n=1,r){let i=t.resolve(e),o=i.depth-n,s=r&&r[r.length-1]||i.parent;if(o<0||i.parent.type.spec.isolating||!i.parent.canReplace(i.index(),i.parent.childCount)||!s.type.validContent(i.parent.content.cutByIndex(i.index(),i.parent.childCount)))return!1;for(let c=i.depth-1,u=n-2;c>o;c--,u--){let d=i.node(c),h=i.index(c);if(d.type.spec.isolating)return!1;let p=d.content.cutByIndex(h,d.childCount),m=r&&r[u+1];m&&(p=p.replaceChild(0,m.type.create(m.attrs)));let y=r&&r[u]||d;if(!d.canReplace(h+1,d.childCount)||!y.type.validContent(p))return!1}let a=i.indexAfter(o),l=r&&r[0];return i.node(o).canReplaceWith(a,a,l?l.type:i.node(o+1).type)}function FL(t,e,n=1,r){let i=t.doc.resolve(e),o=B.empty,s=B.empty;for(let a=i.depth,l=i.depth-n,c=n-1;a>l;a--,c--){o=B.from(i.node(a).copy(o));let u=r&&r[c];s=B.from(u?u.type.create(u.attrs,s):i.node(a).copy(s))}t.step(new st(e,e,new W(o.append(s),n,n),!0))}function Do(t,e){let n=t.resolve(e),r=n.index();return AT(n.nodeBefore,n.nodeAfter)&&n.parent.canReplace(r,r+1)}function BL(t,e){e.content.size||t.type.compatibleContent(e.type);let n=t.contentMatchAt(t.childCount),{linebreakReplacement:r}=t.type.schema;for(let i=0;i<e.childCount;i++){let o=e.child(i),s=o.type==r?t.type.schema.nodes.text:o.type;if(n=n.matchType(s),!n||!t.type.allowsMarks(o.marks))return!1}return n.validEnd}function AT(t,e){return!!(t&&e&&!t.isLeaf&&BL(t,e))}function Jh(t,e,n=-1){let r=t.resolve(e);for(let i=r.depth;;i--){let o,s,a=r.index(i);if(i==r.depth?(o=r.nodeBefore,s=r.nodeAfter):n>0?(o=r.node(i+1),a++,s=r.node(i).maybeChild(a)):(o=r.node(i).maybeChild(a-1),s=r.node(i+1)),o&&!o.isTextblock&&AT(o,s)&&r.node(i).canReplace(a,a+1))return e;if(i==0)break;e=n<0?r.before(i):r.after(i)}}function zL(t,e,n){let r=null,{linebreakReplacement:i}=t.doc.type.schema,o=t.doc.resolve(e-n),s=o.node().type;if(i&&s.inlineContent){let u=s.whitespace=="pre",d=!!s.contentMatch.matchType(i);u&&!d?r=!1:!u&&d&&(r=!0)}let a=t.steps.length;if(r===!1){let u=t.doc.resolve(e+n);IT(t,u.node(),u.before(),a)}s.inlineContent&&I0(t,e+n-1,s,o.node().contentMatchAt(o.index()),r==null);let l=t.mapping.slice(a),c=l.map(e-n);if(t.step(new st(c,l.map(e+n,-1),W.empty,!0)),r===!0){let u=t.doc.resolve(c);MT(t,u.node(),u.before(),t.steps.length)}return t}function VL(t,e,n){let r=t.resolve(e);if(r.parent.canReplaceWith(r.index(),r.index(),n))return e;if(r.parentOffset==0)for(let i=r.depth-1;i>=0;i--){let o=r.index(i);if(r.node(i).canReplaceWith(o,o,n))return r.before(i+1);if(o>0)return null}if(r.parentOffset==r.parent.content.size)for(let i=r.depth-1;i>=0;i--){let o=r.indexAfter(i);if(r.node(i).canReplaceWith(o,o,n))return r.after(i+1);if(o<r.node(i).childCount)return null}return null}function NT(t,e,n){let r=t.resolve(e);if(!n.content.size)return e;let i=n.content;for(let o=0;o<n.openStart;o++)i=i.firstChild.content;for(let o=1;o<=(n.openStart==0&&n.size?2:1);o++)for(let s=r.depth;s>=0;s--){let a=s==r.depth?0:r.pos<=(r.start(s+1)+r.end(s+1))/2?-1:1,l=r.index(s)+(a>0?1:0),c=r.node(s),u=!1;if(o==1)u=c.canReplace(l,l,i);else{let d=c.contentMatchAt(l).findWrapping(i.firstChild.type);u=d&&c.canReplaceWith(l,l,d[0])}if(u)return a==0?r.pos:a<0?r.before(s+1):r.after(s+1)}return null}function Yh(t,e,n=e,r=W.empty){if(e==n&&!r.size)return null;let i=t.resolve(e),o=t.resolve(n);return DT(i,o,r)?new st(e,n,r):new UL(i,o,r).fit()}function DT(t,e,n){return!n.openStart&&!n.openEnd&&t.start()==e.start()&&t.parent.canReplace(t.index(),e.index(),n.content)}class UL{constructor(e,n,r){this.$from=e,this.$to=n,this.unplaced=r,this.frontier=[],this.placed=B.empty;for(let i=0;i<=e.depth;i++){let o=e.node(i);this.frontier.push({type:o.type,match:o.contentMatchAt(e.indexAfter(i))})}for(let i=e.depth;i>0;i--)this.placed=B.from(e.node(i).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let c=this.findFittable();c?this.placeNodes(c):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),n=this.placed.size-this.depth-this.$from.depth,r=this.$from,i=this.close(e<0?this.$to:r.doc.resolve(e));if(!i)return null;let o=this.placed,s=r.depth,a=i.depth;for(;s&&a&&o.childCount==1;)o=o.firstChild.content,s--,a--;let l=new W(o,s,a);return e>-1?new lt(r.pos,e,this.$to.pos,this.$to.end(),l,n):l.size||r.pos!=this.$to.pos?new st(r.pos,i.pos,l):null}findFittable(){let e=this.unplaced.openStart;for(let n=this.unplaced.content,r=0,i=this.unplaced.openEnd;r<e;r++){let o=n.firstChild;if(n.childCount>1&&(i=0),o.type.spec.isolating&&i<=r){e=r;break}n=o.content}for(let n=1;n<=2;n++)for(let r=n==1?e:this.unplaced.openStart;r>=0;r--){let i,o=null;r?(o=vm(this.unplaced.content,r-1).firstChild,i=o.content):i=this.unplaced.content;let s=i.firstChild;for(let a=this.depth;a>=0;a--){let{type:l,match:c}=this.frontier[a],u,d=null;if(n==1&&(s?c.matchType(s.type)||(d=c.fillBefore(B.from(s),!1)):o&&l.compatibleContent(o.type)))return{sliceDepth:r,frontierDepth:a,parent:o,inject:d};if(n==2&&s&&(u=c.findWrapping(s.type)))return{sliceDepth:r,frontierDepth:a,parent:o,wrap:u};if(o&&c.matchType(o.type))break}}}openMore(){let{content:e,openStart:n,openEnd:r}=this.unplaced,i=vm(e,n);return!i.childCount||i.firstChild.isLeaf?!1:(this.unplaced=new W(e,n+1,Math.max(r,i.size+n>=e.size-r?n+1:0)),!0)}dropNode(){let{content:e,openStart:n,openEnd:r}=this.unplaced,i=vm(e,n);if(i.childCount<=1&&n>0){let o=e.size-n<=n+i.size;this.unplaced=new W(uc(e,n-1,1),n-1,o?n-1:r)}else this.unplaced=new W(uc(e,n,1),n,r)}placeNodes({sliceDepth:e,frontierDepth:n,parent:r,inject:i,wrap:o}){for(;this.depth>n;)this.closeFrontierNode();if(o)for(let y=0;y<o.length;y++)this.openFrontierNode(o[y]);let s=this.unplaced,a=r?r.content:s.content,l=s.openStart-e,c=0,u=[],{match:d,type:h}=this.frontier[n];if(i){for(let y=0;y<i.childCount;y++)u.push(i.child(y));d=d.matchFragment(i)}let p=a.size+e-(s.content.size-s.openEnd);for(;c<a.childCount;){let y=a.child(c),v=d.matchType(y.type);if(!v)break;c++,(c>1||l==0||y.content.size)&&(d=v,u.push(jT(y.mark(h.allowedMarks(y.marks)),c==1?l:0,c==a.childCount?p:-1)))}let m=c==a.childCount;m||(p=-1),this.placed=dc(this.placed,n,B.from(u)),this.frontier[n].match=d,m&&p<0&&r&&r.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let y=0,v=a;y<p;y++){let x=v.lastChild;this.frontier.push({type:x.type,match:x.contentMatchAt(x.childCount)}),v=x.content}this.unplaced=m?e==0?W.empty:new W(uc(s.content,e-1,1),e-1,p<0?s.openEnd:e-1):new W(uc(s.content,e,c),s.openStart,s.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e=this.frontier[this.depth],n;if(!e.type.isTextblock||!xm(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(n=this.findCloseLevel(this.$to))&&n.depth==this.depth)return-1;let{depth:r}=this.$to,i=this.$to.after(r);for(;r>1&&i==this.$to.end(--r);)++i;return i}findCloseLevel(e){e:for(let n=Math.min(this.depth,e.depth);n>=0;n--){let{match:r,type:i}=this.frontier[n],o=n<e.depth&&e.end(n+1)==e.pos+(e.depth-(n+1)),s=xm(e,n,i,r,o);if(s){for(let a=n-1;a>=0;a--){let{match:l,type:c}=this.frontier[a],u=xm(e,a,c,l,!0);if(!u||u.childCount)continue e}return{depth:n,fit:s,move:o?e.doc.resolve(e.after(n+1)):e}}}}close(e){let n=this.findCloseLevel(e);if(!n)return null;for(;this.depth>n.depth;)this.closeFrontierNode();n.fit.childCount&&(this.placed=dc(this.placed,n.depth,n.fit)),e=n.move;for(let r=n.depth+1;r<=e.depth;r++){let i=e.node(r),o=i.type.contentMatch.fillBefore(i.content,!0,e.index(r));this.openFrontierNode(i.type,i.attrs,o)}return e}openFrontierNode(e,n=null,r){let i=this.frontier[this.depth];i.match=i.match.matchType(e),this.placed=dc(this.placed,this.depth,B.from(e.create(n,r))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let n=this.frontier.pop().match.fillBefore(B.empty,!0);n.childCount&&(this.placed=dc(this.placed,this.frontier.length,n))}}function uc(t,e,n){return e==0?t.cutByIndex(n,t.childCount):t.replaceChild(0,t.firstChild.copy(uc(t.firstChild.content,e-1,n)))}function dc(t,e,n){return e==0?t.append(n):t.replaceChild(t.childCount-1,t.lastChild.copy(dc(t.lastChild.content,e-1,n)))}function vm(t,e){for(let n=0;n<e;n++)t=t.firstChild.content;return t}function jT(t,e,n){if(e<=0)return t;let r=t.content;return e>1&&(r=r.replaceChild(0,jT(r.firstChild,e-1,r.childCount==1?n-1:0))),e>0&&(r=t.type.contentMatch.fillBefore(r).append(r),n<=0&&(r=r.append(t.type.contentMatch.matchFragment(r).fillBefore(B.empty,!0)))),t.copy(r)}function xm(t,e,n,r,i){let o=t.node(e),s=i?t.indexAfter(e):t.index(e);if(s==o.childCount&&!n.compatibleContent(o.type))return null;let a=r.fillBefore(o.content,!0,s);return a&&!HL(n,o.content,s)?a:null}function HL(t,e,n){for(let r=n;r<e.childCount;r++)if(!t.allowsMarks(e.child(r).marks))return!0;return!1}function WL(t){return t.spec.defining||t.spec.definingForContent}function KL(t,e,n,r){if(!r.size)return t.deleteRange(e,n);let i=t.doc.resolve(e),o=t.doc.resolve(n);if(DT(i,o,r))return t.step(new st(e,n,r));let s=$T(i,t.doc.resolve(n));s[s.length-1]==0&&s.pop();let a=-(i.depth+1);s.unshift(a);for(let h=i.depth,p=i.pos-1;h>0;h--,p--){let m=i.node(h).type.spec;if(m.defining||m.definingAsContext||m.isolating)break;s.indexOf(h)>-1?a=h:i.before(h)==p&&s.splice(1,0,-h)}let l=s.indexOf(a),c=[],u=r.openStart;for(let h=r.content,p=0;;p++){let m=h.firstChild;if(c.push(m),p==r.openStart)break;h=m.content}for(let h=u-1;h>=0;h--){let p=c[h],m=WL(p.type);if(m&&!p.sameMarkup(i.node(Math.abs(a)-1)))u=h;else if(m||!p.type.isTextblock)break}for(let h=r.openStart;h>=0;h--){let p=(h+u+1)%(r.openStart+1),m=c[p];if(m)for(let y=0;y<s.length;y++){let v=s[(y+l)%s.length],x=!0;v<0&&(x=!1,v=-v);let w=i.node(v-1),b=i.index(v-1);if(w.canReplaceWith(b,b,m.type,m.marks))return t.replace(i.before(v),x?o.after(v):n,new W(LT(r.content,0,r.openStart,p),p,r.openEnd))}}let d=t.steps.length;for(let h=s.length-1;h>=0&&(t.replace(e,n,r),!(t.steps.length>d));h--){let p=s[h];p<0||(e=i.before(p),n=o.after(p))}}function LT(t,e,n,r,i){if(e<n){let o=t.firstChild;t=t.replaceChild(0,o.copy(LT(o.content,e+1,n,r,o)))}if(e>r){let o=i.contentMatchAt(0),s=o.fillBefore(t).append(t);t=s.append(o.matchFragment(s).fillBefore(B.empty,!0))}return t}function qL(t,e,n,r){if(!r.isInline&&e==n&&t.doc.resolve(e).parent.content.size){let i=VL(t.doc,e,r.type);i!=null&&(e=n=i)}t.replaceRange(e,n,new W(B.from(r),0,0))}function GL(t,e,n){let r=t.doc.resolve(e),i=t.doc.resolve(n),o=$T(r,i);for(let s=0;s<o.length;s++){let a=o[s],l=s==o.length-1;if(l&&a==0||r.node(a).type.contentMatch.validEnd)return t.delete(r.start(a),i.end(a));if(a>0&&(l||r.node(a-1).canReplace(r.index(a-1),i.indexAfter(a-1))))return t.delete(r.before(a),i.after(a))}for(let s=1;s<=r.depth&&s<=i.depth;s++)if(e-r.start(s)==r.depth-s&&n>r.end(s)&&i.end(s)-n!=i.depth-s&&r.start(s-1)==i.start(s-1)&&r.node(s-1).canReplace(r.index(s-1),i.index(s-1)))return t.delete(r.before(s),n);t.delete(e,n)}function $T(t,e){let n=[],r=Math.min(t.depth,e.depth);for(let i=r;i>=0;i--){let o=t.start(i);if(o<t.pos-(t.depth-i)||e.end(i)>e.pos+(e.depth-i)||t.node(i).type.spec.isolating||e.node(i).type.spec.isolating)break;(o==e.start(i)||i==t.depth&&i==e.depth&&t.parent.inlineContent&&e.parent.inlineContent&&i&&e.start(i-1)==o-1)&&n.push(i)}return n}class $a extends Mt{constructor(e,n,r){super(),this.pos=e,this.attr=n,this.value=r}apply(e){let n=e.nodeAt(this.pos);if(!n)return Xe.fail("No node at attribute step's position");let r=Object.create(null);for(let o in n.attrs)r[o]=n.attrs[o];r[this.attr]=this.value;let i=n.type.create(r,null,n.marks);return Xe.fromReplace(e,this.pos,this.pos+1,new W(B.from(i),0,n.isLeaf?0:1))}getMap(){return wn.empty}invert(e){return new $a(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new $a(n.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,n){if(typeof n.pos!="number"||typeof n.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new $a(n.pos,n.attr,n.value)}}Mt.jsonID("attr",$a);class ru extends Mt{constructor(e,n){super(),this.attr=e,this.value=n}apply(e){let n=Object.create(null);for(let i in e.attrs)n[i]=e.attrs[i];n[this.attr]=this.value;let r=e.type.create(n,e.content,e.marks);return Xe.ok(r)}getMap(){return wn.empty}invert(e){return new ru(this.attr,e.attrs[this.attr])}map(e){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(e,n){if(typeof n.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new ru(n.attr,n.value)}}Mt.jsonID("docAttr",ru);let dl=class extends Error{};dl=function t(e){let n=Error.call(this,e);return n.__proto__=t.prototype,n};dl.prototype=Object.create(Error.prototype);dl.prototype.constructor=dl;dl.prototype.name="TransformError";class JL{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new nu}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let n=this.maybeStep(e);if(n.failed)throw new dl(n.failed);return this}maybeStep(e){let n=e.apply(this.doc);return n.failed||this.addStep(e,n.doc),n}get docChanged(){return this.steps.length>0}addStep(e,n){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=n}replace(e,n=e,r=W.empty){let i=Yh(this.doc,e,n,r);return i&&this.step(i),this}replaceWith(e,n,r){return this.replace(e,n,new W(B.from(r),0,0))}delete(e,n){return this.replace(e,n,W.empty)}insert(e,n){return this.replaceWith(e,e,n)}replaceRange(e,n,r){return KL(this,e,n,r),this}replaceRangeWith(e,n,r){return qL(this,e,n,r),this}deleteRange(e,n){return GL(this,e,n),this}lift(e,n){return IL(this,e,n),this}join(e,n=1){return zL(this,e,n),this}wrap(e,n){return DL(this,e,n),this}setBlockType(e,n=e,r,i=null){return jL(this,e,n,r,i),this}setNodeMarkup(e,n,r=null,i){return $L(this,e,n,r,i),this}setNodeAttribute(e,n,r){return this.step(new $a(e,n,r)),this}setDocAttribute(e,n){return this.step(new ru(e,n)),this}addNodeMark(e,n){return this.step(new so(e,n)),this}removeNodeMark(e,n){if(!(n instanceof Re)){let r=this.doc.nodeAt(e);if(!r)throw new RangeError("No node at position "+e);if(n=n.isInSet(r.marks),!n)return this}return this.step(new ul(e,n)),this}split(e,n=1,r){return FL(this,e,n,r),this}addMark(e,n,r){return OL(this,e,n,r),this}removeMark(e,n,r){return PL(this,e,n,r),this}clearIncompatible(e,n,r){return I0(this,e,n,r),this}}const wm=Object.create(null);class oe{constructor(e,n,r){this.$anchor=e,this.$head=n,this.ranges=r||[new YL(e.min(n),e.max(n))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let n=0;n<e.length;n++)if(e[n].$from.pos!=e[n].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,n=W.empty){let r=n.content.lastChild,i=null;for(let a=0;a<n.openEnd;a++)i=r,r=r.lastChild;let o=e.steps.length,s=this.ranges;for(let a=0;a<s.length;a++){let{$from:l,$to:c}=s[a],u=e.mapping.slice(o);e.replaceRange(u.map(l.pos),u.map(c.pos),a?W.empty:n),a==0&&zb(e,o,(r?r.isInline:i&&i.isTextblock)?-1:1)}}replaceWith(e,n){let r=e.steps.length,i=this.ranges;for(let o=0;o<i.length;o++){let{$from:s,$to:a}=i[o],l=e.mapping.slice(r),c=l.map(s.pos),u=l.map(a.pos);o?e.deleteRange(c,u):(e.replaceRangeWith(c,u,n),zb(e,r,n.isInline?-1:1))}}static findFrom(e,n,r=!1){let i=e.parent.inlineContent?new ie(e):ua(e.node(0),e.parent,e.pos,e.index(),n,r);if(i)return i;for(let o=e.depth-1;o>=0;o--){let s=n<0?ua(e.node(0),e.node(o),e.before(o+1),e.index(o),n,r):ua(e.node(0),e.node(o),e.after(o+1),e.index(o)+1,n,r);if(s)return s}return null}static near(e,n=1){return this.findFrom(e,n)||this.findFrom(e,-n)||new $n(e.node(0))}static atStart(e){return ua(e,e,0,0,1)||new $n(e)}static atEnd(e){return ua(e,e,e.content.size,e.childCount,-1)||new $n(e)}static fromJSON(e,n){if(!n||!n.type)throw new RangeError("Invalid input for Selection.fromJSON");let r=wm[n.type];if(!r)throw new RangeError(`No selection type ${n.type} defined`);return r.fromJSON(e,n)}static jsonID(e,n){if(e in wm)throw new RangeError("Duplicate use of selection JSON ID "+e);return wm[e]=n,n.prototype.jsonID=e,n}getBookmark(){return ie.between(this.$anchor,this.$head).getBookmark()}}oe.prototype.visible=!0;class YL{constructor(e,n){this.$from=e,this.$to=n}}let Fb=!1;function Bb(t){!Fb&&!t.parent.inlineContent&&(Fb=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+t.parent.type.name+")"))}class ie extends oe{constructor(e,n=e){Bb(e),Bb(n),super(e,n)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,n){let r=e.resolve(n.map(this.head));if(!r.parent.inlineContent)return oe.near(r);let i=e.resolve(n.map(this.anchor));return new ie(i.parent.inlineContent?i:r,r)}replace(e,n=W.empty){if(super.replace(e,n),n==W.empty){let r=this.$from.marksAcross(this.$to);r&&e.ensureMarks(r)}}eq(e){return e instanceof ie&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new Qh(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,n){if(typeof n.anchor!="number"||typeof n.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new ie(e.resolve(n.anchor),e.resolve(n.head))}static create(e,n,r=n){let i=e.resolve(n);return new this(i,r==n?i:e.resolve(r))}static between(e,n,r){let i=e.pos-n.pos;if((!r||i)&&(r=i>=0?1:-1),!n.parent.inlineContent){let o=oe.findFrom(n,r,!0)||oe.findFrom(n,-r,!0);if(o)n=o.$head;else return oe.near(n,r)}return e.parent.inlineContent||(i==0?e=n:(e=(oe.findFrom(e,-r,!0)||oe.findFrom(e,r,!0)).$anchor,e.pos<n.pos!=i<0&&(e=n))),new ie(e,n)}}oe.jsonID("text",ie);class Qh{constructor(e,n){this.anchor=e,this.head=n}map(e){return new Qh(e.map(this.anchor),e.map(this.head))}resolve(e){return ie.between(e.resolve(this.anchor),e.resolve(this.head))}}class te extends oe{constructor(e){let n=e.nodeAfter,r=e.node(0).resolve(e.pos+n.nodeSize);super(e,r),this.node=n}map(e,n){let{deleted:r,pos:i}=n.mapResult(this.anchor),o=e.resolve(i);return r?oe.near(o):new te(o)}content(){return new W(B.from(this.node),0,0)}eq(e){return e instanceof te&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new N0(this.anchor)}static fromJSON(e,n){if(typeof n.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new te(e.resolve(n.anchor))}static create(e,n){return new te(e.resolve(n))}static isSelectable(e){return!e.isText&&e.type.spec.selectable!==!1}}te.prototype.visible=!1;oe.jsonID("node",te);class N0{constructor(e){this.anchor=e}map(e){let{deleted:n,pos:r}=e.mapResult(this.anchor);return n?new Qh(r,r):new N0(r)}resolve(e){let n=e.resolve(this.anchor),r=n.nodeAfter;return r&&te.isSelectable(r)?new te(n):oe.near(n)}}class $n extends oe{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,n=W.empty){if(n==W.empty){e.delete(0,e.doc.content.size);let r=oe.atStart(e.doc);r.eq(e.selection)||e.setSelection(r)}else super.replace(e,n)}toJSON(){return{type:"all"}}static fromJSON(e){return new $n(e)}map(e){return new $n(e)}eq(e){return e instanceof $n}getBookmark(){return QL}}oe.jsonID("all",$n);const QL={map(){return this},resolve(t){return new $n(t)}};function ua(t,e,n,r,i,o=!1){if(e.inlineContent)return ie.create(t,n);for(let s=r-(i>0?0:1);i>0?s<e.childCount:s>=0;s+=i){let a=e.child(s);if(a.isAtom){if(!o&&te.isSelectable(a))return te.create(t,n-(i<0?a.nodeSize:0))}else{let l=ua(t,a,n+i,i<0?a.childCount:0,i,o);if(l)return l}n+=a.nodeSize*i}return null}function zb(t,e,n){let r=t.steps.length-1;if(r<e)return;let i=t.steps[r];if(!(i instanceof st||i instanceof lt))return;let o=t.mapping.maps[r],s;o.forEach((a,l,c,u)=>{s==null&&(s=u)}),t.setSelection(oe.near(t.doc.resolve(s),n))}const Vb=1,Od=2,Ub=4;class XL extends JL{constructor(e){super(e.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=e.selection,this.storedMarks=e.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(e){if(e.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=(this.updated|Vb)&~Od,this.storedMarks=null,this}get selectionSet(){return(this.updated&Vb)>0}setStoredMarks(e){return this.storedMarks=e,this.updated|=Od,this}ensureMarks(e){return Re.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this}addStoredMark(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(this.updated&Od)>0}addStep(e,n){super.addStep(e,n),this.updated=this.updated&~Od,this.storedMarks=null}setTime(e){return this.time=e,this}replaceSelection(e){return this.selection.replace(this,e),this}replaceSelectionWith(e,n=!0){let r=this.selection;return n&&(e=e.mark(this.storedMarks||(r.empty?r.$from.marks():r.$from.marksAcross(r.$to)||Re.none))),r.replaceWith(this,e),this}deleteSelection(){return this.selection.replace(this),this}insertText(e,n,r){let i=this.doc.type.schema;if(n==null)return e?this.replaceSelectionWith(i.text(e),!0):this.deleteSelection();{if(r==null&&(r=n),r=r??n,!e)return this.deleteRange(n,r);let o=this.storedMarks;if(!o){let s=this.doc.resolve(n);o=r==n?s.marks():s.marksAcross(this.doc.resolve(r))}return this.replaceRangeWith(n,r,i.text(e,o)),this.selection.empty||this.setSelection(oe.near(this.selection.$to)),this}}setMeta(e,n){return this.meta[typeof e=="string"?e:e.key]=n,this}getMeta(e){return this.meta[typeof e=="string"?e:e.key]}get isGeneric(){for(let e in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=Ub,this}get scrolledIntoView(){return(this.updated&Ub)>0}}function Hb(t,e){return!e||!t?t:t.bind(e)}class fc{constructor(e,n,r){this.name=e,this.init=Hb(n.init,r),this.apply=Hb(n.apply,r)}}const ZL=[new fc("doc",{init(t){return t.doc||t.schema.topNodeType.createAndFill()},apply(t){return t.doc}}),new fc("selection",{init(t,e){return t.selection||oe.atStart(e.doc)},apply(t){return t.selection}}),new fc("storedMarks",{init(t){return t.storedMarks||null},apply(t,e,n,r){return r.selection.$cursor?t.storedMarks:null}}),new fc("scrollToSelection",{init(){return 0},apply(t,e){return t.scrolledIntoView?e+1:e}})];class bm{constructor(e,n){this.schema=e,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=ZL.slice(),n&&n.forEach(r=>{if(this.pluginsByKey[r.key])throw new RangeError("Adding different instances of a keyed plugin ("+r.key+")");this.plugins.push(r),this.pluginsByKey[r.key]=r,r.spec.state&&this.fields.push(new fc(r.key,r.spec.state,r))})}}class Ta{constructor(e){this.config=e}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(e){return this.applyTransaction(e).state}filterTransaction(e,n=-1){for(let r=0;r<this.config.plugins.length;r++)if(r!=n){let i=this.config.plugins[r];if(i.spec.filterTransaction&&!i.spec.filterTransaction.call(i,e,this))return!1}return!0}applyTransaction(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};let n=[e],r=this.applyInner(e),i=null;for(;;){let o=!1;for(let s=0;s<this.config.plugins.length;s++){let a=this.config.plugins[s];if(a.spec.appendTransaction){let l=i?i[s].n:0,c=i?i[s].state:this,u=l<n.length&&a.spec.appendTransaction.call(a,l?n.slice(l):n,c,r);if(u&&r.filterTransaction(u,s)){if(u.setMeta("appendedTransaction",e),!i){i=[];for(let d=0;d<this.config.plugins.length;d++)i.push(d<s?{state:r,n:n.length}:{state:this,n:0})}n.push(u),r=r.applyInner(u),o=!0}i&&(i[s]={state:r,n:n.length})}}if(!o)return{state:r,transactions:n}}}applyInner(e){if(!e.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let n=new Ta(this.config),r=this.config.fields;for(let i=0;i<r.length;i++){let o=r[i];n[o.name]=o.apply(e,this[o.name],this,n)}return n}get tr(){return new XL(this)}static create(e){let n=new bm(e.doc?e.doc.type.schema:e.schema,e.plugins),r=new Ta(n);for(let i=0;i<n.fields.length;i++)r[n.fields[i].name]=n.fields[i].init(e,r);return r}reconfigure(e){let n=new bm(this.schema,e.plugins),r=n.fields,i=new Ta(n);for(let o=0;o<r.length;o++){let s=r[o].name;i[s]=this.hasOwnProperty(s)?this[s]:r[o].init(e,i)}return i}toJSON(e){let n={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(n.storedMarks=this.storedMarks.map(r=>r.toJSON())),e&&typeof e=="object")for(let r in e){if(r=="doc"||r=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");let i=e[r],o=i.spec.state;o&&o.toJSON&&(n[r]=o.toJSON.call(i,this[i.key]))}return n}static fromJSON(e,n,r){if(!n)throw new RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw new RangeError("Required config field 'schema' missing");let i=new bm(e.schema,e.plugins),o=new Ta(i);return i.fields.forEach(s=>{if(s.name=="doc")o.doc=vo.fromJSON(e.schema,n.doc);else if(s.name=="selection")o.selection=oe.fromJSON(o.doc,n.selection);else if(s.name=="storedMarks")n.storedMarks&&(o.storedMarks=n.storedMarks.map(e.schema.markFromJSON));else{if(r)for(let a in r){let l=r[a],c=l.spec.state;if(l.key==s.name&&c&&c.fromJSON&&Object.prototype.hasOwnProperty.call(n,a)){o[s.name]=c.fromJSON.call(l,e,n[a],o);return}}o[s.name]=s.init(e,o)}}),o}}function FT(t,e,n){for(let r in t){let i=t[r];i instanceof Function?i=i.bind(e):r=="handleDOMEvents"&&(i=FT(i,e,{})),n[r]=i}return n}class xt{constructor(e){this.spec=e,this.props={},e.props&&FT(e.props,this,this.props),this.key=e.key?e.key.key:BT("plugin")}getState(e){return e[this.key]}}const Sm=Object.create(null);function BT(t){return t in Sm?t+"$"+ ++Sm[t]:(Sm[t]=0,t+"$")}class Rn{constructor(e="key"){this.key=BT(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}}const mt=function(t){for(var e=0;;e++)if(t=t.previousSibling,!t)return e},fl=function(t){let e=t.assignedSlot||t.parentNode;return e&&e.nodeType==11?e.host:e};let Ry=null;const Qr=function(t,e,n){let r=Ry||(Ry=document.createRange());return r.setEnd(t,n??t.nodeValue.length),r.setStart(t,e||0),r},e3=function(){Ry=null},As=function(t,e,n,r){return n&&(Wb(t,e,n,r,-1)||Wb(t,e,n,r,1))},t3=/^(img|br|input|textarea|hr)$/i;function Wb(t,e,n,r,i){for(;;){if(t==n&&e==r)return!0;if(e==(i<0?0:Dn(t))){let o=t.parentNode;if(!o||o.nodeType!=1||Fu(t)||t3.test(t.nodeName)||t.contentEditable=="false")return!1;e=mt(t)+(i<0?0:1),t=o}else if(t.nodeType==1){if(t=t.childNodes[e+(i<0?-1:0)],t.contentEditable=="false")return!1;e=i<0?Dn(t):0}else return!1}}function Dn(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function n3(t,e){for(;;){if(t.nodeType==3&&e)return t;if(t.nodeType==1&&e>0){if(t.contentEditable=="false")return null;t=t.childNodes[e-1],e=Dn(t)}else if(t.parentNode&&!Fu(t))e=mt(t),t=t.parentNode;else return null}}function r3(t,e){for(;;){if(t.nodeType==3&&e<t.nodeValue.length)return t;if(t.nodeType==1&&e<t.childNodes.length){if(t.contentEditable=="false")return null;t=t.childNodes[e],e=0}else if(t.parentNode&&!Fu(t))e=mt(t)+1,t=t.parentNode;else return null}}function i3(t,e,n){for(let r=e==0,i=e==Dn(t);r||i;){if(t==n)return!0;let o=mt(t);if(t=t.parentNode,!t)return!1;r=r&&o==0,i=i&&o==Dn(t)}}function Fu(t){let e;for(let n=t;n&&!(e=n.pmViewDesc);n=n.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==t||e.contentDOM==t)}const Xh=function(t){return t.focusNode&&As(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset)};function Qo(t,e){let n=document.createEvent("Event");return n.initEvent("keydown",!0,!0),n.keyCode=t,n.key=n.code=e,n}function o3(t){let e=t.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}function s3(t,e,n){if(t.caretPositionFromPoint)try{let r=t.caretPositionFromPoint(e,n);if(r)return{node:r.offsetNode,offset:Math.min(Dn(r.offsetNode),r.offset)}}catch{}if(t.caretRangeFromPoint){let r=t.caretRangeFromPoint(e,n);if(r)return{node:r.startContainer,offset:Math.min(Dn(r.startContainer),r.startOffset)}}}const Fr=typeof navigator<"u"?navigator:null,Kb=typeof document<"u"?document:null,jo=Fr&&Fr.userAgent||"",Oy=/Edge\/(\d+)/.exec(jo),zT=/MSIE \d/.exec(jo),Py=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(jo),dn=!!(zT||Py||Oy),wo=zT?document.documentMode:Py?+Py[1]:Oy?+Oy[1]:0,ur=!dn&&/gecko\/(\d+)/i.test(jo);ur&&+(/Firefox\/(\d+)/.exec(jo)||[0,0])[1];const My=!dn&&/Chrome\/(\d+)/.exec(jo),_t=!!My,VT=My?+My[1]:0,Ut=!dn&&!!Fr&&/Apple Computer/.test(Fr.vendor),hl=Ut&&(/Mobile\/\w+/.test(jo)||!!Fr&&Fr.maxTouchPoints>2),In=hl||(Fr?/Mac/.test(Fr.platform):!1),a3=Fr?/Win/.test(Fr.platform):!1,ri=/Android \d/.test(jo),Bu=!!Kb&&"webkitFontSmoothing"in Kb.documentElement.style,l3=Bu?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function c3(t){let e=t.defaultView&&t.defaultView.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:t.documentElement.clientWidth,top:0,bottom:t.documentElement.clientHeight}}function qr(t,e){return typeof t=="number"?t:t[e]}function u3(t){let e=t.getBoundingClientRect(),n=e.width/t.offsetWidth||1,r=e.height/t.offsetHeight||1;return{left:e.left,right:e.left+t.clientWidth*n,top:e.top,bottom:e.top+t.clientHeight*r}}function qb(t,e,n){let r=t.someProp("scrollThreshold")||0,i=t.someProp("scrollMargin")||5,o=t.dom.ownerDocument;for(let s=n||t.dom;s;){if(s.nodeType!=1){s=fl(s);continue}let a=s,l=a==o.body,c=l?c3(o):u3(a),u=0,d=0;if(e.top<c.top+qr(r,"top")?d=-(c.top-e.top+qr(i,"top")):e.bottom>c.bottom-qr(r,"bottom")&&(d=e.bottom-e.top>c.bottom-c.top?e.top+qr(i,"top")-c.top:e.bottom-c.bottom+qr(i,"bottom")),e.left<c.left+qr(r,"left")?u=-(c.left-e.left+qr(i,"left")):e.right>c.right-qr(r,"right")&&(u=e.right-c.right+qr(i,"right")),u||d)if(l)o.defaultView.scrollBy(u,d);else{let p=a.scrollLeft,m=a.scrollTop;d&&(a.scrollTop+=d),u&&(a.scrollLeft+=u);let y=a.scrollLeft-p,v=a.scrollTop-m;e={left:e.left-y,top:e.top-v,right:e.right-y,bottom:e.bottom-v}}let h=l?"fixed":getComputedStyle(s).position;if(/^(fixed|sticky)$/.test(h))break;s=h=="absolute"?s.offsetParent:fl(s)}}function d3(t){let e=t.dom.getBoundingClientRect(),n=Math.max(0,e.top),r,i;for(let o=(e.left+e.right)/2,s=n+1;s<Math.min(innerHeight,e.bottom);s+=5){let a=t.root.elementFromPoint(o,s);if(!a||a==t.dom||!t.dom.contains(a))continue;let l=a.getBoundingClientRect();if(l.top>=n-20){r=a,i=l.top;break}}return{refDOM:r,refTop:i,stack:UT(t.dom)}}function UT(t){let e=[],n=t.ownerDocument;for(let r=t;r&&(e.push({dom:r,top:r.scrollTop,left:r.scrollLeft}),t!=n);r=fl(r));return e}function f3({refDOM:t,refTop:e,stack:n}){let r=t?t.getBoundingClientRect().top:0;HT(n,r==0?0:r-e)}function HT(t,e){for(let n=0;n<t.length;n++){let{dom:r,top:i,left:o}=t[n];r.scrollTop!=i+e&&(r.scrollTop=i+e),r.scrollLeft!=o&&(r.scrollLeft=o)}}let ta=null;function h3(t){if(t.setActive)return t.setActive();if(ta)return t.focus(ta);let e=UT(t);t.focus(ta==null?{get preventScroll(){return ta={preventScroll:!0},!0}}:void 0),ta||(ta=!1,HT(e,0))}function WT(t,e){let n,r=2e8,i,o=0,s=e.top,a=e.top,l,c;for(let u=t.firstChild,d=0;u;u=u.nextSibling,d++){let h;if(u.nodeType==1)h=u.getClientRects();else if(u.nodeType==3)h=Qr(u).getClientRects();else continue;for(let p=0;p<h.length;p++){let m=h[p];if(m.top<=s&&m.bottom>=a){s=Math.max(m.bottom,s),a=Math.min(m.top,a);let y=m.left>e.left?m.left-e.left:m.right<e.left?e.left-m.right:0;if(y<r){n=u,r=y,i=y&&n.nodeType==3?{left:m.right<e.left?m.right:m.left,top:e.top}:e,u.nodeType==1&&y&&(o=d+(e.left>=(m.left+m.right)/2?1:0));continue}}else m.top>e.top&&!l&&m.left<=e.left&&m.right>=e.left&&(l=u,c={left:Math.max(m.left,Math.min(m.right,e.left)),top:m.top});!n&&(e.left>=m.right&&e.top>=m.top||e.left>=m.left&&e.top>=m.bottom)&&(o=d+1)}}return!n&&l&&(n=l,i=c,r=0),n&&n.nodeType==3?p3(n,i):!n||r&&n.nodeType==1?{node:t,offset:o}:WT(n,i)}function p3(t,e){let n=t.nodeValue.length,r=document.createRange();for(let i=0;i<n;i++){r.setEnd(t,i+1),r.setStart(t,i);let o=_i(r,1);if(o.top!=o.bottom&&D0(e,o))return{node:t,offset:i+(e.left>=(o.left+o.right)/2?1:0)}}return{node:t,offset:0}}function D0(t,e){return t.left>=e.left-1&&t.left<=e.right+1&&t.top>=e.top-1&&t.top<=e.bottom+1}function m3(t,e){let n=t.parentNode;return n&&/^li$/i.test(n.nodeName)&&e.left<t.getBoundingClientRect().left?n:t}function g3(t,e,n){let{node:r,offset:i}=WT(e,n),o=-1;if(r.nodeType==1&&!r.firstChild){let s=r.getBoundingClientRect();o=s.left!=s.right&&n.left>(s.left+s.right)/2?1:-1}return t.docView.posFromDOM(r,i,o)}function y3(t,e,n,r){let i=-1;for(let o=e,s=!1;o!=t.dom;){let a=t.docView.nearestDesc(o,!0),l;if(!a)return null;if(a.dom.nodeType==1&&(a.node.isBlock&&a.parent||!a.contentDOM)&&((l=a.dom.getBoundingClientRect()).width||l.height)&&(a.node.isBlock&&a.parent&&(!s&&l.left>r.left||l.top>r.top?i=a.posBefore:(!s&&l.right<r.left||l.bottom<r.top)&&(i=a.posAfter),s=!0),!a.contentDOM&&i<0&&!a.node.isText))return(a.node.isBlock?r.top<(l.top+l.bottom)/2:r.left<(l.left+l.right)/2)?a.posBefore:a.posAfter;o=a.dom.parentNode}return i>-1?i:t.docView.posFromDOM(e,n,-1)}function KT(t,e,n){let r=t.childNodes.length;if(r&&n.top<n.bottom)for(let i=Math.max(0,Math.min(r-1,Math.floor(r*(e.top-n.top)/(n.bottom-n.top))-2)),o=i;;){let s=t.childNodes[o];if(s.nodeType==1){let a=s.getClientRects();for(let l=0;l<a.length;l++){let c=a[l];if(D0(e,c))return KT(s,e,c)}}if((o=(o+1)%r)==i)break}return t}function v3(t,e){let n=t.dom.ownerDocument,r,i=0,o=s3(n,e.left,e.top);o&&({node:r,offset:i}=o);let s=(t.root.elementFromPoint?t.root:n).elementFromPoint(e.left,e.top),a;if(!s||!t.dom.contains(s.nodeType!=1?s.parentNode:s)){let c=t.dom.getBoundingClientRect();if(!D0(e,c)||(s=KT(t.dom,e,c),!s))return null}if(Ut)for(let c=s;r&&c;c=fl(c))c.draggable&&(r=void 0);if(s=m3(s,e),r){if(ur&&r.nodeType==1&&(i=Math.min(i,r.childNodes.length),i<r.childNodes.length)){let u=r.childNodes[i],d;u.nodeName=="IMG"&&(d=u.getBoundingClientRect()).right<=e.left&&d.bottom>e.top&&i++}let c;Bu&&i&&r.nodeType==1&&(c=r.childNodes[i-1]).nodeType==1&&c.contentEditable=="false"&&c.getBoundingClientRect().top>=e.top&&i--,r==t.dom&&i==r.childNodes.length-1&&r.lastChild.nodeType==1&&e.top>r.lastChild.getBoundingClientRect().bottom?a=t.state.doc.content.size:(i==0||r.nodeType!=1||r.childNodes[i-1].nodeName!="BR")&&(a=y3(t,r,i,e))}a==null&&(a=g3(t,s,e));let l=t.docView.nearestDesc(s,!0);return{pos:a,inside:l?l.posAtStart-l.border:-1}}function Gb(t){return t.top<t.bottom||t.left<t.right}function _i(t,e){let n=t.getClientRects();if(n.length){let r=n[e<0?0:n.length-1];if(Gb(r))return r}return Array.prototype.find.call(n,Gb)||t.getBoundingClientRect()}const x3=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function qT(t,e,n){let{node:r,offset:i,atom:o}=t.docView.domFromPos(e,n<0?-1:1),s=Bu||ur;if(r.nodeType==3)if(s&&(x3.test(r.nodeValue)||(n<0?!i:i==r.nodeValue.length))){let l=_i(Qr(r,i,i),n);if(ur&&i&&/\s/.test(r.nodeValue[i-1])&&i<r.nodeValue.length){let c=_i(Qr(r,i-1,i-1),-1);if(c.top==l.top){let u=_i(Qr(r,i,i+1),-1);if(u.top!=l.top)return tc(u,u.left<c.left)}}return l}else{let l=i,c=i,u=n<0?1:-1;return n<0&&!i?(c++,u=-1):n>=0&&i==r.nodeValue.length?(l--,u=1):n<0?l--:c++,tc(_i(Qr(r,l,c),u),u<0)}if(!t.state.doc.resolve(e-(o||0)).parent.inlineContent){if(o==null&&i&&(n<0||i==Dn(r))){let l=r.childNodes[i-1];if(l.nodeType==1)return Cm(l.getBoundingClientRect(),!1)}if(o==null&&i<Dn(r)){let l=r.childNodes[i];if(l.nodeType==1)return Cm(l.getBoundingClientRect(),!0)}return Cm(r.getBoundingClientRect(),n>=0)}if(o==null&&i&&(n<0||i==Dn(r))){let l=r.childNodes[i-1],c=l.nodeType==3?Qr(l,Dn(l)-(s?0:1)):l.nodeType==1&&(l.nodeName!="BR"||!l.nextSibling)?l:null;if(c)return tc(_i(c,1),!1)}if(o==null&&i<Dn(r)){let l=r.childNodes[i];for(;l.pmViewDesc&&l.pmViewDesc.ignoreForCoords;)l=l.nextSibling;let c=l?l.nodeType==3?Qr(l,0,s?0:1):l.nodeType==1?l:null:null;if(c)return tc(_i(c,-1),!0)}return tc(_i(r.nodeType==3?Qr(r):r,-n),n>=0)}function tc(t,e){if(t.width==0)return t;let n=e?t.left:t.right;return{top:t.top,bottom:t.bottom,left:n,right:n}}function Cm(t,e){if(t.height==0)return t;let n=e?t.top:t.bottom;return{top:n,bottom:n,left:t.left,right:t.right}}function GT(t,e,n){let r=t.state,i=t.root.activeElement;r!=e&&t.updateState(e),i!=t.dom&&t.focus();try{return n()}finally{r!=e&&t.updateState(r),i!=t.dom&&i&&i.focus()}}function w3(t,e,n){let r=e.selection,i=n=="up"?r.$from:r.$to;return GT(t,e,()=>{let{node:o}=t.docView.domFromPos(i.pos,n=="up"?-1:1);for(;;){let a=t.docView.nearestDesc(o,!0);if(!a)break;if(a.node.isBlock){o=a.contentDOM||a.dom;break}o=a.dom.parentNode}let s=qT(t,i.pos,1);for(let a=o.firstChild;a;a=a.nextSibling){let l;if(a.nodeType==1)l=a.getClientRects();else if(a.nodeType==3)l=Qr(a,0,a.nodeValue.length).getClientRects();else continue;for(let c=0;c<l.length;c++){let u=l[c];if(u.bottom>u.top+1&&(n=="up"?s.top-u.top>(u.bottom-s.top)*2:u.bottom-s.bottom>(s.bottom-u.top)*2))return!1}}return!0})}const b3=/[\u0590-\u08ac]/;function S3(t,e,n){let{$head:r}=e.selection;if(!r.parent.isTextblock)return!1;let i=r.parentOffset,o=!i,s=i==r.parent.content.size,a=t.domSelection();return a?!b3.test(r.parent.textContent)||!a.modify?n=="left"||n=="backward"?o:s:GT(t,e,()=>{let{focusNode:l,focusOffset:c,anchorNode:u,anchorOffset:d}=t.domSelectionRange(),h=a.caretBidiLevel;a.modify("move",n,"character");let p=r.depth?t.docView.domAfterPos(r.before()):t.dom,{focusNode:m,focusOffset:y}=t.domSelectionRange(),v=m&&!p.contains(m.nodeType==1?m:m.parentNode)||l==m&&c==y;try{a.collapse(u,d),l&&(l!=u||c!=d)&&a.extend&&a.extend(l,c)}catch{}return h!=null&&(a.caretBidiLevel=h),v}):r.pos==r.start()||r.pos==r.end()}let Jb=null,Yb=null,Qb=!1;function C3(t,e,n){return Jb==e&&Yb==n?Qb:(Jb=e,Yb=n,Qb=n=="up"||n=="down"?w3(t,e,n):S3(t,e,n))}const Fn=0,Xb=1,rs=2,Br=3;class zu{constructor(e,n,r,i){this.parent=e,this.children=n,this.dom=r,this.contentDOM=i,this.dirty=Fn,r.pmViewDesc=this}matchesWidget(e){return!1}matchesMark(e){return!1}matchesNode(e,n,r){return!1}matchesHack(e){return!1}parseRule(){return null}stopEvent(e){return!1}get size(){let e=0;for(let n=0;n<this.children.length;n++)e+=this.children[n].size;return e}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let e=0;e<this.children.length;e++)this.children[e].destroy()}posBeforeChild(e){for(let n=0,r=this.posAtStart;;n++){let i=this.children[n];if(i==e)return r;r+=i.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(e,n,r){if(this.contentDOM&&this.contentDOM.contains(e.nodeType==1?e:e.parentNode))if(r<0){let o,s;if(e==this.contentDOM)o=e.childNodes[n-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;o=e.previousSibling}for(;o&&!((s=o.pmViewDesc)&&s.parent==this);)o=o.previousSibling;return o?this.posBeforeChild(s)+s.size:this.posAtStart}else{let o,s;if(e==this.contentDOM)o=e.childNodes[n];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;o=e.nextSibling}for(;o&&!((s=o.pmViewDesc)&&s.parent==this);)o=o.nextSibling;return o?this.posBeforeChild(s):this.posAtEnd}let i;if(e==this.dom&&this.contentDOM)i=n>mt(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))i=e.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(n==0)for(let o=e;;o=o.parentNode){if(o==this.dom){i=!1;break}if(o.previousSibling)break}if(i==null&&n==e.childNodes.length)for(let o=e;;o=o.parentNode){if(o==this.dom){i=!0;break}if(o.nextSibling)break}}return i??r>0?this.posAtEnd:this.posAtStart}nearestDesc(e,n=!1){for(let r=!0,i=e;i;i=i.parentNode){let o=this.getDesc(i),s;if(o&&(!n||o.node))if(r&&(s=o.nodeDOM)&&!(s.nodeType==1?s.contains(e.nodeType==1?e:e.parentNode):s==e))r=!1;else return o}}getDesc(e){let n=e.pmViewDesc;for(let r=n;r;r=r.parent)if(r==this)return n}posFromDOM(e,n,r){for(let i=e;i;i=i.parentNode){let o=this.getDesc(i);if(o)return o.localPosFromDOM(e,n,r)}return-1}descAt(e){for(let n=0,r=0;n<this.children.length;n++){let i=this.children[n],o=r+i.size;if(r==e&&o!=r){for(;!i.border&&i.children.length;)for(let s=0;s<i.children.length;s++){let a=i.children[s];if(a.size){i=a;break}}return i}if(e<o)return i.descAt(e-r-i.border);r=o}}domFromPos(e,n){if(!this.contentDOM)return{node:this.dom,offset:0,atom:e+1};let r=0,i=0;for(let o=0;r<this.children.length;r++){let s=this.children[r],a=o+s.size;if(a>e||s instanceof YT){i=e-o;break}o=a}if(i)return this.children[r].domFromPos(i-this.children[r].border,n);for(let o;r&&!(o=this.children[r-1]).size&&o instanceof JT&&o.side>=0;r--);if(n<=0){let o,s=!0;for(;o=r?this.children[r-1]:null,!(!o||o.dom.parentNode==this.contentDOM);r--,s=!1);return o&&n&&s&&!o.border&&!o.domAtom?o.domFromPos(o.size,n):{node:this.contentDOM,offset:o?mt(o.dom)+1:0}}else{let o,s=!0;for(;o=r<this.children.length?this.children[r]:null,!(!o||o.dom.parentNode==this.contentDOM);r++,s=!1);return o&&s&&!o.border&&!o.domAtom?o.domFromPos(0,n):{node:this.contentDOM,offset:o?mt(o.dom):this.contentDOM.childNodes.length}}}parseRange(e,n,r=0){if(this.children.length==0)return{node:this.contentDOM,from:e,to:n,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let i=-1,o=-1;for(let s=r,a=0;;a++){let l=this.children[a],c=s+l.size;if(i==-1&&e<=c){let u=s+l.border;if(e>=u&&n<=c-l.border&&l.node&&l.contentDOM&&this.contentDOM.contains(l.contentDOM))return l.parseRange(e,n,u);e=s;for(let d=a;d>0;d--){let h=this.children[d-1];if(h.size&&h.dom.parentNode==this.contentDOM&&!h.emptyChildAt(1)){i=mt(h.dom)+1;break}e-=h.size}i==-1&&(i=0)}if(i>-1&&(c>n||a==this.children.length-1)){n=c;for(let u=a+1;u<this.children.length;u++){let d=this.children[u];if(d.size&&d.dom.parentNode==this.contentDOM&&!d.emptyChildAt(-1)){o=mt(d.dom);break}n+=d.size}o==-1&&(o=this.contentDOM.childNodes.length);break}s=c}return{node:this.contentDOM,from:e,to:n,fromOffset:i,toOffset:o}}emptyChildAt(e){if(this.border||!this.contentDOM||!this.children.length)return!1;let n=this.children[e<0?0:this.children.length-1];return n.size==0||n.emptyChildAt(e)}domAfterPos(e){let{node:n,offset:r}=this.domFromPos(e,0);if(n.nodeType!=1||r==n.childNodes.length)throw new RangeError("No node after pos "+e);return n.childNodes[r]}setSelection(e,n,r,i=!1){let o=Math.min(e,n),s=Math.max(e,n);for(let p=0,m=0;p<this.children.length;p++){let y=this.children[p],v=m+y.size;if(o>m&&s<v)return y.setSelection(e-m-y.border,n-m-y.border,r,i);m=v}let a=this.domFromPos(e,e?-1:1),l=n==e?a:this.domFromPos(n,n?-1:1),c=r.root.getSelection(),u=r.domSelectionRange(),d=!1;if((ur||Ut)&&e==n){let{node:p,offset:m}=a;if(p.nodeType==3){if(d=!!(m&&p.nodeValue[m-1]==`
`),d&&m==p.nodeValue.length)for(let y=p,v;y;y=y.parentNode){if(v=y.nextSibling){v.nodeName=="BR"&&(a=l={node:v.parentNode,offset:mt(v)+1});break}let x=y.pmViewDesc;if(x&&x.node&&x.node.isBlock)break}}else{let y=p.childNodes[m-1];d=y&&(y.nodeName=="BR"||y.contentEditable=="false")}}if(ur&&u.focusNode&&u.focusNode!=l.node&&u.focusNode.nodeType==1){let p=u.focusNode.childNodes[u.focusOffset];p&&p.contentEditable=="false"&&(i=!0)}if(!(i||d&&Ut)&&As(a.node,a.offset,u.anchorNode,u.anchorOffset)&&As(l.node,l.offset,u.focusNode,u.focusOffset))return;let h=!1;if((c.extend||e==n)&&!d){c.collapse(a.node,a.offset);try{e!=n&&c.extend(l.node,l.offset),h=!0}catch{}}if(!h){if(e>n){let m=a;a=l,l=m}let p=document.createRange();p.setEnd(l.node,l.offset),p.setStart(a.node,a.offset),c.removeAllRanges(),c.addRange(p)}}ignoreMutation(e){return!this.contentDOM&&e.type!="selection"}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(e,n){for(let r=0,i=0;i<this.children.length;i++){let o=this.children[i],s=r+o.size;if(r==s?e<=s&&n>=r:e<s&&n>r){let a=r+o.border,l=s-o.border;if(e>=a&&n<=l){this.dirty=e==r||n==s?rs:Xb,e==a&&n==l&&(o.contentLost||o.dom.parentNode!=this.contentDOM)?o.dirty=Br:o.markDirty(e-a,n-a);return}else o.dirty=o.dom==o.contentDOM&&o.dom.parentNode==this.contentDOM&&!o.children.length?rs:Br}r=s}this.dirty=rs}markParentsDirty(){let e=1;for(let n=this.parent;n;n=n.parent,e++){let r=e==1?rs:Xb;n.dirty<r&&(n.dirty=r)}}get domAtom(){return!1}get ignoreForCoords(){return!1}isText(e){return!1}}class JT extends zu{constructor(e,n,r,i){let o,s=n.type.toDOM;if(typeof s=="function"&&(s=s(r,()=>{if(!o)return i;if(o.parent)return o.parent.posBeforeChild(o)})),!n.type.spec.raw){if(s.nodeType!=1){let a=document.createElement("span");a.appendChild(s),s=a}s.contentEditable="false",s.classList.add("ProseMirror-widget")}super(e,[],s,null),this.widget=n,this.widget=n,o=this}matchesWidget(e){return this.dirty==Fn&&e.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(e){let n=this.widget.spec.stopEvent;return n?n(e):!1}ignoreMutation(e){return e.type!="selection"||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get side(){return this.widget.type.side}}class k3 extends zu{constructor(e,n,r,i){super(e,[],n,null),this.textDOM=r,this.text=i}get size(){return this.text.length}localPosFromDOM(e,n){return e!=this.textDOM?this.posAtStart+(n?this.size:0):this.posAtStart+n}domFromPos(e){return{node:this.textDOM,offset:e}}ignoreMutation(e){return e.type==="characterData"&&e.target.nodeValue==e.oldValue}}class Ns extends zu{constructor(e,n,r,i,o){super(e,[],r,i),this.mark=n,this.spec=o}static create(e,n,r,i){let o=i.nodeViews[n.type.name],s=o&&o(n,i,r);return(!s||!s.dom)&&(s=Ws.renderSpec(document,n.type.spec.toDOM(n,r),null,n.attrs)),new Ns(e,n,s.dom,s.contentDOM||s.dom,s)}parseRule(){return this.dirty&Br||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(e){return this.dirty!=Br&&this.mark.eq(e)}markDirty(e,n){if(super.markDirty(e,n),this.dirty!=Fn){let r=this.parent;for(;!r.node;)r=r.parent;r.dirty<this.dirty&&(r.dirty=this.dirty),this.dirty=Fn}}slice(e,n,r){let i=Ns.create(this.parent,this.mark,!0,r),o=this.children,s=this.size;n<s&&(o=Ay(o,n,s,r)),e>0&&(o=Ay(o,0,e,r));for(let a=0;a<o.length;a++)o[a].parent=i;return i.children=o,i}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}}class bo extends zu{constructor(e,n,r,i,o,s,a,l,c){super(e,[],o,s),this.node=n,this.outerDeco=r,this.innerDeco=i,this.nodeDOM=a}static create(e,n,r,i,o,s){let a=o.nodeViews[n.type.name],l,c=a&&a(n,o,()=>{if(!l)return s;if(l.parent)return l.parent.posBeforeChild(l)},r,i),u=c&&c.dom,d=c&&c.contentDOM;if(n.isText){if(!u)u=document.createTextNode(n.text);else if(u.nodeType!=3)throw new RangeError("Text must be rendered as a DOM text node")}else u||({dom:u,contentDOM:d}=Ws.renderSpec(document,n.type.spec.toDOM(n),null,n.attrs));!d&&!n.isText&&u.nodeName!="BR"&&(u.hasAttribute("contenteditable")||(u.contentEditable="false"),n.type.spec.draggable&&(u.draggable=!0));let h=u;return u=ZT(u,r,n),c?l=new E3(e,n,r,i,u,d||null,h,c,o,s+1):n.isText?new Zh(e,n,r,i,u,h,o):new bo(e,n,r,i,u,d||null,h,o,s+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let e={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre"&&(e.preserveWhitespace="full"),!this.contentDOM)e.getContent=()=>this.node.content;else if(!this.contentLost)e.contentElement=this.contentDOM;else{for(let n=this.children.length-1;n>=0;n--){let r=this.children[n];if(this.dom.contains(r.dom.parentNode)){e.contentElement=r.dom.parentNode;break}}e.contentElement||(e.getContent=()=>B.empty)}return e}matchesNode(e,n,r){return this.dirty==Fn&&e.eq(this.node)&&Qf(n,this.outerDeco)&&r.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(e,n){let r=this.node.inlineContent,i=n,o=e.composing?this.localCompositionInfo(e,n):null,s=o&&o.pos>-1?o:null,a=o&&o.pos<0,l=new _3(this,s&&s.node,e);P3(this.node,this.innerDeco,(c,u,d)=>{c.spec.marks?l.syncToMarks(c.spec.marks,r,e):c.type.side>=0&&!d&&l.syncToMarks(u==this.node.childCount?Re.none:this.node.child(u).marks,r,e),l.placeWidget(c,e,i)},(c,u,d,h)=>{l.syncToMarks(c.marks,r,e);let p;l.findNodeMatch(c,u,d,h)||a&&e.state.selection.from>i&&e.state.selection.to<i+c.nodeSize&&(p=l.findIndexWithChild(o.node))>-1&&l.updateNodeAt(c,u,d,p,e)||l.updateNextNode(c,u,d,e,h,i)||l.addNode(c,u,d,e,i),i+=c.nodeSize}),l.syncToMarks([],r,e),this.node.isTextblock&&l.addTextblockHacks(),l.destroyRest(),(l.changed||this.dirty==rs)&&(s&&this.protectLocalComposition(e,s),QT(this.contentDOM,this.children,e),hl&&M3(this.dom))}localCompositionInfo(e,n){let{from:r,to:i}=e.state.selection;if(!(e.state.selection instanceof ie)||r<n||i>n+this.node.content.size)return null;let o=e.input.compositionNode;if(!o||!this.dom.contains(o.parentNode))return null;if(this.node.inlineContent){let s=o.nodeValue,a=I3(this.node.content,s,r-n,i-n);return a<0?null:{node:o,pos:a,text:s}}else return{node:o,pos:-1,text:""}}protectLocalComposition(e,{node:n,pos:r,text:i}){if(this.getDesc(n))return;let o=n;for(;o.parentNode!=this.contentDOM;o=o.parentNode){for(;o.previousSibling;)o.parentNode.removeChild(o.previousSibling);for(;o.nextSibling;)o.parentNode.removeChild(o.nextSibling);o.pmViewDesc&&(o.pmViewDesc=void 0)}let s=new k3(this,o,n,i);e.input.compositionNodes.push(s),this.children=Ay(this.children,r,r+i.length,e,s)}update(e,n,r,i){return this.dirty==Br||!e.sameMarkup(this.node)?!1:(this.updateInner(e,n,r,i),!0)}updateInner(e,n,r,i){this.updateOuterDeco(n),this.node=e,this.innerDeco=r,this.contentDOM&&this.updateChildren(i,this.posAtStart),this.dirty=Fn}updateOuterDeco(e){if(Qf(e,this.outerDeco))return;let n=this.nodeDOM.nodeType!=1,r=this.dom;this.dom=XT(this.dom,this.nodeDOM,Iy(this.outerDeco,this.node,n),Iy(e,this.node,n)),this.dom!=r&&(r.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=e}selectNode(){this.nodeDOM.nodeType==1&&this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.dom.draggable=!0)}deselectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.dom.removeAttribute("draggable"))}get domAtom(){return this.node.isAtom}}function Zb(t,e,n,r,i){ZT(r,e,t);let o=new bo(void 0,t,e,n,r,r,r,i,0);return o.contentDOM&&o.updateChildren(i,0),o}class Zh extends bo{constructor(e,n,r,i,o,s,a){super(e,n,r,i,o,null,s,a,0)}parseRule(){let e=this.nodeDOM.parentNode;for(;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}}update(e,n,r,i){return this.dirty==Br||this.dirty!=Fn&&!this.inParent()||!e.sameMarkup(this.node)?!1:(this.updateOuterDeco(n),(this.dirty!=Fn||e.text!=this.node.text)&&e.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=e.text,i.trackWrites==this.nodeDOM&&(i.trackWrites=null)),this.node=e,this.dirty=Fn,!0)}inParent(){let e=this.parent.contentDOM;for(let n=this.nodeDOM;n;n=n.parentNode)if(n==e)return!0;return!1}domFromPos(e){return{node:this.nodeDOM,offset:e}}localPosFromDOM(e,n,r){return e==this.nodeDOM?this.posAtStart+Math.min(n,this.node.text.length):super.localPosFromDOM(e,n,r)}ignoreMutation(e){return e.type!="characterData"&&e.type!="selection"}slice(e,n,r){let i=this.node.cut(e,n),o=document.createTextNode(i.text);return new Zh(this.parent,i,this.outerDeco,this.innerDeco,o,o,r)}markDirty(e,n){super.markDirty(e,n),this.dom!=this.nodeDOM&&(e==0||n==this.nodeDOM.nodeValue.length)&&(this.dirty=Br)}get domAtom(){return!1}isText(e){return this.node.text==e}}class YT extends zu{parseRule(){return{ignore:!0}}matchesHack(e){return this.dirty==Fn&&this.dom.nodeName==e}get domAtom(){return!0}get ignoreForCoords(){return this.dom.nodeName=="IMG"}}class E3 extends bo{constructor(e,n,r,i,o,s,a,l,c,u){super(e,n,r,i,o,s,a,c,u),this.spec=l}update(e,n,r,i){if(this.dirty==Br)return!1;if(this.spec.update&&(this.node.type==e.type||this.spec.multiType)){let o=this.spec.update(e,n,r);return o&&this.updateInner(e,n,r,i),o}else return!this.contentDOM&&!e.isLeaf?!1:super.update(e,n,r,i)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(e,n,r,i){this.spec.setSelection?this.spec.setSelection(e,n,r.root):super.setSelection(e,n,r,i)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(e){return this.spec.stopEvent?this.spec.stopEvent(e):!1}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}}function QT(t,e,n){let r=t.firstChild,i=!1;for(let o=0;o<e.length;o++){let s=e[o],a=s.dom;if(a.parentNode==t){for(;a!=r;)r=e1(r),i=!0;r=r.nextSibling}else i=!0,t.insertBefore(a,r);if(s instanceof Ns){let l=r?r.previousSibling:t.lastChild;QT(s.contentDOM,s.children,n),r=l?l.nextSibling:t.firstChild}}for(;r;)r=e1(r),i=!0;i&&n.trackWrites==t&&(n.trackWrites=null)}const Rc=function(t){t&&(this.nodeName=t)};Rc.prototype=Object.create(null);const is=[new Rc];function Iy(t,e,n){if(t.length==0)return is;let r=n?is[0]:new Rc,i=[r];for(let o=0;o<t.length;o++){let s=t[o].type.attrs;if(s){s.nodeName&&i.push(r=new Rc(s.nodeName));for(let a in s){let l=s[a];l!=null&&(n&&i.length==1&&i.push(r=new Rc(e.isInline?"span":"div")),a=="class"?r.class=(r.class?r.class+" ":"")+l:a=="style"?r.style=(r.style?r.style+";":"")+l:a!="nodeName"&&(r[a]=l))}}}return i}function XT(t,e,n,r){if(n==is&&r==is)return e;let i=e;for(let o=0;o<r.length;o++){let s=r[o],a=n[o];if(o){let l;a&&a.nodeName==s.nodeName&&i!=t&&(l=i.parentNode)&&l.nodeName.toLowerCase()==s.nodeName||(l=document.createElement(s.nodeName),l.pmIsDeco=!0,l.appendChild(i),a=is[0]),i=l}T3(i,a||is[0],s)}return i}function T3(t,e,n){for(let r in e)r!="class"&&r!="style"&&r!="nodeName"&&!(r in n)&&t.removeAttribute(r);for(let r in n)r!="class"&&r!="style"&&r!="nodeName"&&n[r]!=e[r]&&t.setAttribute(r,n[r]);if(e.class!=n.class){let r=e.class?e.class.split(" ").filter(Boolean):[],i=n.class?n.class.split(" ").filter(Boolean):[];for(let o=0;o<r.length;o++)i.indexOf(r[o])==-1&&t.classList.remove(r[o]);for(let o=0;o<i.length;o++)r.indexOf(i[o])==-1&&t.classList.add(i[o]);t.classList.length==0&&t.removeAttribute("class")}if(e.style!=n.style){if(e.style){let r=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,i;for(;i=r.exec(e.style);)t.style.removeProperty(i[1])}n.style&&(t.style.cssText+=n.style)}}function ZT(t,e,n){return XT(t,t,is,Iy(e,n,t.nodeType!=1))}function Qf(t,e){if(t.length!=e.length)return!1;for(let n=0;n<t.length;n++)if(!t[n].type.eq(e[n].type))return!1;return!0}function e1(t){let e=t.nextSibling;return t.parentNode.removeChild(t),e}class _3{constructor(e,n,r){this.lock=n,this.view=r,this.index=0,this.stack=[],this.changed=!1,this.top=e,this.preMatch=R3(e.node.content,e)}destroyBetween(e,n){if(e!=n){for(let r=e;r<n;r++)this.top.children[r].destroy();this.top.children.splice(e,n-e),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(e,n,r){let i=0,o=this.stack.length>>1,s=Math.min(o,e.length);for(;i<s&&(i==o-1?this.top:this.stack[i+1<<1]).matchesMark(e[i])&&e[i].type.spec.spanning!==!1;)i++;for(;i<o;)this.destroyRest(),this.top.dirty=Fn,this.index=this.stack.pop(),this.top=this.stack.pop(),o--;for(;o<e.length;){this.stack.push(this.top,this.index+1);let a=-1;for(let l=this.index;l<Math.min(this.index+3,this.top.children.length);l++){let c=this.top.children[l];if(c.matchesMark(e[o])&&!this.isLocked(c.dom)){a=l;break}}if(a>-1)a>this.index&&(this.changed=!0,this.destroyBetween(this.index,a)),this.top=this.top.children[this.index];else{let l=Ns.create(this.top,e[o],n,r);this.top.children.splice(this.index,0,l),this.top=l,this.changed=!0}this.index=0,o++}}findNodeMatch(e,n,r,i){let o=-1,s;if(i>=this.preMatch.index&&(s=this.preMatch.matches[i-this.preMatch.index]).parent==this.top&&s.matchesNode(e,n,r))o=this.top.children.indexOf(s,this.index);else for(let a=this.index,l=Math.min(this.top.children.length,a+5);a<l;a++){let c=this.top.children[a];if(c.matchesNode(e,n,r)&&!this.preMatch.matched.has(c)){o=a;break}}return o<0?!1:(this.destroyBetween(this.index,o),this.index++,!0)}updateNodeAt(e,n,r,i,o){let s=this.top.children[i];return s.dirty==Br&&s.dom==s.contentDOM&&(s.dirty=rs),s.update(e,n,r,o)?(this.destroyBetween(this.index,i),this.index++,!0):!1}findIndexWithChild(e){for(;;){let n=e.parentNode;if(!n)return-1;if(n==this.top.contentDOM){let r=e.pmViewDesc;if(r){for(let i=this.index;i<this.top.children.length;i++)if(this.top.children[i]==r)return i}return-1}e=n}}updateNextNode(e,n,r,i,o,s){for(let a=this.index;a<this.top.children.length;a++){let l=this.top.children[a];if(l instanceof bo){let c=this.preMatch.matched.get(l);if(c!=null&&c!=o)return!1;let u=l.dom,d,h=this.isLocked(u)&&!(e.isText&&l.node&&l.node.isText&&l.nodeDOM.nodeValue==e.text&&l.dirty!=Br&&Qf(n,l.outerDeco));if(!h&&l.update(e,n,r,i))return this.destroyBetween(this.index,a),l.dom!=u&&(this.changed=!0),this.index++,!0;if(!h&&(d=this.recreateWrapper(l,e,n,r,i,s)))return this.destroyBetween(this.index,a),this.top.children[this.index]=d,d.contentDOM&&(d.dirty=rs,d.updateChildren(i,s+1),d.dirty=Fn),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(e,n,r,i,o,s){if(e.dirty||n.isAtom||!e.children.length||!e.node.content.eq(n.content)||!Qf(r,e.outerDeco)||!i.eq(e.innerDeco))return null;let a=bo.create(this.top,n,r,i,o,s);if(a.contentDOM){a.children=e.children,e.children=[];for(let l of a.children)l.parent=a}return e.destroy(),a}addNode(e,n,r,i,o){let s=bo.create(this.top,e,n,r,i,o);s.contentDOM&&s.updateChildren(i,o+1),this.top.children.splice(this.index++,0,s),this.changed=!0}placeWidget(e,n,r){let i=this.index<this.top.children.length?this.top.children[this.index]:null;if(i&&i.matchesWidget(e)&&(e==i.widget||!i.widget.type.toDOM.parentNode))this.index++;else{let o=new JT(this.top,e,n,r);this.top.children.splice(this.index++,0,o),this.changed=!0}}addTextblockHacks(){let e=this.top.children[this.index-1],n=this.top;for(;e instanceof Ns;)n=e,e=n.children[n.children.length-1];(!e||!(e instanceof Zh)||/\n$/.test(e.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(e.node.text))&&((Ut||_t)&&e&&e.dom.contentEditable=="false"&&this.addHackNode("IMG",n),this.addHackNode("BR",this.top))}addHackNode(e,n){if(n==this.top&&this.index<n.children.length&&n.children[this.index].matchesHack(e))this.index++;else{let r=document.createElement(e);e=="IMG"&&(r.className="ProseMirror-separator",r.alt=""),e=="BR"&&(r.className="ProseMirror-trailingBreak");let i=new YT(this.top,[],r,null);n!=this.top?n.children.push(i):n.children.splice(this.index++,0,i),this.changed=!0}}isLocked(e){return this.lock&&(e==this.lock||e.nodeType==1&&e.contains(this.lock.parentNode))}}function R3(t,e){let n=e,r=n.children.length,i=t.childCount,o=new Map,s=[];e:for(;i>0;){let a;for(;;)if(r){let c=n.children[r-1];if(c instanceof Ns)n=c,r=c.children.length;else{a=c,r--;break}}else{if(n==e)break e;r=n.parent.children.indexOf(n),n=n.parent}let l=a.node;if(l){if(l!=t.child(i-1))break;--i,o.set(a,i),s.push(a)}}return{index:i,matched:o,matches:s.reverse()}}function O3(t,e){return t.type.side-e.type.side}function P3(t,e,n,r){let i=e.locals(t),o=0;if(i.length==0){for(let c=0;c<t.childCount;c++){let u=t.child(c);r(u,i,e.forChild(o,u),c),o+=u.nodeSize}return}let s=0,a=[],l=null;for(let c=0;;){let u,d;for(;s<i.length&&i[s].to==o;){let v=i[s++];v.widget&&(u?(d||(d=[u])).push(v):u=v)}if(u)if(d){d.sort(O3);for(let v=0;v<d.length;v++)n(d[v],c,!!l)}else n(u,c,!!l);let h,p;if(l)p=-1,h=l,l=null;else if(c<t.childCount)p=c,h=t.child(c++);else break;for(let v=0;v<a.length;v++)a[v].to<=o&&a.splice(v--,1);for(;s<i.length&&i[s].from<=o&&i[s].to>o;)a.push(i[s++]);let m=o+h.nodeSize;if(h.isText){let v=m;s<i.length&&i[s].from<v&&(v=i[s].from);for(let x=0;x<a.length;x++)a[x].to<v&&(v=a[x].to);v<m&&(l=h.cut(v-o),h=h.cut(0,v-o),m=v,p=-1)}else for(;s<i.length&&i[s].to<m;)s++;let y=h.isInline&&!h.isLeaf?a.filter(v=>!v.inline):a.slice();r(h,y,e.forChild(o,h),p),o=m}}function M3(t){if(t.nodeName=="UL"||t.nodeName=="OL"){let e=t.style.cssText;t.style.cssText=e+"; list-style: square !important",window.getComputedStyle(t).listStyle,t.style.cssText=e}}function I3(t,e,n,r){for(let i=0,o=0;i<t.childCount&&o<=r;){let s=t.child(i++),a=o;if(o+=s.nodeSize,!s.isText)continue;let l=s.text;for(;i<t.childCount;){let c=t.child(i++);if(o+=c.nodeSize,!c.isText)break;l+=c.text}if(o>=n){if(o>=r&&l.slice(r-e.length-a,r-a)==e)return r-e.length;let c=a<r?l.lastIndexOf(e,r-a-1):-1;if(c>=0&&c+e.length+a>=n)return a+c;if(n==r&&l.length>=r+e.length-a&&l.slice(r-a,r-a+e.length)==e)return r}}return-1}function Ay(t,e,n,r,i){let o=[];for(let s=0,a=0;s<t.length;s++){let l=t[s],c=a,u=a+=l.size;c>=n||u<=e?o.push(l):(c<e&&o.push(l.slice(0,e-c,r)),i&&(o.push(i),i=void 0),u>n&&o.push(l.slice(n-c,l.size,r)))}return o}function j0(t,e=null){let n=t.domSelectionRange(),r=t.state.doc;if(!n.focusNode)return null;let i=t.docView.nearestDesc(n.focusNode),o=i&&i.size==0,s=t.docView.posFromDOM(n.focusNode,n.focusOffset,1);if(s<0)return null;let a=r.resolve(s),l,c;if(Xh(n)){for(l=s;i&&!i.node;)i=i.parent;let d=i.node;if(i&&d.isAtom&&te.isSelectable(d)&&i.parent&&!(d.isInline&&i3(n.focusNode,n.focusOffset,i.dom))){let h=i.posBefore;c=new te(s==h?a:r.resolve(h))}}else{if(n instanceof t.dom.ownerDocument.defaultView.Selection&&n.rangeCount>1){let d=s,h=s;for(let p=0;p<n.rangeCount;p++){let m=n.getRangeAt(p);d=Math.min(d,t.docView.posFromDOM(m.startContainer,m.startOffset,1)),h=Math.max(h,t.docView.posFromDOM(m.endContainer,m.endOffset,-1))}if(d<0)return null;[l,s]=h==t.state.selection.anchor?[h,d]:[d,h],a=r.resolve(s)}else l=t.docView.posFromDOM(n.anchorNode,n.anchorOffset,1);if(l<0)return null}let u=r.resolve(l);if(!c){let d=e=="pointer"||t.state.selection.head<a.pos&&!o?1:-1;c=L0(t,u,a,d)}return c}function e_(t){return t.editable?t.hasFocus():n_(t)&&document.activeElement&&document.activeElement.contains(t.dom)}function ai(t,e=!1){let n=t.state.selection;if(t_(t,n),!!e_(t)){if(!e&&t.input.mouseDown&&t.input.mouseDown.allowDefault&&_t){let r=t.domSelectionRange(),i=t.domObserver.currentSelection;if(r.anchorNode&&i.anchorNode&&As(r.anchorNode,r.anchorOffset,i.anchorNode,i.anchorOffset)){t.input.mouseDown.delayedSelectionSync=!0,t.domObserver.setCurSelection();return}}if(t.domObserver.disconnectSelection(),t.cursorWrapper)N3(t);else{let{anchor:r,head:i}=n,o,s;t1&&!(n instanceof ie)&&(n.$from.parent.inlineContent||(o=n1(t,n.from)),!n.empty&&!n.$from.parent.inlineContent&&(s=n1(t,n.to))),t.docView.setSelection(r,i,t,e),t1&&(o&&r1(o),s&&r1(s)),n.visible?t.dom.classList.remove("ProseMirror-hideselection"):(t.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&A3(t))}t.domObserver.setCurSelection(),t.domObserver.connectSelection()}}const t1=Ut||_t&&VT<63;function n1(t,e){let{node:n,offset:r}=t.docView.domFromPos(e,0),i=r<n.childNodes.length?n.childNodes[r]:null,o=r?n.childNodes[r-1]:null;if(Ut&&i&&i.contentEditable=="false")return km(i);if((!i||i.contentEditable=="false")&&(!o||o.contentEditable=="false")){if(i)return km(i);if(o)return km(o)}}function km(t){return t.contentEditable="true",Ut&&t.draggable&&(t.draggable=!1,t.wasDraggable=!0),t}function r1(t){t.contentEditable="false",t.wasDraggable&&(t.draggable=!0,t.wasDraggable=null)}function A3(t){let e=t.dom.ownerDocument;e.removeEventListener("selectionchange",t.input.hideSelectionGuard);let n=t.domSelectionRange(),r=n.anchorNode,i=n.anchorOffset;e.addEventListener("selectionchange",t.input.hideSelectionGuard=()=>{(n.anchorNode!=r||n.anchorOffset!=i)&&(e.removeEventListener("selectionchange",t.input.hideSelectionGuard),setTimeout(()=>{(!e_(t)||t.state.selection.visible)&&t.dom.classList.remove("ProseMirror-hideselection")},20))})}function N3(t){let e=t.domSelection(),n=document.createRange();if(!e)return;let r=t.cursorWrapper.dom,i=r.nodeName=="IMG";i?n.setStart(r.parentNode,mt(r)+1):n.setStart(r,0),n.collapse(!0),e.removeAllRanges(),e.addRange(n),!i&&!t.state.selection.visible&&dn&&wo<=11&&(r.disabled=!0,r.disabled=!1)}function t_(t,e){if(e instanceof te){let n=t.docView.descAt(e.from);n!=t.lastSelectedViewDesc&&(i1(t),n&&n.selectNode(),t.lastSelectedViewDesc=n)}else i1(t)}function i1(t){t.lastSelectedViewDesc&&(t.lastSelectedViewDesc.parent&&t.lastSelectedViewDesc.deselectNode(),t.lastSelectedViewDesc=void 0)}function L0(t,e,n,r){return t.someProp("createSelectionBetween",i=>i(t,e,n))||ie.between(e,n,r)}function o1(t){return t.editable&&!t.hasFocus()?!1:n_(t)}function n_(t){let e=t.domSelectionRange();if(!e.anchorNode)return!1;try{return t.dom.contains(e.anchorNode.nodeType==3?e.anchorNode.parentNode:e.anchorNode)&&(t.editable||t.dom.contains(e.focusNode.nodeType==3?e.focusNode.parentNode:e.focusNode))}catch{return!1}}function D3(t){let e=t.docView.domFromPos(t.state.selection.anchor,0),n=t.domSelectionRange();return As(e.node,e.offset,n.anchorNode,n.anchorOffset)}function Ny(t,e){let{$anchor:n,$head:r}=t.selection,i=e>0?n.max(r):n.min(r),o=i.parent.inlineContent?i.depth?t.doc.resolve(e>0?i.after():i.before()):null:i;return o&&oe.findFrom(o,e)}function Ii(t,e){return t.dispatch(t.state.tr.setSelection(e).scrollIntoView()),!0}function s1(t,e,n){let r=t.state.selection;if(r instanceof ie)if(n.indexOf("s")>-1){let{$head:i}=r,o=i.textOffset?null:e<0?i.nodeBefore:i.nodeAfter;if(!o||o.isText||!o.isLeaf)return!1;let s=t.state.doc.resolve(i.pos+o.nodeSize*(e<0?-1:1));return Ii(t,new ie(r.$anchor,s))}else if(r.empty){if(t.endOfTextblock(e>0?"forward":"backward")){let i=Ny(t.state,e);return i&&i instanceof te?Ii(t,i):!1}else if(!(In&&n.indexOf("m")>-1)){let i=r.$head,o=i.textOffset?null:e<0?i.nodeBefore:i.nodeAfter,s;if(!o||o.isText)return!1;let a=e<0?i.pos-o.nodeSize:i.pos;return o.isAtom||(s=t.docView.descAt(a))&&!s.contentDOM?te.isSelectable(o)?Ii(t,new te(e<0?t.state.doc.resolve(i.pos-o.nodeSize):i)):Bu?Ii(t,new ie(t.state.doc.resolve(e<0?a:a+o.nodeSize))):!1:!1}}else return!1;else{if(r instanceof te&&r.node.isInline)return Ii(t,new ie(e>0?r.$to:r.$from));{let i=Ny(t.state,e);return i?Ii(t,i):!1}}}function Xf(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function Oc(t,e){let n=t.pmViewDesc;return n&&n.size==0&&(e<0||t.nextSibling||t.nodeName!="BR")}function na(t,e){return e<0?j3(t):L3(t)}function j3(t){let e=t.domSelectionRange(),n=e.focusNode,r=e.focusOffset;if(!n)return;let i,o,s=!1;for(ur&&n.nodeType==1&&r<Xf(n)&&Oc(n.childNodes[r],-1)&&(s=!0);;)if(r>0){if(n.nodeType!=1)break;{let a=n.childNodes[r-1];if(Oc(a,-1))i=n,o=--r;else if(a.nodeType==3)n=a,r=n.nodeValue.length;else break}}else{if(r_(n))break;{let a=n.previousSibling;for(;a&&Oc(a,-1);)i=n.parentNode,o=mt(a),a=a.previousSibling;if(a)n=a,r=Xf(n);else{if(n=n.parentNode,n==t.dom)break;r=0}}}s?Dy(t,n,r):i&&Dy(t,i,o)}function L3(t){let e=t.domSelectionRange(),n=e.focusNode,r=e.focusOffset;if(!n)return;let i=Xf(n),o,s;for(;;)if(r<i){if(n.nodeType!=1)break;let a=n.childNodes[r];if(Oc(a,1))o=n,s=++r;else break}else{if(r_(n))break;{let a=n.nextSibling;for(;a&&Oc(a,1);)o=a.parentNode,s=mt(a)+1,a=a.nextSibling;if(a)n=a,r=0,i=Xf(n);else{if(n=n.parentNode,n==t.dom)break;r=i=0}}}o&&Dy(t,o,s)}function r_(t){let e=t.pmViewDesc;return e&&e.node&&e.node.isBlock}function $3(t,e){for(;t&&e==t.childNodes.length&&!Fu(t);)e=mt(t)+1,t=t.parentNode;for(;t&&e<t.childNodes.length;){let n=t.childNodes[e];if(n.nodeType==3)return n;if(n.nodeType==1&&n.contentEditable=="false")break;t=n,e=0}}function F3(t,e){for(;t&&!e&&!Fu(t);)e=mt(t),t=t.parentNode;for(;t&&e;){let n=t.childNodes[e-1];if(n.nodeType==3)return n;if(n.nodeType==1&&n.contentEditable=="false")break;t=n,e=t.childNodes.length}}function Dy(t,e,n){if(e.nodeType!=3){let o,s;(s=$3(e,n))?(e=s,n=0):(o=F3(e,n))&&(e=o,n=o.nodeValue.length)}let r=t.domSelection();if(!r)return;if(Xh(r)){let o=document.createRange();o.setEnd(e,n),o.setStart(e,n),r.removeAllRanges(),r.addRange(o)}else r.extend&&r.extend(e,n);t.domObserver.setCurSelection();let{state:i}=t;setTimeout(()=>{t.state==i&&ai(t)},50)}function a1(t,e){let n=t.state.doc.resolve(e);if(!(_t||a3)&&n.parent.inlineContent){let i=t.coordsAtPos(e);if(e>n.start()){let o=t.coordsAtPos(e-1),s=(o.top+o.bottom)/2;if(s>i.top&&s<i.bottom&&Math.abs(o.left-i.left)>1)return o.left<i.left?"ltr":"rtl"}if(e<n.end()){let o=t.coordsAtPos(e+1),s=(o.top+o.bottom)/2;if(s>i.top&&s<i.bottom&&Math.abs(o.left-i.left)>1)return o.left>i.left?"ltr":"rtl"}}return getComputedStyle(t.dom).direction=="rtl"?"rtl":"ltr"}function l1(t,e,n){let r=t.state.selection;if(r instanceof ie&&!r.empty||n.indexOf("s")>-1||In&&n.indexOf("m")>-1)return!1;let{$from:i,$to:o}=r;if(!i.parent.inlineContent||t.endOfTextblock(e<0?"up":"down")){let s=Ny(t.state,e);if(s&&s instanceof te)return Ii(t,s)}if(!i.parent.inlineContent){let s=e<0?i:o,a=r instanceof $n?oe.near(s,e):oe.findFrom(s,e);return a?Ii(t,a):!1}return!1}function c1(t,e){if(!(t.state.selection instanceof ie))return!0;let{$head:n,$anchor:r,empty:i}=t.state.selection;if(!n.sameParent(r))return!0;if(!i)return!1;if(t.endOfTextblock(e>0?"forward":"backward"))return!0;let o=!n.textOffset&&(e<0?n.nodeBefore:n.nodeAfter);if(o&&!o.isText){let s=t.state.tr;return e<0?s.delete(n.pos-o.nodeSize,n.pos):s.delete(n.pos,n.pos+o.nodeSize),t.dispatch(s),!0}return!1}function u1(t,e,n){t.domObserver.stop(),e.contentEditable=n,t.domObserver.start()}function B3(t){if(!Ut||t.state.selection.$head.parentOffset>0)return!1;let{focusNode:e,focusOffset:n}=t.domSelectionRange();if(e&&e.nodeType==1&&n==0&&e.firstChild&&e.firstChild.contentEditable=="false"){let r=e.firstChild;u1(t,r,"true"),setTimeout(()=>u1(t,r,"false"),20)}return!1}function z3(t){let e="";return t.ctrlKey&&(e+="c"),t.metaKey&&(e+="m"),t.altKey&&(e+="a"),t.shiftKey&&(e+="s"),e}function V3(t,e){let n=e.keyCode,r=z3(e);if(n==8||In&&n==72&&r=="c")return c1(t,-1)||na(t,-1);if(n==46&&!e.shiftKey||In&&n==68&&r=="c")return c1(t,1)||na(t,1);if(n==13||n==27)return!0;if(n==37||In&&n==66&&r=="c"){let i=n==37?a1(t,t.state.selection.from)=="ltr"?-1:1:-1;return s1(t,i,r)||na(t,i)}else if(n==39||In&&n==70&&r=="c"){let i=n==39?a1(t,t.state.selection.from)=="ltr"?1:-1:1;return s1(t,i,r)||na(t,i)}else{if(n==38||In&&n==80&&r=="c")return l1(t,-1,r)||na(t,-1);if(n==40||In&&n==78&&r=="c")return B3(t)||l1(t,1,r)||na(t,1);if(r==(In?"m":"c")&&(n==66||n==73||n==89||n==90))return!0}return!1}function $0(t,e){t.someProp("transformCopied",p=>{e=p(e,t)});let n=[],{content:r,openStart:i,openEnd:o}=e;for(;i>1&&o>1&&r.childCount==1&&r.firstChild.childCount==1;){i--,o--;let p=r.firstChild;n.push(p.type.name,p.attrs!=p.type.defaultAttrs?p.attrs:null),r=p.content}let s=t.someProp("clipboardSerializer")||Ws.fromSchema(t.state.schema),a=c_(),l=a.createElement("div");l.appendChild(s.serializeFragment(r,{document:a}));let c=l.firstChild,u,d=0;for(;c&&c.nodeType==1&&(u=l_[c.nodeName.toLowerCase()]);){for(let p=u.length-1;p>=0;p--){let m=a.createElement(u[p]);for(;l.firstChild;)m.appendChild(l.firstChild);l.appendChild(m),d++}c=l.firstChild}c&&c.nodeType==1&&c.setAttribute("data-pm-slice",`${i} ${o}${d?` -${d}`:""} ${JSON.stringify(n)}`);let h=t.someProp("clipboardTextSerializer",p=>p(e,t))||e.content.textBetween(0,e.content.size,`

`);return{dom:l,text:h,slice:e}}function i_(t,e,n,r,i){let o=i.parent.type.spec.code,s,a;if(!n&&!e)return null;let l=e&&(r||o||!n);if(l){if(t.someProp("transformPastedText",h=>{e=h(e,o||r,t)}),o)return e?new W(B.from(t.state.schema.text(e.replace(/\r\n?/g,`
`))),0,0):W.empty;let d=t.someProp("clipboardTextParser",h=>h(e,i,r,t));if(d)a=d;else{let h=i.marks(),{schema:p}=t.state,m=Ws.fromSchema(p);s=document.createElement("div"),e.split(/(?:\r\n?|\n)+/).forEach(y=>{let v=s.appendChild(document.createElement("p"));y&&v.appendChild(m.serializeNode(p.text(y,h)))})}}else t.someProp("transformPastedHTML",d=>{n=d(n,t)}),s=K3(n),Bu&&q3(s);let c=s&&s.querySelector("[data-pm-slice]"),u=c&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(c.getAttribute("data-pm-slice")||"");if(u&&u[3])for(let d=+u[3];d>0;d--){let h=s.firstChild;for(;h&&h.nodeType!=1;)h=h.nextSibling;if(!h)break;s=h}if(a||(a=(t.someProp("clipboardParser")||t.someProp("domParser")||xo.fromSchema(t.state.schema)).parseSlice(s,{preserveWhitespace:!!(l||u),context:i,ruleFromNode(h){return h.nodeName=="BR"&&!h.nextSibling&&h.parentNode&&!U3.test(h.parentNode.nodeName)?{ignore:!0}:null}})),u)a=G3(d1(a,+u[1],+u[2]),u[4]);else if(a=W.maxOpen(H3(a.content,i),!0),a.openStart||a.openEnd){let d=0,h=0;for(let p=a.content.firstChild;d<a.openStart&&!p.type.spec.isolating;d++,p=p.firstChild);for(let p=a.content.lastChild;h<a.openEnd&&!p.type.spec.isolating;h++,p=p.lastChild);a=d1(a,d,h)}return t.someProp("transformPasted",d=>{a=d(a,t)}),a}const U3=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function H3(t,e){if(t.childCount<2)return t;for(let n=e.depth;n>=0;n--){let i=e.node(n).contentMatchAt(e.index(n)),o,s=[];if(t.forEach(a=>{if(!s)return;let l=i.findWrapping(a.type),c;if(!l)return s=null;if(c=s.length&&o.length&&s_(l,o,a,s[s.length-1],0))s[s.length-1]=c;else{s.length&&(s[s.length-1]=a_(s[s.length-1],o.length));let u=o_(a,l);s.push(u),i=i.matchType(u.type),o=l}}),s)return B.from(s)}return t}function o_(t,e,n=0){for(let r=e.length-1;r>=n;r--)t=e[r].create(null,B.from(t));return t}function s_(t,e,n,r,i){if(i<t.length&&i<e.length&&t[i]==e[i]){let o=s_(t,e,n,r.lastChild,i+1);if(o)return r.copy(r.content.replaceChild(r.childCount-1,o));if(r.contentMatchAt(r.childCount).matchType(i==t.length-1?n.type:t[i+1]))return r.copy(r.content.append(B.from(o_(n,t,i+1))))}}function a_(t,e){if(e==0)return t;let n=t.content.replaceChild(t.childCount-1,a_(t.lastChild,e-1)),r=t.contentMatchAt(t.childCount).fillBefore(B.empty,!0);return t.copy(n.append(r))}function jy(t,e,n,r,i,o){let s=e<0?t.firstChild:t.lastChild,a=s.content;return t.childCount>1&&(o=0),i<r-1&&(a=jy(a,e,n,r,i+1,o)),i>=n&&(a=e<0?s.contentMatchAt(0).fillBefore(a,o<=i).append(a):a.append(s.contentMatchAt(s.childCount).fillBefore(B.empty,!0))),t.replaceChild(e<0?0:t.childCount-1,s.copy(a))}function d1(t,e,n){return e<t.openStart&&(t=new W(jy(t.content,-1,e,t.openStart,0,t.openEnd),e,t.openEnd)),n<t.openEnd&&(t=new W(jy(t.content,1,n,t.openEnd,0,0),t.openStart,n)),t}const l_={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let f1=null;function c_(){return f1||(f1=document.implementation.createHTMLDocument("title"))}let Em=null;function W3(t){let e=window.trustedTypes;return e?(Em||(Em=e.createPolicy("ProseMirrorClipboard",{createHTML:n=>n})),Em.createHTML(t)):t}function K3(t){let e=/^(\s*<meta [^>]*>)*/.exec(t);e&&(t=t.slice(e[0].length));let n=c_().createElement("div"),r=/<([a-z][^>\s]+)/i.exec(t),i;if((i=r&&l_[r[1].toLowerCase()])&&(t=i.map(o=>"<"+o+">").join("")+t+i.map(o=>"</"+o+">").reverse().join("")),n.innerHTML=W3(t),i)for(let o=0;o<i.length;o++)n=n.querySelector(i[o])||n;return n}function q3(t){let e=t.querySelectorAll(_t?"span:not([class]):not([style])":"span.Apple-converted-space");for(let n=0;n<e.length;n++){let r=e[n];r.childNodes.length==1&&r.textContent==" "&&r.parentNode&&r.parentNode.replaceChild(t.ownerDocument.createTextNode(" "),r)}}function G3(t,e){if(!t.size)return t;let n=t.content.firstChild.type.schema,r;try{r=JSON.parse(e)}catch{return t}let{content:i,openStart:o,openEnd:s}=t;for(let a=r.length-2;a>=0;a-=2){let l=n.nodes[r[a]];if(!l||l.hasRequiredAttrs())break;i=B.from(l.create(r[a+1],i)),o++,s++}return new W(i,o,s)}const Ht={},Wt={},J3={touchstart:!0,touchmove:!0};class Y3{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:""},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastChromeDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function Q3(t){for(let e in Ht){let n=Ht[e];t.dom.addEventListener(e,t.input.eventHandlers[e]=r=>{Z3(t,r)&&!F0(t,r)&&(t.editable||!(r.type in Wt))&&n(t,r)},J3[e]?{passive:!0}:void 0)}Ut&&t.dom.addEventListener("input",()=>null),Ly(t)}function ao(t,e){t.input.lastSelectionOrigin=e,t.input.lastSelectionTime=Date.now()}function X3(t){t.domObserver.stop();for(let e in t.input.eventHandlers)t.dom.removeEventListener(e,t.input.eventHandlers[e]);clearTimeout(t.input.composingTimeout),clearTimeout(t.input.lastIOSEnterFallbackTimeout)}function Ly(t){t.someProp("handleDOMEvents",e=>{for(let n in e)t.input.eventHandlers[n]||t.dom.addEventListener(n,t.input.eventHandlers[n]=r=>F0(t,r))})}function F0(t,e){return t.someProp("handleDOMEvents",n=>{let r=n[e.type];return r?r(t,e)||e.defaultPrevented:!1})}function Z3(t,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let n=e.target;n!=t.dom;n=n.parentNode)if(!n||n.nodeType==11||n.pmViewDesc&&n.pmViewDesc.stopEvent(e))return!1;return!0}function e$(t,e){!F0(t,e)&&Ht[e.type]&&(t.editable||!(e.type in Wt))&&Ht[e.type](t,e)}Wt.keydown=(t,e)=>{let n=e;if(t.input.shiftKey=n.keyCode==16||n.shiftKey,!d_(t,n)&&(t.input.lastKeyCode=n.keyCode,t.input.lastKeyCodeTime=Date.now(),!(ri&&_t&&n.keyCode==13)))if(n.keyCode!=229&&t.domObserver.forceFlush(),hl&&n.keyCode==13&&!n.ctrlKey&&!n.altKey&&!n.metaKey){let r=Date.now();t.input.lastIOSEnter=r,t.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{t.input.lastIOSEnter==r&&(t.someProp("handleKeyDown",i=>i(t,Qo(13,"Enter"))),t.input.lastIOSEnter=0)},200)}else t.someProp("handleKeyDown",r=>r(t,n))||V3(t,n)?n.preventDefault():ao(t,"key")};Wt.keyup=(t,e)=>{e.keyCode==16&&(t.input.shiftKey=!1)};Wt.keypress=(t,e)=>{let n=e;if(d_(t,n)||!n.charCode||n.ctrlKey&&!n.altKey||In&&n.metaKey)return;if(t.someProp("handleKeyPress",i=>i(t,n))){n.preventDefault();return}let r=t.state.selection;if(!(r instanceof ie)||!r.$from.sameParent(r.$to)){let i=String.fromCharCode(n.charCode);!/[\r\n]/.test(i)&&!t.someProp("handleTextInput",o=>o(t,r.$from.pos,r.$to.pos,i))&&t.dispatch(t.state.tr.insertText(i).scrollIntoView()),n.preventDefault()}};function ep(t){return{left:t.clientX,top:t.clientY}}function t$(t,e){let n=e.x-t.clientX,r=e.y-t.clientY;return n*n+r*r<100}function B0(t,e,n,r,i){if(r==-1)return!1;let o=t.state.doc.resolve(r);for(let s=o.depth+1;s>0;s--)if(t.someProp(e,a=>s>o.depth?a(t,n,o.nodeAfter,o.before(s),i,!0):a(t,n,o.node(s),o.before(s),i,!1)))return!0;return!1}function Fa(t,e,n){if(t.focused||t.focus(),t.state.selection.eq(e))return;let r=t.state.tr.setSelection(e);n=="pointer"&&r.setMeta("pointer",!0),t.dispatch(r)}function n$(t,e){if(e==-1)return!1;let n=t.state.doc.resolve(e),r=n.nodeAfter;return r&&r.isAtom&&te.isSelectable(r)?(Fa(t,new te(n),"pointer"),!0):!1}function r$(t,e){if(e==-1)return!1;let n=t.state.selection,r,i;n instanceof te&&(r=n.node);let o=t.state.doc.resolve(e);for(let s=o.depth+1;s>0;s--){let a=s>o.depth?o.nodeAfter:o.node(s);if(te.isSelectable(a)){r&&n.$from.depth>0&&s>=n.$from.depth&&o.before(n.$from.depth+1)==n.$from.pos?i=o.before(n.$from.depth):i=o.before(s);break}}return i!=null?(Fa(t,te.create(t.state.doc,i),"pointer"),!0):!1}function i$(t,e,n,r,i){return B0(t,"handleClickOn",e,n,r)||t.someProp("handleClick",o=>o(t,e,r))||(i?r$(t,n):n$(t,n))}function o$(t,e,n,r){return B0(t,"handleDoubleClickOn",e,n,r)||t.someProp("handleDoubleClick",i=>i(t,e,r))}function s$(t,e,n,r){return B0(t,"handleTripleClickOn",e,n,r)||t.someProp("handleTripleClick",i=>i(t,e,r))||a$(t,n,r)}function a$(t,e,n){if(n.button!=0)return!1;let r=t.state.doc;if(e==-1)return r.inlineContent?(Fa(t,ie.create(r,0,r.content.size),"pointer"),!0):!1;let i=r.resolve(e);for(let o=i.depth+1;o>0;o--){let s=o>i.depth?i.nodeAfter:i.node(o),a=i.before(o);if(s.inlineContent)Fa(t,ie.create(r,a+1,a+1+s.content.size),"pointer");else if(te.isSelectable(s))Fa(t,te.create(r,a),"pointer");else continue;return!0}}function z0(t){return Zf(t)}const u_=In?"metaKey":"ctrlKey";Ht.mousedown=(t,e)=>{let n=e;t.input.shiftKey=n.shiftKey;let r=z0(t),i=Date.now(),o="singleClick";i-t.input.lastClick.time<500&&t$(n,t.input.lastClick)&&!n[u_]&&(t.input.lastClick.type=="singleClick"?o="doubleClick":t.input.lastClick.type=="doubleClick"&&(o="tripleClick")),t.input.lastClick={time:i,x:n.clientX,y:n.clientY,type:o};let s=t.posAtCoords(ep(n));s&&(o=="singleClick"?(t.input.mouseDown&&t.input.mouseDown.done(),t.input.mouseDown=new l$(t,s,n,!!r)):(o=="doubleClick"?o$:s$)(t,s.pos,s.inside,n)?n.preventDefault():ao(t,"pointer"))};class l${constructor(e,n,r,i){this.view=e,this.pos=n,this.event=r,this.flushed=i,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!r[u_],this.allowDefault=r.shiftKey;let o,s;if(n.inside>-1)o=e.state.doc.nodeAt(n.inside),s=n.inside;else{let u=e.state.doc.resolve(n.pos);o=u.parent,s=u.depth?u.before():0}const a=i?null:r.target,l=a?e.docView.nearestDesc(a,!0):null;this.target=l&&l.dom.nodeType==1?l.dom:null;let{selection:c}=e.state;(r.button==0&&o.type.spec.draggable&&o.type.spec.selectable!==!1||c instanceof te&&c.from<=s&&c.to>s)&&(this.mightDrag={node:o,pos:s,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&ur&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),ao(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>ai(this.view)),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let n=this.pos;this.view.state.doc!=this.startDoc&&(n=this.view.posAtCoords(ep(e))),this.updateAllowDefault(e),this.allowDefault||!n?ao(this.view,"pointer"):i$(this.view,n.pos,n.inside,e,this.selectNode)?e.preventDefault():e.button==0&&(this.flushed||Ut&&this.mightDrag&&!this.mightDrag.node.isAtom||_t&&!this.view.state.selection.visible&&Math.min(Math.abs(n.pos-this.view.state.selection.from),Math.abs(n.pos-this.view.state.selection.to))<=2)?(Fa(this.view,oe.near(this.view.state.doc.resolve(n.pos)),"pointer"),e.preventDefault()):ao(this.view,"pointer")}move(e){this.updateAllowDefault(e),ao(this.view,"pointer"),e.buttons==0&&this.done()}updateAllowDefault(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}}Ht.touchstart=t=>{t.input.lastTouch=Date.now(),z0(t),ao(t,"pointer")};Ht.touchmove=t=>{t.input.lastTouch=Date.now(),ao(t,"pointer")};Ht.contextmenu=t=>z0(t);function d_(t,e){return t.composing?!0:Ut&&Math.abs(e.timeStamp-t.input.compositionEndedAt)<500?(t.input.compositionEndedAt=-2e8,!0):!1}const c$=ri?5e3:-1;Wt.compositionstart=Wt.compositionupdate=t=>{if(!t.composing){t.domObserver.flush();let{state:e}=t,n=e.selection.$to;if(e.selection instanceof ie&&(e.storedMarks||!n.textOffset&&n.parentOffset&&n.nodeBefore.marks.some(r=>r.type.spec.inclusive===!1)))t.markCursor=t.state.storedMarks||n.marks(),Zf(t,!0),t.markCursor=null;else if(Zf(t,!e.selection.empty),ur&&e.selection.empty&&n.parentOffset&&!n.textOffset&&n.nodeBefore.marks.length){let r=t.domSelectionRange();for(let i=r.focusNode,o=r.focusOffset;i&&i.nodeType==1&&o!=0;){let s=o<0?i.lastChild:i.childNodes[o-1];if(!s)break;if(s.nodeType==3){let a=t.domSelection();a&&a.collapse(s,s.nodeValue.length);break}else i=s,o=-1}}t.input.composing=!0}f_(t,c$)};Wt.compositionend=(t,e)=>{t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=e.timeStamp,t.input.compositionPendingChanges=t.domObserver.pendingRecords().length?t.input.compositionID:0,t.input.compositionNode=null,t.input.compositionPendingChanges&&Promise.resolve().then(()=>t.domObserver.flush()),t.input.compositionID++,f_(t,20))};function f_(t,e){clearTimeout(t.input.composingTimeout),e>-1&&(t.input.composingTimeout=setTimeout(()=>Zf(t),e))}function h_(t){for(t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=d$());t.input.compositionNodes.length>0;)t.input.compositionNodes.pop().markParentsDirty()}function u$(t){let e=t.domSelectionRange();if(!e.focusNode)return null;let n=n3(e.focusNode,e.focusOffset),r=r3(e.focusNode,e.focusOffset);if(n&&r&&n!=r){let i=r.pmViewDesc,o=t.domObserver.lastChangedTextNode;if(n==o||r==o)return o;if(!i||!i.isText(r.nodeValue))return r;if(t.input.compositionNode==r){let s=n.pmViewDesc;if(!(!s||!s.isText(n.nodeValue)))return r}}return n||r}function d$(){let t=document.createEvent("Event");return t.initEvent("event",!0,!0),t.timeStamp}function Zf(t,e=!1){if(!(ri&&t.domObserver.flushingSoon>=0)){if(t.domObserver.forceFlush(),h_(t),e||t.docView&&t.docView.dirty){let n=j0(t);return n&&!n.eq(t.state.selection)?t.dispatch(t.state.tr.setSelection(n)):(t.markCursor||e)&&!t.state.selection.empty?t.dispatch(t.state.tr.deleteSelection()):t.updateState(t.state),!0}return!1}}function f$(t,e){if(!t.dom.parentNode)return;let n=t.dom.parentNode.appendChild(document.createElement("div"));n.appendChild(e),n.style.cssText="position: fixed; left: -10000px; top: 10px";let r=getSelection(),i=document.createRange();i.selectNodeContents(e),t.dom.blur(),r.removeAllRanges(),r.addRange(i),setTimeout(()=>{n.parentNode&&n.parentNode.removeChild(n),t.focus()},50)}const iu=dn&&wo<15||hl&&l3<604;Ht.copy=Wt.cut=(t,e)=>{let n=e,r=t.state.selection,i=n.type=="cut";if(r.empty)return;let o=iu?null:n.clipboardData,s=r.content(),{dom:a,text:l}=$0(t,s);o?(n.preventDefault(),o.clearData(),o.setData("text/html",a.innerHTML),o.setData("text/plain",l)):f$(t,a),i&&t.dispatch(t.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function h$(t){return t.openStart==0&&t.openEnd==0&&t.content.childCount==1?t.content.firstChild:null}function p$(t,e){if(!t.dom.parentNode)return;let n=t.input.shiftKey||t.state.selection.$from.parent.type.spec.code,r=t.dom.parentNode.appendChild(document.createElement(n?"textarea":"div"));n||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus();let i=t.input.shiftKey&&t.input.lastKeyCode!=45;setTimeout(()=>{t.focus(),r.parentNode&&r.parentNode.removeChild(r),n?ou(t,r.value,null,i,e):ou(t,r.textContent,r.innerHTML,i,e)},50)}function ou(t,e,n,r,i){let o=i_(t,e,n,r,t.state.selection.$from);if(t.someProp("handlePaste",l=>l(t,i,o||W.empty)))return!0;if(!o)return!1;let s=h$(o),a=s?t.state.tr.replaceSelectionWith(s,r):t.state.tr.replaceSelection(o);return t.dispatch(a.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function p_(t){let e=t.getData("text/plain")||t.getData("Text");if(e)return e;let n=t.getData("text/uri-list");return n?n.replace(/\r?\n/g," "):""}Wt.paste=(t,e)=>{let n=e;if(t.composing&&!ri)return;let r=iu?null:n.clipboardData,i=t.input.shiftKey&&t.input.lastKeyCode!=45;r&&ou(t,p_(r),r.getData("text/html"),i,n)?n.preventDefault():p$(t,n)};class m_{constructor(e,n,r){this.slice=e,this.move=n,this.node=r}}const g_=In?"altKey":"ctrlKey";Ht.dragstart=(t,e)=>{let n=e,r=t.input.mouseDown;if(r&&r.done(),!n.dataTransfer)return;let i=t.state.selection,o=i.empty?null:t.posAtCoords(ep(n)),s;if(!(o&&o.pos>=i.from&&o.pos<=(i instanceof te?i.to-1:i.to))){if(r&&r.mightDrag)s=te.create(t.state.doc,r.mightDrag.pos);else if(n.target&&n.target.nodeType==1){let d=t.docView.nearestDesc(n.target,!0);d&&d.node.type.spec.draggable&&d!=t.docView&&(s=te.create(t.state.doc,d.posBefore))}}let a=(s||t.state.selection).content(),{dom:l,text:c,slice:u}=$0(t,a);(!n.dataTransfer.files.length||!_t||VT>120)&&n.dataTransfer.clearData(),n.dataTransfer.setData(iu?"Text":"text/html",l.innerHTML),n.dataTransfer.effectAllowed="copyMove",iu||n.dataTransfer.setData("text/plain",c),t.dragging=new m_(u,!n[g_],s)};Ht.dragend=t=>{let e=t.dragging;window.setTimeout(()=>{t.dragging==e&&(t.dragging=null)},50)};Wt.dragover=Wt.dragenter=(t,e)=>e.preventDefault();Wt.drop=(t,e)=>{let n=e,r=t.dragging;if(t.dragging=null,!n.dataTransfer)return;let i=t.posAtCoords(ep(n));if(!i)return;let o=t.state.doc.resolve(i.pos),s=r&&r.slice;s?t.someProp("transformPasted",m=>{s=m(s,t)}):s=i_(t,p_(n.dataTransfer),iu?null:n.dataTransfer.getData("text/html"),!1,o);let a=!!(r&&!n[g_]);if(t.someProp("handleDrop",m=>m(t,n,s||W.empty,a))){n.preventDefault();return}if(!s)return;n.preventDefault();let l=s?NT(t.state.doc,o.pos,s):o.pos;l==null&&(l=o.pos);let c=t.state.tr;if(a){let{node:m}=r;m?m.replace(c):c.deleteSelection()}let u=c.mapping.map(l),d=s.openStart==0&&s.openEnd==0&&s.content.childCount==1,h=c.doc;if(d?c.replaceRangeWith(u,u,s.content.firstChild):c.replaceRange(u,u,s),c.doc.eq(h))return;let p=c.doc.resolve(u);if(d&&te.isSelectable(s.content.firstChild)&&p.nodeAfter&&p.nodeAfter.sameMarkup(s.content.firstChild))c.setSelection(new te(p));else{let m=c.mapping.map(l);c.mapping.maps[c.mapping.maps.length-1].forEach((y,v,x,w)=>m=w),c.setSelection(L0(t,p,c.doc.resolve(m)))}t.focus(),t.dispatch(c.setMeta("uiEvent","drop"))};Ht.focus=t=>{t.input.lastFocus=Date.now(),t.focused||(t.domObserver.stop(),t.dom.classList.add("ProseMirror-focused"),t.domObserver.start(),t.focused=!0,setTimeout(()=>{t.docView&&t.hasFocus()&&!t.domObserver.currentSelection.eq(t.domSelectionRange())&&ai(t)},20))};Ht.blur=(t,e)=>{let n=e;t.focused&&(t.domObserver.stop(),t.dom.classList.remove("ProseMirror-focused"),t.domObserver.start(),n.relatedTarget&&t.dom.contains(n.relatedTarget)&&t.domObserver.currentSelection.clear(),t.focused=!1)};Ht.beforeinput=(t,e)=>{if(_t&&ri&&e.inputType=="deleteContentBackward"){t.domObserver.flushSoon();let{domChangeCount:r}=t.input;setTimeout(()=>{if(t.input.domChangeCount!=r||(t.dom.blur(),t.focus(),t.someProp("handleKeyDown",o=>o(t,Qo(8,"Backspace")))))return;let{$cursor:i}=t.state.selection;i&&i.pos>0&&t.dispatch(t.state.tr.delete(i.pos-1,i.pos).scrollIntoView())},50)}};for(let t in Wt)Ht[t]=Wt[t];function su(t,e){if(t==e)return!0;for(let n in t)if(t[n]!==e[n])return!1;for(let n in e)if(!(n in t))return!1;return!0}class eh{constructor(e,n){this.toDOM=e,this.spec=n||xs,this.side=this.spec.side||0}map(e,n,r,i){let{pos:o,deleted:s}=e.mapResult(n.from+i,this.side<0?-1:1);return s?null:new an(o-r,o-r,this)}valid(){return!0}eq(e){return this==e||e instanceof eh&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&su(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}}class So{constructor(e,n){this.attrs=e,this.spec=n||xs}map(e,n,r,i){let o=e.map(n.from+i,this.spec.inclusiveStart?-1:1)-r,s=e.map(n.to+i,this.spec.inclusiveEnd?1:-1)-r;return o>=s?null:new an(o,s,this)}valid(e,n){return n.from<n.to}eq(e){return this==e||e instanceof So&&su(this.attrs,e.attrs)&&su(this.spec,e.spec)}static is(e){return e.type instanceof So}destroy(){}}class V0{constructor(e,n){this.attrs=e,this.spec=n||xs}map(e,n,r,i){let o=e.mapResult(n.from+i,1);if(o.deleted)return null;let s=e.mapResult(n.to+i,-1);return s.deleted||s.pos<=o.pos?null:new an(o.pos-r,s.pos-r,this)}valid(e,n){let{index:r,offset:i}=e.content.findIndex(n.from),o;return i==n.from&&!(o=e.child(r)).isText&&i+o.nodeSize==n.to}eq(e){return this==e||e instanceof V0&&su(this.attrs,e.attrs)&&su(this.spec,e.spec)}destroy(){}}class an{constructor(e,n,r){this.from=e,this.to=n,this.type=r}copy(e,n){return new an(e,n,this.type)}eq(e,n=0){return this.type.eq(e.type)&&this.from+n==e.from&&this.to+n==e.to}map(e,n,r){return this.type.map(e,this,n,r)}static widget(e,n,r){return new an(e,e,new eh(n,r))}static inline(e,n,r,i){return new an(e,n,new So(r,i))}static node(e,n,r,i){return new an(e,n,new V0(r,i))}get spec(){return this.type.spec}get inline(){return this.type instanceof So}get widget(){return this.type instanceof eh}}const da=[],xs={};class qe{constructor(e,n){this.local=e.length?e:da,this.children=n.length?n:da}static create(e,n){return n.length?th(n,e,0,xs):Et}find(e,n,r){let i=[];return this.findInner(e??0,n??1e9,i,0,r),i}findInner(e,n,r,i,o){for(let s=0;s<this.local.length;s++){let a=this.local[s];a.from<=n&&a.to>=e&&(!o||o(a.spec))&&r.push(a.copy(a.from+i,a.to+i))}for(let s=0;s<this.children.length;s+=3)if(this.children[s]<n&&this.children[s+1]>e){let a=this.children[s]+1;this.children[s+2].findInner(e-a,n-a,r,i+a,o)}}map(e,n,r){return this==Et||e.maps.length==0?this:this.mapInner(e,n,0,0,r||xs)}mapInner(e,n,r,i,o){let s;for(let a=0;a<this.local.length;a++){let l=this.local[a].map(e,r,i);l&&l.type.valid(n,l)?(s||(s=[])).push(l):o.onRemove&&o.onRemove(this.local[a].spec)}return this.children.length?m$(this.children,s||[],e,n,r,i,o):s?new qe(s.sort(ws),da):Et}add(e,n){return n.length?this==Et?qe.create(e,n):this.addInner(e,n,0):this}addInner(e,n,r){let i,o=0;e.forEach((a,l)=>{let c=l+r,u;if(u=v_(n,a,c)){for(i||(i=this.children.slice());o<i.length&&i[o]<l;)o+=3;i[o]==l?i[o+2]=i[o+2].addInner(a,u,c+1):i.splice(o,0,l,l+a.nodeSize,th(u,a,c+1,xs)),o+=3}});let s=y_(o?x_(n):n,-r);for(let a=0;a<s.length;a++)s[a].type.valid(e,s[a])||s.splice(a--,1);return new qe(s.length?this.local.concat(s).sort(ws):this.local,i||this.children)}remove(e){return e.length==0||this==Et?this:this.removeInner(e,0)}removeInner(e,n){let r=this.children,i=this.local;for(let o=0;o<r.length;o+=3){let s,a=r[o]+n,l=r[o+1]+n;for(let u=0,d;u<e.length;u++)(d=e[u])&&d.from>a&&d.to<l&&(e[u]=null,(s||(s=[])).push(d));if(!s)continue;r==this.children&&(r=this.children.slice());let c=r[o+2].removeInner(s,a+1);c!=Et?r[o+2]=c:(r.splice(o,3),o-=3)}if(i.length){for(let o=0,s;o<e.length;o++)if(s=e[o])for(let a=0;a<i.length;a++)i[a].eq(s,n)&&(i==this.local&&(i=this.local.slice()),i.splice(a--,1))}return r==this.children&&i==this.local?this:i.length||r.length?new qe(i,r):Et}forChild(e,n){if(this==Et)return this;if(n.isLeaf)return qe.empty;let r,i;for(let a=0;a<this.children.length;a+=3)if(this.children[a]>=e){this.children[a]==e&&(r=this.children[a+2]);break}let o=e+1,s=o+n.content.size;for(let a=0;a<this.local.length;a++){let l=this.local[a];if(l.from<s&&l.to>o&&l.type instanceof So){let c=Math.max(o,l.from)-o,u=Math.min(s,l.to)-o;c<u&&(i||(i=[])).push(l.copy(c,u))}}if(i){let a=new qe(i.sort(ws),da);return r?new qi([a,r]):a}return r||Et}eq(e){if(this==e)return!0;if(!(e instanceof qe)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let n=0;n<this.local.length;n++)if(!this.local[n].eq(e.local[n]))return!1;for(let n=0;n<this.children.length;n+=3)if(this.children[n]!=e.children[n]||this.children[n+1]!=e.children[n+1]||!this.children[n+2].eq(e.children[n+2]))return!1;return!0}locals(e){return U0(this.localsInner(e))}localsInner(e){if(this==Et)return da;if(e.inlineContent||!this.local.some(So.is))return this.local;let n=[];for(let r=0;r<this.local.length;r++)this.local[r].type instanceof So||n.push(this.local[r]);return n}forEachSet(e){e(this)}}qe.empty=new qe([],[]);qe.removeOverlap=U0;const Et=qe.empty;class qi{constructor(e){this.members=e}map(e,n){const r=this.members.map(i=>i.map(e,n,xs));return qi.from(r)}forChild(e,n){if(n.isLeaf)return qe.empty;let r=[];for(let i=0;i<this.members.length;i++){let o=this.members[i].forChild(e,n);o!=Et&&(o instanceof qi?r=r.concat(o.members):r.push(o))}return qi.from(r)}eq(e){if(!(e instanceof qi)||e.members.length!=this.members.length)return!1;for(let n=0;n<this.members.length;n++)if(!this.members[n].eq(e.members[n]))return!1;return!0}locals(e){let n,r=!0;for(let i=0;i<this.members.length;i++){let o=this.members[i].localsInner(e);if(o.length)if(!n)n=o;else{r&&(n=n.slice(),r=!1);for(let s=0;s<o.length;s++)n.push(o[s])}}return n?U0(r?n:n.sort(ws)):da}static from(e){switch(e.length){case 0:return Et;case 1:return e[0];default:return new qi(e.every(n=>n instanceof qe)?e:e.reduce((n,r)=>n.concat(r instanceof qe?r:r.members),[]))}}forEachSet(e){for(let n=0;n<this.members.length;n++)this.members[n].forEachSet(e)}}function m$(t,e,n,r,i,o,s){let a=t.slice();for(let c=0,u=o;c<n.maps.length;c++){let d=0;n.maps[c].forEach((h,p,m,y)=>{let v=y-m-(p-h);for(let x=0;x<a.length;x+=3){let w=a[x+1];if(w<0||h>w+u-d)continue;let b=a[x]+u-d;p>=b?a[x+1]=h<=b?-2:-1:h>=u&&v&&(a[x]+=v,a[x+1]+=v)}d+=v}),u=n.maps[c].map(u,-1)}let l=!1;for(let c=0;c<a.length;c+=3)if(a[c+1]<0){if(a[c+1]==-2){l=!0,a[c+1]=-1;continue}let u=n.map(t[c]+o),d=u-i;if(d<0||d>=r.content.size){l=!0;continue}let h=n.map(t[c+1]+o,-1),p=h-i,{index:m,offset:y}=r.content.findIndex(d),v=r.maybeChild(m);if(v&&y==d&&y+v.nodeSize==p){let x=a[c+2].mapInner(n,v,u+1,t[c]+o+1,s);x!=Et?(a[c]=d,a[c+1]=p,a[c+2]=x):(a[c+1]=-2,l=!0)}else l=!0}if(l){let c=g$(a,t,e,n,i,o,s),u=th(c,r,0,s);e=u.local;for(let d=0;d<a.length;d+=3)a[d+1]<0&&(a.splice(d,3),d-=3);for(let d=0,h=0;d<u.children.length;d+=3){let p=u.children[d];for(;h<a.length&&a[h]<p;)h+=3;a.splice(h,0,u.children[d],u.children[d+1],u.children[d+2])}}return new qe(e.sort(ws),a)}function y_(t,e){if(!e||!t.length)return t;let n=[];for(let r=0;r<t.length;r++){let i=t[r];n.push(new an(i.from+e,i.to+e,i.type))}return n}function g$(t,e,n,r,i,o,s){function a(l,c){for(let u=0;u<l.local.length;u++){let d=l.local[u].map(r,i,c);d?n.push(d):s.onRemove&&s.onRemove(l.local[u].spec)}for(let u=0;u<l.children.length;u+=3)a(l.children[u+2],l.children[u]+c+1)}for(let l=0;l<t.length;l+=3)t[l+1]==-1&&a(t[l+2],e[l]+o+1);return n}function v_(t,e,n){if(e.isLeaf)return null;let r=n+e.nodeSize,i=null;for(let o=0,s;o<t.length;o++)(s=t[o])&&s.from>n&&s.to<r&&((i||(i=[])).push(s),t[o]=null);return i}function x_(t){let e=[];for(let n=0;n<t.length;n++)t[n]!=null&&e.push(t[n]);return e}function th(t,e,n,r){let i=[],o=!1;e.forEach((a,l)=>{let c=v_(t,a,l+n);if(c){o=!0;let u=th(c,a,n+l+1,r);u!=Et&&i.push(l,l+a.nodeSize,u)}});let s=y_(o?x_(t):t,-n).sort(ws);for(let a=0;a<s.length;a++)s[a].type.valid(e,s[a])||(r.onRemove&&r.onRemove(s[a].spec),s.splice(a--,1));return s.length||i.length?new qe(s,i):Et}function ws(t,e){return t.from-e.from||t.to-e.to}function U0(t){let e=t;for(let n=0;n<e.length-1;n++){let r=e[n];if(r.from!=r.to)for(let i=n+1;i<e.length;i++){let o=e[i];if(o.from==r.from){o.to!=r.to&&(e==t&&(e=t.slice()),e[i]=o.copy(o.from,r.to),h1(e,i+1,o.copy(r.to,o.to)));continue}else{o.from<r.to&&(e==t&&(e=t.slice()),e[n]=r.copy(r.from,o.from),h1(e,i,r.copy(o.from,r.to)));break}}}return e}function h1(t,e,n){for(;e<t.length&&ws(n,t[e])>0;)e++;t.splice(e,0,n)}function Tm(t){let e=[];return t.someProp("decorations",n=>{let r=n(t.state);r&&r!=Et&&e.push(r)}),t.cursorWrapper&&e.push(qe.create(t.state.doc,[t.cursorWrapper.deco])),qi.from(e)}const y$={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},v$=dn&&wo<=11;class x${constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}}class w${constructor(e,n){this.view=e,this.handleDOMChange=n,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new x$,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver(r=>{for(let i=0;i<r.length;i++)this.queue.push(r[i]);dn&&wo<=11&&r.some(i=>i.type=="childList"&&i.removedNodes.length||i.type=="characterData"&&i.oldValue.length>i.target.nodeValue.length)?this.flushSoon():this.flush()}),v$&&(this.onCharData=r=>{this.queue.push({target:r.target,type:"characterData",oldValue:r.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,y$)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let e=this.observer.takeRecords();if(e.length){for(let n=0;n<e.length;n++)this.queue.push(e[n]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(o1(this.view)){if(this.suppressingSelectionUpdates)return ai(this.view);if(dn&&wo<=11&&!this.view.state.selection.empty){let e=this.view.domSelectionRange();if(e.focusNode&&As(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(e){if(!e.focusNode)return!0;let n=new Set,r;for(let o=e.focusNode;o;o=fl(o))n.add(o);for(let o=e.anchorNode;o;o=fl(o))if(n.has(o)){r=o;break}let i=r&&this.view.docView.nearestDesc(r);if(i&&i.ignoreMutation({type:"selection",target:r.nodeType==3?r.parentNode:r}))return this.setCurSelection(),!0}pendingRecords(){if(this.observer)for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}flush(){let{view:e}=this;if(!e.docView||this.flushingSoon>-1)return;let n=this.pendingRecords();n.length&&(this.queue=[]);let r=e.domSelectionRange(),i=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(r)&&o1(e)&&!this.ignoreSelectionChange(r),o=-1,s=-1,a=!1,l=[];if(e.editable)for(let u=0;u<n.length;u++){let d=this.registerMutation(n[u],l);d&&(o=o<0?d.from:Math.min(d.from,o),s=s<0?d.to:Math.max(d.to,s),d.typeOver&&(a=!0))}if(ur&&l.length){let u=l.filter(d=>d.nodeName=="BR");if(u.length==2){let[d,h]=u;d.parentNode&&d.parentNode.parentNode==h.parentNode?h.remove():d.remove()}else{let{focusNode:d}=this.currentSelection;for(let h of u){let p=h.parentNode;p&&p.nodeName=="LI"&&(!d||C$(e,d)!=p)&&h.remove()}}}let c=null;o<0&&i&&e.input.lastFocus>Date.now()-200&&Math.max(e.input.lastTouch,e.input.lastClick.time)<Date.now()-300&&Xh(r)&&(c=j0(e))&&c.eq(oe.near(e.state.doc.resolve(0),1))?(e.input.lastFocus=0,ai(e),this.currentSelection.set(r),e.scrollToSelection()):(o>-1||i)&&(o>-1&&(e.docView.markDirty(o,s),b$(e)),this.handleDOMChange(o,s,a,l),e.docView&&e.docView.dirty?e.updateState(e.state):this.currentSelection.eq(r)||ai(e),this.currentSelection.set(r))}registerMutation(e,n){if(n.indexOf(e.target)>-1)return null;let r=this.view.docView.nearestDesc(e.target);if(e.type=="attributes"&&(r==this.view.docView||e.attributeName=="contenteditable"||e.attributeName=="style"&&!e.oldValue&&!e.target.getAttribute("style"))||!r||r.ignoreMutation(e))return null;if(e.type=="childList"){for(let u=0;u<e.addedNodes.length;u++){let d=e.addedNodes[u];n.push(d),d.nodeType==3&&(this.lastChangedTextNode=d)}if(r.contentDOM&&r.contentDOM!=r.dom&&!r.contentDOM.contains(e.target))return{from:r.posBefore,to:r.posAfter};let i=e.previousSibling,o=e.nextSibling;if(dn&&wo<=11&&e.addedNodes.length)for(let u=0;u<e.addedNodes.length;u++){let{previousSibling:d,nextSibling:h}=e.addedNodes[u];(!d||Array.prototype.indexOf.call(e.addedNodes,d)<0)&&(i=d),(!h||Array.prototype.indexOf.call(e.addedNodes,h)<0)&&(o=h)}let s=i&&i.parentNode==e.target?mt(i)+1:0,a=r.localPosFromDOM(e.target,s,-1),l=o&&o.parentNode==e.target?mt(o):e.target.childNodes.length,c=r.localPosFromDOM(e.target,l,1);return{from:a,to:c}}else return e.type=="attributes"?{from:r.posAtStart-r.border,to:r.posAtEnd+r.border}:(this.lastChangedTextNode=e.target,{from:r.posAtStart,to:r.posAtEnd,typeOver:e.target.nodeValue==e.oldValue})}}let p1=new WeakMap,m1=!1;function b$(t){if(!p1.has(t)&&(p1.set(t,null),["normal","nowrap","pre-line"].indexOf(getComputedStyle(t.dom).whiteSpace)!==-1)){if(t.requiresGeckoHackNode=ur,m1)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),m1=!0}}function g1(t,e){let n=e.startContainer,r=e.startOffset,i=e.endContainer,o=e.endOffset,s=t.domAtPos(t.state.selection.anchor);return As(s.node,s.offset,i,o)&&([n,r,i,o]=[i,o,n,r]),{anchorNode:n,anchorOffset:r,focusNode:i,focusOffset:o}}function S$(t,e){if(e.getComposedRanges){let i=e.getComposedRanges(t.root)[0];if(i)return g1(t,i)}let n;function r(i){i.preventDefault(),i.stopImmediatePropagation(),n=i.getTargetRanges()[0]}return t.dom.addEventListener("beforeinput",r,!0),document.execCommand("indent"),t.dom.removeEventListener("beforeinput",r,!0),n?g1(t,n):null}function C$(t,e){for(let n=e.parentNode;n&&n!=t.dom;n=n.parentNode){let r=t.docView.nearestDesc(n,!0);if(r&&r.node.isBlock)return n}return null}function k$(t,e,n){let{node:r,fromOffset:i,toOffset:o,from:s,to:a}=t.docView.parseRange(e,n),l=t.domSelectionRange(),c,u=l.anchorNode;if(u&&t.dom.contains(u.nodeType==1?u:u.parentNode)&&(c=[{node:u,offset:l.anchorOffset}],Xh(l)||c.push({node:l.focusNode,offset:l.focusOffset})),_t&&t.input.lastKeyCode===8)for(let v=o;v>i;v--){let x=r.childNodes[v-1],w=x.pmViewDesc;if(x.nodeName=="BR"&&!w){o=v;break}if(!w||w.size)break}let d=t.state.doc,h=t.someProp("domParser")||xo.fromSchema(t.state.schema),p=d.resolve(s),m=null,y=h.parse(r,{topNode:p.parent,topMatch:p.parent.contentMatchAt(p.index()),topOpen:!0,from:i,to:o,preserveWhitespace:p.parent.type.whitespace=="pre"?"full":!0,findPositions:c,ruleFromNode:E$,context:p});if(c&&c[0].pos!=null){let v=c[0].pos,x=c[1]&&c[1].pos;x==null&&(x=v),m={anchor:v+s,head:x+s}}return{doc:y,sel:m,from:s,to:a}}function E$(t){let e=t.pmViewDesc;if(e)return e.parseRule();if(t.nodeName=="BR"&&t.parentNode){if(Ut&&/^(ul|ol)$/i.test(t.parentNode.nodeName)){let n=document.createElement("div");return n.appendChild(document.createElement("li")),{skip:n}}else if(t.parentNode.lastChild==t||Ut&&/^(tr|table)$/i.test(t.parentNode.nodeName))return{ignore:!0}}else if(t.nodeName=="IMG"&&t.getAttribute("mark-placeholder"))return{ignore:!0};return null}const T$=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function _$(t,e,n,r,i){let o=t.input.compositionPendingChanges||(t.composing?t.input.compositionID:0);if(t.input.compositionPendingChanges=0,e<0){let O=t.input.lastSelectionTime>Date.now()-50?t.input.lastSelectionOrigin:null,_=j0(t,O);if(_&&!t.state.selection.eq(_)){if(_t&&ri&&t.input.lastKeyCode===13&&Date.now()-100<t.input.lastKeyCodeTime&&t.someProp("handleKeyDown",L=>L(t,Qo(13,"Enter"))))return;let D=t.state.tr.setSelection(_);O=="pointer"?D.setMeta("pointer",!0):O=="key"&&D.scrollIntoView(),o&&D.setMeta("composition",o),t.dispatch(D)}return}let s=t.state.doc.resolve(e),a=s.sharedDepth(n);e=s.before(a+1),n=t.state.doc.resolve(n).after(a+1);let l=t.state.selection,c=k$(t,e,n),u=t.state.doc,d=u.slice(c.from,c.to),h,p;t.input.lastKeyCode===8&&Date.now()-100<t.input.lastKeyCodeTime?(h=t.state.selection.to,p="end"):(h=t.state.selection.from,p="start"),t.input.lastKeyCode=null;let m=P$(d.content,c.doc.content,c.from,h,p);if(m&&t.input.domChangeCount++,(hl&&t.input.lastIOSEnter>Date.now()-225||ri)&&i.some(O=>O.nodeType==1&&!T$.test(O.nodeName))&&(!m||m.endA>=m.endB)&&t.someProp("handleKeyDown",O=>O(t,Qo(13,"Enter")))){t.input.lastIOSEnter=0;return}if(!m)if(r&&l instanceof ie&&!l.empty&&l.$head.sameParent(l.$anchor)&&!t.composing&&!(c.sel&&c.sel.anchor!=c.sel.head))m={start:l.from,endA:l.to,endB:l.to};else{if(c.sel){let O=y1(t,t.state.doc,c.sel);if(O&&!O.eq(t.state.selection)){let _=t.state.tr.setSelection(O);o&&_.setMeta("composition",o),t.dispatch(_)}}return}t.state.selection.from<t.state.selection.to&&m.start==m.endB&&t.state.selection instanceof ie&&(m.start>t.state.selection.from&&m.start<=t.state.selection.from+2&&t.state.selection.from>=c.from?m.start=t.state.selection.from:m.endA<t.state.selection.to&&m.endA>=t.state.selection.to-2&&t.state.selection.to<=c.to&&(m.endB+=t.state.selection.to-m.endA,m.endA=t.state.selection.to)),dn&&wo<=11&&m.endB==m.start+1&&m.endA==m.start&&m.start>c.from&&c.doc.textBetween(m.start-c.from-1,m.start-c.from+1)=="  "&&(m.start--,m.endA--,m.endB--);let y=c.doc.resolveNoCache(m.start-c.from),v=c.doc.resolveNoCache(m.endB-c.from),x=u.resolve(m.start),w=y.sameParent(v)&&y.parent.inlineContent&&x.end()>=m.endA,b;if((hl&&t.input.lastIOSEnter>Date.now()-225&&(!w||i.some(O=>O.nodeName=="DIV"||O.nodeName=="P"))||!w&&y.pos<c.doc.content.size&&!y.sameParent(v)&&(b=oe.findFrom(c.doc.resolve(y.pos+1),1,!0))&&b.head==v.pos)&&t.someProp("handleKeyDown",O=>O(t,Qo(13,"Enter")))){t.input.lastIOSEnter=0;return}if(t.state.selection.anchor>m.start&&O$(u,m.start,m.endA,y,v)&&t.someProp("handleKeyDown",O=>O(t,Qo(8,"Backspace")))){ri&&_t&&t.domObserver.suppressSelectionUpdates();return}_t&&m.endB==m.start&&(t.input.lastChromeDelete=Date.now()),ri&&!w&&y.start()!=v.start()&&v.parentOffset==0&&y.depth==v.depth&&c.sel&&c.sel.anchor==c.sel.head&&c.sel.head==m.endA&&(m.endB-=2,v=c.doc.resolveNoCache(m.endB-c.from),setTimeout(()=>{t.someProp("handleKeyDown",function(O){return O(t,Qo(13,"Enter"))})},20));let S=m.start,C=m.endA,k,E,T;if(w){if(y.pos==v.pos)dn&&wo<=11&&y.parentOffset==0&&(t.domObserver.suppressSelectionUpdates(),setTimeout(()=>ai(t),20)),k=t.state.tr.delete(S,C),E=u.resolve(m.start).marksAcross(u.resolve(m.endA));else if(m.endA==m.endB&&(T=R$(y.parent.content.cut(y.parentOffset,v.parentOffset),x.parent.content.cut(x.parentOffset,m.endA-x.start()))))k=t.state.tr,T.type=="add"?k.addMark(S,C,T.mark):k.removeMark(S,C,T.mark);else if(y.parent.child(y.index()).isText&&y.index()==v.index()-(v.textOffset?0:1)){let O=y.parent.textBetween(y.parentOffset,v.parentOffset);if(t.someProp("handleTextInput",_=>_(t,S,C,O)))return;k=t.state.tr.insertText(O,S,C)}}if(k||(k=t.state.tr.replace(S,C,c.doc.slice(m.start-c.from,m.endB-c.from))),c.sel){let O=y1(t,k.doc,c.sel);O&&!(_t&&t.composing&&O.empty&&(m.start!=m.endB||t.input.lastChromeDelete<Date.now()-100)&&(O.head==S||O.head==k.mapping.map(C)-1)||dn&&O.empty&&O.head==S)&&k.setSelection(O)}E&&k.ensureMarks(E),o&&k.setMeta("composition",o),t.dispatch(k.scrollIntoView())}function y1(t,e,n){return Math.max(n.anchor,n.head)>e.content.size?null:L0(t,e.resolve(n.anchor),e.resolve(n.head))}function R$(t,e){let n=t.firstChild.marks,r=e.firstChild.marks,i=n,o=r,s,a,l;for(let u=0;u<r.length;u++)i=r[u].removeFromSet(i);for(let u=0;u<n.length;u++)o=n[u].removeFromSet(o);if(i.length==1&&o.length==0)a=i[0],s="add",l=u=>u.mark(a.addToSet(u.marks));else if(i.length==0&&o.length==1)a=o[0],s="remove",l=u=>u.mark(a.removeFromSet(u.marks));else return null;let c=[];for(let u=0;u<e.childCount;u++)c.push(l(e.child(u)));if(B.from(c).eq(t))return{mark:a,type:s}}function O$(t,e,n,r,i){if(n-e<=i.pos-r.pos||_m(r,!0,!1)<i.pos)return!1;let o=t.resolve(e);if(!r.parent.isTextblock){let a=o.nodeAfter;return a!=null&&n==e+a.nodeSize}if(o.parentOffset<o.parent.content.size||!o.parent.isTextblock)return!1;let s=t.resolve(_m(o,!0,!0));return!s.parent.isTextblock||s.pos>n||_m(s,!0,!1)<n?!1:r.parent.content.cut(r.parentOffset).eq(s.parent.content)}function _m(t,e,n){let r=t.depth,i=e?t.end():t.pos;for(;r>0&&(e||t.indexAfter(r)==t.node(r).childCount);)r--,i++,e=!1;if(n){let o=t.node(r).maybeChild(t.indexAfter(r));for(;o&&!o.isLeaf;)o=o.firstChild,i++}return i}function P$(t,e,n,r,i){let o=t.findDiffStart(e,n);if(o==null)return null;let{a:s,b:a}=t.findDiffEnd(e,n+t.size,n+e.size);if(i=="end"){let l=Math.max(0,o-Math.min(s,a));r-=s+l-o}if(s<o&&t.size<e.size){let l=r<=o&&r>=s?o-r:0;o-=l,o&&o<e.size&&v1(e.textBetween(o-1,o+1))&&(o+=l?1:-1),a=o+(a-s),s=o}else if(a<o){let l=r<=o&&r>=a?o-r:0;o-=l,o&&o<t.size&&v1(t.textBetween(o-1,o+1))&&(o+=l?1:-1),s=o+(s-a),a=o}return{start:o,endA:s,endB:a}}function v1(t){if(t.length!=2)return!1;let e=t.charCodeAt(0),n=t.charCodeAt(1);return e>=56320&&e<=57343&&n>=55296&&n<=56319}class M${constructor(e,n){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new Y3,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=n,this.state=n.state,this.directPlugins=n.plugins||[],this.directPlugins.forEach(C1),this.dispatch=this.dispatch.bind(this),this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):typeof e=="function"?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=b1(this),w1(this),this.nodeViews=S1(this),this.docView=Zb(this.state.doc,x1(this),Tm(this),this.dom,this),this.domObserver=new w$(this,(r,i,o,s)=>_$(this,r,i,o,s)),this.domObserver.start(),Q3(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let e=this._props;this._props={};for(let n in e)this._props[n]=e[n];this._props.state=this.state}return this._props}update(e){e.handleDOMEvents!=this._props.handleDOMEvents&&Ly(this);let n=this._props;this._props=e,e.plugins&&(e.plugins.forEach(C1),this.directPlugins=e.plugins),this.updateStateInner(e.state,n)}setProps(e){let n={};for(let r in this._props)n[r]=this._props[r];n.state=this.state;for(let r in e)n[r]=e[r];this.update(n)}updateState(e){this.updateStateInner(e,this._props)}updateStateInner(e,n){var r;let i=this.state,o=!1,s=!1;e.storedMarks&&this.composing&&(h_(this),s=!0),this.state=e;let a=i.plugins!=e.plugins||this._props.plugins!=n.plugins;if(a||this._props.plugins!=n.plugins||this._props.nodeViews!=n.nodeViews){let p=S1(this);A$(p,this.nodeViews)&&(this.nodeViews=p,o=!0)}(a||n.handleDOMEvents!=this._props.handleDOMEvents)&&Ly(this),this.editable=b1(this),w1(this);let l=Tm(this),c=x1(this),u=i.plugins!=e.plugins&&!i.doc.eq(e.doc)?"reset":e.scrollToSelection>i.scrollToSelection?"to selection":"preserve",d=o||!this.docView.matchesNode(e.doc,c,l);(d||!e.selection.eq(i.selection))&&(s=!0);let h=u=="preserve"&&s&&this.dom.style.overflowAnchor==null&&d3(this);if(s){this.domObserver.stop();let p=d&&(dn||_t)&&!this.composing&&!i.selection.empty&&!e.selection.empty&&I$(i.selection,e.selection);if(d){let m=_t?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=u$(this)),(o||!this.docView.update(e.doc,c,l,this))&&(this.docView.updateOuterDeco(c),this.docView.destroy(),this.docView=Zb(e.doc,c,l,this.dom,this)),m&&!this.trackWrites&&(p=!0)}p||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&D3(this))?ai(this,p):(t_(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(i),!((r=this.dragging)===null||r===void 0)&&r.node&&!i.doc.eq(e.doc)&&this.updateDraggedNode(this.dragging,i),u=="reset"?this.dom.scrollTop=0:u=="to selection"?this.scrollToSelection():h&&f3(h)}scrollToSelection(){let e=this.domSelectionRange().focusNode;if(!(!e||!this.dom.contains(e.nodeType==1?e:e.parentNode))){if(!this.someProp("handleScrollToSelection",n=>n(this)))if(this.state.selection instanceof te){let n=this.docView.domAfterPos(this.state.selection.from);n.nodeType==1&&qb(this,n.getBoundingClientRect(),e)}else qb(this,this.coordsAtPos(this.state.selection.head,1),e)}}destroyPluginViews(){let e;for(;e=this.pluginViews.pop();)e.destroy&&e.destroy()}updatePluginViews(e){if(!e||e.plugins!=this.state.plugins||this.directPlugins!=this.prevDirectPlugins){this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let n=0;n<this.directPlugins.length;n++){let r=this.directPlugins[n];r.spec.view&&this.pluginViews.push(r.spec.view(this))}for(let n=0;n<this.state.plugins.length;n++){let r=this.state.plugins[n];r.spec.view&&this.pluginViews.push(r.spec.view(this))}}else for(let n=0;n<this.pluginViews.length;n++){let r=this.pluginViews[n];r.update&&r.update(this,e)}}updateDraggedNode(e,n){let r=e.node,i=-1;if(this.state.doc.nodeAt(r.from)==r.node)i=r.from;else{let o=r.from+(this.state.doc.content.size-n.doc.content.size);(o>0&&this.state.doc.nodeAt(o))==r.node&&(i=o)}this.dragging=new m_(e.slice,e.move,i<0?void 0:te.create(this.state.doc,i))}someProp(e,n){let r=this._props&&this._props[e],i;if(r!=null&&(i=n?n(r):r))return i;for(let s=0;s<this.directPlugins.length;s++){let a=this.directPlugins[s].props[e];if(a!=null&&(i=n?n(a):a))return i}let o=this.state.plugins;if(o)for(let s=0;s<o.length;s++){let a=o[s].props[e];if(a!=null&&(i=n?n(a):a))return i}}hasFocus(){if(dn){let e=this.root.activeElement;if(e==this.dom)return!0;if(!e||!this.dom.contains(e))return!1;for(;e&&this.dom!=e&&this.dom.contains(e);){if(e.contentEditable=="false")return!1;e=e.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&h3(this.dom),ai(this),this.domObserver.start()}get root(){let e=this._root;if(e==null){for(let n=this.dom.parentNode;n;n=n.parentNode)if(n.nodeType==9||n.nodeType==11&&n.host)return n.getSelection||(Object.getPrototypeOf(n).getSelection=()=>n.ownerDocument.getSelection()),this._root=n}return e||document}updateRoot(){this._root=null}posAtCoords(e){return v3(this,e)}coordsAtPos(e,n=1){return qT(this,e,n)}domAtPos(e,n=0){return this.docView.domFromPos(e,n)}nodeDOM(e){let n=this.docView.descAt(e);return n?n.nodeDOM:null}posAtDOM(e,n,r=-1){let i=this.docView.posFromDOM(e,n,r);if(i==null)throw new RangeError("DOM position not inside the editor");return i}endOfTextblock(e,n){return C3(this,n||this.state,e)}pasteHTML(e,n){return ou(this,"",e,!1,n||new ClipboardEvent("paste"))}pasteText(e,n){return ou(this,e,null,!0,n||new ClipboardEvent("paste"))}serializeForClipboard(e){return $0(this,e)}destroy(){this.docView&&(X3(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],Tm(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,e3())}get isDestroyed(){return this.docView==null}dispatchEvent(e){return e$(this,e)}dispatch(e){let n=this._props.dispatchTransaction;n?n.call(this,e):this.updateState(this.state.apply(e))}domSelectionRange(){let e=this.domSelection();return e?Ut&&this.root.nodeType===11&&o3(this.dom.ownerDocument)==this.dom&&S$(this,e)||e:{focusNode:null,focusOffset:0,anchorNode:null,anchorOffset:0}}domSelection(){return this.root.getSelection()}}function x1(t){let e=Object.create(null);return e.class="ProseMirror",e.contenteditable=String(t.editable),t.someProp("attributes",n=>{if(typeof n=="function"&&(n=n(t.state)),n)for(let r in n)r=="class"?e.class+=" "+n[r]:r=="style"?e.style=(e.style?e.style+";":"")+n[r]:!e[r]&&r!="contenteditable"&&r!="nodeName"&&(e[r]=String(n[r]))}),e.translate||(e.translate="no"),[an.node(0,t.state.doc.content.size,e)]}function w1(t){if(t.markCursor){let e=document.createElement("img");e.className="ProseMirror-separator",e.setAttribute("mark-placeholder","true"),e.setAttribute("alt",""),t.cursorWrapper={dom:e,deco:an.widget(t.state.selection.from,e,{raw:!0,marks:t.markCursor})}}else t.cursorWrapper=null}function b1(t){return!t.someProp("editable",e=>e(t.state)===!1)}function I$(t,e){let n=Math.min(t.$anchor.sharedDepth(t.head),e.$anchor.sharedDepth(e.head));return t.$anchor.start(n)!=e.$anchor.start(n)}function S1(t){let e=Object.create(null);function n(r){for(let i in r)Object.prototype.hasOwnProperty.call(e,i)||(e[i]=r[i])}return t.someProp("nodeViews",n),t.someProp("markViews",n),e}function A$(t,e){let n=0,r=0;for(let i in t){if(t[i]!=e[i])return!0;n++}for(let i in e)r++;return n!=r}function C1(t){if(t.spec.state||t.spec.filterTransaction||t.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}var To={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},nh={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},N$=typeof navigator<"u"&&/Mac/.test(navigator.platform),D$=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var gt=0;gt<10;gt++)To[48+gt]=To[96+gt]=String(gt);for(var gt=1;gt<=24;gt++)To[gt+111]="F"+gt;for(var gt=65;gt<=90;gt++)To[gt]=String.fromCharCode(gt+32),nh[gt]=String.fromCharCode(gt);for(var Rm in To)nh.hasOwnProperty(Rm)||(nh[Rm]=To[Rm]);function j$(t){var e=N$&&t.metaKey&&t.shiftKey&&!t.ctrlKey&&!t.altKey||D$&&t.shiftKey&&t.key&&t.key.length==1||t.key=="Unidentified",n=!e&&t.key||(t.shiftKey?nh:To)[t.keyCode]||t.key||"Unidentified";return n=="Esc"&&(n="Escape"),n=="Del"&&(n="Delete"),n=="Left"&&(n="ArrowLeft"),n=="Up"&&(n="ArrowUp"),n=="Right"&&(n="ArrowRight"),n=="Down"&&(n="ArrowDown"),n}const L$=typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):!1;function $$(t){let e=t.split(/-(?!$)/),n=e[e.length-1];n=="Space"&&(n=" ");let r,i,o,s;for(let a=0;a<e.length-1;a++){let l=e[a];if(/^(cmd|meta|m)$/i.test(l))s=!0;else if(/^a(lt)?$/i.test(l))r=!0;else if(/^(c|ctrl|control)$/i.test(l))i=!0;else if(/^s(hift)?$/i.test(l))o=!0;else if(/^mod$/i.test(l))L$?s=!0:i=!0;else throw new Error("Unrecognized modifier name: "+l)}return r&&(n="Alt-"+n),i&&(n="Ctrl-"+n),s&&(n="Meta-"+n),o&&(n="Shift-"+n),n}function F$(t){let e=Object.create(null);for(let n in t)e[$$(n)]=t[n];return e}function Om(t,e,n=!0){return e.altKey&&(t="Alt-"+t),e.ctrlKey&&(t="Ctrl-"+t),e.metaKey&&(t="Meta-"+t),n&&e.shiftKey&&(t="Shift-"+t),t}function B$(t){return new xt({props:{handleKeyDown:w_(t)}})}function w_(t){let e=F$(t);return function(n,r){let i=j$(r),o,s=e[Om(i,r)];if(s&&s(n.state,n.dispatch,n))return!0;if(i.length==1&&i!=" "){if(r.shiftKey){let a=e[Om(i,r,!1)];if(a&&a(n.state,n.dispatch,n))return!0}if((r.shiftKey||r.altKey||r.metaKey||i.charCodeAt(0)>127)&&(o=To[r.keyCode])&&o!=i){let a=e[Om(o,r)];if(a&&a(n.state,n.dispatch,n))return!0}}return!1}}const z$=(t,e)=>t.selection.empty?!1:(e&&e(t.tr.deleteSelection().scrollIntoView()),!0);function b_(t,e){let{$cursor:n}=t.selection;return!n||(e?!e.endOfTextblock("backward",t):n.parentOffset>0)?null:n}const V$=(t,e,n)=>{let r=b_(t,n);if(!r)return!1;let i=H0(r);if(!i){let s=r.blockRange(),a=s&&jl(s);return a==null?!1:(e&&e(t.tr.lift(s,a).scrollIntoView()),!0)}let o=i.nodeBefore;if(E_(t,i,e,-1))return!0;if(r.parent.content.size==0&&(pl(o,"end")||te.isSelectable(o)))for(let s=r.depth;;s--){let a=Yh(t.doc,r.before(s),r.after(s),W.empty);if(a&&a.slice.size<a.to-a.from){if(e){let l=t.tr.step(a);l.setSelection(pl(o,"end")?oe.findFrom(l.doc.resolve(l.mapping.map(i.pos,-1)),-1):te.create(l.doc,i.pos-o.nodeSize)),e(l.scrollIntoView())}return!0}if(s==1||r.node(s-1).childCount>1)break}return o.isAtom&&i.depth==r.depth-1?(e&&e(t.tr.delete(i.pos-o.nodeSize,i.pos).scrollIntoView()),!0):!1},U$=(t,e,n)=>{let r=b_(t,n);if(!r)return!1;let i=H0(r);return i?S_(t,i,e):!1},H$=(t,e,n)=>{let r=C_(t,n);if(!r)return!1;let i=W0(r);return i?S_(t,i,e):!1};function S_(t,e,n){let r=e.nodeBefore,i=r,o=e.pos-1;for(;!i.isTextblock;o--){if(i.type.spec.isolating)return!1;let u=i.lastChild;if(!u)return!1;i=u}let s=e.nodeAfter,a=s,l=e.pos+1;for(;!a.isTextblock;l++){if(a.type.spec.isolating)return!1;let u=a.firstChild;if(!u)return!1;a=u}let c=Yh(t.doc,o,l,W.empty);if(!c||c.from!=o||c instanceof st&&c.slice.size>=l-o)return!1;if(n){let u=t.tr.step(c);u.setSelection(ie.create(u.doc,o)),n(u.scrollIntoView())}return!0}function pl(t,e,n=!1){for(let r=t;r;r=e=="start"?r.firstChild:r.lastChild){if(r.isTextblock)return!0;if(n&&r.childCount!=1)return!1}return!1}const W$=(t,e,n)=>{let{$head:r,empty:i}=t.selection,o=r;if(!i)return!1;if(r.parent.isTextblock){if(n?!n.endOfTextblock("backward",t):r.parentOffset>0)return!1;o=H0(r)}let s=o&&o.nodeBefore;return!s||!te.isSelectable(s)?!1:(e&&e(t.tr.setSelection(te.create(t.doc,o.pos-s.nodeSize)).scrollIntoView()),!0)};function H0(t){if(!t.parent.type.spec.isolating)for(let e=t.depth-1;e>=0;e--){if(t.index(e)>0)return t.doc.resolve(t.before(e+1));if(t.node(e).type.spec.isolating)break}return null}function C_(t,e){let{$cursor:n}=t.selection;return!n||(e?!e.endOfTextblock("forward",t):n.parentOffset<n.parent.content.size)?null:n}const K$=(t,e,n)=>{let r=C_(t,n);if(!r)return!1;let i=W0(r);if(!i)return!1;let o=i.nodeAfter;if(E_(t,i,e,1))return!0;if(r.parent.content.size==0&&(pl(o,"start")||te.isSelectable(o))){let s=Yh(t.doc,r.before(),r.after(),W.empty);if(s&&s.slice.size<s.to-s.from){if(e){let a=t.tr.step(s);a.setSelection(pl(o,"start")?oe.findFrom(a.doc.resolve(a.mapping.map(i.pos)),1):te.create(a.doc,a.mapping.map(i.pos))),e(a.scrollIntoView())}return!0}}return o.isAtom&&i.depth==r.depth-1?(e&&e(t.tr.delete(i.pos,i.pos+o.nodeSize).scrollIntoView()),!0):!1},q$=(t,e,n)=>{let{$head:r,empty:i}=t.selection,o=r;if(!i)return!1;if(r.parent.isTextblock){if(n?!n.endOfTextblock("forward",t):r.parentOffset<r.parent.content.size)return!1;o=W0(r)}let s=o&&o.nodeAfter;return!s||!te.isSelectable(s)?!1:(e&&e(t.tr.setSelection(te.create(t.doc,o.pos)).scrollIntoView()),!0)};function W0(t){if(!t.parent.type.spec.isolating)for(let e=t.depth-1;e>=0;e--){let n=t.node(e);if(t.index(e)+1<n.childCount)return t.doc.resolve(t.after(e+1));if(n.type.spec.isolating)break}return null}const G$=(t,e)=>{let n=t.selection,r=n instanceof te,i;if(r){if(n.node.isTextblock||!Do(t.doc,n.from))return!1;i=n.from}else if(i=Jh(t.doc,n.from,-1),i==null)return!1;if(e){let o=t.tr.join(i);r&&o.setSelection(te.create(o.doc,i-t.doc.resolve(i).nodeBefore.nodeSize)),e(o.scrollIntoView())}return!0},J$=(t,e)=>{let n=t.selection,r;if(n instanceof te){if(n.node.isTextblock||!Do(t.doc,n.to))return!1;r=n.to}else if(r=Jh(t.doc,n.to,1),r==null)return!1;return e&&e(t.tr.join(r).scrollIntoView()),!0},Y$=(t,e)=>{let{$from:n,$to:r}=t.selection,i=n.blockRange(r),o=i&&jl(i);return o==null?!1:(e&&e(t.tr.lift(i,o).scrollIntoView()),!0)},Q$=(t,e)=>{let{$head:n,$anchor:r}=t.selection;return!n.parent.type.spec.code||!n.sameParent(r)?!1:(e&&e(t.tr.insertText(`
`).scrollIntoView()),!0)};function k_(t){for(let e=0;e<t.edgeCount;e++){let{type:n}=t.edge(e);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}const X$=(t,e)=>{let{$head:n,$anchor:r}=t.selection;if(!n.parent.type.spec.code||!n.sameParent(r))return!1;let i=n.node(-1),o=n.indexAfter(-1),s=k_(i.contentMatchAt(o));if(!s||!i.canReplaceWith(o,o,s))return!1;if(e){let a=n.after(),l=t.tr.replaceWith(a,a,s.createAndFill());l.setSelection(oe.near(l.doc.resolve(a),1)),e(l.scrollIntoView())}return!0},Z$=(t,e)=>{let n=t.selection,{$from:r,$to:i}=n;if(n instanceof $n||r.parent.inlineContent||i.parent.inlineContent)return!1;let o=k_(i.parent.contentMatchAt(i.indexAfter()));if(!o||!o.isTextblock)return!1;if(e){let s=(!r.parentOffset&&i.index()<i.parent.childCount?r:i).pos,a=t.tr.insert(s,o.createAndFill());a.setSelection(ie.create(a.doc,s+1)),e(a.scrollIntoView())}return!0},e4=(t,e)=>{let{$cursor:n}=t.selection;if(!n||n.parent.content.size)return!1;if(n.depth>1&&n.after()!=n.end(-1)){let o=n.before();if(La(t.doc,o))return e&&e(t.tr.split(o).scrollIntoView()),!0}let r=n.blockRange(),i=r&&jl(r);return i==null?!1:(e&&e(t.tr.lift(r,i).scrollIntoView()),!0)},t4=(t,e)=>{let{$from:n,to:r}=t.selection,i,o=n.sharedDepth(r);return o==0?!1:(i=n.before(o),e&&e(t.tr.setSelection(te.create(t.doc,i))),!0)};function n4(t,e,n){let r=e.nodeBefore,i=e.nodeAfter,o=e.index();return!r||!i||!r.type.compatibleContent(i.type)?!1:!r.content.size&&e.parent.canReplace(o-1,o)?(n&&n(t.tr.delete(e.pos-r.nodeSize,e.pos).scrollIntoView()),!0):!e.parent.canReplace(o,o+1)||!(i.isTextblock||Do(t.doc,e.pos))?!1:(n&&n(t.tr.join(e.pos).scrollIntoView()),!0)}function E_(t,e,n,r){let i=e.nodeBefore,o=e.nodeAfter,s,a,l=i.type.spec.isolating||o.type.spec.isolating;if(!l&&n4(t,e,n))return!0;let c=!l&&e.parent.canReplace(e.index(),e.index()+1);if(c&&(s=(a=i.contentMatchAt(i.childCount)).findWrapping(o.type))&&a.matchType(s[0]||o.type).validEnd){if(n){let p=e.pos+o.nodeSize,m=B.empty;for(let x=s.length-1;x>=0;x--)m=B.from(s[x].create(null,m));m=B.from(i.copy(m));let y=t.tr.step(new lt(e.pos-1,p,e.pos,p,new W(m,1,0),s.length,!0)),v=y.doc.resolve(p+2*s.length);v.nodeAfter&&v.nodeAfter.type==i.type&&Do(y.doc,v.pos)&&y.join(v.pos),n(y.scrollIntoView())}return!0}let u=o.type.spec.isolating||r>0&&l?null:oe.findFrom(e,1),d=u&&u.$from.blockRange(u.$to),h=d&&jl(d);if(h!=null&&h>=e.depth)return n&&n(t.tr.lift(d,h).scrollIntoView()),!0;if(c&&pl(o,"start",!0)&&pl(i,"end")){let p=i,m=[];for(;m.push(p),!p.isTextblock;)p=p.lastChild;let y=o,v=1;for(;!y.isTextblock;y=y.firstChild)v++;if(p.canReplace(p.childCount,p.childCount,y.content)){if(n){let x=B.empty;for(let b=m.length-1;b>=0;b--)x=B.from(m[b].copy(x));let w=t.tr.step(new lt(e.pos-m.length,e.pos+o.nodeSize,e.pos+v,e.pos+o.nodeSize-v,new W(x,m.length,0),0,!0));n(w.scrollIntoView())}return!0}}return!1}function T_(t){return function(e,n){let r=e.selection,i=t<0?r.$from:r.$to,o=i.depth;for(;i.node(o).isInline;){if(!o)return!1;o--}return i.node(o).isTextblock?(n&&n(e.tr.setSelection(ie.create(e.doc,t<0?i.start(o):i.end(o)))),!0):!1}}const r4=T_(-1),i4=T_(1);function o4(t,e=null){return function(n,r){let{$from:i,$to:o}=n.selection,s=i.blockRange(o),a=s&&A0(s,t,e);return a?(r&&r(n.tr.wrap(s,a).scrollIntoView()),!0):!1}}function k1(t,e=null){return function(n,r){let i=!1;for(let o=0;o<n.selection.ranges.length&&!i;o++){let{$from:{pos:s},$to:{pos:a}}=n.selection.ranges[o];n.doc.nodesBetween(s,a,(l,c)=>{if(i)return!1;if(!(!l.isTextblock||l.hasMarkup(t,e)))if(l.type==t)i=!0;else{let u=n.doc.resolve(c),d=u.index();i=u.parent.canReplaceWith(d,d+1,t)}})}if(!i)return!1;if(r){let o=n.tr;for(let s=0;s<n.selection.ranges.length;s++){let{$from:{pos:a},$to:{pos:l}}=n.selection.ranges[s];o.setBlockType(a,l,t,e)}r(o.scrollIntoView())}return!0}}typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform&&os.platform()=="darwin";function s4(t,e=null){return function(n,r){let{$from:i,$to:o}=n.selection,s=i.blockRange(o);if(!s)return!1;let a=r?n.tr:null;return a4(a,s,t,e)?(r&&r(a.scrollIntoView()),!0):!1}}function a4(t,e,n,r=null){let i=!1,o=e,s=e.$from.doc;if(e.depth>=2&&e.$from.node(e.depth-1).type.compatibleContent(n)&&e.startIndex==0){if(e.$from.index(e.depth-1)==0)return!1;let l=s.resolve(e.start-2);o=new Jf(l,l,e.depth),e.endIndex<e.parent.childCount&&(e=new Jf(e.$from,s.resolve(e.$to.end(e.depth)),e.depth)),i=!0}let a=A0(o,n,r,e);return a?(t&&l4(t,e,a,i,n),!0):!1}function l4(t,e,n,r,i){let o=B.empty;for(let u=n.length-1;u>=0;u--)o=B.from(n[u].type.create(n[u].attrs,o));t.step(new lt(e.start-(r?2:0),e.end,e.start,e.end,new W(o,0,0),n.length,!0));let s=0;for(let u=0;u<n.length;u++)n[u].type==i&&(s=u+1);let a=n.length-s,l=e.start+n.length-(r?2:0),c=e.parent;for(let u=e.startIndex,d=e.endIndex,h=!0;u<d;u++,h=!1)!h&&La(t.doc,l,a)&&(t.split(l,a),l+=2*a),l+=c.child(u).nodeSize;return t}function c4(t){return function(e,n){let{$from:r,$to:i}=e.selection,o=r.blockRange(i,s=>s.childCount>0&&s.firstChild.type==t);return o?n?r.node(o.depth-1).type==t?u4(e,n,t,o):d4(e,n,o):!0:!1}}function u4(t,e,n,r){let i=t.tr,o=r.end,s=r.$to.end(r.depth);o<s&&(i.step(new lt(o-1,s,o,s,new W(B.from(n.create(null,r.parent.copy())),1,0),1,!0)),r=new Jf(i.doc.resolve(r.$from.pos),i.doc.resolve(s),r.depth));const a=jl(r);if(a==null)return!1;i.lift(r,a);let l=i.doc.resolve(i.mapping.map(o,-1)-1);return Do(i.doc,l.pos)&&l.nodeBefore.type==l.nodeAfter.type&&i.join(l.pos),e(i.scrollIntoView()),!0}function d4(t,e,n){let r=t.tr,i=n.parent;for(let p=n.end,m=n.endIndex-1,y=n.startIndex;m>y;m--)p-=i.child(m).nodeSize,r.delete(p-1,p+1);let o=r.doc.resolve(n.start),s=o.nodeAfter;if(r.mapping.map(n.end)!=n.start+o.nodeAfter.nodeSize)return!1;let a=n.startIndex==0,l=n.endIndex==i.childCount,c=o.node(-1),u=o.index(-1);if(!c.canReplace(u+(a?0:1),u+1,s.content.append(l?B.empty:B.from(i))))return!1;let d=o.pos,h=d+s.nodeSize;return r.step(new lt(d-(a?1:0),h+(l?1:0),d+1,h-1,new W((a?B.empty:B.from(i.copy(B.empty))).append(l?B.empty:B.from(i.copy(B.empty))),a?0:1,l?0:1),a?0:1)),e(r.scrollIntoView()),!0}function f4(t){return function(e,n){let{$from:r,$to:i}=e.selection,o=r.blockRange(i,c=>c.childCount>0&&c.firstChild.type==t);if(!o)return!1;let s=o.startIndex;if(s==0)return!1;let a=o.parent,l=a.child(s-1);if(l.type!=t)return!1;if(n){let c=l.lastChild&&l.lastChild.type==a.type,u=B.from(c?t.create():null),d=new W(B.from(t.create(null,B.from(a.type.create(null,u)))),c?3:1,0),h=o.start,p=o.end;n(e.tr.step(new lt(h-(c?3:1),p,h,p,d,1,!0)).scrollIntoView())}return!0}}function tp(t){const{state:e,transaction:n}=t;let{selection:r}=n,{doc:i}=n,{storedMarks:o}=n;return{...e,apply:e.apply.bind(e),applyTransaction:e.applyTransaction.bind(e),plugins:e.plugins,schema:e.schema,reconfigure:e.reconfigure.bind(e),toJSON:e.toJSON.bind(e),get storedMarks(){return o},get selection(){return r},get doc(){return i},get tr(){return r=n.selection,i=n.doc,o=n.storedMarks,n}}}class np{constructor(e){this.editor=e.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=e.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:e,editor:n,state:r}=this,{view:i}=n,{tr:o}=r,s=this.buildProps(o);return Object.fromEntries(Object.entries(e).map(([a,l])=>[a,(...u)=>{const d=l(...u)(s);return!o.getMeta("preventDispatch")&&!this.hasCustomState&&i.dispatch(o),d}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(e,n=!0){const{rawCommands:r,editor:i,state:o}=this,{view:s}=i,a=[],l=!!e,c=e||o.tr,u=()=>(!l&&n&&!c.getMeta("preventDispatch")&&!this.hasCustomState&&s.dispatch(c),a.every(h=>h===!0)),d={...Object.fromEntries(Object.entries(r).map(([h,p])=>[h,(...y)=>{const v=this.buildProps(c,n),x=p(...y)(v);return a.push(x),d}])),run:u};return d}createCan(e){const{rawCommands:n,state:r}=this,i=!1,o=e||r.tr,s=this.buildProps(o,i);return{...Object.fromEntries(Object.entries(n).map(([l,c])=>[l,(...u)=>c(...u)({...s,dispatch:void 0})])),chain:()=>this.createChain(o,i)}}buildProps(e,n=!0){const{rawCommands:r,editor:i,state:o}=this,{view:s}=i,a={tr:e,editor:i,view:s,state:tp({state:o,transaction:e}),dispatch:n?()=>{}:void 0,chain:()=>this.createChain(e,n),can:()=>this.createCan(e),get commands(){return Object.fromEntries(Object.entries(r).map(([l,c])=>[l,(...u)=>c(...u)(a)]))}};return a}}class h4{constructor(){this.callbacks={}}on(e,n){return this.callbacks[e]||(this.callbacks[e]=[]),this.callbacks[e].push(n),this}emit(e,...n){const r=this.callbacks[e];return r&&r.forEach(i=>i.apply(this,n)),this}off(e,n){const r=this.callbacks[e];return r&&(n?this.callbacks[e]=r.filter(i=>i!==n):delete this.callbacks[e]),this}once(e,n){const r=(...i)=>{this.off(e,r),n.apply(this,i)};return this.on(e,r)}removeAllListeners(){this.callbacks={}}}function Y(t,e,n){return t.config[e]===void 0&&t.parent?Y(t.parent,e,n):typeof t.config[e]=="function"?t.config[e].bind({...n,parent:t.parent?Y(t.parent,e,n):null}):t.config[e]}function rp(t){const e=t.filter(i=>i.type==="extension"),n=t.filter(i=>i.type==="node"),r=t.filter(i=>i.type==="mark");return{baseExtensions:e,nodeExtensions:n,markExtensions:r}}function __(t){const e=[],{nodeExtensions:n,markExtensions:r}=rp(t),i=[...n,...r],o={default:null,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return t.forEach(s=>{const a={name:s.name,options:s.options,storage:s.storage,extensions:i},l=Y(s,"addGlobalAttributes",a);if(!l)return;l().forEach(u=>{u.types.forEach(d=>{Object.entries(u.attributes).forEach(([h,p])=>{e.push({type:d,name:h,attribute:{...o,...p}})})})})}),i.forEach(s=>{const a={name:s.name,options:s.options,storage:s.storage},l=Y(s,"addAttributes",a);if(!l)return;const c=l();Object.entries(c).forEach(([u,d])=>{const h={...o,...d};typeof(h==null?void 0:h.default)=="function"&&(h.default=h.default()),h!=null&&h.isRequired&&(h==null?void 0:h.default)===void 0&&delete h.default,e.push({type:s.name,name:u,attribute:h})})}),e}function ut(t,e){if(typeof t=="string"){if(!e.nodes[t])throw Error(`There is no node type named '${t}'. Maybe you forgot to add the extension?`);return e.nodes[t]}return t}function Kt(...t){return t.filter(e=>!!e).reduce((e,n)=>{const r={...e};return Object.entries(n).forEach(([i,o])=>{if(!r[i]){r[i]=o;return}if(i==="class"){const a=o?String(o).split(" "):[],l=r[i]?r[i].split(" "):[],c=a.filter(u=>!l.includes(u));r[i]=[...l,...c].join(" ")}else if(i==="style"){const a=o?o.split(";").map(u=>u.trim()).filter(Boolean):[],l=r[i]?r[i].split(";").map(u=>u.trim()).filter(Boolean):[],c=new Map;l.forEach(u=>{const[d,h]=u.split(":").map(p=>p.trim());c.set(d,h)}),a.forEach(u=>{const[d,h]=u.split(":").map(p=>p.trim());c.set(d,h)}),r[i]=Array.from(c.entries()).map(([u,d])=>`${u}: ${d}`).join("; ")}else r[i]=o}),r},{})}function $y(t,e){return e.filter(n=>n.type===t.type.name).filter(n=>n.attribute.rendered).map(n=>n.attribute.renderHTML?n.attribute.renderHTML(t.attrs)||{}:{[n.name]:t.attrs[n.name]}).reduce((n,r)=>Kt(n,r),{})}function R_(t){return typeof t=="function"}function ce(t,e=void 0,...n){return R_(t)?e?t.bind(e)(...n):t(...n):t}function p4(t={}){return Object.keys(t).length===0&&t.constructor===Object}function m4(t){return typeof t!="string"?t:t.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(t):t==="true"?!0:t==="false"?!1:t}function E1(t,e){return"style"in t?t:{...t,getAttrs:n=>{const r=t.getAttrs?t.getAttrs(n):t.attrs;if(r===!1)return!1;const i=e.reduce((o,s)=>{const a=s.attribute.parseHTML?s.attribute.parseHTML(n):m4(n.getAttribute(s.name));return a==null?o:{...o,[s.name]:a}},{});return{...r,...i}}}}function T1(t){return Object.fromEntries(Object.entries(t).filter(([e,n])=>e==="attrs"&&p4(n)?!1:n!=null))}function g4(t,e){var n;const r=__(t),{nodeExtensions:i,markExtensions:o}=rp(t),s=(n=i.find(c=>Y(c,"topNode")))===null||n===void 0?void 0:n.name,a=Object.fromEntries(i.map(c=>{const u=r.filter(x=>x.type===c.name),d={name:c.name,options:c.options,storage:c.storage,editor:e},h=t.reduce((x,w)=>{const b=Y(w,"extendNodeSchema",d);return{...x,...b?b(c):{}}},{}),p=T1({...h,content:ce(Y(c,"content",d)),marks:ce(Y(c,"marks",d)),group:ce(Y(c,"group",d)),inline:ce(Y(c,"inline",d)),atom:ce(Y(c,"atom",d)),selectable:ce(Y(c,"selectable",d)),draggable:ce(Y(c,"draggable",d)),code:ce(Y(c,"code",d)),whitespace:ce(Y(c,"whitespace",d)),linebreakReplacement:ce(Y(c,"linebreakReplacement",d)),defining:ce(Y(c,"defining",d)),isolating:ce(Y(c,"isolating",d)),attrs:Object.fromEntries(u.map(x=>{var w;return[x.name,{default:(w=x==null?void 0:x.attribute)===null||w===void 0?void 0:w.default}]}))}),m=ce(Y(c,"parseHTML",d));m&&(p.parseDOM=m.map(x=>E1(x,u)));const y=Y(c,"renderHTML",d);y&&(p.toDOM=x=>y({node:x,HTMLAttributes:$y(x,u)}));const v=Y(c,"renderText",d);return v&&(p.toText=v),[c.name,p]})),l=Object.fromEntries(o.map(c=>{const u=r.filter(v=>v.type===c.name),d={name:c.name,options:c.options,storage:c.storage,editor:e},h=t.reduce((v,x)=>{const w=Y(x,"extendMarkSchema",d);return{...v,...w?w(c):{}}},{}),p=T1({...h,inclusive:ce(Y(c,"inclusive",d)),excludes:ce(Y(c,"excludes",d)),group:ce(Y(c,"group",d)),spanning:ce(Y(c,"spanning",d)),code:ce(Y(c,"code",d)),attrs:Object.fromEntries(u.map(v=>{var x;return[v.name,{default:(x=v==null?void 0:v.attribute)===null||x===void 0?void 0:x.default}]}))}),m=ce(Y(c,"parseHTML",d));m&&(p.parseDOM=m.map(v=>E1(v,u)));const y=Y(c,"renderHTML",d);return y&&(p.toDOM=v=>y({mark:v,HTMLAttributes:$y(v,u)})),[c.name,p]}));return new CT({topNode:s,nodes:a,marks:l})}function Pm(t,e){return e.nodes[t]||e.marks[t]||null}function _1(t,e){return Array.isArray(e)?e.some(n=>(typeof n=="string"?n:n.name)===t.name):e}function K0(t,e){const n=Ws.fromSchema(e).serializeFragment(t),i=document.implementation.createHTMLDocument().createElement("div");return i.appendChild(n),i.innerHTML}const y4=(t,e=500)=>{let n="";const r=t.parentOffset;return t.parent.nodesBetween(Math.max(0,r-e),r,(i,o,s,a)=>{var l,c;const u=((c=(l=i.type.spec).toText)===null||c===void 0?void 0:c.call(l,{node:i,pos:o,parent:s,index:a}))||i.textContent||"%leaf%";n+=i.isAtom&&!i.isText?u:u.slice(0,Math.max(0,r-o))}),n};function q0(t){return Object.prototype.toString.call(t)==="[object RegExp]"}class ip{constructor(e){this.find=e.find,this.handler=e.handler}}const v4=(t,e)=>{if(q0(e))return e.exec(t);const n=e(t);if(!n)return null;const r=[n.text];return r.index=n.index,r.input=t,r.data=n.data,n.replaceWith&&(n.text.includes(n.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),r.push(n.replaceWith)),r};function Pd(t){var e;const{editor:n,from:r,to:i,text:o,rules:s,plugin:a}=t,{view:l}=n;if(l.composing)return!1;const c=l.state.doc.resolve(r);if(c.parent.type.spec.code||!((e=c.nodeBefore||c.nodeAfter)===null||e===void 0)&&e.marks.find(h=>h.type.spec.code))return!1;let u=!1;const d=y4(c)+o;return s.forEach(h=>{if(u)return;const p=v4(d,h.find);if(!p)return;const m=l.state.tr,y=tp({state:l.state,transaction:m}),v={from:r-(p[0].length-o.length),to:i},{commands:x,chain:w,can:b}=new np({editor:n,state:y});h.handler({state:y,range:v,match:p,commands:x,chain:w,can:b})===null||!m.steps.length||(m.setMeta(a,{transform:m,from:r,to:i,text:o}),l.dispatch(m),u=!0)}),u}function x4(t){const{editor:e,rules:n}=t,r=new xt({state:{init(){return null},apply(i,o,s){const a=i.getMeta(r);if(a)return a;const l=i.getMeta("applyInputRules");return!!l&&setTimeout(()=>{let{text:u}=l;typeof u=="string"?u=u:u=K0(B.from(u),s.schema);const{from:d}=l,h=d+u.length;Pd({editor:e,from:d,to:h,text:u,rules:n,plugin:r})}),i.selectionSet||i.docChanged?null:o}},props:{handleTextInput(i,o,s,a){return Pd({editor:e,from:o,to:s,text:a,rules:n,plugin:r})},handleDOMEvents:{compositionend:i=>(setTimeout(()=>{const{$cursor:o}=i.state.selection;o&&Pd({editor:e,from:o.pos,to:o.pos,text:"",rules:n,plugin:r})}),!1)},handleKeyDown(i,o){if(o.key!=="Enter")return!1;const{$cursor:s}=i.state.selection;return s?Pd({editor:e,from:s.pos,to:s.pos,text:`
`,rules:n,plugin:r}):!1}},isInputRules:!0});return r}function w4(t){return Object.prototype.toString.call(t).slice(8,-1)}function Md(t){return w4(t)!=="Object"?!1:t.constructor===Object&&Object.getPrototypeOf(t)===Object.prototype}function op(t,e){const n={...t};return Md(t)&&Md(e)&&Object.keys(e).forEach(r=>{Md(e[r])&&Md(t[r])?n[r]=op(t[r],e[r]):n[r]=e[r]}),n}class _o{constructor(e={}){this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=ce(Y(this,"addOptions",{name:this.name}))),this.storage=ce(Y(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new _o(e)}configure(e={}){const n=this.extend({...this.config,addOptions:()=>op(this.options,e)});return n.name=this.name,n.parent=this.parent,n}extend(e={}){const n=new _o(e);return n.parent=this,this.child=n,n.name=e.name?e.name:n.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=ce(Y(n,"addOptions",{name:n.name})),n.storage=ce(Y(n,"addStorage",{name:n.name,options:n.options})),n}static handleExit({editor:e,mark:n}){const{tr:r}=e.state,i=e.state.selection.$from;if(i.pos===i.end()){const s=i.marks();if(!!!s.find(c=>(c==null?void 0:c.type.name)===n.name))return!1;const l=s.find(c=>(c==null?void 0:c.type.name)===n.name);return l&&r.removeStoredMark(l),r.insertText(" ",i.pos),e.view.dispatch(r),!0}return!1}}function b4(t){return typeof t=="number"}class S4{constructor(e){this.find=e.find,this.handler=e.handler}}const C4=(t,e,n)=>{if(q0(e))return[...t.matchAll(e)];const r=e(t,n);return r?r.map(i=>{const o=[i.text];return o.index=i.index,o.input=t,o.data=i.data,i.replaceWith&&(i.text.includes(i.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),o.push(i.replaceWith)),o}):[]};function k4(t){const{editor:e,state:n,from:r,to:i,rule:o,pasteEvent:s,dropEvent:a}=t,{commands:l,chain:c,can:u}=new np({editor:e,state:n}),d=[];return n.doc.nodesBetween(r,i,(p,m)=>{if(!p.isTextblock||p.type.spec.code)return;const y=Math.max(r,m),v=Math.min(i,m+p.content.size),x=p.textBetween(y-m,v-m,void 0,"￼");C4(x,o.find,s).forEach(b=>{if(b.index===void 0)return;const S=y+b.index+1,C=S+b[0].length,k={from:n.tr.mapping.map(S),to:n.tr.mapping.map(C)},E=o.handler({state:n,range:k,match:b,commands:l,chain:c,can:u,pasteEvent:s,dropEvent:a});d.push(E)})}),d.every(p=>p!==null)}let Id=null;const E4=t=>{var e;const n=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return(e=n.clipboardData)===null||e===void 0||e.setData("text/html",t),n};function T4(t){const{editor:e,rules:n}=t;let r=null,i=!1,o=!1,s=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,a;try{a=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{a=null}const l=({state:u,from:d,to:h,rule:p,pasteEvt:m})=>{const y=u.tr,v=tp({state:u,transaction:y});if(!(!k4({editor:e,state:v,from:Math.max(d-1,0),to:h.b-1,rule:p,pasteEvent:m,dropEvent:a})||!y.steps.length)){try{a=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{a=null}return s=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,y}};return n.map(u=>new xt({view(d){const h=m=>{var y;r=!((y=d.dom.parentElement)===null||y===void 0)&&y.contains(m.target)?d.dom.parentElement:null,r&&(Id=e)},p=()=>{Id&&(Id=null)};return window.addEventListener("dragstart",h),window.addEventListener("dragend",p),{destroy(){window.removeEventListener("dragstart",h),window.removeEventListener("dragend",p)}}},props:{handleDOMEvents:{drop:(d,h)=>{if(o=r===d.dom.parentElement,a=h,!o){const p=Id;p&&setTimeout(()=>{const m=p.state.selection;m&&p.commands.deleteRange({from:m.from,to:m.to})},10)}return!1},paste:(d,h)=>{var p;const m=(p=h.clipboardData)===null||p===void 0?void 0:p.getData("text/html");return s=h,i=!!(m!=null&&m.includes("data-pm-slice")),!1}}},appendTransaction:(d,h,p)=>{const m=d[0],y=m.getMeta("uiEvent")==="paste"&&!i,v=m.getMeta("uiEvent")==="drop"&&!o,x=m.getMeta("applyPasteRules"),w=!!x;if(!y&&!v&&!w)return;if(w){let{text:C}=x;typeof C=="string"?C=C:C=K0(B.from(C),p.schema);const{from:k}=x,E=k+C.length,T=E4(C);return l({rule:u,state:p,from:k,to:{b:E},pasteEvt:T})}const b=h.doc.content.findDiffStart(p.doc.content),S=h.doc.content.findDiffEnd(p.doc.content);if(!(!b4(b)||!S||b===S.b))return l({rule:u,state:p,from:b,to:S,pasteEvt:s})}}))}function _4(t){const e=t.filter((n,r)=>t.indexOf(n)!==r);return Array.from(new Set(e))}class _a{constructor(e,n){this.splittableMarks=[],this.editor=n,this.extensions=_a.resolve(e),this.schema=g4(this.extensions,n),this.setupExtensions()}static resolve(e){const n=_a.sort(_a.flatten(e)),r=_4(n.map(i=>i.name));return r.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${r.map(i=>`'${i}'`).join(", ")}]. This can lead to issues.`),n}static flatten(e){return e.map(n=>{const r={name:n.name,options:n.options,storage:n.storage},i=Y(n,"addExtensions",r);return i?[n,...this.flatten(i())]:n}).flat(10)}static sort(e){return e.sort((r,i)=>{const o=Y(r,"priority")||100,s=Y(i,"priority")||100;return o>s?-1:o<s?1:0})}get commands(){return this.extensions.reduce((e,n)=>{const r={name:n.name,options:n.options,storage:n.storage,editor:this.editor,type:Pm(n.name,this.schema)},i=Y(n,"addCommands",r);return i?{...e,...i()}:e},{})}get plugins(){const{editor:e}=this,n=_a.sort([...this.extensions].reverse()),r=[],i=[],o=n.map(s=>{const a={name:s.name,options:s.options,storage:s.storage,editor:e,type:Pm(s.name,this.schema)},l=[],c=Y(s,"addKeyboardShortcuts",a);let u={};if(s.type==="mark"&&Y(s,"exitable",a)&&(u.ArrowRight=()=>_o.handleExit({editor:e,mark:s})),c){const y=Object.fromEntries(Object.entries(c()).map(([v,x])=>[v,()=>x({editor:e})]));u={...u,...y}}const d=B$(u);l.push(d);const h=Y(s,"addInputRules",a);_1(s,e.options.enableInputRules)&&h&&r.push(...h());const p=Y(s,"addPasteRules",a);_1(s,e.options.enablePasteRules)&&p&&i.push(...p());const m=Y(s,"addProseMirrorPlugins",a);if(m){const y=m();l.push(...y)}return l}).flat();return[x4({editor:e,rules:r}),...T4({editor:e,rules:i}),...o]}get attributes(){return __(this.extensions)}get nodeViews(){const{editor:e}=this,{nodeExtensions:n}=rp(this.extensions);return Object.fromEntries(n.filter(r=>!!Y(r,"addNodeView")).map(r=>{const i=this.attributes.filter(l=>l.type===r.name),o={name:r.name,options:r.options,storage:r.storage,editor:e,type:ut(r.name,this.schema)},s=Y(r,"addNodeView",o);if(!s)return[];const a=(l,c,u,d,h)=>{const p=$y(l,i);return s()({node:l,view:c,getPos:u,decorations:d,innerDecorations:h,editor:e,extension:r,HTMLAttributes:p})};return[r.name,a]}))}setupExtensions(){this.extensions.forEach(e=>{var n;this.editor.extensionStorage[e.name]=e.storage;const r={name:e.name,options:e.options,storage:e.storage,editor:this.editor,type:Pm(e.name,this.schema)};e.type==="mark"&&(!((n=ce(Y(e,"keepOnSplit",r)))!==null&&n!==void 0)||n)&&this.splittableMarks.push(e.name);const i=Y(e,"onBeforeCreate",r),o=Y(e,"onCreate",r),s=Y(e,"onUpdate",r),a=Y(e,"onSelectionUpdate",r),l=Y(e,"onTransaction",r),c=Y(e,"onFocus",r),u=Y(e,"onBlur",r),d=Y(e,"onDestroy",r);i&&this.editor.on("beforeCreate",i),o&&this.editor.on("create",o),s&&this.editor.on("update",s),a&&this.editor.on("selectionUpdate",a),l&&this.editor.on("transaction",l),c&&this.editor.on("focus",c),u&&this.editor.on("blur",u),d&&this.editor.on("destroy",d)})}}class dt{constructor(e={}){this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=ce(Y(this,"addOptions",{name:this.name}))),this.storage=ce(Y(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new dt(e)}configure(e={}){const n=this.extend({...this.config,addOptions:()=>op(this.options,e)});return n.name=this.name,n.parent=this.parent,n}extend(e={}){const n=new dt({...this.config,...e});return n.parent=this,this.child=n,n.name=e.name?e.name:n.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=ce(Y(n,"addOptions",{name:n.name})),n.storage=ce(Y(n,"addStorage",{name:n.name,options:n.options})),n}}function O_(t,e,n){const{from:r,to:i}=e,{blockSeparator:o=`

`,textSerializers:s={}}=n||{};let a="";return t.nodesBetween(r,i,(l,c,u,d)=>{var h;l.isBlock&&c>r&&(a+=o);const p=s==null?void 0:s[l.type.name];if(p)return u&&(a+=p({node:l,pos:c,parent:u,index:d,range:e})),!1;l.isText&&(a+=(h=l==null?void 0:l.text)===null||h===void 0?void 0:h.slice(Math.max(r,c)-c,i-c))}),a}function P_(t){return Object.fromEntries(Object.entries(t.nodes).filter(([,e])=>e.spec.toText).map(([e,n])=>[e,n.spec.toText]))}const R4=dt.create({name:"clipboardTextSerializer",addOptions(){return{blockSeparator:void 0}},addProseMirrorPlugins(){return[new xt({key:new Rn("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:t}=this,{state:e,schema:n}=t,{doc:r,selection:i}=e,{ranges:o}=i,s=Math.min(...o.map(u=>u.$from.pos)),a=Math.max(...o.map(u=>u.$to.pos)),l=P_(n);return O_(r,{from:s,to:a},{...this.options.blockSeparator!==void 0?{blockSeparator:this.options.blockSeparator}:{},textSerializers:l})}}})]}}),O4=()=>({editor:t,view:e})=>(requestAnimationFrame(()=>{var n;t.isDestroyed||(e.dom.blur(),(n=window==null?void 0:window.getSelection())===null||n===void 0||n.removeAllRanges())}),!0),P4=(t=!1)=>({commands:e})=>e.setContent("",t),M4=()=>({state:t,tr:e,dispatch:n})=>{const{selection:r}=e,{ranges:i}=r;return n&&i.forEach(({$from:o,$to:s})=>{t.doc.nodesBetween(o.pos,s.pos,(a,l)=>{if(a.type.isText)return;const{doc:c,mapping:u}=e,d=c.resolve(u.map(l)),h=c.resolve(u.map(l+a.nodeSize)),p=d.blockRange(h);if(!p)return;const m=jl(p);if(a.type.isTextblock){const{defaultType:y}=d.parent.contentMatchAt(d.index());e.setNodeMarkup(p.start,y)}(m||m===0)&&e.lift(p,m)})}),!0},I4=t=>e=>t(e),A4=()=>({state:t,dispatch:e})=>Z$(t,e),N4=(t,e)=>({editor:n,tr:r})=>{const{state:i}=n,o=i.doc.slice(t.from,t.to);r.deleteRange(t.from,t.to);const s=r.mapping.map(e);return r.insert(s,o.content),r.setSelection(new ie(r.doc.resolve(s-1))),!0},D4=()=>({tr:t,dispatch:e})=>{const{selection:n}=t,r=n.$anchor.node();if(r.content.size>0)return!1;const i=t.selection.$anchor;for(let o=i.depth;o>0;o-=1)if(i.node(o).type===r.type){if(e){const a=i.before(o),l=i.after(o);t.delete(a,l).scrollIntoView()}return!0}return!1},j4=t=>({tr:e,state:n,dispatch:r})=>{const i=ut(t,n.schema),o=e.selection.$anchor;for(let s=o.depth;s>0;s-=1)if(o.node(s).type===i){if(r){const l=o.before(s),c=o.after(s);e.delete(l,c).scrollIntoView()}return!0}return!1},L4=t=>({tr:e,dispatch:n})=>{const{from:r,to:i}=t;return n&&e.delete(r,i),!0},$4=()=>({state:t,dispatch:e})=>z$(t,e),F4=()=>({commands:t})=>t.keyboardShortcut("Enter"),B4=()=>({state:t,dispatch:e})=>X$(t,e);function rh(t,e,n={strict:!0}){const r=Object.keys(e);return r.length?r.every(i=>n.strict?e[i]===t[i]:q0(e[i])?e[i].test(t[i]):e[i]===t[i]):!0}function M_(t,e,n={}){return t.find(r=>r.type===e&&rh(Object.fromEntries(Object.keys(n).map(i=>[i,r.attrs[i]])),n))}function R1(t,e,n={}){return!!M_(t,e,n)}function G0(t,e,n){var r;if(!t||!e)return;let i=t.parent.childAfter(t.parentOffset);if((!i.node||!i.node.marks.some(u=>u.type===e))&&(i=t.parent.childBefore(t.parentOffset)),!i.node||!i.node.marks.some(u=>u.type===e)||(n=n||((r=i.node.marks[0])===null||r===void 0?void 0:r.attrs),!M_([...i.node.marks],e,n)))return;let s=i.index,a=t.start()+i.offset,l=s+1,c=a+i.node.nodeSize;for(;s>0&&R1([...t.parent.child(s-1).marks],e,n);)s-=1,a-=t.parent.child(s).nodeSize;for(;l<t.parent.childCount&&R1([...t.parent.child(l).marks],e,n);)c+=t.parent.child(l).nodeSize,l+=1;return{from:a,to:c}}function Lo(t,e){if(typeof t=="string"){if(!e.marks[t])throw Error(`There is no mark type named '${t}'. Maybe you forgot to add the extension?`);return e.marks[t]}return t}const z4=(t,e={})=>({tr:n,state:r,dispatch:i})=>{const o=Lo(t,r.schema),{doc:s,selection:a}=n,{$from:l,from:c,to:u}=a;if(i){const d=G0(l,o,e);if(d&&d.from<=c&&d.to>=u){const h=ie.create(s,d.from,d.to);n.setSelection(h)}}return!0},V4=t=>e=>{const n=typeof t=="function"?t(e):t;for(let r=0;r<n.length;r+=1)if(n[r](e))return!0;return!1};function J0(t){return t instanceof ie}function ii(t=0,e=0,n=0){return Math.min(Math.max(t,e),n)}function I_(t,e=null){if(!e)return null;const n=oe.atStart(t),r=oe.atEnd(t);if(e==="start"||e===!0)return n;if(e==="end")return r;const i=n.from,o=r.to;return e==="all"?ie.create(t,ii(0,i,o),ii(t.content.size,i,o)):ie.create(t,ii(e,i,o),ii(e,i,o))}function U4(){return navigator.platform==="Android"||/android/i.test(navigator.userAgent)}function Y0(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}const H4=(t=null,e={})=>({editor:n,view:r,tr:i,dispatch:o})=>{e={scrollIntoView:!0,...e};const s=()=>{(Y0()||U4())&&r.dom.focus(),requestAnimationFrame(()=>{n.isDestroyed||(r.focus(),e!=null&&e.scrollIntoView&&n.commands.scrollIntoView())})};if(r.hasFocus()&&t===null||t===!1)return!0;if(o&&t===null&&!J0(n.state.selection))return s(),!0;const a=I_(i.doc,t)||n.state.selection,l=n.state.selection.eq(a);return o&&(l||i.setSelection(a),l&&i.storedMarks&&i.setStoredMarks(i.storedMarks),s()),!0},W4=(t,e)=>n=>t.every((r,i)=>e(r,{...n,index:i})),K4=(t,e)=>({tr:n,commands:r})=>r.insertContentAt({from:n.selection.from,to:n.selection.to},t,e),A_=t=>{const e=t.childNodes;for(let n=e.length-1;n>=0;n-=1){const r=e[n];r.nodeType===3&&r.nodeValue&&/^(\n\s\s|\n)$/.test(r.nodeValue)?t.removeChild(r):r.nodeType===1&&A_(r)}return t};function Ad(t){const e=`<body>${t}</body>`,n=new window.DOMParser().parseFromString(e,"text/html").body;return A_(n)}function ih(t,e,n){if(t instanceof vo||t instanceof B)return t;n={slice:!0,parseOptions:{},...n};const r=typeof t=="object"&&t!==null,i=typeof t=="string";if(r)try{if(Array.isArray(t)&&t.length>0)return B.fromArray(t.map(a=>e.nodeFromJSON(a)));const s=e.nodeFromJSON(t);return n.errorOnInvalidContent&&s.check(),s}catch(o){if(n.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:o});return console.warn("[tiptap warn]: Invalid content.","Passed value:",t,"Error:",o),ih("",e,n)}if(i){if(n.errorOnInvalidContent){let s=!1,a="";const l=new CT({topNode:e.spec.topNode,marks:e.spec.marks,nodes:e.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:c=>(s=!0,a=typeof c=="string"?c:c.outerHTML,null)}]}})});if(n.slice?xo.fromSchema(l).parseSlice(Ad(t),n.parseOptions):xo.fromSchema(l).parse(Ad(t),n.parseOptions),n.errorOnInvalidContent&&s)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${a}`)})}const o=xo.fromSchema(e);return n.slice?o.parseSlice(Ad(t),n.parseOptions).content:o.parse(Ad(t),n.parseOptions)}return ih("",e,n)}function q4(t,e,n){const r=t.steps.length-1;if(r<e)return;const i=t.steps[r];if(!(i instanceof st||i instanceof lt))return;const o=t.mapping.maps[r];let s=0;o.forEach((a,l,c,u)=>{s===0&&(s=u)}),t.setSelection(oe.near(t.doc.resolve(s),n))}const G4=t=>!("type"in t),J4=(t,e,n)=>({tr:r,dispatch:i,editor:o})=>{var s;if(i){n={parseOptions:o.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...n};let a;try{a=ih(e,o.schema,{parseOptions:{preserveWhitespace:"full",...n.parseOptions},errorOnInvalidContent:(s=n.errorOnInvalidContent)!==null&&s!==void 0?s:o.options.enableContentCheck})}catch(m){return o.emit("contentError",{editor:o,error:m,disableCollaboration:()=>{o.storage.collaboration&&(o.storage.collaboration.isDisabled=!0)}}),!1}let{from:l,to:c}=typeof t=="number"?{from:t,to:t}:{from:t.from,to:t.to},u=!0,d=!0;if((G4(a)?a:[a]).forEach(m=>{m.check(),u=u?m.isText&&m.marks.length===0:!1,d=d?m.isBlock:!1}),l===c&&d){const{parent:m}=r.doc.resolve(l);m.isTextblock&&!m.type.spec.code&&!m.childCount&&(l-=1,c+=1)}let p;if(u){if(Array.isArray(e))p=e.map(m=>m.text||"").join("");else if(e instanceof B){let m="";e.forEach(y=>{y.text&&(m+=y.text)}),p=m}else typeof e=="object"&&e&&e.text?p=e.text:p=e;r.insertText(p,l,c)}else p=a,r.replaceWith(l,c,p);n.updateSelection&&q4(r,r.steps.length-1,-1),n.applyInputRules&&r.setMeta("applyInputRules",{from:l,text:p}),n.applyPasteRules&&r.setMeta("applyPasteRules",{from:l,text:p})}return!0},Y4=()=>({state:t,dispatch:e})=>G$(t,e),Q4=()=>({state:t,dispatch:e})=>J$(t,e),X4=()=>({state:t,dispatch:e})=>V$(t,e),Z4=()=>({state:t,dispatch:e})=>K$(t,e),eF=()=>({state:t,dispatch:e,tr:n})=>{try{const r=Jh(t.doc,t.selection.$from.pos,-1);return r==null?!1:(n.join(r,2),e&&e(n),!0)}catch{return!1}},tF=()=>({state:t,dispatch:e,tr:n})=>{try{const r=Jh(t.doc,t.selection.$from.pos,1);return r==null?!1:(n.join(r,2),e&&e(n),!0)}catch{return!1}},nF=()=>({state:t,dispatch:e})=>U$(t,e),rF=()=>({state:t,dispatch:e})=>H$(t,e);function N_(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function iF(t){const e=t.split(/-(?!$)/);let n=e[e.length-1];n==="Space"&&(n=" ");let r,i,o,s;for(let a=0;a<e.length-1;a+=1){const l=e[a];if(/^(cmd|meta|m)$/i.test(l))s=!0;else if(/^a(lt)?$/i.test(l))r=!0;else if(/^(c|ctrl|control)$/i.test(l))i=!0;else if(/^s(hift)?$/i.test(l))o=!0;else if(/^mod$/i.test(l))Y0()||N_()?s=!0:i=!0;else throw new Error(`Unrecognized modifier name: ${l}`)}return r&&(n=`Alt-${n}`),i&&(n=`Ctrl-${n}`),s&&(n=`Meta-${n}`),o&&(n=`Shift-${n}`),n}const oF=t=>({editor:e,view:n,tr:r,dispatch:i})=>{const o=iF(t).split(/-(?!$)/),s=o.find(c=>!["Alt","Ctrl","Meta","Shift"].includes(c)),a=new KeyboardEvent("keydown",{key:s==="Space"?" ":s,altKey:o.includes("Alt"),ctrlKey:o.includes("Ctrl"),metaKey:o.includes("Meta"),shiftKey:o.includes("Shift"),bubbles:!0,cancelable:!0}),l=e.captureTransaction(()=>{n.someProp("handleKeyDown",c=>c(n,a))});return l==null||l.steps.forEach(c=>{const u=c.map(r.mapping);u&&i&&r.maybeStep(u)}),!0};function au(t,e,n={}){const{from:r,to:i,empty:o}=t.selection,s=e?ut(e,t.schema):null,a=[];t.doc.nodesBetween(r,i,(d,h)=>{if(d.isText)return;const p=Math.max(r,h),m=Math.min(i,h+d.nodeSize);a.push({node:d,from:p,to:m})});const l=i-r,c=a.filter(d=>s?s.name===d.node.type.name:!0).filter(d=>rh(d.node.attrs,n,{strict:!1}));return o?!!c.length:c.reduce((d,h)=>d+h.to-h.from,0)>=l}const sF=(t,e={})=>({state:n,dispatch:r})=>{const i=ut(t,n.schema);return au(n,i,e)?Y$(n,r):!1},aF=()=>({state:t,dispatch:e})=>e4(t,e),lF=t=>({state:e,dispatch:n})=>{const r=ut(t,e.schema);return c4(r)(e,n)},cF=()=>({state:t,dispatch:e})=>Q$(t,e);function sp(t,e){return e.nodes[t]?"node":e.marks[t]?"mark":null}function O1(t,e){const n=typeof e=="string"?[e]:e;return Object.keys(t).reduce((r,i)=>(n.includes(i)||(r[i]=t[i]),r),{})}const uF=(t,e)=>({tr:n,state:r,dispatch:i})=>{let o=null,s=null;const a=sp(typeof t=="string"?t:t.name,r.schema);return a?(a==="node"&&(o=ut(t,r.schema)),a==="mark"&&(s=Lo(t,r.schema)),i&&n.selection.ranges.forEach(l=>{r.doc.nodesBetween(l.$from.pos,l.$to.pos,(c,u)=>{o&&o===c.type&&n.setNodeMarkup(u,void 0,O1(c.attrs,e)),s&&c.marks.length&&c.marks.forEach(d=>{s===d.type&&n.addMark(u,u+c.nodeSize,s.create(O1(d.attrs,e)))})})}),!0):!1},dF=()=>({tr:t,dispatch:e})=>(e&&t.scrollIntoView(),!0),fF=()=>({tr:t,dispatch:e})=>{if(e){const n=new $n(t.doc);t.setSelection(n)}return!0},hF=()=>({state:t,dispatch:e})=>W$(t,e),pF=()=>({state:t,dispatch:e})=>q$(t,e),mF=()=>({state:t,dispatch:e})=>t4(t,e),gF=()=>({state:t,dispatch:e})=>i4(t,e),yF=()=>({state:t,dispatch:e})=>r4(t,e);function Fy(t,e,n={},r={}){return ih(t,e,{slice:!1,parseOptions:n,errorOnInvalidContent:r.errorOnInvalidContent})}const vF=(t,e=!1,n={},r={})=>({editor:i,tr:o,dispatch:s,commands:a})=>{var l,c;const{doc:u}=o;if(n.preserveWhitespace!=="full"){const d=Fy(t,i.schema,n,{errorOnInvalidContent:(l=r.errorOnInvalidContent)!==null&&l!==void 0?l:i.options.enableContentCheck});return s&&o.replaceWith(0,u.content.size,d).setMeta("preventUpdate",!e),!0}return s&&o.setMeta("preventUpdate",!e),a.insertContentAt({from:0,to:u.content.size},t,{parseOptions:n,errorOnInvalidContent:(c=r.errorOnInvalidContent)!==null&&c!==void 0?c:i.options.enableContentCheck})};function D_(t,e){const n=Lo(e,t.schema),{from:r,to:i,empty:o}=t.selection,s=[];o?(t.storedMarks&&s.push(...t.storedMarks),s.push(...t.selection.$head.marks())):t.doc.nodesBetween(r,i,l=>{s.push(...l.marks)});const a=s.find(l=>l.type.name===n.name);return a?{...a.attrs}:{}}function xF(t){for(let e=0;e<t.edgeCount;e+=1){const{type:n}=t.edge(e);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}function wF(t,e){for(let n=t.depth;n>0;n-=1){const r=t.node(n);if(e(r))return{pos:n>0?t.before(n):0,start:t.start(n),depth:n,node:r}}}function Q0(t){return e=>wF(e.$from,t)}function bF(t,e){const n={from:0,to:t.content.size};return O_(t,n,e)}function SF(t,e){const n=ut(e,t.schema),{from:r,to:i}=t.selection,o=[];t.doc.nodesBetween(r,i,a=>{o.push(a)});const s=o.reverse().find(a=>a.type.name===n.name);return s?{...s.attrs}:{}}function CF(t,e){const n=sp(typeof e=="string"?e:e.name,t.schema);return n==="node"?SF(t,e):n==="mark"?D_(t,e):{}}function j_(t,e,n){const r=[];return t===e?n.resolve(t).marks().forEach(i=>{const o=n.resolve(t),s=G0(o,i.type);s&&r.push({mark:i,...s})}):n.nodesBetween(t,e,(i,o)=>{!i||(i==null?void 0:i.nodeSize)===void 0||r.push(...i.marks.map(s=>({from:o,to:o+i.nodeSize,mark:s})))}),r}function df(t,e,n){return Object.fromEntries(Object.entries(n).filter(([r])=>{const i=t.find(o=>o.type===e&&o.name===r);return i?i.attribute.keepOnSplit:!1}))}function By(t,e,n={}){const{empty:r,ranges:i}=t.selection,o=e?Lo(e,t.schema):null;if(r)return!!(t.storedMarks||t.selection.$from.marks()).filter(d=>o?o.name===d.type.name:!0).find(d=>rh(d.attrs,n,{strict:!1}));let s=0;const a=[];if(i.forEach(({$from:d,$to:h})=>{const p=d.pos,m=h.pos;t.doc.nodesBetween(p,m,(y,v)=>{if(!y.isText&&!y.marks.length)return;const x=Math.max(p,v),w=Math.min(m,v+y.nodeSize),b=w-x;s+=b,a.push(...y.marks.map(S=>({mark:S,from:x,to:w})))})}),s===0)return!1;const l=a.filter(d=>o?o.name===d.mark.type.name:!0).filter(d=>rh(d.mark.attrs,n,{strict:!1})).reduce((d,h)=>d+h.to-h.from,0),c=a.filter(d=>o?d.mark.type!==o&&d.mark.type.excludes(o):!0).reduce((d,h)=>d+h.to-h.from,0);return(l>0?l+c:l)>=s}function kF(t,e,n={}){if(!e)return au(t,null,n)||By(t,null,n);const r=sp(e,t.schema);return r==="node"?au(t,e,n):r==="mark"?By(t,e,n):!1}function P1(t,e){const{nodeExtensions:n}=rp(e),r=n.find(s=>s.name===t);if(!r)return!1;const i={name:r.name,options:r.options,storage:r.storage},o=ce(Y(r,"group",i));return typeof o!="string"?!1:o.split(" ").includes("list")}function ap(t,{checkChildren:e=!0,ignoreWhitespace:n=!1}={}){var r;if(n){if(t.type.name==="hardBreak")return!0;if(t.isText)return/^\s*$/m.test((r=t.text)!==null&&r!==void 0?r:"")}if(t.isText)return!t.text;if(t.isAtom||t.isLeaf)return!1;if(t.content.childCount===0)return!0;if(e){let i=!0;return t.content.forEach(o=>{i!==!1&&(ap(o,{ignoreWhitespace:n,checkChildren:e})||(i=!1))}),i}return!1}function L_(t){return t instanceof te}function EF(t,e,n){const i=t.state.doc.content.size,o=ii(e,0,i),s=ii(n,0,i),a=t.coordsAtPos(o),l=t.coordsAtPos(s,-1),c=Math.min(a.top,l.top),u=Math.max(a.bottom,l.bottom),d=Math.min(a.left,l.left),h=Math.max(a.right,l.right),p=h-d,m=u-c,x={top:c,bottom:u,left:d,right:h,width:p,height:m,x:d,y:c};return{...x,toJSON:()=>x}}function TF(t,e,n){var r;const{selection:i}=e;let o=null;if(J0(i)&&(o=i.$cursor),o){const a=(r=t.storedMarks)!==null&&r!==void 0?r:o.marks();return!!n.isInSet(a)||!a.some(l=>l.type.excludes(n))}const{ranges:s}=i;return s.some(({$from:a,$to:l})=>{let c=a.depth===0?t.doc.inlineContent&&t.doc.type.allowsMarkType(n):!1;return t.doc.nodesBetween(a.pos,l.pos,(u,d,h)=>{if(c)return!1;if(u.isInline){const p=!h||h.type.allowsMarkType(n),m=!!n.isInSet(u.marks)||!u.marks.some(y=>y.type.excludes(n));c=p&&m}return!c}),c})}const _F=(t,e={})=>({tr:n,state:r,dispatch:i})=>{const{selection:o}=n,{empty:s,ranges:a}=o,l=Lo(t,r.schema);if(i)if(s){const c=D_(r,l);n.addStoredMark(l.create({...c,...e}))}else a.forEach(c=>{const u=c.$from.pos,d=c.$to.pos;r.doc.nodesBetween(u,d,(h,p)=>{const m=Math.max(p,u),y=Math.min(p+h.nodeSize,d);h.marks.find(x=>x.type===l)?h.marks.forEach(x=>{l===x.type&&n.addMark(m,y,l.create({...x.attrs,...e}))}):n.addMark(m,y,l.create(e))})});return TF(r,n,l)},RF=(t,e)=>({tr:n})=>(n.setMeta(t,e),!0),OF=(t,e={})=>({state:n,dispatch:r,chain:i})=>{const o=ut(t,n.schema);let s;return n.selection.$anchor.sameParent(n.selection.$head)&&(s=n.selection.$anchor.parent.attrs),o.isTextblock?i().command(({commands:a})=>k1(o,{...s,...e})(n)?!0:a.clearNodes()).command(({state:a})=>k1(o,{...s,...e})(a,r)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},PF=t=>({tr:e,dispatch:n})=>{if(n){const{doc:r}=e,i=ii(t,0,r.content.size),o=te.create(r,i);e.setSelection(o)}return!0},MF=t=>({tr:e,dispatch:n})=>{if(n){const{doc:r}=e,{from:i,to:o}=typeof t=="number"?{from:t,to:t}:t,s=ie.atStart(r).from,a=ie.atEnd(r).to,l=ii(i,s,a),c=ii(o,s,a),u=ie.create(r,l,c);e.setSelection(u)}return!0},IF=t=>({state:e,dispatch:n})=>{const r=ut(t,e.schema);return f4(r)(e,n)};function M1(t,e){const n=t.storedMarks||t.selection.$to.parentOffset&&t.selection.$from.marks();if(n){const r=n.filter(i=>e==null?void 0:e.includes(i.type.name));t.tr.ensureMarks(r)}}const AF=({keepMarks:t=!0}={})=>({tr:e,state:n,dispatch:r,editor:i})=>{const{selection:o,doc:s}=e,{$from:a,$to:l}=o,c=i.extensionManager.attributes,u=df(c,a.node().type.name,a.node().attrs);if(o instanceof te&&o.node.isBlock)return!a.parentOffset||!La(s,a.pos)?!1:(r&&(t&&M1(n,i.extensionManager.splittableMarks),e.split(a.pos).scrollIntoView()),!0);if(!a.parent.isBlock)return!1;const d=l.parentOffset===l.parent.content.size,h=a.depth===0?void 0:xF(a.node(-1).contentMatchAt(a.indexAfter(-1)));let p=d&&h?[{type:h,attrs:u}]:void 0,m=La(e.doc,e.mapping.map(a.pos),1,p);if(!p&&!m&&La(e.doc,e.mapping.map(a.pos),1,h?[{type:h}]:void 0)&&(m=!0,p=h?[{type:h,attrs:u}]:void 0),r){if(m&&(o instanceof ie&&e.deleteSelection(),e.split(e.mapping.map(a.pos),1,p),h&&!d&&!a.parentOffset&&a.parent.type!==h)){const y=e.mapping.map(a.before()),v=e.doc.resolve(y);a.node(-1).canReplaceWith(v.index(),v.index()+1,h)&&e.setNodeMarkup(e.mapping.map(a.before()),h)}t&&M1(n,i.extensionManager.splittableMarks),e.scrollIntoView()}return m},NF=(t,e={})=>({tr:n,state:r,dispatch:i,editor:o})=>{var s;const a=ut(t,r.schema),{$from:l,$to:c}=r.selection,u=r.selection.node;if(u&&u.isBlock||l.depth<2||!l.sameParent(c))return!1;const d=l.node(-1);if(d.type!==a)return!1;const h=o.extensionManager.attributes;if(l.parent.content.size===0&&l.node(-1).childCount===l.indexAfter(-1)){if(l.depth===2||l.node(-3).type!==a||l.index(-2)!==l.node(-2).childCount-1)return!1;if(i){let x=B.empty;const w=l.index(-1)?1:l.index(-2)?2:3;for(let T=l.depth-w;T>=l.depth-3;T-=1)x=B.from(l.node(T).copy(x));const b=l.indexAfter(-1)<l.node(-2).childCount?1:l.indexAfter(-2)<l.node(-3).childCount?2:3,S={...df(h,l.node().type.name,l.node().attrs),...e},C=((s=a.contentMatch.defaultType)===null||s===void 0?void 0:s.createAndFill(S))||void 0;x=x.append(B.from(a.createAndFill(null,C)||void 0));const k=l.before(l.depth-(w-1));n.replace(k,l.after(-b),new W(x,4-w,0));let E=-1;n.doc.nodesBetween(k,n.doc.content.size,(T,O)=>{if(E>-1)return!1;T.isTextblock&&T.content.size===0&&(E=O+1)}),E>-1&&n.setSelection(ie.near(n.doc.resolve(E))),n.scrollIntoView()}return!0}const p=c.pos===l.end()?d.contentMatchAt(0).defaultType:null,m={...df(h,d.type.name,d.attrs),...e},y={...df(h,l.node().type.name,l.node().attrs),...e};n.delete(l.pos,c.pos);const v=p?[{type:a,attrs:m},{type:p,attrs:y}]:[{type:a,attrs:m}];if(!La(n.doc,l.pos,2))return!1;if(i){const{selection:x,storedMarks:w}=r,{splittableMarks:b}=o.extensionManager,S=w||x.$to.parentOffset&&x.$from.marks();if(n.split(l.pos,2,v).scrollIntoView(),!S||!i)return!0;const C=S.filter(k=>b.includes(k.type.name));n.ensureMarks(C)}return!0},Mm=(t,e)=>{const n=Q0(s=>s.type===e)(t.selection);if(!n)return!0;const r=t.doc.resolve(Math.max(0,n.pos-1)).before(n.depth);if(r===void 0)return!0;const i=t.doc.nodeAt(r);return n.node.type===(i==null?void 0:i.type)&&Do(t.doc,n.pos)&&t.join(n.pos),!0},Im=(t,e)=>{const n=Q0(s=>s.type===e)(t.selection);if(!n)return!0;const r=t.doc.resolve(n.start).after(n.depth);if(r===void 0)return!0;const i=t.doc.nodeAt(r);return n.node.type===(i==null?void 0:i.type)&&Do(t.doc,r)&&t.join(r),!0},DF=(t,e,n,r={})=>({editor:i,tr:o,state:s,dispatch:a,chain:l,commands:c,can:u})=>{const{extensions:d,splittableMarks:h}=i.extensionManager,p=ut(t,s.schema),m=ut(e,s.schema),{selection:y,storedMarks:v}=s,{$from:x,$to:w}=y,b=x.blockRange(w),S=v||y.$to.parentOffset&&y.$from.marks();if(!b)return!1;const C=Q0(k=>P1(k.type.name,d))(y);if(b.depth>=1&&C&&b.depth-C.depth<=1){if(C.node.type===p)return c.liftListItem(m);if(P1(C.node.type.name,d)&&p.validContent(C.node.content)&&a)return l().command(()=>(o.setNodeMarkup(C.pos,p),!0)).command(()=>Mm(o,p)).command(()=>Im(o,p)).run()}return!n||!S||!a?l().command(()=>u().wrapInList(p,r)?!0:c.clearNodes()).wrapInList(p,r).command(()=>Mm(o,p)).command(()=>Im(o,p)).run():l().command(()=>{const k=u().wrapInList(p,r),E=S.filter(T=>h.includes(T.type.name));return o.ensureMarks(E),k?!0:c.clearNodes()}).wrapInList(p,r).command(()=>Mm(o,p)).command(()=>Im(o,p)).run()},jF=(t,e={},n={})=>({state:r,commands:i})=>{const{extendEmptyMarkRange:o=!1}=n,s=Lo(t,r.schema);return By(r,s,e)?i.unsetMark(s,{extendEmptyMarkRange:o}):i.setMark(s,e)},LF=(t,e,n={})=>({state:r,commands:i})=>{const o=ut(t,r.schema),s=ut(e,r.schema),a=au(r,o,n);let l;return r.selection.$anchor.sameParent(r.selection.$head)&&(l=r.selection.$anchor.parent.attrs),a?i.setNode(s,l):i.setNode(o,{...l,...n})},$F=(t,e={})=>({state:n,commands:r})=>{const i=ut(t,n.schema);return au(n,i,e)?r.lift(i):r.wrapIn(i,e)},FF=()=>({state:t,dispatch:e})=>{const n=t.plugins;for(let r=0;r<n.length;r+=1){const i=n[r];let o;if(i.spec.isInputRules&&(o=i.getState(t))){if(e){const s=t.tr,a=o.transform;for(let l=a.steps.length-1;l>=0;l-=1)s.step(a.steps[l].invert(a.docs[l]));if(o.text){const l=s.doc.resolve(o.from).marks();s.replaceWith(o.from,o.to,t.schema.text(o.text,l))}else s.delete(o.from,o.to)}return!0}}return!1},BF=()=>({tr:t,dispatch:e})=>{const{selection:n}=t,{empty:r,ranges:i}=n;return r||e&&i.forEach(o=>{t.removeMark(o.$from.pos,o.$to.pos)}),!0},zF=(t,e={})=>({tr:n,state:r,dispatch:i})=>{var o;const{extendEmptyMarkRange:s=!1}=e,{selection:a}=n,l=Lo(t,r.schema),{$from:c,empty:u,ranges:d}=a;if(!i)return!0;if(u&&s){let{from:h,to:p}=a;const m=(o=c.marks().find(v=>v.type===l))===null||o===void 0?void 0:o.attrs,y=G0(c,l,m);y&&(h=y.from,p=y.to),n.removeMark(h,p,l)}else d.forEach(h=>{n.removeMark(h.$from.pos,h.$to.pos,l)});return n.removeStoredMark(l),!0},VF=(t,e={})=>({tr:n,state:r,dispatch:i})=>{let o=null,s=null;const a=sp(typeof t=="string"?t:t.name,r.schema);return a?(a==="node"&&(o=ut(t,r.schema)),a==="mark"&&(s=Lo(t,r.schema)),i&&n.selection.ranges.forEach(l=>{const c=l.$from.pos,u=l.$to.pos;let d,h,p,m;n.selection.empty?r.doc.nodesBetween(c,u,(y,v)=>{o&&o===y.type&&(p=Math.max(v,c),m=Math.min(v+y.nodeSize,u),d=v,h=y)}):r.doc.nodesBetween(c,u,(y,v)=>{v<c&&o&&o===y.type&&(p=Math.max(v,c),m=Math.min(v+y.nodeSize,u),d=v,h=y),v>=c&&v<=u&&(o&&o===y.type&&n.setNodeMarkup(v,void 0,{...y.attrs,...e}),s&&y.marks.length&&y.marks.forEach(x=>{if(s===x.type){const w=Math.max(v,c),b=Math.min(v+y.nodeSize,u);n.addMark(w,b,s.create({...x.attrs,...e}))}}))}),h&&(d!==void 0&&n.setNodeMarkup(d,void 0,{...h.attrs,...e}),s&&h.marks.length&&h.marks.forEach(y=>{s===y.type&&n.addMark(p,m,s.create({...y.attrs,...e}))}))}),!0):!1},UF=(t,e={})=>({state:n,dispatch:r})=>{const i=ut(t,n.schema);return o4(i,e)(n,r)},HF=(t,e={})=>({state:n,dispatch:r})=>{const i=ut(t,n.schema);return s4(i,e)(n,r)};var WF=Object.freeze({__proto__:null,blur:O4,clearContent:P4,clearNodes:M4,command:I4,createParagraphNear:A4,cut:N4,deleteCurrentNode:D4,deleteNode:j4,deleteRange:L4,deleteSelection:$4,enter:F4,exitCode:B4,extendMarkRange:z4,first:V4,focus:H4,forEach:W4,insertContent:K4,insertContentAt:J4,joinBackward:X4,joinDown:Q4,joinForward:Z4,joinItemBackward:eF,joinItemForward:tF,joinTextblockBackward:nF,joinTextblockForward:rF,joinUp:Y4,keyboardShortcut:oF,lift:sF,liftEmptyBlock:aF,liftListItem:lF,newlineInCode:cF,resetAttributes:uF,scrollIntoView:dF,selectAll:fF,selectNodeBackward:hF,selectNodeForward:pF,selectParentNode:mF,selectTextblockEnd:gF,selectTextblockStart:yF,setContent:vF,setMark:_F,setMeta:RF,setNode:OF,setNodeSelection:PF,setTextSelection:MF,sinkListItem:IF,splitBlock:AF,splitListItem:NF,toggleList:DF,toggleMark:jF,toggleNode:LF,toggleWrap:$F,undoInputRule:FF,unsetAllMarks:BF,unsetMark:zF,updateAttributes:VF,wrapIn:UF,wrapInList:HF});const KF=dt.create({name:"commands",addCommands(){return{...WF}}}),qF=dt.create({name:"drop",addProseMirrorPlugins(){return[new xt({key:new Rn("tiptapDrop"),props:{handleDrop:(t,e,n,r)=>{this.editor.emit("drop",{editor:this.editor,event:e,slice:n,moved:r})}}})]}}),GF=dt.create({name:"editable",addProseMirrorPlugins(){return[new xt({key:new Rn("editable"),props:{editable:()=>this.editor.options.editable}})]}}),JF=dt.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:t}=this;return[new xt({key:new Rn("focusEvents"),props:{handleDOMEvents:{focus:(e,n)=>{t.isFocused=!0;const r=t.state.tr.setMeta("focus",{event:n}).setMeta("addToHistory",!1);return e.dispatch(r),!1},blur:(e,n)=>{t.isFocused=!1;const r=t.state.tr.setMeta("blur",{event:n}).setMeta("addToHistory",!1);return e.dispatch(r),!1}}}})]}}),YF=dt.create({name:"keymap",addKeyboardShortcuts(){const t=()=>this.editor.commands.first(({commands:s})=>[()=>s.undoInputRule(),()=>s.command(({tr:a})=>{const{selection:l,doc:c}=a,{empty:u,$anchor:d}=l,{pos:h,parent:p}=d,m=d.parent.isTextblock&&h>0?a.doc.resolve(h-1):d,y=m.parent.type.spec.isolating,v=d.pos-d.parentOffset,x=y&&m.parent.childCount===1?v===d.pos:oe.atStart(c).from===h;return!u||!p.type.isTextblock||p.textContent.length||!x||x&&d.parent.type.name==="paragraph"?!1:s.clearNodes()}),()=>s.deleteSelection(),()=>s.joinBackward(),()=>s.selectNodeBackward()]),e=()=>this.editor.commands.first(({commands:s})=>[()=>s.deleteSelection(),()=>s.deleteCurrentNode(),()=>s.joinForward(),()=>s.selectNodeForward()]),r={Enter:()=>this.editor.commands.first(({commands:s})=>[()=>s.newlineInCode(),()=>s.createParagraphNear(),()=>s.liftEmptyBlock(),()=>s.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:t,"Mod-Backspace":t,"Shift-Backspace":t,Delete:e,"Mod-Delete":e,"Mod-a":()=>this.editor.commands.selectAll()},i={...r},o={...r,"Ctrl-h":t,"Alt-Backspace":t,"Ctrl-d":e,"Ctrl-Alt-Backspace":e,"Alt-Delete":e,"Alt-d":e,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return Y0()||N_()?o:i},addProseMirrorPlugins(){return[new xt({key:new Rn("clearDocument"),appendTransaction:(t,e,n)=>{if(t.some(y=>y.getMeta("composition")))return;const r=t.some(y=>y.docChanged)&&!e.doc.eq(n.doc),i=t.some(y=>y.getMeta("preventClearDocument"));if(!r||i)return;const{empty:o,from:s,to:a}=e.selection,l=oe.atStart(e.doc).from,c=oe.atEnd(e.doc).to;if(o||!(s===l&&a===c)||!ap(n.doc))return;const h=n.tr,p=tp({state:n,transaction:h}),{commands:m}=new np({editor:this.editor,state:p});if(m.clearNodes(),!!h.steps.length)return h}})]}}),QF=dt.create({name:"paste",addProseMirrorPlugins(){return[new xt({key:new Rn("tiptapPaste"),props:{handlePaste:(t,e,n)=>{this.editor.emit("paste",{editor:this.editor,event:e,slice:n})}}})]}}),XF=dt.create({name:"tabindex",addProseMirrorPlugins(){return[new xt({key:new Rn("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}});class Xo{get name(){return this.node.type.name}constructor(e,n,r=!1,i=null){this.currentNode=null,this.actualDepth=null,this.isBlock=r,this.resolvedPos=e,this.editor=n,this.currentNode=i}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var e;return(e=this.actualDepth)!==null&&e!==void 0?e:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(e){let n=this.from,r=this.to;if(this.isBlock){if(this.content.size===0){console.error(`You can’t set content on a block node. Tried to set content on ${this.name} at ${this.pos}`);return}n=this.from+1,r=this.to-1}this.editor.commands.insertContentAt({from:n,to:r},e)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(this.depth===0)return null;const e=this.resolvedPos.start(this.resolvedPos.depth-1),n=this.resolvedPos.doc.resolve(e);return new Xo(n,this.editor)}get before(){let e=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.from-3)),new Xo(e,this.editor)}get after(){let e=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.to+3)),new Xo(e,this.editor)}get children(){const e=[];return this.node.content.forEach((n,r)=>{const i=n.isBlock&&!n.isTextblock,o=n.isAtom&&!n.isText,s=this.pos+r+(o?0:1),a=this.resolvedPos.doc.resolve(s);if(!i&&a.depth<=this.depth)return;const l=new Xo(a,this.editor,i,i?n:null);i&&(l.actualDepth=this.depth+1),e.push(new Xo(a,this.editor,i,i?n:null))}),e}get firstChild(){return this.children[0]||null}get lastChild(){const e=this.children;return e[e.length-1]||null}closest(e,n={}){let r=null,i=this.parent;for(;i&&!r;){if(i.node.type.name===e)if(Object.keys(n).length>0){const o=i.node.attrs,s=Object.keys(n);for(let a=0;a<s.length;a+=1){const l=s[a];if(o[l]!==n[l])break}}else r=i;i=i.parent}return r}querySelector(e,n={}){return this.querySelectorAll(e,n,!0)[0]||null}querySelectorAll(e,n={},r=!1){let i=[];if(!this.children||this.children.length===0)return i;const o=Object.keys(n);return this.children.forEach(s=>{r&&i.length>0||(s.node.type.name===e&&o.every(l=>n[l]===s.node.attrs[l])&&i.push(s),!(r&&i.length>0)&&(i=i.concat(s.querySelectorAll(e,n,r))))}),i}setAttribute(e){const{tr:n}=this.editor.state;n.setNodeMarkup(this.from,void 0,{...this.node.attrs,...e}),this.editor.view.dispatch(n)}}const ZF=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 0 !important;
  height: 0 !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}

.tippy-box[data-animation=fade][data-state=hidden] {
  opacity: 0
}`;function eB(t,e,n){const r=document.querySelector(`style[data-tiptap-style${n?`-${n}`:""}]`);if(r!==null)return r;const i=document.createElement("style");return e&&i.setAttribute("nonce",e),i.setAttribute(`data-tiptap-style${n?`-${n}`:""}`,""),i.innerHTML=t,document.getElementsByTagName("head")[0].appendChild(i),i}class tB extends h4{constructor(e={}){super(),this.isFocused=!1,this.isInitialized=!1,this.extensionStorage={},this.options={element:document.createElement("div"),content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,enableContentCheck:!1,onBeforeCreate:()=>null,onCreate:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null,onContentError:({error:n})=>{throw n},onPaste:()=>null,onDrop:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(e),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.on("contentError",this.options.onContentError),this.createView(),this.injectCSS(),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),this.on("drop",({event:n,slice:r,moved:i})=>this.options.onDrop(n,r,i)),this.on("paste",({event:n,slice:r})=>this.options.onPaste(n,r)),window.setTimeout(()=>{this.isDestroyed||(this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}),this.isInitialized=!0)},0)}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&document&&(this.css=eB(ZF,this.options.injectNonce))}setOptions(e={}){this.options={...this.options,...e},!(!this.view||!this.state||this.isDestroyed)&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(e,n=!0){this.setOptions({editable:e}),n&&this.emit("update",{editor:this,transaction:this.state.tr})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get state(){return this.view.state}registerPlugin(e,n){const r=R_(n)?n(e,[...this.state.plugins]):[...this.state.plugins,e],i=this.state.reconfigure({plugins:r});return this.view.updateState(i),i}unregisterPlugin(e){if(this.isDestroyed)return;const n=this.state.plugins;let r=n;if([].concat(e).forEach(o=>{const s=typeof o=="string"?`${o}$`:o.key;r=n.filter(a=>!a.key.startsWith(s))}),n.length===r.length)return;const i=this.state.reconfigure({plugins:r});return this.view.updateState(i),i}createExtensionManager(){var e,n;const i=[...this.options.enableCoreExtensions?[GF,R4.configure({blockSeparator:(n=(e=this.options.coreExtensionOptions)===null||e===void 0?void 0:e.clipboardTextSerializer)===null||n===void 0?void 0:n.blockSeparator}),KF,JF,YF,XF,qF,QF].filter(o=>typeof this.options.enableCoreExtensions=="object"?this.options.enableCoreExtensions[o.name]!==!1:!0):[],...this.options.extensions].filter(o=>["extension","node","mark"].includes(o==null?void 0:o.type));this.extensionManager=new _a(i,this)}createCommandManager(){this.commandManager=new np({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createView(){var e;let n;try{n=Fy(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:this.options.enableContentCheck})}catch(s){if(!(s instanceof Error)||!["[tiptap error]: Invalid JSON content","[tiptap error]: Invalid HTML content"].includes(s.message))throw s;this.emit("contentError",{editor:this,error:s,disableCollaboration:()=>{this.storage.collaboration&&(this.storage.collaboration.isDisabled=!0),this.options.extensions=this.options.extensions.filter(a=>a.name!=="collaboration"),this.createExtensionManager()}}),n=Fy(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:!1})}const r=I_(n,this.options.autofocus);this.view=new M$(this.options.element,{...this.options.editorProps,attributes:{role:"textbox",...(e=this.options.editorProps)===null||e===void 0?void 0:e.attributes},dispatchTransaction:this.dispatchTransaction.bind(this),state:Ta.create({doc:n,selection:r||void 0})});const i=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(i),this.createNodeViews(),this.prependClass();const o=this.view.dom;o.editor=this}createNodeViews(){this.view.isDestroyed||this.view.setProps({nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`tiptap ${this.view.dom.className}`}captureTransaction(e){this.isCapturingTransaction=!0,e(),this.isCapturingTransaction=!1;const n=this.capturedTransaction;return this.capturedTransaction=null,n}dispatchTransaction(e){if(this.view.isDestroyed)return;if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=e;return}e.steps.forEach(s=>{var a;return(a=this.capturedTransaction)===null||a===void 0?void 0:a.step(s)});return}const n=this.state.apply(e),r=!this.state.selection.eq(n.selection);this.emit("beforeTransaction",{editor:this,transaction:e,nextState:n}),this.view.updateState(n),this.emit("transaction",{editor:this,transaction:e}),r&&this.emit("selectionUpdate",{editor:this,transaction:e});const i=e.getMeta("focus"),o=e.getMeta("blur");i&&this.emit("focus",{editor:this,event:i.event,transaction:e}),o&&this.emit("blur",{editor:this,event:o.event,transaction:e}),!(!e.docChanged||e.getMeta("preventUpdate"))&&this.emit("update",{editor:this,transaction:e})}getAttributes(e){return CF(this.state,e)}isActive(e,n){const r=typeof e=="string"?e:null,i=typeof e=="string"?n:e;return kF(this.state,r,i)}getJSON(){return this.state.doc.toJSON()}getHTML(){return K0(this.state.doc.content,this.schema)}getText(e){const{blockSeparator:n=`

`,textSerializers:r={}}=e||{};return bF(this.state.doc,{blockSeparator:n,textSerializers:{...P_(this.schema),...r}})}get isEmpty(){return ap(this.state.doc)}getCharacterCount(){return console.warn('[tiptap warn]: "editor.getCharacterCount()" is deprecated. Please use "editor.storage.characterCount.characters()" instead.'),this.state.doc.content.size-2}destroy(){if(this.emit("destroy"),this.view){const e=this.view.dom;e&&e.editor&&delete e.editor,this.view.destroy()}this.removeAllListeners()}get isDestroyed(){var e;return!(!((e=this.view)===null||e===void 0)&&e.docView)}$node(e,n){var r;return((r=this.$doc)===null||r===void 0?void 0:r.querySelector(e,n))||null}$nodes(e,n){var r;return((r=this.$doc)===null||r===void 0?void 0:r.querySelectorAll(e,n))||null}$pos(e){const n=this.state.doc.resolve(e);return new Xo(n,this)}get $doc(){return this.$pos(0)}}function ml(t){return new ip({find:t.find,handler:({state:e,range:n,match:r})=>{const i=ce(t.getAttributes,void 0,r);if(i===!1||i===null)return null;const{tr:o}=e,s=r[r.length-1],a=r[0];if(s){const l=a.search(/\S/),c=n.from+a.indexOf(s),u=c+s.length;if(j_(n.from,n.to,e.doc).filter(p=>p.mark.type.excluded.find(y=>y===t.type&&y!==p.mark.type)).filter(p=>p.to>c).length)return null;u<n.to&&o.delete(u,n.to),c>n.from&&o.delete(n.from+l,c);const h=n.from+l+s.length;o.addMark(n.from+l,h,t.type.create(i||{})),o.removeStoredMark(t.type)}}})}function nB(t){return new ip({find:t.find,handler:({state:e,range:n,match:r})=>{const i=ce(t.getAttributes,void 0,r)||{},{tr:o}=e,s=n.from;let a=n.to;const l=t.type.create(i);if(r[1]){const c=r[0].lastIndexOf(r[1]);let u=s+c;u>a?u=a:a=u+r[1].length;const d=r[0][r[0].length-1];o.insertText(d,s+r[0].length-1),o.replaceWith(u,a,l)}else if(r[0]){const c=t.type.isInline?s:s-1;o.insert(c,t.type.create(i)).delete(o.mapping.map(s),o.mapping.map(a))}o.scrollIntoView()}})}function zy(t){return new ip({find:t.find,handler:({state:e,range:n,match:r})=>{const i=e.doc.resolve(n.from),o=ce(t.getAttributes,void 0,r)||{};if(!i.node(-1).canReplaceWith(i.index(-1),i.indexAfter(-1),t.type))return null;e.tr.delete(n.from,n.to).setBlockType(n.from,n.from,t.type,o)}})}function lu(t){return new ip({find:t.find,handler:({state:e,range:n,match:r,chain:i})=>{const o=ce(t.getAttributes,void 0,r)||{},s=e.tr.delete(n.from,n.to),l=s.doc.resolve(n.from).blockRange(),c=l&&A0(l,t.type,o);if(!c)return null;if(s.wrap(l,c),t.keepMarks&&t.editor){const{selection:d,storedMarks:h}=e,{splittableMarks:p}=t.editor.extensionManager,m=h||d.$to.parentOffset&&d.$from.marks();if(m){const y=m.filter(v=>p.includes(v.type.name));s.ensureMarks(y)}}if(t.keepAttributes){const d=t.type.name==="bulletList"||t.type.name==="orderedList"?"listItem":"taskList";i().updateAttributes(d,o).run()}const u=s.doc.resolve(n.from-1).nodeBefore;u&&u.type===t.type&&Do(s.doc,n.from-1)&&(!t.joinPredicate||t.joinPredicate(r,u))&&s.join(n.from-1)}})}let gr=class Vy{constructor(e={}){this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=ce(Y(this,"addOptions",{name:this.name}))),this.storage=ce(Y(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new Vy(e)}configure(e={}){const n=this.extend({...this.config,addOptions:()=>op(this.options,e)});return n.name=this.name,n.parent=this.parent,n}extend(e={}){const n=new Vy(e);return n.parent=this,this.child=n,n.name=e.name?e.name:n.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=ce(Y(n,"addOptions",{name:n.name})),n.storage=ce(Y(n,"addStorage",{name:n.name,options:n.options})),n}};function gl(t){return new S4({find:t.find,handler:({state:e,range:n,match:r,pasteEvent:i})=>{const o=ce(t.getAttributes,void 0,r,i);if(o===!1||o===null)return null;const{tr:s}=e,a=r[r.length-1],l=r[0];let c=n.to;if(a){const u=l.search(/\S/),d=n.from+l.indexOf(a),h=d+a.length;if(j_(n.from,n.to,e.doc).filter(m=>m.mark.type.excluded.find(v=>v===t.type&&v!==m.mark.type)).filter(m=>m.to>d).length)return null;h<n.to&&s.delete(h,n.to),d>n.from&&s.delete(n.from+u,d),c=n.from+u+a.length,s.addMark(n.from+u,c,t.type.create(o||{})),s.removeStoredMark(t.type)}}})}function rB(t){return t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}var fn="top",Kn="bottom",qn="right",hn="left",X0="auto",Vu=[fn,Kn,qn,hn],yl="start",cu="end",iB="clippingParents",$_="viewport",nc="popper",oB="reference",I1=Vu.reduce(function(t,e){return t.concat([e+"-"+yl,e+"-"+cu])},[]),F_=[].concat(Vu,[X0]).reduce(function(t,e){return t.concat([e,e+"-"+yl,e+"-"+cu])},[]),sB="beforeRead",aB="read",lB="afterRead",cB="beforeMain",uB="main",dB="afterMain",fB="beforeWrite",hB="write",pB="afterWrite",mB=[sB,aB,lB,cB,uB,dB,fB,hB,pB];function zr(t){return t?(t.nodeName||"").toLowerCase():null}function En(t){if(t==null)return window;if(t.toString()!=="[object Window]"){var e=t.ownerDocument;return e&&e.defaultView||window}return t}function Ds(t){var e=En(t).Element;return t instanceof e||t instanceof Element}function Bn(t){var e=En(t).HTMLElement;return t instanceof e||t instanceof HTMLElement}function Z0(t){if(typeof ShadowRoot>"u")return!1;var e=En(t).ShadowRoot;return t instanceof e||t instanceof ShadowRoot}function gB(t){var e=t.state;Object.keys(e.elements).forEach(function(n){var r=e.styles[n]||{},i=e.attributes[n]||{},o=e.elements[n];!Bn(o)||!zr(o)||(Object.assign(o.style,r),Object.keys(i).forEach(function(s){var a=i[s];a===!1?o.removeAttribute(s):o.setAttribute(s,a===!0?"":a)}))})}function yB(t){var e=t.state,n={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,n.popper),e.styles=n,e.elements.arrow&&Object.assign(e.elements.arrow.style,n.arrow),function(){Object.keys(e.elements).forEach(function(r){var i=e.elements[r],o=e.attributes[r]||{},s=Object.keys(e.styles.hasOwnProperty(r)?e.styles[r]:n[r]),a=s.reduce(function(l,c){return l[c]="",l},{});!Bn(i)||!zr(i)||(Object.assign(i.style,a),Object.keys(o).forEach(function(l){i.removeAttribute(l)}))})}}const B_={name:"applyStyles",enabled:!0,phase:"write",fn:gB,effect:yB,requires:["computeStyles"]};function Dr(t){return t.split("-")[0]}var bs=Math.max,oh=Math.min,vl=Math.round;function Uy(){var t=navigator.userAgentData;return t!=null&&t.brands&&Array.isArray(t.brands)?t.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function z_(){return!/^((?!chrome|android).)*safari/i.test(Uy())}function xl(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!1);var r=t.getBoundingClientRect(),i=1,o=1;e&&Bn(t)&&(i=t.offsetWidth>0&&vl(r.width)/t.offsetWidth||1,o=t.offsetHeight>0&&vl(r.height)/t.offsetHeight||1);var s=Ds(t)?En(t):window,a=s.visualViewport,l=!z_()&&n,c=(r.left+(l&&a?a.offsetLeft:0))/i,u=(r.top+(l&&a?a.offsetTop:0))/o,d=r.width/i,h=r.height/o;return{width:d,height:h,top:u,right:c+d,bottom:u+h,left:c,x:c,y:u}}function ex(t){var e=xl(t),n=t.offsetWidth,r=t.offsetHeight;return Math.abs(e.width-n)<=1&&(n=e.width),Math.abs(e.height-r)<=1&&(r=e.height),{x:t.offsetLeft,y:t.offsetTop,width:n,height:r}}function V_(t,e){var n=e.getRootNode&&e.getRootNode();if(t.contains(e))return!0;if(n&&Z0(n)){var r=e;do{if(r&&t.isSameNode(r))return!0;r=r.parentNode||r.host}while(r)}return!1}function fi(t){return En(t).getComputedStyle(t)}function vB(t){return["table","td","th"].indexOf(zr(t))>=0}function $o(t){return((Ds(t)?t.ownerDocument:t.document)||window.document).documentElement}function lp(t){return zr(t)==="html"?t:t.assignedSlot||t.parentNode||(Z0(t)?t.host:null)||$o(t)}function A1(t){return!Bn(t)||fi(t).position==="fixed"?null:t.offsetParent}function xB(t){var e=/firefox/i.test(Uy()),n=/Trident/i.test(Uy());if(n&&Bn(t)){var r=fi(t);if(r.position==="fixed")return null}var i=lp(t);for(Z0(i)&&(i=i.host);Bn(i)&&["html","body"].indexOf(zr(i))<0;){var o=fi(i);if(o.transform!=="none"||o.perspective!=="none"||o.contain==="paint"||["transform","perspective"].indexOf(o.willChange)!==-1||e&&o.willChange==="filter"||e&&o.filter&&o.filter!=="none")return i;i=i.parentNode}return null}function Uu(t){for(var e=En(t),n=A1(t);n&&vB(n)&&fi(n).position==="static";)n=A1(n);return n&&(zr(n)==="html"||zr(n)==="body"&&fi(n).position==="static")?e:n||xB(t)||e}function tx(t){return["top","bottom"].indexOf(t)>=0?"x":"y"}function Pc(t,e,n){return bs(t,oh(e,n))}function wB(t,e,n){var r=Pc(t,e,n);return r>n?n:r}function U_(){return{top:0,right:0,bottom:0,left:0}}function H_(t){return Object.assign({},U_(),t)}function W_(t,e){return e.reduce(function(n,r){return n[r]=t,n},{})}var bB=function(e,n){return e=typeof e=="function"?e(Object.assign({},n.rects,{placement:n.placement})):e,H_(typeof e!="number"?e:W_(e,Vu))};function SB(t){var e,n=t.state,r=t.name,i=t.options,o=n.elements.arrow,s=n.modifiersData.popperOffsets,a=Dr(n.placement),l=tx(a),c=[hn,qn].indexOf(a)>=0,u=c?"height":"width";if(!(!o||!s)){var d=bB(i.padding,n),h=ex(o),p=l==="y"?fn:hn,m=l==="y"?Kn:qn,y=n.rects.reference[u]+n.rects.reference[l]-s[l]-n.rects.popper[u],v=s[l]-n.rects.reference[l],x=Uu(o),w=x?l==="y"?x.clientHeight||0:x.clientWidth||0:0,b=y/2-v/2,S=d[p],C=w-h[u]-d[m],k=w/2-h[u]/2+b,E=Pc(S,k,C),T=l;n.modifiersData[r]=(e={},e[T]=E,e.centerOffset=E-k,e)}}function CB(t){var e=t.state,n=t.options,r=n.element,i=r===void 0?"[data-popper-arrow]":r;i!=null&&(typeof i=="string"&&(i=e.elements.popper.querySelector(i),!i)||V_(e.elements.popper,i)&&(e.elements.arrow=i))}const kB={name:"arrow",enabled:!0,phase:"main",fn:SB,effect:CB,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function wl(t){return t.split("-")[1]}var EB={top:"auto",right:"auto",bottom:"auto",left:"auto"};function TB(t,e){var n=t.x,r=t.y,i=e.devicePixelRatio||1;return{x:vl(n*i)/i||0,y:vl(r*i)/i||0}}function N1(t){var e,n=t.popper,r=t.popperRect,i=t.placement,o=t.variation,s=t.offsets,a=t.position,l=t.gpuAcceleration,c=t.adaptive,u=t.roundOffsets,d=t.isFixed,h=s.x,p=h===void 0?0:h,m=s.y,y=m===void 0?0:m,v=typeof u=="function"?u({x:p,y}):{x:p,y};p=v.x,y=v.y;var x=s.hasOwnProperty("x"),w=s.hasOwnProperty("y"),b=hn,S=fn,C=window;if(c){var k=Uu(n),E="clientHeight",T="clientWidth";if(k===En(n)&&(k=$o(n),fi(k).position!=="static"&&a==="absolute"&&(E="scrollHeight",T="scrollWidth")),k=k,i===fn||(i===hn||i===qn)&&o===cu){S=Kn;var O=d&&k===C&&C.visualViewport?C.visualViewport.height:k[E];y-=O-r.height,y*=l?1:-1}if(i===hn||(i===fn||i===Kn)&&o===cu){b=qn;var _=d&&k===C&&C.visualViewport?C.visualViewport.width:k[T];p-=_-r.width,p*=l?1:-1}}var D=Object.assign({position:a},c&&EB),L=u===!0?TB({x:p,y},En(n)):{x:p,y};if(p=L.x,y=L.y,l){var N;return Object.assign({},D,(N={},N[S]=w?"0":"",N[b]=x?"0":"",N.transform=(C.devicePixelRatio||1)<=1?"translate("+p+"px, "+y+"px)":"translate3d("+p+"px, "+y+"px, 0)",N))}return Object.assign({},D,(e={},e[S]=w?y+"px":"",e[b]=x?p+"px":"",e.transform="",e))}function _B(t){var e=t.state,n=t.options,r=n.gpuAcceleration,i=r===void 0?!0:r,o=n.adaptive,s=o===void 0?!0:o,a=n.roundOffsets,l=a===void 0?!0:a,c={placement:Dr(e.placement),variation:wl(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:i,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,N1(Object.assign({},c,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:s,roundOffsets:l})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,N1(Object.assign({},c,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const RB={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:_B,data:{}};var Nd={passive:!0};function OB(t){var e=t.state,n=t.instance,r=t.options,i=r.scroll,o=i===void 0?!0:i,s=r.resize,a=s===void 0?!0:s,l=En(e.elements.popper),c=[].concat(e.scrollParents.reference,e.scrollParents.popper);return o&&c.forEach(function(u){u.addEventListener("scroll",n.update,Nd)}),a&&l.addEventListener("resize",n.update,Nd),function(){o&&c.forEach(function(u){u.removeEventListener("scroll",n.update,Nd)}),a&&l.removeEventListener("resize",n.update,Nd)}}const PB={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:OB,data:{}};var MB={left:"right",right:"left",bottom:"top",top:"bottom"};function ff(t){return t.replace(/left|right|bottom|top/g,function(e){return MB[e]})}var IB={start:"end",end:"start"};function D1(t){return t.replace(/start|end/g,function(e){return IB[e]})}function nx(t){var e=En(t),n=e.pageXOffset,r=e.pageYOffset;return{scrollLeft:n,scrollTop:r}}function rx(t){return xl($o(t)).left+nx(t).scrollLeft}function AB(t,e){var n=En(t),r=$o(t),i=n.visualViewport,o=r.clientWidth,s=r.clientHeight,a=0,l=0;if(i){o=i.width,s=i.height;var c=z_();(c||!c&&e==="fixed")&&(a=i.offsetLeft,l=i.offsetTop)}return{width:o,height:s,x:a+rx(t),y:l}}function NB(t){var e,n=$o(t),r=nx(t),i=(e=t.ownerDocument)==null?void 0:e.body,o=bs(n.scrollWidth,n.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),s=bs(n.scrollHeight,n.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),a=-r.scrollLeft+rx(t),l=-r.scrollTop;return fi(i||n).direction==="rtl"&&(a+=bs(n.clientWidth,i?i.clientWidth:0)-o),{width:o,height:s,x:a,y:l}}function ix(t){var e=fi(t),n=e.overflow,r=e.overflowX,i=e.overflowY;return/auto|scroll|overlay|hidden/.test(n+i+r)}function K_(t){return["html","body","#document"].indexOf(zr(t))>=0?t.ownerDocument.body:Bn(t)&&ix(t)?t:K_(lp(t))}function Mc(t,e){var n;e===void 0&&(e=[]);var r=K_(t),i=r===((n=t.ownerDocument)==null?void 0:n.body),o=En(r),s=i?[o].concat(o.visualViewport||[],ix(r)?r:[]):r,a=e.concat(s);return i?a:a.concat(Mc(lp(s)))}function Hy(t){return Object.assign({},t,{left:t.x,top:t.y,right:t.x+t.width,bottom:t.y+t.height})}function DB(t,e){var n=xl(t,!1,e==="fixed");return n.top=n.top+t.clientTop,n.left=n.left+t.clientLeft,n.bottom=n.top+t.clientHeight,n.right=n.left+t.clientWidth,n.width=t.clientWidth,n.height=t.clientHeight,n.x=n.left,n.y=n.top,n}function j1(t,e,n){return e===$_?Hy(AB(t,n)):Ds(e)?DB(e,n):Hy(NB($o(t)))}function jB(t){var e=Mc(lp(t)),n=["absolute","fixed"].indexOf(fi(t).position)>=0,r=n&&Bn(t)?Uu(t):t;return Ds(r)?e.filter(function(i){return Ds(i)&&V_(i,r)&&zr(i)!=="body"}):[]}function LB(t,e,n,r){var i=e==="clippingParents"?jB(t):[].concat(e),o=[].concat(i,[n]),s=o[0],a=o.reduce(function(l,c){var u=j1(t,c,r);return l.top=bs(u.top,l.top),l.right=oh(u.right,l.right),l.bottom=oh(u.bottom,l.bottom),l.left=bs(u.left,l.left),l},j1(t,s,r));return a.width=a.right-a.left,a.height=a.bottom-a.top,a.x=a.left,a.y=a.top,a}function q_(t){var e=t.reference,n=t.element,r=t.placement,i=r?Dr(r):null,o=r?wl(r):null,s=e.x+e.width/2-n.width/2,a=e.y+e.height/2-n.height/2,l;switch(i){case fn:l={x:s,y:e.y-n.height};break;case Kn:l={x:s,y:e.y+e.height};break;case qn:l={x:e.x+e.width,y:a};break;case hn:l={x:e.x-n.width,y:a};break;default:l={x:e.x,y:e.y}}var c=i?tx(i):null;if(c!=null){var u=c==="y"?"height":"width";switch(o){case yl:l[c]=l[c]-(e[u]/2-n[u]/2);break;case cu:l[c]=l[c]+(e[u]/2-n[u]/2);break}}return l}function uu(t,e){e===void 0&&(e={});var n=e,r=n.placement,i=r===void 0?t.placement:r,o=n.strategy,s=o===void 0?t.strategy:o,a=n.boundary,l=a===void 0?iB:a,c=n.rootBoundary,u=c===void 0?$_:c,d=n.elementContext,h=d===void 0?nc:d,p=n.altBoundary,m=p===void 0?!1:p,y=n.padding,v=y===void 0?0:y,x=H_(typeof v!="number"?v:W_(v,Vu)),w=h===nc?oB:nc,b=t.rects.popper,S=t.elements[m?w:h],C=LB(Ds(S)?S:S.contextElement||$o(t.elements.popper),l,u,s),k=xl(t.elements.reference),E=q_({reference:k,element:b,strategy:"absolute",placement:i}),T=Hy(Object.assign({},b,E)),O=h===nc?T:k,_={top:C.top-O.top+x.top,bottom:O.bottom-C.bottom+x.bottom,left:C.left-O.left+x.left,right:O.right-C.right+x.right},D=t.modifiersData.offset;if(h===nc&&D){var L=D[i];Object.keys(_).forEach(function(N){var P=[qn,Kn].indexOf(N)>=0?1:-1,V=[fn,Kn].indexOf(N)>=0?"y":"x";_[N]+=L[V]*P})}return _}function $B(t,e){e===void 0&&(e={});var n=e,r=n.placement,i=n.boundary,o=n.rootBoundary,s=n.padding,a=n.flipVariations,l=n.allowedAutoPlacements,c=l===void 0?F_:l,u=wl(r),d=u?a?I1:I1.filter(function(m){return wl(m)===u}):Vu,h=d.filter(function(m){return c.indexOf(m)>=0});h.length===0&&(h=d);var p=h.reduce(function(m,y){return m[y]=uu(t,{placement:y,boundary:i,rootBoundary:o,padding:s})[Dr(y)],m},{});return Object.keys(p).sort(function(m,y){return p[m]-p[y]})}function FB(t){if(Dr(t)===X0)return[];var e=ff(t);return[D1(t),e,D1(e)]}function BB(t){var e=t.state,n=t.options,r=t.name;if(!e.modifiersData[r]._skip){for(var i=n.mainAxis,o=i===void 0?!0:i,s=n.altAxis,a=s===void 0?!0:s,l=n.fallbackPlacements,c=n.padding,u=n.boundary,d=n.rootBoundary,h=n.altBoundary,p=n.flipVariations,m=p===void 0?!0:p,y=n.allowedAutoPlacements,v=e.options.placement,x=Dr(v),w=x===v,b=l||(w||!m?[ff(v)]:FB(v)),S=[v].concat(b).reduce(function(Z,be){return Z.concat(Dr(be)===X0?$B(e,{placement:be,boundary:u,rootBoundary:d,padding:c,flipVariations:m,allowedAutoPlacements:y}):be)},[]),C=e.rects.reference,k=e.rects.popper,E=new Map,T=!0,O=S[0],_=0;_<S.length;_++){var D=S[_],L=Dr(D),N=wl(D)===yl,P=[fn,Kn].indexOf(L)>=0,V=P?"width":"height",I=uu(e,{placement:D,boundary:u,rootBoundary:d,altBoundary:h,padding:c}),F=P?N?qn:hn:N?Kn:fn;C[V]>k[V]&&(F=ff(F));var M=ff(F),A=[];if(o&&A.push(I[L]<=0),a&&A.push(I[F]<=0,I[M]<=0),A.every(function(Z){return Z})){O=D,T=!1;break}E.set(D,A)}if(T)for(var $=m?3:1,G=function(be){var ge=S.find(function(J){var ue=E.get(J);if(ue)return ue.slice(0,be).every(function(ye){return ye})});if(ge)return O=ge,"break"},ee=$;ee>0;ee--){var q=G(ee);if(q==="break")break}e.placement!==O&&(e.modifiersData[r]._skip=!0,e.placement=O,e.reset=!0)}}const zB={name:"flip",enabled:!0,phase:"main",fn:BB,requiresIfExists:["offset"],data:{_skip:!1}};function L1(t,e,n){return n===void 0&&(n={x:0,y:0}),{top:t.top-e.height-n.y,right:t.right-e.width+n.x,bottom:t.bottom-e.height+n.y,left:t.left-e.width-n.x}}function $1(t){return[fn,qn,Kn,hn].some(function(e){return t[e]>=0})}function VB(t){var e=t.state,n=t.name,r=e.rects.reference,i=e.rects.popper,o=e.modifiersData.preventOverflow,s=uu(e,{elementContext:"reference"}),a=uu(e,{altBoundary:!0}),l=L1(s,r),c=L1(a,i,o),u=$1(l),d=$1(c);e.modifiersData[n]={referenceClippingOffsets:l,popperEscapeOffsets:c,isReferenceHidden:u,hasPopperEscaped:d},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":u,"data-popper-escaped":d})}const UB={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:VB};function HB(t,e,n){var r=Dr(t),i=[hn,fn].indexOf(r)>=0?-1:1,o=typeof n=="function"?n(Object.assign({},e,{placement:t})):n,s=o[0],a=o[1];return s=s||0,a=(a||0)*i,[hn,qn].indexOf(r)>=0?{x:a,y:s}:{x:s,y:a}}function WB(t){var e=t.state,n=t.options,r=t.name,i=n.offset,o=i===void 0?[0,0]:i,s=F_.reduce(function(u,d){return u[d]=HB(d,e.rects,o),u},{}),a=s[e.placement],l=a.x,c=a.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=l,e.modifiersData.popperOffsets.y+=c),e.modifiersData[r]=s}const KB={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:WB};function qB(t){var e=t.state,n=t.name;e.modifiersData[n]=q_({reference:e.rects.reference,element:e.rects.popper,strategy:"absolute",placement:e.placement})}const GB={name:"popperOffsets",enabled:!0,phase:"read",fn:qB,data:{}};function JB(t){return t==="x"?"y":"x"}function YB(t){var e=t.state,n=t.options,r=t.name,i=n.mainAxis,o=i===void 0?!0:i,s=n.altAxis,a=s===void 0?!1:s,l=n.boundary,c=n.rootBoundary,u=n.altBoundary,d=n.padding,h=n.tether,p=h===void 0?!0:h,m=n.tetherOffset,y=m===void 0?0:m,v=uu(e,{boundary:l,rootBoundary:c,padding:d,altBoundary:u}),x=Dr(e.placement),w=wl(e.placement),b=!w,S=tx(x),C=JB(S),k=e.modifiersData.popperOffsets,E=e.rects.reference,T=e.rects.popper,O=typeof y=="function"?y(Object.assign({},e.rects,{placement:e.placement})):y,_=typeof O=="number"?{mainAxis:O,altAxis:O}:Object.assign({mainAxis:0,altAxis:0},O),D=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,L={x:0,y:0};if(k){if(o){var N,P=S==="y"?fn:hn,V=S==="y"?Kn:qn,I=S==="y"?"height":"width",F=k[S],M=F+v[P],A=F-v[V],$=p?-T[I]/2:0,G=w===yl?E[I]:T[I],ee=w===yl?-T[I]:-E[I],q=e.elements.arrow,Z=p&&q?ex(q):{width:0,height:0},be=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:U_(),ge=be[P],J=be[V],ue=Pc(0,E[I],Z[I]),ye=b?E[I]/2-$-ue-ge-_.mainAxis:G-ue-ge-_.mainAxis,de=b?-E[I]/2+$+ue+J+_.mainAxis:ee+ue+J+_.mainAxis,he=e.elements.arrow&&Uu(e.elements.arrow),ve=he?S==="y"?he.clientTop||0:he.clientLeft||0:0,Ze=(N=D==null?void 0:D[S])!=null?N:0,At=F+ye-Ze-ve,xr=F+de-Ze,Jn=Pc(p?oh(M,At):M,F,p?bs(A,xr):A);k[S]=Jn,L[S]=Jn-F}if(a){var Yn,Gs=S==="x"?fn:hn,Wr=S==="x"?Kn:qn,Kr=k[C],vi=C==="y"?"height":"width",Ul=Kr+v[Gs],Vo=Kr-v[Wr],Hl=[fn,hn].indexOf(x)!==-1,Qu=(Yn=D==null?void 0:D[C])!=null?Yn:0,Xu=Hl?Ul:Kr-E[vi]-T[vi]-Qu+_.altAxis,Zu=Hl?Kr+E[vi]+T[vi]-Qu-_.altAxis:Vo,ed=p&&Hl?wB(Xu,Kr,Zu):Pc(p?Xu:Ul,Kr,p?Zu:Vo);k[C]=ed,L[C]=ed-Kr}e.modifiersData[r]=L}}const QB={name:"preventOverflow",enabled:!0,phase:"main",fn:YB,requiresIfExists:["offset"]};function XB(t){return{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}}function ZB(t){return t===En(t)||!Bn(t)?nx(t):XB(t)}function e5(t){var e=t.getBoundingClientRect(),n=vl(e.width)/t.offsetWidth||1,r=vl(e.height)/t.offsetHeight||1;return n!==1||r!==1}function t5(t,e,n){n===void 0&&(n=!1);var r=Bn(e),i=Bn(e)&&e5(e),o=$o(e),s=xl(t,i,n),a={scrollLeft:0,scrollTop:0},l={x:0,y:0};return(r||!r&&!n)&&((zr(e)!=="body"||ix(o))&&(a=ZB(e)),Bn(e)?(l=xl(e,!0),l.x+=e.clientLeft,l.y+=e.clientTop):o&&(l.x=rx(o))),{x:s.left+a.scrollLeft-l.x,y:s.top+a.scrollTop-l.y,width:s.width,height:s.height}}function n5(t){var e=new Map,n=new Set,r=[];t.forEach(function(o){e.set(o.name,o)});function i(o){n.add(o.name);var s=[].concat(o.requires||[],o.requiresIfExists||[]);s.forEach(function(a){if(!n.has(a)){var l=e.get(a);l&&i(l)}}),r.push(o)}return t.forEach(function(o){n.has(o.name)||i(o)}),r}function r5(t){var e=n5(t);return mB.reduce(function(n,r){return n.concat(e.filter(function(i){return i.phase===r}))},[])}function i5(t){var e;return function(){return e||(e=new Promise(function(n){Promise.resolve().then(function(){e=void 0,n(t())})})),e}}function o5(t){var e=t.reduce(function(n,r){var i=n[r.name];return n[r.name]=i?Object.assign({},i,r,{options:Object.assign({},i.options,r.options),data:Object.assign({},i.data,r.data)}):r,n},{});return Object.keys(e).map(function(n){return e[n]})}var F1={placement:"bottom",modifiers:[],strategy:"absolute"};function B1(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return!e.some(function(r){return!(r&&typeof r.getBoundingClientRect=="function")})}function s5(t){t===void 0&&(t={});var e=t,n=e.defaultModifiers,r=n===void 0?[]:n,i=e.defaultOptions,o=i===void 0?F1:i;return function(a,l,c){c===void 0&&(c=o);var u={placement:"bottom",orderedModifiers:[],options:Object.assign({},F1,o),modifiersData:{},elements:{reference:a,popper:l},attributes:{},styles:{}},d=[],h=!1,p={state:u,setOptions:function(x){var w=typeof x=="function"?x(u.options):x;y(),u.options=Object.assign({},o,u.options,w),u.scrollParents={reference:Ds(a)?Mc(a):a.contextElement?Mc(a.contextElement):[],popper:Mc(l)};var b=r5(o5([].concat(r,u.options.modifiers)));return u.orderedModifiers=b.filter(function(S){return S.enabled}),m(),p.update()},forceUpdate:function(){if(!h){var x=u.elements,w=x.reference,b=x.popper;if(B1(w,b)){u.rects={reference:t5(w,Uu(b),u.options.strategy==="fixed"),popper:ex(b)},u.reset=!1,u.placement=u.options.placement,u.orderedModifiers.forEach(function(_){return u.modifiersData[_.name]=Object.assign({},_.data)});for(var S=0;S<u.orderedModifiers.length;S++){if(u.reset===!0){u.reset=!1,S=-1;continue}var C=u.orderedModifiers[S],k=C.fn,E=C.options,T=E===void 0?{}:E,O=C.name;typeof k=="function"&&(u=k({state:u,options:T,name:O,instance:p})||u)}}}},update:i5(function(){return new Promise(function(v){p.forceUpdate(),v(u)})}),destroy:function(){y(),h=!0}};if(!B1(a,l))return p;p.setOptions(c).then(function(v){!h&&c.onFirstUpdate&&c.onFirstUpdate(v)});function m(){u.orderedModifiers.forEach(function(v){var x=v.name,w=v.options,b=w===void 0?{}:w,S=v.effect;if(typeof S=="function"){var C=S({state:u,name:x,instance:p,options:b}),k=function(){};d.push(C||k)}})}function y(){d.forEach(function(v){return v()}),d=[]}return p}}var a5=[PB,GB,RB,B_,KB,zB,QB,kB,UB],l5=s5({defaultModifiers:a5}),c5="tippy-box",G_="tippy-content",u5="tippy-backdrop",J_="tippy-arrow",Y_="tippy-svg-arrow",Jo={passive:!0,capture:!0},Q_=function(){return document.body};function Am(t,e,n){if(Array.isArray(t)){var r=t[e];return r??(Array.isArray(n)?n[e]:n)}return t}function ox(t,e){var n={}.toString.call(t);return n.indexOf("[object")===0&&n.indexOf(e+"]")>-1}function X_(t,e){return typeof t=="function"?t.apply(void 0,e):t}function z1(t,e){if(e===0)return t;var n;return function(r){clearTimeout(n),n=setTimeout(function(){t(r)},e)}}function d5(t){return t.split(/\s+/).filter(Boolean)}function fa(t){return[].concat(t)}function V1(t,e){t.indexOf(e)===-1&&t.push(e)}function f5(t){return t.filter(function(e,n){return t.indexOf(e)===n})}function h5(t){return t.split("-")[0]}function sh(t){return[].slice.call(t)}function U1(t){return Object.keys(t).reduce(function(e,n){return t[n]!==void 0&&(e[n]=t[n]),e},{})}function Ic(){return document.createElement("div")}function cp(t){return["Element","Fragment"].some(function(e){return ox(t,e)})}function p5(t){return ox(t,"NodeList")}function m5(t){return ox(t,"MouseEvent")}function g5(t){return!!(t&&t._tippy&&t._tippy.reference===t)}function y5(t){return cp(t)?[t]:p5(t)?sh(t):Array.isArray(t)?t:sh(document.querySelectorAll(t))}function Nm(t,e){t.forEach(function(n){n&&(n.style.transitionDuration=e+"ms")})}function H1(t,e){t.forEach(function(n){n&&n.setAttribute("data-state",e)})}function v5(t){var e,n=fa(t),r=n[0];return r!=null&&(e=r.ownerDocument)!=null&&e.body?r.ownerDocument:document}function x5(t,e){var n=e.clientX,r=e.clientY;return t.every(function(i){var o=i.popperRect,s=i.popperState,a=i.props,l=a.interactiveBorder,c=h5(s.placement),u=s.modifiersData.offset;if(!u)return!0;var d=c==="bottom"?u.top.y:0,h=c==="top"?u.bottom.y:0,p=c==="right"?u.left.x:0,m=c==="left"?u.right.x:0,y=o.top-r+d>l,v=r-o.bottom-h>l,x=o.left-n+p>l,w=n-o.right-m>l;return y||v||x||w})}function Dm(t,e,n){var r=e+"EventListener";["transitionend","webkitTransitionEnd"].forEach(function(i){t[r](i,n)})}function W1(t,e){for(var n=e;n;){var r;if(t.contains(n))return!0;n=n.getRootNode==null||(r=n.getRootNode())==null?void 0:r.host}return!1}var Rr={isTouch:!1},K1=0;function w5(){Rr.isTouch||(Rr.isTouch=!0,window.performance&&document.addEventListener("mousemove",Z_))}function Z_(){var t=performance.now();t-K1<20&&(Rr.isTouch=!1,document.removeEventListener("mousemove",Z_)),K1=t}function b5(){var t=document.activeElement;if(g5(t)){var e=t._tippy;t.blur&&!e.state.isVisible&&t.blur()}}function S5(){document.addEventListener("touchstart",w5,Jo),window.addEventListener("blur",b5)}var C5=typeof window<"u"&&typeof document<"u",k5=C5?!!window.msCrypto:!1,E5={animateFill:!1,followCursor:!1,inlinePositioning:!1,sticky:!1},T5={allowHTML:!1,animation:"fade",arrow:!0,content:"",inertia:!1,maxWidth:350,role:"tooltip",theme:"",zIndex:9999},sr=Object.assign({appendTo:Q_,aria:{content:"auto",expanded:"auto"},delay:0,duration:[300,250],getReferenceClientRect:null,hideOnClick:!0,ignoreAttributes:!1,interactive:!1,interactiveBorder:2,interactiveDebounce:0,moveTransition:"",offset:[0,10],onAfterUpdate:function(){},onBeforeUpdate:function(){},onCreate:function(){},onDestroy:function(){},onHidden:function(){},onHide:function(){},onMount:function(){},onShow:function(){},onShown:function(){},onTrigger:function(){},onUntrigger:function(){},onClickOutside:function(){},placement:"top",plugins:[],popperOptions:{},render:null,showOnCreate:!1,touch:!0,trigger:"mouseenter focus",triggerTarget:null},E5,T5),_5=Object.keys(sr),R5=function(e){var n=Object.keys(e);n.forEach(function(r){sr[r]=e[r]})};function eR(t){var e=t.plugins||[],n=e.reduce(function(r,i){var o=i.name,s=i.defaultValue;if(o){var a;r[o]=t[o]!==void 0?t[o]:(a=sr[o])!=null?a:s}return r},{});return Object.assign({},t,n)}function O5(t,e){var n=e?Object.keys(eR(Object.assign({},sr,{plugins:e}))):_5,r=n.reduce(function(i,o){var s=(t.getAttribute("data-tippy-"+o)||"").trim();if(!s)return i;if(o==="content")i[o]=s;else try{i[o]=JSON.parse(s)}catch{i[o]=s}return i},{});return r}function q1(t,e){var n=Object.assign({},e,{content:X_(e.content,[t])},e.ignoreAttributes?{}:O5(t,e.plugins));return n.aria=Object.assign({},sr.aria,n.aria),n.aria={expanded:n.aria.expanded==="auto"?e.interactive:n.aria.expanded,content:n.aria.content==="auto"?e.interactive?null:"describedby":n.aria.content},n}var P5=function(){return"innerHTML"};function Wy(t,e){t[P5()]=e}function G1(t){var e=Ic();return t===!0?e.className=J_:(e.className=Y_,cp(t)?e.appendChild(t):Wy(e,t)),e}function J1(t,e){cp(e.content)?(Wy(t,""),t.appendChild(e.content)):typeof e.content!="function"&&(e.allowHTML?Wy(t,e.content):t.textContent=e.content)}function Ky(t){var e=t.firstElementChild,n=sh(e.children);return{box:e,content:n.find(function(r){return r.classList.contains(G_)}),arrow:n.find(function(r){return r.classList.contains(J_)||r.classList.contains(Y_)}),backdrop:n.find(function(r){return r.classList.contains(u5)})}}function tR(t){var e=Ic(),n=Ic();n.className=c5,n.setAttribute("data-state","hidden"),n.setAttribute("tabindex","-1");var r=Ic();r.className=G_,r.setAttribute("data-state","hidden"),J1(r,t.props),e.appendChild(n),n.appendChild(r),i(t.props,t.props);function i(o,s){var a=Ky(e),l=a.box,c=a.content,u=a.arrow;s.theme?l.setAttribute("data-theme",s.theme):l.removeAttribute("data-theme"),typeof s.animation=="string"?l.setAttribute("data-animation",s.animation):l.removeAttribute("data-animation"),s.inertia?l.setAttribute("data-inertia",""):l.removeAttribute("data-inertia"),l.style.maxWidth=typeof s.maxWidth=="number"?s.maxWidth+"px":s.maxWidth,s.role?l.setAttribute("role",s.role):l.removeAttribute("role"),(o.content!==s.content||o.allowHTML!==s.allowHTML)&&J1(c,t.props),s.arrow?u?o.arrow!==s.arrow&&(l.removeChild(u),l.appendChild(G1(s.arrow))):l.appendChild(G1(s.arrow)):u&&l.removeChild(u)}return{popper:e,onUpdate:i}}tR.$$tippy=!0;var M5=1,Dd=[],jm=[];function I5(t,e){var n=q1(t,Object.assign({},sr,eR(U1(e)))),r,i,o,s=!1,a=!1,l=!1,c=!1,u,d,h,p=[],m=z1(At,n.interactiveDebounce),y,v=M5++,x=null,w=f5(n.plugins),b={isEnabled:!0,isVisible:!1,isDestroyed:!1,isMounted:!1,isShown:!1},S={id:v,reference:t,popper:Ic(),popperInstance:x,props:n,state:b,plugins:w,clearDelayTimeouts:Xu,setProps:Zu,setContent:ed,show:nM,hide:rM,hideWithInteractivity:iM,enable:Hl,disable:Qu,unmount:oM,destroy:sM};if(!n.render)return S;var C=n.render(S),k=C.popper,E=C.onUpdate;k.setAttribute("data-tippy-root",""),k.id="tippy-"+S.id,S.popper=k,t._tippy=S,k._tippy=S;var T=w.map(function(j){return j.fn(S)}),O=t.hasAttribute("aria-expanded");return he(),$(),F(),M("onCreate",[S]),n.showOnCreate&&Ul(),k.addEventListener("mouseenter",function(){S.props.interactive&&S.state.isVisible&&S.clearDelayTimeouts()}),k.addEventListener("mouseleave",function(){S.props.interactive&&S.props.trigger.indexOf("mouseenter")>=0&&P().addEventListener("mousemove",m)}),S;function _(){var j=S.props.touch;return Array.isArray(j)?j:[j,0]}function D(){return _()[0]==="hold"}function L(){var j;return!!((j=S.props.render)!=null&&j.$$tippy)}function N(){return y||t}function P(){var j=N().parentNode;return j?v5(j):document}function V(){return Ky(k)}function I(j){return S.state.isMounted&&!S.state.isVisible||Rr.isTouch||u&&u.type==="focus"?0:Am(S.props.delay,j?0:1,sr.delay)}function F(j){j===void 0&&(j=!1),k.style.pointerEvents=S.props.interactive&&!j?"":"none",k.style.zIndex=""+S.props.zIndex}function M(j,X,re){if(re===void 0&&(re=!0),T.forEach(function(xe){xe[j]&&xe[j].apply(xe,X)}),re){var Ce;(Ce=S.props)[j].apply(Ce,X)}}function A(){var j=S.props.aria;if(j.content){var X="aria-"+j.content,re=k.id,Ce=fa(S.props.triggerTarget||t);Ce.forEach(function(xe){var Nt=xe.getAttribute(X);if(S.state.isVisible)xe.setAttribute(X,Nt?Nt+" "+re:re);else{var On=Nt&&Nt.replace(re,"").trim();On?xe.setAttribute(X,On):xe.removeAttribute(X)}})}}function $(){if(!(O||!S.props.aria.expanded)){var j=fa(S.props.triggerTarget||t);j.forEach(function(X){S.props.interactive?X.setAttribute("aria-expanded",S.state.isVisible&&X===N()?"true":"false"):X.removeAttribute("aria-expanded")})}}function G(){P().removeEventListener("mousemove",m),Dd=Dd.filter(function(j){return j!==m})}function ee(j){if(!(Rr.isTouch&&(l||j.type==="mousedown"))){var X=j.composedPath&&j.composedPath()[0]||j.target;if(!(S.props.interactive&&W1(k,X))){if(fa(S.props.triggerTarget||t).some(function(re){return W1(re,X)})){if(Rr.isTouch||S.state.isVisible&&S.props.trigger.indexOf("click")>=0)return}else M("onClickOutside",[S,j]);S.props.hideOnClick===!0&&(S.clearDelayTimeouts(),S.hide(),a=!0,setTimeout(function(){a=!1}),S.state.isMounted||ge())}}}function q(){l=!0}function Z(){l=!1}function be(){var j=P();j.addEventListener("mousedown",ee,!0),j.addEventListener("touchend",ee,Jo),j.addEventListener("touchstart",Z,Jo),j.addEventListener("touchmove",q,Jo)}function ge(){var j=P();j.removeEventListener("mousedown",ee,!0),j.removeEventListener("touchend",ee,Jo),j.removeEventListener("touchstart",Z,Jo),j.removeEventListener("touchmove",q,Jo)}function J(j,X){ye(j,function(){!S.state.isVisible&&k.parentNode&&k.parentNode.contains(k)&&X()})}function ue(j,X){ye(j,X)}function ye(j,X){var re=V().box;function Ce(xe){xe.target===re&&(Dm(re,"remove",Ce),X())}if(j===0)return X();Dm(re,"remove",d),Dm(re,"add",Ce),d=Ce}function de(j,X,re){re===void 0&&(re=!1);var Ce=fa(S.props.triggerTarget||t);Ce.forEach(function(xe){xe.addEventListener(j,X,re),p.push({node:xe,eventType:j,handler:X,options:re})})}function he(){D()&&(de("touchstart",Ze,{passive:!0}),de("touchend",xr,{passive:!0})),d5(S.props.trigger).forEach(function(j){if(j!=="manual")switch(de(j,Ze),j){case"mouseenter":de("mouseleave",xr);break;case"focus":de(k5?"focusout":"blur",Jn);break;case"focusin":de("focusout",Jn);break}})}function ve(){p.forEach(function(j){var X=j.node,re=j.eventType,Ce=j.handler,xe=j.options;X.removeEventListener(re,Ce,xe)}),p=[]}function Ze(j){var X,re=!1;if(!(!S.state.isEnabled||Yn(j)||a)){var Ce=((X=u)==null?void 0:X.type)==="focus";u=j,y=j.currentTarget,$(),!S.state.isVisible&&m5(j)&&Dd.forEach(function(xe){return xe(j)}),j.type==="click"&&(S.props.trigger.indexOf("mouseenter")<0||s)&&S.props.hideOnClick!==!1&&S.state.isVisible?re=!0:Ul(j),j.type==="click"&&(s=!re),re&&!Ce&&Vo(j)}}function At(j){var X=j.target,re=N().contains(X)||k.contains(X);if(!(j.type==="mousemove"&&re)){var Ce=vi().concat(k).map(function(xe){var Nt,On=xe._tippy,Js=(Nt=On.popperInstance)==null?void 0:Nt.state;return Js?{popperRect:xe.getBoundingClientRect(),popperState:Js,props:n}:null}).filter(Boolean);x5(Ce,j)&&(G(),Vo(j))}}function xr(j){var X=Yn(j)||S.props.trigger.indexOf("click")>=0&&s;if(!X){if(S.props.interactive){S.hideWithInteractivity(j);return}Vo(j)}}function Jn(j){S.props.trigger.indexOf("focusin")<0&&j.target!==N()||S.props.interactive&&j.relatedTarget&&k.contains(j.relatedTarget)||Vo(j)}function Yn(j){return Rr.isTouch?D()!==j.type.indexOf("touch")>=0:!1}function Gs(){Wr();var j=S.props,X=j.popperOptions,re=j.placement,Ce=j.offset,xe=j.getReferenceClientRect,Nt=j.moveTransition,On=L()?Ky(k).arrow:null,Js=xe?{getBoundingClientRect:xe,contextElement:xe.contextElement||N()}:t,Vx={name:"$$tippy",enabled:!0,phase:"beforeWrite",requires:["computeStyles"],fn:function(td){var Ys=td.state;if(L()){var aM=V(),Ap=aM.box;["placement","reference-hidden","escaped"].forEach(function(nd){nd==="placement"?Ap.setAttribute("data-placement",Ys.placement):Ys.attributes.popper["data-popper-"+nd]?Ap.setAttribute("data-"+nd,""):Ap.removeAttribute("data-"+nd)}),Ys.attributes.popper={}}}},Uo=[{name:"offset",options:{offset:Ce}},{name:"preventOverflow",options:{padding:{top:2,bottom:2,left:5,right:5}}},{name:"flip",options:{padding:5}},{name:"computeStyles",options:{adaptive:!Nt}},Vx];L()&&On&&Uo.push({name:"arrow",options:{element:On,padding:3}}),Uo.push.apply(Uo,(X==null?void 0:X.modifiers)||[]),S.popperInstance=l5(Js,k,Object.assign({},X,{placement:re,onFirstUpdate:h,modifiers:Uo}))}function Wr(){S.popperInstance&&(S.popperInstance.destroy(),S.popperInstance=null)}function Kr(){var j=S.props.appendTo,X,re=N();S.props.interactive&&j===Q_||j==="parent"?X=re.parentNode:X=X_(j,[re]),X.contains(k)||X.appendChild(k),S.state.isMounted=!0,Gs()}function vi(){return sh(k.querySelectorAll("[data-tippy-root]"))}function Ul(j){S.clearDelayTimeouts(),j&&M("onTrigger",[S,j]),be();var X=I(!0),re=_(),Ce=re[0],xe=re[1];Rr.isTouch&&Ce==="hold"&&xe&&(X=xe),X?r=setTimeout(function(){S.show()},X):S.show()}function Vo(j){if(S.clearDelayTimeouts(),M("onUntrigger",[S,j]),!S.state.isVisible){ge();return}if(!(S.props.trigger.indexOf("mouseenter")>=0&&S.props.trigger.indexOf("click")>=0&&["mouseleave","mousemove"].indexOf(j.type)>=0&&s)){var X=I(!1);X?i=setTimeout(function(){S.state.isVisible&&S.hide()},X):o=requestAnimationFrame(function(){S.hide()})}}function Hl(){S.state.isEnabled=!0}function Qu(){S.hide(),S.state.isEnabled=!1}function Xu(){clearTimeout(r),clearTimeout(i),cancelAnimationFrame(o)}function Zu(j){if(!S.state.isDestroyed){M("onBeforeUpdate",[S,j]),ve();var X=S.props,re=q1(t,Object.assign({},X,U1(j),{ignoreAttributes:!0}));S.props=re,he(),X.interactiveDebounce!==re.interactiveDebounce&&(G(),m=z1(At,re.interactiveDebounce)),X.triggerTarget&&!re.triggerTarget?fa(X.triggerTarget).forEach(function(Ce){Ce.removeAttribute("aria-expanded")}):re.triggerTarget&&t.removeAttribute("aria-expanded"),$(),F(),E&&E(X,re),S.popperInstance&&(Gs(),vi().forEach(function(Ce){requestAnimationFrame(Ce._tippy.popperInstance.forceUpdate)})),M("onAfterUpdate",[S,j])}}function ed(j){S.setProps({content:j})}function nM(){var j=S.state.isVisible,X=S.state.isDestroyed,re=!S.state.isEnabled,Ce=Rr.isTouch&&!S.props.touch,xe=Am(S.props.duration,0,sr.duration);if(!(j||X||re||Ce)&&!N().hasAttribute("disabled")&&(M("onShow",[S],!1),S.props.onShow(S)!==!1)){if(S.state.isVisible=!0,L()&&(k.style.visibility="visible"),F(),be(),S.state.isMounted||(k.style.transition="none"),L()){var Nt=V(),On=Nt.box,Js=Nt.content;Nm([On,Js],0)}h=function(){var Uo;if(!(!S.state.isVisible||c)){if(c=!0,k.offsetHeight,k.style.transition=S.props.moveTransition,L()&&S.props.animation){var Ip=V(),td=Ip.box,Ys=Ip.content;Nm([td,Ys],xe),H1([td,Ys],"visible")}A(),$(),V1(jm,S),(Uo=S.popperInstance)==null||Uo.forceUpdate(),M("onMount",[S]),S.props.animation&&L()&&ue(xe,function(){S.state.isShown=!0,M("onShown",[S])})}},Kr()}}function rM(){var j=!S.state.isVisible,X=S.state.isDestroyed,re=!S.state.isEnabled,Ce=Am(S.props.duration,1,sr.duration);if(!(j||X||re)&&(M("onHide",[S],!1),S.props.onHide(S)!==!1)){if(S.state.isVisible=!1,S.state.isShown=!1,c=!1,s=!1,L()&&(k.style.visibility="hidden"),G(),ge(),F(!0),L()){var xe=V(),Nt=xe.box,On=xe.content;S.props.animation&&(Nm([Nt,On],Ce),H1([Nt,On],"hidden"))}A(),$(),S.props.animation?L()&&J(Ce,S.unmount):S.unmount()}}function iM(j){P().addEventListener("mousemove",m),V1(Dd,m),m(j)}function oM(){S.state.isVisible&&S.hide(),S.state.isMounted&&(Wr(),vi().forEach(function(j){j._tippy.unmount()}),k.parentNode&&k.parentNode.removeChild(k),jm=jm.filter(function(j){return j!==S}),S.state.isMounted=!1,M("onHidden",[S]))}function sM(){S.state.isDestroyed||(S.clearDelayTimeouts(),S.unmount(),ve(),delete t._tippy,S.state.isDestroyed=!0,M("onDestroy",[S]))}}function Hu(t,e){e===void 0&&(e={});var n=sr.plugins.concat(e.plugins||[]);S5();var r=Object.assign({},e,{plugins:n}),i=y5(t),o=i.reduce(function(s,a){var l=a&&I5(a,r);return l&&s.push(l),s},[]);return cp(t)?o[0]:o}Hu.defaultProps=sr;Hu.setDefaultProps=R5;Hu.currentInput=Rr;Object.assign({},B_,{effect:function(e){var n=e.state,r={popper:{position:n.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};Object.assign(n.elements.popper.style,r.popper),n.styles=r,n.elements.arrow&&Object.assign(n.elements.arrow.style,r.arrow)}});Hu.setDefaultProps({render:tR});class A5{constructor({editor:e,element:n,view:r,tippyOptions:i={},updateDelay:o=250,shouldShow:s}){this.preventHide=!1,this.shouldShow=({view:a,state:l,from:c,to:u})=>{const{doc:d,selection:h}=l,{empty:p}=h,m=!d.textBetween(c,u).length&&J0(l.selection),y=this.element.contains(document.activeElement);return!(!(a.hasFocus()||y)||p||m||!this.editor.isEditable)},this.mousedownHandler=()=>{this.preventHide=!0},this.dragstartHandler=()=>{this.hide()},this.focusHandler=()=>{setTimeout(()=>this.update(this.editor.view))},this.blurHandler=({event:a})=>{var l;if(this.preventHide){this.preventHide=!1;return}a!=null&&a.relatedTarget&&(!((l=this.element.parentNode)===null||l===void 0)&&l.contains(a.relatedTarget))||(a==null?void 0:a.relatedTarget)!==this.editor.view.dom&&this.hide()},this.tippyBlurHandler=a=>{this.blurHandler({event:a})},this.handleDebouncedUpdate=(a,l)=>{const c=!(l!=null&&l.selection.eq(a.state.selection)),u=!(l!=null&&l.doc.eq(a.state.doc));!c&&!u||(this.updateDebounceTimer&&clearTimeout(this.updateDebounceTimer),this.updateDebounceTimer=window.setTimeout(()=>{this.updateHandler(a,c,u,l)},this.updateDelay))},this.updateHandler=(a,l,c,u)=>{var d,h,p;const{state:m,composing:y}=a,{selection:v}=m;if(y||!l&&!c)return;this.createTooltip();const{ranges:w}=v,b=Math.min(...w.map(k=>k.$from.pos)),S=Math.max(...w.map(k=>k.$to.pos));if(!((d=this.shouldShow)===null||d===void 0?void 0:d.call(this,{editor:this.editor,element:this.element,view:a,state:m,oldState:u,from:b,to:S}))){this.hide();return}(h=this.tippy)===null||h===void 0||h.setProps({getReferenceClientRect:((p=this.tippyOptions)===null||p===void 0?void 0:p.getReferenceClientRect)||(()=>{if(L_(m.selection)){let k=a.nodeDOM(b);if(k){const E=k.dataset.nodeViewWrapper?k:k.querySelector("[data-node-view-wrapper]");if(E&&(k=E.firstChild),k)return k.getBoundingClientRect()}}return EF(a,b,S)})}),this.show()},this.editor=e,this.element=n,this.view=r,this.updateDelay=o,s&&(this.shouldShow=s),this.element.addEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.view.dom.addEventListener("dragstart",this.dragstartHandler),this.editor.on("focus",this.focusHandler),this.editor.on("blur",this.blurHandler),this.tippyOptions=i,this.element.remove(),this.element.style.visibility="visible"}createTooltip(){const{element:e}=this.editor.options,n=!!e.parentElement;this.tippy||!n||(this.tippy=Hu(e,{duration:0,getReferenceClientRect:null,content:this.element,interactive:!0,trigger:"manual",placement:"top",hideOnClick:"toggle",...this.tippyOptions}),this.tippy.popper.firstChild&&this.tippy.popper.firstChild.addEventListener("blur",this.tippyBlurHandler))}update(e,n){const{state:r}=e,i=r.selection.from!==r.selection.to;if(this.updateDelay>0&&i){this.handleDebouncedUpdate(e,n);return}const o=!(n!=null&&n.selection.eq(e.state.selection)),s=!(n!=null&&n.doc.eq(e.state.doc));this.updateHandler(e,o,s,n)}show(){var e;(e=this.tippy)===null||e===void 0||e.show()}hide(){var e;(e=this.tippy)===null||e===void 0||e.hide()}destroy(){var e,n;!((e=this.tippy)===null||e===void 0)&&e.popper.firstChild&&this.tippy.popper.firstChild.removeEventListener("blur",this.tippyBlurHandler),(n=this.tippy)===null||n===void 0||n.destroy(),this.element.removeEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.view.dom.removeEventListener("dragstart",this.dragstartHandler),this.editor.off("focus",this.focusHandler),this.editor.off("blur",this.blurHandler)}}const nR=t=>new xt({key:typeof t.pluginKey=="string"?new Rn(t.pluginKey):t.pluginKey,view:e=>new A5({view:e,...t})});dt.create({name:"bubbleMenu",addOptions(){return{element:null,tippyOptions:{},pluginKey:"bubbleMenu",updateDelay:void 0,shouldShow:null}},addProseMirrorPlugins(){return this.options.element?[nR({pluginKey:this.options.pluginKey,editor:this.editor,element:this.options.element,tippyOptions:this.options.tippyOptions,updateDelay:this.options.updateDelay,shouldShow:this.options.shouldShow})]:[]}});function N5(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var rR={exports:{}},Lm={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Y1;function D5(){if(Y1)return Lm;Y1=1;var t=Te;function e(d,h){return d===h&&(d!==0||1/d===1/h)||d!==d&&h!==h}var n=typeof Object.is=="function"?Object.is:e,r=t.useState,i=t.useEffect,o=t.useLayoutEffect,s=t.useDebugValue;function a(d,h){var p=h(),m=r({inst:{value:p,getSnapshot:h}}),y=m[0].inst,v=m[1];return o(function(){y.value=p,y.getSnapshot=h,l(y)&&v({inst:y})},[d,p,h]),i(function(){return l(y)&&v({inst:y}),d(function(){l(y)&&v({inst:y})})},[d]),s(p),p}function l(d){var h=d.getSnapshot;d=d.value;try{var p=h();return!n(d,p)}catch{return!0}}function c(d,h){return h()}var u=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?c:a;return Lm.useSyncExternalStore=t.useSyncExternalStore!==void 0?t.useSyncExternalStore:u,Lm}rR.exports=D5();var sx=rR.exports;const j5=(...t)=>e=>{t.forEach(n=>{typeof n=="function"?n(e):n&&(n.current=e)})},L5=({contentComponent:t})=>{const e=sx.useSyncExternalStore(t.subscribe,t.getSnapshot,t.getServerSnapshot);return Te.createElement(Te.Fragment,null,Object.values(e))};function $5(){const t=new Set;let e={};return{subscribe(n){return t.add(n),()=>{t.delete(n)}},getSnapshot(){return e},getServerSnapshot(){return e},setRenderer(n,r){e={...e,[n]:cE.createPortal(r.reactElement,r.element,n)},t.forEach(i=>i())},removeRenderer(n){const r={...e};delete r[n],e=r,t.forEach(i=>i())}}}class F5 extends Te.Component{constructor(e){var n;super(e),this.editorContentRef=Te.createRef(),this.initialized=!1,this.state={hasContentComponentInitialized:!!(!((n=e.editor)===null||n===void 0)&&n.contentComponent)}}componentDidMount(){this.init()}componentDidUpdate(){this.init()}init(){const e=this.props.editor;if(e&&!e.isDestroyed&&e.options.element){if(e.contentComponent)return;const n=this.editorContentRef.current;n.append(...e.options.element.childNodes),e.setOptions({element:n}),e.contentComponent=$5(),this.state.hasContentComponentInitialized||(this.unsubscribeToContentComponent=e.contentComponent.subscribe(()=>{this.setState(r=>r.hasContentComponentInitialized?r:{hasContentComponentInitialized:!0}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent()})),e.createNodeViews(),this.initialized=!0}}componentWillUnmount(){const e=this.props.editor;if(!e||(this.initialized=!1,e.isDestroyed||e.view.setProps({nodeViews:{}}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent(),e.contentComponent=null,!e.options.element.firstChild))return;const n=document.createElement("div");n.append(...e.options.element.childNodes),e.setOptions({element:n})}render(){const{editor:e,innerRef:n,...r}=this.props;return Te.createElement(Te.Fragment,null,Te.createElement("div",{ref:j5(n,this.editorContentRef),...r}),(e==null?void 0:e.contentComponent)&&Te.createElement(L5,{contentComponent:e.contentComponent}))}}const B5=g.forwardRef((t,e)=>{const n=Te.useMemo(()=>Math.floor(Math.random()*4294967295).toString(),[t.editor]);return Te.createElement(F5,{key:n,innerRef:e,...t})}),z5=Te.memo(B5);var V5=function t(e,n){if(e===n)return!0;if(e&&n&&typeof e=="object"&&typeof n=="object"){if(e.constructor!==n.constructor)return!1;var r,i,o;if(Array.isArray(e)){if(r=e.length,r!=n.length)return!1;for(i=r;i--!==0;)if(!t(e[i],n[i]))return!1;return!0}if(e instanceof Map&&n instanceof Map){if(e.size!==n.size)return!1;for(i of e.entries())if(!n.has(i[0]))return!1;for(i of e.entries())if(!t(i[1],n.get(i[0])))return!1;return!0}if(e instanceof Set&&n instanceof Set){if(e.size!==n.size)return!1;for(i of e.entries())if(!n.has(i[0]))return!1;return!0}if(ArrayBuffer.isView(e)&&ArrayBuffer.isView(n)){if(r=e.length,r!=n.length)return!1;for(i=r;i--!==0;)if(e[i]!==n[i])return!1;return!0}if(e.constructor===RegExp)return e.source===n.source&&e.flags===n.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===n.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===n.toString();if(o=Object.keys(e),r=o.length,r!==Object.keys(n).length)return!1;for(i=r;i--!==0;)if(!Object.prototype.hasOwnProperty.call(n,o[i]))return!1;for(i=r;i--!==0;){var s=o[i];if(!(s==="_owner"&&e.$$typeof)&&!t(e[s],n[s]))return!1}return!0}return e!==e&&n!==n},U5=N5(V5),iR={exports:{}},$m={};/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Q1;function H5(){if(Q1)return $m;Q1=1;var t=Te,e=sx;function n(c,u){return c===u&&(c!==0||1/c===1/u)||c!==c&&u!==u}var r=typeof Object.is=="function"?Object.is:n,i=e.useSyncExternalStore,o=t.useRef,s=t.useEffect,a=t.useMemo,l=t.useDebugValue;return $m.useSyncExternalStoreWithSelector=function(c,u,d,h,p){var m=o(null);if(m.current===null){var y={hasValue:!1,value:null};m.current=y}else y=m.current;m=a(function(){function x(k){if(!w){if(w=!0,b=k,k=h(k),p!==void 0&&y.hasValue){var E=y.value;if(p(E,k))return S=E}return S=k}if(E=S,r(b,k))return E;var T=h(k);return p!==void 0&&p(E,T)?E:(b=k,S=T)}var w=!1,b,S,C=d===void 0?null:d;return[function(){return x(u())},C===null?void 0:function(){return x(C())}]},[u,d,h,p]);var v=i(c,m[0],m[1]);return s(function(){y.hasValue=!0,y.value=v},[v]),l(v),v},$m}iR.exports=H5();var W5=iR.exports;const K5=typeof window<"u"?g.useLayoutEffect:g.useEffect;class q5{constructor(e){this.transactionNumber=0,this.lastTransactionNumber=0,this.subscribers=new Set,this.editor=e,this.lastSnapshot={editor:e,transactionNumber:0},this.getSnapshot=this.getSnapshot.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.watch=this.watch.bind(this),this.subscribe=this.subscribe.bind(this)}getSnapshot(){return this.transactionNumber===this.lastTransactionNumber?this.lastSnapshot:(this.lastTransactionNumber=this.transactionNumber,this.lastSnapshot={editor:this.editor,transactionNumber:this.transactionNumber},this.lastSnapshot)}getServerSnapshot(){return{editor:null,transactionNumber:0}}subscribe(e){return this.subscribers.add(e),()=>{this.subscribers.delete(e)}}watch(e){if(this.editor=e,this.editor){const n=()=>{this.transactionNumber+=1,this.subscribers.forEach(i=>i())},r=this.editor;return r.on("transaction",n),()=>{r.off("transaction",n)}}}}function G5(t){var e;const[n]=g.useState(()=>new q5(t.editor)),r=W5.useSyncExternalStoreWithSelector(n.subscribe,n.getSnapshot,n.getServerSnapshot,t.selector,(e=t.equalityFn)!==null&&e!==void 0?e:U5);return K5(()=>n.watch(t.editor),[t.editor,n]),g.useDebugValue(r),r}const J5=!1,qy=typeof window>"u",Y5=qy||!!(typeof window<"u"&&window.next);class ax{constructor(e){this.editor=null,this.subscriptions=new Set,this.isComponentMounted=!1,this.previousDeps=null,this.instanceId="",this.options=e,this.subscriptions=new Set,this.setEditor(this.getInitialEditor()),this.scheduleDestroy(),this.getEditor=this.getEditor.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.subscribe=this.subscribe.bind(this),this.refreshEditorInstance=this.refreshEditorInstance.bind(this),this.scheduleDestroy=this.scheduleDestroy.bind(this),this.onRender=this.onRender.bind(this),this.createEditor=this.createEditor.bind(this)}setEditor(e){this.editor=e,this.instanceId=Math.random().toString(36).slice(2,9),this.subscriptions.forEach(n=>n())}getInitialEditor(){if(this.options.current.immediatelyRender===void 0)return qy||Y5?null:this.createEditor();if(this.options.current.immediatelyRender&&qy&&J5)throw new Error("Tiptap Error: SSR has been detected, and `immediatelyRender` has been set to `true` this is an unsupported configuration that may result in errors, explicitly set `immediatelyRender` to `false` to avoid hydration mismatches.");return this.options.current.immediatelyRender?this.createEditor():null}createEditor(){const e={...this.options.current,onBeforeCreate:(...r)=>{var i,o;return(o=(i=this.options.current).onBeforeCreate)===null||o===void 0?void 0:o.call(i,...r)},onBlur:(...r)=>{var i,o;return(o=(i=this.options.current).onBlur)===null||o===void 0?void 0:o.call(i,...r)},onCreate:(...r)=>{var i,o;return(o=(i=this.options.current).onCreate)===null||o===void 0?void 0:o.call(i,...r)},onDestroy:(...r)=>{var i,o;return(o=(i=this.options.current).onDestroy)===null||o===void 0?void 0:o.call(i,...r)},onFocus:(...r)=>{var i,o;return(o=(i=this.options.current).onFocus)===null||o===void 0?void 0:o.call(i,...r)},onSelectionUpdate:(...r)=>{var i,o;return(o=(i=this.options.current).onSelectionUpdate)===null||o===void 0?void 0:o.call(i,...r)},onTransaction:(...r)=>{var i,o;return(o=(i=this.options.current).onTransaction)===null||o===void 0?void 0:o.call(i,...r)},onUpdate:(...r)=>{var i,o;return(o=(i=this.options.current).onUpdate)===null||o===void 0?void 0:o.call(i,...r)},onContentError:(...r)=>{var i,o;return(o=(i=this.options.current).onContentError)===null||o===void 0?void 0:o.call(i,...r)},onDrop:(...r)=>{var i,o;return(o=(i=this.options.current).onDrop)===null||o===void 0?void 0:o.call(i,...r)},onPaste:(...r)=>{var i,o;return(o=(i=this.options.current).onPaste)===null||o===void 0?void 0:o.call(i,...r)}};return new tB(e)}getEditor(){return this.editor}getServerSnapshot(){return null}subscribe(e){return this.subscriptions.add(e),()=>{this.subscriptions.delete(e)}}static compareOptions(e,n){return Object.keys(e).every(r=>["onCreate","onBeforeCreate","onDestroy","onUpdate","onTransaction","onFocus","onBlur","onSelectionUpdate","onContentError","onDrop","onPaste"].includes(r)?!0:r==="extensions"&&e.extensions&&n.extensions?e.extensions.length!==n.extensions.length?!1:e.extensions.every((i,o)=>{var s;return i===((s=n.extensions)===null||s===void 0?void 0:s[o])}):e[r]===n[r])}onRender(e){return()=>(this.isComponentMounted=!0,clearTimeout(this.scheduledDestructionTimeout),this.editor&&!this.editor.isDestroyed&&e.length===0?ax.compareOptions(this.options.current,this.editor.options)||this.editor.setOptions({...this.options.current,editable:this.editor.isEditable}):this.refreshEditorInstance(e),()=>{this.isComponentMounted=!1,this.scheduleDestroy()})}refreshEditorInstance(e){if(this.editor&&!this.editor.isDestroyed){if(this.previousDeps===null){this.previousDeps=e;return}if(this.previousDeps.length===e.length&&this.previousDeps.every((r,i)=>r===e[i]))return}this.editor&&!this.editor.isDestroyed&&this.editor.destroy(),this.setEditor(this.createEditor()),this.previousDeps=e}scheduleDestroy(){const e=this.instanceId,n=this.editor;this.scheduledDestructionTimeout=setTimeout(()=>{if(this.isComponentMounted&&this.instanceId===e){n&&n.setOptions(this.options.current);return}n&&!n.isDestroyed&&(n.destroy(),this.instanceId===e&&this.setEditor(null))},1)}}function Q5(t={},e=[]){const n=g.useRef(t);n.current=t;const[r]=g.useState(()=>new ax(n)),i=sx.useSyncExternalStore(r.subscribe,r.getEditor,r.getServerSnapshot);return g.useDebugValue(i),g.useEffect(r.onRender(e)),G5({editor:i,selector:({transactionNumber:o})=>t.shouldRerenderOnTransaction===!1?null:t.immediatelyRender&&o===0?0:o+1}),i}const oR=g.createContext({editor:null});oR.Consumer;const X5=()=>g.useContext(oR),Z5=t=>{const[e,n]=g.useState(null),{editor:r}=X5();return g.useEffect(()=>{var i;if(!e||!((i=t.editor)===null||i===void 0)&&i.isDestroyed||r!=null&&r.isDestroyed)return;const{pluginKey:o="bubbleMenu",editor:s,tippyOptions:a={},updateDelay:l,shouldShow:c=null}=t,u=s||r;if(!u){console.warn("BubbleMenu component is not rendered inside of an editor component or does not have editor prop.");return}const d=nR({updateDelay:l,editor:u,element:e,pluginKey:o,shouldShow:c,tippyOptions:a});return u.registerPlugin(d),()=>{u.unregisterPlugin(o)}},[t.editor,r,e]),Te.createElement("div",{ref:n,className:t.className,style:{visibility:"hidden"}},t.children)},e6=g.createContext({onDragStart:void 0}),t6=()=>g.useContext(e6);Te.forwardRef((t,e)=>{const{onDragStart:n}=t6(),r=t.as||"div";return Te.createElement(r,{...t,ref:e,"data-node-view-wrapper":"",onDragStart:n,style:{whiteSpace:"normal",...t.style}})});const n6=/^\s*>\s$/,r6=gr.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:t}){return["blockquote",Kt(this.options.HTMLAttributes,t),0]},addCommands(){return{setBlockquote:()=>({commands:t})=>t.wrapIn(this.name),toggleBlockquote:()=>({commands:t})=>t.toggleWrap(this.name),unsetBlockquote:()=>({commands:t})=>t.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[lu({find:n6,type:this.type})]}}),i6=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,o6=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,s6=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,a6=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,l6=_o.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:t=>t.style.fontWeight!=="normal"&&null},{style:"font-weight=400",clearMark:t=>t.type.name===this.name},{style:"font-weight",getAttrs:t=>/^(bold(er)?|[5-9]\d{2,})$/.test(t)&&null}]},renderHTML({HTMLAttributes:t}){return["strong",Kt(this.options.HTMLAttributes,t),0]},addCommands(){return{setBold:()=>({commands:t})=>t.setMark(this.name),toggleBold:()=>({commands:t})=>t.toggleMark(this.name),unsetBold:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[ml({find:i6,type:this.type}),ml({find:s6,type:this.type})]},addPasteRules(){return[gl({find:o6,type:this.type}),gl({find:a6,type:this.type})]}}),c6="listItem",X1="textStyle",Z1=/^\s*([-+*])\s$/,u6=gr.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:t}){return["ul",Kt(this.options.HTMLAttributes,t),0]},addCommands(){return{toggleBulletList:()=>({commands:t,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(c6,this.editor.getAttributes(X1)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let t=lu({find:Z1,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(t=lu({find:Z1,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(X1),editor:this.editor})),[t]}}),d6=/(^|[^`])`([^`]+)`(?!`)/,f6=/(^|[^`])`([^`]+)`(?!`)/g,h6=_o.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:t}){return["code",Kt(this.options.HTMLAttributes,t),0]},addCommands(){return{setCode:()=>({commands:t})=>t.setMark(this.name),toggleCode:()=>({commands:t})=>t.toggleMark(this.name),unsetCode:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[ml({find:d6,type:this.type})]},addPasteRules(){return[gl({find:f6,type:this.type})]}}),p6=/^```([a-z]+)?[\s\n]$/,m6=/^~~~([a-z]+)?[\s\n]$/,g6=gr.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:this.options.defaultLanguage,parseHTML:t=>{var e;const{languageClassPrefix:n}=this.options,o=[...((e=t.firstElementChild)===null||e===void 0?void 0:e.classList)||[]].filter(s=>s.startsWith(n)).map(s=>s.replace(n,""))[0];return o||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:t,HTMLAttributes:e}){return["pre",Kt(this.options.HTMLAttributes,e),["code",{class:t.attrs.language?this.options.languageClassPrefix+t.attrs.language:null},0]]},addCommands(){return{setCodeBlock:t=>({commands:e})=>e.setNode(this.name,t),toggleCodeBlock:t=>({commands:e})=>e.toggleNode(this.name,"paragraph",t)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:t,$anchor:e}=this.editor.state.selection,n=e.pos===1;return!t||e.parent.type.name!==this.name?!1:n||!e.parent.textContent.length?this.editor.commands.clearNodes():!1},Enter:({editor:t})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:e}=t,{selection:n}=e,{$from:r,empty:i}=n;if(!i||r.parent.type!==this.type)return!1;const o=r.parentOffset===r.parent.nodeSize-2,s=r.parent.textContent.endsWith(`

`);return!o||!s?!1:t.chain().command(({tr:a})=>(a.delete(r.pos-2,r.pos),!0)).exitCode().run()},ArrowDown:({editor:t})=>{if(!this.options.exitOnArrowDown)return!1;const{state:e}=t,{selection:n,doc:r}=e,{$from:i,empty:o}=n;if(!o||i.parent.type!==this.type||!(i.parentOffset===i.parent.nodeSize-2))return!1;const a=i.after();return a===void 0?!1:r.nodeAt(a)?t.commands.command(({tr:c})=>(c.setSelection(oe.near(r.resolve(a))),!0)):t.commands.exitCode()}}},addInputRules(){return[zy({find:p6,type:this.type,getAttributes:t=>({language:t[1]})}),zy({find:m6,type:this.type,getAttributes:t=>({language:t[1]})})]},addProseMirrorPlugins(){return[new xt({key:new Rn("codeBlockVSCodeHandler"),props:{handlePaste:(t,e)=>{if(!e.clipboardData||this.editor.isActive(this.type.name))return!1;const n=e.clipboardData.getData("text/plain"),r=e.clipboardData.getData("vscode-editor-data"),i=r?JSON.parse(r):void 0,o=i==null?void 0:i.mode;if(!n||!o)return!1;const{tr:s,schema:a}=t.state,l=a.text(n.replace(/\r\n?/g,`
`));return s.replaceSelectionWith(this.type.create({language:o},l)),s.selection.$from.parent.type!==this.type&&s.setSelection(ie.near(s.doc.resolve(Math.max(0,s.selection.from-2)))),s.setMeta("paste",!0),t.dispatch(s),!0}}})]}}),y6=gr.create({name:"doc",topNode:!0,content:"block+"});function v6(t={}){return new xt({view(e){return new x6(e,t)}})}class x6{constructor(e,n){var r;this.editorView=e,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=(r=n.width)!==null&&r!==void 0?r:1,this.color=n.color===!1?void 0:n.color||"black",this.class=n.class,this.handlers=["dragover","dragend","drop","dragleave"].map(i=>{let o=s=>{this[i](s)};return e.dom.addEventListener(i,o),{name:i,handler:o}})}destroy(){this.handlers.forEach(({name:e,handler:n})=>this.editorView.dom.removeEventListener(e,n))}update(e,n){this.cursorPos!=null&&n.doc!=e.state.doc&&(this.cursorPos>e.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(e){e!=this.cursorPos&&(this.cursorPos=e,e==null?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let e=this.editorView.state.doc.resolve(this.cursorPos),n=!e.parent.inlineContent,r;if(n){let a=e.nodeBefore,l=e.nodeAfter;if(a||l){let c=this.editorView.nodeDOM(this.cursorPos-(a?a.nodeSize:0));if(c){let u=c.getBoundingClientRect(),d=a?u.bottom:u.top;a&&l&&(d=(d+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2),r={left:u.left,right:u.right,top:d-this.width/2,bottom:d+this.width/2}}}}if(!r){let a=this.editorView.coordsAtPos(this.cursorPos);r={left:a.left-this.width/2,right:a.left+this.width/2,top:a.top,bottom:a.bottom}}let i=this.editorView.dom.offsetParent;this.element||(this.element=i.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",n),this.element.classList.toggle("prosemirror-dropcursor-inline",!n);let o,s;if(!i||i==document.body&&getComputedStyle(i).position=="static")o=-pageXOffset,s=-pageYOffset;else{let a=i.getBoundingClientRect();o=a.left-i.scrollLeft,s=a.top-i.scrollTop}this.element.style.left=r.left-o+"px",this.element.style.top=r.top-s+"px",this.element.style.width=r.right-r.left+"px",this.element.style.height=r.bottom-r.top+"px"}scheduleRemoval(e){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),e)}dragover(e){if(!this.editorView.editable)return;let n=this.editorView.posAtCoords({left:e.clientX,top:e.clientY}),r=n&&n.inside>=0&&this.editorView.state.doc.nodeAt(n.inside),i=r&&r.type.spec.disableDropCursor,o=typeof i=="function"?i(this.editorView,n,e):i;if(n&&!o){let s=n.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let a=NT(this.editorView.state.doc,s,this.editorView.dragging.slice);a!=null&&(s=a)}this.setCursor(s),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(e){(e.target==this.editorView.dom||!this.editorView.dom.contains(e.relatedTarget))&&this.setCursor(null)}}const w6=dt.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[v6(this.options)]}});class We extends oe{constructor(e){super(e,e)}map(e,n){let r=e.resolve(n.map(this.head));return We.valid(r)?new We(r):oe.near(r)}content(){return W.empty}eq(e){return e instanceof We&&e.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(e,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for GapCursor.fromJSON");return new We(e.resolve(n.pos))}getBookmark(){return new lx(this.anchor)}static valid(e){let n=e.parent;if(n.isTextblock||!b6(e)||!S6(e))return!1;let r=n.type.spec.allowGapCursor;if(r!=null)return r;let i=n.contentMatchAt(e.index()).defaultType;return i&&i.isTextblock}static findGapCursorFrom(e,n,r=!1){e:for(;;){if(!r&&We.valid(e))return e;let i=e.pos,o=null;for(let s=e.depth;;s--){let a=e.node(s);if(n>0?e.indexAfter(s)<a.childCount:e.index(s)>0){o=a.child(n>0?e.indexAfter(s):e.index(s)-1);break}else if(s==0)return null;i+=n;let l=e.doc.resolve(i);if(We.valid(l))return l}for(;;){let s=n>0?o.firstChild:o.lastChild;if(!s){if(o.isAtom&&!o.isText&&!te.isSelectable(o)){e=e.doc.resolve(i+o.nodeSize*n),r=!1;continue e}break}o=s,i+=n;let a=e.doc.resolve(i);if(We.valid(a))return a}return null}}}We.prototype.visible=!1;We.findFrom=We.findGapCursorFrom;oe.jsonID("gapcursor",We);class lx{constructor(e){this.pos=e}map(e){return new lx(e.map(this.pos))}resolve(e){let n=e.resolve(this.pos);return We.valid(n)?new We(n):oe.near(n)}}function b6(t){for(let e=t.depth;e>=0;e--){let n=t.index(e),r=t.node(e);if(n==0){if(r.type.spec.isolating)return!0;continue}for(let i=r.child(n-1);;i=i.lastChild){if(i.childCount==0&&!i.inlineContent||i.isAtom||i.type.spec.isolating)return!0;if(i.inlineContent)return!1}}return!0}function S6(t){for(let e=t.depth;e>=0;e--){let n=t.indexAfter(e),r=t.node(e);if(n==r.childCount){if(r.type.spec.isolating)return!0;continue}for(let i=r.child(n);;i=i.firstChild){if(i.childCount==0&&!i.inlineContent||i.isAtom||i.type.spec.isolating)return!0;if(i.inlineContent)return!1}}return!0}function C6(){return new xt({props:{decorations:_6,createSelectionBetween(t,e,n){return e.pos==n.pos&&We.valid(n)?new We(n):null},handleClick:E6,handleKeyDown:k6,handleDOMEvents:{beforeinput:T6}}})}const k6=w_({ArrowLeft:jd("horiz",-1),ArrowRight:jd("horiz",1),ArrowUp:jd("vert",-1),ArrowDown:jd("vert",1)});function jd(t,e){const n=t=="vert"?e>0?"down":"up":e>0?"right":"left";return function(r,i,o){let s=r.selection,a=e>0?s.$to:s.$from,l=s.empty;if(s instanceof ie){if(!o.endOfTextblock(n)||a.depth==0)return!1;l=!1,a=r.doc.resolve(e>0?a.after():a.before())}let c=We.findGapCursorFrom(a,e,l);return c?(i&&i(r.tr.setSelection(new We(c))),!0):!1}}function E6(t,e,n){if(!t||!t.editable)return!1;let r=t.state.doc.resolve(e);if(!We.valid(r))return!1;let i=t.posAtCoords({left:n.clientX,top:n.clientY});return i&&i.inside>-1&&te.isSelectable(t.state.doc.nodeAt(i.inside))?!1:(t.dispatch(t.state.tr.setSelection(new We(r))),!0)}function T6(t,e){if(e.inputType!="insertCompositionText"||!(t.state.selection instanceof We))return!1;let{$from:n}=t.state.selection,r=n.parent.contentMatchAt(n.index()).findWrapping(t.state.schema.nodes.text);if(!r)return!1;let i=B.empty;for(let s=r.length-1;s>=0;s--)i=B.from(r[s].createAndFill(null,i));let o=t.state.tr.replace(n.pos,n.pos,new W(i,0,0));return o.setSelection(ie.near(o.doc.resolve(n.pos+1))),t.dispatch(o),!1}function _6(t){if(!(t.selection instanceof We))return null;let e=document.createElement("div");return e.className="ProseMirror-gapcursor",qe.create(t.doc,[an.widget(t.selection.head,e,{key:"gapcursor"})])}const R6=dt.create({name:"gapCursor",addProseMirrorPlugins(){return[C6()]},extendNodeSchema(t){var e;const n={name:t.name,options:t.options,storage:t.storage};return{allowGapCursor:(e=ce(Y(t,"allowGapCursor",n)))!==null&&e!==void 0?e:null}}}),O6=gr.create({name:"hardBreak",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:t}){return["br",Kt(this.options.HTMLAttributes,t)]},renderText(){return`
`},addCommands(){return{setHardBreak:()=>({commands:t,chain:e,state:n,editor:r})=>t.first([()=>t.exitCode(),()=>t.command(()=>{const{selection:i,storedMarks:o}=n;if(i.$from.parent.type.spec.isolating)return!1;const{keepMarks:s}=this.options,{splittableMarks:a}=r.extensionManager,l=o||i.$to.parentOffset&&i.$from.marks();return e().insertContent({type:this.name}).command(({tr:c,dispatch:u})=>{if(u&&l&&s){const d=l.filter(h=>a.includes(h.type.name));c.ensureMarks(d)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),P6=gr.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(t=>({tag:`h${t}`,attrs:{level:t}}))},renderHTML({node:t,HTMLAttributes:e}){return[`h${this.options.levels.includes(t.attrs.level)?t.attrs.level:this.options.levels[0]}`,Kt(this.options.HTMLAttributes,e),0]},addCommands(){return{setHeading:t=>({commands:e})=>this.options.levels.includes(t.level)?e.setNode(this.name,t):!1,toggleHeading:t=>({commands:e})=>this.options.levels.includes(t.level)?e.toggleNode(this.name,"paragraph",t):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((t,e)=>({...t,[`Mod-Alt-${e}`]:()=>this.editor.commands.toggleHeading({level:e})}),{})},addInputRules(){return this.options.levels.map(t=>zy({find:new RegExp(`^(#{${Math.min(...this.options.levels)},${t}})\\s$`),type:this.type,getAttributes:{level:t}}))}});var ah=200,ct=function(){};ct.prototype.append=function(e){return e.length?(e=ct.from(e),!this.length&&e||e.length<ah&&this.leafAppend(e)||this.length<ah&&e.leafPrepend(this)||this.appendInner(e)):this};ct.prototype.prepend=function(e){return e.length?ct.from(e).append(this):this};ct.prototype.appendInner=function(e){return new M6(this,e)};ct.prototype.slice=function(e,n){return e===void 0&&(e=0),n===void 0&&(n=this.length),e>=n?ct.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,n))};ct.prototype.get=function(e){if(!(e<0||e>=this.length))return this.getInner(e)};ct.prototype.forEach=function(e,n,r){n===void 0&&(n=0),r===void 0&&(r=this.length),n<=r?this.forEachInner(e,n,r,0):this.forEachInvertedInner(e,n,r,0)};ct.prototype.map=function(e,n,r){n===void 0&&(n=0),r===void 0&&(r=this.length);var i=[];return this.forEach(function(o,s){return i.push(e(o,s))},n,r),i};ct.from=function(e){return e instanceof ct?e:e&&e.length?new sR(e):ct.empty};var sR=function(t){function e(r){t.call(this),this.values=r}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={length:{configurable:!0},depth:{configurable:!0}};return e.prototype.flatten=function(){return this.values},e.prototype.sliceInner=function(i,o){return i==0&&o==this.length?this:new e(this.values.slice(i,o))},e.prototype.getInner=function(i){return this.values[i]},e.prototype.forEachInner=function(i,o,s,a){for(var l=o;l<s;l++)if(i(this.values[l],a+l)===!1)return!1},e.prototype.forEachInvertedInner=function(i,o,s,a){for(var l=o-1;l>=s;l--)if(i(this.values[l],a+l)===!1)return!1},e.prototype.leafAppend=function(i){if(this.length+i.length<=ah)return new e(this.values.concat(i.flatten()))},e.prototype.leafPrepend=function(i){if(this.length+i.length<=ah)return new e(i.flatten().concat(this.values))},n.length.get=function(){return this.values.length},n.depth.get=function(){return 0},Object.defineProperties(e.prototype,n),e}(ct);ct.empty=new sR([]);var M6=function(t){function e(n,r){t.call(this),this.left=n,this.right=r,this.length=n.length+r.length,this.depth=Math.max(n.depth,r.depth)+1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},e.prototype.getInner=function(r){return r<this.left.length?this.left.get(r):this.right.get(r-this.left.length)},e.prototype.forEachInner=function(r,i,o,s){var a=this.left.length;if(i<a&&this.left.forEachInner(r,i,Math.min(o,a),s)===!1||o>a&&this.right.forEachInner(r,Math.max(i-a,0),Math.min(this.length,o)-a,s+a)===!1)return!1},e.prototype.forEachInvertedInner=function(r,i,o,s){var a=this.left.length;if(i>a&&this.right.forEachInvertedInner(r,i-a,Math.max(o,a)-a,s+a)===!1||o<a&&this.left.forEachInvertedInner(r,Math.min(i,a),o,s)===!1)return!1},e.prototype.sliceInner=function(r,i){if(r==0&&i==this.length)return this;var o=this.left.length;return i<=o?this.left.slice(r,i):r>=o?this.right.slice(r-o,i-o):this.left.slice(r,o).append(this.right.slice(0,i-o))},e.prototype.leafAppend=function(r){var i=this.right.leafAppend(r);if(i)return new e(this.left,i)},e.prototype.leafPrepend=function(r){var i=this.left.leafPrepend(r);if(i)return new e(i,this.right)},e.prototype.appendInner=function(r){return this.left.depth>=Math.max(this.right.depth,r.depth)+1?new e(this.left,new e(this.right,r)):new e(this,r)},e}(ct);const I6=500;let du=class ha{constructor(e,n){this.items=e,this.eventCount=n}popEvent(e,n){if(this.eventCount==0)return null;let r=this.items.length;for(;;r--)if(this.items.get(r-1).selection){--r;break}let i,o;n&&(i=this.remapping(r,this.items.length),o=i.maps.length);let s=e.tr,a,l,c=[],u=[];return this.items.forEach((d,h)=>{if(!d.step){i||(i=this.remapping(r,h+1),o=i.maps.length),o--,u.push(d);return}if(i){u.push(new bi(d.map));let p=d.step.map(i.slice(o)),m;p&&s.maybeStep(p).doc&&(m=s.mapping.maps[s.mapping.maps.length-1],c.push(new bi(m,void 0,void 0,c.length+u.length))),o--,m&&i.appendMap(m,o)}else s.maybeStep(d.step);if(d.selection)return a=i?d.selection.map(i.slice(o)):d.selection,l=new ha(this.items.slice(0,r).append(u.reverse().concat(c)),this.eventCount-1),!1},this.items.length,0),{remaining:l,transform:s,selection:a}}addTransform(e,n,r,i){let o=[],s=this.eventCount,a=this.items,l=!i&&a.length?a.get(a.length-1):null;for(let u=0;u<e.steps.length;u++){let d=e.steps[u].invert(e.docs[u]),h=new bi(e.mapping.maps[u],d,n),p;(p=l&&l.merge(h))&&(h=p,u?o.pop():a=a.slice(0,a.length-1)),o.push(h),n&&(s++,n=void 0),i||(l=h)}let c=s-r.depth;return c>N6&&(a=A6(a,c),s-=c),new ha(a.append(o),s)}remapping(e,n){let r=new nu;return this.items.forEach((i,o)=>{let s=i.mirrorOffset!=null&&o-i.mirrorOffset>=e?r.maps.length-i.mirrorOffset:void 0;r.appendMap(i.map,s)},e,n),r}addMaps(e){return this.eventCount==0?this:new ha(this.items.append(e.map(n=>new bi(n))),this.eventCount)}rebased(e,n){if(!this.eventCount)return this;let r=[],i=Math.max(0,this.items.length-n),o=e.mapping,s=e.steps.length,a=this.eventCount;this.items.forEach(h=>{h.selection&&a--},i);let l=n;this.items.forEach(h=>{let p=o.getMirror(--l);if(p==null)return;s=Math.min(s,p);let m=o.maps[p];if(h.step){let y=e.steps[p].invert(e.docs[p]),v=h.selection&&h.selection.map(o.slice(l+1,p));v&&a++,r.push(new bi(m,y,v))}else r.push(new bi(m))},i);let c=[];for(let h=n;h<s;h++)c.push(new bi(o.maps[h]));let u=this.items.slice(0,i).append(c).append(r),d=new ha(u,a);return d.emptyItemCount()>I6&&(d=d.compress(this.items.length-r.length)),d}emptyItemCount(){let e=0;return this.items.forEach(n=>{n.step||e++}),e}compress(e=this.items.length){let n=this.remapping(0,e),r=n.maps.length,i=[],o=0;return this.items.forEach((s,a)=>{if(a>=e)i.push(s),s.selection&&o++;else if(s.step){let l=s.step.map(n.slice(r)),c=l&&l.getMap();if(r--,c&&n.appendMap(c,r),l){let u=s.selection&&s.selection.map(n.slice(r));u&&o++;let d=new bi(c.invert(),l,u),h,p=i.length-1;(h=i.length&&i[p].merge(d))?i[p]=h:i.push(d)}}else s.map&&r--},this.items.length,0),new ha(ct.from(i.reverse()),o)}};du.empty=new du(ct.empty,0);function A6(t,e){let n;return t.forEach((r,i)=>{if(r.selection&&e--==0)return n=i,!1}),t.slice(n)}let bi=class aR{constructor(e,n,r,i){this.map=e,this.step=n,this.selection=r,this.mirrorOffset=i}merge(e){if(this.step&&e.step&&!e.selection){let n=e.step.merge(this.step);if(n)return new aR(n.getMap().invert(),n,this.selection)}}};class Ai{constructor(e,n,r,i,o){this.done=e,this.undone=n,this.prevRanges=r,this.prevTime=i,this.prevComposition=o}}const N6=20;function D6(t,e,n,r){let i=n.getMeta(Ss),o;if(i)return i.historyState;n.getMeta($6)&&(t=new Ai(t.done,t.undone,null,0,-1));let s=n.getMeta("appendedTransaction");if(n.steps.length==0)return t;if(s&&s.getMeta(Ss))return s.getMeta(Ss).redo?new Ai(t.done.addTransform(n,void 0,r,hf(e)),t.undone,eS(n.mapping.maps),t.prevTime,t.prevComposition):new Ai(t.done,t.undone.addTransform(n,void 0,r,hf(e)),null,t.prevTime,t.prevComposition);if(n.getMeta("addToHistory")!==!1&&!(s&&s.getMeta("addToHistory")===!1)){let a=n.getMeta("composition"),l=t.prevTime==0||!s&&t.prevComposition!=a&&(t.prevTime<(n.time||0)-r.newGroupDelay||!j6(n,t.prevRanges)),c=s?Fm(t.prevRanges,n.mapping):eS(n.mapping.maps);return new Ai(t.done.addTransform(n,l?e.selection.getBookmark():void 0,r,hf(e)),du.empty,c,n.time,a??t.prevComposition)}else return(o=n.getMeta("rebased"))?new Ai(t.done.rebased(n,o),t.undone.rebased(n,o),Fm(t.prevRanges,n.mapping),t.prevTime,t.prevComposition):new Ai(t.done.addMaps(n.mapping.maps),t.undone.addMaps(n.mapping.maps),Fm(t.prevRanges,n.mapping),t.prevTime,t.prevComposition)}function j6(t,e){if(!e)return!1;if(!t.docChanged)return!0;let n=!1;return t.mapping.maps[0].forEach((r,i)=>{for(let o=0;o<e.length;o+=2)r<=e[o+1]&&i>=e[o]&&(n=!0)}),n}function eS(t){let e=[];for(let n=t.length-1;n>=0&&e.length==0;n--)t[n].forEach((r,i,o,s)=>e.push(o,s));return e}function Fm(t,e){if(!t)return null;let n=[];for(let r=0;r<t.length;r+=2){let i=e.map(t[r],1),o=e.map(t[r+1],-1);i<=o&&n.push(i,o)}return n}function L6(t,e,n){let r=hf(e),i=Ss.get(e).spec.config,o=(n?t.undone:t.done).popEvent(e,r);if(!o)return null;let s=o.selection.resolve(o.transform.doc),a=(n?t.done:t.undone).addTransform(o.transform,e.selection.getBookmark(),i,r),l=new Ai(n?a:o.remaining,n?o.remaining:a,null,0,-1);return o.transform.setSelection(s).setMeta(Ss,{redo:n,historyState:l})}let Bm=!1,tS=null;function hf(t){let e=t.plugins;if(tS!=e){Bm=!1,tS=e;for(let n=0;n<e.length;n++)if(e[n].spec.historyPreserveItems){Bm=!0;break}}return Bm}const Ss=new Rn("history"),$6=new Rn("closeHistory");function F6(t={}){return t={depth:t.depth||100,newGroupDelay:t.newGroupDelay||500},new xt({key:Ss,state:{init(){return new Ai(du.empty,du.empty,null,0,-1)},apply(e,n,r){return D6(n,r,e,t)}},config:t,props:{handleDOMEvents:{beforeinput(e,n){let r=n.inputType,i=r=="historyUndo"?cR:r=="historyRedo"?uR:null;return i?(n.preventDefault(),i(e.state,e.dispatch)):!1}}}})}function lR(t,e){return(n,r)=>{let i=Ss.getState(n);if(!i||(t?i.undone:i.done).eventCount==0)return!1;if(r){let o=L6(i,n,t);o&&r(e?o.scrollIntoView():o)}return!0}}const cR=lR(!1,!0),uR=lR(!0,!0),B6=dt.create({name:"history",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:t,dispatch:e})=>cR(t,e),redo:()=>({state:t,dispatch:e})=>uR(t,e)}},addProseMirrorPlugins(){return[F6(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-я":()=>this.editor.commands.undo(),"Shift-Mod-я":()=>this.editor.commands.redo()}}}),z6=gr.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{}}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:t}){return["hr",Kt(this.options.HTMLAttributes,t)]},addCommands(){return{setHorizontalRule:()=>({chain:t,state:e})=>{const{selection:n}=e,{$from:r,$to:i}=n,o=t();return r.parentOffset===0?o.insertContentAt({from:Math.max(r.pos-1,0),to:i.pos},{type:this.name}):L_(n)?o.insertContentAt(i.pos,{type:this.name}):o.insertContent({type:this.name}),o.command(({tr:s,dispatch:a})=>{var l;if(a){const{$to:c}=s.selection,u=c.end();if(c.nodeAfter)c.nodeAfter.isTextblock?s.setSelection(ie.create(s.doc,c.pos+1)):c.nodeAfter.isBlock?s.setSelection(te.create(s.doc,c.pos)):s.setSelection(ie.create(s.doc,c.pos));else{const d=(l=c.parent.type.contentMatch.defaultType)===null||l===void 0?void 0:l.create();d&&(s.insert(u,d),s.setSelection(ie.create(s.doc,u+1)))}s.scrollIntoView()}return!0}).run()}}},addInputRules(){return[nB({find:/^(?:---|—-|___\s|\*\*\*\s)$/,type:this.type})]}}),V6=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,U6=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,H6=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,W6=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,K6=_o.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:t=>t.style.fontStyle!=="normal"&&null},{style:"font-style=normal",clearMark:t=>t.type.name===this.name},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:t}){return["em",Kt(this.options.HTMLAttributes,t),0]},addCommands(){return{setItalic:()=>({commands:t})=>t.setMark(this.name),toggleItalic:()=>({commands:t})=>t.toggleMark(this.name),unsetItalic:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[ml({find:V6,type:this.type}),ml({find:H6,type:this.type})]},addPasteRules(){return[gl({find:U6,type:this.type}),gl({find:W6,type:this.type})]}}),q6=gr.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:t}){return["li",Kt(this.options.HTMLAttributes,t),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),G6="listItem",nS="textStyle",rS=/^(\d+)\.\s$/,J6=gr.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:t=>t.hasAttribute("start")?parseInt(t.getAttribute("start")||"",10):1},type:{default:void 0,parseHTML:t=>t.getAttribute("type")}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:t}){const{start:e,...n}=t;return e===1?["ol",Kt(this.options.HTMLAttributes,n),0]:["ol",Kt(this.options.HTMLAttributes,t),0]},addCommands(){return{toggleOrderedList:()=>({commands:t,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(G6,this.editor.getAttributes(nS)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let t=lu({find:rS,type:this.type,getAttributes:e=>({start:+e[1]}),joinPredicate:(e,n)=>n.childCount+n.attrs.start===+e[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(t=lu({find:rS,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:e=>({start:+e[1],...this.editor.getAttributes(nS)}),joinPredicate:(e,n)=>n.childCount+n.attrs.start===+e[1],editor:this.editor})),[t]}}),Y6=gr.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:t}){return["p",Kt(this.options.HTMLAttributes,t),0]},addCommands(){return{setParagraph:()=>({commands:t})=>t.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),Q6=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,X6=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,Z6=_o.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:t=>t.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:t}){return["s",Kt(this.options.HTMLAttributes,t),0]},addCommands(){return{setStrike:()=>({commands:t})=>t.setMark(this.name),toggleStrike:()=>({commands:t})=>t.toggleMark(this.name),unsetStrike:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[ml({find:Q6,type:this.type})]},addPasteRules(){return[gl({find:X6,type:this.type})]}}),ez=gr.create({name:"text",group:"inline"}),tz=dt.create({name:"starterKit",addExtensions(){var t,e,n,r,i,o,s,a,l,c,u,d,h,p,m,y,v,x;const w=[];return this.options.bold!==!1&&w.push(l6.configure((t=this.options)===null||t===void 0?void 0:t.bold)),this.options.blockquote!==!1&&w.push(r6.configure((e=this.options)===null||e===void 0?void 0:e.blockquote)),this.options.bulletList!==!1&&w.push(u6.configure((n=this.options)===null||n===void 0?void 0:n.bulletList)),this.options.code!==!1&&w.push(h6.configure((r=this.options)===null||r===void 0?void 0:r.code)),this.options.codeBlock!==!1&&w.push(g6.configure((i=this.options)===null||i===void 0?void 0:i.codeBlock)),this.options.document!==!1&&w.push(y6.configure((o=this.options)===null||o===void 0?void 0:o.document)),this.options.dropcursor!==!1&&w.push(w6.configure((s=this.options)===null||s===void 0?void 0:s.dropcursor)),this.options.gapcursor!==!1&&w.push(R6.configure((a=this.options)===null||a===void 0?void 0:a.gapcursor)),this.options.hardBreak!==!1&&w.push(O6.configure((l=this.options)===null||l===void 0?void 0:l.hardBreak)),this.options.heading!==!1&&w.push(P6.configure((c=this.options)===null||c===void 0?void 0:c.heading)),this.options.history!==!1&&w.push(B6.configure((u=this.options)===null||u===void 0?void 0:u.history)),this.options.horizontalRule!==!1&&w.push(z6.configure((d=this.options)===null||d===void 0?void 0:d.horizontalRule)),this.options.italic!==!1&&w.push(K6.configure((h=this.options)===null||h===void 0?void 0:h.italic)),this.options.listItem!==!1&&w.push(q6.configure((p=this.options)===null||p===void 0?void 0:p.listItem)),this.options.orderedList!==!1&&w.push(J6.configure((m=this.options)===null||m===void 0?void 0:m.orderedList)),this.options.paragraph!==!1&&w.push(Y6.configure((y=this.options)===null||y===void 0?void 0:y.paragraph)),this.options.strike!==!1&&w.push(Z6.configure((v=this.options)===null||v===void 0?void 0:v.strike)),this.options.text!==!1&&w.push(ez.configure((x=this.options)===null||x===void 0?void 0:x.text)),w}}),nz=dt.create({name:"placeholder",addOptions(){return{emptyEditorClass:"is-editor-empty",emptyNodeClass:"is-empty",placeholder:"Write something …",showOnlyWhenEditable:!0,showOnlyCurrent:!0,includeChildren:!1}},addProseMirrorPlugins(){return[new xt({key:new Rn("placeholder"),props:{decorations:({doc:t,selection:e})=>{const n=this.editor.isEditable||!this.options.showOnlyWhenEditable,{anchor:r}=e,i=[];if(!n)return null;const o=this.editor.isEmpty;return t.descendants((s,a)=>{const l=r>=a&&r<=a+s.nodeSize,c=!s.isLeaf&&ap(s);if((l||!this.options.showOnlyCurrent)&&c){const u=[this.options.emptyNodeClass];o&&u.push(this.options.emptyEditorClass);const d=an.node(a,a+s.nodeSize,{class:u.join(" "),"data-placeholder":typeof this.options.placeholder=="function"?this.options.placeholder({editor:this.editor,node:s,pos:a,hasAnchor:l}):this.options.placeholder});i.push(d)}return this.options.includeChildren}),qe.create(t,i)}}})]}});function dR(t,e){if(typeof t!="function"){const[n,r]=g.useState(t);return g.useEffect(()=>{const i=setTimeout(()=>{r(t)},e);return()=>{clearTimeout(i)}},[t,e]),n}return g.useCallback((...n)=>{const r=t,i=setTimeout(()=>{r(...n)},e);return()=>{clearTimeout(i)}},[t,e])}function rz(t){var e;const{char:n,allowSpaces:r,allowToIncludeChar:i,allowedPrefixes:o,startOfLine:s,$position:a}=t,l=r&&!i,c=rB(n),u=new RegExp(`\\s${c}$`),d=s?"^":"",h=i?"":c,p=l?new RegExp(`${d}${c}.*?(?=\\s${h}|$)`,"gm"):new RegExp(`${d}(?:^)?${c}[^\\s${h}]*`,"gm"),m=((e=a.nodeBefore)===null||e===void 0?void 0:e.isText)&&a.nodeBefore.text;if(!m)return null;const y=a.pos-m.length,v=Array.from(m.matchAll(p)).pop();if(!v||v.input===void 0||v.index===void 0)return null;const x=v.input.slice(Math.max(0,v.index-1),v.index),w=new RegExp(`^[${o==null?void 0:o.join("")}\0]?$`).test(x);if(o!==null&&!w)return null;const b=y+v.index;let S=b+v[0].length;return l&&u.test(m.slice(S-1,S+1))&&(v[0]+=" ",S+=1),b<a.pos&&S>=a.pos?{range:{from:b,to:S},query:v[0].slice(n.length),text:v[0]}:null}const iz=new Rn("suggestion");function oz({pluginKey:t=iz,editor:e,char:n="@",allowSpaces:r=!1,allowToIncludeChar:i=!1,allowedPrefixes:o=[" "],startOfLine:s=!1,decorationTag:a="span",decorationClass:l="suggestion",command:c=()=>null,items:u=()=>[],render:d=()=>({}),allow:h=()=>!0,findSuggestionMatch:p=rz}){let m;const y=d==null?void 0:d(),v=new xt({key:t,view(){return{update:async(x,w)=>{var b,S,C,k,E,T,O;const _=(b=this.key)===null||b===void 0?void 0:b.getState(w),D=(S=this.key)===null||S===void 0?void 0:S.getState(x.state),L=_.active&&D.active&&_.range.from!==D.range.from,N=!_.active&&D.active,P=_.active&&!D.active,V=!N&&!P&&_.query!==D.query,I=N||L&&V,F=V||L,M=P||L&&V;if(!I&&!F&&!M)return;const A=M&&!I?_:D,$=x.dom.querySelector(`[data-decoration-id="${A.decorationId}"]`);m={editor:e,range:A.range,query:A.query,text:A.text,items:[],command:G=>c({editor:e,range:A.range,props:G}),decorationNode:$,clientRect:$?()=>{var G;const{decorationId:ee}=(G=this.key)===null||G===void 0?void 0:G.getState(e.state),q=x.dom.querySelector(`[data-decoration-id="${ee}"]`);return(q==null?void 0:q.getBoundingClientRect())||null}:null},I&&((C=y==null?void 0:y.onBeforeStart)===null||C===void 0||C.call(y,m)),F&&((k=y==null?void 0:y.onBeforeUpdate)===null||k===void 0||k.call(y,m)),(F||I)&&(m.items=await u({editor:e,query:A.query})),M&&((E=y==null?void 0:y.onExit)===null||E===void 0||E.call(y,m)),F&&((T=y==null?void 0:y.onUpdate)===null||T===void 0||T.call(y,m)),I&&((O=y==null?void 0:y.onStart)===null||O===void 0||O.call(y,m))},destroy:()=>{var x;m&&((x=y==null?void 0:y.onExit)===null||x===void 0||x.call(y,m))}}},state:{init(){return{active:!1,range:{from:0,to:0},query:null,text:null,composing:!1}},apply(x,w,b,S){const{isEditable:C}=e,{composing:k}=e.view,{selection:E}=x,{empty:T,from:O}=E,_={...w};if(_.composing=k,C&&(T||e.view.composing)){(O<w.range.from||O>w.range.to)&&!k&&!w.composing&&(_.active=!1);const D=p({char:n,allowSpaces:r,allowToIncludeChar:i,allowedPrefixes:o,startOfLine:s,$position:E.$from}),L=`id_${Math.floor(Math.random()*4294967295)}`;D&&h({editor:e,state:S,range:D.range,isActive:w.active})?(_.active=!0,_.decorationId=w.decorationId?w.decorationId:L,_.range=D.range,_.query=D.query,_.text=D.text):_.active=!1}else _.active=!1;return _.active||(_.decorationId=null,_.range={from:0,to:0},_.query=null,_.text=null),_}},props:{handleKeyDown(x,w){var b;const{active:S,range:C}=v.getState(x.state);return S&&((b=y==null?void 0:y.onKeyDown)===null||b===void 0?void 0:b.call(y,{view:x,event:w,range:C}))||!1},decorations(x){const{active:w,range:b,decorationId:S}=v.getState(x);return w?qe.create(x.doc,[an.inline(b.from,b.to,{nodeName:a,class:l,"data-decoration-id":S})]):null}}});return v}const sz=dt.create({name:"slashCommand",addOptions(){return{snippets:[],suggestion:{char:"/",command:({editor:e,range:n,props:r})=>{r.command({editor:e,range:n})},items:({query:e,editor:n})=>{var o;const r=n.extensionManager.extensions.find(s=>s.name==="slashCommand");return(((o=r==null?void 0:r.options)==null?void 0:o.snippets)||[]).filter(s=>s.command.toLowerCase().includes(e.toLowerCase())).map(s=>({title:s.command,previewText:s.text,command:({editor:a,range:l})=>{a.chain().focus().deleteRange(l).insertContent(s.text).run()}}))},render:()=>{let e,n=0,r;return{onStart:i=>{var s;r=i,e=document.createElement("div"),e.style.cssText=`
            position: absolute;
            z-index: 100;
            background: white;
            border: 1px solid #e5e7eb;
            border-radius: 6px;
            padding: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            min-width: 300px;
            max-width: 400px;
          `,r.items.forEach((a,l)=>{var h;const c=document.createElement("button");c.style.cssText=`
              display: flex;
              width: 100%;
              align-items: center;
              gap: 8px;
              text-align: left;
              padding: 8px 12px;
              border: none;
              background: none;
              cursor: pointer;
              border-radius: 4px;
              ${l===n?"background-color: #f3f4f6;":""}
            `;const u=document.createElement("div");u.textContent=a.title,u.style.cssText=`
              font-weight: 500;
              color: #1f2937;
              flex-shrink: 0;
            `;const d=document.createElement("div");d.textContent=(h=a.previewText)!=null&&h.length&&a.previewText.length>100?a.previewText.substring(0,100)+"...":a.previewText||"",d.style.cssText=`
              font-size: 14px;
              color: #6b7280;
              white-space: nowrap;
              overflow: hidden;
              text-overflow: ellipsis;
            `,c.appendChild(u),c.appendChild(d),c.addEventListener("click",()=>{r.command(a),e.remove()}),e.appendChild(c)}),document.body.appendChild(e);const o=(s=r.clientRect)==null?void 0:s.call(r);o&&(e.style.top=`${o.top+window.scrollY-e.offsetHeight-10}px`,e.style.left=`${o.left+window.scrollX}px`)},onUpdate:i=>{var s;r=i;const o=(s=r.clientRect)==null?void 0:s.call(r);o&&(e.style.top=`${o.top+window.scrollY-e.offsetHeight-10}px`,e.style.left=`${o.left+window.scrollX}px`)},onKeyDown:({event:i})=>i.key==="ArrowDown"?(n=(n+1)%e.children.length,Array.from(e.children).forEach((o,s)=>{o.style.backgroundColor=s===n?"#f3f4f6":""}),!0):i.key==="ArrowUp"?(n=(n-1+e.children.length)%e.children.length,Array.from(e.children).forEach((o,s)=>{o.style.backgroundColor=s===n?"#f3f4f6":""}),!0):i.key==="Enter"&&e.children.length>0?(r.command(r.items[n]),e.remove(),!0):!1,onExit:()=>{e.remove()}}}}}},addProseMirrorPlugins(){return[oz({editor:this.editor,...this.options.suggestion})]}});function az(t){return/<(.|\n)*?>/g.test(t.trim())}function lz(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function cz(t){return`<p>${lz(t).split(/\r?\n/).join("<br/>")}</p>`}function iS(t){return t.trim()?az(t)?t:cz(t):""}const ra={editor:{flex:1,width:"100%",height:"100%",fontSize:"16px",lineHeight:"1.5",color:"#374151",outline:"none",cursor:"text",display:"flex",flexDirection:"column",position:"relative",overflow:"auto",backgroundColor:"#ffffff","& .ProseMirror":{outline:"none !important",border:"none !important",flex:1,padding:"12px",whiteSpace:"pre-wrap",overflowY:"auto",overflowX:"hidden",minHeight:"100%",height:"100%",display:"flex",flexDirection:"column",position:"relative","& > *:first-child":{marginTop:0},"& > *:last-child":{marginBottom:"auto"},"&::after":{content:'""',position:"absolute",top:0,left:0,right:0,bottom:0,pointerEvents:"none",zIndex:-1},"&.ProseMirror p.is-editor-empty:first-child::before":{content:"attr(dataPlaceholder)",float:"left",color:"#adb5bd",pointerEvents:"none",height:"0"},"& .preserve-whitespace":{whiteSpace:"pre-wrap"},"&:focus":{outline:"none !important",border:"none !important"},"&.ProseMirror-focused":{outline:"none !important",border:"none !important"},"& ul":{listStyleType:"disc",paddingLeft:"1.5em",marginTop:"0.5em",marginBottom:"0.5em"},"& ol":{listStyleType:"decimal",paddingLeft:"1.5em",marginTop:"0.5em",marginBottom:"0.5em"}}},bubbleMenu:{display:"flex",gap:"8px",backgroundColor:"white",padding:"8px",borderRadius:"6px",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)",border:"1px solid #e5e7eb"},menuButton:{padding:"4px 8px",backgroundColor:"transparent",border:"none",borderRadius:"4px",cursor:"pointer",color:"#6b7280","&:hover":{backgroundColor:"#f3f4f6"}},copyButton:{position:"absolute",right:"8px",top:"8px",padding:"4px 8px",backgroundColor:"#f3f4f6",borderRadius:"4px",cursor:"pointer",fontSize:"14px",color:"#6b7280","&:hover":{backgroundColor:"#e5e7eb"}},editorToolbar:{display:"flex",gap:"8px",alignItems:"center",marginBottom:"8px",height:"36px"},toolbarButton:{padding:"4px 8px",backgroundColor:"#f3f4f6",border:"1px solid #e5e7eb",borderRadius:"4px",cursor:"pointer",fontSize:"14px",color:"#6b7280",display:"flex",alignItems:"center",gap:"4px","&:hover":{backgroundColor:"#e5e7eb"},"&:disabled":{opacity:.5,cursor:"not-allowed"}}};function zm({content:t,onChange:e,readOnly:n=!1,placeholder:r="Start typing...",snippets:i=[],onEditorReady:o}){const[s,a]=g.useState(""),l=g.useRef(!1),c=g.useRef(t),u=g.useMemo(()=>iS(t),[t]),d=Q5({extensions:[tz.configure({bulletList:{keepMarks:!0,keepAttributes:!1},orderedList:{keepMarks:!0,keepAttributes:!1}}),nz.configure({placeholder:r}),sz.configure({snippets:i})],editorProps:{attributes:{class:"focus:outline-none w-full h-full prose prose-sm sm:prose lg:prose-lg"},handleClick(p,m,y){return m!==null?!1:(d&&d.commands.focus("end"),!0)}},content:u,onUpdate:({editor:p})=>{l.current||(l.current=!0);const m=p.getHTML();a(m)},editable:!n});g.useEffect(()=>{d&&o&&o(d)},[d,o]),g.useEffect(()=>{if(d&&t!==c.current&&!l.current){const p=iS(t);d.commands.setContent(p),c.current=t}},[t,d]);const h=dR(s,200);if(g.useEffect(()=>{h&&l.current&&e&&(e(h),l.current=!1,c.current=h)},[h,e]),!!d)return f.jsxs("div",{style:{height:"100%",display:"flex",flexDirection:"column",position:"relative"},children:[!n&&f.jsx(Z5,{editor:d,tippyOptions:{duration:100},children:f.jsxs("div",{style:ra.bubbleMenu,children:[f.jsx("button",{onClick:()=>d.chain().focus().toggleBold().run(),className:d.isActive("bold")?"is-active":"",style:ra.menuButton,children:"Bold"}),f.jsx("button",{onClick:()=>d.chain().focus().toggleItalic().run(),className:d.isActive("italic")?"is-active":"",style:ra.menuButton,children:"Italic"}),f.jsx("button",{onClick:()=>d.chain().focus().toggleBulletList().run(),className:d.isActive("bulletList")?"is-active":"",style:ra.menuButton,children:"Bullet List"}),f.jsx("button",{onClick:()=>d.chain().focus().toggleOrderedList().run(),className:d.isActive("orderedList")?"is-active":"",style:ra.menuButton,children:"Numbered List"})]})}),f.jsx(z5,{editor:d,style:{...ra.editor,position:"relative",zIndex:1},onClick:p=>{(p.target===p.currentTarget||p.target.className.includes("ProseMirror"))&&d.commands.focus("end")}})]})}const Bt={container:{padding:"32px 32px 0",width:"100%",height:"100%",backgroundColor:"#fff",overflow:"hidden",display:"flex",flexDirection:"column"},section:{maxWidth:"1200px",margin:"0 auto",width:"100%",height:"100%",display:"flex",flexDirection:"column"},header:{flex:"0 0 auto"},contentContainer:{flex:1,overflow:"auto",minHeight:0},title:{fontSize:"16px",fontWeight:"500",marginBottom:"8px",color:"#1f2937"},tabs:{display:"flex",gap:"24px",marginBottom:"16px",borderBottom:"1px solid #e5e7eb"},tab:{padding:"12px 0",fontSize:"14px",color:"#6b7280",cursor:"pointer",borderBottomWidth:"2px",borderBottomStyle:"solid",borderBottomColor:"transparent",marginBottom:"-1px"},activeTab:{color:"#2563eb",borderBottomColor:"#2563eb"},formGrid:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",columnGap:"24px",rowGap:"8px"},field:{marginBottom:"8px"},label:{display:"block",fontSize:"14px",color:"#4b5563",marginBottom:"8px"},sublabel:{display:"block",fontSize:"14px",color:"#6b7280",marginBottom:"8px"},select:{width:"100%",padding:"8px 12px",fontSize:"14px",border:"1px solid #d1d5db",borderRadius:"6px",color:"#1f2937",backgroundColor:"#fff",cursor:"pointer",appearance:"none",backgroundImage:'url("data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2224%22%20height%3D%2224%22%20viewBox%3D%220%200%2024%2024%22%20fill%3D%22none%22%20stroke%3D%22%236b7280%22%20stroke-width%3D%222%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%3E%3Cpolyline%20points%3D%226%209%2012%2015%2018%209%22%3E%3C%2Fpolyline%3E%3C%2Fsvg%3E")',backgroundRepeat:"no-repeat",backgroundPosition:"right 8px center",backgroundSize:"16px",paddingRight:"32px"},input:{width:"100%",padding:"8px 12px",fontSize:"14px",border:"1px solid #d1d5db",borderRadius:"6px",color:"#1f2937",backgroundColor:"#fff","&:focus":{outline:"none",borderColor:"#2563eb",boxShadow:"0 0 0 2px rgba(37, 99, 235, 0.2)"}},sectionTitle:{fontSize:"16px",fontWeight:"500",marginTop:"8px",color:"#1f2937"}};function gi(t,e){if(t==null)return{};var n={},r=Object.keys(t),i,o;for(o=0;o<r.length;o++)i=r[o],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}var uz=["color"],Ye=g.forwardRef(function(t,e){var n=t.color,r=n===void 0?"currentColor":n,i=gi(t,uz);return g.createElement("svg",Object.assign({width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},i,{ref:e}),g.createElement("path",{d:"M3.13523 6.15803C3.3241 5.95657 3.64052 5.94637 3.84197 6.13523L7.5 9.56464L11.158 6.13523C11.3595 5.94637 11.6759 5.95657 11.8648 6.15803C12.0536 6.35949 12.0434 6.67591 11.842 6.86477L7.84197 10.6148C7.64964 10.7951 7.35036 10.7951 7.15803 10.6148L3.15803 6.86477C2.95657 6.67591 2.94637 6.35949 3.13523 6.15803Z",fill:r,fillRule:"evenodd",clipRule:"evenodd"}))}),dz=["color"],Ni=g.forwardRef(function(t,e){var n=t.color,r=n===void 0?"currentColor":n,i=gi(t,dz);return g.createElement("svg",Object.assign({width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},i,{ref:e}),g.createElement("path",{d:"M3.13523 8.84197C3.3241 9.04343 3.64052 9.05363 3.84197 8.86477L7.5 5.43536L11.158 8.86477C11.3595 9.05363 11.6759 9.04343 11.8648 8.84197C12.0536 8.64051 12.0434 8.32409 11.842 8.13523L7.84197 4.38523C7.64964 4.20492 7.35036 4.20492 7.15803 4.38523L3.15803 8.13523C2.95657 8.32409 2.94637 8.64051 3.13523 8.84197Z",fill:r,fillRule:"evenodd",clipRule:"evenodd"}))}),fz=["color"],fu=g.forwardRef(function(t,e){var n=t.color,r=n===void 0?"currentColor":n,i=gi(t,fz);return g.createElement("svg",Object.assign({width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},i,{ref:e}),g.createElement("path",{d:"M11.7816 4.03157C12.0062 3.80702 12.0062 3.44295 11.7816 3.2184C11.5571 2.99385 11.193 2.99385 10.9685 3.2184L7.50005 6.68682L4.03164 3.2184C3.80708 2.99385 3.44301 2.99385 3.21846 3.2184C2.99391 3.44295 2.99391 3.80702 3.21846 4.03157L6.68688 7.49999L3.21846 10.9684C2.99391 11.193 2.99391 11.557 3.21846 11.7816C3.44301 12.0061 3.80708 12.0061 4.03164 11.7816L7.50005 8.31316L10.9685 11.7816C11.193 12.0061 11.5571 12.0061 11.7816 11.7816C12.0062 11.557 12.0062 11.193 11.7816 10.9684L8.31322 7.49999L11.7816 4.03157Z",fill:r,fillRule:"evenodd",clipRule:"evenodd"}))}),hz=["color"],pz=g.forwardRef(function(t,e){var n=t.color,r=n===void 0?"currentColor":n,i=gi(t,hz);return g.createElement("svg",Object.assign({width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},i,{ref:e}),g.createElement("path",{d:"M8.625 2.5C8.625 3.12132 8.12132 3.625 7.5 3.625C6.87868 3.625 6.375 3.12132 6.375 2.5C6.375 1.87868 6.87868 1.375 7.5 1.375C8.12132 1.375 8.625 1.87868 8.625 2.5ZM8.625 7.5C8.625 8.12132 8.12132 8.625 7.5 8.625C6.87868 8.625 6.375 8.12132 6.375 7.5C6.375 6.87868 6.87868 6.375 7.5 6.375C8.12132 6.375 8.625 6.87868 8.625 7.5ZM7.5 13.625C8.12132 13.625 8.625 13.1213 8.625 12.5C8.625 11.8787 8.12132 11.375 7.5 11.375C6.87868 11.375 6.375 11.8787 6.375 12.5C6.375 13.1213 6.87868 13.625 7.5 13.625Z",fill:r,fillRule:"evenodd",clipRule:"evenodd"}))}),mz=["color"],gz=g.forwardRef(function(t,e){var n=t.color,r=n===void 0?"currentColor":n,i=gi(t,mz);return g.createElement("svg",Object.assign({width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},i,{ref:e}),g.createElement("path",{d:"M10 6.5C10 8.433 8.433 10 6.5 10C4.567 10 3 8.433 3 6.5C3 4.567 4.567 3 6.5 3C8.433 3 10 4.567 10 6.5ZM9.30884 10.0159C8.53901 10.6318 7.56251 11 6.5 11C4.01472 11 2 8.98528 2 6.5C2 4.01472 4.01472 2 6.5 2C8.98528 2 11 4.01472 11 6.5C11 7.56251 10.6318 8.53901 10.0159 9.30884L12.8536 12.1464C13.0488 12.3417 13.0488 12.6583 12.8536 12.8536C12.6583 13.0488 12.3417 13.0488 12.1464 12.8536L9.30884 10.0159Z",fill:r,fillRule:"evenodd",clipRule:"evenodd"}))}),yz=["color"],vz=g.forwardRef(function(t,e){var n=t.color,r=n===void 0?"currentColor":n,i=gi(t,yz);return g.createElement("svg",Object.assign({width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},i,{ref:e}),g.createElement("path",{d:"M11.8536 1.14645C11.6583 0.951184 11.3417 0.951184 11.1465 1.14645L3.71455 8.57836C3.62459 8.66832 3.55263 8.77461 3.50251 8.89155L2.04044 12.303C1.9599 12.491 2.00189 12.709 2.14646 12.8536C2.29103 12.9981 2.50905 13.0401 2.69697 12.9596L6.10847 11.4975C6.2254 11.4474 6.3317 11.3754 6.42166 11.2855L13.8536 3.85355C14.0488 3.65829 14.0488 3.34171 13.8536 3.14645L11.8536 1.14645ZM4.42166 9.28547L11.5 2.20711L12.7929 3.5L5.71455 10.5784L4.21924 11.2192L3.78081 10.7808L4.42166 9.28547Z",fill:r,fillRule:"evenodd",clipRule:"evenodd"}))}),xz=["color"],hu=g.forwardRef(function(t,e){var n=t.color,r=n===void 0?"currentColor":n,i=gi(t,xz);return g.createElement("svg",Object.assign({width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},i,{ref:e}),g.createElement("path",{d:"M8 2.75C8 2.47386 7.77614 2.25 7.5 2.25C7.22386 2.25 7 2.47386 7 2.75V7H2.75C2.47386 7 2.25 7.22386 2.25 7.5C2.25 7.77614 2.47386 8 2.75 8H7V12.25C7 12.5261 7.22386 12.75 7.5 12.75C7.77614 12.75 8 12.5261 8 12.25V8H12.25C12.5261 8 12.75 7.77614 12.75 7.5C12.75 7.22386 12.5261 7 12.25 7H8V2.75Z",fill:r,fillRule:"evenodd",clipRule:"evenodd"}))}),wz=["color"],bz=g.forwardRef(function(t,e){var n=t.color,r=n===void 0?"currentColor":n,i=gi(t,wz);return g.createElement("svg",Object.assign({width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},i,{ref:e}),g.createElement("path",{d:"M7.49998 0.849976C7.22383 0.849976 6.99998 1.07383 6.99998 1.34998V3.52234C6.99998 3.79848 7.22383 4.02234 7.49998 4.02234C7.77612 4.02234 7.99998 3.79848 7.99998 3.52234V1.8718C10.8862 2.12488 13.15 4.54806 13.15 7.49998C13.15 10.6204 10.6204 13.15 7.49998 13.15C4.37957 13.15 1.84998 10.6204 1.84998 7.49998C1.84998 6.10612 2.35407 4.83128 3.19049 3.8459C3.36919 3.63538 3.34339 3.31985 3.13286 3.14115C2.92234 2.96245 2.60681 2.98825 2.42811 3.19877C1.44405 4.35808 0.849976 5.86029 0.849976 7.49998C0.849976 11.1727 3.82728 14.15 7.49998 14.15C11.1727 14.15 14.15 11.1727 14.15 7.49998C14.15 3.82728 11.1727 0.849976 7.49998 0.849976ZM6.74049 8.08072L4.22363 4.57237C4.15231 4.47295 4.16346 4.33652 4.24998 4.25C4.33649 4.16348 4.47293 4.15233 4.57234 4.22365L8.08069 6.74051C8.56227 7.08599 8.61906 7.78091 8.19998 8.2C7.78089 8.61909 7.08597 8.56229 6.74049 8.08072Z",fill:r,fillRule:"evenodd",clipRule:"evenodd"}))}),Sz=["color"],Gy=g.forwardRef(function(t,e){var n=t.color,r=n===void 0?"currentColor":n,i=gi(t,Sz);return g.createElement("svg",Object.assign({width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},i,{ref:e}),g.createElement("path",{d:"M5.5 1C5.22386 1 5 1.22386 5 1.5C5 1.77614 5.22386 2 5.5 2H9.5C9.77614 2 10 1.77614 10 1.5C10 1.22386 9.77614 1 9.5 1H5.5ZM3 3.5C3 3.22386 3.22386 3 3.5 3H5H10H11.5C11.7761 3 12 3.22386 12 3.5C12 3.77614 11.7761 4 11.5 4H11V12C11 12.5523 10.5523 13 10 13H5C4.44772 13 4 12.5523 4 12V4L3.5 4C3.22386 4 3 3.77614 3 3.5ZM5 4H10V12H5V4Z",fill:r,fillRule:"evenodd",clipRule:"evenodd"}))});function H(t,e,{checkForDefaultPrevented:n=!0}={}){return function(i){if(t==null||t(i),n===!1||!i.defaultPrevented)return e==null?void 0:e(i)}}function oS(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function up(...t){return e=>{let n=!1;const r=t.map(i=>{const o=oS(i,e);return!n&&typeof o=="function"&&(n=!0),o});if(n)return()=>{for(let i=0;i<r.length;i++){const o=r[i];typeof o=="function"?o():oS(t[i],null)}}}}function Se(...t){return g.useCallback(up(...t),t)}function Cz(t,e){const n=g.createContext(e),r=o=>{const{children:s,...a}=o,l=g.useMemo(()=>a,Object.values(a));return f.jsx(n.Provider,{value:l,children:s})};r.displayName=t+"Provider";function i(o){const s=g.useContext(n);if(s)return s;if(e!==void 0)return e;throw new Error(`\`${o}\` must be used within \`${t}\``)}return[r,i]}function yi(t,e=[]){let n=[];function r(o,s){const a=g.createContext(s),l=n.length;n=[...n,s];const c=d=>{var x;const{scope:h,children:p,...m}=d,y=((x=h==null?void 0:h[t])==null?void 0:x[l])||a,v=g.useMemo(()=>m,Object.values(m));return f.jsx(y.Provider,{value:v,children:p})};c.displayName=o+"Provider";function u(d,h){var y;const p=((y=h==null?void 0:h[t])==null?void 0:y[l])||a,m=g.useContext(p);if(m)return m;if(s!==void 0)return s;throw new Error(`\`${d}\` must be used within \`${o}\``)}return[c,u]}const i=()=>{const o=n.map(s=>g.createContext(s));return function(a){const l=(a==null?void 0:a[t])||o;return g.useMemo(()=>({[`__scope${t}`]:{...a,[t]:l}}),[a,l])}};return i.scopeName=t,[r,kz(i,...e)]}function kz(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const r=t.map(i=>({useScope:i(),scopeName:i.scopeName}));return function(o){const s=r.reduce((a,{useScope:l,scopeName:c})=>{const d=l(o)[`__scope${c}`];return{...a,...d}},{});return g.useMemo(()=>({[`__scope${e.scopeName}`]:s}),[s])}};return n.scopeName=e.scopeName,n}var Ot=globalThis!=null&&globalThis.document?g.useLayoutEffect:()=>{},Ez=EM["useId".toString()]||(()=>{}),Tz=0;function jr(t){const[e,n]=g.useState(Ez());return Ot(()=>{t||n(r=>r??String(Tz++))},[t]),t||(e?`radix-${e}`:"")}function Pt(t){const e=g.useRef(t);return g.useEffect(()=>{e.current=t}),g.useMemo(()=>(...n)=>{var r;return(r=e.current)==null?void 0:r.call(e,...n)},[])}function js({prop:t,defaultProp:e,onChange:n=()=>{}}){const[r,i]=_z({defaultProp:e,onChange:n}),o=t!==void 0,s=o?t:r,a=Pt(n),l=g.useCallback(c=>{if(o){const d=typeof c=="function"?c(t):c;d!==t&&a(d)}else i(c)},[o,t,i,a]);return[s,l]}function _z({defaultProp:t,onChange:e}){const n=g.useState(t),[r]=n,i=g.useRef(r),o=Pt(e);return g.useEffect(()=>{i.current!==r&&(o(r),i.current=r)},[r,i,o]),n}var Ro=g.forwardRef((t,e)=>{const{children:n,...r}=t,i=g.Children.toArray(n),o=i.find(Oz);if(o){const s=o.props.children,a=i.map(l=>l===o?g.Children.count(s)>1?g.Children.only(null):g.isValidElement(s)?s.props.children:null:l);return f.jsx(Jy,{...r,ref:e,children:g.isValidElement(s)?g.cloneElement(s,void 0,a):null})}return f.jsx(Jy,{...r,ref:e,children:n})});Ro.displayName="Slot";var Jy=g.forwardRef((t,e)=>{const{children:n,...r}=t;if(g.isValidElement(n)){const i=Mz(n),o=Pz(r,n.props);return n.type!==g.Fragment&&(o.ref=e?up(e,i):i),g.cloneElement(n,o)}return g.Children.count(n)>1?g.Children.only(null):null});Jy.displayName="SlotClone";var Rz=({children:t})=>f.jsx(f.Fragment,{children:t});function Oz(t){return g.isValidElement(t)&&t.type===Rz}function Pz(t,e){const n={...e};for(const r in e){const i=t[r],o=e[r];/^on[A-Z]/.test(r)?i&&o?n[r]=(...a)=>{o(...a),i(...a)}:i&&(n[r]=i):r==="style"?n[r]={...i,...o}:r==="className"&&(n[r]=[i,o].filter(Boolean).join(" "))}return{...t,...n}}function Mz(t){var r,i;let e=(r=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(i=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:i.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}var Iz=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],se=Iz.reduce((t,e)=>{const n=g.forwardRef((r,i)=>{const{asChild:o,...s}=r,a=o?Ro:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),f.jsx(a,{...s,ref:i})});return n.displayName=`Primitive.${e}`,{...t,[e]:n}},{});function cx(t,e){t&&Vs.flushSync(()=>t.dispatchEvent(e))}function Az(t,e=globalThis==null?void 0:globalThis.document){const n=Pt(t);g.useEffect(()=>{const r=i=>{i.key==="Escape"&&n(i)};return e.addEventListener("keydown",r,{capture:!0}),()=>e.removeEventListener("keydown",r,{capture:!0})},[n,e])}var Nz="DismissableLayer",Yy="dismissableLayer.update",Dz="dismissableLayer.pointerDownOutside",jz="dismissableLayer.focusOutside",sS,fR=g.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Ll=g.forwardRef((t,e)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:i,onFocusOutside:o,onInteractOutside:s,onDismiss:a,...l}=t,c=g.useContext(fR),[u,d]=g.useState(null),h=(u==null?void 0:u.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,p]=g.useState({}),m=Se(e,E=>d(E)),y=Array.from(c.layers),[v]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),x=y.indexOf(v),w=u?y.indexOf(u):-1,b=c.layersWithOutsidePointerEventsDisabled.size>0,S=w>=x,C=$z(E=>{const T=E.target,O=[...c.branches].some(_=>_.contains(T));!S||O||(i==null||i(E),s==null||s(E),E.defaultPrevented||a==null||a())},h),k=Fz(E=>{const T=E.target;[...c.branches].some(_=>_.contains(T))||(o==null||o(E),s==null||s(E),E.defaultPrevented||a==null||a())},h);return Az(E=>{w===c.layers.size-1&&(r==null||r(E),!E.defaultPrevented&&a&&(E.preventDefault(),a()))},h),g.useEffect(()=>{if(u)return n&&(c.layersWithOutsidePointerEventsDisabled.size===0&&(sS=h.body.style.pointerEvents,h.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(u)),c.layers.add(u),aS(),()=>{n&&c.layersWithOutsidePointerEventsDisabled.size===1&&(h.body.style.pointerEvents=sS)}},[u,h,n,c]),g.useEffect(()=>()=>{u&&(c.layers.delete(u),c.layersWithOutsidePointerEventsDisabled.delete(u),aS())},[u,c]),g.useEffect(()=>{const E=()=>p({});return document.addEventListener(Yy,E),()=>document.removeEventListener(Yy,E)},[]),f.jsx(se.div,{...l,ref:m,style:{pointerEvents:b?S?"auto":"none":void 0,...t.style},onFocusCapture:H(t.onFocusCapture,k.onFocusCapture),onBlurCapture:H(t.onBlurCapture,k.onBlurCapture),onPointerDownCapture:H(t.onPointerDownCapture,C.onPointerDownCapture)})});Ll.displayName=Nz;var Lz="DismissableLayerBranch",hR=g.forwardRef((t,e)=>{const n=g.useContext(fR),r=g.useRef(null),i=Se(e,r);return g.useEffect(()=>{const o=r.current;if(o)return n.branches.add(o),()=>{n.branches.delete(o)}},[n.branches]),f.jsx(se.div,{...t,ref:i})});hR.displayName=Lz;function $z(t,e=globalThis==null?void 0:globalThis.document){const n=Pt(t),r=g.useRef(!1),i=g.useRef(()=>{});return g.useEffect(()=>{const o=a=>{if(a.target&&!r.current){let l=function(){pR(Dz,n,c,{discrete:!0})};const c={originalEvent:a};a.pointerType==="touch"?(e.removeEventListener("click",i.current),i.current=l,e.addEventListener("click",i.current,{once:!0})):l()}else e.removeEventListener("click",i.current);r.current=!1},s=window.setTimeout(()=>{e.addEventListener("pointerdown",o)},0);return()=>{window.clearTimeout(s),e.removeEventListener("pointerdown",o),e.removeEventListener("click",i.current)}},[e,n]),{onPointerDownCapture:()=>r.current=!0}}function Fz(t,e=globalThis==null?void 0:globalThis.document){const n=Pt(t),r=g.useRef(!1);return g.useEffect(()=>{const i=o=>{o.target&&!r.current&&pR(jz,n,{originalEvent:o},{discrete:!1})};return e.addEventListener("focusin",i),()=>e.removeEventListener("focusin",i)},[e,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function aS(){const t=new CustomEvent(Yy);document.dispatchEvent(t)}function pR(t,e,n,{discrete:r}){const i=n.originalEvent.target,o=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:n});e&&i.addEventListener(t,e,{once:!0}),r?cx(i,o):i.dispatchEvent(o)}var Bz=Ll,zz=hR,Vm="focusScope.autoFocusOnMount",Um="focusScope.autoFocusOnUnmount",lS={bubbles:!1,cancelable:!0},Vz="FocusScope",Wu=g.forwardRef((t,e)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:i,onUnmountAutoFocus:o,...s}=t,[a,l]=g.useState(null),c=Pt(i),u=Pt(o),d=g.useRef(null),h=Se(e,y=>l(y)),p=g.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;g.useEffect(()=>{if(r){let y=function(b){if(p.paused||!a)return;const S=b.target;a.contains(S)?d.current=S:Ri(d.current,{select:!0})},v=function(b){if(p.paused||!a)return;const S=b.relatedTarget;S!==null&&(a.contains(S)||Ri(d.current,{select:!0}))},x=function(b){if(document.activeElement===document.body)for(const C of b)C.removedNodes.length>0&&Ri(a)};document.addEventListener("focusin",y),document.addEventListener("focusout",v);const w=new MutationObserver(x);return a&&w.observe(a,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",y),document.removeEventListener("focusout",v),w.disconnect()}}},[r,a,p.paused]),g.useEffect(()=>{if(a){uS.add(p);const y=document.activeElement;if(!a.contains(y)){const x=new CustomEvent(Vm,lS);a.addEventListener(Vm,c),a.dispatchEvent(x),x.defaultPrevented||(Uz(Gz(mR(a)),{select:!0}),document.activeElement===y&&Ri(a))}return()=>{a.removeEventListener(Vm,c),setTimeout(()=>{const x=new CustomEvent(Um,lS);a.addEventListener(Um,u),a.dispatchEvent(x),x.defaultPrevented||Ri(y??document.body,{select:!0}),a.removeEventListener(Um,u),uS.remove(p)},0)}}},[a,c,u,p]);const m=g.useCallback(y=>{if(!n&&!r||p.paused)return;const v=y.key==="Tab"&&!y.altKey&&!y.ctrlKey&&!y.metaKey,x=document.activeElement;if(v&&x){const w=y.currentTarget,[b,S]=Hz(w);b&&S?!y.shiftKey&&x===S?(y.preventDefault(),n&&Ri(b,{select:!0})):y.shiftKey&&x===b&&(y.preventDefault(),n&&Ri(S,{select:!0})):x===w&&y.preventDefault()}},[n,r,p.paused]);return f.jsx(se.div,{tabIndex:-1,...s,ref:h,onKeyDown:m})});Wu.displayName=Vz;function Uz(t,{select:e=!1}={}){const n=document.activeElement;for(const r of t)if(Ri(r,{select:e}),document.activeElement!==n)return}function Hz(t){const e=mR(t),n=cS(e,t),r=cS(e.reverse(),t);return[n,r]}function mR(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const i=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||i?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function cS(t,e){for(const n of t)if(!Wz(n,{upTo:e}))return n}function Wz(t,{upTo:e}){if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(e!==void 0&&t===e)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1}function Kz(t){return t instanceof HTMLInputElement&&"select"in t}function Ri(t,{select:e=!1}={}){if(t&&t.focus){const n=document.activeElement;t.focus({preventScroll:!0}),t!==n&&Kz(t)&&e&&t.select()}}var uS=qz();function qz(){let t=[];return{add(e){const n=t[0];e!==n&&(n==null||n.pause()),t=dS(t,e),t.unshift(e)},remove(e){var n;t=dS(t,e),(n=t[0])==null||n.resume()}}}function dS(t,e){const n=[...t],r=n.indexOf(e);return r!==-1&&n.splice(r,1),n}function Gz(t){return t.filter(e=>e.tagName!=="A")}var Jz="Portal",$l=g.forwardRef((t,e)=>{var a;const{container:n,...r}=t,[i,o]=g.useState(!1);Ot(()=>o(!0),[]);const s=n||i&&((a=globalThis==null?void 0:globalThis.document)==null?void 0:a.body);return s?cE.createPortal(f.jsx(se.div,{...r,ref:e}),s):null});$l.displayName=Jz;function Yz(t,e){return g.useReducer((n,r)=>e[n][r]??n,t)}var yr=t=>{const{present:e,children:n}=t,r=Qz(e),i=typeof n=="function"?n({present:r.isPresent}):g.Children.only(n),o=Se(r.ref,Xz(i));return typeof n=="function"||r.isPresent?g.cloneElement(i,{ref:o}):null};yr.displayName="Presence";function Qz(t){const[e,n]=g.useState(),r=g.useRef({}),i=g.useRef(t),o=g.useRef("none"),s=t?"mounted":"unmounted",[a,l]=Yz(s,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return g.useEffect(()=>{const c=Ld(r.current);o.current=a==="mounted"?c:"none"},[a]),Ot(()=>{const c=r.current,u=i.current;if(u!==t){const h=o.current,p=Ld(c);t?l("MOUNT"):p==="none"||(c==null?void 0:c.display)==="none"?l("UNMOUNT"):l(u&&h!==p?"ANIMATION_OUT":"UNMOUNT"),i.current=t}},[t,l]),Ot(()=>{if(e){let c;const u=e.ownerDocument.defaultView??window,d=p=>{const y=Ld(r.current).includes(p.animationName);if(p.target===e&&y&&(l("ANIMATION_END"),!i.current)){const v=e.style.animationFillMode;e.style.animationFillMode="forwards",c=u.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=v)})}},h=p=>{p.target===e&&(o.current=Ld(r.current))};return e.addEventListener("animationstart",h),e.addEventListener("animationcancel",d),e.addEventListener("animationend",d),()=>{u.clearTimeout(c),e.removeEventListener("animationstart",h),e.removeEventListener("animationcancel",d),e.removeEventListener("animationend",d)}}else l("ANIMATION_END")},[e,l]),{isPresent:["mounted","unmountSuspended"].includes(a),ref:g.useCallback(c=>{c&&(r.current=getComputedStyle(c)),n(c)},[])}}function Ld(t){return(t==null?void 0:t.animationName)||"none"}function Xz(t){var r,i;let e=(r=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(i=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:i.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}var Hm=0;function dp(){g.useEffect(()=>{const t=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",t[0]??fS()),document.body.insertAdjacentElement("beforeend",t[1]??fS()),Hm++,()=>{Hm===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),Hm--}},[])}function fS(){const t=document.createElement("span");return t.setAttribute("data-radix-focus-guard",""),t.tabIndex=0,t.style.outline="none",t.style.opacity="0",t.style.position="fixed",t.style.pointerEvents="none",t}var Mr=function(){return Mr=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},Mr.apply(this,arguments)};function gR(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n}function Zz(t,e,n){if(n||arguments.length===2)for(var r=0,i=e.length,o;r<i;r++)(o||!(r in e))&&(o||(o=Array.prototype.slice.call(e,0,r)),o[r]=e[r]);return t.concat(o||Array.prototype.slice.call(e))}var pf="right-scroll-bar-position",mf="width-before-scroll-bar",e8="with-scroll-bars-hidden",t8="--removed-body-scroll-bar-size";function Wm(t,e){return typeof t=="function"?t(e):t&&(t.current=e),t}function n8(t,e){var n=g.useState(function(){return{value:t,callback:e,facade:{get current(){return n.value},set current(r){var i=n.value;i!==r&&(n.value=r,n.callback(r,i))}}}})[0];return n.callback=e,n.facade}var r8=typeof window<"u"?g.useLayoutEffect:g.useEffect,hS=new WeakMap;function i8(t,e){var n=n8(e||null,function(r){return t.forEach(function(i){return Wm(i,r)})});return r8(function(){var r=hS.get(n);if(r){var i=new Set(r),o=new Set(t),s=n.current;i.forEach(function(a){o.has(a)||Wm(a,null)}),o.forEach(function(a){i.has(a)||Wm(a,s)})}hS.set(n,t)},[t]),n}function o8(t){return t}function s8(t,e){e===void 0&&(e=o8);var n=[],r=!1,i={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:t},useMedium:function(o){var s=e(o,r);return n.push(s),function(){n=n.filter(function(a){return a!==s})}},assignSyncMedium:function(o){for(r=!0;n.length;){var s=n;n=[],s.forEach(o)}n={push:function(a){return o(a)},filter:function(){return n}}},assignMedium:function(o){r=!0;var s=[];if(n.length){var a=n;n=[],a.forEach(o),s=n}var l=function(){var u=s;s=[],u.forEach(o)},c=function(){return Promise.resolve().then(l)};c(),n={push:function(u){s.push(u),c()},filter:function(u){return s=s.filter(u),n}}}};return i}function a8(t){t===void 0&&(t={});var e=s8(null);return e.options=Mr({async:!0,ssr:!1},t),e}var yR=function(t){var e=t.sideCar,n=gR(t,["sideCar"]);if(!e)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=e.read();if(!r)throw new Error("Sidecar medium not found");return g.createElement(r,Mr({},n))};yR.isSideCarExport=!0;function l8(t,e){return t.useMedium(e),yR}var vR=a8(),Km=function(){},fp=g.forwardRef(function(t,e){var n=g.useRef(null),r=g.useState({onScrollCapture:Km,onWheelCapture:Km,onTouchMoveCapture:Km}),i=r[0],o=r[1],s=t.forwardProps,a=t.children,l=t.className,c=t.removeScrollBar,u=t.enabled,d=t.shards,h=t.sideCar,p=t.noIsolation,m=t.inert,y=t.allowPinchZoom,v=t.as,x=v===void 0?"div":v,w=t.gapMode,b=gR(t,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),S=h,C=i8([n,e]),k=Mr(Mr({},b),i);return g.createElement(g.Fragment,null,u&&g.createElement(S,{sideCar:vR,removeScrollBar:c,shards:d,noIsolation:p,inert:m,setCallbacks:o,allowPinchZoom:!!y,lockRef:n,gapMode:w}),s?g.cloneElement(g.Children.only(a),Mr(Mr({},k),{ref:C})):g.createElement(x,Mr({},k,{className:l,ref:C}),a))});fp.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};fp.classNames={fullWidth:mf,zeroRight:pf};var pS,c8=function(){if(pS)return pS;if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function u8(){if(!document)return null;var t=document.createElement("style");t.type="text/css";var e=c8();return e&&t.setAttribute("nonce",e),t}function d8(t,e){t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e))}function f8(t){var e=document.head||document.getElementsByTagName("head")[0];e.appendChild(t)}var h8=function(){var t=0,e=null;return{add:function(n){t==0&&(e=u8())&&(d8(e,n),f8(e)),t++},remove:function(){t--,!t&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},p8=function(){var t=h8();return function(e,n){g.useEffect(function(){return t.add(e),function(){t.remove()}},[e&&n])}},xR=function(){var t=p8(),e=function(n){var r=n.styles,i=n.dynamic;return t(r,i),null};return e},m8={left:0,top:0,right:0,gap:0},qm=function(t){return parseInt(t||"",10)||0},g8=function(t){var e=window.getComputedStyle(document.body),n=e[t==="padding"?"paddingLeft":"marginLeft"],r=e[t==="padding"?"paddingTop":"marginTop"],i=e[t==="padding"?"paddingRight":"marginRight"];return[qm(n),qm(r),qm(i)]},y8=function(t){if(t===void 0&&(t="margin"),typeof window>"u")return m8;var e=g8(t),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,r-n+e[2]-e[0])}},v8=xR(),Ba="data-scroll-locked",x8=function(t,e,n,r){var i=t.left,o=t.top,s=t.right,a=t.gap;return n===void 0&&(n="margin"),`
  .`.concat(e8,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(a,"px ").concat(r,`;
  }
  body[`).concat(Ba,`] {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([e&&"position: relative ".concat(r,";"),n==="margin"&&`
    padding-left: `.concat(i,`px;
    padding-top: `).concat(o,`px;
    padding-right: `).concat(s,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(a,"px ").concat(r,`;
    `),n==="padding"&&"padding-right: ".concat(a,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(pf,` {
    right: `).concat(a,"px ").concat(r,`;
  }
  
  .`).concat(mf,` {
    margin-right: `).concat(a,"px ").concat(r,`;
  }
  
  .`).concat(pf," .").concat(pf,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(mf," .").concat(mf,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body[`).concat(Ba,`] {
    `).concat(t8,": ").concat(a,`px;
  }
`)},mS=function(){var t=parseInt(document.body.getAttribute(Ba)||"0",10);return isFinite(t)?t:0},w8=function(){g.useEffect(function(){return document.body.setAttribute(Ba,(mS()+1).toString()),function(){var t=mS()-1;t<=0?document.body.removeAttribute(Ba):document.body.setAttribute(Ba,t.toString())}},[])},b8=function(t){var e=t.noRelative,n=t.noImportant,r=t.gapMode,i=r===void 0?"margin":r;w8();var o=g.useMemo(function(){return y8(i)},[i]);return g.createElement(v8,{styles:x8(o,!e,i,n?"":"!important")})},Qy=!1;if(typeof window<"u")try{var $d=Object.defineProperty({},"passive",{get:function(){return Qy=!0,!0}});window.addEventListener("test",$d,$d),window.removeEventListener("test",$d,$d)}catch{Qy=!1}var ia=Qy?{passive:!1}:!1,S8=function(t){return t.tagName==="TEXTAREA"},wR=function(t,e){if(!(t instanceof Element))return!1;var n=window.getComputedStyle(t);return n[e]!=="hidden"&&!(n.overflowY===n.overflowX&&!S8(t)&&n[e]==="visible")},C8=function(t){return wR(t,"overflowY")},k8=function(t){return wR(t,"overflowX")},gS=function(t,e){var n=e.ownerDocument,r=e;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var i=bR(t,r);if(i){var o=SR(t,r),s=o[1],a=o[2];if(s>a)return!0}r=r.parentNode}while(r&&r!==n.body);return!1},E8=function(t){var e=t.scrollTop,n=t.scrollHeight,r=t.clientHeight;return[e,n,r]},T8=function(t){var e=t.scrollLeft,n=t.scrollWidth,r=t.clientWidth;return[e,n,r]},bR=function(t,e){return t==="v"?C8(e):k8(e)},SR=function(t,e){return t==="v"?E8(e):T8(e)},_8=function(t,e){return t==="h"&&e==="rtl"?-1:1},R8=function(t,e,n,r,i){var o=_8(t,window.getComputedStyle(e).direction),s=o*r,a=n.target,l=e.contains(a),c=!1,u=s>0,d=0,h=0;do{var p=SR(t,a),m=p[0],y=p[1],v=p[2],x=y-v-o*m;(m||x)&&bR(t,a)&&(d+=x,h+=m),a instanceof ShadowRoot?a=a.host:a=a.parentNode}while(!l&&a!==document.body||l&&(e.contains(a)||e===a));return(u&&(i&&Math.abs(d)<1||!i&&s>d)||!u&&(i&&Math.abs(h)<1||!i&&-s>h))&&(c=!0),c},Fd=function(t){return"changedTouches"in t?[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:[0,0]},yS=function(t){return[t.deltaX,t.deltaY]},vS=function(t){return t&&"current"in t?t.current:t},O8=function(t,e){return t[0]===e[0]&&t[1]===e[1]},P8=function(t){return`
  .block-interactivity-`.concat(t,` {pointer-events: none;}
  .allow-interactivity-`).concat(t,` {pointer-events: all;}
`)},M8=0,oa=[];function I8(t){var e=g.useRef([]),n=g.useRef([0,0]),r=g.useRef(),i=g.useState(M8++)[0],o=g.useState(xR)[0],s=g.useRef(t);g.useEffect(function(){s.current=t},[t]),g.useEffect(function(){if(t.inert){document.body.classList.add("block-interactivity-".concat(i));var y=Zz([t.lockRef.current],(t.shards||[]).map(vS),!0).filter(Boolean);return y.forEach(function(v){return v.classList.add("allow-interactivity-".concat(i))}),function(){document.body.classList.remove("block-interactivity-".concat(i)),y.forEach(function(v){return v.classList.remove("allow-interactivity-".concat(i))})}}},[t.inert,t.lockRef.current,t.shards]);var a=g.useCallback(function(y,v){if("touches"in y&&y.touches.length===2||y.type==="wheel"&&y.ctrlKey)return!s.current.allowPinchZoom;var x=Fd(y),w=n.current,b="deltaX"in y?y.deltaX:w[0]-x[0],S="deltaY"in y?y.deltaY:w[1]-x[1],C,k=y.target,E=Math.abs(b)>Math.abs(S)?"h":"v";if("touches"in y&&E==="h"&&k.type==="range")return!1;var T=gS(E,k);if(!T)return!0;if(T?C=E:(C=E==="v"?"h":"v",T=gS(E,k)),!T)return!1;if(!r.current&&"changedTouches"in y&&(b||S)&&(r.current=C),!C)return!0;var O=r.current||C;return R8(O,v,y,O==="h"?b:S,!0)},[]),l=g.useCallback(function(y){var v=y;if(!(!oa.length||oa[oa.length-1]!==o)){var x="deltaY"in v?yS(v):Fd(v),w=e.current.filter(function(C){return C.name===v.type&&(C.target===v.target||v.target===C.shadowParent)&&O8(C.delta,x)})[0];if(w&&w.should){v.cancelable&&v.preventDefault();return}if(!w){var b=(s.current.shards||[]).map(vS).filter(Boolean).filter(function(C){return C.contains(v.target)}),S=b.length>0?a(v,b[0]):!s.current.noIsolation;S&&v.cancelable&&v.preventDefault()}}},[]),c=g.useCallback(function(y,v,x,w){var b={name:y,delta:v,target:x,should:w,shadowParent:A8(x)};e.current.push(b),setTimeout(function(){e.current=e.current.filter(function(S){return S!==b})},1)},[]),u=g.useCallback(function(y){n.current=Fd(y),r.current=void 0},[]),d=g.useCallback(function(y){c(y.type,yS(y),y.target,a(y,t.lockRef.current))},[]),h=g.useCallback(function(y){c(y.type,Fd(y),y.target,a(y,t.lockRef.current))},[]);g.useEffect(function(){return oa.push(o),t.setCallbacks({onScrollCapture:d,onWheelCapture:d,onTouchMoveCapture:h}),document.addEventListener("wheel",l,ia),document.addEventListener("touchmove",l,ia),document.addEventListener("touchstart",u,ia),function(){oa=oa.filter(function(y){return y!==o}),document.removeEventListener("wheel",l,ia),document.removeEventListener("touchmove",l,ia),document.removeEventListener("touchstart",u,ia)}},[]);var p=t.removeScrollBar,m=t.inert;return g.createElement(g.Fragment,null,m?g.createElement(o,{styles:P8(i)}):null,p?g.createElement(b8,{gapMode:t.gapMode}):null)}function A8(t){for(var e=null;t!==null;)t instanceof ShadowRoot&&(e=t.host,t=t.host),t=t.parentNode;return e}const N8=l8(vR,I8);var CR=g.forwardRef(function(t,e){return g.createElement(fp,Mr({},t,{ref:e,sideCar:N8}))});CR.classNames=fp.classNames;const hp=CR;var D8=function(t){if(typeof document>"u")return null;var e=Array.isArray(t)?t[0]:t;return e.ownerDocument.body},sa=new WeakMap,Bd=new WeakMap,zd={},Gm=0,kR=function(t){return t&&(t.host||kR(t.parentNode))},j8=function(t,e){return e.map(function(n){if(t.contains(n))return n;var r=kR(n);return r&&t.contains(r)?r:(console.error("aria-hidden",n,"in not contained inside",t,". Doing nothing"),null)}).filter(function(n){return!!n})},L8=function(t,e,n,r){var i=j8(e,Array.isArray(t)?t:[t]);zd[n]||(zd[n]=new WeakMap);var o=zd[n],s=[],a=new Set,l=new Set(i),c=function(d){!d||a.has(d)||(a.add(d),c(d.parentNode))};i.forEach(c);var u=function(d){!d||l.has(d)||Array.prototype.forEach.call(d.children,function(h){if(a.has(h))u(h);else try{var p=h.getAttribute(r),m=p!==null&&p!=="false",y=(sa.get(h)||0)+1,v=(o.get(h)||0)+1;sa.set(h,y),o.set(h,v),s.push(h),y===1&&m&&Bd.set(h,!0),v===1&&h.setAttribute(n,"true"),m||h.setAttribute(r,"true")}catch(x){console.error("aria-hidden: cannot operate on ",h,x)}})};return u(e),a.clear(),Gm++,function(){s.forEach(function(d){var h=sa.get(d)-1,p=o.get(d)-1;sa.set(d,h),o.set(d,p),h||(Bd.has(d)||d.removeAttribute(r),Bd.delete(d)),p||d.removeAttribute(n)}),Gm--,Gm||(sa=new WeakMap,sa=new WeakMap,Bd=new WeakMap,zd={})}},pp=function(t,e,n){n===void 0&&(n="data-aria-hidden");var r=Array.from(Array.isArray(t)?t:[t]),i=e||D8(t);return i?(r.push.apply(r,Array.from(i.querySelectorAll("[aria-live]"))),L8(r,i,n,"aria-hidden")):function(){return null}},ux="Dialog",[ER,LW]=yi(ux),[$8,vr]=ER(ux),TR=t=>{const{__scopeDialog:e,children:n,open:r,defaultOpen:i,onOpenChange:o,modal:s=!0}=t,a=g.useRef(null),l=g.useRef(null),[c=!1,u]=js({prop:r,defaultProp:i,onChange:o});return f.jsx($8,{scope:e,triggerRef:a,contentRef:l,contentId:jr(),titleId:jr(),descriptionId:jr(),open:c,onOpenChange:u,onOpenToggle:g.useCallback(()=>u(d=>!d),[u]),modal:s,children:n})};TR.displayName=ux;var _R="DialogTrigger",F8=g.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,i=vr(_R,n),o=Se(e,i.triggerRef);return f.jsx(se.button,{type:"button","aria-haspopup":"dialog","aria-expanded":i.open,"aria-controls":i.contentId,"data-state":hx(i.open),...r,ref:o,onClick:H(t.onClick,i.onOpenToggle)})});F8.displayName=_R;var dx="DialogPortal",[B8,RR]=ER(dx,{forceMount:void 0}),OR=t=>{const{__scopeDialog:e,forceMount:n,children:r,container:i}=t,o=vr(dx,e);return f.jsx(B8,{scope:e,forceMount:n,children:g.Children.map(r,s=>f.jsx(yr,{present:n||o.open,children:f.jsx($l,{asChild:!0,container:i,children:s})}))})};OR.displayName=dx;var lh="DialogOverlay",PR=g.forwardRef((t,e)=>{const n=RR(lh,t.__scopeDialog),{forceMount:r=n.forceMount,...i}=t,o=vr(lh,t.__scopeDialog);return o.modal?f.jsx(yr,{present:r||o.open,children:f.jsx(z8,{...i,ref:e})}):null});PR.displayName=lh;var z8=g.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,i=vr(lh,n);return f.jsx(hp,{as:Ro,allowPinchZoom:!0,shards:[i.contentRef],children:f.jsx(se.div,{"data-state":hx(i.open),...r,ref:e,style:{pointerEvents:"auto",...r.style}})})}),Ls="DialogContent",MR=g.forwardRef((t,e)=>{const n=RR(Ls,t.__scopeDialog),{forceMount:r=n.forceMount,...i}=t,o=vr(Ls,t.__scopeDialog);return f.jsx(yr,{present:r||o.open,children:o.modal?f.jsx(V8,{...i,ref:e}):f.jsx(U8,{...i,ref:e})})});MR.displayName=Ls;var V8=g.forwardRef((t,e)=>{const n=vr(Ls,t.__scopeDialog),r=g.useRef(null),i=Se(e,n.contentRef,r);return g.useEffect(()=>{const o=r.current;if(o)return pp(o)},[]),f.jsx(IR,{...t,ref:i,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:H(t.onCloseAutoFocus,o=>{var s;o.preventDefault(),(s=n.triggerRef.current)==null||s.focus()}),onPointerDownOutside:H(t.onPointerDownOutside,o=>{const s=o.detail.originalEvent,a=s.button===0&&s.ctrlKey===!0;(s.button===2||a)&&o.preventDefault()}),onFocusOutside:H(t.onFocusOutside,o=>o.preventDefault())})}),U8=g.forwardRef((t,e)=>{const n=vr(Ls,t.__scopeDialog),r=g.useRef(!1),i=g.useRef(!1);return f.jsx(IR,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:o=>{var s,a;(s=t.onCloseAutoFocus)==null||s.call(t,o),o.defaultPrevented||(r.current||(a=n.triggerRef.current)==null||a.focus(),o.preventDefault()),r.current=!1,i.current=!1},onInteractOutside:o=>{var l,c;(l=t.onInteractOutside)==null||l.call(t,o),o.defaultPrevented||(r.current=!0,o.detail.originalEvent.type==="pointerdown"&&(i.current=!0));const s=o.target;((c=n.triggerRef.current)==null?void 0:c.contains(s))&&o.preventDefault(),o.detail.originalEvent.type==="focusin"&&i.current&&o.preventDefault()}})}),IR=g.forwardRef((t,e)=>{const{__scopeDialog:n,trapFocus:r,onOpenAutoFocus:i,onCloseAutoFocus:o,...s}=t,a=vr(Ls,n),l=g.useRef(null),c=Se(e,l);return dp(),f.jsxs(f.Fragment,{children:[f.jsx(Wu,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:i,onUnmountAutoFocus:o,children:f.jsx(Ll,{role:"dialog",id:a.contentId,"aria-describedby":a.descriptionId,"aria-labelledby":a.titleId,"data-state":hx(a.open),...s,ref:c,onDismiss:()=>a.onOpenChange(!1)})}),f.jsxs(f.Fragment,{children:[f.jsx(H8,{titleId:a.titleId}),f.jsx(K8,{contentRef:l,descriptionId:a.descriptionId})]})]})}),fx="DialogTitle",AR=g.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,i=vr(fx,n);return f.jsx(se.h2,{id:i.titleId,...r,ref:e})});AR.displayName=fx;var NR="DialogDescription",DR=g.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,i=vr(NR,n);return f.jsx(se.p,{id:i.descriptionId,...r,ref:e})});DR.displayName=NR;var jR="DialogClose",LR=g.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,i=vr(jR,n);return f.jsx(se.button,{type:"button",...r,ref:e,onClick:H(t.onClick,()=>i.onOpenChange(!1))})});LR.displayName=jR;function hx(t){return t?"open":"closed"}var $R="DialogTitleWarning",[$W,FR]=Cz($R,{contentName:Ls,titleName:fx,docsSlug:"dialog"}),H8=({titleId:t})=>{const e=FR($R),n=`\`${e.contentName}\` requires a \`${e.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${e.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${e.docsSlug}`;return g.useEffect(()=>{t&&(document.getElementById(t)||console.error(n))},[n,t]),null},W8="DialogDescriptionWarning",K8=({contentRef:t,descriptionId:e})=>{const r=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${FR(W8).contentName}}.`;return g.useEffect(()=>{var o;const i=(o=t.current)==null?void 0:o.getAttribute("aria-describedby");e&&i&&(document.getElementById(e)||console.warn(r))},[r,t,e]),null},ch=TR,uh=OR,dh=PR,fh=MR,hh=AR,BR=DR,Xy=LR;const pn={overlay:{backgroundColor:"rgba(0, 0, 0, 0.4)",position:"fixed",inset:0,animation:"overlayShow 150ms cubic-bezier(0.16, 1, 0.3, 1)"},content:{backgroundColor:"white",borderRadius:"8px",boxShadow:"0 10px 25px rgba(0, 0, 0, 0.2)",position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"90vw",maxWidth:"600px",maxHeight:"85vh",padding:"24px"},title:{fontSize:"20px",fontWeight:"500",color:"#1f2937",marginBottom:"24px"},field:{marginBottom:"24px"},label:{display:"block",fontSize:"14px",color:"#4b5563",marginBottom:"8px"},input:{width:"100%",padding:"8px 12px",fontSize:"14px",border:"1px solid #d1d5db",borderRadius:"6px",color:"#1f2937"},textarea:{width:"100%",padding:"8px 12px",fontSize:"14px",border:"1px solid #d1d5db",borderRadius:"6px",color:"#1f2937",minHeight:"200px",resize:"vertical"},closeButton:{position:"absolute",top:"16px",right:"16px",padding:"4px",color:"#6b7280",cursor:"pointer",background:"none",border:"none","&:hover":{color:"#1f2937"}},footer:{display:"flex",justifyContent:"flex-end",gap:"12px",marginTop:"24px"},cancelButton:{padding:"8px 16px",fontSize:"14px",color:"#6b7280",backgroundColor:"#f3f4f6",border:"none",borderRadius:"6px",cursor:"pointer","&:hover":{backgroundColor:"#e5e7eb"}},saveButton:{padding:"8px 16px",fontSize:"14px",color:"white",backgroundColor:"#2563eb",border:"none",borderRadius:"6px",cursor:"pointer","&:hover":{backgroundColor:"#1d4ed8"}}};function q8({open:t,onClose:e,onSave:n}){const[r,i]=g.useState(""),[o,s]=g.useState(""),a=()=>{n(r,o),i(""),s(""),e()};return f.jsx(ch,{open:t,onOpenChange:e,children:f.jsxs(uh,{children:[f.jsx(dh,{style:pn.overlay}),f.jsxs(fh,{style:pn.content,children:[f.jsx(hh,{style:pn.title,children:"Create snippet"}),f.jsx("button",{style:pn.closeButton,onClick:e,children:f.jsx(fu,{})}),f.jsxs("div",{style:pn.field,children:[f.jsx("label",{style:pn.label,children:"Shorthand"}),f.jsx("div",{style:{position:"relative"},children:f.jsx("input",{style:pn.input,type:"text",value:r,onChange:l=>i(l.target.value),placeholder:"Short, memorable trigger for your snippet"})})]}),f.jsxs("div",{style:pn.field,children:[f.jsx("label",{style:pn.label,children:"Content"}),f.jsx("textarea",{style:pn.textarea,value:o,onChange:l=>s(l.target.value),placeholder:"Type or paste your snippet content here..."})]}),f.jsxs("div",{style:pn.footer,children:[f.jsx("button",{style:pn.cancelButton,onClick:e,children:"Cancel"}),f.jsx("button",{style:pn.saveButton,onClick:a,disabled:!r.trim()||!o.trim(),children:"Create Snippet"})]})]})]})})}const St={...Bt,section:{marginBottom:"48px"},description:{fontSize:"14px",color:"#6b7280",marginBottom:"24px"},table:{width:"100%",backgroundColor:"#f3f6f9",borderRadius:"8px",padding:"16px"},tableHeader:{display:"grid",gridTemplateColumns:"1fr 1fr auto",gap:"16px",padding:"8px 16px",color:"#6b7280",fontSize:"14px",fontWeight:"500"},tableRow:{display:"grid",gridTemplateColumns:"1fr 1fr auto",gap:"16px",padding:"8px 16px",alignItems:"center"},addButton:{display:"flex",alignItems:"center",gap:"8px",color:"#6b7280",fontSize:"14px",padding:"8px 16px",cursor:"pointer",border:"none",background:"none","&:hover":{color:"#2563eb"}},iconButton:{padding:"4px",border:"none",background:"none",cursor:"pointer",color:"#6b7280","&:hover":{color:"#ef4444"}},snippetCard:{backgroundColor:"white",borderRadius:"8px",padding:"16px",marginBottom:"16px",border:"1px solid #e5e7eb"},snippetHeader:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},snippetCommand:{fontSize:"14px",fontWeight:"500",color:"#1f2937"},snippetText:{fontSize:"14px",color:"#6b7280"}};function zR(){const[t,e]=g.useState([{command:"/test",text:"Tests are not covered under your insurance and may be subject..."}]);return{snippets:t,addSnippet:(i,o)=>{e([...t,{command:`/${i}`,text:o}])},deleteSnippet:i=>{e(t.filter((o,s)=>s!==i))}}}function G8(){const[t,e]=g.useState([{instead:"Chi",doThis:"Qi"}]),{snippets:n,addSnippet:r,deleteSnippet:i}=zR(),[o,s]=g.useState(!1),a=()=>{e([...t,{instead:"",doThis:""}])},l=u=>{e(t.filter((d,h)=>h!==u))},c=(u,d)=>{r(u,d)};return f.jsxs("div",{style:{height:"100%",overflow:"auto",paddingRight:"16px"},children:[f.jsxs("div",{style:St.section,children:[f.jsx("h2",{style:Bt.sectionTitle,children:"Replace"}),f.jsx("p",{style:St.description,children:"Specify any abbreviations or alternative spellings of words you use in your notes"}),f.jsxs("div",{style:St.table,children:[f.jsxs("div",{style:St.tableHeader,children:[f.jsx("div",{children:"Instead of"}),f.jsx("div",{children:"Do this"}),f.jsx("div",{})]}),t.map((u,d)=>f.jsxs("div",{style:St.tableRow,children:[f.jsx("input",{style:Bt.input,value:u.instead,placeholder:"Type word or phrase"}),f.jsx("input",{style:Bt.input,value:u.doThis,placeholder:"Type replacement"}),f.jsx("button",{style:St.iconButton,onClick:()=>l(d),children:f.jsx(Gy,{width:20,height:20})})]},d))]}),f.jsxs("button",{style:St.addButton,onClick:a,children:[f.jsx(hu,{width:20,height:20}),"New replacement"]})]}),f.jsxs("div",{style:St.section,children:[f.jsx("h2",{style:Bt.sectionTitle,children:"Snippets"}),f.jsx("p",{style:St.description,children:"Type / to insert your pre-written text snippets"}),n.map((u,d)=>f.jsxs("div",{style:St.snippetCard,children:[f.jsxs("div",{style:St.snippetHeader,children:[f.jsx("div",{style:St.snippetCommand,children:u.command}),f.jsxs("div",{style:{display:"flex",gap:"8px"},children:[f.jsx("button",{style:St.iconButton,children:f.jsx(pz,{width:20,height:20})}),f.jsx("button",{style:St.iconButton,onClick:()=>i(d),children:f.jsx(Gy,{width:20,height:20})})]})]}),f.jsx("div",{style:St.snippetText,children:u.text})]},d)),f.jsxs("button",{style:St.addButton,onClick:()=>s(!0),children:[f.jsx(hu,{width:20,height:20}),"New snippet"]})]}),f.jsx(q8,{open:o,onClose:()=>s(!1),onSave:c})]})}const br={tabsContainer:{display:"flex",gap:"1px",alignItems:"flex-end",height:"44px",flexShrink:0,overflow:"auto hidden",WebkitOverflowScrolling:"touch",borderBottom:"1px solid #e5e7eb",position:"relative",zIndex:10},tab:{padding:"0 12px",backgroundColor:"#f3f4f6",borderTopLeftRadius:"6px",borderTopRightRadius:"6px",borderBottomLeftRadius:"0px",borderBottomRightRadius:"0px",cursor:"pointer",fontWeight:"500",color:"#6b7280",transition:"all 0.15s ease",height:"44px",display:"flex",alignItems:"center",fontSize:"13px",whiteSpace:"nowrap",position:"relative",marginBottom:"-1px","&:hover":{backgroundColor:"#f9fafb"}},activeTab:{backgroundColor:"#ffffff",color:"#111827",zIndex:1,borderLeft:"1px solid rgb(229, 231, 235)",borderRight:"1px solid rgb(229, 231, 235)",borderTop:"1px solid rgb(229, 231, 235)"},generateButton:{display:"flex",alignItems:"center",justifyContent:"center",minWidth:"32px",height:"32px",padding:0,backgroundColor:"#ffffff",border:"1px solid #e5e7eb",borderRadius:"6px",cursor:"pointer",transition:"all 0.15s ease",fontSize:"16px",lineHeight:"1",flexShrink:0,marginLeft:"4px",marginBottom:"4px",boxShadow:"0 1px 2px rgba(0, 0, 0, 0.05)","&:hover":{backgroundColor:"#f9fafb"}}};function J8({activeTab:t,setActiveTab:e,aiContextVersion:n,soapNoteVersion:r,templateNotes:i,onOpenTemplateModal:o}){const a=[...i].sort((l,c)=>{const u=new Date(l.created_at||0),d=new Date(c.created_at||0);return u.getTime()-d.getTime()}).reduce((l,c)=>{const u=l.find(d=>d.template_id===c.template_id);return!u||(u.version_id||0)<(c.version_id||0)?[...l.filter(h=>h.template_id!==c.template_id),c]:l},[]);return console.log("[TranscriptionTabs] Template notes:",a),f.jsxs("div",{style:br.tabsContainer,className:"tabs-container",children:[f.jsx("button",{style:{...br.tab,...t==="transcript"?br.activeTab:{}},onClick:()=>e("transcript"),children:"Transcript"}),n&&f.jsxs("button",{style:{...br.tab,...t==="ai_context"?br.activeTab:{}},onClick:()=>e("ai_context"),children:["Context ",n>1?` (v${n})`:""]}),r&&f.jsxs("button",{style:{...br.tab,...t==="soap"?br.activeTab:{}},onClick:()=>e("soap"),children:["SOAP Note ",r>1?` (v${r})`:""]}),a.map(l=>{const c=l.metadata;return f.jsxs("button",{style:{...br.tab,...t===l.template_id?br.activeTab:{}},onClick:()=>e(l.template_id||""),children:[(c==null?void 0:c.template_name)||"Template Note",l.version_id&&l.version_id>1?` (v${l.version_id})`:""]},l.template_id)}),r&&f.jsx("button",{style:br.generateButton,onClick:o,title:"Generate from template",children:"+"})]})}function mp(){const t=Je();return{getValidSessionToken:async()=>{const{data:{session:n},error:r}=await t.auth.getSession();if(r)throw new Error("Failed to get session: "+r.message);if(!(n!=null&&n.access_token)){const{data:{session:i},error:o}=await t.auth.refreshSession();if(o||!(i!=null&&i.access_token))throw new Error("No valid session available");return console.log("[Session] Using refreshed session token"),i.access_token}return console.log("[Session] Using existing session token"),n.access_token}}}function Y8({visitId:t,onSuccess:e}){const[n,r]=g.useState(!1),i=Je(),{getValidSessionToken:o}=mp();return{generateFromTemplate:async a=>{if(!(!t||n)){r(!0);try{const{data:l,error:c}=await i.from("notes").insert({visit_id:t,content:"Generating note...",type:"template",template_id:a.id,metadata:{template_name:a.name,status:"processing"},user_facing:!0,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}).select("id").single();if(c){console.error("Error creating placeholder note:",c);return}const{data:u,error:d}=await i.from("notes").select("*").eq("visit_id",t).eq("type","template").order("created_at",{ascending:!1});!d&&u&&(e==null||e(a.id,u));const h=await o(),p=await fetch(`${$r.apiUrl}/generate-from-template`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${h}`},body:JSON.stringify({visitId:t,templateId:a.id,noteId:l.id})});if(!p.ok){const m=await p.json();throw new Error(m.error||"Failed to generate note")}}catch(l){console.error("Error generating template note:",l);const{error:c}=await i.from("notes").upsert({visit_id:t,content:"Failed to generate note. Please try again.",type:"template",user_facing:!0,updated_at:new Date().toISOString(),metadata:{template_id:a.id,template_name:a.name,status:"error"}},{onConflict:"visit_id,type,metadata->template_id"});c&&console.error("Error updating note status:",c)}finally{r(!1)}}},isGenerating:n}}/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q8=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),VR=(...t)=>t.filter((e,n,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===n).join(" ").trim();/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var X8={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z8=g.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:i="",children:o,iconNode:s,...a},l)=>g.createElement("svg",{ref:l,...X8,width:e,height:e,stroke:t,strokeWidth:r?Number(n)*24/Number(e):n,className:VR("lucide",i),...a},[...s.map(([c,u])=>g.createElement(c,u)),...Array.isArray(o)?o:[o]]));/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rt=(t,e)=>{const n=g.forwardRef(({className:r,...i},o)=>g.createElement(Z8,{ref:o,iconNode:e,className:VR(`lucide-${Q8(t)}`,r),...i}));return n.displayName=`${t}`,n};/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eV=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],UR=rt("ChevronDown",eV);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tV=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],nV=rt("ChevronRight",tV);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rV=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],iV=rt("CircleAlert",rV);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oV=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],sV=rt("CircleCheck",oV);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aV=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]],lV=rt("ClipboardCheck",aV);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cV=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],uV=rt("Copy",cV);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dV=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]],fV=rt("Ellipsis",dV);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hV=[["path",{d:"m5 8 6 6",key:"1wu5hv"}],["path",{d:"m4 14 6-6 2-3",key:"1k1g8d"}],["path",{d:"M2 5h12",key:"or177f"}],["path",{d:"M7 2h1",key:"1t2jsx"}],["path",{d:"m22 22-5-10-5 10",key:"don7ne"}],["path",{d:"M14 18h6",key:"1m8k6r"}]],pV=rt("Languages",hV);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mV=[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]],ph=rt("Mic",mV);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gV=[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]],yV=rt("Pause",gV);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vV=[["path",{d:"M21 7v6h-6",key:"3ptur4"}],["path",{d:"M3 17a9 9 0 0 1 9-9 9 9 0 0 1 6 2.3l3 2.7",key:"1kgawr"}]],xV=rt("Redo",vV);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wV=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],HR=rt("RefreshCw",wV);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bV=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],SV=rt("Save",bV);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CV=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],kV=rt("Square",CV);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EV=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],TV=rt("Trash2",EV);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _V=[["path",{d:"M3 7v6h6",key:"1v2h90"}],["path",{d:"M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13",key:"1r6uu6"}]],RV=rt("Undo",_V);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OV=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]],PV=rt("Upload",OV);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MV=[["circle",{cx:"10",cy:"8",r:"5",key:"o932ke"}],["path",{d:"M2 21a8 8 0 0 1 10.434-7.62",key:"1yezr2"}],["circle",{cx:"18",cy:"18",r:"3",key:"1xkwt0"}],["path",{d:"m22 22-1.9-1.9",key:"1e5ubv"}]],IV=rt("UserRoundSearch",MV);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AV=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],NV=rt("X",AV);function gp(t){const e=t+"CollectionProvider",[n,r]=yi(e),[i,o]=n(e,{collectionRef:{current:null},itemMap:new Map}),s=p=>{const{scope:m,children:y}=p,v=Te.useRef(null),x=Te.useRef(new Map).current;return f.jsx(i,{scope:m,itemMap:x,collectionRef:v,children:y})};s.displayName=e;const a=t+"CollectionSlot",l=Te.forwardRef((p,m)=>{const{scope:y,children:v}=p,x=o(a,y),w=Se(m,x.collectionRef);return f.jsx(Ro,{ref:w,children:v})});l.displayName=a;const c=t+"CollectionItemSlot",u="data-radix-collection-item",d=Te.forwardRef((p,m)=>{const{scope:y,children:v,...x}=p,w=Te.useRef(null),b=Se(m,w),S=o(c,y);return Te.useEffect(()=>(S.itemMap.set(w,{ref:w,...x}),()=>void S.itemMap.delete(w))),f.jsx(Ro,{[u]:"",ref:b,children:v})});d.displayName=c;function h(p){const m=o(t+"CollectionConsumer",p);return Te.useCallback(()=>{const v=m.collectionRef.current;if(!v)return[];const x=Array.from(v.querySelectorAll(`[${u}]`));return Array.from(m.itemMap.values()).sort((S,C)=>x.indexOf(S.ref.current)-x.indexOf(C.ref.current))},[m.collectionRef,m.itemMap])}return[{Provider:s,Slot:l,ItemSlot:d},h,r]}var DV=g.createContext(void 0);function px(t){const e=g.useContext(DV);return t||e||"ltr"}const jV=["top","right","bottom","left"],Oo=Math.min,xn=Math.max,mh=Math.round,Vd=Math.floor,Lr=t=>({x:t,y:t}),LV={left:"right",right:"left",bottom:"top",top:"bottom"},$V={start:"end",end:"start"};function Zy(t,e,n){return xn(t,Oo(e,n))}function hi(t,e){return typeof t=="function"?t(e):t}function pi(t){return t.split("-")[0]}function Fl(t){return t.split("-")[1]}function mx(t){return t==="x"?"y":"x"}function gx(t){return t==="y"?"height":"width"}function Po(t){return["top","bottom"].includes(pi(t))?"y":"x"}function yx(t){return mx(Po(t))}function FV(t,e,n){n===void 0&&(n=!1);const r=Fl(t),i=yx(t),o=gx(i);let s=i==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return e.reference[o]>e.floating[o]&&(s=gh(s)),[s,gh(s)]}function BV(t){const e=gh(t);return[ev(t),e,ev(e)]}function ev(t){return t.replace(/start|end/g,e=>$V[e])}function zV(t,e,n){const r=["left","right"],i=["right","left"],o=["top","bottom"],s=["bottom","top"];switch(t){case"top":case"bottom":return n?e?i:r:e?r:i;case"left":case"right":return e?o:s;default:return[]}}function VV(t,e,n,r){const i=Fl(t);let o=zV(pi(t),n==="start",r);return i&&(o=o.map(s=>s+"-"+i),e&&(o=o.concat(o.map(ev)))),o}function gh(t){return t.replace(/left|right|bottom|top/g,e=>LV[e])}function UV(t){return{top:0,right:0,bottom:0,left:0,...t}}function WR(t){return typeof t!="number"?UV(t):{top:t,right:t,bottom:t,left:t}}function yh(t){const{x:e,y:n,width:r,height:i}=t;return{width:r,height:i,top:n,left:e,right:e+r,bottom:n+i,x:e,y:n}}function xS(t,e,n){let{reference:r,floating:i}=t;const o=Po(e),s=yx(e),a=gx(s),l=pi(e),c=o==="y",u=r.x+r.width/2-i.width/2,d=r.y+r.height/2-i.height/2,h=r[a]/2-i[a]/2;let p;switch(l){case"top":p={x:u,y:r.y-i.height};break;case"bottom":p={x:u,y:r.y+r.height};break;case"right":p={x:r.x+r.width,y:d};break;case"left":p={x:r.x-i.width,y:d};break;default:p={x:r.x,y:r.y}}switch(Fl(e)){case"start":p[s]-=h*(n&&c?-1:1);break;case"end":p[s]+=h*(n&&c?-1:1);break}return p}const HV=async(t,e,n)=>{const{placement:r="bottom",strategy:i="absolute",middleware:o=[],platform:s}=n,a=o.filter(Boolean),l=await(s.isRTL==null?void 0:s.isRTL(e));let c=await s.getElementRects({reference:t,floating:e,strategy:i}),{x:u,y:d}=xS(c,r,l),h=r,p={},m=0;for(let y=0;y<a.length;y++){const{name:v,fn:x}=a[y],{x:w,y:b,data:S,reset:C}=await x({x:u,y:d,initialPlacement:r,placement:h,strategy:i,middlewareData:p,rects:c,platform:s,elements:{reference:t,floating:e}});u=w??u,d=b??d,p={...p,[v]:{...p[v],...S}},C&&m<=50&&(m++,typeof C=="object"&&(C.placement&&(h=C.placement),C.rects&&(c=C.rects===!0?await s.getElementRects({reference:t,floating:e,strategy:i}):C.rects),{x:u,y:d}=xS(c,h,l)),y=-1)}return{x:u,y:d,placement:h,strategy:i,middlewareData:p}};async function pu(t,e){var n;e===void 0&&(e={});const{x:r,y:i,platform:o,rects:s,elements:a,strategy:l}=t,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:d="floating",altBoundary:h=!1,padding:p=0}=hi(e,t),m=WR(p),v=a[h?d==="floating"?"reference":"floating":d],x=yh(await o.getClippingRect({element:(n=await(o.isElement==null?void 0:o.isElement(v)))==null||n?v:v.contextElement||await(o.getDocumentElement==null?void 0:o.getDocumentElement(a.floating)),boundary:c,rootBoundary:u,strategy:l})),w=d==="floating"?{x:r,y:i,width:s.floating.width,height:s.floating.height}:s.reference,b=await(o.getOffsetParent==null?void 0:o.getOffsetParent(a.floating)),S=await(o.isElement==null?void 0:o.isElement(b))?await(o.getScale==null?void 0:o.getScale(b))||{x:1,y:1}:{x:1,y:1},C=yh(o.convertOffsetParentRelativeRectToViewportRelativeRect?await o.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:w,offsetParent:b,strategy:l}):w);return{top:(x.top-C.top+m.top)/S.y,bottom:(C.bottom-x.bottom+m.bottom)/S.y,left:(x.left-C.left+m.left)/S.x,right:(C.right-x.right+m.right)/S.x}}const WV=t=>({name:"arrow",options:t,async fn(e){const{x:n,y:r,placement:i,rects:o,platform:s,elements:a,middlewareData:l}=e,{element:c,padding:u=0}=hi(t,e)||{};if(c==null)return{};const d=WR(u),h={x:n,y:r},p=yx(i),m=gx(p),y=await s.getDimensions(c),v=p==="y",x=v?"top":"left",w=v?"bottom":"right",b=v?"clientHeight":"clientWidth",S=o.reference[m]+o.reference[p]-h[p]-o.floating[m],C=h[p]-o.reference[p],k=await(s.getOffsetParent==null?void 0:s.getOffsetParent(c));let E=k?k[b]:0;(!E||!await(s.isElement==null?void 0:s.isElement(k)))&&(E=a.floating[b]||o.floating[m]);const T=S/2-C/2,O=E/2-y[m]/2-1,_=Oo(d[x],O),D=Oo(d[w],O),L=_,N=E-y[m]-D,P=E/2-y[m]/2+T,V=Zy(L,P,N),I=!l.arrow&&Fl(i)!=null&&P!==V&&o.reference[m]/2-(P<L?_:D)-y[m]/2<0,F=I?P<L?P-L:P-N:0;return{[p]:h[p]+F,data:{[p]:V,centerOffset:P-V-F,...I&&{alignmentOffset:F}},reset:I}}}),KV=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var n,r;const{placement:i,middlewareData:o,rects:s,initialPlacement:a,platform:l,elements:c}=e,{mainAxis:u=!0,crossAxis:d=!0,fallbackPlacements:h,fallbackStrategy:p="bestFit",fallbackAxisSideDirection:m="none",flipAlignment:y=!0,...v}=hi(t,e);if((n=o.arrow)!=null&&n.alignmentOffset)return{};const x=pi(i),w=Po(a),b=pi(a)===a,S=await(l.isRTL==null?void 0:l.isRTL(c.floating)),C=h||(b||!y?[gh(a)]:BV(a)),k=m!=="none";!h&&k&&C.push(...VV(a,y,m,S));const E=[a,...C],T=await pu(e,v),O=[];let _=((r=o.flip)==null?void 0:r.overflows)||[];if(u&&O.push(T[x]),d){const P=FV(i,s,S);O.push(T[P[0]],T[P[1]])}if(_=[..._,{placement:i,overflows:O}],!O.every(P=>P<=0)){var D,L;const P=(((D=o.flip)==null?void 0:D.index)||0)+1,V=E[P];if(V)return{data:{index:P,overflows:_},reset:{placement:V}};let I=(L=_.filter(F=>F.overflows[0]<=0).sort((F,M)=>F.overflows[1]-M.overflows[1])[0])==null?void 0:L.placement;if(!I)switch(p){case"bestFit":{var N;const F=(N=_.filter(M=>{if(k){const A=Po(M.placement);return A===w||A==="y"}return!0}).map(M=>[M.placement,M.overflows.filter(A=>A>0).reduce((A,$)=>A+$,0)]).sort((M,A)=>M[1]-A[1])[0])==null?void 0:N[0];F&&(I=F);break}case"initialPlacement":I=a;break}if(i!==I)return{reset:{placement:I}}}return{}}}};function wS(t,e){return{top:t.top-e.height,right:t.right-e.width,bottom:t.bottom-e.height,left:t.left-e.width}}function bS(t){return jV.some(e=>t[e]>=0)}const qV=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(e){const{rects:n}=e,{strategy:r="referenceHidden",...i}=hi(t,e);switch(r){case"referenceHidden":{const o=await pu(e,{...i,elementContext:"reference"}),s=wS(o,n.reference);return{data:{referenceHiddenOffsets:s,referenceHidden:bS(s)}}}case"escaped":{const o=await pu(e,{...i,altBoundary:!0}),s=wS(o,n.floating);return{data:{escapedOffsets:s,escaped:bS(s)}}}default:return{}}}}};async function GV(t,e){const{placement:n,platform:r,elements:i}=t,o=await(r.isRTL==null?void 0:r.isRTL(i.floating)),s=pi(n),a=Fl(n),l=Po(n)==="y",c=["left","top"].includes(s)?-1:1,u=o&&l?-1:1,d=hi(e,t);let{mainAxis:h,crossAxis:p,alignmentAxis:m}=typeof d=="number"?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:d.mainAxis||0,crossAxis:d.crossAxis||0,alignmentAxis:d.alignmentAxis};return a&&typeof m=="number"&&(p=a==="end"?m*-1:m),l?{x:p*u,y:h*c}:{x:h*c,y:p*u}}const JV=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var n,r;const{x:i,y:o,placement:s,middlewareData:a}=e,l=await GV(e,t);return s===((n=a.offset)==null?void 0:n.placement)&&(r=a.arrow)!=null&&r.alignmentOffset?{}:{x:i+l.x,y:o+l.y,data:{...l,placement:s}}}}},YV=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:n,y:r,placement:i}=e,{mainAxis:o=!0,crossAxis:s=!1,limiter:a={fn:v=>{let{x,y:w}=v;return{x,y:w}}},...l}=hi(t,e),c={x:n,y:r},u=await pu(e,l),d=Po(pi(i)),h=mx(d);let p=c[h],m=c[d];if(o){const v=h==="y"?"top":"left",x=h==="y"?"bottom":"right",w=p+u[v],b=p-u[x];p=Zy(w,p,b)}if(s){const v=d==="y"?"top":"left",x=d==="y"?"bottom":"right",w=m+u[v],b=m-u[x];m=Zy(w,m,b)}const y=a.fn({...e,[h]:p,[d]:m});return{...y,data:{x:y.x-n,y:y.y-r,enabled:{[h]:o,[d]:s}}}}}},QV=function(t){return t===void 0&&(t={}),{options:t,fn(e){const{x:n,y:r,placement:i,rects:o,middlewareData:s}=e,{offset:a=0,mainAxis:l=!0,crossAxis:c=!0}=hi(t,e),u={x:n,y:r},d=Po(i),h=mx(d);let p=u[h],m=u[d];const y=hi(a,e),v=typeof y=="number"?{mainAxis:y,crossAxis:0}:{mainAxis:0,crossAxis:0,...y};if(l){const b=h==="y"?"height":"width",S=o.reference[h]-o.floating[b]+v.mainAxis,C=o.reference[h]+o.reference[b]-v.mainAxis;p<S?p=S:p>C&&(p=C)}if(c){var x,w;const b=h==="y"?"width":"height",S=["top","left"].includes(pi(i)),C=o.reference[d]-o.floating[b]+(S&&((x=s.offset)==null?void 0:x[d])||0)+(S?0:v.crossAxis),k=o.reference[d]+o.reference[b]+(S?0:((w=s.offset)==null?void 0:w[d])||0)-(S?v.crossAxis:0);m<C?m=C:m>k&&(m=k)}return{[h]:p,[d]:m}}}},XV=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(e){var n,r;const{placement:i,rects:o,platform:s,elements:a}=e,{apply:l=()=>{},...c}=hi(t,e),u=await pu(e,c),d=pi(i),h=Fl(i),p=Po(i)==="y",{width:m,height:y}=o.floating;let v,x;d==="top"||d==="bottom"?(v=d,x=h===(await(s.isRTL==null?void 0:s.isRTL(a.floating))?"start":"end")?"left":"right"):(x=d,v=h==="end"?"top":"bottom");const w=y-u.top-u.bottom,b=m-u.left-u.right,S=Oo(y-u[v],w),C=Oo(m-u[x],b),k=!e.middlewareData.shift;let E=S,T=C;if((n=e.middlewareData.shift)!=null&&n.enabled.x&&(T=b),(r=e.middlewareData.shift)!=null&&r.enabled.y&&(E=w),k&&!h){const _=xn(u.left,0),D=xn(u.right,0),L=xn(u.top,0),N=xn(u.bottom,0);p?T=m-2*(_!==0||D!==0?_+D:xn(u.left,u.right)):E=y-2*(L!==0||N!==0?L+N:xn(u.top,u.bottom))}await l({...e,availableWidth:T,availableHeight:E});const O=await s.getDimensions(a.floating);return m!==O.width||y!==O.height?{reset:{rects:!0}}:{}}}};function yp(){return typeof window<"u"}function Bl(t){return KR(t)?(t.nodeName||"").toLowerCase():"#document"}function Cn(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function Hr(t){var e;return(e=(KR(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function KR(t){return yp()?t instanceof Node||t instanceof Cn(t).Node:!1}function dr(t){return yp()?t instanceof Element||t instanceof Cn(t).Element:!1}function Vr(t){return yp()?t instanceof HTMLElement||t instanceof Cn(t).HTMLElement:!1}function SS(t){return!yp()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof Cn(t).ShadowRoot}function Ku(t){const{overflow:e,overflowX:n,overflowY:r,display:i}=fr(t);return/auto|scroll|overlay|hidden|clip/.test(e+r+n)&&!["inline","contents"].includes(i)}function ZV(t){return["table","td","th"].includes(Bl(t))}function vp(t){return[":popover-open",":modal"].some(e=>{try{return t.matches(e)}catch{return!1}})}function vx(t){const e=xx(),n=dr(t)?fr(t):t;return["transform","translate","scale","rotate","perspective"].some(r=>n[r]?n[r]!=="none":!1)||(n.containerType?n.containerType!=="normal":!1)||!e&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!e&&(n.filter?n.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(r=>(n.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(n.contain||"").includes(r))}function eU(t){let e=Mo(t);for(;Vr(e)&&!bl(e);){if(vx(e))return e;if(vp(e))return null;e=Mo(e)}return null}function xx(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function bl(t){return["html","body","#document"].includes(Bl(t))}function fr(t){return Cn(t).getComputedStyle(t)}function xp(t){return dr(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function Mo(t){if(Bl(t)==="html")return t;const e=t.assignedSlot||t.parentNode||SS(t)&&t.host||Hr(t);return SS(e)?e.host:e}function qR(t){const e=Mo(t);return bl(e)?t.ownerDocument?t.ownerDocument.body:t.body:Vr(e)&&Ku(e)?e:qR(e)}function mu(t,e,n){var r;e===void 0&&(e=[]),n===void 0&&(n=!0);const i=qR(t),o=i===((r=t.ownerDocument)==null?void 0:r.body),s=Cn(i);if(o){const a=tv(s);return e.concat(s,s.visualViewport||[],Ku(i)?i:[],a&&n?mu(a):[])}return e.concat(i,mu(i,[],n))}function tv(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function GR(t){const e=fr(t);let n=parseFloat(e.width)||0,r=parseFloat(e.height)||0;const i=Vr(t),o=i?t.offsetWidth:n,s=i?t.offsetHeight:r,a=mh(n)!==o||mh(r)!==s;return a&&(n=o,r=s),{width:n,height:r,$:a}}function wx(t){return dr(t)?t:t.contextElement}function za(t){const e=wx(t);if(!Vr(e))return Lr(1);const n=e.getBoundingClientRect(),{width:r,height:i,$:o}=GR(e);let s=(o?mh(n.width):n.width)/r,a=(o?mh(n.height):n.height)/i;return(!s||!Number.isFinite(s))&&(s=1),(!a||!Number.isFinite(a))&&(a=1),{x:s,y:a}}const tU=Lr(0);function JR(t){const e=Cn(t);return!xx()||!e.visualViewport?tU:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function nU(t,e,n){return e===void 0&&(e=!1),!n||e&&n!==Cn(t)?!1:e}function $s(t,e,n,r){e===void 0&&(e=!1),n===void 0&&(n=!1);const i=t.getBoundingClientRect(),o=wx(t);let s=Lr(1);e&&(r?dr(r)&&(s=za(r)):s=za(t));const a=nU(o,n,r)?JR(o):Lr(0);let l=(i.left+a.x)/s.x,c=(i.top+a.y)/s.y,u=i.width/s.x,d=i.height/s.y;if(o){const h=Cn(o),p=r&&dr(r)?Cn(r):r;let m=h,y=tv(m);for(;y&&r&&p!==m;){const v=za(y),x=y.getBoundingClientRect(),w=fr(y),b=x.left+(y.clientLeft+parseFloat(w.paddingLeft))*v.x,S=x.top+(y.clientTop+parseFloat(w.paddingTop))*v.y;l*=v.x,c*=v.y,u*=v.x,d*=v.y,l+=b,c+=S,m=Cn(y),y=tv(m)}}return yh({width:u,height:d,x:l,y:c})}function bx(t,e){const n=xp(t).scrollLeft;return e?e.left+n:$s(Hr(t)).left+n}function YR(t,e,n){n===void 0&&(n=!1);const r=t.getBoundingClientRect(),i=r.left+e.scrollLeft-(n?0:bx(t,r)),o=r.top+e.scrollTop;return{x:i,y:o}}function rU(t){let{elements:e,rect:n,offsetParent:r,strategy:i}=t;const o=i==="fixed",s=Hr(r),a=e?vp(e.floating):!1;if(r===s||a&&o)return n;let l={scrollLeft:0,scrollTop:0},c=Lr(1);const u=Lr(0),d=Vr(r);if((d||!d&&!o)&&((Bl(r)!=="body"||Ku(s))&&(l=xp(r)),Vr(r))){const p=$s(r);c=za(r),u.x=p.x+r.clientLeft,u.y=p.y+r.clientTop}const h=s&&!d&&!o?YR(s,l,!0):Lr(0);return{width:n.width*c.x,height:n.height*c.y,x:n.x*c.x-l.scrollLeft*c.x+u.x+h.x,y:n.y*c.y-l.scrollTop*c.y+u.y+h.y}}function iU(t){return Array.from(t.getClientRects())}function oU(t){const e=Hr(t),n=xp(t),r=t.ownerDocument.body,i=xn(e.scrollWidth,e.clientWidth,r.scrollWidth,r.clientWidth),o=xn(e.scrollHeight,e.clientHeight,r.scrollHeight,r.clientHeight);let s=-n.scrollLeft+bx(t);const a=-n.scrollTop;return fr(r).direction==="rtl"&&(s+=xn(e.clientWidth,r.clientWidth)-i),{width:i,height:o,x:s,y:a}}function sU(t,e){const n=Cn(t),r=Hr(t),i=n.visualViewport;let o=r.clientWidth,s=r.clientHeight,a=0,l=0;if(i){o=i.width,s=i.height;const c=xx();(!c||c&&e==="fixed")&&(a=i.offsetLeft,l=i.offsetTop)}return{width:o,height:s,x:a,y:l}}function aU(t,e){const n=$s(t,!0,e==="fixed"),r=n.top+t.clientTop,i=n.left+t.clientLeft,o=Vr(t)?za(t):Lr(1),s=t.clientWidth*o.x,a=t.clientHeight*o.y,l=i*o.x,c=r*o.y;return{width:s,height:a,x:l,y:c}}function CS(t,e,n){let r;if(e==="viewport")r=sU(t,n);else if(e==="document")r=oU(Hr(t));else if(dr(e))r=aU(e,n);else{const i=JR(t);r={x:e.x-i.x,y:e.y-i.y,width:e.width,height:e.height}}return yh(r)}function QR(t,e){const n=Mo(t);return n===e||!dr(n)||bl(n)?!1:fr(n).position==="fixed"||QR(n,e)}function lU(t,e){const n=e.get(t);if(n)return n;let r=mu(t,[],!1).filter(a=>dr(a)&&Bl(a)!=="body"),i=null;const o=fr(t).position==="fixed";let s=o?Mo(t):t;for(;dr(s)&&!bl(s);){const a=fr(s),l=vx(s);!l&&a.position==="fixed"&&(i=null),(o?!l&&!i:!l&&a.position==="static"&&!!i&&["absolute","fixed"].includes(i.position)||Ku(s)&&!l&&QR(t,s))?r=r.filter(u=>u!==s):i=a,s=Mo(s)}return e.set(t,r),r}function cU(t){let{element:e,boundary:n,rootBoundary:r,strategy:i}=t;const s=[...n==="clippingAncestors"?vp(e)?[]:lU(e,this._c):[].concat(n),r],a=s[0],l=s.reduce((c,u)=>{const d=CS(e,u,i);return c.top=xn(d.top,c.top),c.right=Oo(d.right,c.right),c.bottom=Oo(d.bottom,c.bottom),c.left=xn(d.left,c.left),c},CS(e,a,i));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function uU(t){const{width:e,height:n}=GR(t);return{width:e,height:n}}function dU(t,e,n){const r=Vr(e),i=Hr(e),o=n==="fixed",s=$s(t,!0,o,e);let a={scrollLeft:0,scrollTop:0};const l=Lr(0);if(r||!r&&!o)if((Bl(e)!=="body"||Ku(i))&&(a=xp(e)),r){const h=$s(e,!0,o,e);l.x=h.x+e.clientLeft,l.y=h.y+e.clientTop}else i&&(l.x=bx(i));const c=i&&!r&&!o?YR(i,a):Lr(0),u=s.left+a.scrollLeft-l.x-c.x,d=s.top+a.scrollTop-l.y-c.y;return{x:u,y:d,width:s.width,height:s.height}}function Jm(t){return fr(t).position==="static"}function kS(t,e){if(!Vr(t)||fr(t).position==="fixed")return null;if(e)return e(t);let n=t.offsetParent;return Hr(t)===n&&(n=n.ownerDocument.body),n}function XR(t,e){const n=Cn(t);if(vp(t))return n;if(!Vr(t)){let i=Mo(t);for(;i&&!bl(i);){if(dr(i)&&!Jm(i))return i;i=Mo(i)}return n}let r=kS(t,e);for(;r&&ZV(r)&&Jm(r);)r=kS(r,e);return r&&bl(r)&&Jm(r)&&!vx(r)?n:r||eU(t)||n}const fU=async function(t){const e=this.getOffsetParent||XR,n=this.getDimensions,r=await n(t.floating);return{reference:dU(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function hU(t){return fr(t).direction==="rtl"}const pU={convertOffsetParentRelativeRectToViewportRelativeRect:rU,getDocumentElement:Hr,getClippingRect:cU,getOffsetParent:XR,getElementRects:fU,getClientRects:iU,getDimensions:uU,getScale:za,isElement:dr,isRTL:hU};function ZR(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height}function mU(t,e){let n=null,r;const i=Hr(t);function o(){var a;clearTimeout(r),(a=n)==null||a.disconnect(),n=null}function s(a,l){a===void 0&&(a=!1),l===void 0&&(l=1),o();const c=t.getBoundingClientRect(),{left:u,top:d,width:h,height:p}=c;if(a||e(),!h||!p)return;const m=Vd(d),y=Vd(i.clientWidth-(u+h)),v=Vd(i.clientHeight-(d+p)),x=Vd(u),b={rootMargin:-m+"px "+-y+"px "+-v+"px "+-x+"px",threshold:xn(0,Oo(1,l))||1};let S=!0;function C(k){const E=k[0].intersectionRatio;if(E!==l){if(!S)return s();E?s(!1,E):r=setTimeout(()=>{s(!1,1e-7)},1e3)}E===1&&!ZR(c,t.getBoundingClientRect())&&s(),S=!1}try{n=new IntersectionObserver(C,{...b,root:i.ownerDocument})}catch{n=new IntersectionObserver(C,b)}n.observe(t)}return s(!0),o}function gU(t,e,n,r){r===void 0&&(r={});const{ancestorScroll:i=!0,ancestorResize:o=!0,elementResize:s=typeof ResizeObserver=="function",layoutShift:a=typeof IntersectionObserver=="function",animationFrame:l=!1}=r,c=wx(t),u=i||o?[...c?mu(c):[],...mu(e)]:[];u.forEach(x=>{i&&x.addEventListener("scroll",n,{passive:!0}),o&&x.addEventListener("resize",n)});const d=c&&a?mU(c,n):null;let h=-1,p=null;s&&(p=new ResizeObserver(x=>{let[w]=x;w&&w.target===c&&p&&(p.unobserve(e),cancelAnimationFrame(h),h=requestAnimationFrame(()=>{var b;(b=p)==null||b.observe(e)})),n()}),c&&!l&&p.observe(c),p.observe(e));let m,y=l?$s(t):null;l&&v();function v(){const x=$s(t);y&&!ZR(y,x)&&n(),y=x,m=requestAnimationFrame(v)}return n(),()=>{var x;u.forEach(w=>{i&&w.removeEventListener("scroll",n),o&&w.removeEventListener("resize",n)}),d==null||d(),(x=p)==null||x.disconnect(),p=null,l&&cancelAnimationFrame(m)}}const yU=JV,vU=YV,xU=KV,wU=XV,bU=qV,ES=WV,SU=QV,CU=(t,e,n)=>{const r=new Map,i={platform:pU,...n},o={...i.platform,_c:r};return HV(t,e,{...i,platform:o})};var gf=typeof document<"u"?g.useLayoutEffect:g.useEffect;function vh(t,e){if(t===e)return!0;if(typeof t!=typeof e)return!1;if(typeof t=="function"&&t.toString()===e.toString())return!0;let n,r,i;if(t&&e&&typeof t=="object"){if(Array.isArray(t)){if(n=t.length,n!==e.length)return!1;for(r=n;r--!==0;)if(!vh(t[r],e[r]))return!1;return!0}if(i=Object.keys(t),n=i.length,n!==Object.keys(e).length)return!1;for(r=n;r--!==0;)if(!{}.hasOwnProperty.call(e,i[r]))return!1;for(r=n;r--!==0;){const o=i[r];if(!(o==="_owner"&&t.$$typeof)&&!vh(t[o],e[o]))return!1}return!0}return t!==t&&e!==e}function eO(t){return typeof window>"u"?1:(t.ownerDocument.defaultView||window).devicePixelRatio||1}function TS(t,e){const n=eO(t);return Math.round(e*n)/n}function Ym(t){const e=g.useRef(t);return gf(()=>{e.current=t}),e}function kU(t){t===void 0&&(t={});const{placement:e="bottom",strategy:n="absolute",middleware:r=[],platform:i,elements:{reference:o,floating:s}={},transform:a=!0,whileElementsMounted:l,open:c}=t,[u,d]=g.useState({x:0,y:0,strategy:n,placement:e,middlewareData:{},isPositioned:!1}),[h,p]=g.useState(r);vh(h,r)||p(r);const[m,y]=g.useState(null),[v,x]=g.useState(null),w=g.useCallback(M=>{M!==k.current&&(k.current=M,y(M))},[]),b=g.useCallback(M=>{M!==E.current&&(E.current=M,x(M))},[]),S=o||m,C=s||v,k=g.useRef(null),E=g.useRef(null),T=g.useRef(u),O=l!=null,_=Ym(l),D=Ym(i),L=Ym(c),N=g.useCallback(()=>{if(!k.current||!E.current)return;const M={placement:e,strategy:n,middleware:h};D.current&&(M.platform=D.current),CU(k.current,E.current,M).then(A=>{const $={...A,isPositioned:L.current!==!1};P.current&&!vh(T.current,$)&&(T.current=$,Vs.flushSync(()=>{d($)}))})},[h,e,n,D,L]);gf(()=>{c===!1&&T.current.isPositioned&&(T.current.isPositioned=!1,d(M=>({...M,isPositioned:!1})))},[c]);const P=g.useRef(!1);gf(()=>(P.current=!0,()=>{P.current=!1}),[]),gf(()=>{if(S&&(k.current=S),C&&(E.current=C),S&&C){if(_.current)return _.current(S,C,N);N()}},[S,C,N,_,O]);const V=g.useMemo(()=>({reference:k,floating:E,setReference:w,setFloating:b}),[w,b]),I=g.useMemo(()=>({reference:S,floating:C}),[S,C]),F=g.useMemo(()=>{const M={position:n,left:0,top:0};if(!I.floating)return M;const A=TS(I.floating,u.x),$=TS(I.floating,u.y);return a?{...M,transform:"translate("+A+"px, "+$+"px)",...eO(I.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:A,top:$}},[n,a,I.floating,u.x,u.y]);return g.useMemo(()=>({...u,update:N,refs:V,elements:I,floatingStyles:F}),[u,N,V,I,F])}const EU=t=>{function e(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:t,fn(n){const{element:r,padding:i}=typeof t=="function"?t(n):t;return r&&e(r)?r.current!=null?ES({element:r.current,padding:i}).fn(n):{}:r?ES({element:r,padding:i}).fn(n):{}}}},TU=(t,e)=>({...yU(t),options:[t,e]}),_U=(t,e)=>({...vU(t),options:[t,e]}),RU=(t,e)=>({...SU(t),options:[t,e]}),OU=(t,e)=>({...xU(t),options:[t,e]}),PU=(t,e)=>({...wU(t),options:[t,e]}),MU=(t,e)=>({...bU(t),options:[t,e]}),IU=(t,e)=>({...EU(t),options:[t,e]});var AU="Arrow",tO=g.forwardRef((t,e)=>{const{children:n,width:r=10,height:i=5,...o}=t;return f.jsx(se.svg,{...o,ref:e,width:r,height:i,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:t.asChild?n:f.jsx("polygon",{points:"0,0 30,0 15,10"})})});tO.displayName=AU;var NU=tO;function DU(t){const[e,n]=g.useState(void 0);return Ot(()=>{if(t){n({width:t.offsetWidth,height:t.offsetHeight});const r=new ResizeObserver(i=>{if(!Array.isArray(i)||!i.length)return;const o=i[0];let s,a;if("borderBoxSize"in o){const l=o.borderBoxSize,c=Array.isArray(l)?l[0]:l;s=c.inlineSize,a=c.blockSize}else s=t.offsetWidth,a=t.offsetHeight;n({width:s,height:a})});return r.observe(t,{box:"border-box"}),()=>r.unobserve(t)}else n(void 0)},[t]),e}var Sx="Popper",[nO,zl]=yi(Sx),[jU,rO]=nO(Sx),iO=t=>{const{__scopePopper:e,children:n}=t,[r,i]=g.useState(null);return f.jsx(jU,{scope:e,anchor:r,onAnchorChange:i,children:n})};iO.displayName=Sx;var oO="PopperAnchor",sO=g.forwardRef((t,e)=>{const{__scopePopper:n,virtualRef:r,...i}=t,o=rO(oO,n),s=g.useRef(null),a=Se(e,s);return g.useEffect(()=>{o.onAnchorChange((r==null?void 0:r.current)||s.current)}),r?null:f.jsx(se.div,{...i,ref:a})});sO.displayName=oO;var Cx="PopperContent",[LU,$U]=nO(Cx),aO=g.forwardRef((t,e)=>{var J,ue,ye,de,he,ve;const{__scopePopper:n,side:r="bottom",sideOffset:i=0,align:o="center",alignOffset:s=0,arrowPadding:a=0,avoidCollisions:l=!0,collisionBoundary:c=[],collisionPadding:u=0,sticky:d="partial",hideWhenDetached:h=!1,updatePositionStrategy:p="optimized",onPlaced:m,...y}=t,v=rO(Cx,n),[x,w]=g.useState(null),b=Se(e,Ze=>w(Ze)),[S,C]=g.useState(null),k=DU(S),E=(k==null?void 0:k.width)??0,T=(k==null?void 0:k.height)??0,O=r+(o!=="center"?"-"+o:""),_=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},D=Array.isArray(c)?c:[c],L=D.length>0,N={padding:_,boundary:D.filter(BU),altBoundary:L},{refs:P,floatingStyles:V,placement:I,isPositioned:F,middlewareData:M}=kU({strategy:"fixed",placement:O,whileElementsMounted:(...Ze)=>gU(...Ze,{animationFrame:p==="always"}),elements:{reference:v.anchor},middleware:[TU({mainAxis:i+T,alignmentAxis:s}),l&&_U({mainAxis:!0,crossAxis:!1,limiter:d==="partial"?RU():void 0,...N}),l&&OU({...N}),PU({...N,apply:({elements:Ze,rects:At,availableWidth:xr,availableHeight:Jn})=>{const{width:Yn,height:Gs}=At.reference,Wr=Ze.floating.style;Wr.setProperty("--radix-popper-available-width",`${xr}px`),Wr.setProperty("--radix-popper-available-height",`${Jn}px`),Wr.setProperty("--radix-popper-anchor-width",`${Yn}px`),Wr.setProperty("--radix-popper-anchor-height",`${Gs}px`)}}),S&&IU({element:S,padding:a}),zU({arrowWidth:E,arrowHeight:T}),h&&MU({strategy:"referenceHidden",...N})]}),[A,$]=uO(I),G=Pt(m);Ot(()=>{F&&(G==null||G())},[F,G]);const ee=(J=M.arrow)==null?void 0:J.x,q=(ue=M.arrow)==null?void 0:ue.y,Z=((ye=M.arrow)==null?void 0:ye.centerOffset)!==0,[be,ge]=g.useState();return Ot(()=>{x&&ge(window.getComputedStyle(x).zIndex)},[x]),f.jsx("div",{ref:P.setFloating,"data-radix-popper-content-wrapper":"",style:{...V,transform:F?V.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:be,"--radix-popper-transform-origin":[(de=M.transformOrigin)==null?void 0:de.x,(he=M.transformOrigin)==null?void 0:he.y].join(" "),...((ve=M.hide)==null?void 0:ve.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:t.dir,children:f.jsx(LU,{scope:n,placedSide:A,onArrowChange:C,arrowX:ee,arrowY:q,shouldHideArrow:Z,children:f.jsx(se.div,{"data-side":A,"data-align":$,...y,ref:b,style:{...y.style,animation:F?void 0:"none"}})})})});aO.displayName=Cx;var lO="PopperArrow",FU={top:"bottom",right:"left",bottom:"top",left:"right"},cO=g.forwardRef(function(e,n){const{__scopePopper:r,...i}=e,o=$U(lO,r),s=FU[o.placedSide];return f.jsx("span",{ref:o.onArrowChange,style:{position:"absolute",left:o.arrowX,top:o.arrowY,[s]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[o.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[o.placedSide],visibility:o.shouldHideArrow?"hidden":void 0},children:f.jsx(NU,{...i,ref:n,style:{...i.style,display:"block"}})})});cO.displayName=lO;function BU(t){return t!==null}var zU=t=>({name:"transformOrigin",options:t,fn(e){var v,x,w;const{placement:n,rects:r,middlewareData:i}=e,s=((v=i.arrow)==null?void 0:v.centerOffset)!==0,a=s?0:t.arrowWidth,l=s?0:t.arrowHeight,[c,u]=uO(n),d={start:"0%",center:"50%",end:"100%"}[u],h=(((x=i.arrow)==null?void 0:x.x)??0)+a/2,p=(((w=i.arrow)==null?void 0:w.y)??0)+l/2;let m="",y="";return c==="bottom"?(m=s?d:`${h}px`,y=`${-l}px`):c==="top"?(m=s?d:`${h}px`,y=`${r.floating.height+l}px`):c==="right"?(m=`${-l}px`,y=s?d:`${p}px`):c==="left"&&(m=`${r.floating.width+l}px`,y=s?d:`${p}px`),{data:{x:m,y}}}});function uO(t){const[e,n="center"]=t.split("-");return[e,n]}var kx=iO,wp=sO,Ex=aO,Tx=cO,Qm="rovingFocusGroup.onEntryFocus",VU={bubbles:!1,cancelable:!0},bp="RovingFocusGroup",[nv,dO,UU]=gp(bp),[HU,fO]=yi(bp,[UU]),[WU,KU]=HU(bp),hO=g.forwardRef((t,e)=>f.jsx(nv.Provider,{scope:t.__scopeRovingFocusGroup,children:f.jsx(nv.Slot,{scope:t.__scopeRovingFocusGroup,children:f.jsx(qU,{...t,ref:e})})}));hO.displayName=bp;var qU=g.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:n,orientation:r,loop:i=!1,dir:o,currentTabStopId:s,defaultCurrentTabStopId:a,onCurrentTabStopIdChange:l,onEntryFocus:c,preventScrollOnEntryFocus:u=!1,...d}=t,h=g.useRef(null),p=Se(e,h),m=px(o),[y=null,v]=js({prop:s,defaultProp:a,onChange:l}),[x,w]=g.useState(!1),b=Pt(c),S=dO(n),C=g.useRef(!1),[k,E]=g.useState(0);return g.useEffect(()=>{const T=h.current;if(T)return T.addEventListener(Qm,b),()=>T.removeEventListener(Qm,b)},[b]),f.jsx(WU,{scope:n,orientation:r,dir:m,loop:i,currentTabStopId:y,onItemFocus:g.useCallback(T=>v(T),[v]),onItemShiftTab:g.useCallback(()=>w(!0),[]),onFocusableItemAdd:g.useCallback(()=>E(T=>T+1),[]),onFocusableItemRemove:g.useCallback(()=>E(T=>T-1),[]),children:f.jsx(se.div,{tabIndex:x||k===0?-1:0,"data-orientation":r,...d,ref:p,style:{outline:"none",...t.style},onMouseDown:H(t.onMouseDown,()=>{C.current=!0}),onFocus:H(t.onFocus,T=>{const O=!C.current;if(T.target===T.currentTarget&&O&&!x){const _=new CustomEvent(Qm,VU);if(T.currentTarget.dispatchEvent(_),!_.defaultPrevented){const D=S().filter(I=>I.focusable),L=D.find(I=>I.active),N=D.find(I=>I.id===y),V=[L,N,...D].filter(Boolean).map(I=>I.ref.current);gO(V,u)}}C.current=!1}),onBlur:H(t.onBlur,()=>w(!1))})})}),pO="RovingFocusGroupItem",mO=g.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:n,focusable:r=!0,active:i=!1,tabStopId:o,...s}=t,a=jr(),l=o||a,c=KU(pO,n),u=c.currentTabStopId===l,d=dO(n),{onFocusableItemAdd:h,onFocusableItemRemove:p}=c;return g.useEffect(()=>{if(r)return h(),()=>p()},[r,h,p]),f.jsx(nv.ItemSlot,{scope:n,id:l,focusable:r,active:i,children:f.jsx(se.span,{tabIndex:u?0:-1,"data-orientation":c.orientation,...s,ref:e,onMouseDown:H(t.onMouseDown,m=>{r?c.onItemFocus(l):m.preventDefault()}),onFocus:H(t.onFocus,()=>c.onItemFocus(l)),onKeyDown:H(t.onKeyDown,m=>{if(m.key==="Tab"&&m.shiftKey){c.onItemShiftTab();return}if(m.target!==m.currentTarget)return;const y=YU(m,c.orientation,c.dir);if(y!==void 0){if(m.metaKey||m.ctrlKey||m.altKey||m.shiftKey)return;m.preventDefault();let x=d().filter(w=>w.focusable).map(w=>w.ref.current);if(y==="last")x.reverse();else if(y==="prev"||y==="next"){y==="prev"&&x.reverse();const w=x.indexOf(m.currentTarget);x=c.loop?QU(x,w+1):x.slice(w+1)}setTimeout(()=>gO(x))}})})})});mO.displayName=pO;var GU={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function JU(t,e){return e!=="rtl"?t:t==="ArrowLeft"?"ArrowRight":t==="ArrowRight"?"ArrowLeft":t}function YU(t,e,n){const r=JU(t.key,n);if(!(e==="vertical"&&["ArrowLeft","ArrowRight"].includes(r))&&!(e==="horizontal"&&["ArrowUp","ArrowDown"].includes(r)))return GU[r]}function gO(t,e=!1){const n=document.activeElement;for(const r of t)if(r===n||(r.focus({preventScroll:e}),document.activeElement!==n))return}function QU(t,e){return t.map((n,r)=>t[(e+r)%t.length])}var XU=hO,ZU=mO,rv=["Enter"," "],e7=["ArrowDown","PageUp","Home"],yO=["ArrowUp","PageDown","End"],t7=[...e7,...yO],n7={ltr:[...rv,"ArrowRight"],rtl:[...rv,"ArrowLeft"]},r7={ltr:["ArrowLeft"],rtl:["ArrowRight"]},qu="Menu",[gu,i7,o7]=gp(qu),[Ks,vO]=yi(qu,[o7,zl,fO]),Sp=zl(),xO=fO(),[s7,qs]=Ks(qu),[a7,Gu]=Ks(qu),wO=t=>{const{__scopeMenu:e,open:n=!1,children:r,dir:i,onOpenChange:o,modal:s=!0}=t,a=Sp(e),[l,c]=g.useState(null),u=g.useRef(!1),d=Pt(o),h=px(i);return g.useEffect(()=>{const p=()=>{u.current=!0,document.addEventListener("pointerdown",m,{capture:!0,once:!0}),document.addEventListener("pointermove",m,{capture:!0,once:!0})},m=()=>u.current=!1;return document.addEventListener("keydown",p,{capture:!0}),()=>{document.removeEventListener("keydown",p,{capture:!0}),document.removeEventListener("pointerdown",m,{capture:!0}),document.removeEventListener("pointermove",m,{capture:!0})}},[]),f.jsx(kx,{...a,children:f.jsx(s7,{scope:e,open:n,onOpenChange:d,content:l,onContentChange:c,children:f.jsx(a7,{scope:e,onClose:g.useCallback(()=>d(!1),[d]),isUsingKeyboardRef:u,dir:h,modal:s,children:r})})})};wO.displayName=qu;var l7="MenuAnchor",_x=g.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t,i=Sp(n);return f.jsx(wp,{...i,...r,ref:e})});_x.displayName=l7;var Rx="MenuPortal",[c7,bO]=Ks(Rx,{forceMount:void 0}),SO=t=>{const{__scopeMenu:e,forceMount:n,children:r,container:i}=t,o=qs(Rx,e);return f.jsx(c7,{scope:e,forceMount:n,children:f.jsx(yr,{present:n||o.open,children:f.jsx($l,{asChild:!0,container:i,children:r})})})};SO.displayName=Rx;var zn="MenuContent",[u7,Ox]=Ks(zn),CO=g.forwardRef((t,e)=>{const n=bO(zn,t.__scopeMenu),{forceMount:r=n.forceMount,...i}=t,o=qs(zn,t.__scopeMenu),s=Gu(zn,t.__scopeMenu);return f.jsx(gu.Provider,{scope:t.__scopeMenu,children:f.jsx(yr,{present:r||o.open,children:f.jsx(gu.Slot,{scope:t.__scopeMenu,children:s.modal?f.jsx(d7,{...i,ref:e}):f.jsx(f7,{...i,ref:e})})})})}),d7=g.forwardRef((t,e)=>{const n=qs(zn,t.__scopeMenu),r=g.useRef(null),i=Se(e,r);return g.useEffect(()=>{const o=r.current;if(o)return pp(o)},[]),f.jsx(Px,{...t,ref:i,trapFocus:n.open,disableOutsidePointerEvents:n.open,disableOutsideScroll:!0,onFocusOutside:H(t.onFocusOutside,o=>o.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>n.onOpenChange(!1)})}),f7=g.forwardRef((t,e)=>{const n=qs(zn,t.__scopeMenu);return f.jsx(Px,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>n.onOpenChange(!1)})}),Px=g.forwardRef((t,e)=>{const{__scopeMenu:n,loop:r=!1,trapFocus:i,onOpenAutoFocus:o,onCloseAutoFocus:s,disableOutsidePointerEvents:a,onEntryFocus:l,onEscapeKeyDown:c,onPointerDownOutside:u,onFocusOutside:d,onInteractOutside:h,onDismiss:p,disableOutsideScroll:m,...y}=t,v=qs(zn,n),x=Gu(zn,n),w=Sp(n),b=xO(n),S=i7(n),[C,k]=g.useState(null),E=g.useRef(null),T=Se(e,E,v.onContentChange),O=g.useRef(0),_=g.useRef(""),D=g.useRef(0),L=g.useRef(null),N=g.useRef("right"),P=g.useRef(0),V=m?hp:g.Fragment,I=m?{as:Ro,allowPinchZoom:!0}:void 0,F=A=>{var J,ue;const $=_.current+A,G=S().filter(ye=>!ye.disabled),ee=document.activeElement,q=(J=G.find(ye=>ye.ref.current===ee))==null?void 0:J.textValue,Z=G.map(ye=>ye.textValue),be=k7(Z,$,q),ge=(ue=G.find(ye=>ye.textValue===be))==null?void 0:ue.ref.current;(function ye(de){_.current=de,window.clearTimeout(O.current),de!==""&&(O.current=window.setTimeout(()=>ye(""),1e3))})($),ge&&setTimeout(()=>ge.focus())};g.useEffect(()=>()=>window.clearTimeout(O.current),[]),dp();const M=g.useCallback(A=>{var G,ee;return N.current===((G=L.current)==null?void 0:G.side)&&T7(A,(ee=L.current)==null?void 0:ee.area)},[]);return f.jsx(u7,{scope:n,searchRef:_,onItemEnter:g.useCallback(A=>{M(A)&&A.preventDefault()},[M]),onItemLeave:g.useCallback(A=>{var $;M(A)||(($=E.current)==null||$.focus(),k(null))},[M]),onTriggerLeave:g.useCallback(A=>{M(A)&&A.preventDefault()},[M]),pointerGraceTimerRef:D,onPointerGraceIntentChange:g.useCallback(A=>{L.current=A},[]),children:f.jsx(V,{...I,children:f.jsx(Wu,{asChild:!0,trapped:i,onMountAutoFocus:H(o,A=>{var $;A.preventDefault(),($=E.current)==null||$.focus({preventScroll:!0})}),onUnmountAutoFocus:s,children:f.jsx(Ll,{asChild:!0,disableOutsidePointerEvents:a,onEscapeKeyDown:c,onPointerDownOutside:u,onFocusOutside:d,onInteractOutside:h,onDismiss:p,children:f.jsx(XU,{asChild:!0,...b,dir:x.dir,orientation:"vertical",loop:r,currentTabStopId:C,onCurrentTabStopIdChange:k,onEntryFocus:H(l,A=>{x.isUsingKeyboardRef.current||A.preventDefault()}),preventScrollOnEntryFocus:!0,children:f.jsx(Ex,{role:"menu","aria-orientation":"vertical","data-state":FO(v.open),"data-radix-menu-content":"",dir:x.dir,...w,...y,ref:T,style:{outline:"none",...y.style},onKeyDown:H(y.onKeyDown,A=>{const G=A.target.closest("[data-radix-menu-content]")===A.currentTarget,ee=A.ctrlKey||A.altKey||A.metaKey,q=A.key.length===1;G&&(A.key==="Tab"&&A.preventDefault(),!ee&&q&&F(A.key));const Z=E.current;if(A.target!==Z||!t7.includes(A.key))return;A.preventDefault();const ge=S().filter(J=>!J.disabled).map(J=>J.ref.current);yO.includes(A.key)&&ge.reverse(),S7(ge)}),onBlur:H(t.onBlur,A=>{A.currentTarget.contains(A.target)||(window.clearTimeout(O.current),_.current="")}),onPointerMove:H(t.onPointerMove,yu(A=>{const $=A.target,G=P.current!==A.clientX;if(A.currentTarget.contains($)&&G){const ee=A.clientX>P.current?"right":"left";N.current=ee,P.current=A.clientX}}))})})})})})})});CO.displayName=zn;var h7="MenuGroup",Mx=g.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t;return f.jsx(se.div,{role:"group",...r,ref:e})});Mx.displayName=h7;var p7="MenuLabel",kO=g.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t;return f.jsx(se.div,{...r,ref:e})});kO.displayName=p7;var xh="MenuItem",_S="menu.itemSelect",Cp=g.forwardRef((t,e)=>{const{disabled:n=!1,onSelect:r,...i}=t,o=g.useRef(null),s=Gu(xh,t.__scopeMenu),a=Ox(xh,t.__scopeMenu),l=Se(e,o),c=g.useRef(!1),u=()=>{const d=o.current;if(!n&&d){const h=new CustomEvent(_S,{bubbles:!0,cancelable:!0});d.addEventListener(_S,p=>r==null?void 0:r(p),{once:!0}),cx(d,h),h.defaultPrevented?c.current=!1:s.onClose()}};return f.jsx(EO,{...i,ref:l,disabled:n,onClick:H(t.onClick,u),onPointerDown:d=>{var h;(h=t.onPointerDown)==null||h.call(t,d),c.current=!0},onPointerUp:H(t.onPointerUp,d=>{var h;c.current||(h=d.currentTarget)==null||h.click()}),onKeyDown:H(t.onKeyDown,d=>{const h=a.searchRef.current!=="";n||h&&d.key===" "||rv.includes(d.key)&&(d.currentTarget.click(),d.preventDefault())})})});Cp.displayName=xh;var EO=g.forwardRef((t,e)=>{const{__scopeMenu:n,disabled:r=!1,textValue:i,...o}=t,s=Ox(xh,n),a=xO(n),l=g.useRef(null),c=Se(e,l),[u,d]=g.useState(!1),[h,p]=g.useState("");return g.useEffect(()=>{const m=l.current;m&&p((m.textContent??"").trim())},[o.children]),f.jsx(gu.ItemSlot,{scope:n,disabled:r,textValue:i??h,children:f.jsx(ZU,{asChild:!0,...a,focusable:!r,children:f.jsx(se.div,{role:"menuitem","data-highlighted":u?"":void 0,"aria-disabled":r||void 0,"data-disabled":r?"":void 0,...o,ref:c,onPointerMove:H(t.onPointerMove,yu(m=>{r?s.onItemLeave(m):(s.onItemEnter(m),m.defaultPrevented||m.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:H(t.onPointerLeave,yu(m=>s.onItemLeave(m))),onFocus:H(t.onFocus,()=>d(!0)),onBlur:H(t.onBlur,()=>d(!1))})})})}),m7="MenuCheckboxItem",TO=g.forwardRef((t,e)=>{const{checked:n=!1,onCheckedChange:r,...i}=t;return f.jsx(MO,{scope:t.__scopeMenu,checked:n,children:f.jsx(Cp,{role:"menuitemcheckbox","aria-checked":wh(n)?"mixed":n,...i,ref:e,"data-state":Ax(n),onSelect:H(i.onSelect,()=>r==null?void 0:r(wh(n)?!0:!n),{checkForDefaultPrevented:!1})})})});TO.displayName=m7;var _O="MenuRadioGroup",[g7,y7]=Ks(_O,{value:void 0,onValueChange:()=>{}}),RO=g.forwardRef((t,e)=>{const{value:n,onValueChange:r,...i}=t,o=Pt(r);return f.jsx(g7,{scope:t.__scopeMenu,value:n,onValueChange:o,children:f.jsx(Mx,{...i,ref:e})})});RO.displayName=_O;var OO="MenuRadioItem",PO=g.forwardRef((t,e)=>{const{value:n,...r}=t,i=y7(OO,t.__scopeMenu),o=n===i.value;return f.jsx(MO,{scope:t.__scopeMenu,checked:o,children:f.jsx(Cp,{role:"menuitemradio","aria-checked":o,...r,ref:e,"data-state":Ax(o),onSelect:H(r.onSelect,()=>{var s;return(s=i.onValueChange)==null?void 0:s.call(i,n)},{checkForDefaultPrevented:!1})})})});PO.displayName=OO;var Ix="MenuItemIndicator",[MO,v7]=Ks(Ix,{checked:!1}),IO=g.forwardRef((t,e)=>{const{__scopeMenu:n,forceMount:r,...i}=t,o=v7(Ix,n);return f.jsx(yr,{present:r||wh(o.checked)||o.checked===!0,children:f.jsx(se.span,{...i,ref:e,"data-state":Ax(o.checked)})})});IO.displayName=Ix;var x7="MenuSeparator",AO=g.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t;return f.jsx(se.div,{role:"separator","aria-orientation":"horizontal",...r,ref:e})});AO.displayName=x7;var w7="MenuArrow",NO=g.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t,i=Sp(n);return f.jsx(Tx,{...i,...r,ref:e})});NO.displayName=w7;var b7="MenuSub",[FW,DO]=Ks(b7),hc="MenuSubTrigger",jO=g.forwardRef((t,e)=>{const n=qs(hc,t.__scopeMenu),r=Gu(hc,t.__scopeMenu),i=DO(hc,t.__scopeMenu),o=Ox(hc,t.__scopeMenu),s=g.useRef(null),{pointerGraceTimerRef:a,onPointerGraceIntentChange:l}=o,c={__scopeMenu:t.__scopeMenu},u=g.useCallback(()=>{s.current&&window.clearTimeout(s.current),s.current=null},[]);return g.useEffect(()=>u,[u]),g.useEffect(()=>{const d=a.current;return()=>{window.clearTimeout(d),l(null)}},[a,l]),f.jsx(_x,{asChild:!0,...c,children:f.jsx(EO,{id:i.triggerId,"aria-haspopup":"menu","aria-expanded":n.open,"aria-controls":i.contentId,"data-state":FO(n.open),...t,ref:up(e,i.onTriggerChange),onClick:d=>{var h;(h=t.onClick)==null||h.call(t,d),!(t.disabled||d.defaultPrevented)&&(d.currentTarget.focus(),n.open||n.onOpenChange(!0))},onPointerMove:H(t.onPointerMove,yu(d=>{o.onItemEnter(d),!d.defaultPrevented&&!t.disabled&&!n.open&&!s.current&&(o.onPointerGraceIntentChange(null),s.current=window.setTimeout(()=>{n.onOpenChange(!0),u()},100))})),onPointerLeave:H(t.onPointerLeave,yu(d=>{var p,m;u();const h=(p=n.content)==null?void 0:p.getBoundingClientRect();if(h){const y=(m=n.content)==null?void 0:m.dataset.side,v=y==="right",x=v?-5:5,w=h[v?"left":"right"],b=h[v?"right":"left"];o.onPointerGraceIntentChange({area:[{x:d.clientX+x,y:d.clientY},{x:w,y:h.top},{x:b,y:h.top},{x:b,y:h.bottom},{x:w,y:h.bottom}],side:y}),window.clearTimeout(a.current),a.current=window.setTimeout(()=>o.onPointerGraceIntentChange(null),300)}else{if(o.onTriggerLeave(d),d.defaultPrevented)return;o.onPointerGraceIntentChange(null)}})),onKeyDown:H(t.onKeyDown,d=>{var p;const h=o.searchRef.current!=="";t.disabled||h&&d.key===" "||n7[r.dir].includes(d.key)&&(n.onOpenChange(!0),(p=n.content)==null||p.focus(),d.preventDefault())})})})});jO.displayName=hc;var LO="MenuSubContent",$O=g.forwardRef((t,e)=>{const n=bO(zn,t.__scopeMenu),{forceMount:r=n.forceMount,...i}=t,o=qs(zn,t.__scopeMenu),s=Gu(zn,t.__scopeMenu),a=DO(LO,t.__scopeMenu),l=g.useRef(null),c=Se(e,l);return f.jsx(gu.Provider,{scope:t.__scopeMenu,children:f.jsx(yr,{present:r||o.open,children:f.jsx(gu.Slot,{scope:t.__scopeMenu,children:f.jsx(Px,{id:a.contentId,"aria-labelledby":a.triggerId,...i,ref:c,align:"start",side:s.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:u=>{var d;s.isUsingKeyboardRef.current&&((d=l.current)==null||d.focus()),u.preventDefault()},onCloseAutoFocus:u=>u.preventDefault(),onFocusOutside:H(t.onFocusOutside,u=>{u.target!==a.trigger&&o.onOpenChange(!1)}),onEscapeKeyDown:H(t.onEscapeKeyDown,u=>{s.onClose(),u.preventDefault()}),onKeyDown:H(t.onKeyDown,u=>{var p;const d=u.currentTarget.contains(u.target),h=r7[s.dir].includes(u.key);d&&h&&(o.onOpenChange(!1),(p=a.trigger)==null||p.focus(),u.preventDefault())})})})})})});$O.displayName=LO;function FO(t){return t?"open":"closed"}function wh(t){return t==="indeterminate"}function Ax(t){return wh(t)?"indeterminate":t?"checked":"unchecked"}function S7(t){const e=document.activeElement;for(const n of t)if(n===e||(n.focus(),document.activeElement!==e))return}function C7(t,e){return t.map((n,r)=>t[(e+r)%t.length])}function k7(t,e,n){const i=e.length>1&&Array.from(e).every(c=>c===e[0])?e[0]:e,o=n?t.indexOf(n):-1;let s=C7(t,Math.max(o,0));i.length===1&&(s=s.filter(c=>c!==n));const l=s.find(c=>c.toLowerCase().startsWith(i.toLowerCase()));return l!==n?l:void 0}function E7(t,e){const{x:n,y:r}=t;let i=!1;for(let o=0,s=e.length-1;o<e.length;s=o++){const a=e[o].x,l=e[o].y,c=e[s].x,u=e[s].y;l>r!=u>r&&n<(c-a)*(r-l)/(u-l)+a&&(i=!i)}return i}function T7(t,e){if(!e)return!1;const n={x:t.clientX,y:t.clientY};return E7(n,e)}function yu(t){return e=>e.pointerType==="mouse"?t(e):void 0}var _7=wO,R7=_x,O7=SO,P7=CO,M7=Mx,I7=kO,A7=Cp,N7=TO,D7=RO,j7=PO,L7=IO,$7=AO,F7=NO,B7=jO,z7=$O,Nx="DropdownMenu",[V7,BW]=yi(Nx,[vO]),Jt=vO(),[U7,BO]=V7(Nx),zO=t=>{const{__scopeDropdownMenu:e,children:n,dir:r,open:i,defaultOpen:o,onOpenChange:s,modal:a=!0}=t,l=Jt(e),c=g.useRef(null),[u=!1,d]=js({prop:i,defaultProp:o,onChange:s});return f.jsx(U7,{scope:e,triggerId:jr(),triggerRef:c,contentId:jr(),open:u,onOpenChange:d,onOpenToggle:g.useCallback(()=>d(h=>!h),[d]),modal:a,children:f.jsx(_7,{...l,open:u,onOpenChange:d,dir:r,modal:a,children:n})})};zO.displayName=Nx;var VO="DropdownMenuTrigger",UO=g.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,disabled:r=!1,...i}=t,o=BO(VO,n),s=Jt(n);return f.jsx(R7,{asChild:!0,...s,children:f.jsx(se.button,{type:"button",id:o.triggerId,"aria-haspopup":"menu","aria-expanded":o.open,"aria-controls":o.open?o.contentId:void 0,"data-state":o.open?"open":"closed","data-disabled":r?"":void 0,disabled:r,...i,ref:up(e,o.triggerRef),onPointerDown:H(t.onPointerDown,a=>{!r&&a.button===0&&a.ctrlKey===!1&&(o.onOpenToggle(),o.open||a.preventDefault())}),onKeyDown:H(t.onKeyDown,a=>{r||(["Enter"," "].includes(a.key)&&o.onOpenToggle(),a.key==="ArrowDown"&&o.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(a.key)&&a.preventDefault())})})})});UO.displayName=VO;var H7="DropdownMenuPortal",HO=t=>{const{__scopeDropdownMenu:e,...n}=t,r=Jt(e);return f.jsx(O7,{...r,...n})};HO.displayName=H7;var WO="DropdownMenuContent",KO=g.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,i=BO(WO,n),o=Jt(n),s=g.useRef(!1);return f.jsx(P7,{id:i.contentId,"aria-labelledby":i.triggerId,...o,...r,ref:e,onCloseAutoFocus:H(t.onCloseAutoFocus,a=>{var l;s.current||(l=i.triggerRef.current)==null||l.focus(),s.current=!1,a.preventDefault()}),onInteractOutside:H(t.onInteractOutside,a=>{const l=a.detail.originalEvent,c=l.button===0&&l.ctrlKey===!0,u=l.button===2||c;(!i.modal||u)&&(s.current=!0)}),style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});KO.displayName=WO;var W7="DropdownMenuGroup",K7=g.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,i=Jt(n);return f.jsx(M7,{...i,...r,ref:e})});K7.displayName=W7;var q7="DropdownMenuLabel",G7=g.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,i=Jt(n);return f.jsx(I7,{...i,...r,ref:e})});G7.displayName=q7;var J7="DropdownMenuItem",qO=g.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,i=Jt(n);return f.jsx(A7,{...i,...r,ref:e})});qO.displayName=J7;var Y7="DropdownMenuCheckboxItem",Q7=g.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,i=Jt(n);return f.jsx(N7,{...i,...r,ref:e})});Q7.displayName=Y7;var X7="DropdownMenuRadioGroup",Z7=g.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,i=Jt(n);return f.jsx(D7,{...i,...r,ref:e})});Z7.displayName=X7;var eH="DropdownMenuRadioItem",tH=g.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,i=Jt(n);return f.jsx(j7,{...i,...r,ref:e})});tH.displayName=eH;var nH="DropdownMenuItemIndicator",rH=g.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,i=Jt(n);return f.jsx(L7,{...i,...r,ref:e})});rH.displayName=nH;var iH="DropdownMenuSeparator",GO=g.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,i=Jt(n);return f.jsx($7,{...i,...r,ref:e})});GO.displayName=iH;var oH="DropdownMenuArrow",sH=g.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,i=Jt(n);return f.jsx(F7,{...i,...r,ref:e})});sH.displayName=oH;var aH="DropdownMenuSubTrigger",lH=g.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,i=Jt(n);return f.jsx(B7,{...i,...r,ref:e})});lH.displayName=aH;var cH="DropdownMenuSubContent",uH=g.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,i=Jt(n);return f.jsx(z7,{...i,...r,ref:e,style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});uH.displayName=cH;var Sl=zO,Cl=UO,kl=HO,El=KO,tn=qO,RS=GO,dH="VisuallyHidden",kp=g.forwardRef((t,e)=>f.jsx(se.span,{...t,ref:e,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...t.style}}));kp.displayName=dH;var Dx="ToastProvider",[jx,fH,hH]=gp("Toast"),[JO,zW]=yi("Toast",[hH]),[pH,Ep]=JO(Dx),YO=t=>{const{__scopeToast:e,label:n="Notification",duration:r=5e3,swipeDirection:i="right",swipeThreshold:o=50,children:s}=t,[a,l]=g.useState(null),[c,u]=g.useState(0),d=g.useRef(!1),h=g.useRef(!1);return n.trim()||console.error(`Invalid prop \`label\` supplied to \`${Dx}\`. Expected non-empty \`string\`.`),f.jsx(jx.Provider,{scope:e,children:f.jsx(pH,{scope:e,label:n,duration:r,swipeDirection:i,swipeThreshold:o,toastCount:c,viewport:a,onViewportChange:l,onToastAdd:g.useCallback(()=>u(p=>p+1),[]),onToastRemove:g.useCallback(()=>u(p=>p-1),[]),isFocusedToastEscapeKeyDownRef:d,isClosePausedRef:h,children:s})})};YO.displayName=Dx;var QO="ToastViewport",mH=["F8"],iv="toast.viewportPause",ov="toast.viewportResume",XO=g.forwardRef((t,e)=>{const{__scopeToast:n,hotkey:r=mH,label:i="Notifications ({hotkey})",...o}=t,s=Ep(QO,n),a=fH(n),l=g.useRef(null),c=g.useRef(null),u=g.useRef(null),d=g.useRef(null),h=Se(e,d,s.onViewportChange),p=r.join("+").replace(/Key/g,"").replace(/Digit/g,""),m=s.toastCount>0;g.useEffect(()=>{const v=x=>{var b;r.length!==0&&r.every(S=>x[S]||x.code===S)&&((b=d.current)==null||b.focus())};return document.addEventListener("keydown",v),()=>document.removeEventListener("keydown",v)},[r]),g.useEffect(()=>{const v=l.current,x=d.current;if(m&&v&&x){const w=()=>{if(!s.isClosePausedRef.current){const k=new CustomEvent(iv);x.dispatchEvent(k),s.isClosePausedRef.current=!0}},b=()=>{if(s.isClosePausedRef.current){const k=new CustomEvent(ov);x.dispatchEvent(k),s.isClosePausedRef.current=!1}},S=k=>{!v.contains(k.relatedTarget)&&b()},C=()=>{v.contains(document.activeElement)||b()};return v.addEventListener("focusin",w),v.addEventListener("focusout",S),v.addEventListener("pointermove",w),v.addEventListener("pointerleave",C),window.addEventListener("blur",w),window.addEventListener("focus",b),()=>{v.removeEventListener("focusin",w),v.removeEventListener("focusout",S),v.removeEventListener("pointermove",w),v.removeEventListener("pointerleave",C),window.removeEventListener("blur",w),window.removeEventListener("focus",b)}}},[m,s.isClosePausedRef]);const y=g.useCallback(({tabbingDirection:v})=>{const w=a().map(b=>{const S=b.ref.current,C=[S,...OH(S)];return v==="forwards"?C:C.reverse()});return(v==="forwards"?w.reverse():w).flat()},[a]);return g.useEffect(()=>{const v=d.current;if(v){const x=w=>{var C,k,E;const b=w.altKey||w.ctrlKey||w.metaKey;if(w.key==="Tab"&&!b){const T=document.activeElement,O=w.shiftKey;if(w.target===v&&O){(C=c.current)==null||C.focus();return}const L=y({tabbingDirection:O?"backwards":"forwards"}),N=L.findIndex(P=>P===T);Xm(L.slice(N+1))?w.preventDefault():O?(k=c.current)==null||k.focus():(E=u.current)==null||E.focus()}};return v.addEventListener("keydown",x),()=>v.removeEventListener("keydown",x)}},[a,y]),f.jsxs(zz,{ref:l,role:"region","aria-label":i.replace("{hotkey}",p),tabIndex:-1,style:{pointerEvents:m?void 0:"none"},children:[m&&f.jsx(sv,{ref:c,onFocusFromOutsideViewport:()=>{const v=y({tabbingDirection:"forwards"});Xm(v)}}),f.jsx(jx.Slot,{scope:n,children:f.jsx(se.ol,{tabIndex:-1,...o,ref:h})}),m&&f.jsx(sv,{ref:u,onFocusFromOutsideViewport:()=>{const v=y({tabbingDirection:"backwards"});Xm(v)}})]})});XO.displayName=QO;var ZO="ToastFocusProxy",sv=g.forwardRef((t,e)=>{const{__scopeToast:n,onFocusFromOutsideViewport:r,...i}=t,o=Ep(ZO,n);return f.jsx(kp,{"aria-hidden":!0,tabIndex:0,...i,ref:e,style:{position:"fixed"},onFocus:s=>{var c;const a=s.relatedTarget;!((c=o.viewport)!=null&&c.contains(a))&&r()}})});sv.displayName=ZO;var Tp="Toast",gH="toast.swipeStart",yH="toast.swipeMove",vH="toast.swipeCancel",xH="toast.swipeEnd",eP=g.forwardRef((t,e)=>{const{forceMount:n,open:r,defaultOpen:i,onOpenChange:o,...s}=t,[a=!0,l]=js({prop:r,defaultProp:i,onChange:o});return f.jsx(yr,{present:n||a,children:f.jsx(SH,{open:a,...s,ref:e,onClose:()=>l(!1),onPause:Pt(t.onPause),onResume:Pt(t.onResume),onSwipeStart:H(t.onSwipeStart,c=>{c.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:H(t.onSwipeMove,c=>{const{x:u,y:d}=c.detail.delta;c.currentTarget.setAttribute("data-swipe","move"),c.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${u}px`),c.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${d}px`)}),onSwipeCancel:H(t.onSwipeCancel,c=>{c.currentTarget.setAttribute("data-swipe","cancel"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),c.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),c.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:H(t.onSwipeEnd,c=>{const{x:u,y:d}=c.detail.delta;c.currentTarget.setAttribute("data-swipe","end"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),c.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${u}px`),c.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${d}px`),l(!1)})})})});eP.displayName=Tp;var[wH,bH]=JO(Tp,{onClose(){}}),SH=g.forwardRef((t,e)=>{const{__scopeToast:n,type:r="foreground",duration:i,open:o,onClose:s,onEscapeKeyDown:a,onPause:l,onResume:c,onSwipeStart:u,onSwipeMove:d,onSwipeCancel:h,onSwipeEnd:p,...m}=t,y=Ep(Tp,n),[v,x]=g.useState(null),w=Se(e,P=>x(P)),b=g.useRef(null),S=g.useRef(null),C=i||y.duration,k=g.useRef(0),E=g.useRef(C),T=g.useRef(0),{onToastAdd:O,onToastRemove:_}=y,D=Pt(()=>{var V;(v==null?void 0:v.contains(document.activeElement))&&((V=y.viewport)==null||V.focus()),s()}),L=g.useCallback(P=>{!P||P===1/0||(window.clearTimeout(T.current),k.current=new Date().getTime(),T.current=window.setTimeout(D,P))},[D]);g.useEffect(()=>{const P=y.viewport;if(P){const V=()=>{L(E.current),c==null||c()},I=()=>{const F=new Date().getTime()-k.current;E.current=E.current-F,window.clearTimeout(T.current),l==null||l()};return P.addEventListener(iv,I),P.addEventListener(ov,V),()=>{P.removeEventListener(iv,I),P.removeEventListener(ov,V)}}},[y.viewport,C,l,c,L]),g.useEffect(()=>{o&&!y.isClosePausedRef.current&&L(C)},[o,C,y.isClosePausedRef,L]),g.useEffect(()=>(O(),()=>_()),[O,_]);const N=g.useMemo(()=>v?sP(v):null,[v]);return y.viewport?f.jsxs(f.Fragment,{children:[N&&f.jsx(CH,{__scopeToast:n,role:"status","aria-live":r==="foreground"?"assertive":"polite","aria-atomic":!0,children:N}),f.jsx(wH,{scope:n,onClose:D,children:Vs.createPortal(f.jsx(jx.ItemSlot,{scope:n,children:f.jsx(Bz,{asChild:!0,onEscapeKeyDown:H(a,()=>{y.isFocusedToastEscapeKeyDownRef.current||D(),y.isFocusedToastEscapeKeyDownRef.current=!1}),children:f.jsx(se.li,{role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":o?"open":"closed","data-swipe-direction":y.swipeDirection,...m,ref:w,style:{userSelect:"none",touchAction:"none",...t.style},onKeyDown:H(t.onKeyDown,P=>{P.key==="Escape"&&(a==null||a(P.nativeEvent),P.nativeEvent.defaultPrevented||(y.isFocusedToastEscapeKeyDownRef.current=!0,D()))}),onPointerDown:H(t.onPointerDown,P=>{P.button===0&&(b.current={x:P.clientX,y:P.clientY})}),onPointerMove:H(t.onPointerMove,P=>{if(!b.current)return;const V=P.clientX-b.current.x,I=P.clientY-b.current.y,F=!!S.current,M=["left","right"].includes(y.swipeDirection),A=["left","up"].includes(y.swipeDirection)?Math.min:Math.max,$=M?A(0,V):0,G=M?0:A(0,I),ee=P.pointerType==="touch"?10:2,q={x:$,y:G},Z={originalEvent:P,delta:q};F?(S.current=q,Ud(yH,d,Z,{discrete:!1})):OS(q,y.swipeDirection,ee)?(S.current=q,Ud(gH,u,Z,{discrete:!1}),P.target.setPointerCapture(P.pointerId)):(Math.abs(V)>ee||Math.abs(I)>ee)&&(b.current=null)}),onPointerUp:H(t.onPointerUp,P=>{const V=S.current,I=P.target;if(I.hasPointerCapture(P.pointerId)&&I.releasePointerCapture(P.pointerId),S.current=null,b.current=null,V){const F=P.currentTarget,M={originalEvent:P,delta:V};OS(V,y.swipeDirection,y.swipeThreshold)?Ud(xH,p,M,{discrete:!0}):Ud(vH,h,M,{discrete:!0}),F.addEventListener("click",A=>A.preventDefault(),{once:!0})}})})})}),y.viewport)})]}):null}),CH=t=>{const{__scopeToast:e,children:n,...r}=t,i=Ep(Tp,e),[o,s]=g.useState(!1),[a,l]=g.useState(!1);return _H(()=>s(!0)),g.useEffect(()=>{const c=window.setTimeout(()=>l(!0),1e3);return()=>window.clearTimeout(c)},[]),a?null:f.jsx($l,{asChild:!0,children:f.jsx(kp,{...r,children:o&&f.jsxs(f.Fragment,{children:[i.label," ",n]})})})},kH="ToastTitle",tP=g.forwardRef((t,e)=>{const{__scopeToast:n,...r}=t;return f.jsx(se.div,{...r,ref:e})});tP.displayName=kH;var EH="ToastDescription",nP=g.forwardRef((t,e)=>{const{__scopeToast:n,...r}=t;return f.jsx(se.div,{...r,ref:e})});nP.displayName=EH;var rP="ToastAction",TH=g.forwardRef((t,e)=>{const{altText:n,...r}=t;return n.trim()?f.jsx(oP,{altText:n,asChild:!0,children:f.jsx(Lx,{...r,ref:e})}):(console.error(`Invalid prop \`altText\` supplied to \`${rP}\`. Expected non-empty \`string\`.`),null)});TH.displayName=rP;var iP="ToastClose",Lx=g.forwardRef((t,e)=>{const{__scopeToast:n,...r}=t,i=bH(iP,n);return f.jsx(oP,{asChild:!0,children:f.jsx(se.button,{type:"button",...r,ref:e,onClick:H(t.onClick,i.onClose)})})});Lx.displayName=iP;var oP=g.forwardRef((t,e)=>{const{__scopeToast:n,altText:r,...i}=t;return f.jsx(se.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":r||void 0,...i,ref:e})});function sP(t){const e=[];return Array.from(t.childNodes).forEach(r=>{if(r.nodeType===r.TEXT_NODE&&r.textContent&&e.push(r.textContent),RH(r)){const i=r.ariaHidden||r.hidden||r.style.display==="none",o=r.dataset.radixToastAnnounceExclude==="";if(!i)if(o){const s=r.dataset.radixToastAnnounceAlt;s&&e.push(s)}else e.push(...sP(r))}}),e}function Ud(t,e,n,{discrete:r}){const i=n.originalEvent.currentTarget,o=new CustomEvent(t,{bubbles:!0,cancelable:!0,detail:n});e&&i.addEventListener(t,e,{once:!0}),r?cx(i,o):i.dispatchEvent(o)}var OS=(t,e,n=0)=>{const r=Math.abs(t.x),i=Math.abs(t.y),o=r>i;return e==="left"||e==="right"?o&&r>n:!o&&i>n};function _H(t=()=>{}){const e=Pt(t);Ot(()=>{let n=0,r=0;return n=window.requestAnimationFrame(()=>r=window.requestAnimationFrame(e)),()=>{window.cancelAnimationFrame(n),window.cancelAnimationFrame(r)}},[e])}function RH(t){return t.nodeType===t.ELEMENT_NODE}function OH(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const i=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||i?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function Xm(t){const e=document.activeElement;return t.some(n=>n===e?!0:(n.focus(),document.activeElement!==e))}var PH=YO,MH=XO,IH=eP,AH=tP,NH=nP,DH=Lx;const jH=`
  .toast-close-button {
    all: unset;
    cursor: pointer;
    color: #9CA3AF;
    flex-shrink: 0;
    padding: 2px;
    border-radius: 4px;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s ease;
  }
  
  .toast-close-button:hover {
    background-color: #F3F4F6;
    color: #6B7280;
  }

  @keyframes slideIn {
    from {
      transform: translateY(100%);
      opacity: 0;
    }
    to {
      transform: translateY(0);
      opacity: 1;
    }
  }

  @keyframes slideOut {
    from {
      transform: translateY(0);
      opacity: 1;
    }
    to {
      transform: translateY(100%);
      opacity: 0;
    }
  }

  .toast-root[data-state='open'] {
    animation: slideIn 300ms cubic-bezier(0.16, 1, 0.3, 1);
  }

  .toast-root[data-state='closed'] {
    animation: slideOut 300ms cubic-bezier(0.16, 1, 0.3, 1);
  }
`,aa={viewport:{position:"fixed",bottom:"32px",left:"50%",transform:"translateX(-50%)",display:"flex",flexDirection:"column",padding:"25px",gap:"10px",width:"fit-content",minWidth:"300px",maxWidth:"480px",listStyle:"none",zIndex:2147483647,outline:"none"},toast:{backgroundColor:"white",borderRadius:"8px",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.15)",padding:"16px",display:"flex",alignItems:"flex-start",justifyContent:"space-between",gap:"12px",border:"1px solid #e5e7eb",width:"100%"},title:{color:"#111827",fontSize:"14px",fontWeight:600,marginBottom:"4px"},description:{color:"#6b7280",fontSize:"13px"},icon:{flexShrink:0,marginTop:"2px"}},aP=g.createContext(null);function LH({children:t}){const[e,n]=g.useState({open:!1,title:"",description:"",type:"success"}),r=(i,o,s="success")=>{n({open:!0,title:i,description:o,type:s})};return f.jsx(aP.Provider,{value:{showToast:r},children:f.jsxs(PH,{swipeDirection:"down",duration:2e3,children:[f.jsx("style",{children:jH}),t,f.jsxs(IH,{open:e.open,onOpenChange:i=>n(o=>({...o,open:i})),style:aa.toast,className:"toast-root",children:[f.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"12px",flex:1},children:[e.type==="success"?f.jsx(sV,{size:18,style:{...aa.icon,color:"#10b981"}}):f.jsx(iV,{size:18,style:{...aa.icon,color:"#ef4444"}}),f.jsxs("div",{style:{flex:1},children:[f.jsx(AH,{style:aa.title,children:e.title}),f.jsx(NH,{style:aa.description,children:e.description})]})]}),f.jsx(DH,{asChild:!0,children:f.jsx("button",{className:"toast-close-button",children:f.jsx(NV,{size:16})})})]}),f.jsx(MH,{style:aa.viewport})]})})}function lP(){const t=g.useContext(aP);if(!t)throw new Error("useToast must be used within a ToastProvider");return t}function It(){const t=Je(),e=Ur(),{data:n,isLoading:r,error:i}=Xc({queryKey:["user"],queryFn:async()=>{const o=e.getQueryData(["user"]);if(o)return o;const{data:{user:s},error:a}=await t.auth.getUser();if(a)throw a;if(!s)return null;try{const{data:l,error:c}=await t.from("user_profiles").select("*").eq("id",s.id).single();if(c){if(c.code==="PGRST116")return s;throw c}return{...s,...l}}catch{return s}},staleTime:1/0,gcTime:30*60*1e3,retry:!1,refetchOnMount:!1,refetchOnWindowFocus:!1});return g.useEffect(()=>{const{data:{subscription:o}}=t.auth.onAuthStateChange((s,a)=>{s==="SIGNED_OUT"?e.setQueryData(["user"],null):a!=null&&a.user&&e.invalidateQueries({queryKey:["user"]})});return()=>{o.unsubscribe()}},[t,e]),g.useEffect(()=>{if(!(n!=null&&n.id))return;const o=t.channel(`profile-changes-${n.id}`).on("postgres_changes",{event:"*",schema:"public",table:"user_profiles",filter:`id=eq.${n.id}`},s=>{s.new&&e.setQueryData(["user"],a=>a?{...a,name:s.new.name,specialty:s.new.specialty,note_preferences:s.new.note_preferences}:null)}).subscribe();return()=>{o.unsubscribe()}},[t,n==null?void 0:n.id,e]),{user:n,loading:r,error:(i==null?void 0:i.message)||null}}function PS(t){return typeof t=="object"&&t!==null&&"default_copy_mode"in t&&typeof t.default_copy_mode=="string"}function $H(t,e){switch(e){case"plain":return t.getText();case"rich_text":return t.getHTML();case"without_lists":return t.getText();default:return t.getText()}}const Ee={toolbar:{display:"flex",gap:"4px",alignItems:"center"},button:{padding:"8px",backgroundColor:"#f3f4f6",border:"1px solid #e5e7eb",borderRadius:"4px",cursor:"pointer",color:"#6b7280",display:"flex",alignItems:"center",justifyContent:"center",height:"36px",width:"36px",transition:"all 0.2s ease","&:hover:not(:disabled)":{backgroundColor:"#e5e7eb"},"&:disabled":{opacity:.5,cursor:"not-allowed",backgroundColor:"#f3f4f6"}},divider:{width:"1px",height:"24px",backgroundColor:"#e5e7eb",margin:"0 4px"},buttonContainer:{position:"relative"},dropdown:{position:"absolute",top:"calc(100% + 4px)",right:"0",backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"6px",padding:"4px",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)",zIndex:1e3,minWidth:"180px"},dropdownButton:{width:"100%",padding:"8px 12px",border:"none",backgroundColor:"transparent",cursor:"pointer",textAlign:"left",fontSize:"14px",color:"#6b7280",borderRadius:"4px","&:hover":{backgroundColor:"#f3f4f6"}},modal:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",backgroundColor:"white",padding:"24px",borderRadius:"8px",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1)",zIndex:100,width:"400px"},modalOverlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",zIndex:99},modalTitle:{fontSize:"18px",fontWeight:"600",color:"#111827",marginBottom:"16px"},modalText:{fontSize:"14px",color:"#4b5563",marginBottom:"24px",lineHeight:"1.5"},modalButtons:{display:"flex",gap:"8px",justifyContent:"flex-end"},modalButton:{padding:"8px 16px",borderRadius:"6px",fontSize:"14px",fontWeight:"500",cursor:"pointer",border:"1px solid #e5e7eb"},modalButtonPrimary:{backgroundColor:"#ef4444",color:"white",border:"none","&:hover":{backgroundColor:"#dc2626"}},modalButtonSecondary:{backgroundColor:"white",color:"#6b7280","&:hover":{backgroundColor:"#f3f4f6"}},copyButtonGroup:{display:"flex",alignItems:"center",gap:"1px"},copyMainButton:{padding:"8px",backgroundColor:"#f3f4f6",border:"1px solid #e5e7eb",borderRadius:"4px 0 0 4px",cursor:"pointer",color:"#6b7280",display:"flex",alignItems:"center",justifyContent:"center",height:"36px",width:"36px",transition:"all 0.2s ease","&:hover":{backgroundColor:"#e5e7eb"}},copyDropdownButton:{padding:"8px 4px",backgroundColor:"#f3f4f6",border:"1px solid #e5e7eb",borderLeft:"none",borderRadius:"0 4px 4px 0",cursor:"pointer",color:"#6b7280",display:"flex",alignItems:"center",justifyContent:"center",height:"36px",width:"24px",transition:"all 0.2s ease","&:hover":{backgroundColor:"#e5e7eb"}},dropdownContent:{minWidth:"220px",backgroundColor:"white",borderRadius:"6px",padding:"5px",boxShadow:"0px 10px 38px -10px rgba(22, 23, 24, 0.35), 0px 10px 20px -15px rgba(22, 23, 24, 0.2)",zIndex:20},dropdownItem:{fontSize:"14px",lineHeight:"1",color:"#374151",borderRadius:"3px",display:"flex",alignItems:"center",justifyContent:"space-between",height:"32px",padding:"0 8px",userSelect:"none",outline:"none",cursor:"pointer","&:hover":{backgroundColor:"#f3f4f6"}},selectedDropdownItem:{backgroundColor:"#f0f9ff",color:"#2563eb","&:hover":{backgroundColor:"#e0f2fe"}},checkmark:{color:"#2563eb",marginLeft:"8px"},toastViewport:{position:"fixed",bottom:0,right:0,display:"flex",flexDirection:"column",padding:"25px",gap:"10px",width:"390px",listStyle:"none",zIndex:2147483647,outline:"none"},toast:{backgroundColor:"white",borderRadius:"6px",boxShadow:"0 2px 10px rgba(0, 0, 0, 0.1)",padding:"15px",display:"flex",alignItems:"center",justifyContent:"space-between",border:"1px solid #e5e7eb"},toastTitle:{color:"#111827",fontSize:"14px",fontWeight:500,marginBottom:"4px"},toastDescription:{color:"#6b7280",fontSize:"13px"},successIcon:{color:"#10b981",marginRight:"12px"}};function FH({editor:t,previousVersions:e=[],onRevertToPreviousVersion:n,hasUnsavedChanges:r=!1,onSave:i,tabType:o,onRegenerateSoapNote:s,onRegenerateCurrentNote:a}){const l=Je(),{showToast:c}=lP(),{user:u}=It(),[d,h]=g.useState(!1),[p,m]=g.useState("plain");g.useEffect(()=>{u!=null&&u.note_preferences&&PS(u.note_preferences)&&m(u.note_preferences.default_copy_mode)},[u==null?void 0:u.note_preferences]);const y=(t==null?void 0:t.can().undo())||e.length>0&&!!n,v=t==null?void 0:t.can().redo(),x=async(E=p)=>{if(t)try{const T=$H(t,E);await navigator.clipboard.writeText(T),c("Copied!",`Content copied as ${E.replace(/_/g," ").toLowerCase()}`,"success")}catch(T){console.error("Failed to copy text:",T),c("Copy Failed","Failed to copy content to clipboard","error")}},w=async E=>{try{if(!(u!=null&&u.id))return;const T=u.note_preferences&&PS(u.note_preferences)?u.note_preferences:{};await l.from("user_profiles").update({note_preferences:{...T,default_copy_mode:E}}).eq("user_id",u.id),m(E),await x(E)}catch(T){console.error("Failed to update default copy mode:",T),c("Error","Failed to update copy mode","error")}},b=()=>{if(!(!t||!y)){if(t.can().undo()){t.chain().focus().undo().run();return}e.length>0&&n&&h(!0)}},S=async()=>{if(!n||e.length===0)return;const E=e[0];await n(E),h(!1)},C=()=>{r&&i&&(i(),c("Saved!","Your changes have been saved","success"))},k=[{value:"plain",label:"Copy as Plain Text"},{value:"rich_text",label:"Copy as Rich Text"},{value:"without_lists",label:"Copy Without Lists"}];return t?f.jsxs("div",{style:Ee.toolbar,children:[f.jsx("button",{onClick:b,disabled:!y,style:{...Ee.button,opacity:y?1:.5},title:t!=null&&t.can().undo()?"Undo last change":e.length>0?"Revert to previous version":"Nothing to undo",children:f.jsx(RV,{size:18})}),f.jsx("button",{onClick:()=>t.chain().focus().redo().run(),disabled:!v,style:{...Ee.button,opacity:v?1:.5},title:v?"Redo":"Nothing to redo",children:f.jsx(xV,{size:18})}),f.jsx("div",{style:Ee.divider}),f.jsx("button",{onClick:C,disabled:!r,style:{...Ee.button,...r?{backgroundColor:"#10b981",color:"white",border:"none","&:hover":{backgroundColor:"#059669"}}:{}},title:r?"Save changes":"No unsaved changes",children:f.jsx(SV,{size:18})}),f.jsx("div",{style:Ee.divider}),f.jsxs("div",{style:Ee.copyButtonGroup,children:[f.jsx("button",{onClick:()=>x(),style:Ee.copyMainButton,title:`Copy as ${p.replace(/_/g," ").toUpperCase()}`,children:f.jsx(uV,{size:18})}),f.jsxs(Sl,{children:[f.jsx(Cl,{asChild:!0,children:f.jsx("button",{style:Ee.copyDropdownButton,title:"Copy Options",children:f.jsx(UR,{size:14})})}),f.jsx(kl,{children:f.jsx(El,{style:Ee.dropdownContent,sideOffset:5,children:k.map(E=>{const T=E.value===p;return f.jsxs(tn,{style:{...Ee.dropdownItem,...T?Ee.selectedDropdownItem:{}},onClick:()=>w(E.value),children:[E.label,T&&f.jsx("span",{style:Ee.checkmark,children:"✓"})]},E.value)})})})]})]}),f.jsx("div",{style:Ee.divider}),f.jsxs(Sl,{children:[f.jsx(Cl,{asChild:!0,children:f.jsx("button",{style:Ee.button,title:"More Options",children:f.jsx(fV,{size:18})})}),f.jsx(kl,{children:f.jsxs(El,{style:Ee.dropdownContent,sideOffset:5,children:[f.jsx(tn,{style:Ee.dropdownItem,onClick:()=>x(),children:"Copy All"}),(o==="ai_context"||o==="soap")&&s&&f.jsx(tn,{style:Ee.dropdownItem,onClick:()=>{c("Regenerating","Starting SOAP note regeneration...","success"),s()},children:"Regenerate SOAP Note"}),a&&f.jsx(tn,{style:Ee.dropdownItem,onClick:()=>{c("Regenerating","Starting note regeneration...","success"),a()},children:"Regenerate Current Note"})]})})]}),d&&f.jsxs(f.Fragment,{children:[f.jsx("div",{style:Ee.modalOverlay,onClick:()=>h(!1)}),f.jsxs("div",{style:Ee.modal,children:[f.jsx("h3",{style:Ee.modalTitle,children:"Revert to Previous Version?"}),f.jsx("p",{style:Ee.modalText,children:"This will delete your current changes and restore the previous version of this note. This action cannot be undone."}),f.jsxs("div",{style:Ee.modalButtons,children:[f.jsx("button",{onClick:()=>h(!1),style:{...Ee.modalButton,...Ee.modalButtonSecondary},children:"Cancel"}),f.jsx("button",{onClick:S,style:{...Ee.modalButton,...Ee.modalButtonPrimary},children:"Revert to Previous Version"})]})]})]})]}):null}function av(t,e){const n=t.filter(r=>r.type===e);if(n.length)return n.reduce((r,i)=>(i.version_id||0)>(r.version_id||0)?i:r)}function MS(t,e){var n;return((n=av(t,e))==null?void 0:n.content)||""}function BH(t){return[...t].sort((e,n)=>(n.version_id||0)-(e.version_id||0))}function zH(t){const e={soap:[],ai_context:[]};return t.forEach(n=>{n.type==="soap"||n.type==="ai_context"?(e[n.type]||(e[n.type]=[]),e[n.type].push(n)):n.type==="template"&&n.template_id&&(e[n.template_id]||(e[n.template_id]=[]),e[n.template_id].push(n))}),Object.keys(e).forEach(n=>{e[n]=BH(e[n])}),e}function VH({visit:t,notes:e,onRevert:n,handleNoteDeleted:r}){const i=Je(),o=g.useRef(!1),{getValidSessionToken:s}=mp(),[a,l]=g.useState({noteVersions:{soap:[],ai_context:[]},hasUnsavedChanges:!1,pendingContent:null}),{soapNote:c,aiContext:u,templateNotes:d}=g.useMemo(()=>({soapNote:MS(e,"soap"),aiContext:MS(e,"ai_context"),templateNotes:e.filter(C=>C.type==="template")}),[e]);g.useEffect(()=>{const C=zH(e);console.log("[useNoteManager] Versions:",C),l(k=>({...k,noteVersions:C}))},[e]),g.useEffect(()=>{console.log("[useNoteManager] Visit changed, resetting state:",t.id),l({noteVersions:{soap:[],ai_context:[]},hasUnsavedChanges:!1,pendingContent:null})},[t.id]);const h=g.useCallback(C=>{l(k=>({...k,templateNotes:C}))},[]),p=g.useCallback(()=>{l(C=>({...C,hasUnsavedChanges:!1,pendingContent:null}))},[]),m=g.useCallback((C,k,E)=>{var O;console.log("[handleContentChange] Content:",C,k,E);const T=k==="soap"?c:k==="ai_context"?u:(O=d.find(_=>_.id===E))==null?void 0:O.content;l(_=>({..._,pendingContent:C?{content:C,type:k,noteId:E}:null,hasUnsavedChanges:C!==T}))},[c,u,d,e]),y=g.useCallback((C,k)=>{var E,T;return C==="soap"||C==="ai_context"?((E=a.noteVersions[C])==null?void 0:E[0])||null:(console.log("[getCurrentNote] Template ID:",k,a.noteVersions),((T=a.noteVersions[k||""])==null?void 0:T[0])||null)},[a.noteVersions]),v=g.useCallback((C,k)=>{var E;return C==="soap"||C==="ai_context"?((E=a.noteVersions[C])==null?void 0:E.slice(1))||[]:a.noteVersions[k||""]||[]},[a.noteVersions]),x=g.useCallback(async()=>{if(!t.id||!a.pendingContent||o.current)return!1;o.current=!0;const{content:C,type:k,noteId:E}=a.pendingContent;try{if(k==="template"&&E){const T=e.find(_=>_.id===E),O=((T==null?void 0:T.version_id)||0)+1;await i.from("notes").insert({visit_id:t.id,content:C,type:k,template_id:T==null?void 0:T.template_id,metadata:{...T==null?void 0:T.metadata,status:"edited"},version_id:O,user_facing:!0})}else{const T=e.filter(D=>D.type===k),_=(T.length>0?Math.max(...T.map(D=>D.version_id||0)):0)+1;await i.from("notes").insert({visit_id:t.id,content:C,type:k,version_id:_,user_facing:!0})}return p(),!0}catch(T){throw console.error("Error saving note:",T),T}finally{o.current=!1}},[t.id,e,a.pendingContent,i,p]),w=g.useCallback(async C=>{if(!(!t.id||o.current)){o.current=!0;try{console.log("[revertToPreviousVersion] Deleting note:",C.type,C.template_id);const k=y(C.type,C.template_id||void 0);if(k){console.log("[useNoteManager] Deleting note:",k.id);const{error:E,data:T}=await i.from("notes").delete().eq("id",k.id).select();if(E)throw console.error("[useNoteManager] Error deleting note:",E),E;console.log("[useNoteManager] Delete operation successful, deleted data:",T),r&&k.id&&(console.log("[useNoteManager] Triggering manual note deletion for:",k.id),r(k.id))}else console.log("[useNoteManager] No current note found to delete");l(E=>({...E,hasUnsavedChanges:!1,pendingContent:null})),n==null||n()}catch(k){console.error("[useNoteManager] Error reverting to previous version:",k)}finally{o.current=!1}}},[t.id,i,y,n,r]),b=g.useCallback(async()=>{var C;try{const k=await s(),E=(C=y("soap",""))==null?void 0:C.id;console.log("[regenerateSoapNote] Attempting to regenerate SOAP note with ID:",E);const T=`${$r.apiUrl}/notes/${E}/regenerate-soap`;console.log("[regenerateSoapNote] Calling endpoint:",T);const O=await fetch(T,{method:"POST",headers:{Authorization:`Bearer ${k}`,"Content-Type":"application/json"}});if(!O.ok){console.error("[regenerateSoapNote] Error response:",O.status,O.statusText);const D=await O.text();throw console.error("[regenerateSoapNote] Error details:",D),new Error(`Failed to regenerate SOAP note: ${O.status} ${O.statusText}`)}const _=await O.json();console.log("[regenerateSoapNote] Successfully regenerated note:",_.id),l(D=>({...D,hasUnsavedChanges:!1,pendingContent:{content:_.content,type:"soap"}})),n==null||n()}catch(k){console.error("Error regenerating SOAP note:",k)}},[y,n]),S=g.useCallback(async C=>{try{const k=await s(),E=`${$r.apiUrl}/notes/${C}/regenerate-template`;console.log("[regenerateTemplateNote] Calling endpoint:",E);const T=await fetch(E,{method:"POST",headers:{Authorization:`Bearer ${k}`,"Content-Type":"application/json"}});if(!T.ok)throw new Error("Failed to regenerate template note");const O=await T.json();l(_=>({..._,hasUnsavedChanges:!1,pendingContent:{content:O.content,type:"template",noteId:C}})),n==null||n()}catch(k){console.error("Error regenerating template note:",k)}},[n]);return{hasUnsavedChanges:a.hasUnsavedChanges,handleContentChange:m,saveNote:x,revertToPreviousVersion:w,getCurrentNote:y,getPreviousVersions:v,updateTemplateNotes:h,resetState:p,regenerateSoapNote:b,regenerateTemplateNote:S}}const rc={container:{display:"flex",flexDirection:"column",gap:"0px",height:"100%",overflow:"hidden"},transcriptPanel:{flex:1,display:"flex",flexDirection:"column",backgroundColor:"white",border:"1px solid #e5e7eb",borderTop:"none",borderBottomLeftRadius:"6px",borderBottomRightRadius:"6px",padding:"16px",overflow:"hidden",minHeight:0},text:{fontSize:"16px",color:"#374151",lineHeight:"1.5",whiteSpace:"pre-wrap",margin:0,overflow:"auto",flex:1},contentContainer:{flex:1,display:"flex",flexDirection:"column",minHeight:0,height:"100%",overflow:"hidden",gap:"16px"},toolbarSection:{display:"flex",alignItems:"center",justifyContent:"flex-start",gap:"8px",flexShrink:0}};function UH({visit:t,notes:e,handleNoteDeleted:n}){console.log("[ReadyTranscriptionDisplay] Rendering with visit:",{id:t.id,state:t.state}),console.log("[ReadyTranscriptionDisplay] Received notes count:",e.length);const[r,i]=g.useState("transcript"),[o,s]=g.useState(!1),[a,l]=g.useState(null),[c,u]=g.useState(0),{snippets:d}=zR(),[h,p]=g.useState("");g.useEffect(()=>{i("transcript"),u(q=>q+1)},[t.id]),g.useEffect(()=>{(async()=>{if(t.id)try{const{data:Z,error:be}=await sn.from("transcripts").select("full_text").eq("visit_id",t.id).single();if(be){console.error("Error loading transcript:",be);return}p((Z==null?void 0:Z.full_text)||"")}catch(Z){console.error("Error loading transcript:",Z)}})()},[t.id]);const m=g.useCallback(()=>{u(q=>q+1)},[]),{hasUnsavedChanges:y,handleContentChange:v,saveNote:x,revertToPreviousVersion:w,getCurrentNote:b,getPreviousVersions:S,updateTemplateNotes:C,resetState:k,regenerateSoapNote:E,regenerateTemplateNote:T}=VH({visit:t,notes:e,onRevert:m,handleNoteDeleted:n}),O=g.useCallback((q,Z)=>{C(Z),i(q),s(!1)},[C]),{generateFromTemplate:_,isGenerating:D}=Y8({visitId:t.id,onSuccess:O}),L=g.useCallback(q=>{y&&!window.confirm("You have unsaved changes. Are you sure you want to switch tabs? Your changes will be lost.")||(i(q),u(Z=>Z+1),k())},[y,k]),N=g.useCallback(async()=>{await x()&&u(Z=>Z+1)},[x]),P=g.useCallback(()=>{if(y){if(!window.confirm("You have unsaved changes. Are you sure you want to create a new template? Your changes will be lost."))return;k()}s(!0)},[y,k]),V=g.useCallback(()=>{s(!1)},[]),I=g.useMemo(()=>e.filter((q,Z,be)=>Z===be.findIndex(ge=>ge.template_id===q.template_id)).map(q=>q.template_id).filter(q=>q!==null),[e]),F=g.useCallback(async()=>{y&&await x(),await E()},[y,x,E]),M=g.useCallback(async()=>{y&&await x();const q=b("template",r);q&&await T(q.id)},[y,x,T,b,r]),A=av(e,"soap"),$=av(e,"ai_context"),G=e.filter(q=>q.type==="template"),ee=()=>{if(r==="transcript")return f.jsx("p",{style:rc.text,children:h});if(r==="soap")return f.jsx(zm,{content:(A==null?void 0:A.content)||"",readOnly:!1,placeholder:"Start typing your SOAP note...",onChange:Z=>v(Z,"soap"),snippets:d,onEditorReady:l},`soap-editor-${c}`);if(r==="ai_context")return f.jsx(zm,{content:($==null?void 0:$.content)||"",readOnly:!1,placeholder:"Start typing your context note...",onChange:Z=>v(Z,"ai_context"),snippets:d,onEditorReady:l},`ai_context-${c}`);const q=e.filter(Z=>Z.template_id===r).sort((Z,be)=>(be.version_id||0)-(Z.version_id||0))[0];return f.jsx(zm,{content:(q==null?void 0:q.content)||"",readOnly:!1,placeholder:"Start typing your template note...",onChange:Z=>v(Z,"template",q==null?void 0:q.id),snippets:d,onEditorReady:l},`template-${q==null?void 0:q.id}-${c}`)};return f.jsxs("div",{style:rc.container,children:[f.jsx(J8,{activeTab:r,setActiveTab:L,aiContextVersion:$==null?void 0:$.version_id,soapNoteVersion:A==null?void 0:A.version_id,templateNotes:G,onOpenTemplateModal:P}),f.jsx("div",{style:rc.transcriptPanel,children:f.jsxs("div",{style:rc.contentContainer,children:[a&&r!=="transcript"&&f.jsx("div",{style:rc.toolbarSection,children:f.jsx(FH,{editor:a,previousVersions:S(r!=="soap"&&r!=="ai_context"?"template":r,r!=="soap"&&r!=="ai_context"?r:void 0),onRevertToPreviousVersion:w,hasUnsavedChanges:y,onSave:N,tabType:r,onRegenerateSoapNote:F,onRegenerateCurrentNote:r!=="soap"&&r!=="ai_context"&&r!=="transcript"?M:void 0})}),ee()]})}),f.jsx(rL,{isOpen:o,onClose:V,onGenerate:_,existingTemplateIds:I})]})}const Hd=(...t)=>{};function HH({visitId:t,onMessage:e}){const[n,r]=g.useState([]),i=g.useRef(!1),o=g.useRef(null),s=g.useCallback(async()=>{if(!t||t==="")return;const{data:a,error:l}=await sn.from("containers").select("*").eq("visit_id",t).order("chunk_id",{ascending:!0});l||a&&(Hd(`Fetched ${a.length} containers`),r(a),i.current=!0,a.forEach(c=>e==null?void 0:e(c)))},[t,e]);return g.useEffect(()=>{if(!t||t===""){r([]),i.current=!1;return}i.current||s(),o.current&&(o.current.unsubscribe(),o.current=null);const a=sn.channel(`containers_list_${t}`).on("postgres_changes",{event:"*",schema:"public",table:"containers",filter:`visit_id=eq.${t}`},l=>{switch(Hd("Received realtime event:",l.eventType,l),l.eventType){case yo.INSERT:{const c=l.new;r(u=>{if(u.some(h=>h.id===c.id))return u;const d=[...u,c].sort((h,p)=>h.chunk_id-p.chunk_id);return e==null||e(c),d});break}case yo.UPDATE:{const c=l.new;r(u=>{const d=u.map(h=>h.id===c.id?c:h);return JSON.stringify(d)===JSON.stringify(u)?u:(e==null||e(c),d)});break}case yo.DELETE:{const c=l.old;r(u=>{const d=u.filter(h=>h.id!==c.id);return d.length,u.length,d});break}default:Hd("Unhandled event type:",l.eventType);break}}).subscribe(l=>{});return o.current=a,()=>{a.unsubscribe(),o.current=null}},[t,s,e]),g.useEffect(()=>{Hd("Containers state updated:",n.length,"containers")},[n]),n}const Le=(...t)=>{console.log("[useRealtimeNotes]",...t)};function WH({visitId:t,onMessage:e}){const[n,r]=g.useState([]),i=g.useRef(!1),o=g.useRef(null),s=g.useCallback(async()=>{if(!t||t==="")return;Le("Fetching notes for visit:",t);const{data:l,error:c}=await sn.from("notes").select("*").eq("visit_id",t).order("created_at",{ascending:!0});if(c){Le("Error fetching notes:",c);return}l&&(Le(`Fetched ${l.length} notes`),r(l),i.current=!0,l.forEach(u=>e==null?void 0:e(u)))},[t,e]),a=g.useCallback(l=>{Le("Manual note deletion triggered for ID:",l),r(c=>{const u=c.filter(d=>d.id!==l);return u.length===c.length?Le("No note found to delete with ID (manual):",l):Le("Successfully removed note with ID (manual):",l),u})},[]);return g.useEffect(()=>{if(!t||t===""){Le("No valid visitId provided, skipping subscription"),r([]),i.current=!1;return}Le("Visit ID changed to:",t),r([]),i.current=!1,i.current||(Le("Setting up realtime subscription for visit:",t),s()),o.current&&(Le("Cleaning up existing subscription"),o.current.unsubscribe(),o.current=null);const l=sn.channel(`notes_list_${t}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"notes",filter:`visit_id=eq.${t}`},c=>{Le("Received INSERT event:",c);const u=c.new;Le("Inserting new note:",u),r(d=>{if(d.some(p=>p.id===u.id))return Le("Note already exists, skipping insert"),d;const h=[...d,u].sort((p,m)=>new Date(p.created_at).getTime()-new Date(m.created_at).getTime());return e==null||e(u),h})}).on("postgres_changes",{event:"UPDATE",schema:"public",table:"notes",filter:`visit_id=eq.${t}`},c=>{Le("Received UPDATE event:",c);const u=c.new;Le("Updating note:",u),r(d=>{const h=d.map(p=>p.id===u.id?u:p);return JSON.stringify(h)===JSON.stringify(d)?(Le("No changes detected in update"),d):(e==null||e(u),h)})}).on("postgres_changes",{event:"DELETE",schema:"public",table:"notes",filter:`visit_id=eq.${t}`},c=>{Le("Received DELETE event:",c);const u=c.old;if(Le("Deleting note with ID:",u==null?void 0:u.id),!u||!u.id){Le("Warning: Invalid delete payload, no note ID found",c);return}r(d=>{const h=d.filter(p=>p.id!==u.id);return h.length===d.length?Le("No note found to delete with ID:",u.id):Le("Successfully removed note with ID:",u.id),h})}).subscribe(c=>{Le("Subscription status:",c)});return o.current=l,()=>{Le("Cleaning up subscription"),l.unsubscribe(),o.current=null}},[t,s,e]),g.useEffect(()=>{Le("Notes state updated:",n.length,"notes")},[n]),{notes:n,handleNoteDeleted:a}}const KH=async(t,e,n)=>{try{if(n==="paused"||n==="processing"){const{data:o,error:s}=await t.from("containers").select("transcript_fragment").eq("visit_id",e).order("chunk_id",{ascending:!0});return s?(console.error("Error loading containers:",s),"Error loading partial transcription."):o.map(l=>l.transcript_fragment).filter(l=>l!==null).join(" ").trim()||""}else if(n==="recording")return"";const{data:r,error:i}=await t.from("transcripts").select("full_text").eq("visit_id",e).single();return i?i.code==="PGRST116"?"No transcript available for this visit.":(console.error("Error loading transcript:",i),"Error loading transcript. Please try again later."):(r==null?void 0:r.full_text)||"No transcript content available."}catch(r){return console.error("Error processing transcription:",r),"Error loading transcription data. Please try again later."}},Wd={container:{display:"flex",flexDirection:"column",height:"100%",width:"100%",backgroundColor:"#f9fafb"},content:{flex:1,backgroundColor:"#f9fafb",overflow:"hidden",width:"100%",height:"calc(100vh - 60px)",padding:"24px"},transcriptContainer:{height:"100%",overflow:"hidden"},transcriptContent:{lineHeight:"1.5",color:"#374151",height:"100%",display:"flex",flexDirection:"column"}};function qH({placeholder:t="Your transcription will appear here as you speak...",isTranscribing:e=!1,currentVisit:n}){const[r,i]=g.useState(""),[o,s]=g.useState({}),[a,l]=g.useState(null),c=Je(),u=n==null?void 0:n.state,d=n==null?void 0:n.id,h=g.useCallback(b=>{const S=b.transcript_fragment,C=b.chunk_id;S&&typeof C=="number"&&s(k=>({...k,[C]:S}))},[]);HH({visitId:d||"",onMessage:h});const p=g.useMemo(()=>e?Object.entries(o).sort(([b],[S])=>Number(b)-Number(S)).map(([b,S])=>S).join(" ").trim():"",[o,e]);g.useEffect(()=>{e&&p!==r&&i(p)},[p,r,e]),g.useEffect(()=>{if(!d||!u||!n){s({}),i(""),l(null);return}(async()=>{try{const S=await KH(c,d,u);l(S),e||i(S)}catch{i("Error loading transcription data.")}})()},[d,u,n,c,e]);const m=g.useMemo(()=>e?r:a||r||"",[e,r,a]),{notes:y,handleNoteDeleted:v}=WH({visitId:d||""}),x=y.filter(b=>b.type==="ai_context").sort((b,S)=>new Date(S.created_at).getTime()-new Date(b.created_at).getTime())[0],w=g.useMemo(()=>f.jsx("div",{style:Wd.content,children:f.jsx("div",{style:Wd.transcriptContainer,children:f.jsx("div",{style:Wd.transcriptContent,children:e||!d||!n||(n==null?void 0:n.state)==="processing"||(n==null?void 0:n.state)==="recording"||(n==null?void 0:n.state)==="paused"?f.jsx(nL,{transcription:m,placeholder:t,isTranscribing:e,visit:n??void 0,aiContextNote:x},`visit-${d}`):f.jsx(UH,{visit:n,notes:y,handleNoteDeleted:v},`visit-${d}`)})})}),[m,t,e,d,n,y,v]);return f.jsx("div",{style:Wd.container,children:w})}function GH(){const t=g.useContext(aT),e=Je();if(t===void 0)throw new Error("useAuth must be used within an AuthProvider");return{...t,signIn:async(r,i)=>{try{const{data:o,error:s}=await e.auth.signInWithPassword({email:r,password:i});if(s)throw s;return await e.auth.getSession(),{data:o,error:null}}catch(o){return console.error("Sign in error:",o),{data:null,error:o}}}}}const jt={container:{minHeight:"100vh",width:"100vw",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#f3f4f6",padding:"20px"},formContainer:{backgroundColor:"white",padding:"48px",borderRadius:"12px",boxShadow:"0 4px 6px rgba(0,0,0,0.1)",width:"100%",maxWidth:"480px"},title:{fontSize:"32px",fontWeight:"bold",color:"#1f2937",marginBottom:"32px",textAlign:"center"},form:{display:"flex",flexDirection:"column",gap:"24px"},inputGroup:{display:"flex",flexDirection:"column",gap:"8px"},label:{fontSize:"14px",color:"#4b5563",fontWeight:"500"},input:{padding:"12px 16px",borderRadius:"8px",border:"1px solid #e5e7eb",fontSize:"16px",backgroundColor:"white",transition:"all 0.2s ease","&:focus":{outline:"none",borderColor:"#3b82f6",boxShadow:"0 0 0 3px rgba(59, 130, 246, 0.1)"}},button:{backgroundColor:"#3b82f6",color:"white",padding:"14px",borderRadius:"8px",border:"none",fontSize:"16px",fontWeight:"500",cursor:"pointer",transition:"all 0.2s ease",marginTop:"8px","&:hover":{backgroundColor:"#2563eb"},"&:disabled":{backgroundColor:"#93c5fd",cursor:"not-allowed"}},error:{color:"#ef4444",fontSize:"14px",textAlign:"center",marginBottom:"16px"},signupText:{textAlign:"center",marginTop:"24px",fontSize:"14px",color:"#6b7280"},signupLink:{color:"#3b82f6",textDecoration:"none",fontWeight:"500","&:hover":{textDecoration:"underline"}}};function JH(){const t=mr(),{signIn:e,user:n}=GH(),[r,i]=g.useState(""),[o,s]=g.useState(""),[a,l]=g.useState(""),[c,u]=g.useState(!1),d=Ur(),h=Gn();g.useEffect(()=>{var m,y;if(n){console.log("User is logged in, redirecting to record",{user:n.id,email:n.email,location:window.location.pathname});const v=((y=(m=h.state)==null?void 0:m.from)==null?void 0:y.pathname)||"/record";t(v,{replace:!0})}},[n,t,h]);const p=async m=>{if(m.preventDefault(),!c){l(""),u(!0);try{const y=await e(r,o);if(y.error)throw y.error;d.clear()}catch(y){l(y instanceof Error?y.message:"Failed to sign in"),u(!1)}}};return n?f.jsx("div",{style:jt.container,children:f.jsx("div",{style:jt.formContainer,children:f.jsx("div",{style:{textAlign:"center",color:"#4b5563"},children:"Redirecting..."})})}):f.jsx("div",{style:jt.container,children:f.jsxs("div",{style:jt.formContainer,children:[f.jsx("h1",{style:jt.title,children:"Welcome to East Medical AI Scribe"}),f.jsxs("form",{onSubmit:p,style:jt.form,children:[a&&f.jsx("div",{style:jt.error,children:a}),f.jsxs("div",{style:jt.inputGroup,children:[f.jsx("label",{htmlFor:"email",style:jt.label,children:"Email Address"}),f.jsx("input",{id:"email",type:"email",value:r,onChange:m=>i(m.target.value),required:!0,style:jt.input,placeholder:"Enter your email"})]}),f.jsxs("div",{style:jt.inputGroup,children:[f.jsx("label",{htmlFor:"password",style:jt.label,children:"Password"}),f.jsx("input",{id:"password",type:"password",value:o,onChange:m=>s(m.target.value),required:!0,style:jt.input,placeholder:"Enter your password"})]}),f.jsx("button",{type:"submit",disabled:c,style:jt.button,children:c?"Signing in...":"Sign In"})]}),f.jsxs("div",{style:jt.signupText,children:["Don't have an account?"," "]})]})})}const cP=g.createContext(void 0);function YH({children:t}){const[e,n]=g.useState(null),[r,i]=g.useState(!0),o=Je();g.useEffect(()=>{(async()=>{const{data:{session:h},error:p}=await o.auth.getSession();p&&console.error("Error fetching session:",p),n((h==null?void 0:h.user)??null),i(!1)})();const{data:{subscription:d}}=o.auth.onAuthStateChange((h,p)=>{n((p==null?void 0:p.user)??null)});return()=>{d.unsubscribe()}},[o]);const c={user:e,loading:r,signIn:async(u,d)=>{const{error:h}=await o.auth.signInWithPassword({email:u,password:d});if(h)throw h},signUp:async(u,d)=>{const{error:h}=await o.auth.signUp({email:u,password:d});if(h)throw h},signOut:async()=>{const{error:u}=await o.auth.signOut();if(u)throw u}};return f.jsx(cP.Provider,{value:c,children:t})}function uP(){const t=g.useContext(cP);if(t===void 0)throw new Error("useAuth must be used within an AuthProvider");return t}const Qt={container:{minHeight:"100vh",width:"100vw",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#f3f4f6",padding:"20px"},formContainer:{backgroundColor:"white",padding:"48px",borderRadius:"12px",boxShadow:"0 4px 6px rgba(0,0,0,0.1)",width:"100%",maxWidth:"480px"},title:{fontSize:"32px",fontWeight:"bold",color:"#1f2937",marginBottom:"32px",textAlign:"center"},form:{display:"flex",flexDirection:"column",gap:"24px"},inputGroup:{display:"flex",flexDirection:"column",gap:"8px"},label:{fontSize:"14px",color:"#4b5563",fontWeight:"500"},input:{padding:"12px 16px",borderRadius:"8px",border:"1px solid #e5e7eb",fontSize:"16px",backgroundColor:"white",transition:"all 0.2s ease","&:focus":{outline:"none",borderColor:"#3b82f6",boxShadow:"0 0 0 3px rgba(59, 130, 246, 0.1)"}},button:{backgroundColor:"#3b82f6",color:"white",padding:"14px",borderRadius:"8px",border:"none",fontSize:"16px",fontWeight:"500",cursor:"pointer",transition:"all 0.2s ease",marginTop:"8px","&:hover":{backgroundColor:"#2563eb"},"&:disabled":{backgroundColor:"#93c5fd",cursor:"not-allowed"}},error:{color:"#ef4444",fontSize:"14px",textAlign:"center",marginBottom:"16px"},loginText:{textAlign:"center",marginTop:"24px",fontSize:"14px",color:"#6b7280"},loginLink:{color:"#3b82f6",textDecoration:"none",fontWeight:"500","&:hover":{textDecoration:"underline"}}};function QH(){const[t,e]=g.useState(""),[n,r]=g.useState(""),[i,o]=g.useState(""),[s,a]=g.useState(!1),{signUp:l}=uP(),c=mr(),u=async d=>{d.preventDefault();try{o(""),a(!0),await l(t,n),c("/")}catch(h){o("Failed to create account. Please try again."),console.error("Signup error:",h)}finally{a(!1)}};return f.jsx("div",{style:Qt.container,children:f.jsxs("div",{style:Qt.formContainer,children:[f.jsx("h1",{style:Qt.title,children:"Create an Account"}),f.jsxs("form",{onSubmit:u,style:Qt.form,children:[i&&f.jsx("div",{style:Qt.error,children:i}),f.jsxs("div",{style:Qt.inputGroup,children:[f.jsx("label",{htmlFor:"email",style:Qt.label,children:"Email Address"}),f.jsx("input",{id:"email",type:"email",value:t,onChange:d=>e(d.target.value),required:!0,style:Qt.input,placeholder:"Enter your email"})]}),f.jsxs("div",{style:Qt.inputGroup,children:[f.jsx("label",{htmlFor:"password",style:Qt.label,children:"Password"}),f.jsx("input",{id:"password",type:"password",value:n,onChange:d=>r(d.target.value),required:!0,style:Qt.input,placeholder:"Choose a password"})]}),f.jsx("button",{type:"submit",disabled:s,style:Qt.button,children:s?"Creating Account...":"Sign Up"})]}),f.jsxs("div",{style:Qt.loginText,children:["Already have an account?"," ",f.jsx(b0,{to:"/login",style:Qt.loginLink,children:"Sign in"})]})]})})}const XH=["Accident and Emergency Nurse","Acupuncturist","Addiction Counsellor","Addiction Medicine Specialist","Adolescent and young adult medicine Specialist","Adult Intensive Care Specialist","Aerospace Medicine Specialist","Allergy and Immunologist","Allied Health Professional","Alternative medicine practitioner","Anaesthetist","Anatomical Pathologist","Andrologist","Animal-Assisted Therapist","Aromatherapist","Arts Therapist","Audiologist","Audiology Technician","Audiometrist","Ayurveda","Behaviour Therapist","Bereavement Counselor","Biofeedback Therapist","Blood Transfusion Doctor","Breast Surgeon","Cardiologist","Cardiothoracic Surgeon","Chemical Pathologist","Chemotherapy Nurse","Child and Adolescent Psychiatrist","Chiropractor","Chronic Pain Specialist","Clinical Geneticist","Clinical Immunologist","Clinical Neurophysiologist","Clinical Pathologist","Clinical Pharmacologist","Clinical Physiologist","Clinical Social Worker","Cognitive Behavioral Therapist","Colorectal Surgeon","Community Child Health Specialist","Community Nurse","Coroner","Counselling Psychologist","Counselors","Critical Care Medicine Specialist","Dance Therapist","Dental Auxiliary","Dental Technician","Dental assistant","Dental nurse","Dentist","Dermatologist","Diabetes Dietitian","Diabetes Specialist","Diabetologist","Diagnostic Radiographer","Diagnostic Radiologist","Dietitian","Drama Therapist","ECG Technician","EEG Technician","EMT","Eating Disorder Specialist Dietitian","Eating Disorder Specialist Psychologist","Emergency Medicine Specialist","Endocrine Surgeon","Endocrinologist","Endodontist","Equine Therapist","Exercise Physiologists","Family Medicine Specialist","Family Planning Doctor","Fetal Medicine Specialist","Foot and Ankle Surgeon","Forensic Medicine Specialist","Forensic Psychiatrist","Functional Medicine Specialist","Gastroenterologist","Gastrointestinal Surgeon","General Dietitian","General Gastrointestinal Surgeon","General Practitioner","General Surgeon","Genetic Counselor","Geriatric Medicine Specialist","Geriatrician","Gerodontist","Geropsychologist","Grief Counsellor","Gynaecologist","Haematologist","Haemodialysis Nurse","Hand Surgeon","Health Coach","Health Psychologist","Healthcare Assistant","Healthcare Service Manager","Hepatobiliary Surgeon","Hepatologist","Herbal Medicine Specialist","Hip and Knee Surgeon","Holistic Health Practitioner","Homeopath","Horticultural Therapist","Hospital Administrator","Hydrotherapist","Hypnotherapist","Immunopathologist","Infection Control Nurse","Infectious Diseases Physician","Intensive Care Specialist","Internal Medicine Specialist","Interpreter","Interventional Radiologist","Invasive Cardiologist","Kinesiologist","Laboratory Haematologist","Laboratory Medicine Specialist","Lactation Consultant","Lifestyle medicine Specialist","Liver Dietitian","Lower Gastrointestinal Surgeon","Marriage Guidance Counsellor","Marriage and family therapist","Massage Therapist","Maternal-Fetal Medicine Specialist","Maxillofacial Surgeon","Medical Geneticist","Medical Microbiologist","Medical Oncologist","Medical Pathologist","Medical Record Administrator","Medical Secretary","Medical Technician","Medical X-ray Technician","Mental Health Counselor","Mental Health Nurse","Mental Health and Behavioural Specialist","Midwife","Music Therapist","Naturopath","Neonatal Nurse","Neonatologist","Nephrologist","Neuroendocrinologist","Neurologist","Neuropathologist","Neuropsychiatrist","Neuroradiologist","Neurosurgeon","Nuclear Medicine Physician","Nurse","Nurse Administrator","Nurse Anaesthetist","Nurse Practitioner","Nurse Psychotherapist","Nursing Aid","Nursing Auxiliary","Nutrition & diabetics Specialist","Nutrition Therapist","Obesity Medicine","Obesity Specialist","Obstetrician & Gynaecologist","Occupational Health Nurse","Occupational Medicine Specialist","Occupational Therapist","Oculoplastic Surgeon","Oncologist","Oncology Dietitian","Oncology Nurse","Ophthalmologist","Optician","Optometrist","Oral Pathologist","Oral/Dental Hygienist","Orthodontist","Orthopaedic Surgeon","Orthoptist","Orthotist","Osteopath","Otolaryngologist","Otorhinolaryngologist (ENT Specialist)","Paediatric Allergist","Paediatric Audiologist","Paediatric Cardiologist","Paediatric Dietitian","Paediatric Emergency Medicine Specialist","Paediatric Endocrinologist","Paediatric Gastroenterologist","Paediatric Intensive Care Specialist","Paediatric Nephrologist","Paediatric Neurologist","Paediatric Nurse","Paediatric Oncologist","Paediatric Orthopaedic Surgeon","Paediatric Respirologist","Paediatric Rheumatologist","Paediatric Surgeon","Paediatric haematologist","Paediatrician","Pain Management Specialist","Palantypist","Palliative Care Nurse","Palliative Care Physician","Pancreatic Surgeon","Paramedic","Pathologist","Pediatric Dentist","Pediatric Psychologist","Pediatric Pulmonologist","Pediatric Radiologist","Pediatric Surgeon","Periodontist","Perioperative Nurse","Pharmacist","Physical Medicine and Rehabilitation Specialist","Physician","Physician Assistant","Physiologist","Physiotherapist","Pituitary Surgeon","Plastic & Reconstructive Surgeon","Play Therapist","Podiatrist","Podiatrist Assistant","Practice Manager","Preventive medicine Specialist","Prosthetist","Prosthodontist","Psychiatric Nurse","Psychiatrist","Psychiatrist for Mental Handicap","Psychoanalyst","Psychogeriatrician","Psychologist","Psychotherapist","Public Health Medicine Specialist","Public Health Nurse","Pulmonologist","Radiation Oncologist","Radiation Oncology","Radiation Therapist","Radiologist","Radiology and Imaging Specialist","Radiotherapy Nurse","Recreational Therapist","Reflexologist","Registered Nurse"],Oe={container:{padding:"32px",width:"100%",height:"100%",backgroundColor:"#fff"},title:{fontSize:"16px",fontWeight:"500",marginBottom:"32px",color:"#1f2937"},section:{maxWidth:"1200px",margin:"0 auto"},formGrid:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"24px"},field:{marginBottom:"24px"},label:{display:"block",fontSize:"14px",color:"#4b5563",marginBottom:"8px"},input:{width:"100%",padding:"8px 12px",fontSize:"14px",border:"1px solid #d1d5db",borderRadius:"6px",color:"#1f2937",backgroundColor:"#fff","&:focus":{outline:"none",borderColor:"#2563eb",boxShadow:"0 0 0 2px rgba(37, 99, 235, 0.2)"}},select:{width:"100%",padding:"8px 12px",fontSize:"14px",border:"1px solid #d1d5db",borderRadius:"6px",color:"#1f2937",backgroundColor:"#fff",cursor:"pointer",appearance:"none",backgroundImage:'url("data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2224%22%20height%3D%2224%22%20viewBox%3D%220%200%2024%2024%22%20fill%3D%22none%22%20stroke%3D%22%236b7280%22%20stroke-width%3D%222%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%3E%3Cpolyline%20points%3D%226%209%2012%2015%2018%209%22%3E%3C%2Fpolyline%3E%3C%2Fsvg%3E")',backgroundRepeat:"no-repeat",backgroundPosition:"right 8px center",backgroundSize:"16px",paddingRight:"32px"},saveButton:{backgroundColor:"#2563eb",color:"white",padding:"10px 20px",borderRadius:"6px",border:"none",fontSize:"14px",fontWeight:"500",cursor:"pointer",transition:"background-color 0.2s","&:hover":{backgroundColor:"#1d4ed8"},"&:disabled":{backgroundColor:"#93c5fd",cursor:"not-allowed"}},disabledInput:{backgroundColor:"#f3f4f6",cursor:"not-allowed"}};function ZH(){const{user:t,loading:e}=It(),n=Je(),[r,i]=g.useState({firstName:"",lastName:"",specialty:"",title:"",organization:"",companySize:"Just me",position:"Individual clinician"}),[o,s]=g.useState(!1);if(Te.useEffect(()=>{if(t){const[c="",u=""]=(t.name||"").split(" ");i({firstName:c,lastName:u,specialty:t.specialty||"",title:t.title||"",organization:t.organization||"",companySize:"Just me",position:"Individual clinician"})}},[t]),e)return f.jsx("div",{children:"Loading..."});if(!t)return f.jsx("div",{children:"Not logged in"});const a=c=>{const{name:u,value:d}=c.target;i(h=>({...h,[u]:d}))},l=async()=>{if(t.id){s(!0);try{const{error:c}=await n.from("user_profiles").update({name:`${r.firstName} ${r.lastName}`.trim(),specialty:r.specialty,title:r.title,organization:r.organization,updated_at:new Date().toISOString()}).eq("id",t.id);if(c)throw c}catch(c){console.error("Error updating profile:",c)}finally{s(!1)}}};return f.jsx("div",{style:Oe.container,children:f.jsxs("div",{style:Oe.section,children:[f.jsx("h1",{style:Oe.title,children:"About you"}),f.jsxs("div",{style:Oe.formGrid,children:[f.jsxs("div",{style:Oe.field,children:[f.jsx("label",{style:Oe.label,children:"Title"}),f.jsx("input",{style:Oe.input,name:"title",value:r.title,onChange:a,type:"text",placeholder:"Enter your title"})]}),f.jsxs("div",{style:Oe.field,children:[f.jsx("label",{style:Oe.label,children:"First name"}),f.jsx("input",{style:Oe.input,type:"text",name:"firstName",value:r.firstName,onChange:a,placeholder:"Enter your first name"})]}),f.jsxs("div",{style:Oe.field,children:[f.jsx("label",{style:Oe.label,children:"Last name"}),f.jsx("input",{style:Oe.input,type:"text",name:"lastName",value:r.lastName,onChange:a,placeholder:"Enter your last name"})]}),f.jsxs("div",{style:Oe.field,children:[f.jsx("label",{style:Oe.label,children:"Specialty"}),f.jsxs("select",{style:Oe.select,name:"specialty",value:r.specialty,onChange:a,children:[f.jsx("option",{value:"",children:"Select a specialty"}),XH.map(c=>f.jsx("option",{value:c,children:c},c))]})]}),f.jsxs("div",{style:Oe.field,children:[f.jsx("label",{style:Oe.label,children:"Organization name"}),f.jsx("input",{style:Oe.input,type:"text",name:"organization",value:r.organization,onChange:a,placeholder:"Enter your organization"})]}),f.jsxs("div",{style:Oe.field,children:[f.jsx("label",{style:Oe.label,children:"Company size"}),f.jsxs("select",{style:Oe.select,name:"companySize",value:r.companySize,onChange:a,children:[f.jsx("option",{value:"Just me",children:"Just me"}),f.jsx("option",{value:"2-10",children:"2-10 employees"}),f.jsx("option",{value:"11-50",children:"11-50 employees"}),f.jsx("option",{value:"51+",children:"51+ employees"})]})]}),f.jsxs("div",{style:Oe.field,children:[f.jsx("label",{style:Oe.label,children:"Position"}),f.jsxs("select",{style:Oe.select,name:"position",value:r.position,onChange:a,children:[f.jsx("option",{value:"Individual clinician",children:"Individual clinician"}),f.jsx("option",{value:"Practice owner",children:"Practice owner"}),f.jsx("option",{value:"Administrator",children:"Administrator"})]})]})]}),f.jsx("div",{style:{marginTop:"24px",textAlign:"right"},children:f.jsx("button",{style:Oe.saveButton,onClick:l,disabled:o,children:o?"Saving...":"Save changes"})})]})})}const Ra={default_copy_mode:"plain",date_format:"MM/DD/YYYY",primary_language:"auto",preferred_note_language:"en",patient_instructions_language:"en",spelling:"en-us",patient_reference_format:"",clinician_reference_format:""},e9=[{value:"plain",label:"Plain Text"},{value:"rich_text",label:"Formatted Text"},{value:"without_lists",label:"Formatted Text (Without Lists)"}],lv=[{value:"auto",label:"Multi-lingual"},{value:"en",label:"English"},{value:"zh",label:"Mandarin"},{value:"zh-HK",label:"Cantonese"},{value:"cs",label:"Czech"},{value:"da",label:"Danish"},{value:"nl",label:"Dutch"},{value:"nl-BE",label:"Flemish"},{value:"fr",label:"French"},{value:"de",label:"German"},{value:"el",label:"Greek"},{value:"hi",label:"Hindi"},{value:"id",label:"Indonesian"},{value:"it",label:"Italian"},{value:"ja",label:"Japanese"},{value:"ko",label:"Korean"},{value:"ms",label:"Malay"},{value:"no",label:"Norwegian"},{value:"pl",label:"Polish"},{value:"pt",label:"Portuguese"},{value:"ru",label:"Russian"},{value:"es",label:"Spanish"},{value:"sv",label:"Swedish"},{value:"th",label:"Thai"},{value:"tr",label:"Turkish"},{value:"uk",label:"Ukrainian"},{value:"vi",label:"Vietnamese"}],t9=[{value:"MM/DD/YYYY",label:"MM/DD/YYYY"},{value:"DD/MM/YYYY",label:"DD/MM/YYYY"},{value:"D MMM YYYY",label:"D MMM YYYY"},{value:"MMMM DD YYYY",label:"MMMM DD YYYY"},{value:"MMM DD YYYY",label:"MMM DD YYYY"},{value:"YYYY/MM/DD",label:"YYYY/MM/DD"}],dP=[{value:"match_spoken",label:"Match spoken language"},{value:"en",label:"English"},{value:"zh",label:"Mandarin"},{value:"zh-HK",label:"Cantonese"},{value:"cs",label:"Czech"},{value:"da",label:"Danish"},{value:"nl",label:"Dutch"},{value:"nl-BE",label:"Flemish"},{value:"fr",label:"French"},{value:"de",label:"German"},{value:"el",label:"Greek"},{value:"hi",label:"Hindi"},{value:"id",label:"Indonesian"},{value:"it",label:"Italian"},{value:"ja",label:"Japanese"},{value:"ko",label:"Korean"},{value:"ms",label:"Malay"},{value:"no",label:"Norwegian"},{value:"pl",label:"Polish"},{value:"pt",label:"Portuguese"},{value:"ru",label:"Russian"},{value:"es",label:"Spanish"},{value:"sv",label:"Swedish"},{value:"th",label:"Thai"},{value:"tr",label:"Turkish"},{value:"uk",label:"Ukrainian"},{value:"vi",label:"Vietnamese"}],n9=[{value:"en-us",label:"English (United States)"},{value:"en-gb",label:"English (United Kingdom)"},{value:"en-au",label:"English (Australia)"},{value:"en-ca",label:"English (Canada)"}];function IS(t,[e,n]){return Math.min(n,Math.max(e,t))}function r9(t){const e=g.useRef({value:t,previous:t});return g.useMemo(()=>(e.current.value!==t&&(e.current.previous=e.current.value,e.current.value=t),e.current.previous),[t])}var i9=[" ","Enter","ArrowUp","ArrowDown"],o9=[" ","Enter"],Ju="Select",[_p,Rp,s9]=gp(Ju),[Vl,VW]=yi(Ju,[s9,zl]),Op=zl(),[a9,Fo]=Vl(Ju),[l9,c9]=Vl(Ju),fP=t=>{const{__scopeSelect:e,children:n,open:r,defaultOpen:i,onOpenChange:o,value:s,defaultValue:a,onValueChange:l,dir:c,name:u,autoComplete:d,disabled:h,required:p,form:m}=t,y=Op(e),[v,x]=g.useState(null),[w,b]=g.useState(null),[S,C]=g.useState(!1),k=px(c),[E=!1,T]=js({prop:r,defaultProp:i,onChange:o}),[O,_]=js({prop:s,defaultProp:a,onChange:l}),D=g.useRef(null),L=v?m||!!v.closest("form"):!0,[N,P]=g.useState(new Set),V=Array.from(N).map(I=>I.props.value).join(";");return f.jsx(kx,{...y,children:f.jsxs(a9,{required:p,scope:e,trigger:v,onTriggerChange:x,valueNode:w,onValueNodeChange:b,valueNodeHasChildren:S,onValueNodeHasChildrenChange:C,contentId:jr(),value:O,onValueChange:_,open:E,onOpenChange:T,dir:k,triggerPointerDownPosRef:D,disabled:h,children:[f.jsx(_p.Provider,{scope:e,children:f.jsx(l9,{scope:t.__scopeSelect,onNativeOptionAdd:g.useCallback(I=>{P(F=>new Set(F).add(I))},[]),onNativeOptionRemove:g.useCallback(I=>{P(F=>{const M=new Set(F);return M.delete(I),M})},[]),children:n})}),L?f.jsxs(NP,{"aria-hidden":!0,required:p,tabIndex:-1,name:u,autoComplete:d,value:O,onChange:I=>_(I.target.value),disabled:h,form:m,children:[O===void 0?f.jsx("option",{value:""}):null,Array.from(N)]},V):null]})})};fP.displayName=Ju;var hP="SelectTrigger",pP=g.forwardRef((t,e)=>{const{__scopeSelect:n,disabled:r=!1,...i}=t,o=Op(n),s=Fo(hP,n),a=s.disabled||r,l=Se(e,s.onTriggerChange),c=Rp(n),u=g.useRef("touch"),[d,h,p]=DP(y=>{const v=c().filter(b=>!b.disabled),x=v.find(b=>b.value===s.value),w=jP(v,y,x);w!==void 0&&s.onValueChange(w.value)}),m=y=>{a||(s.onOpenChange(!0),p()),y&&(s.triggerPointerDownPosRef.current={x:Math.round(y.pageX),y:Math.round(y.pageY)})};return f.jsx(wp,{asChild:!0,...o,children:f.jsx(se.button,{type:"button",role:"combobox","aria-controls":s.contentId,"aria-expanded":s.open,"aria-required":s.required,"aria-autocomplete":"none",dir:s.dir,"data-state":s.open?"open":"closed",disabled:a,"data-disabled":a?"":void 0,"data-placeholder":AP(s.value)?"":void 0,...i,ref:l,onClick:H(i.onClick,y=>{y.currentTarget.focus(),u.current!=="mouse"&&m(y)}),onPointerDown:H(i.onPointerDown,y=>{u.current=y.pointerType;const v=y.target;v.hasPointerCapture(y.pointerId)&&v.releasePointerCapture(y.pointerId),y.button===0&&y.ctrlKey===!1&&y.pointerType==="mouse"&&(m(y),y.preventDefault())}),onKeyDown:H(i.onKeyDown,y=>{const v=d.current!=="";!(y.ctrlKey||y.altKey||y.metaKey)&&y.key.length===1&&h(y.key),!(v&&y.key===" ")&&i9.includes(y.key)&&(m(),y.preventDefault())})})})});pP.displayName=hP;var mP="SelectValue",gP=g.forwardRef((t,e)=>{const{__scopeSelect:n,className:r,style:i,children:o,placeholder:s="",...a}=t,l=Fo(mP,n),{onValueNodeHasChildrenChange:c}=l,u=o!==void 0,d=Se(e,l.onValueNodeChange);return Ot(()=>{c(u)},[c,u]),f.jsx(se.span,{...a,ref:d,style:{pointerEvents:"none"},children:AP(l.value)?f.jsx(f.Fragment,{children:s}):o})});gP.displayName=mP;var u9="SelectIcon",yP=g.forwardRef((t,e)=>{const{__scopeSelect:n,children:r,...i}=t;return f.jsx(se.span,{"aria-hidden":!0,...i,ref:e,children:r||"▼"})});yP.displayName=u9;var d9="SelectPortal",vP=t=>f.jsx($l,{asChild:!0,...t});vP.displayName=d9;var Fs="SelectContent",xP=g.forwardRef((t,e)=>{const n=Fo(Fs,t.__scopeSelect),[r,i]=g.useState();if(Ot(()=>{i(new DocumentFragment)},[]),!n.open){const o=r;return o?Vs.createPortal(f.jsx(wP,{scope:t.__scopeSelect,children:f.jsx(_p.Slot,{scope:t.__scopeSelect,children:f.jsx("div",{children:t.children})})}),o):null}return f.jsx(bP,{...t,ref:e})});xP.displayName=Fs;var Xn=10,[wP,Bo]=Vl(Fs),f9="SelectContentImpl",bP=g.forwardRef((t,e)=>{const{__scopeSelect:n,position:r="item-aligned",onCloseAutoFocus:i,onEscapeKeyDown:o,onPointerDownOutside:s,side:a,sideOffset:l,align:c,alignOffset:u,arrowPadding:d,collisionBoundary:h,collisionPadding:p,sticky:m,hideWhenDetached:y,avoidCollisions:v,...x}=t,w=Fo(Fs,n),[b,S]=g.useState(null),[C,k]=g.useState(null),E=Se(e,J=>S(J)),[T,O]=g.useState(null),[_,D]=g.useState(null),L=Rp(n),[N,P]=g.useState(!1),V=g.useRef(!1);g.useEffect(()=>{if(b)return pp(b)},[b]),dp();const I=g.useCallback(J=>{const[ue,...ye]=L().map(ve=>ve.ref.current),[de]=ye.slice(-1),he=document.activeElement;for(const ve of J)if(ve===he||(ve==null||ve.scrollIntoView({block:"nearest"}),ve===ue&&C&&(C.scrollTop=0),ve===de&&C&&(C.scrollTop=C.scrollHeight),ve==null||ve.focus(),document.activeElement!==he))return},[L,C]),F=g.useCallback(()=>I([T,b]),[I,T,b]);g.useEffect(()=>{N&&F()},[N,F]);const{onOpenChange:M,triggerPointerDownPosRef:A}=w;g.useEffect(()=>{if(b){let J={x:0,y:0};const ue=de=>{var he,ve;J={x:Math.abs(Math.round(de.pageX)-(((he=A.current)==null?void 0:he.x)??0)),y:Math.abs(Math.round(de.pageY)-(((ve=A.current)==null?void 0:ve.y)??0))}},ye=de=>{J.x<=10&&J.y<=10?de.preventDefault():b.contains(de.target)||M(!1),document.removeEventListener("pointermove",ue),A.current=null};return A.current!==null&&(document.addEventListener("pointermove",ue),document.addEventListener("pointerup",ye,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",ue),document.removeEventListener("pointerup",ye,{capture:!0})}}},[b,M,A]),g.useEffect(()=>{const J=()=>M(!1);return window.addEventListener("blur",J),window.addEventListener("resize",J),()=>{window.removeEventListener("blur",J),window.removeEventListener("resize",J)}},[M]);const[$,G]=DP(J=>{const ue=L().filter(he=>!he.disabled),ye=ue.find(he=>he.ref.current===document.activeElement),de=jP(ue,J,ye);de&&setTimeout(()=>de.ref.current.focus())}),ee=g.useCallback((J,ue,ye)=>{const de=!V.current&&!ye;(w.value!==void 0&&w.value===ue||de)&&(O(J),de&&(V.current=!0))},[w.value]),q=g.useCallback(()=>b==null?void 0:b.focus(),[b]),Z=g.useCallback((J,ue,ye)=>{const de=!V.current&&!ye;(w.value!==void 0&&w.value===ue||de)&&D(J)},[w.value]),be=r==="popper"?cv:SP,ge=be===cv?{side:a,sideOffset:l,align:c,alignOffset:u,arrowPadding:d,collisionBoundary:h,collisionPadding:p,sticky:m,hideWhenDetached:y,avoidCollisions:v}:{};return f.jsx(wP,{scope:n,content:b,viewport:C,onViewportChange:k,itemRefCallback:ee,selectedItem:T,onItemLeave:q,itemTextRefCallback:Z,focusSelectedItem:F,selectedItemText:_,position:r,isPositioned:N,searchRef:$,children:f.jsx(hp,{as:Ro,allowPinchZoom:!0,children:f.jsx(Wu,{asChild:!0,trapped:w.open,onMountAutoFocus:J=>{J.preventDefault()},onUnmountAutoFocus:H(i,J=>{var ue;(ue=w.trigger)==null||ue.focus({preventScroll:!0}),J.preventDefault()}),children:f.jsx(Ll,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:o,onPointerDownOutside:s,onFocusOutside:J=>J.preventDefault(),onDismiss:()=>w.onOpenChange(!1),children:f.jsx(be,{role:"listbox",id:w.contentId,"data-state":w.open?"open":"closed",dir:w.dir,onContextMenu:J=>J.preventDefault(),...x,...ge,onPlaced:()=>P(!0),ref:E,style:{display:"flex",flexDirection:"column",outline:"none",...x.style},onKeyDown:H(x.onKeyDown,J=>{const ue=J.ctrlKey||J.altKey||J.metaKey;if(J.key==="Tab"&&J.preventDefault(),!ue&&J.key.length===1&&G(J.key),["ArrowUp","ArrowDown","Home","End"].includes(J.key)){let de=L().filter(he=>!he.disabled).map(he=>he.ref.current);if(["ArrowUp","End"].includes(J.key)&&(de=de.slice().reverse()),["ArrowUp","ArrowDown"].includes(J.key)){const he=J.target,ve=de.indexOf(he);de=de.slice(ve+1)}setTimeout(()=>I(de)),J.preventDefault()}})})})})})})});bP.displayName=f9;var h9="SelectItemAlignedPosition",SP=g.forwardRef((t,e)=>{const{__scopeSelect:n,onPlaced:r,...i}=t,o=Fo(Fs,n),s=Bo(Fs,n),[a,l]=g.useState(null),[c,u]=g.useState(null),d=Se(e,E=>u(E)),h=Rp(n),p=g.useRef(!1),m=g.useRef(!0),{viewport:y,selectedItem:v,selectedItemText:x,focusSelectedItem:w}=s,b=g.useCallback(()=>{if(o.trigger&&o.valueNode&&a&&c&&y&&v&&x){const E=o.trigger.getBoundingClientRect(),T=c.getBoundingClientRect(),O=o.valueNode.getBoundingClientRect(),_=x.getBoundingClientRect();if(o.dir!=="rtl"){const he=_.left-T.left,ve=O.left-he,Ze=E.left-ve,At=E.width+Ze,xr=Math.max(At,T.width),Jn=window.innerWidth-Xn,Yn=IS(ve,[Xn,Math.max(Xn,Jn-xr)]);a.style.minWidth=At+"px",a.style.left=Yn+"px"}else{const he=T.right-_.right,ve=window.innerWidth-O.right-he,Ze=window.innerWidth-E.right-ve,At=E.width+Ze,xr=Math.max(At,T.width),Jn=window.innerWidth-Xn,Yn=IS(ve,[Xn,Math.max(Xn,Jn-xr)]);a.style.minWidth=At+"px",a.style.right=Yn+"px"}const D=h(),L=window.innerHeight-Xn*2,N=y.scrollHeight,P=window.getComputedStyle(c),V=parseInt(P.borderTopWidth,10),I=parseInt(P.paddingTop,10),F=parseInt(P.borderBottomWidth,10),M=parseInt(P.paddingBottom,10),A=V+I+N+M+F,$=Math.min(v.offsetHeight*5,A),G=window.getComputedStyle(y),ee=parseInt(G.paddingTop,10),q=parseInt(G.paddingBottom,10),Z=E.top+E.height/2-Xn,be=L-Z,ge=v.offsetHeight/2,J=v.offsetTop+ge,ue=V+I+J,ye=A-ue;if(ue<=Z){const he=D.length>0&&v===D[D.length-1].ref.current;a.style.bottom="0px";const ve=c.clientHeight-y.offsetTop-y.offsetHeight,Ze=Math.max(be,ge+(he?q:0)+ve+F),At=ue+Ze;a.style.height=At+"px"}else{const he=D.length>0&&v===D[0].ref.current;a.style.top="0px";const Ze=Math.max(Z,V+y.offsetTop+(he?ee:0)+ge)+ye;a.style.height=Ze+"px",y.scrollTop=ue-Z+y.offsetTop}a.style.margin=`${Xn}px 0`,a.style.minHeight=$+"px",a.style.maxHeight=L+"px",r==null||r(),requestAnimationFrame(()=>p.current=!0)}},[h,o.trigger,o.valueNode,a,c,y,v,x,o.dir,r]);Ot(()=>b(),[b]);const[S,C]=g.useState();Ot(()=>{c&&C(window.getComputedStyle(c).zIndex)},[c]);const k=g.useCallback(E=>{E&&m.current===!0&&(b(),w==null||w(),m.current=!1)},[b,w]);return f.jsx(m9,{scope:n,contentWrapper:a,shouldExpandOnScrollRef:p,onScrollButtonChange:k,children:f.jsx("div",{ref:l,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:S},children:f.jsx(se.div,{...i,ref:d,style:{boxSizing:"border-box",maxHeight:"100%",...i.style}})})})});SP.displayName=h9;var p9="SelectPopperPosition",cv=g.forwardRef((t,e)=>{const{__scopeSelect:n,align:r="start",collisionPadding:i=Xn,...o}=t,s=Op(n);return f.jsx(Ex,{...s,...o,ref:e,align:r,collisionPadding:i,style:{boxSizing:"border-box",...o.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});cv.displayName=p9;var[m9,$x]=Vl(Fs,{}),uv="SelectViewport",CP=g.forwardRef((t,e)=>{const{__scopeSelect:n,nonce:r,...i}=t,o=Bo(uv,n),s=$x(uv,n),a=Se(e,o.onViewportChange),l=g.useRef(0);return f.jsxs(f.Fragment,{children:[f.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:r}),f.jsx(_p.Slot,{scope:n,children:f.jsx(se.div,{"data-radix-select-viewport":"",role:"presentation",...i,ref:a,style:{position:"relative",flex:1,overflow:"hidden auto",...i.style},onScroll:H(i.onScroll,c=>{const u=c.currentTarget,{contentWrapper:d,shouldExpandOnScrollRef:h}=s;if(h!=null&&h.current&&d){const p=Math.abs(l.current-u.scrollTop);if(p>0){const m=window.innerHeight-Xn*2,y=parseFloat(d.style.minHeight),v=parseFloat(d.style.height),x=Math.max(y,v);if(x<m){const w=x+p,b=Math.min(m,w),S=w-b;d.style.height=b+"px",d.style.bottom==="0px"&&(u.scrollTop=S>0?S:0,d.style.justifyContent="flex-end")}}}l.current=u.scrollTop})})})]})});CP.displayName=uv;var kP="SelectGroup",[g9,y9]=Vl(kP),v9=g.forwardRef((t,e)=>{const{__scopeSelect:n,...r}=t,i=jr();return f.jsx(g9,{scope:n,id:i,children:f.jsx(se.div,{role:"group","aria-labelledby":i,...r,ref:e})})});v9.displayName=kP;var EP="SelectLabel",x9=g.forwardRef((t,e)=>{const{__scopeSelect:n,...r}=t,i=y9(EP,n);return f.jsx(se.div,{id:i.id,...r,ref:e})});x9.displayName=EP;var bh="SelectItem",[w9,TP]=Vl(bh),_P=g.forwardRef((t,e)=>{const{__scopeSelect:n,value:r,disabled:i=!1,textValue:o,...s}=t,a=Fo(bh,n),l=Bo(bh,n),c=a.value===r,[u,d]=g.useState(o??""),[h,p]=g.useState(!1),m=Se(e,w=>{var b;return(b=l.itemRefCallback)==null?void 0:b.call(l,w,r,i)}),y=jr(),v=g.useRef("touch"),x=()=>{i||(a.onValueChange(r),a.onOpenChange(!1))};if(r==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return f.jsx(w9,{scope:n,value:r,disabled:i,textId:y,isSelected:c,onItemTextChange:g.useCallback(w=>{d(b=>b||((w==null?void 0:w.textContent)??"").trim())},[]),children:f.jsx(_p.ItemSlot,{scope:n,value:r,disabled:i,textValue:u,children:f.jsx(se.div,{role:"option","aria-labelledby":y,"data-highlighted":h?"":void 0,"aria-selected":c&&h,"data-state":c?"checked":"unchecked","aria-disabled":i||void 0,"data-disabled":i?"":void 0,tabIndex:i?void 0:-1,...s,ref:m,onFocus:H(s.onFocus,()=>p(!0)),onBlur:H(s.onBlur,()=>p(!1)),onClick:H(s.onClick,()=>{v.current!=="mouse"&&x()}),onPointerUp:H(s.onPointerUp,()=>{v.current==="mouse"&&x()}),onPointerDown:H(s.onPointerDown,w=>{v.current=w.pointerType}),onPointerMove:H(s.onPointerMove,w=>{var b;v.current=w.pointerType,i?(b=l.onItemLeave)==null||b.call(l):v.current==="mouse"&&w.currentTarget.focus({preventScroll:!0})}),onPointerLeave:H(s.onPointerLeave,w=>{var b;w.currentTarget===document.activeElement&&((b=l.onItemLeave)==null||b.call(l))}),onKeyDown:H(s.onKeyDown,w=>{var S;((S=l.searchRef)==null?void 0:S.current)!==""&&w.key===" "||(o9.includes(w.key)&&x(),w.key===" "&&w.preventDefault())})})})})});_P.displayName=bh;var pc="SelectItemText",RP=g.forwardRef((t,e)=>{const{__scopeSelect:n,className:r,style:i,...o}=t,s=Fo(pc,n),a=Bo(pc,n),l=TP(pc,n),c=c9(pc,n),[u,d]=g.useState(null),h=Se(e,x=>d(x),l.onItemTextChange,x=>{var w;return(w=a.itemTextRefCallback)==null?void 0:w.call(a,x,l.value,l.disabled)}),p=u==null?void 0:u.textContent,m=g.useMemo(()=>f.jsx("option",{value:l.value,disabled:l.disabled,children:p},l.value),[l.disabled,l.value,p]),{onNativeOptionAdd:y,onNativeOptionRemove:v}=c;return Ot(()=>(y(m),()=>v(m)),[y,v,m]),f.jsxs(f.Fragment,{children:[f.jsx(se.span,{id:l.textId,...o,ref:h}),l.isSelected&&s.valueNode&&!s.valueNodeHasChildren?Vs.createPortal(o.children,s.valueNode):null]})});RP.displayName=pc;var OP="SelectItemIndicator",b9=g.forwardRef((t,e)=>{const{__scopeSelect:n,...r}=t;return TP(OP,n).isSelected?f.jsx(se.span,{"aria-hidden":!0,...r,ref:e}):null});b9.displayName=OP;var dv="SelectScrollUpButton",PP=g.forwardRef((t,e)=>{const n=Bo(dv,t.__scopeSelect),r=$x(dv,t.__scopeSelect),[i,o]=g.useState(!1),s=Se(e,r.onScrollButtonChange);return Ot(()=>{if(n.viewport&&n.isPositioned){let a=function(){const c=l.scrollTop>0;o(c)};const l=n.viewport;return a(),l.addEventListener("scroll",a),()=>l.removeEventListener("scroll",a)}},[n.viewport,n.isPositioned]),i?f.jsx(IP,{...t,ref:s,onAutoScroll:()=>{const{viewport:a,selectedItem:l}=n;a&&l&&(a.scrollTop=a.scrollTop-l.offsetHeight)}}):null});PP.displayName=dv;var fv="SelectScrollDownButton",MP=g.forwardRef((t,e)=>{const n=Bo(fv,t.__scopeSelect),r=$x(fv,t.__scopeSelect),[i,o]=g.useState(!1),s=Se(e,r.onScrollButtonChange);return Ot(()=>{if(n.viewport&&n.isPositioned){let a=function(){const c=l.scrollHeight-l.clientHeight,u=Math.ceil(l.scrollTop)<c;o(u)};const l=n.viewport;return a(),l.addEventListener("scroll",a),()=>l.removeEventListener("scroll",a)}},[n.viewport,n.isPositioned]),i?f.jsx(IP,{...t,ref:s,onAutoScroll:()=>{const{viewport:a,selectedItem:l}=n;a&&l&&(a.scrollTop=a.scrollTop+l.offsetHeight)}}):null});MP.displayName=fv;var IP=g.forwardRef((t,e)=>{const{__scopeSelect:n,onAutoScroll:r,...i}=t,o=Bo("SelectScrollButton",n),s=g.useRef(null),a=Rp(n),l=g.useCallback(()=>{s.current!==null&&(window.clearInterval(s.current),s.current=null)},[]);return g.useEffect(()=>()=>l(),[l]),Ot(()=>{var u;const c=a().find(d=>d.ref.current===document.activeElement);(u=c==null?void 0:c.ref.current)==null||u.scrollIntoView({block:"nearest"})},[a]),f.jsx(se.div,{"aria-hidden":!0,...i,ref:e,style:{flexShrink:0,...i.style},onPointerDown:H(i.onPointerDown,()=>{s.current===null&&(s.current=window.setInterval(r,50))}),onPointerMove:H(i.onPointerMove,()=>{var c;(c=o.onItemLeave)==null||c.call(o),s.current===null&&(s.current=window.setInterval(r,50))}),onPointerLeave:H(i.onPointerLeave,()=>{l()})})}),S9="SelectSeparator",C9=g.forwardRef((t,e)=>{const{__scopeSelect:n,...r}=t;return f.jsx(se.div,{"aria-hidden":!0,...r,ref:e})});C9.displayName=S9;var hv="SelectArrow",k9=g.forwardRef((t,e)=>{const{__scopeSelect:n,...r}=t,i=Op(n),o=Fo(hv,n),s=Bo(hv,n);return o.open&&s.position==="popper"?f.jsx(Tx,{...i,...r,ref:e}):null});k9.displayName=hv;function AP(t){return t===""||t===void 0}var NP=g.forwardRef((t,e)=>{const{value:n,...r}=t,i=g.useRef(null),o=Se(e,i),s=r9(n);return g.useEffect(()=>{const a=i.current,l=window.HTMLSelectElement.prototype,u=Object.getOwnPropertyDescriptor(l,"value").set;if(s!==n&&u){const d=new Event("change",{bubbles:!0});u.call(a,n),a.dispatchEvent(d)}},[s,n]),f.jsx(kp,{asChild:!0,children:f.jsx("select",{...r,ref:o,defaultValue:n})})});NP.displayName="BubbleSelect";function DP(t){const e=Pt(t),n=g.useRef(""),r=g.useRef(0),i=g.useCallback(s=>{const a=n.current+s;e(a),function l(c){n.current=c,window.clearTimeout(r.current),c!==""&&(r.current=window.setTimeout(()=>l(""),1e3))}(a)},[e]),o=g.useCallback(()=>{n.current="",window.clearTimeout(r.current)},[]);return g.useEffect(()=>()=>window.clearTimeout(r.current),[]),[n,i,o]}function jP(t,e,n){const i=e.length>1&&Array.from(e).every(c=>c===e[0])?e[0]:e,o=n?t.indexOf(n):-1;let s=E9(t,Math.max(o,0));i.length===1&&(s=s.filter(c=>c!==n));const l=s.find(c=>c.textValue.toLowerCase().startsWith(i.toLowerCase()));return l!==n?l:void 0}function E9(t,e){return t.map((n,r)=>t[(e+r)%t.length])}var Di=fP,ji=pP,Li=gP,$i=yP,Fi=vP,Bi=xP,zi=CP,LP=_P,$P=RP,Vi=PP,Ui=MP;const la=({children:t,className:e,...n})=>f.jsx(LP,{className:`text-[13px] leading-none text-gray-700 rounded-[3px] flex items-center h-[25px] pr-[35px] pl-[25px] relative select-none data-[disabled]:text-gray-400 data-[disabled]:pointer-events-none data-[highlighted]:outline-none data-[highlighted]:bg-blue-100 data-[highlighted]:text-blue-900 ${e}`,...n,children:f.jsx($P,{children:t})});function T9(){const t=Je(),{user:e}=It(),n=Ur(),[r,i]=g.useState(Ra);g.useEffect(()=>{e!=null&&e.note_preferences&&i(a=>({...a,...e.note_preferences}))},[e==null?void 0:e.note_preferences]);const{mutateAsync:o}=Pr({mutationFn:async a=>{if(!(e!=null&&e.id))throw new Error("No user found");const l=e.note_preferences||Ra,{error:c}=await t.from("user_profiles").update({note_preferences:{...l,...a}}).eq("id",e.id);if(c)throw c},onSuccess:()=>{n.invalidateQueries({queryKey:["user"]})}}),s=(a,l)=>{i(c=>({...c,[a]:l})),o({[a]:l}).catch(c=>{console.error("Failed to update preferences:",c)})};return f.jsxs("div",{className:"h-full overflow-auto pr-4 pb-12",children:[f.jsx("div",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Editor Settings"}),f.jsx("div",{className:"space-y-6",children:f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Default Copy Mode"}),f.jsxs(Di,{value:r.default_copy_mode,onValueChange:a=>s("default_copy_mode",a),children:[f.jsxs(ji,{className:"inline-flex items-center justify-between rounded-md px-3 py-2 text-sm leading-none gap-1 bg-white border border-gray-300 h-9 w-full max-w-md outline-none focus:border-blue-500 data-[placeholder]:text-gray-500",children:[f.jsx(Li,{}),f.jsx($i,{children:f.jsx(Ye,{className:"h-4 w-4 text-gray-500"})})]}),f.jsx(Fi,{children:f.jsxs(Bi,{className:"overflow-hidden bg-white rounded-md shadow-lg border border-gray-200",children:[f.jsx(Vi,{className:"flex items-center justify-center h-6 bg-white text-gray-500 cursor-default",children:f.jsx(Ni,{})}),f.jsx(zi,{className:"p-1",children:e9.map(a=>f.jsx(la,{value:a.value,children:a.label},a.value))}),f.jsx(Ui,{className:"flex items-center justify-center h-6 bg-white text-gray-500 cursor-default",children:f.jsx(Ye,{})})]})})]})]})}),f.jsx("div",{className:"text-lg font-semibold text-gray-900 mt-8 mb-4",children:"Date"}),f.jsx("div",{className:"space-y-6",children:f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date format"}),f.jsxs(Di,{value:r.date_format,onValueChange:a=>s("date_format",a),children:[f.jsxs(ji,{className:"inline-flex items-center justify-between rounded-md px-3 py-2 text-sm leading-none gap-1 bg-white border border-gray-300 h-9 w-full max-w-md outline-none focus:border-blue-500 data-[placeholder]:text-gray-500",children:[f.jsx(Li,{}),f.jsx($i,{children:f.jsx(Ye,{className:"h-4 w-4 text-gray-500"})})]}),f.jsx(Fi,{children:f.jsxs(Bi,{className:"overflow-hidden bg-white rounded-md shadow-lg border border-gray-200",children:[f.jsx(Vi,{className:"flex items-center justify-center h-6 bg-white text-gray-500 cursor-default",children:f.jsx(Ni,{})}),f.jsx(zi,{className:"p-1",children:t9.map(a=>f.jsx(la,{value:a.value,children:a.label},a.value))}),f.jsx(Ui,{className:"flex items-center justify-center h-6 bg-white text-gray-500 cursor-default",children:f.jsx(Ye,{})})]})})]})]})}),f.jsx("div",{className:"text-lg font-semibold text-gray-900 mt-8 mb-4",children:"Language & spelling"}),f.jsxs("div",{className:"grid grid-cols-2 gap-x-6 gap-y-6",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Primary Spoken Language"}),f.jsxs(Di,{value:r.primary_language,onValueChange:a=>s("primary_language",a),children:[f.jsxs(ji,{className:"inline-flex items-center justify-between rounded-md px-3 py-2 text-sm leading-none gap-1 bg-white border border-gray-300 h-9 w-full max-w-md outline-none focus:border-blue-500 data-[placeholder]:text-gray-500",children:[f.jsx(Li,{}),f.jsx($i,{children:f.jsx(Ye,{className:"h-4 w-4 text-gray-500"})})]}),f.jsx(Fi,{children:f.jsxs(Bi,{className:"overflow-hidden bg-white rounded-md shadow-lg border border-gray-200",children:[f.jsx(Vi,{className:"flex items-center justify-center h-6 bg-white text-gray-500 cursor-default",children:f.jsx(Ni,{})}),f.jsx(zi,{className:"p-1",children:lv.map(a=>f.jsx(la,{value:a.value,children:a.label},a.value))}),f.jsx(Ui,{className:"flex items-center justify-center h-6 bg-white text-gray-500 cursor-default",children:f.jsx(Ye,{})})]})})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Default Note Language"}),f.jsxs(Di,{value:r.preferred_note_language,onValueChange:a=>s("preferred_note_language",a),children:[f.jsxs(ji,{className:"inline-flex items-center justify-between rounded-md px-3 py-2 text-sm leading-none gap-1 bg-white border border-gray-300 h-9 w-full max-w-md outline-none focus:border-blue-500 data-[placeholder]:text-gray-500",children:[f.jsx(Li,{}),f.jsx($i,{children:f.jsx(Ye,{className:"h-4 w-4 text-gray-500"})})]}),f.jsx(Fi,{children:f.jsxs(Bi,{className:"overflow-hidden bg-white rounded-md shadow-lg border border-gray-200",children:[f.jsx(Vi,{className:"flex items-center justify-center h-6 bg-white text-gray-500 cursor-default",children:f.jsx(Ni,{})}),f.jsx(zi,{className:"p-1",children:lv.filter(a=>a.value!=="auto").map(a=>f.jsx(la,{value:a.value,children:a.label},a.value))}),f.jsx(Ui,{className:"flex items-center justify-center h-6 bg-white text-gray-500 cursor-default",children:f.jsx(Ye,{})})]})})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Patient Instructions Language"}),f.jsxs(Di,{value:r.patient_instructions_language,onValueChange:a=>s("patient_instructions_language",a),children:[f.jsxs(ji,{className:"inline-flex items-center justify-between rounded-md px-3 py-2 text-sm leading-none gap-1 bg-white border border-gray-300 h-9 w-full max-w-md outline-none focus:border-blue-500 data-[placeholder]:text-gray-500",children:[f.jsx(Li,{}),f.jsx($i,{children:f.jsx(Ye,{className:"h-4 w-4 text-gray-500"})})]}),f.jsx(Fi,{children:f.jsxs(Bi,{className:"overflow-hidden bg-white rounded-md shadow-lg border border-gray-200",children:[f.jsx(Vi,{className:"flex items-center justify-center h-6 bg-white text-gray-500 cursor-default",children:f.jsx(Ni,{})}),f.jsx(zi,{className:"p-1",children:dP.map(a=>f.jsx(la,{value:a.value,children:a.label},a.value))}),f.jsx(Ui,{className:"flex items-center justify-center h-6 bg-white text-gray-500 cursor-default",children:f.jsx(Ye,{})})]})})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Spelling"}),f.jsxs(Di,{value:r.spelling,onValueChange:a=>s("spelling",a),children:[f.jsxs(ji,{className:"inline-flex items-center justify-between rounded-md px-3 py-2 text-sm leading-none gap-1 bg-white border border-gray-300 h-9 w-full max-w-md outline-none focus:border-blue-500 data-[placeholder]:text-gray-500",children:[f.jsx(Li,{}),f.jsx($i,{children:f.jsx(Ye,{className:"h-4 w-4 text-gray-500"})})]}),f.jsx(Fi,{children:f.jsxs(Bi,{className:"overflow-hidden bg-white rounded-md shadow-lg border border-gray-200",children:[f.jsx(Vi,{className:"flex items-center justify-center h-6 bg-white text-gray-500 cursor-default",children:f.jsx(Ni,{})}),f.jsx(zi,{className:"p-1",children:n9.map(a=>f.jsx(la,{value:a.value,children:a.label},a.value))}),f.jsx(Ui,{className:"flex items-center justify-center h-6 bg-white text-gray-500 cursor-default",children:f.jsx(Ye,{})})]})})]})]})]}),f.jsx("div",{className:"text-lg font-semibold text-gray-900 mt-8 mb-4",children:"Reference format"}),f.jsxs("div",{className:"grid grid-cols-2 gap-x-6 gap-y-6",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Refer to patient"}),f.jsx("input",{className:"w-full max-w-md rounded-md border border-gray-300 px-3 py-2 text-sm outline-none focus:border-blue-500",type:"text",value:r.patient_reference_format,onChange:a=>s("patient_reference_format",a.target.value),placeholder:"e.g Title + Firstname + Lastname"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Refer to clinician"}),f.jsx("input",{className:"w-full max-w-md rounded-md border border-gray-300 px-3 py-2 text-sm outline-none focus:border-blue-500",type:"text",value:r.clinician_reference_format,onChange:a=>s("clinician_reference_format",a.target.value),placeholder:"e.g Dr Smith"})]})]})]})}function _9(){const[t,e]=g.useState("preferences");return f.jsx("div",{style:Bt.container,children:f.jsxs("div",{style:Bt.section,children:[f.jsxs("div",{style:Bt.header,children:[f.jsx("h1",{style:Bt.title,children:"Settings"}),f.jsxs("div",{style:Bt.tabs,children:[f.jsx("div",{style:{...Bt.tab,...t==="preferences"?Bt.activeTab:{}},onClick:()=>e("preferences"),children:"Note Preferences"}),f.jsx("div",{style:{...Bt.tab,...t==="memory"?Bt.activeTab:{}},onClick:()=>e("memory"),children:"Memory"})]})]}),f.jsx("div",{style:Bt.contentContainer,children:t==="preferences"?f.jsx(T9,{}):f.jsx(G8,{})})]})})}const Ne={container:{padding:"32px",width:"100%",height:"100%",backgroundColor:"#fff"},section:{maxWidth:"1200px",margin:"0 auto"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"32px"},title:{fontSize:"24px",fontWeight:"600",color:"#1f2937"},actions:{display:"flex",gap:"12px"},button:{display:"flex",alignItems:"center",gap:"8px",padding:"8px 16px",borderRadius:"6px",fontSize:"14px",fontWeight:"500"},primaryButton:{backgroundColor:"#1f2937",color:"white",border:"none"},secondaryButton:{backgroundColor:"transparent",color:"#1f2937",border:"1px solid #e5e7eb"},searchBar:{display:"flex",gap:"12px",marginBottom:"24px"},searchInput:{flex:"1",maxWidth:"320px",padding:"8px 12px",border:"1px solid #e5e7eb",borderRadius:"6px",fontSize:"14px"},table:{width:"100%",borderCollapse:"collapse"},tableHeader:{textAlign:"left",padding:"12px 16px",fontSize:"14px",fontWeight:"500",color:"#6b7280",borderBottom:"1px solid #e5e7eb"},tableCell:{padding:"12px 16px",fontSize:"14px",color:"#374151",borderBottom:"1px solid #e5e7eb"},templateType:{fontSize:"12px",padding:"4 px 6px",marginLeft:"8px",backgroundColor:"#f3f4f6",borderRadius:"12px",color:"#6b7280"},actionButton:{padding:"4px",border:"none",background:"none",cursor:"pointer",color:"#6b7280","&:hover":{color:"#374151"}}};function R9(){const[t,e]=g.useState([]),[n,r]=g.useState(!0),[i,o]=g.useState(""),s=Je(),{user:a}=It();g.useEffect(()=>{(async()=>{try{if(!(a!=null&&a.id))return;const{data:u,error:d}=await s.from("template_library").select("*").or(`owner_id.eq.${a.id}`).order("name");if(d)throw d;e(u||[])}catch(u){console.error("Error fetching templates:",u)}finally{r(!1)}})()},[s,a==null?void 0:a.id]);const l=t.filter(c=>c.name.toLowerCase().includes(i.toLowerCase()));return n?f.jsx("div",{style:Ne.container,children:f.jsxs("div",{style:Ne.section,children:[f.jsx("h1",{style:Ne.title,children:"My Templates"}),f.jsx("div",{children:"Loading templates..."})]})}):f.jsx("div",{style:Ne.container,children:f.jsxs("div",{style:Ne.section,children:[f.jsxs("div",{style:Ne.header,children:[f.jsx("h1",{style:Ne.title,children:"My Templates"}),f.jsxs("div",{style:Ne.actions,children:[f.jsx("button",{style:{...Ne.button,...Ne.secondaryButton},children:"Browse community"}),f.jsx("button",{style:{...Ne.button,...Ne.primaryButton},children:"Create template"})]})]}),f.jsx("div",{style:Ne.searchBar,children:f.jsx("input",{type:"text",placeholder:"Search templates...",value:i,onChange:c=>o(c.target.value),style:Ne.searchInput})}),f.jsxs("table",{style:Ne.table,children:[f.jsx("thead",{children:f.jsxs("tr",{children:[f.jsx("th",{style:Ne.tableHeader,children:"Template name"}),f.jsx("th",{style:Ne.tableHeader,children:"Creator"}),f.jsx("th",{style:Ne.tableHeader,children:"Visibility"}),f.jsx("th",{style:Ne.tableHeader})]})}),f.jsx("tbody",{children:l.map(c=>f.jsxs("tr",{children:[f.jsxs("td",{style:Ne.tableCell,children:[c.name,f.jsx("span",{style:Ne.templateType,children:c.type})]}),f.jsx("td",{style:Ne.tableCell,children:c.owner_id===(a==null?void 0:a.id)?"Me":"Library"}),f.jsx("td",{style:Ne.tableCell,children:"Just me"}),f.jsx("td",{style:Ne.tableCell,children:f.jsx("button",{style:Ne.actionButton,children:"•••"})})]},c.id))})]})]})})}const ft={container:{padding:"32px",width:"100%",height:"100%",backgroundColor:"#fff"},section:{maxWidth:"1200px",margin:"0 auto"},title:{fontSize:"16px",fontWeight:"500",marginBottom:"32px",color:"#1f2937"},searchContainer:{marginBottom:"24px"},searchInput:{width:"100%",maxWidth:"400px",padding:"8px 16px",fontSize:"14px",border:"1px solid #e5e7eb",borderRadius:"6px","&:focus":{outline:"none",borderColor:"#2563eb",boxShadow:"0 0 0 2px rgba(37, 99, 235, 0.2)"}},templateGrid:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:"16px",marginTop:"24px"},templateCard:{backgroundColor:"white",borderRadius:"8px",border:"1px solid #e5e7eb",padding:"16px",transition:"all 0.2s ease","&:hover":{transform:"translateY(-2px)",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)"}},templateName:{fontSize:"18px",fontWeight:"500",color:"#111827",marginBottom:"8px"},templateDescription:{fontSize:"14px",color:"#6b7280",marginBottom:"12px"},templateMeta:{display:"flex",justifyContent:"space-between",alignItems:"center",fontSize:"12px",color:"#6b7280"},templateType:{display:"inline-block",padding:"2px 8px",backgroundColor:"#f3f4f6",borderRadius:"12px",fontSize:"12px",color:"#374151"},noTemplates:{textAlign:"center",padding:"48px",color:"#6b7280",backgroundColor:"#f9fafb",borderRadius:"8px",border:"1px dashed #e5e7eb"},tagsContainer:{display:"flex",flexWrap:"wrap",gap:"8px",marginBottom:"12px"},tag:{display:"inline-block",padding:"2px 8px",backgroundColor:"#e5e7eb",borderRadius:"12px",fontSize:"12px",color:"#374151"}};function O9(){const[t,e]=g.useState([]),[n,r]=g.useState(!0),[i,o]=g.useState(""),s=Je(),{user:a}=It();return g.useEffect(()=>{(async()=>{try{const c=s.from("template_library").select("*").neq("owner_id",(a==null?void 0:a.id)||"").order("name");i&&c.or(`name.ilike.%${i}%,description.ilike.%${i}%`);const{data:u,error:d}=await c;if(d)throw d;e(u||[])}catch(c){console.error("Error fetching templates:",c)}finally{r(!1)}})()},[s,i,a==null?void 0:a.id]),n?f.jsx("div",{style:ft.container,children:f.jsxs("div",{style:ft.section,children:[f.jsx("h1",{style:ft.title,children:"Community Templates"}),f.jsx("div",{children:"Loading templates..."})]})}):f.jsx("div",{style:ft.container,children:f.jsxs("div",{style:ft.section,children:[f.jsx("h1",{style:ft.title,children:"Community Templates"}),f.jsx("div",{style:ft.searchContainer,children:f.jsx("input",{type:"text",placeholder:"Search templates...",value:i,onChange:l=>o(l.target.value),style:ft.searchInput})}),t.length===0?f.jsx("div",{style:ft.noTemplates,children:i?"No templates found matching your search.":"No community templates available."}):f.jsx("div",{style:ft.templateGrid,children:t.map(l=>f.jsxs("div",{style:ft.templateCard,children:[f.jsx("div",{style:ft.templateName,children:l.name}),l.description&&f.jsx("div",{style:ft.templateDescription,children:l.description}),l.tags&&l.tags.length>0&&f.jsx("div",{style:ft.tagsContainer,children:l.tags.map((c,u)=>f.jsx("span",{style:ft.tag,children:c},u))}),f.jsxs("div",{style:ft.templateMeta,children:[f.jsx("div",{style:ft.templateType,children:l.type.charAt(0).toUpperCase()+l.type.slice(1)}),l.specialty&&f.jsx("div",{children:l.specialty})]})]},l.id))})]})})}function Si({children:t}){const{user:e,loading:n,error:r}=It(),i=Gn(),[o,s]=g.useState(!0);return console.log("ProtectedRoute state:",{isAuthenticated:!!e,userId:e==null?void 0:e.id,isLoading:n,hasError:!!r,errorMessage:r,path:i.pathname,isInitialLoad:o}),g.useEffect(()=>{!n&&o&&s(!1)},[n]),n||o?f.jsxs("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,height:"100vh",width:"100vw",display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:"#f3f4f6",flexDirection:"column",gap:"12px",zIndex:9999},children:[f.jsx("div",{style:{width:"48px",height:"48px",border:"4px solid #e5e7eb",borderTopColor:"#3b82f6",borderRadius:"50%",animation:"spin 1s linear infinite"}}),f.jsx("div",{style:{fontSize:"16px",color:"#4b5563",marginTop:"16px"},children:"Loading..."}),f.jsx("style",{children:`
          @keyframes spin {
            to {
              transform: rotate(360deg);
            }
          }
        `})]}):(r&&console.error("ProtectedRoute error:",r),e?(console.log("ProtectedRoute: User authenticated, rendering protected content"),f.jsx(f.Fragment,{children:t})):(console.log("ProtectedRoute: No user found, redirecting to login"),f.jsx(Vf,{to:"/login",state:{from:i},replace:!0})))}const _e={container:{flex:1,overflowY:"auto",display:"flex",flexDirection:"column"},filtersContainer:{padding:"12px",backgroundColor:"white",borderBottom:"1px solid #e5e7eb",display:"flex",gap:"8px",position:"sticky",top:0,zIndex:10},searchContainer:{flex:1,position:"relative"},searchInput:{width:"100%",padding:"8px 12px 8px 36px",fontSize:"14px",borderRadius:"6px",border:"1px solid #e5e7eb",outline:"none"},searchIcon:{position:"absolute",left:"12px",top:"50%",transform:"translateY(-50%)",color:"#6b7280"},filterButton:{display:"flex",alignItems:"center",gap:"4px",padding:"8px 12px",fontSize:"14px",backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"6px",cursor:"pointer"},dropdownContent:{minWidth:"160px",backgroundColor:"white",borderRadius:"6px",padding:"5px",boxShadow:"0px 10px 38px -10px rgba(22, 23, 24, 0.35), 0px 10px 20px -15px rgba(22, 23, 24, 0.2)",zIndex:9999},dropdownItem:{fontSize:"14px",lineHeight:"1",color:"#374151",borderRadius:"3px",display:"flex",alignItems:"center",height:"32px",padding:"0 8px",userSelect:"none",outline:"none",cursor:"pointer"},selectedDropdownItem:{backgroundColor:"#f0f9ff",color:"#2563eb"},listContainer:{flex:1,overflowY:"auto"},dateGroup:{display:"flex",flexDirection:"column",gap:"1px",marginBottom:"16px"},dateHeader:{fontSize:"12px",fontWeight:"600",color:"#6b7280",padding:"4px 12px",backgroundColor:"#f9fafb",borderTop:"1px solid #e5e7eb",borderBottom:"1px solid #e5e7eb",textTransform:"uppercase",letterSpacing:"0.05em"},visitItem:{display:"flex",flexDirection:"column",padding:"8px 12px",backgroundColor:"white",cursor:"pointer",transition:"all 0.2s ease",position:"relative"},selectedVisit:{backgroundColor:"#f0f9ff"},visitHeader:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",gap:"8px"},visitName:{fontSize:"15px",fontWeight:"600",color:"#111827",flex:1},visitState:{fontSize:"12px",padding:"2px 6px",borderRadius:"4px",backgroundColor:"#f3f4f6",color:"#374151",textTransform:"capitalize",flexShrink:0},visitTime:{fontSize:"12px",color:"#6b7280",marginTop:"2px"},loadingContainer:{display:"flex",justifyContent:"center",alignItems:"center",height:"100px",color:"#6b7280"},actionIcons:{position:"absolute",bottom:"8px",right:"12px",display:"flex",gap:"6px",opacity:0,transition:"opacity 0.2s ease"},actionIconsVisible:{opacity:1},iconButton:{background:"none",backgroundColor:"transparent",border:"none",cursor:"pointer",padding:"2px",borderRadius:"4px",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s ease"},iconButtonHover:{backgroundColor:"#d1d5db"},trashIcon:{},letterIcon:{}},P9=g.memo(function({visit:e,isSelected:n,onSelect:r}){const[i,o]=g.useState(!1),[s,a]=g.useState(!1),[l,c]=g.useState(!1),{showToast:u}=lP(),{data:d}=Xc({queryKey:["patient",e.patient_id],queryFn:async()=>{if(!e.patient_id)return null;const{data:b}=await sn.from("patient_profiles").select("name").eq("id",e.patient_id).single();return b},enabled:!!e.patient_id}),h=(d==null?void 0:d.name)||e.name||"Untitled",p=new Date(e.started_at).toLocaleTimeString([],{hour:"numeric",minute:"2-digit"}),y=`${new Date(e.started_at).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})} at ${p}`,v=async b=>{b.stopPropagation();const{error:S}=await sn.from("visits").update({state:"trash"}).eq("id",e.id);S?(console.error("Error updating visit state:",S),u("Error","Failed to move visit to trash","error")):u("Success",`"${h}" (${y}) moved to trash`,"success")},x=async b=>{b.stopPropagation();const{error:S}=await sn.from("visits").update({state:"completed"}).eq("id",e.id);S?(console.error("Error updating visit state:",S),u("Error","Failed to mark visit as completed","error")):u("Success",`"${h}" (${y}) marked as completed`,"success")},w=async()=>{if(e.state==="ready"){const{error:b}=await sn.from("visits").update({state:"seen"}).eq("id",e.id);b&&console.error("Error updating visit state:",b)}r(e)};return f.jsxs("div",{style:{..._e.visitItem,...n?_e.selectedVisit:{}},onClick:w,onMouseEnter:()=>o(!0),onMouseLeave:()=>o(!1),children:[f.jsxs("div",{style:_e.visitHeader,children:[f.jsx("div",{style:_e.visitName,children:h}),f.jsx("div",{style:_e.visitState,children:e.state})]}),f.jsx("div",{style:_e.visitTime,children:p}),f.jsxs("div",{style:{..._e.actionIcons,...i?_e.actionIconsVisible:{}},children:[["ready","seen","completed"].includes(e.state)&&f.jsx("button",{style:{..._e.iconButton,...s?_e.iconButtonHover:{}},onClick:v,title:"Move to trash",onMouseEnter:()=>a(!0),onMouseLeave:()=>a(!1),children:f.jsx(TV,{size:14})}),["ready","seen"].includes(e.state)&&f.jsx("button",{style:{..._e.iconButton,...l?_e.iconButtonHover:{}},onClick:x,title:"Mark as completed",onMouseEnter:()=>c(!0),onMouseLeave:()=>c(!1),children:f.jsx(lV,{size:14})})]})]})});function M9({visits:t,onVisitSelect:e,selectedVisitId:n,onContinueRecording:r}){const{user:i}=It(),[o,s]=g.useState(!0),[a,l]=g.useState(""),[c,u]=g.useState("todo"),[d,h]=g.useState({});g.useEffect(()=>{const w=[...new Set(t.filter(b=>b.patient_id).map(b=>b.patient_id))];w.length>0&&(async()=>{const{data:S,error:C}=await sn.from("patient_profiles").select("id, name").in("id",w);if(!C&&S){const k=S.reduce((E,T)=>(E[T.id]=T.name,E),{});h(k)}})()},[t]);const p=g.useCallback(w=>{w.state==="paused"&&r?r(w):e==null||e(w)},[r,e]),m=g.useMemo(()=>t.filter(w=>{var k,E;if(c==="todo"){if(["trash","completed","deleted"].includes(w.state))return!1}else if(c==="all"){if(["trash","deleted"].includes(w.state))return!1}else if(c==="trash"&&w.state!=="trash")return!1;if(!a)return!0;const b=a.toLowerCase(),S=((k=w.name)==null?void 0:k.toLowerCase())||"",C=w.patient_id&&((E=d[w.patient_id])==null?void 0:E.toLowerCase())||"";return S.includes(b)||C.includes(b)}),[t,a,c,d]),y=g.useMemo(()=>m.reduce((w,b)=>{const S=new Date(b.started_at).toLocaleDateString("en-US",{month:"2-digit",day:"2-digit",year:"numeric"});return w[S]||(w[S]=[]),w[S].push(b),w},{}),[m]);g.useEffect(()=>{i!=null&&i.id&&s(t.length===0)},[i==null?void 0:i.id,t.length]);const v=w=>{switch(w){case"todo":return"To Do";case"all":return"All";case"trash":return"Trash";default:return"To Do"}};if(!(i!=null&&i.id)||o)return f.jsx("div",{style:_e.container,children:f.jsx("div",{style:_e.loadingContainer,children:o?"Your visits will appear here":"Loading..."})});const x=Object.keys(y).sort((w,b)=>new Date(b).getTime()-new Date(w).getTime());return f.jsxs("div",{style:_e.container,children:[f.jsxs("div",{style:_e.filtersContainer,children:[f.jsxs("div",{style:_e.searchContainer,children:[f.jsx("input",{type:"text",placeholder:"Search",value:a,onChange:w=>l(w.target.value),style:_e.searchInput}),f.jsx("span",{style:_e.searchIcon,children:f.jsx(gz,{width:16,height:16})})]}),f.jsxs(Sl,{children:[f.jsx(Cl,{asChild:!0,children:f.jsxs("button",{style:_e.filterButton,children:[v(c),f.jsx(Ye,{width:16,height:16})]})}),f.jsx(kl,{children:f.jsx(El,{style:_e.dropdownContent,sideOffset:5,children:["todo","all","trash"].map(w=>{const b=w===c;return f.jsx(tn,{style:{..._e.dropdownItem,...b?_e.selectedDropdownItem:{}},onClick:()=>u(w),children:v(w)},w)})})})]})]}),f.jsx("div",{style:_e.listContainer,children:x.length>0?x.map(w=>f.jsxs("div",{style:_e.dateGroup,children:[f.jsx("div",{style:_e.dateHeader,children:w}),y[w].sort((b,S)=>new Date(S.started_at).getTime()-new Date(b.started_at).getTime()).map(b=>f.jsx(P9,{visit:b,isSelected:b.id===n,onSelect:p},b.id))]},w)):f.jsx("div",{style:_e.loadingContainer,children:a?"No matching visits found":`No visits in ${v(c).toLowerCase()}`})})]})}const I9=({user:t,onSignOut:e})=>{const n=mr();return f.jsx("div",{style:Ct.userSection,children:f.jsxs(Sl,{children:[f.jsx(Cl,{asChild:!0,children:f.jsxs("button",{style:Ct.userButton,children:[f.jsxs("div",{style:Ct.userInfo,children:[f.jsxs("span",{style:Ct.userName,children:[t!=null&&t.title?`${t.title} `:""," ",t!=null&&t.name?`${t.name}`:"User"]}),f.jsx("span",{style:Ct.userSpecialty,children:(t==null?void 0:t.specialty)||"No specialty set"})]}),f.jsx(Ye,{style:Ct.chevronIcon})]})}),f.jsx(kl,{children:f.jsxs(El,{style:Ct.dropdownContent,sideOffset:5,align:"start",children:[f.jsx(tn,{asChild:!0,children:f.jsx("button",{style:Ct.dropdownItem,onClick:()=>n("/profile"),children:"Profile"})}),f.jsx(tn,{asChild:!0,children:f.jsx("button",{style:Ct.dropdownItem,onClick:()=>n("/settings"),children:"Settings"})}),f.jsx(tn,{asChild:!0,children:f.jsx("button",{style:Ct.dropdownItem,onClick:()=>n("/group"),children:"Group Settings"})}),f.jsx(tn,{asChild:!0,children:f.jsx("button",{style:Ct.dropdownItem,onClick:()=>n("/patients"),children:"Patients"})}),f.jsx(RS,{style:Ct.dropdownSeparator}),f.jsx(tn,{asChild:!0,children:f.jsx("button",{style:Ct.dropdownItem,onClick:()=>n("/my-templates"),children:"My Templates"})}),f.jsx(tn,{asChild:!0,children:f.jsx("button",{style:Ct.dropdownItem,onClick:()=>n("/community-templates"),children:"Community Templates"})}),f.jsx(RS,{style:Ct.dropdownSeparator}),f.jsx(tn,{asChild:!0,children:f.jsx("button",{style:Ct.dropdownItem,onClick:e,children:"Logout"})})]})})]})})},Ct={userSection:{padding:"12px",borderBottom:"1px solid #e5e7eb"},userButton:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%",padding:"8px",border:"none",borderRadius:"6px",background:"transparent",cursor:"pointer",":hover":{backgroundColor:"#f5f5f5"}},userInfo:{display:"flex",flexDirection:"column",alignItems:"flex-start",gap:"2px"},userName:{fontSize:"14px",fontWeight:600,color:"#111827"},userSpecialty:{fontSize:"12px",color:"#6b7280",fontWeight:500},chevronIcon:{width:"16px",height:"16px",color:"#666"},dropdownContent:{maxWidth:"280px",backgroundColor:"white",borderRadius:"6px",padding:"4px",boxShadow:"0 2px 10px rgba(0, 0, 0, 0.1)",zIndex:100},dropdownItem:{width:"100%",border:"none",borderRadius:"4px",padding:"8px 12px",fontSize:"14px",textAlign:"left",backgroundColor:"transparent",cursor:"pointer",":hover":{backgroundColor:"#f5f5f5"}},dropdownSeparator:{height:"1px",backgroundColor:"#eaeaea",margin:"4px 0"}},Zm={sidebar:{width:"240px",backgroundColor:"#ffffff",display:"flex",flexDirection:"column",overflow:"hidden",borderRight:"1px solid #d1d5db",height:"100vh",position:"relative",zIndex:50},userSection:{padding:"16px 16px 12px 16px",borderBottom:"1px solid #d1d5db",backgroundColor:"#ffffff",marginBottom:"8px"},userButton:{width:"100%",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"12px",backgroundColor:"transparent",border:"none",cursor:"pointer",transition:"all 0.2s ease","&:hover":{backgroundColor:"#f3f4f6"}},userInfo:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1},userName:{fontSize:"14px",fontWeight:"500",color:"#111827"},userEmail:{fontSize:"12px",color:"#6b7280",marginTop:"2px"},chevronIcon:{color:"#9ca3af",width:"12px",height:"12px",marginLeft:"8px",flexShrink:0},dropdownContent:{minWidth:"200px",backgroundColor:"white",borderRadius:"8px",padding:"6px",boxShadow:"0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05)",border:"1px solid #e5e7eb"},dropdownItem:{fontSize:"14px",padding:"8px 12px",borderRadius:"6px",cursor:"pointer",color:"#374151",display:"block",width:"100%",textAlign:"left",border:"none",backgroundColor:"transparent",transition:"all 0.2s ease","&:hover":{backgroundColor:"#f3f4f6",color:"#111827"}},dropdownSeparator:{height:"1px",backgroundColor:"#e5e7eb",margin:"6px"},newSessionButton:{display:"flex",alignItems:"center",backgroundColor:"#FF8080",color:"#ffffff",border:"none",cursor:"pointer",fontSize:"14px",fontWeight:"600",margin:"16px 12px 16px 12px",width:"calc(100% - 24px)",justifyContent:"center",borderRadius:"8px",transition:"all 0.2s ease","&:hover":{backgroundColor:"#ff6666",transform:"translateY(-1px)"},"&:active":{transform:"translateY(0px)"}},visitsContainer:{flex:1,overflow:"auto",borderTop:"1px solid #e5e7eb"}};function A9({onNewSession:t,onVisitSelect:e,selectedVisitId:n,onContinueRecording:r,visits:i=[]}){const o=mr(),{user:s}=It(),{signOut:a}=uP();console.log("[Sidebar] Render with visits:",i.length);const l=async()=>{try{await a(),o("/login")}catch(c){console.error("Error signing out:",c)}};if(s)return f.jsxs("div",{style:Zm.sidebar,children:[f.jsx(I9,{user:s,onSignOut:l}),f.jsx("button",{style:Zm.newSessionButton,onClick:t,children:"New Session"}),f.jsx("div",{style:Zm.visitsContainer,children:f.jsx(M9,{visits:i,onVisitSelect:e,selectedVisitId:n,onContinueRecording:r})})]})}const Ke=(...t)=>{console.log("[useRealtimeVisits]",...t)};function N9(t){const[e,n]=g.useState([]),r=g.useRef(!1),i=g.useRef(null),o=g.useRef(null),s=g.useRef([]);g.useEffect(()=>{s.current=e,Ke("Updated visitsRef:",e.length,"visits")},[e]),g.useEffect(()=>{if(!t||r.current)return;(async()=>{Ke("Fetching initial visits for user:",t);const{data:c,error:u}=await sn.from("visits").select("*").eq("user_id",t).order("started_at",{ascending:!1});if(u){Ke("Error fetching initial visits:",u);return}c&&(Ke(`Setting initial ${c.length} visits`),n(c),s.current=c,r.current=!0)})()},[t]);const a=g.useCallback(l=>{const c=[...l].sort((u,d)=>new Date(d.started_at).getTime()-new Date(u.started_at).getTime());n(c)},[]);return g.useEffect(()=>{if(!t){Ke("No userId, skipping subscription");return}Ke("Setting up realtime subscription for user:",t),i.current&&(Ke("Cleaning up existing subscription"),i.current.unsubscribe(),i.current=null);const l=sn.channel(`visits_list_${t}`).on("postgres_changes",{event:"*",schema:"public",table:"visits",filter:`user_id=eq.${t}`},c=>{const u=new Date().toISOString(),d=o.current?new Date(u).getTime()-new Date(o.current).getTime():null;switch(Ke("Received realtime event:",c.eventType,{...c,timeSinceLastUpdate:d?`${d}ms`:"first update",currentVisitsCount:s.current.length}),o.current=u,c.eventType){case yo.INSERT:{const h=c.new;if(Ke("Processing insert for visit:",h.id),s.current.some(m=>m.id===h.id)){Ke("Visit already exists, skipping insert:",h.id);return}const p=[h,...s.current];Ke(`Updating visits after insert: ${p.length} visits`),a(p);break}case yo.UPDATE:{const h=c.new;Ke("Processing update for visit:",h.id);const p=s.current.map(m=>m.id===h.id?h:m);Ke(`Updating visits after update: ${p.length} visits`),a(p);break}case yo.DELETE:{const h=c.old;Ke("Processing delete for visit:",h.id);const p=s.current.filter(m=>m.id!==h.id);Ke(`Updating visits after delete: ${p.length} visits`),a(p);break}}}).subscribe(async c=>{if(Ke("Subscription status:",c),c==="SUBSCRIBED"){Ke("Requerying visits on subscription established");const{data:u,error:d}=await sn.from("visits").select("*").eq("user_id",t).order("started_at",{ascending:!1});if(d){Ke("Error requerying visits:",d);return}u&&(Ke(`Setting ${u.length} visits from requery`),a(u))}});return i.current=l,()=>{Ke("Cleaning up subscription in effect cleanup"),l.unsubscribe(),i.current=null}},[t,a]),g.useEffect(()=>{Ke("Visits state updated:",e.length,"visits")},[e]),e}function eg({title:t,children:e}){const[n,r]=g.useState(!1);return f.jsxs("div",{className:"border border-gray-200 rounded-md mb-4",children:[f.jsxs("button",{onClick:()=>r(!n),className:"w-full px-4 py-3 flex items-center justify-between bg-gray-50 hover:bg-gray-100 transition-colors rounded-t-md",children:[f.jsx("h3",{className:"text-sm font-medium text-gray-700",children:t}),n?f.jsx(UR,{className:"h-4 w-4 text-gray-500"}):f.jsx(nV,{className:"h-4 w-4 text-gray-500"})]}),n&&f.jsx("div",{className:"p-4 bg-white rounded-b-md",children:e})]})}function D9({onClick:t,icon:e,label:n,loading:r=!1,disabled:i=!1}){return f.jsxs("button",{onClick:t,disabled:r||i,className:`
        flex items-center gap-2 px-3 py-2 text-sm 
        ${i?"bg-gray-100 text-gray-400":"bg-gray-50 text-gray-700 hover:bg-gray-100"} 
        rounded-md transition-colors
        ${r?"cursor-not-allowed":""}
      `,children:[r?f.jsx(HR,{className:"h-4 w-4 animate-spin"}):e,n]})}function j9(){const[t,e]=p2(),n=Je(),[r,i]=g.useState(t.get("visitId")||""),[o,s]=g.useState(void 0),[a,l]=g.useState(void 0),[c,u]=g.useState([]),[d,h]=g.useState([]),[p,m]=g.useState([]),{getValidSessionToken:y}=mp(),[v,x]=g.useState(!1);g.useEffect(()=>{const _=t.get("visitId");_&&(i(_),w(_))},[]);const w=async _=>{const D=_||r;if(D.trim()){l(void 0);try{const{data:L,error:N}=await n.from("visits").select("*").eq("id",D.trim()).single();if(N)throw N;s(L),e({visitId:D.trim()}),await b(D.trim())}catch(L){console.error("Error fetching visit:",L),l("Visit not found"),s(void 0),e({}),u([]),h([]),m([])}}},b=async _=>{try{const{data:D,error:L}=await n.from("transcripts").select("*").eq("visit_id",_).order("created_at",{ascending:!1});if(L)throw L;u(D||[]);const{data:N,error:P}=await n.from("containers").select("*").eq("visit_id",_).order("chunk_id",{ascending:!0});if(P)throw P;h(N||[]);const{data:V,error:I}=await n.from("notes").select("*").eq("visit_id",_).order("created_at",{ascending:!1});if(I)throw I;m(V||[])}catch(D){console.error("Error loading visit data:",D),l("Failed to load visit data")}},S=async()=>{if(!(!(o!=null&&o.id)||v))try{x(!0);const _=await y(),D=await fetch(`${$r.apiUrl}/admin/regenerate-visit`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json",Authorization:`Bearer ${_}`,Accept:"application/json"},body:JSON.stringify({visitId:o.id})});if(!D.ok){const L=await D.text();let N="Failed to regenerate visit";try{N=JSON.parse(L).error||N}catch{N=L||N}throw new Error(N)}await b(o.id)}catch(_){console.error("Error regenerating visit:",_),l(_ instanceof Error?_.message:"Failed to regenerate visit")}finally{x(!1)}},C=()=>{if(o)return f.jsx("div",{className:"bg-white rounded-lg shadow-sm mb-6",children:f.jsxs("div",{className:"p-6",children:[f.jsx("div",{className:"flex items-center justify-between mb-6",children:f.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"Visit Details"})}),f.jsxs("dl",{className:"grid grid-cols-2 gap-6",children:[f.jsxs("div",{children:[f.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"ID"}),f.jsx("dd",{className:"mt-1 text-sm text-gray-900",children:o.id})]}),f.jsxs("div",{children:[f.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Created At"}),f.jsx("dd",{className:"mt-1 text-sm text-gray-900",children:new Date(o.created_at).toLocaleString()})]}),f.jsxs("div",{children:[f.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Patient ID"}),f.jsx("dd",{className:"mt-1 text-sm text-gray-900",children:o.patient_id||"No patient assigned"})]}),f.jsxs("div",{children:[f.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"State"}),f.jsx("dd",{className:"mt-1 text-sm text-gray-900",children:o.state})]})]})]})})},k=()=>{if(o)return f.jsx("div",{className:"bg-white rounded-lg shadow-sm p-4 mb-6",children:f.jsx("div",{className:"flex items-center gap-4",children:f.jsx(D9,{onClick:S,icon:f.jsx(HR,{className:"h-4 w-4"}),label:"Regenerate SOAP Note",loading:v,disabled:!(o!=null&&o.id)})})})},E=()=>f.jsx(eg,{title:`Transcripts (${c.length})`,children:f.jsx("div",{className:"space-y-4",children:c.map(_=>f.jsxs("div",{className:"border border-gray-200 rounded p-3",children:[f.jsxs("div",{className:"flex justify-between mb-2",children:[f.jsx("span",{className:"text-xs text-gray-500",children:new Date(_.created_at).toLocaleString()}),f.jsxs("span",{className:"text-xs text-gray-500",children:["ID: ",_.id]})]}),f.jsx("p",{className:"text-sm text-gray-700 whitespace-pre-wrap",children:_.full_text})]},_.id))})}),T=()=>f.jsx(eg,{title:`Container Fragments (${d.length})`,children:f.jsx("div",{className:"space-y-4",children:d.map(_=>f.jsxs("div",{className:"border border-gray-200 rounded p-3",children:[f.jsxs("div",{className:"flex justify-between mb-2",children:[f.jsxs("span",{className:"text-xs text-gray-500",children:["Chunk ",_.chunk_id," • ",_.state]}),f.jsx("span",{className:"text-xs text-gray-500",children:new Date(_.created_at).toLocaleString()})]}),f.jsx("p",{className:"text-sm text-gray-700 whitespace-pre-wrap",children:_.transcript_fragment||"No text available"})]},_.id))})}),O=()=>f.jsx(eg,{title:`Notes (${p.length})`,children:f.jsx("div",{className:"space-y-4",children:p.map(_=>f.jsxs("div",{className:"border border-gray-200 rounded p-3",children:[f.jsxs("div",{className:"flex justify-between mb-2",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("span",{className:"text-xs font-medium text-gray-700",children:_.type}),_.version_id&&f.jsxs("span",{className:"text-xs bg-gray-100 text-gray-600 px-2 py-0.5 rounded",children:["v",_.version_id]}),_.template_id&&f.jsx("span",{className:"text-xs text-gray-500",children:"Template"})]}),f.jsx("span",{className:"text-xs text-gray-500",children:new Date(_.created_at).toLocaleString()})]}),f.jsx("p",{className:"text-sm text-gray-700 whitespace-pre-wrap",children:_.content}),_.metadata&&Object.keys(_.metadata).length>0&&f.jsx("div",{className:"mt-2 pt-2 border-t border-gray-200",children:f.jsxs("details",{children:[f.jsx("summary",{className:"text-xs text-gray-500 cursor-pointer",children:"Metadata"}),f.jsx("pre",{className:"mt-2 text-xs text-gray-600 overflow-auto",children:JSON.stringify(_.metadata,null,2)})]})})]},_.id))})});return f.jsxs("div",{className:"h-screen bg-gray-50 flex",children:[f.jsxs("div",{className:"w-80 bg-white border-r border-gray-200 p-6 flex flex-col gap-6",children:[f.jsx("h1",{className:"text-xl font-semibold text-gray-900",children:"Admin Tools"}),f.jsxs("div",{className:"flex flex-col gap-2",children:[f.jsx("h2",{className:"text-sm font-medium text-gray-700",children:"Visit Search"}),f.jsx("input",{type:"text",value:r,onChange:_=>i(_.target.value),placeholder:"Enter Visit ID",className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),f.jsx("button",{onClick:()=>w(),className:"w-full px-3 py-2 text-sm bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors",children:"Search"})]}),f.jsxs("div",{className:"flex flex-col gap-2",children:[f.jsx("h2",{className:"text-sm font-medium text-gray-700",children:"Actions"}),f.jsx("button",{className:"w-full px-3 py-2 text-sm text-gray-700 bg-gray-50 hover:bg-gray-100 rounded-md text-left transition-colors",children:"Future Action 1"}),f.jsx("button",{className:"w-full px-3 py-2 text-sm text-gray-700 bg-gray-50 hover:bg-gray-100 rounded-md text-left transition-colors",children:"Future Action 2"})]})]}),f.jsxs("div",{className:"flex-1 p-6 overflow-auto",children:[a&&f.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-4 mb-6",children:f.jsx("p",{className:"text-sm text-red-600",children:a})}),o&&f.jsxs(f.Fragment,{children:[C(),k(),E(),T(),O()]})]})]})}const L9=["test@localhost"];function $9({children:t}){const{user:e,loading:n}=It();return n?f.jsx("div",{children:"Loading..."}):!e||!L9.includes(e.email||"")?f.jsx(Vf,{to:"/record",replace:!0}):f.jsx(f.Fragment,{children:t})}function AS({isOpen:t,onOpenChange:e,patient:n,mode:r,onSuccess:i}){const o=Je(),{user:s}=It(),a=Ur(),l=Pr({mutationFn:async v=>{if(!(s!=null&&s.id))throw new Error("No user");const{data:x,error:w}=await o.from("patient_profiles").insert({...v,user_id:s.id,contact_information:{},ai_context:null}).select().single();if(w)throw w;return x},onSuccess:()=>{a.invalidateQueries({queryKey:["patients"]}),e(!1),i&&i()}}),c=Pr({mutationFn:async v=>{const{data:x,error:w}=await o.from("patient_profiles").update(v).eq("id",v.id).select().single();if(w)throw w;return x},onSuccess:()=>{a.invalidateQueries({queryKey:["patients"]}),e(!1),i&&i()}}),u=v=>{v.preventDefault();const x=new FormData(v.currentTarget),w=x.get("name");if(!w)return;const b={name:w,medical_record_number:x.get("medical_record_number")||null,phone:x.get("phone")||null,email:x.get("email")||null,pronoun:x.get("pronoun")||null,notes:x.get("notes")||null};l.mutate(b)},d=v=>{if(v.preventDefault(),!n)return;const x=new FormData(v.currentTarget),w={...n,name:x.get("name"),medical_record_number:x.get("medical_record_number")||null,phone:x.get("phone")||null,email:x.get("email")||null,pronoun:x.get("pronoun")||null,notes:x.get("notes")||null};c.mutate(w)},h=({patient:v,onSubmit:x})=>f.jsxs("form",{onSubmit:x,style:Pe.form,children:[f.jsxs("div",{style:Pe.formGroup,children:[f.jsx("label",{htmlFor:"name",style:Pe.label,children:"Name*"}),f.jsx("input",{id:"name",name:"name",type:"text",required:!0,defaultValue:(v==null?void 0:v.name)||"",style:Pe.input})]}),f.jsxs("div",{style:Pe.formGroup,children:[f.jsx("label",{htmlFor:"medical_record_number",style:Pe.label,children:"Medical Record Number"}),f.jsx("input",{id:"medical_record_number",name:"medical_record_number",type:"text",defaultValue:(v==null?void 0:v.medical_record_number)||"",style:Pe.input})]}),f.jsxs("div",{style:Pe.formGroup,children:[f.jsx("label",{htmlFor:"pronoun",style:Pe.label,children:"Pronoun"}),f.jsx("input",{id:"pronoun",name:"pronoun",type:"text",defaultValue:(v==null?void 0:v.pronoun)||"",style:Pe.input})]}),f.jsxs("div",{style:Pe.formGroup,children:[f.jsx("label",{htmlFor:"phone",style:Pe.label,children:"Phone"}),f.jsx("input",{id:"phone",name:"phone",type:"tel",defaultValue:(v==null?void 0:v.phone)||"",style:Pe.input})]}),f.jsxs("div",{style:Pe.formGroup,children:[f.jsx("label",{htmlFor:"email",style:Pe.label,children:"Email"}),f.jsx("input",{id:"email",name:"email",type:"email",defaultValue:(v==null?void 0:v.email)||"",style:Pe.input})]}),f.jsxs("div",{style:Pe.formGroup,children:[f.jsx("label",{htmlFor:"notes",style:Pe.label,children:"Notes"}),f.jsx("textarea",{id:"notes",name:"notes",defaultValue:(v==null?void 0:v.notes)||"",style:{...Pe.input,minHeight:"100px"}})]}),f.jsx("div",{style:Pe.formActions,children:f.jsx("button",{type:"submit",style:Pe.primaryButton,children:r==="edit"?"Update Patient":"Add Patient"})})]}),p=r==="add"?"Add New Patient":"Edit Patient",m=r==="add"?"Fill in the details to add a new patient.":"Update patient information.",y=r==="add"?u:d;return f.jsx(ch,{open:t,onOpenChange:e,children:f.jsxs(uh,{children:[f.jsx(dh,{style:Pe.overlay}),f.jsxs(fh,{style:Pe.dialogContent,children:[f.jsx(hh,{style:Pe.dialogTitle,children:p}),f.jsx(BR,{style:Pe.dialogDescription,children:m}),f.jsx(h,{patient:n,onSubmit:y}),f.jsx(Xy,{asChild:!0,children:f.jsx("button",{style:Pe.closeButton,children:f.jsx(fu,{})})})]})]})})}const Pe={overlay:{backgroundColor:"rgba(0, 0, 0, 0.4)",position:"fixed",inset:0,animation:"overlayShow 150ms cubic-bezier(0.16, 1, 0.3, 1)"},dialogContent:{backgroundColor:"white",borderRadius:"6px",boxShadow:"0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)",position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"90vw",maxWidth:"500px",maxHeight:"85vh",padding:"24px",animation:"contentShow 150ms cubic-bezier(0.16, 1, 0.3, 1)",overflow:"auto"},dialogTitle:{margin:0,fontWeight:600,color:"#111827",fontSize:"18px"},dialogDescription:{marginTop:"8px",marginBottom:"20px",color:"#6b7280",fontSize:"14px"},closeButton:{position:"absolute",top:"16px",right:"16px",backgroundColor:"transparent",border:"none",borderRadius:"4px",cursor:"pointer",color:"#6b7280",display:"flex",padding:"4px"},form:{display:"flex",flexDirection:"column",gap:"16px"},formGroup:{display:"flex",flexDirection:"column",gap:"4px"},label:{fontSize:"14px",fontWeight:500,color:"#374151"},input:{padding:"8px 12px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"14px",color:"#1f2937"},formActions:{display:"flex",justifyContent:"flex-end",gap:"12px",marginTop:"12px"},primaryButton:{padding:"8px 16px",backgroundColor:"#3b82f6",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"14px",fontWeight:500},secondaryButton:{padding:"8px 16px",backgroundColor:"white",color:"#374151",border:"1px solid #d1d5db",borderRadius:"6px",cursor:"pointer",fontSize:"14px",fontWeight:500}};function F9(){const t=Je(),{user:e}=It(),n=Ur(),r=mr(),[i,o]=g.useState(null),[s,a]=g.useState(!1),[l,c]=g.useState(!1),[u,d]=g.useState(!1),[h,p]=g.useState(!1),[m,y]=g.useState([]),[v,x]=g.useState({}),w=async N=>{const{data:P,error:V}=await t.from("visits").select("created_at").eq("patient_id",N).order("created_at",{ascending:!1}).limit(1);return V||!P||P.length===0?null:P[0].created_at},{data:b=[],isLoading:S}=Xc({queryKey:["patients",e==null?void 0:e.id],queryFn:async()=>{if(!(e!=null&&e.id))return[];const{data:N,error:P}=await t.from("patient_profiles").select("*").eq("user_id",e.id).order("name",{ascending:!0});if(P)throw P;return(N||[]).sort((V,I)=>V.name.toLowerCase().localeCompare(I.name.toLowerCase()))},enabled:!!(e!=null&&e.id)});g.useEffect(()=>{(async()=>{if(!b.length)return;const P={},V=b.map(async I=>{const F=await w(I.id);P[I.id]=F});await Promise.all(V),x(P)})()},[b,t]);const C=N=>{if(!N)return"Never";const P=new Date(N);return isNaN(P.getTime())?"Invalid date":P.toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})},k=Pr({mutationFn:async N=>{const{error:P}=await t.from("patient_profiles").delete().eq("id",N);if(P)throw P;return N},onSuccess:()=>{n.invalidateQueries({queryKey:["patients"]}),d(!1)}}),E=async N=>{const{data:P,error:V}=await t.from("visits").select("*").eq("patient_id",N).order("created_at",{ascending:!1});if(V){console.error("Error loading patient visits:",V);return}y(P||[])},T=async N=>{o(N),await E(N.id),p(!0)},O=()=>{i&&k.mutate(i.id)},_=N=>({processing:"Processing",completed:"Completed",paused:"Paused",recording:"Recording",preparing:"Preparing",ready:"Ready",cancelled:"Cancelled",failed:"Failed",deleted:"Deleted"})[N]||N,D=N=>({processing:"#fbbf24",completed:"#34d399",paused:"#f59e0b",recording:"#60a5fa",preparing:"#a855f7",ready:"#10b981",cancelled:"#9ca3af",failed:"#ef4444",deleted:"#6b7280"})[N]||"#6b7280",L=N=>{r(`/visit/${N}`)};return f.jsxs("div",{style:ne.container,children:[f.jsxs("div",{style:ne.header,children:[f.jsx("h1",{style:ne.title,children:"Patients"}),f.jsxs("button",{onClick:()=>a(!0),style:ne.addButton,children:[f.jsx(hu,{}),f.jsx("span",{children:"Add Patient"})]})]}),S?f.jsx("div",{style:ne.loading,children:"Loading patients..."}):b.length===0?f.jsxs("div",{style:ne.emptyState,children:[f.jsx("p",{children:"No patients found. Add your first patient to get started."}),f.jsx("button",{onClick:()=>a(!0),style:ne.primaryButton,children:"Add Patient"})]}):f.jsx("div",{style:ne.tableContainer,children:f.jsxs("table",{style:ne.table,children:[f.jsx("thead",{children:f.jsxs("tr",{children:[f.jsx("th",{style:ne.th,children:"Name"}),f.jsx("th",{style:ne.th,children:"MRN"}),f.jsx("th",{style:ne.th,children:"Phone"}),f.jsx("th",{style:ne.th,children:"Email"}),f.jsx("th",{style:ne.th,children:"Last Visit"}),f.jsx("th",{style:ne.th,children:"Actions"})]})}),f.jsx("tbody",{children:b.map(N=>f.jsxs("tr",{style:ne.tr,children:[f.jsx("td",{style:ne.td,children:N.name}),f.jsx("td",{style:ne.td,children:N.medical_record_number||"-"}),f.jsx("td",{style:ne.td,children:N.phone||"-"}),f.jsx("td",{style:ne.td,children:N.email||"-"}),f.jsx("td",{style:ne.td,children:C(v[N.id])}),f.jsx("td",{style:ne.td,children:f.jsxs("div",{style:ne.actions,children:[f.jsx("button",{onClick:()=>{o(N),c(!0)},style:ne.iconButton,title:"Edit patient",children:f.jsx(vz,{})}),f.jsx("button",{onClick:()=>T(N),style:ne.iconButton,title:"View patient visits",children:"Visits"}),f.jsx("button",{onClick:()=>{o(N),d(!0)},style:ne.iconButton,title:"Delete patient",children:f.jsx(Gy,{})})]})})]},N.id))})]})}),f.jsx(AS,{isOpen:s,onOpenChange:a,mode:"add"}),f.jsx(AS,{isOpen:l,onOpenChange:c,patient:i,mode:"edit"}),f.jsx(ch,{open:u,onOpenChange:d,children:f.jsxs(uh,{children:[f.jsx(dh,{style:ne.overlay}),f.jsxs(fh,{style:ne.dialogContent,children:[f.jsx(hh,{style:ne.dialogTitle,children:"Delete Patient"}),f.jsxs(BR,{style:ne.dialogDescription,children:["Are you sure you want to delete ",i==null?void 0:i.name,"? This action cannot be undone."]}),f.jsxs("div",{style:ne.formActions,children:[f.jsx("button",{onClick:()=>d(!1),style:ne.secondaryButton,children:"Cancel"}),f.jsx("button",{onClick:O,style:{...ne.primaryButton,backgroundColor:"#ef4444"},children:"Delete"})]}),f.jsx(Xy,{asChild:!0,children:f.jsx("button",{style:ne.closeButton,children:f.jsx(fu,{})})})]})]})}),f.jsx(ch,{open:h,onOpenChange:p,children:f.jsxs(uh,{children:[f.jsx(dh,{style:ne.overlay}),f.jsxs(fh,{style:{...ne.dialogContent,maxWidth:"800px"},children:[f.jsxs(hh,{style:ne.dialogTitle,children:["Visits for ",i==null?void 0:i.name]}),m.length===0?f.jsx("p",{style:ne.emptyNotes,children:"No visits found for this patient."}):f.jsx("div",{style:ne.notesContainer,children:m.map(N=>f.jsxs("div",{style:ne.visitCard,onClick:()=>L(N.id),children:[f.jsxs("div",{style:ne.noteHeader,children:[f.jsx("h3",{style:ne.noteTitle,children:N.name||new Date(N.created_at).toLocaleDateString()}),f.jsx("span",{style:ne.noteDate,children:new Date(N.created_at).toLocaleString()})]}),f.jsxs("div",{style:ne.visitContent,children:[f.jsx("div",{style:ne.visitInfo,children:N.name||"No name available"}),f.jsx("div",{style:{...ne.visitStateBadge,backgroundColor:D(N.state)},children:_(N.state)})]})]},N.id))}),f.jsx(Xy,{asChild:!0,children:f.jsx("button",{style:ne.closeButton,children:f.jsx(fu,{})})})]})]})})]})}const ne={container:{padding:"24px",height:"100%",width:"100%",overflow:"auto",backgroundColor:"#f9fafb",display:"flex",flexDirection:"column",flex:1},header:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"24px",width:"100%"},title:{fontSize:"24px",fontWeight:"bold",color:"#111827",margin:0},addButton:{display:"flex",alignItems:"center",gap:"8px",padding:"8px 16px",backgroundColor:"#3b82f6",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"14px",fontWeight:500},loading:{padding:"40px",textAlign:"center",color:"#6b7280"},emptyState:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"60px 20px",textAlign:"center",color:"#6b7280",gap:"16px"},tableContainer:{backgroundColor:"white",borderRadius:"8px",boxShadow:"0 1px 3px 0 rgba(0, 0, 0, 0.1)",overflow:"hidden",flex:1,width:"100%"},table:{width:"100%",borderCollapse:"collapse"},th:{textAlign:"left",padding:"12px 16px",backgroundColor:"#f9fafb",fontSize:"12px",fontWeight:600,color:"#4b5563",borderBottom:"1px solid #e5e7eb"},tr:{borderBottom:"1px solid #e5e7eb",":last-child":{borderBottom:"none"}},td:{padding:"12px 16px",fontSize:"14px",color:"#1f2937"},actions:{display:"flex",gap:"8px"},iconButton:{padding:"4px 8px",backgroundColor:"transparent",border:"none",borderRadius:"4px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",color:"#4b5563",":hover":{backgroundColor:"#f3f4f6",color:"#1f2937"}},overlay:{backgroundColor:"rgba(0, 0, 0, 0.4)",position:"fixed",inset:0,animation:"overlayShow 150ms cubic-bezier(0.16, 1, 0.3, 1)"},dialogContent:{backgroundColor:"white",borderRadius:"6px",boxShadow:"0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)",position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"90vw",maxWidth:"500px",maxHeight:"85vh",padding:"24px",animation:"contentShow 150ms cubic-bezier(0.16, 1, 0.3, 1)",overflow:"auto"},dialogTitle:{margin:0,fontWeight:600,color:"#111827",fontSize:"18px"},dialogDescription:{marginTop:"8px",marginBottom:"20px",color:"#6b7280",fontSize:"14px"},closeButton:{position:"absolute",top:"16px",right:"16px",backgroundColor:"transparent",border:"none",borderRadius:"4px",cursor:"pointer",color:"#6b7280",display:"flex",padding:"4px"},form:{display:"flex",flexDirection:"column",gap:"16px"},formGroup:{display:"flex",flexDirection:"column",gap:"4px"},label:{fontSize:"14px",fontWeight:500,color:"#374151"},input:{padding:"8px 12px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"14px",color:"#1f2937"},formActions:{display:"flex",justifyContent:"flex-end",gap:"12px",marginTop:"12px"},primaryButton:{padding:"8px 16px",backgroundColor:"#3b82f6",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"14px",fontWeight:500},secondaryButton:{padding:"8px 16px",backgroundColor:"white",color:"#374151",border:"1px solid #d1d5db",borderRadius:"6px",cursor:"pointer",fontSize:"14px",fontWeight:500},notesContainer:{display:"flex",flexDirection:"column",gap:"12px",maxHeight:"500px",overflow:"auto"},visitCard:{padding:"16px",backgroundColor:"#f9fafb",borderRadius:"6px",border:"1px solid #e5e7eb",cursor:"pointer",transition:"background-color 0.2s, transform 0.1s",":hover":{backgroundColor:"#f3f4f6",transform:"translateY(-2px)"}},visitContent:{display:"flex",justifyContent:"space-between",alignItems:"center",fontSize:"14px",color:"#1f2937",whiteSpace:"pre-wrap"},visitInfo:{flex:1},visitStateBadge:{padding:"4px 8px",borderRadius:"9999px",fontSize:"12px",fontWeight:500,color:"white",textAlign:"center",minWidth:"80px"},noteHeader:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},noteTitle:{margin:0,fontSize:"16px",fontWeight:600,color:"#111827"},noteDate:{fontSize:"12px",color:"#6b7280"},emptyNotes:{textAlign:"center",color:"#6b7280",padding:"20px"}};var Fx="Popover",[FP,UW]=yi(Fx,[zl]),Yu=zl(),[B9,zo]=FP(Fx),BP=t=>{const{__scopePopover:e,children:n,open:r,defaultOpen:i,onOpenChange:o,modal:s=!1}=t,a=Yu(e),l=g.useRef(null),[c,u]=g.useState(!1),[d=!1,h]=js({prop:r,defaultProp:i,onChange:o});return f.jsx(kx,{...a,children:f.jsx(B9,{scope:e,contentId:jr(),triggerRef:l,open:d,onOpenChange:h,onOpenToggle:g.useCallback(()=>h(p=>!p),[h]),hasCustomAnchor:c,onCustomAnchorAdd:g.useCallback(()=>u(!0),[]),onCustomAnchorRemove:g.useCallback(()=>u(!1),[]),modal:s,children:n})})};BP.displayName=Fx;var zP="PopoverAnchor",z9=g.forwardRef((t,e)=>{const{__scopePopover:n,...r}=t,i=zo(zP,n),o=Yu(n),{onCustomAnchorAdd:s,onCustomAnchorRemove:a}=i;return g.useEffect(()=>(s(),()=>a()),[s,a]),f.jsx(wp,{...o,...r,ref:e})});z9.displayName=zP;var VP="PopoverTrigger",UP=g.forwardRef((t,e)=>{const{__scopePopover:n,...r}=t,i=zo(VP,n),o=Yu(n),s=Se(e,i.triggerRef),a=f.jsx(se.button,{type:"button","aria-haspopup":"dialog","aria-expanded":i.open,"aria-controls":i.contentId,"data-state":GP(i.open),...r,ref:s,onClick:H(t.onClick,i.onOpenToggle)});return i.hasCustomAnchor?a:f.jsx(wp,{asChild:!0,...o,children:a})});UP.displayName=VP;var Bx="PopoverPortal",[V9,U9]=FP(Bx,{forceMount:void 0}),HP=t=>{const{__scopePopover:e,forceMount:n,children:r,container:i}=t,o=zo(Bx,e);return f.jsx(V9,{scope:e,forceMount:n,children:f.jsx(yr,{present:n||o.open,children:f.jsx($l,{asChild:!0,container:i,children:r})})})};HP.displayName=Bx;var Tl="PopoverContent",WP=g.forwardRef((t,e)=>{const n=U9(Tl,t.__scopePopover),{forceMount:r=n.forceMount,...i}=t,o=zo(Tl,t.__scopePopover);return f.jsx(yr,{present:r||o.open,children:o.modal?f.jsx(H9,{...i,ref:e}):f.jsx(W9,{...i,ref:e})})});WP.displayName=Tl;var H9=g.forwardRef((t,e)=>{const n=zo(Tl,t.__scopePopover),r=g.useRef(null),i=Se(e,r),o=g.useRef(!1);return g.useEffect(()=>{const s=r.current;if(s)return pp(s)},[]),f.jsx(hp,{as:Ro,allowPinchZoom:!0,children:f.jsx(KP,{...t,ref:i,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:H(t.onCloseAutoFocus,s=>{var a;s.preventDefault(),o.current||(a=n.triggerRef.current)==null||a.focus()}),onPointerDownOutside:H(t.onPointerDownOutside,s=>{const a=s.detail.originalEvent,l=a.button===0&&a.ctrlKey===!0,c=a.button===2||l;o.current=c},{checkForDefaultPrevented:!1}),onFocusOutside:H(t.onFocusOutside,s=>s.preventDefault(),{checkForDefaultPrevented:!1})})})}),W9=g.forwardRef((t,e)=>{const n=zo(Tl,t.__scopePopover),r=g.useRef(!1),i=g.useRef(!1);return f.jsx(KP,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:o=>{var s,a;(s=t.onCloseAutoFocus)==null||s.call(t,o),o.defaultPrevented||(r.current||(a=n.triggerRef.current)==null||a.focus(),o.preventDefault()),r.current=!1,i.current=!1},onInteractOutside:o=>{var l,c;(l=t.onInteractOutside)==null||l.call(t,o),o.defaultPrevented||(r.current=!0,o.detail.originalEvent.type==="pointerdown"&&(i.current=!0));const s=o.target;((c=n.triggerRef.current)==null?void 0:c.contains(s))&&o.preventDefault(),o.detail.originalEvent.type==="focusin"&&i.current&&o.preventDefault()}})}),KP=g.forwardRef((t,e)=>{const{__scopePopover:n,trapFocus:r,onOpenAutoFocus:i,onCloseAutoFocus:o,disableOutsidePointerEvents:s,onEscapeKeyDown:a,onPointerDownOutside:l,onFocusOutside:c,onInteractOutside:u,...d}=t,h=zo(Tl,n),p=Yu(n);return dp(),f.jsx(Wu,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:i,onUnmountAutoFocus:o,children:f.jsx(Ll,{asChild:!0,disableOutsidePointerEvents:s,onInteractOutside:u,onEscapeKeyDown:a,onPointerDownOutside:l,onFocusOutside:c,onDismiss:()=>h.onOpenChange(!1),children:f.jsx(Ex,{"data-state":GP(h.open),role:"dialog",id:h.contentId,...p,...d,ref:e,style:{...d.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),qP="PopoverClose",K9=g.forwardRef((t,e)=>{const{__scopePopover:n,...r}=t,i=zo(qP,n);return f.jsx(se.button,{type:"button",...r,ref:e,onClick:H(t.onClick,()=>i.onOpenChange(!1))})});K9.displayName=qP;var q9="PopoverArrow",G9=g.forwardRef((t,e)=>{const{__scopePopover:n,...r}=t,i=Yu(n);return f.jsx(Tx,{...i,...r,ref:e})});G9.displayName=q9;function GP(t){return t?"open":"closed"}var JP=BP,YP=UP,QP=HP,XP=WP;async function J9(t,e){const{data:n,error:r}=await t.from("visits").insert([{id:e.id,state:"recording",user_id:e.userId,name:e.name,patient_id:e.patientId,audio_language:e.audioLanguage,patient_instructions_language:e.patientInstructionsLanguage,started_at:new Date().toISOString(),ended_at:null,updated_at:new Date().toISOString()}]).select().single();if(r)throw r;return n}async function Y9(t,e,n,r){const i={state:n,updated_at:new Date().toISOString()};r&&(i.ended_at=new Date().toISOString());const{error:o}=await t.from("visits").update(i).eq("id",e);if(o)throw o}async function Q9(t,e,n){console.log("Updating visit name:",e,n);const{error:r}=await t.from("visits").update({name:n,updated_at:new Date().toISOString()}).eq("id",e);if(r)throw r}function zx(){const t=Je(),e=Ur(),n=Pr({mutationFn:a=>J9(t,a),onSuccess:a=>{e.invalidateQueries({queryKey:["visits"]}),a!=null&&a.id&&e.invalidateQueries({queryKey:["visit",a.id]})}}),r=Pr({mutationFn:({visitId:a,state:l,endVisit:c})=>Y9(t,a,l,c),onSuccess:(a,l)=>{e.invalidateQueries({queryKey:["visits"]}),e.invalidateQueries({queryKey:["visit",l.visitId]})}}),i=Pr({mutationFn:({visitId:a,name:l})=>Q9(t,a,l),onSuccess:(a,l)=>{e.invalidateQueries({queryKey:["visits"]}),e.invalidateQueries({queryKey:["visit",l.visitId]})}}),o=Pr({mutationFn:async({visitId:a,patientId:l})=>{const{error:c}=await t.from("visits").update({patient_id:l}).eq("id",a);if(c)throw c},onSuccess:(a,l)=>{e.invalidateQueries({queryKey:["visits"]}),e.invalidateQueries({queryKey:["visit",l.visitId]})}}),s=Pr({mutationFn:async({visitId:a,audioLanguage:l,patientInstructionsLanguage:c})=>{const{error:u}=await t.from("visits").update({audio_language:l,patient_instructions_language:c}).eq("id",a);if(u)throw u},onSuccess:(a,l)=>{e.invalidateQueries({queryKey:["visits"]}),e.invalidateQueries({queryKey:["visit",l.visitId]})}});return{createVisit:n.mutate,createVisitAsync:n.mutateAsync,isCreatingVisit:n.isPending,createVisitError:n.error,updateVisitState:r.mutate,updateVisitStateAsync:r.mutateAsync,isUpdatingVisitState:r.isPending,updateVisitStateError:r.error,updateVisitName:i.mutate,updateVisitNameAsync:i.mutateAsync,isUpdatingVisitName:i.isPending,updateVisitNameError:i.error,updateVisitPatient:o.mutate,updateVisitPatientAsync:o.mutateAsync,isUpdatingVisitPatient:o.isPending,updateVisitPatientError:o.error,updateVisitLanguages:s.mutate,updateVisitLanguagesAsync:s.mutateAsync,isUpdatingVisitLanguages:s.isPending,updateVisitLanguagesError:s.error}}const Me={container:{position:"relative",width:"100%",maxWidth:"400px"},inputContainer:{display:"flex",alignItems:"center",gap:"8px",width:"100%",position:"relative"},searchIcon:{position:"absolute",left:"12px",color:"#6b7280",width:"16px",height:"16px"},selectedContainer:{display:"flex",alignItems:"center",gap:"8px",width:"100%",padding:"8px 12px",fontSize:"16px",border:"1px solid #e5e7eb",borderRadius:"6px",backgroundColor:"#f9fafb"},selectedName:{flex:1,fontWeight:"500",color:"#1f2937"},unlinkButton:{display:"flex",alignItems:"center",padding:"4px",border:"none",borderRadius:"4px",backgroundColor:"transparent",color:"#6b7280",cursor:"pointer","&:hover":{backgroundColor:"#f3f4f6",color:"#dc2626"}},input:{width:"100%",padding:"8px 12px 8px 36px",fontSize:"16px",border:"1px solid #e5e7eb",borderRadius:"6px",outline:"none","&:focus":{borderColor:"#3b82f6",boxShadow:"0 0 0 2px rgba(59, 130, 246, 0.1)"}},popoverContent:{backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"6px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)",marginTop:"4px",width:"300px",minHeight:"100px",maxHeight:"300px",overflow:"auto",zIndex:50,padding:"8px 0"},section:{padding:"0"},sectionTitle:{padding:"4px 16px",fontSize:"12px",fontWeight:"500",color:"#6b7280",textTransform:"uppercase"},item:{padding:"8px 16px",cursor:"pointer",outline:"none",width:"100%",border:"none",backgroundColor:"transparent",textAlign:"left","&:hover":{backgroundColor:"#f3f4f6"},"&:focus":{backgroundColor:"#f3f4f6"}},createButton:{display:"flex",alignItems:"center",gap:"8px",width:"100%",padding:"8px 16px",backgroundColor:"#f9fafb",border:"none",borderRadius:"0",cursor:"pointer",fontSize:"14px",color:"#1f2937","&:hover":{backgroundColor:"#f3f4f6"}},patientName:{fontSize:"14px",fontWeight:"500",color:"#1f2937"},patientMrn:{fontSize:"12px",color:"#6b7280"},separator:{height:"1px",backgroundColor:"#e5e7eb",margin:"4px 0"},loadingItem:{padding:"8px 16px",height:"38px",backgroundColor:"#f9fafb",borderRadius:"4px",margin:"4px 0",animation:"pulse 1.5s ease-in-out infinite"},placeholderContainer:{padding:"4px 0"}};function X9({onPatientSelect:t,onVisitNameChange:e,visitId:n,selectedPatientId:r}){const[i,o]=g.useState(""),[s,a]=g.useState(!1),l=dR(i,300),{user:c}=It(),u=Je(),d=g.useRef(null),h=Ur(),[p,m]=g.useState(!1),{updateVisitName:y}=zx(),v=g.useRef(n),x=g.useRef(r),{data:w=[],isLoading:b}=Xc({queryKey:["patients",c==null?void 0:c.id,l],queryFn:async()=>{if(!(c!=null&&c.id))return[];const{data:I,error:F}=await u.rpc("search_patients",{search_term:l||"",user_id_param:c.id});if(F)throw F;return I||[]},enabled:!!(c!=null&&c.id)}),{data:S}=Xc({queryKey:["patient",r],queryFn:async()=>{if(!r)return null;const{data:I,error:F}=await u.from("patient_profiles").select("id, name, medical_record_number").eq("id",r).single();if(F)throw F;return I},enabled:!!r}),C=Pr({mutationFn:async I=>{if(!(c!=null&&c.id))throw new Error("No user");const{data:F,error:M}=await u.from("patient_profiles").insert([{name:I.trim(),user_id:c.id}]).select().single();if(M)throw M;return F},onSuccess:I=>{h.invalidateQueries({queryKey:["patients"]}),E(I)}}),k=l?w:w.slice(0,3),E=I=>{o(I.name),a(!1),t(I),e==null||e(null)},T=async()=>{!i.trim()||!(c!=null&&c.id)||C.mutate(i)},O=I=>{const F=I.target.value;o(F)},_=()=>{if(i.trim()){const I=i.trim();t(null),e==null||e(I),o(I),m(!0),a(!1),n&&y({visitId:n,name:I})}},D=I=>{I.key==="Enter"&&i.trim()&&(I.preventDefault(),_())},L=()=>{o(""),m(!1),t(null),e==null||e(null),n&&y({visitId:n,name:null})};Te.useEffect(()=>{(async()=>{if((n!==v.current||r!==x.current)&&(o(""),m(!1),a(!1)),v.current=n,x.current=r,r){const{data:F}=await u.from("patient_profiles").select("name").eq("id",r).single();F&&o(F.name)}else if(n){const{data:F}=await u.from("visits").select("name").eq("id",n).single();F!=null&&F.name&&(o(F.name),m(!0))}})()},[r,n,u]);const N=S||p||n&&i&&!s,P=(I,F)=>f.jsxs("button",{style:Me.item,onClick:F,children:[f.jsx("div",{style:Me.patientName,children:I.name}),I.medical_record_number&&f.jsxs("div",{style:Me.patientMrn,children:["MRN: ",I.medical_record_number]})]},I.id),V=()=>f.jsxs("div",{style:Me.placeholderContainer,children:[f.jsx("div",{style:{...Me.loadingItem,marginLeft:"16px",marginRight:"16px"}}),f.jsx("div",{style:{...Me.loadingItem,marginLeft:"16px",marginRight:"16px"}}),f.jsx("div",{style:{...Me.loadingItem,marginLeft:"16px",marginRight:"16px"}})]});return N?f.jsx("div",{style:Me.container,children:f.jsxs("div",{style:Me.selectedContainer,onClick:()=>{a(!0),m(!1),setTimeout(()=>{var I;return(I=d.current)==null?void 0:I.focus()},0)},children:[f.jsx("div",{style:Me.selectedName,children:(S==null?void 0:S.name)||i}),f.jsx("button",{style:Me.unlinkButton,onClick:I=>{I.stopPropagation(),L()},title:"Unlink patient",children:f.jsx(fu,{})})]})}):f.jsx("div",{style:Me.container,children:f.jsxs(JP,{modal:!1,open:s,onOpenChange:a,children:[f.jsx(YP,{asChild:!0,children:f.jsxs("div",{style:Me.inputContainer,children:[f.jsx(IV,{style:Me.searchIcon}),f.jsx("input",{ref:d,type:"text",value:i,onChange:O,onKeyDown:D,onBlur:()=>{setTimeout(()=>{s&&_()},200)},onFocus:()=>a(!0),onClick:I=>{I.stopPropagation(),a(!0),I.currentTarget.focus()},placeholder:"Add patient details",style:Me.input})]})}),f.jsx(QP,{children:f.jsx(XP,{style:Me.popoverContent,align:"start",sideOffset:4,onEscapeKeyDown:()=>a(!1),onInteractOutside:I=>{var M;const F=I.target;if((M=d.current)!=null&&M.contains(F)){I.preventDefault();return}_()},children:b?f.jsxs(f.Fragment,{children:[f.jsxs("div",{style:Me.section,children:[f.jsx("div",{style:Me.sectionTitle,children:"Suggested"}),V()]}),f.jsx("div",{style:Me.separator}),f.jsxs("button",{style:{...Me.createButton,opacity:.5},disabled:!0,children:[f.jsx(hu,{}),"Create new patient"]})]}):f.jsxs(f.Fragment,{children:[f.jsxs("div",{style:Me.section,children:[f.jsx("div",{style:Me.sectionTitle,children:"Suggested"}),f.jsx("div",{style:Me.placeholderContainer,children:k.length>0?k.map(I=>P(I,()=>E(I))):f.jsx("div",{style:Me.item,children:"No matches found"})})]}),f.jsx("div",{style:Me.separator}),f.jsxs("button",{style:Me.createButton,onClick:T,disabled:C.isPending||!i.trim(),children:[f.jsx(hu,{}),C.isPending?"Creating...":i.trim()?`Create new patient "${i}"`:"Create new patient"]})]})})})]})})}const pv=(t,e)=>e.some(n=>t instanceof n);let NS,DS;function Z9(){return NS||(NS=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function eW(){return DS||(DS=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const mv=new WeakMap,tg=new WeakMap,Pp=new WeakMap;function tW(t){const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("success",o),t.removeEventListener("error",s)},o=()=>{n(Cs(t.result)),i()},s=()=>{r(t.error),i()};t.addEventListener("success",o),t.addEventListener("error",s)});return Pp.set(e,t),e}function nW(t){if(mv.has(t))return;const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("complete",o),t.removeEventListener("error",s),t.removeEventListener("abort",s)},o=()=>{n(),i()},s=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",o),t.addEventListener("error",s),t.addEventListener("abort",s)});mv.set(t,e)}let gv={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return mv.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Cs(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function ZP(t){gv=t(gv)}function rW(t){return eW().includes(t)?function(...e){return t.apply(yv(this),e),Cs(this.request)}:function(...e){return Cs(t.apply(yv(this),e))}}function iW(t){return typeof t=="function"?rW(t):(t instanceof IDBTransaction&&nW(t),pv(t,Z9())?new Proxy(t,gv):t)}function Cs(t){if(t instanceof IDBRequest)return tW(t);if(tg.has(t))return tg.get(t);const e=iW(t);return e!==t&&(tg.set(t,e),Pp.set(e,t)),e}const yv=t=>Pp.get(t);function oW(t,e,{blocked:n,upgrade:r,blocking:i,terminated:o}={}){const s=indexedDB.open(t,e),a=Cs(s);return r&&s.addEventListener("upgradeneeded",l=>{r(Cs(s.result),l.oldVersion,l.newVersion,Cs(s.transaction),l)}),n&&s.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),a.then(l=>{o&&l.addEventListener("close",()=>o()),i&&l.addEventListener("versionchange",c=>i(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}const sW=["get","getKey","getAll","getAllKeys","count"],aW=["put","add","delete","clear"],ng=new Map;function jS(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(ng.get(e))return ng.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=aW.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||sW.includes(n)))return;const o=async function(s,...a){const l=this.transaction(s,i?"readwrite":"readonly");let c=l.store;return r&&(c=c.index(a.shift())),(await Promise.all([c[n](...a),i&&l.done]))[0]};return ng.set(e,o),o}ZP(t=>({...t,get:(e,n,r)=>jS(e,n)||t.get(e,n,r),has:(e,n)=>!!jS(e,n)||t.has(e,n)}));const lW=["continue","continuePrimaryKey","advance"],LS={},vv=new WeakMap,eM=new WeakMap,cW={get(t,e){if(!lW.includes(e))return t[e];let n=LS[e];return n||(n=LS[e]=function(...r){vv.set(this,eM.get(this)[e](...r))}),n}};async function*uW(...t){let e=this;if(e instanceof IDBCursor||(e=await e.openCursor(...t)),!e)return;e=e;const n=new Proxy(e,cW);for(eM.set(n,e),Pp.set(n,yv(e));e;)yield n,e=await(vv.get(n)||e.continue()),vv.delete(n)}function $S(t,e){return e===Symbol.asyncIterator&&pv(t,[IDBIndex,IDBObjectStore,IDBCursor])||e==="iterate"&&pv(t,[IDBIndex,IDBObjectStore])}ZP(t=>({...t,get(e,n,r){return $S(e,n)?uW:t.get(e,n,r)},has(e,n){return $S(e,n)||t.has(e,n)}}));class dW{constructor(){this.db=null,this.DB_NAME="audio-recorder-db",this.STORE_NAME="audio-chunks",this.SYNC_STORE="chunk-sync-metadata",this.DB_VERSION=1}async initialize(){this.db||(this.db=await oW(this.DB_NAME,this.DB_VERSION,{upgrade(e){e.objectStoreNames.contains("audio-chunks")||e.createObjectStore("audio-chunks",{keyPath:["visitId","containerIndex","chunkId"]}).createIndex("by-visit","visitId"),e.objectStoreNames.contains("chunk-sync-metadata")||e.createObjectStore("chunk-sync-metadata",{keyPath:"key"}).createIndex("by-visit","visitId")}}))}async getDb(){return this.db||await this.initialize(),this.db}async storeChunk(e){this.db||await this.initialize(),console.log(`📦 Storing chunk ${e.containerIndex}:${e.chunkId} (${(e.blob.size/1024).toFixed(1)}KB)`),await this.db.put(this.STORE_NAME,e)}async getChunk(e,n,r){return this.db||await this.initialize(),this.db.get(this.STORE_NAME,[e,n,r])}async getChunksByVisit(e){return this.db||await this.initialize(),this.db.getAllFromIndex(this.STORE_NAME,"by-visit",e)}async deleteChunksByVisit(e){this.db||await this.initialize();const n=await this.getChunksByVisit(e),r=this.db.transaction(this.STORE_NAME,"readwrite");await Promise.all(n.map(i=>r.store.delete([i.visitId,i.containerIndex,i.chunkId]))),await r.done}async deleteChunk(e,n,r){this.db||await this.initialize();const i=this.db.transaction(this.STORE_NAME,"readwrite");if(r!==void 0)await i.store.delete([e,n,r]);else{const o=await this.getChunksByVisit(e);await Promise.all(o.filter(s=>s.containerIndex===n).map(s=>i.store.delete([s.visitId,s.containerIndex,s.chunkId])))}await i.done}async getDatabaseStats(){try{this.db||await this.initialize();const r=await this.db.transaction(this.STORE_NAME).objectStore(this.STORE_NAME).getAll(),i={};r.forEach(s=>{i[s.visitId]||(i[s.visitId]={chunks:0,size:0,containers:new Set}),i[s.visitId].chunks++,i[s.visitId].size+=s.blob.size,i[s.visitId].containers.add(s.containerIndex)});const o={totalChunks:r.length,totalVisits:Object.keys(i).length,totalSize:r.reduce((s,a)=>s+a.blob.size,0),visitStats:Object.entries(i).reduce((s,[a,l])=>({...s,[a]:{chunks:l.chunks,size:l.size,containers:l.containers.size}}),{})};return console.log("[AudioStorage] Database stats:",o),o}catch(e){throw console.error("[AudioStorage] Failed to get database stats:",e),e}}}const Zo=new dW,Mp=class gn{constructor(){this.isSyncing=!1,this.syncPromise=null}async getUnuploadedChunks(){return(await Zo.getDb()).transaction(gn.SYNC_STORE).objectStore(gn.SYNC_STORE).getAll()}async markChunkForUpload(e){await(await Zo.getDb()).transaction(gn.SYNC_STORE,"readwrite").objectStore(gn.SYNC_STORE).put({...e,uploadAttempts:0,lastAttempt:Date.now()})}async markChunkAsUploaded(e){await(await Zo.getDb()).transaction(gn.SYNC_STORE,"readwrite").objectStore(gn.SYNC_STORE).delete(e)}async updateUploadAttempt(e){await(await Zo.getDb()).transaction(gn.SYNC_STORE,"readwrite").objectStore(gn.SYNC_STORE).put({...e,uploadAttempts:e.uploadAttempts+1,lastAttempt:Date.now()})}async uploadChunk(e,n){console.log(`⬆️ Uploading container ${e.containerIndex} (${(e.blob.size/1024).toFixed(1)}KB)`);try{const r=e.blob.type.includes("mp4")?"mp4":"webm",i={key:`audio-chunks/${e.visitId}/${e.containerIndex}-${e.chunkId}-${e.timestamp}.${r}`,contentType:e.blob.type,visitId:e.visitId,chunkId:e.chunkId,isFinal:e.isFinal,containerIndex:e.containerIndex},o=await fetch(`${$r.apiUrl}/get-upload-url`,{method:"POST",headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json"},body:JSON.stringify(i)});if(!o.ok)throw new Error(`Failed to get upload URL: ${o.status}`);const{uploadUrl:s,fields:a}=await o.json(),l=new FormData;if(Object.entries(a).forEach(([h,p])=>{l.append(h,p)}),l.append("file",e.blob),!(await fetch(s,{method:"POST",body:l})).ok)throw new Error("Failed to upload to S3");const u=await fetch(`${$r.apiUrl}/process-audio`,{method:"POST",headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json"},body:JSON.stringify({key:i.key,visitId:e.visitId,chunkId:e.chunkId,isFinal:e.isFinal,contentType:e.blob.type,containerIndex:e.containerIndex})});if(!u.ok)throw new Error(`Failed to process audio: ${u.status}`);if(!(await u.json()).success)throw new Error("Processing failed");return console.log(`✅ Uploaded container ${e.containerIndex}`),!0}catch(r){return console.error(`❌ Failed to upload container ${e.containerIndex}:`,r),!1}}async syncChunks(e){return this.isSyncing?this.syncPromise||Promise.resolve():(this.isSyncing=!0,this.syncPromise=(async()=>{try{const n=await this.getUnuploadedChunks();for(const r of n){if(r.uploadAttempts>=gn.MAX_RETRIES){console.log(`⏭️ Skipping container ${r.containerIndex} (max retries reached)`);continue}const i=await Zo.getChunk(r.visitId,r.containerIndex,r.chunkId);if(!i){console.warn(`⚠️ Container ${r.containerIndex} not found in storage`);continue}await this.uploadChunk(i,e)?await this.markChunkAsUploaded(r.key):(await this.updateUploadAttempt(r),console.log(`🔄 Will retry container ${r.containerIndex} later (attempt ${r.uploadAttempts+1}/${gn.MAX_RETRIES})`)),await new Promise(s=>setTimeout(s,gn.RETRY_DELAY))}}finally{this.isSyncing=!1,this.syncPromise=null}})(),this.syncPromise)}async markForUpload(e){const n=e.blob.type.includes("mp4")?"mp4":"webm",r={key:`audio-chunks/${e.visitId}/${e.containerIndex}-${e.chunkId}-${e.timestamp}.${n}`,visitId:e.visitId,chunkId:e.chunkId,containerIndex:e.containerIndex,isFinal:e.isFinal,contentType:e.blob.type};await this.markChunkForUpload(r)}async getSyncStats(){const n=(await this.getUnuploadedChunks()).reduce((r,i)=>{if(r.visitStats[i.visitId]||(r.visitStats[i.visitId]={pending:0,failed:0,lastAttempt:null}),i.uploadAttempts>=gn.MAX_RETRIES?(r.failedUploads++,r.visitStats[i.visitId].failed++):(r.pendingUploads++,r.visitStats[i.visitId].pending++),i.lastAttempt){const o=new Date(i.lastAttempt).toISOString();(!r.visitStats[i.visitId].lastAttempt||o>r.visitStats[i.visitId].lastAttempt)&&(r.visitStats[i.visitId].lastAttempt=o)}return r},{pendingUploads:0,failedUploads:0,visitStats:{}});return console.log("[ChunkSyncManager] Sync stats:",n),n}};Mp.SYNC_STORE="chunk-sync-metadata";Mp.MAX_RETRIES=3;Mp.RETRY_DELAY=5e3;let fW=Mp;function tM(){const t=["audio/webm;codecs=opus","audio/webm","audio/mp4;codecs=mp4a","audio/mp4","audio/mpeg"];for(const e of t)if(MediaRecorder.isTypeSupported(e))return console.log(`[MediaRecorder] Using MIME type: ${e}`),e;throw new Error("No supported MIME type found for MediaRecorder")}class hW{constructor(e){this.mediaRecorder=null,this.stream=null,this.isRecording=!1,this.isPaused=!1,this.currentChunkId=0,this.currentContainerIndex=0,this.chunkBatch=[],this.containerChunks=[],this.CHUNK_DURATION=2e3,this.BATCH_SIZE=5,this.CONTAINER_DURATION=2e4,this.containerStartTime=null,this.containerTimer=null,this.visitId=null,this.config={saveLocally:!0,...e},this.syncManager=new fW,this.visitId=e.visitId||null}async saveChunkLocally(e,n,r,i=!1){if(!this.config.saveLocally)return;const o=URL.createObjectURL(e),s=document.createElement("a");s.href=o;const a=i?"container":"chunk",l=e.type.includes("mp4")?"mp4":"webm";s.download=`${a}_${this.config.visitId||"debug"}_${this.currentContainerIndex}_${n}${r?"_final":""}.${l}`,s.click(),URL.revokeObjectURL(o),console.log(`[RecorderV3] Saved ${a} locally: ${s.download}, size: ${e.size} bytes`)}async initialize(e){try{this.stream&&this.cleanup();const n={sampleRate:16e3,channelCount:1,autoGainControl:!0,deviceId:e||void 0};this.stream=await navigator.mediaDevices.getUserMedia({audio:n}),console.log("[RecorderV3] Initialized with device:",e||"default")}catch(n){throw console.error("[RecorderV3] Initialization failed:",n),this.cleanup(),n}}async flushChunks(e=!1){if(this.chunkBatch.length===0)return;const n=new Blob(this.chunkBatch,{type:"audio/webm;codecs=opus"}),r=Date.now();console.log("[RecorderV3] Flushing chunks:",{batchSize:this.chunkBatch.length,totalSize:n.size,containerIndex:this.currentContainerIndex,isFinal:e});try{this.containerChunks.push(n);const i={blob:n,timestamp:r,chunkId:this.currentChunkId,visitId:this.visitId,isFinal:e,containerIndex:this.currentContainerIndex};await Zo.storeChunk(i),console.log(`[RecorderV3] Stored chunk in IndexedDB: ${this.currentChunkId}`),this.currentChunkId++,this.chunkBatch=[]}catch(i){throw console.error("[RecorderV3] Error in flushChunks:",i),i}}async flushContainer(e=!1){if(this.containerChunks.length===0)return;this.chunkBatch.length>0&&await this.flushChunks(!1);const n=new Blob(this.containerChunks,{type:"audio/webm;codecs=opus"}),r=Date.now(),i=`audio-chunks/${this.visitId}/${this.currentContainerIndex}-${r}.webm`;console.log(`[RecorderV3] Flushing container ${this.currentContainerIndex}:`,{chunks:this.containerChunks.length,totalSize:n.size,timestamp:r,isFinal:e});try{await this.config.onChunkReady({blob:n,chunkId:this.currentContainerIndex,isFinal:e,key:i,isCompleteContainer:!0,visitId:this.visitId}),console.log(`[RecorderV3] Container ${this.currentContainerIndex} uploaded successfully`)}catch(o){console.error("[RecorderV3] Failed to upload container, storing in IndexedDB for retry:",o);const s={blob:n,timestamp:r,chunkId:this.currentContainerIndex,visitId:this.visitId,isFinal:e,containerIndex:this.currentContainerIndex};await Zo.storeChunk(s),await this.syncManager.markForUpload(s)}this.containerChunks=[]}async switchContainer(){var e;if(((e=this.mediaRecorder)==null?void 0:e.state)==="recording"){console.log("[RecorderV3] Switching container:",{currentIndex:this.currentContainerIndex,batchSize:this.chunkBatch.length,containerSize:this.containerChunks.length});try{const n=this.mediaRecorder;await new Promise(r=>{const i=()=>{n.removeEventListener("dataavailable",i),r()};n.addEventListener("dataavailable",i),n.stop()}),this.mediaRecorder=null,this.chunkBatch.length>0&&await this.flushChunks(!1),await this.flushContainer(!1),this.currentContainerIndex++,this.containerStartTime=Date.now(),this.mediaRecorder=this.createRecorder(),this.mediaRecorder.start(this.CHUNK_DURATION),console.log("[RecorderV3] Switched to new container:",{newIndex:this.currentContainerIndex,timestamp:this.containerStartTime})}catch(n){console.error("[RecorderV3] Failed to switch container:",n)}}}createRecorder(){if(!this.stream)throw new Error("No audio stream available");const e=tM(),n=new MediaRecorder(this.stream,{mimeType:e,audioBitsPerSecond:48e3});return n.addEventListener("dataavailable",async r=>{var i;if(!(!(r instanceof BlobEvent)||!((i=r.data)!=null&&i.size))&&(console.log("[RecorderV3] Data available:",{size:r.data.size,batchSize:this.chunkBatch.length,containerIndex:this.currentContainerIndex,isActiveRecorder:this.mediaRecorder===n}),this.chunkBatch.push(r.data),this.chunkBatch.length>=this.BATCH_SIZE))try{await this.flushChunks(!1)}catch(o){console.error("[RecorderV3] Error flushing chunks:",o)}}),n}async startRecording(e){if(!this.isRecording)try{if(this.visitId=e||this.visitId,!this.visitId)throw new Error("No visit ID provided for recording");this.stream||await this.initialize(),this.isRecording=!0,this.currentChunkId=0,this.currentContainerIndex=0,this.chunkBatch=[],this.containerChunks=[],this.containerStartTime=Date.now(),this.mediaRecorder=this.createRecorder(),this.mediaRecorder.start(this.CHUNK_DURATION),this.containerTimer=setInterval(()=>{Date.now()-this.containerStartTime>=this.CONTAINER_DURATION&&this.switchContainer()},1e3),console.log("[RecorderV3] Started recording with visit ID:",this.visitId)}catch(n){throw console.error("[RecorderV3] Failed to start recording:",n),this.cleanup(),n}}async stopRecording(){if(this.isRecording){console.log("[RecorderV3] Stopping recording:",{currentIndex:this.currentContainerIndex,batchSize:this.chunkBatch.length,containerSize:this.containerChunks.length});try{this.containerTimer&&(clearInterval(this.containerTimer),this.containerTimer=null);const e=this.mediaRecorder;this.mediaRecorder=null,this.isRecording=!1;let n=!1;((e==null?void 0:e.state)==="recording"||(e==null?void 0:e.state)==="paused")&&await new Promise((r,i)=>{const o=async s=>{var a;try{e.removeEventListener("dataavailable",o),(a=s.data)!=null&&a.size&&!n&&(console.log("[RecorderV3] Adding final chunk:",{size:s.data.size,existingBatchSize:this.chunkBatch.length}),this.chunkBatch.push(s.data),n=!0),this.chunkBatch.length>0&&await this.flushChunks(!0),await this.flushContainer(!0),r()}catch(l){i(l)}};e.addEventListener("dataavailable",o),e.stop()}),console.log("[RecorderV3] Recording stopped and final data flushed:",{finalContainerIndex:this.currentContainerIndex,finalBatchSize:this.chunkBatch.length,finalContainerSize:this.containerChunks.length}),this.isRecording=!1,this.stream&&(this.stream.getTracks().forEach(r=>r.stop()),this.stream=null),this.chunkBatch=[],this.containerChunks=[]}catch(e){throw console.error("[RecorderV3] Error stopping recording:",e),e}}}async pauseRecording(){if(!(!this.isRecording||this.isPaused))try{this.containerTimer&&(clearInterval(this.containerTimer),this.containerTimer=null);const e=this.mediaRecorder;(e==null?void 0:e.state)==="recording"&&await new Promise(n=>{const r=async()=>{try{e.removeEventListener("dataavailable",r),this.chunkBatch.length>0&&await this.flushChunks(!1),n()}catch(i){console.error("[RecorderV3] Error flushing chunks during pause:",i),n()}};e.addEventListener("dataavailable",r),e.pause()}),this.isPaused=!0,console.log("[RecorderV3] Recording paused")}catch(e){throw console.error("[RecorderV3] Failed to pause recording:",e),e}}async resumeRecording(){var e;if(!(!this.isRecording||!this.isPaused))try{this.stream||await this.initialize(),((e=this.mediaRecorder)==null?void 0:e.state)==="paused"&&this.mediaRecorder.resume(),this.containerStartTime=Date.now(),this.containerTimer=setInterval(()=>{Date.now()-this.containerStartTime>=this.CONTAINER_DURATION&&this.switchContainer()},1e3),this.isPaused=!1,console.log("[RecorderV3] Recording resumed")}catch(n){throw console.error("[RecorderV3] Failed to resume recording:",n),this.isPaused=!0,this.mediaRecorder&&this.mediaRecorder.pause(),n}}cleanup(){var e;this.containerTimer&&(clearInterval(this.containerTimer),this.containerTimer=null),((e=this.mediaRecorder)==null?void 0:e.state)==="recording"&&this.mediaRecorder.stop(),this.mediaRecorder=null,this.stream&&(this.stream.getTracks().forEach(n=>n.stop()),this.stream=null),this.isRecording=!1,this.isPaused=!1,this.chunkBatch=[],this.containerChunks=[],console.log("[RecorderV3] Cleanup complete")}getState(){return{isRecording:this.isRecording,isPaused:this.isPaused,currentChunkId:this.currentChunkId,currentContainerIndex:this.currentContainerIndex,batchSize:this.chunkBatch.length,containerSize:this.containerChunks.length}}}const pW=t=>{const e=Math.floor(t/60),n=t%60;return`${e}:${n.toString().padStart(2,"0")}`};function mW(t={}){const[e,n]=g.useState(!1),[r,i]=g.useState(!1),[o,s]=g.useState(0),[a,l]=g.useState(t.initialVisitId||null),c=g.useRef(null),u=g.useRef(null),d=g.useRef(null),{user:h}=It(),{getValidSessionToken:p}=mp(),m=Je(),y=mr();g.useEffect(()=>h!=null&&h.id?((async()=>{try{if(!await p())throw new Error("No session token available");c.current=new hW({saveLocally:!0,async onChunkReady({blob:k,chunkId:E,isFinal:T,key:O,visitId:_}){const D=await p(),L={key:O,contentType:k.type,visitId:_,chunkId:E,isFinal:T,userId:h==null?void 0:h.id};if(console.log("[Debug] Request payload:",L),!L.key||!L.contentType||!L.visitId)throw new Error("Missing required fields in payload");const N=await fetch(`${$r.apiUrl}/get-upload-url`,{method:"POST",headers:{Authorization:`Bearer ${D}`,"Content-Type":"application/json"},body:JSON.stringify(L)});if(!N.ok){const $=await N.text();throw console.error("[Debug] Upload URL error response:",{status:N.status,statusText:N.statusText,body:$}),new Error(`Failed to get upload URL: ${N.status} ${N.statusText} - ${$}`)}const{uploadUrl:P,fields:V}=await N.json(),I=new FormData;Object.entries(V).forEach(([$,G])=>{I.append($,G)}),I.append("file",k),console.log("[Debug] Uploading to S3:",{uploadUrl:P,fields:V,formDataKeys:Array.from(I.keys())});const F=await fetch(P,{method:"POST",body:I});if(!F.ok){const $=await F.text();throw console.error("[Debug] S3 upload error:",{status:F.status,statusText:F.statusText,response:$}),new Error(`Failed to upload to S3: ${F.status} ${F.statusText} - ${$}`)}console.log("[Debug] S3 upload successful");const M={key:O,visitId:_,chunkId:Number(E),isFinal:!!T,contentType:k.type},A=await fetch(`${$r.apiUrl}/process-audio`,{method:"POST",headers:{Authorization:`Bearer ${D}`,"Content-Type":"application/json"},body:JSON.stringify(M)});if(!A.ok){const $=await A.text();throw new Error(`Failed to process audio: ${A.status} ${A.statusText} - ${$}`)}}}),await c.current.initialize()}catch(C){console.error("Failed to initialize recorder:",C)}})(),()=>{var C;return(C=c.current)==null?void 0:C.cleanup()}):void 0,[h==null?void 0:h.id]),g.useEffect(()=>(e&&!r&&u.current&&(d.current=setInterval(()=>{const S=Date.now()-u.current;s(Math.floor(S/1e3))},1e3)),()=>{d.current&&(clearInterval(d.current),d.current=null)}),[e,r]),g.useEffect(()=>{t.initialVisitId&&t.initialState==="recording"?(n(!0),i(!1)):t.initialVisitId&&t.initialState==="paused"&&(n(!0),i(!0))},[t.initialVisitId,t.initialState]);const v=g.useCallback(async(S,C)=>{var k;try{if(!c.current)throw new Error("Recorder not initialized");if(!(h!=null&&h.id))throw new Error("Must be logged in to record");if(!C)throw new Error("Visit ID is required");const E=C;l(E),S&&await c.current.initialize(S),u.current=Date.now(),await c.current.startRecording(E),n(!0),i(!1),(k=t.onRecordingStateChange)==null||k.call(t,!0,!1)}catch(E){console.error("Failed to start recording:",E)}},[h==null?void 0:h.id,m,a,y]),x=g.useCallback(async()=>{var S;try{c.current&&(await c.current.stopRecording(),a&&await m.from("visits").update({state:"processing"}).eq("id",a),n(!1),i(!1),s(0),(S=t.onRecordingStateChange)==null||S.call(t,!1,!1))}catch(C){console.error("Failed to stop recording:",C)}},[a,m]),w=g.useCallback(async()=>{var S;try{c.current&&(await c.current.pauseRecording(),i(!0),(S=t.onRecordingStateChange)==null||S.call(t,!0,!0))}catch(C){console.error("Failed to pause recording:",C)}},[]),b=g.useCallback(async()=>{var S;try{c.current&&(await c.current.resumeRecording(),i(!1),(S=t.onRecordingStateChange)==null||S.call(t,!0,!1))}catch(C){console.error("Failed to resume recording:",C)}},[]);return{isRecording:e,isPaused:r,startRecording:v,stopRecording:x,pauseRecording:w,resumeRecording:b,formattedTime:pW(o),currentVisitId:a}}class gW{constructor(e={}){this.stream=null,this.monitorRecorder=null,this.audioContext=null,this.analyser=null,this.mediaStreamSource=null,this.reconnectInterval=null,this.isReconnecting=!1,this.onStreamAvailable=e.onStreamAvailable}startStreamMonitoring(){this.reconnectInterval&&clearInterval(this.reconnectInterval),this.reconnectInterval=window.setInterval(async()=>{if(!this.stream)return;if(!this.stream.getAudioTracks().some(r=>r.readyState==="live")&&!this.isReconnecting){console.log("[AudioMonitor] Stream inactive, attempting to reconnect..."),this.isReconnecting=!0;try{await this.initialize(this.lastDeviceId),console.log("[AudioMonitor] Successfully reconnected stream")}catch(r){console.error("[AudioMonitor] Failed to reconnect stream:",r)}finally{this.isReconnecting=!1}}},5e3)}async initialize(e){try{this.lastDeviceId=e,this.cleanup(),this.stream=await navigator.mediaDevices.getUserMedia({audio:{deviceId:e?{exact:e}:void 0,channelCount:1,sampleRate:48e3}}),this.audioContext=new AudioContext,this.analyser=this.audioContext.createAnalyser(),this.analyser.minDecibels=-85,this.analyser.maxDecibels=-10,this.analyser.smoothingTimeConstant=.85,this.analyser.fftSize=1024,this.mediaStreamSource=this.audioContext.createMediaStreamSource(this.stream),this.mediaStreamSource.connect(this.analyser);const n=tM();this.monitorRecorder=new MediaRecorder(this.stream,{mimeType:n,audioBitsPerSecond:48e3}),this.monitorRecorder.start(100),this.startStreamMonitoring(),this.onStreamAvailable&&this.onStreamAvailable(this.stream)}catch(n){throw console.error("[AudioMonitor] Failed to initialize:",n),this.cleanup(),n}}getStream(){return this.stream}getAnalyser(){return this.analyser}getAudioContext(){return this.audioContext}isMonitoring(){return this.monitorRecorder!==null&&this.monitorRecorder.state==="recording"}async resumeContext(){var e;((e=this.audioContext)==null?void 0:e.state)==="suspended"&&await this.audioContext.resume()}cleanup(){if(console.log("[AudioMonitor] Cleaning up..."),this.reconnectInterval&&(clearInterval(this.reconnectInterval),this.reconnectInterval=null),this.monitorRecorder){try{this.monitorRecorder.state==="recording"&&this.monitorRecorder.stop()}catch(e){console.warn("[AudioMonitor] Error stopping monitor recorder:",e)}this.monitorRecorder=null}this.mediaStreamSource&&(this.mediaStreamSource.disconnect(),this.mediaStreamSource=null),this.analyser&&(this.analyser.disconnect(),this.analyser=null),this.audioContext&&(this.audioContext.close(),this.audioContext=null),this.stream&&(this.stream.getTracks().forEach(e=>e.stop()),this.stream=null),console.log("[AudioMonitor] Cleanup complete.")}}const yW=t=>{const e=g.useRef(null),n=g.useRef(null),r=g.useRef(null),i=g.useRef(null),o=async()=>{const a=t.current;if(!a){console.error("AudioMonitor not provided");return}const l=document.getElementById("visualizer");if(!l){console.error("Canvas element not found");return}i.current=l;const c=l.getContext("2d");if(!c){console.error("Unable to get canvas context");return}if(l.width===0||l.height===0){console.error("Canvas has zero dimensions:",l.width,l.height);return}let u=a.getAnalyser(),d=0;const h=5;for(;!u&&d<h;)console.log(`Waiting for analyzer (attempt ${d+1}/${h})...`),await new Promise(O=>{r.current=window.setTimeout(O,500)}),u=a.getAnalyser(),d++;if(!u){console.error("Analyzer not available after retries");return}await a.resumeContext();const p=u.frequencyBinCount,m=new Uint8Array(p),y=8,v=new Float32Array(y).fill(0),x=.85,w=a.getAudioContext();if(!w){console.error("AudioContext not available");return}const S=w.sampleRate/u.fftSize,C=Math.floor(50/S),k=Math.floor(1e3/S),E=k-C;e.current&&(cancelAnimationFrame(e.current),e.current=null);const T=()=>{if(!i.current){console.log("Canvas no longer exists, stopping visualization"),e.current&&(cancelAnimationFrame(e.current),e.current=null);return}e.current=requestAnimationFrame(T),u.getByteFrequencyData(m);const O=m.slice(C,k).every(I=>I===0),_=Date.now();O?n.current||(n.current=_):n.current&&(n.current=null);const D=n.current&&_-n.current>3e4;c.clearRect(0,0,l.width,l.height);const L=1,N=(y-1)*L,P=Math.floor((l.width-N)/y);let V=0;for(let I=0;I<y;I++){const F=C+Math.floor(I/y*E),M=C+Math.floor((I+1)/y*E);if(M<=F)continue;const A=m.slice(F,M).reduce((ee,q)=>ee+q,0)/(M-F);v[I]=v[I]*x+A*(1-x);const $=Math.max(v[I]/255*l.height*1.2,l.height*.2),G=(l.height-$)/2;c.fillStyle=D?"rgba(239, 68, 68, 0.8)":`rgba(59, 130, 246, ${Math.max(.3,v[I]/255)})`,c.fillRect(V,G,P,$),V+=P+L}};T()},s=()=>{r.current&&(window.clearTimeout(r.current),r.current=null),e.current&&(cancelAnimationFrame(e.current),e.current=null),i.current=null};return g.useEffect(()=>()=>{s()},[]),{startVisualizer:o,stopVisualizer:s}},Ci={micSelectorContainer:{display:"flex",alignItems:"center"},visualizerButton:{display:"flex",alignItems:"center",padding:"0",backgroundColor:"transparent",border:"none",cursor:"pointer",outline:"none",WebkitTapHighlightColor:"transparent","&:hover":{backgroundColor:"transparent"},"&:active":{backgroundColor:"transparent"},"&:focus":{backgroundColor:"transparent",outline:"none"}},visualizerGroup:{display:"flex",alignItems:"center",gap:"4px",backgroundColor:"white",padding:"0 12px",borderRadius:"6px",border:"1px solid #e5e7eb",justifyContent:"space-between",height:"36px"},visualizer:{maxWidth:"60px",height:"36px",backgroundColor:"transparent"},dropdownContent:{minWidth:"220px",backgroundColor:"white",borderRadius:"6px",padding:"5px",boxShadow:"0px 10px 38px -10px rgba(22, 23, 24, 0.35), 0px 10px 20px -15px rgba(22, 23, 24, 0.2)"},dropdownItem:{fontSize:"14px",lineHeight:"1",color:"#374151",borderRadius:"3px",display:"flex",alignItems:"center",height:"32px",padding:"0 8px",userSelect:"none",outline:"none",cursor:"pointer","&:hover":{backgroundColor:"#f3f4f6"}},selectedDropdownItem:{backgroundColor:"#f0f9ff",color:"#2563eb","&:hover":{backgroundColor:"#e0f2fe"}},dropdownLabel:{fontSize:"12px",lineHeight:"1",color:"#6b7280",padding:"0 8px",marginBottom:"4px"}};function vW({onDeviceSelect:t,selectedDevice:e}){const[n,r]=g.useState([]),[i,o]=g.useState(null),s=g.useRef(null),a=g.useRef(!1),{startVisualizer:l}=yW(s),c=g.useRef(!0);g.useEffect(()=>(s.current=new gW,c.current=!0,()=>{c.current=!1}),[]);const u=g.useCallback(async()=>{if(c.current)try{await navigator.mediaDevices.getUserMedia({audio:!0});const m=(await navigator.mediaDevices.enumerateDevices()).filter(v=>v.kind==="audioinput");if(r(m),e&&m.some(v=>v.deviceId===e.deviceId)){if(m.length>0&&!e){const v=m.find(x=>x.deviceId!=="default"&&x.deviceId!=="communications")||m[0];t(v)}}else{const v=m.find(x=>x.deviceId!=="default"&&x.deviceId!=="communications")||m[0];v&&(console.log("Previously selected device no longer available. Switching to:",v.label),t(v))}}catch(p){console.error("Failed to load audio devices:",p)}},[e,t]);g.useEffect(()=>(u(),navigator.mediaDevices.addEventListener("devicechange",u),()=>{navigator.mediaDevices.removeEventListener("devicechange",u)}),[u]);const d=g.useCallback(async()=>{if(!(!c.current||!s.current||!e||a.current))try{a.current=!0,s.current.cleanup(),await s.current.initialize(e.deviceId),c.current&&(await new Promise(p=>setTimeout(p,100)),await l())}catch(p){console.error("Failed to initialize audio monitor:",p),c.current&&s.current&&s.current.cleanup()}finally{c.current&&(a.current=!1)}},[e==null?void 0:e.deviceId,l]);g.useEffect(()=>{(i==null?void 0:i.deviceId)!==(e==null?void 0:e.deviceId)&&(o(e),e&&d())},[i==null?void 0:i.deviceId,e==null?void 0:e.deviceId,d]);const h=g.useCallback(p=>{if(!c.current)return;const m=n.find(y=>y.deviceId===p);m&&t(m)},[n,t]);return f.jsx("div",{style:Ci.micSelectorContainer,children:f.jsxs(Sl,{children:[f.jsx(Cl,{asChild:!0,children:f.jsx("button",{style:Ci.visualizerButton,children:f.jsxs("div",{style:Ci.visualizerGroup,children:[f.jsx(ph,{size:16,color:"#6b7280"}),f.jsx("canvas",{id:"visualizer",style:Ci.visualizer,width:"120",height:"36"}),f.jsx(Ye,{width:16,height:16,color:"#6b7280"})]})})}),f.jsx(kl,{children:f.jsxs(El,{style:Ci.dropdownContent,sideOffset:5,children:[f.jsx("div",{style:Ci.dropdownLabel,children:"Select Microphone"}),n.filter(p=>p.deviceId!=="default").map(p=>{const m=p.deviceId===(e==null?void 0:e.deviceId);return f.jsxs(tn,{style:{...Ci.dropdownItem,...m?Ci.selectedDropdownItem:{}},onClick:()=>h(p.deviceId),children:[f.jsx(ph,{size:16,style:{marginRight:"8px",color:m?"#2563eb":"#6b7280"}}),p.label||`Microphone ${p.deviceId.slice(0,4)}`]},p.deviceId)})]})})]})})}const Xt={container:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:"8px"},buttonsContainer:{width:"200px",height:"36px"},buttonGroup:{display:"flex",alignItems:"stretch",height:"100%",width:"100%",minWidth:"200px"},dropdownTrigger:{display:"flex",alignItems:"center",padding:"0 8px",backgroundColor:"#3b82f6",color:"white",border:"none",borderLeft:"1px solid rgba(255,255,255,0.2)",borderRadius:"0 6px 6px 0",cursor:"pointer",transition:"all 0.2s ease",outline:"none",width:"32px","&:hover":{backgroundColor:"#2563eb"},"&:focus":{outline:"none"},"&:active":{outline:"none"},WebkitTapHighlightColor:"transparent"},controlsRow:{display:"flex",alignItems:"center",gap:"16px",userSelect:"none",height:"36px"},timerContainer:{display:"flex",alignItems:"center",pointerEvents:"none",height:"36px"},timer:{display:"flex",alignItems:"center",gap:"4px",fontSize:"14px",color:"#374151",height:"36px",padding:"0 8px"},timerIcon:{width:"16px",height:"16px",color:"#6b7280"},dropdownContent:{minWidth:"220px",backgroundColor:"white",borderRadius:"6px",padding:"5px",boxShadow:"0px 10px 38px -10px rgba(22, 23, 24, 0.35), 0px 10px 20px -15px rgba(22, 23, 24, 0.2)"},dropdownItem:{fontSize:"14px",lineHeight:"1",color:"#374151",borderRadius:"3px",display:"flex",alignItems:"center",height:"32px",padding:"0 8px",userSelect:"none",outline:"none",cursor:"pointer","&:hover":{backgroundColor:"#f3f4f6"}},pauseButton:{display:"flex",alignItems:"center",justifyContent:"center",gap:"6px",padding:"8px 16px",color:"white",border:"none",cursor:"pointer",fontSize:"14px",fontWeight:"500",transition:"all 0.2s ease",outline:"none",borderRadius:"6px 0 0 6px",backgroundColor:"#9ca3af",width:"100px","&:hover":{backgroundColor:"#6b7280"}},resumeButton:{display:"flex",alignItems:"center",justifyContent:"center",gap:"6px",padding:"8px 16px",color:"white",border:"none",cursor:"pointer",fontSize:"14px",fontWeight:"500",transition:"all 0.2s ease",outline:"none",borderRadius:"6px 0 0 6px",backgroundColor:"#3b82f6",flex:"1","&:hover":{backgroundColor:"#2563eb"}},stopButton:{display:"flex",alignItems:"center",justifyContent:"center",gap:"6px",padding:"8px 16px",color:"white",border:"none",cursor:"pointer",fontSize:"14px",fontWeight:"500",transition:"all 0.2s ease",outline:"none",borderRadius:"0 6px 6px 0",backgroundColor:"#dc2626",width:"100px","&:hover":{backgroundColor:"#b91c1c"}},startButton:{display:"flex",alignItems:"center",justifyContent:"center",gap:"6px",padding:"8px 16px",color:"white",border:"none",cursor:"pointer",fontSize:"14px",fontWeight:"500",transition:"all 0.2s ease",outline:"none",borderRadius:"6px 0 0 6px",backgroundColor:"#3b82f6",minWidth:"168px",flex:1,"&:hover":{backgroundColor:"#2563eb"}}};function xW({disabled:t=!1,onRecordingStateChange:e,visitId:n,initialChunkId:r,onStartRecording:i}){const[o,s]=g.useState(null),[a,l]=g.useState("new"),[c,u]=g.useState(n||null),{user:d}=It(),{updateVisitState:h}=zx(),{isRecording:p,isPaused:m,formattedTime:y,startRecording:v,stopRecording:x,pauseRecording:w,resumeRecording:b}=mW({onRecordingStateChange:e,initialVisitId:c||void 0,initialChunkId:r});g.useEffect(()=>{console.log("[AudioRecorder] State update:",{isRecording:p,isPaused:m,recordingState:a,visitId:c,disabled:t})},[p,m,a,c,t]),g.useEffect(()=>{c===null&&l("new")},[c]);const S=g.useCallback(async()=>{try{if(!(d!=null&&d.id))throw new Error("User not authenticated");if(c&&a==="paused"){await b(),l("recording"),await h({visitId:c,state:"recording"});return}if(i){const O=await i();if(!O)return;u(O),console.log("[AudioRecorder] Setting internal visit ID:",O),l("recording"),await v(o==null?void 0:o.deviceId,O)}else{console.error("No visit ID available and no onStartRecording provided");return}}catch(O){console.error("Failed to start recording:",O)}},[d==null?void 0:d.id,c,a,i,b,h]),C=g.useCallback(async()=>{if(c)try{await w(),l("paused"),await h({visitId:c,state:"paused"})}catch(O){console.error("Failed to pause recording:",O)}},[c,w,h]),k=g.useCallback(async()=>{if(c)try{await b(),l("recording"),await h({visitId:c,state:"recording"})}catch(O){console.error("Failed to resume recording:",O)}},[c,b,h]),E=g.useCallback(async()=>{if(console.log("[AudioRecorder] Stopping recording",c),!!c)try{await x(),l("processing"),await h({visitId:c,state:"processing",endVisit:!0})}catch(O){console.error("Failed to stop recording:",O)}},[c,x,h]);g.useEffect(()=>{e==null||e(p,m)},[p,m,e]);const T=g.useMemo(()=>({startButton:{...Xt.startButton,...t?{opacity:.5,cursor:"not-allowed",backgroundColor:"#9ca3af"}:{}},dropdownTrigger:{...Xt.dropdownTrigger,...t?{opacity:.5,cursor:"not-allowed",backgroundColor:"#9ca3af"}:{}}}),[t]);return f.jsxs("div",{style:Xt.container,children:[f.jsxs("div",{style:Xt.controlsRow,children:[f.jsx("div",{style:Xt.timerContainer,children:f.jsxs("div",{style:Xt.timer,children:[f.jsx(bz,{style:Xt.timerIcon}),y]})}),f.jsx(vW,{selectedDevice:o,onDeviceSelect:s})]}),f.jsx("div",{style:Xt.buttonsContainer,children:f.jsx("div",{style:Xt.buttonGroup,children:p?f.jsxs(f.Fragment,{children:[f.jsxs("button",{onClick:a==="paused"?k:C,style:a==="paused"?Xt.resumeButton:Xt.pauseButton,disabled:t,children:[a==="paused"?f.jsx(ph,{size:16}):f.jsx(yV,{size:16}),a==="paused"?"Resume":"Pause"]}),f.jsxs("button",{onClick:E,style:Xt.stopButton,disabled:t,children:[f.jsx(kV,{size:16}),"Stop"]})]}):f.jsxs(f.Fragment,{children:[f.jsxs("button",{onClick:S,style:T.startButton,disabled:t,children:[f.jsx(ph,{size:16}),"Start Recording"]}),f.jsxs(Sl,{children:[f.jsx(Cl,{asChild:!0,children:f.jsx("button",{style:T.dropdownTrigger,disabled:t,children:f.jsx(Ye,{width:16,height:16})})}),f.jsx(kl,{children:f.jsx(El,{style:Xt.dropdownContent,sideOffset:5,children:f.jsxs(tn,{style:Xt.dropdownItem,children:[f.jsx(PV,{size:16,style:{marginRight:"8px"}}),"Upload Audio"]})})})]})]})})})]})}const Lt={container:{position:"relative"},trigger:{display:"flex",alignItems:"center",padding:"8px",border:"none",borderRadius:"6px",backgroundColor:"transparent",color:"#6b7280",cursor:"pointer",outline:"none","&:hover":{backgroundColor:"#f3f4f6"}},popoverContent:{backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"8px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)",width:"400px",zIndex:50,padding:"24px"},title:{fontSize:"20px",fontWeight:"600",color:"#111827",marginBottom:"24px"},section:{marginBottom:"24px"},label:{fontSize:"16px",fontWeight:"500",color:"#111827",marginBottom:"4px"},description:{fontSize:"14px",color:"#6b7280",marginBottom:"12px"},selectTrigger:{display:"inline-flex",alignItems:"center",justifyContent:"space-between",borderRadius:"6px",padding:"0 15px",fontSize:"14px",lineHeight:"1",height:"35px",gap:"5px",backgroundColor:"white",color:"#111827",border:"1px solid #e5e7eb",width:"100%","&:hover":{backgroundColor:"#f9fafb"},"&:focus":{boxShadow:"0 0 0 2px #e5e7eb"},"&[dataPlaceholder]":{color:"#6b7280"}},footer:{display:"flex",justifyContent:"flex-end",gap:"12px",marginTop:"24px"},button:{padding:"8px 16px",borderRadius:"6px",fontSize:"14px",fontWeight:"500",cursor:"pointer"},cancelButton:{border:"none",backgroundColor:"transparent",color:"#6b7280","&:hover":{backgroundColor:"#f3f4f6"}},saveButton:{border:"none",backgroundColor:"#6b7280",color:"white","&:hover":{backgroundColor:"#4b5563"}}},FS=Te.forwardRef(({children:t,...e},n)=>f.jsx(LP,{...e,ref:n,className:"text-[13px] leading-none text-gray-700 rounded-[3px] flex items-center h-[25px] pr-[35px] pl-[25px] relative select-none data-[disabled]:text-gray-400 data-[disabled]:pointer-events-none data-[highlighted]:outline-none data-[highlighted]:bg-blue-100 data-[highlighted]:text-blue-900",children:f.jsx($P,{children:t})}));function wW({spokenLanguage:t,patientInstructionsLanguage:e,setSpokenLanguage:n,setPatientInstructionsLanguage:r}){const[i,o]=g.useState(!1);return f.jsx("div",{style:Lt.container,children:f.jsxs(JP,{open:i,onOpenChange:o,children:[f.jsx(YP,{asChild:!0,children:f.jsx("button",{style:Lt.trigger,children:f.jsx(pV,{size:20})})}),f.jsx(QP,{children:f.jsxs(XP,{style:{...Lt.popoverContent,zIndex:40},side:"bottom",align:"start",sideOffset:4,children:[f.jsx("div",{style:Lt.title,children:"Language settings"}),f.jsxs("div",{style:Lt.section,children:[f.jsx("div",{style:Lt.label,children:"Speech language"}),f.jsx("div",{style:Lt.description,children:"Choosing a specific language will improve transcription accuracy."}),f.jsxs(Di,{value:t,onValueChange:n,children:[f.jsxs(ji,{style:Lt.selectTrigger,className:"inline-flex items-center justify-between rounded-md px-3 py-2 text-sm leading-none gap-1 bg-white border border-gray-300 h-9 w-full max-w-md outline-none focus:border-blue-500 data-[placeholder]:text-gray-500",onClick:s=>s.stopPropagation(),children:[f.jsx(Li,{}),f.jsx($i,{children:f.jsx(Ye,{})})]}),f.jsx(Fi,{children:f.jsxs(Bi,{sideOffset:5,position:"popper",className:"bg-white rounded-md shadow-lg border border-gray-200 w-[var(--radix-select-trigger-width)]",style:{zIndex:9999},onClick:s=>s.stopPropagation(),children:[f.jsx(Vi,{className:"flex items-center justify-center h-6 bg-white text-gray-700 cursor-default",children:f.jsx(Ni,{})}),f.jsx(zi,{className:"p-1",style:{maxHeight:"250px",overflowY:"auto"},children:lv.map(s=>f.jsx(FS,{value:s.value,children:s.label},s.value))}),f.jsx(Ui,{className:"flex items-center justify-center h-6 bg-white text-gray-700 cursor-default",children:f.jsx(Ye,{})})]})})]})]}),f.jsxs("div",{style:Lt.section,children:[f.jsx("div",{style:Lt.label,children:"Patient instructions language"}),f.jsx("div",{style:Lt.description,children:"Your patient instructions will be generated in this language."}),f.jsxs(Di,{value:e,onValueChange:r,children:[f.jsxs(ji,{style:Lt.selectTrigger,className:"inline-flex items-center justify-between rounded-md px-3 py-2 text-sm leading-none gap-1 bg-white border border-gray-300 h-9 w-full max-w-md outline-none focus:border-blue-500 data-[placeholder]:text-gray-500",onClick:s=>s.stopPropagation(),children:[f.jsx(Li,{}),f.jsx($i,{children:f.jsx(Ye,{})})]}),f.jsx(Fi,{children:f.jsxs(Bi,{sideOffset:5,position:"popper",className:"bg-white rounded-md shadow-lg border border-gray-200 w-[var(--radix-select-trigger-width)]",style:{zIndex:9999},onClick:s=>s.stopPropagation(),children:[f.jsx(Vi,{className:"flex items-center justify-center h-6 bg-white text-gray-700 cursor-default",children:f.jsx(Ni,{})}),f.jsx(zi,{className:"p-1",style:{maxHeight:"250px",overflowY:"auto"},children:dP.map(s=>f.jsx(FS,{value:s.value,children:s.label},s.value))}),f.jsx(Ui,{className:"flex items-center justify-center h-6 bg-white text-gray-700 cursor-default",children:f.jsx(Ye,{})})]})})]})]}),f.jsx("div",{style:Lt.footer,children:f.jsx("button",{style:{...Lt.button,...Lt.cancelButton},onClick:()=>o(!1),children:"Close"})})]})})]})})}const Kd={header:{height:"60px",width:"100%",backgroundColor:"#f9fafb",padding:"0 24px 0",display:"flex",alignItems:"flex-end",justifyContent:"space-between",gap:"32px"},headerLeft:{flex:"1 1 auto",minWidth:0,display:"flex",alignItems:"center",gap:"8px"},patientSearchWrapper:{maxWidth:"300px",flex:"1 1 auto"},headerRight:{flex:"0 0 auto",display:"flex",alignItems:"center",gap:"16px"}};function bW({onRecordingStateChange:t,currentVisitId:e,currentVisitSelectedPatientId:n,currentVisitSelectedSpokenLanguage:r,currentVisitSelectedPatientInstructionsLanguage:i}){const[o,s]=g.useState(void 0),[a,l]=g.useState(null),[c,u]=g.useState("en"),[d,h]=g.useState("en"),[p,m]=g.useState(!1),{user:y}=It(),v=mr(),{createVisit:x,updateVisitState:w,updateVisitName:b,updateVisitPatient:S,updateVisitLanguages:C}=zx();g.useEffect(()=>{const P=y==null?void 0:y.note_preferences;e?(u(r??Ra.audio_language),h(i??Ra.patient_instructions_language)):(u(P.primary_language||Ra.audio_language),h(P.patient_instructions_language||Ra.patient_instructions_language))},[y==null?void 0:y.note_preferences,e,r,i]);const k=P=>{u(P),e&&C({visitId:e,audioLanguage:P,patientInstructionsLanguage:d})},E=P=>{h(P),e&&C({visitId:e,audioLanguage:c,patientInstructionsLanguage:P})},T=P=>{l((P==null?void 0:P.id)||null),e&&S({visitId:e,patientId:(P==null?void 0:P.id)||null})},O=P=>{s(P||void 0),e&&b({visitId:e,name:P||null})},_=g.useCallback(async()=>{try{if(!(y!=null&&y.id))throw new Error("User not authenticated");if(e)await w({visitId:e,state:"recording"});else{const P=crypto.randomUUID();return await x({id:P,userId:y.id,name:o,patientId:a||void 0,audioLanguage:c,patientInstructionsLanguage:d}),v(`/visit/${P}`),P}}catch(P){console.error("Failed to create/resume visit:",P);return}},[y==null?void 0:y.id,e,x,w,o,a,c,d,v]),D=g.useCallback((P,V)=>{m(P&&!V),t(P,V)},[t]),L=g.useMemo(()=>({disabled:!1,onRecordingStateChange:D,onStartRecording:_,visitId:p?void 0:e}),[D,_,e,p]),N=g.useMemo(()=>f.jsx(xW,{...L}),[L]);return f.jsxs("div",{style:Kd.header,children:[f.jsxs("div",{style:Kd.headerLeft,children:[f.jsx("div",{style:Kd.patientSearchWrapper,children:f.jsx(X9,{onPatientSelect:T,onVisitNameChange:O,visitId:e,selectedPatientId:n??a??void 0})}),f.jsx(wW,{spokenLanguage:c,patientInstructionsLanguage:d,setSpokenLanguage:k,setPatientInstructionsLanguage:E})]}),f.jsx("div",{style:Kd.headerRight,children:N})]})}const rg={container:{height:"100vh",width:"100vw",display:"flex",flexDirection:"column",backgroundColor:"#f3f4f6"},mainContent:{flex:1,display:"flex",flexDirection:"row",overflow:"hidden"},content:{flex:1,display:"flex",flexDirection:"column",alignItems:"flex-start",overflow:"hidden"}};function Wo(){var w;const t=mr(),{visitId:e}=SN(),n=Gn(),[r,i]=g.useState(!1),[o,s]=g.useState(!1),{user:a,loading:l,error:c}=It(),u=Je(),d=(w=n.state)==null?void 0:w.pendingRecordingVisitId;console.log("MainContent rendering:",{path:n.pathname,userId:a==null?void 0:a.id,isLoading:l,hasError:!!c,visitId:e,pendingRecordingVisitId:d});let h=[];try{h=N9((a==null?void 0:a.id)||""),console.log("Visits loaded:",h.length)}catch(b){console.error("Error loading visits:",b)}console.log("VISIT ID",e);const p=h.find(b=>b.id===e);console.log("SELECTED VISIT",p,h,e);const m=g.useCallback((b,S=!1)=>{i(b),s(S)},[]),y=b=>{t(`/visit/${b.id}`,{state:{pendingRecordingVisitId:b.id}})},v=()=>{console.log("NEW SESSION"),t("/record")},x=b=>{if(b.state!=="paused")return;(async()=>{var C;try{const{data:k,error:E}=await u.from("containers").select("chunk_id").eq("visit_id",b.id).order("chunk_id",{ascending:!1}).limit(1);if(E)throw E;return((C=k==null?void 0:k[0])==null?void 0:C.chunk_id)??-1}catch(k){return console.error("Error getting last chunk ID:",k),-1}})().then(C=>{t(`/visit/${b.id}`,{state:{visitId:b.id,lastChunkId:C,state:"paused",isRecordingEnabled:!0}})})};return l?f.jsx("div",{style:{height:"100vh",width:"100vw",display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:"#f3f4f6"},children:f.jsx("div",{children:"Loading..."})}):c?f.jsxs("div",{children:["Error loading user profile: ",c]}):f.jsx("div",{style:rg.container,children:f.jsxs("div",{style:rg.mainContent,children:[f.jsx(A9,{onNewSession:v,onVisitSelect:y,selectedVisitId:p==null?void 0:p.id,onContinueRecording:x,visits:h}),f.jsx("div",{style:rg.content,children:n.pathname==="/profile"?f.jsx(ZH,{}):n.pathname==="/settings"?f.jsx(_9,{}):n.pathname==="/my-templates"?f.jsx(R9,{}):n.pathname==="/community-templates"?f.jsx(O9,{}):n.pathname==="/patients"?f.jsx(F9,{}):f.jsxs(f.Fragment,{children:[f.jsx(bW,{onRecordingStateChange:m,currentVisitId:p==null?void 0:p.id,currentVisitSelectedPatientId:(p==null?void 0:p.patient_id)??void 0,currentVisitSelectedSpokenLanguage:(p==null?void 0:p.audio_language)??void 0,currentVisitSelectedPatientInstructionsLanguage:(p==null?void 0:p.patient_instructions_language)??void 0}),f.jsx(qH,{isTranscribing:r||o,placeholder:r?o||(p==null?void 0:p.state)==="paused"?"Recording paused...":"Your transcription will appear here as you speak...":p?"Loading visit transcription...":"Select a visit or start a new recording session",currentVisit:p},"TranscriptionDisplay-"+(p==null?void 0:p.id))]})})]})})}const SW=new IE({defaultOptions:{queries:{retry:1,refetchOnWindowFocus:!1}}});function CW(){return f.jsx(DE,{client:SW,children:f.jsx(YH,{children:f.jsx(LH,{children:f.jsxs(LN,{children:[f.jsx(mn,{path:"/login",element:f.jsx(JH,{})}),f.jsx(mn,{path:"/signup",element:f.jsx(QH,{})}),f.jsx(mn,{path:"/",element:f.jsx(Vf,{to:"/record",replace:!0})}),f.jsx(mn,{path:"*",element:f.jsx(Vf,{to:"/record",replace:!0})}),f.jsx(mn,{path:"/record",element:f.jsx(Si,{children:f.jsx(Wo,{})})}),f.jsx(mn,{path:"/visit/:visitId",element:f.jsx(Si,{children:f.jsx(Wo,{})})}),f.jsx(mn,{path:"/profile",element:f.jsx(Si,{children:f.jsx(Wo,{})})}),f.jsx(mn,{path:"/settings",element:f.jsx(Si,{children:f.jsx(Wo,{})})}),f.jsx(mn,{path:"/my-templates",element:f.jsx(Si,{children:f.jsx(Wo,{})})}),f.jsx(mn,{path:"/community-templates",element:f.jsx(Si,{children:f.jsx(Wo,{})})}),f.jsx(mn,{path:"/patients",element:f.jsx(Si,{children:f.jsx(Wo,{})})}),f.jsx(mn,{path:"/admin",element:f.jsx(Si,{children:f.jsx($9,{children:f.jsx(j9,{})})})})]})})})})}const kW=new IE({defaultOptions:{queries:{retry:1,refetchOnWindowFocus:!1}}});ig.createRoot(document.getElementById("root")).render(f.jsx(Te.StrictMode,{children:f.jsx(DE,{client:kW,children:f.jsx(tL,{children:f.jsx(c2,{children:f.jsx(CW,{})})})})}));export{YS as g};
